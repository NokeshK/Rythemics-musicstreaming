!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SlideShowCore=t():e.SlideShowCore=t()}(window,(function(){return function(e){function t(t){for(var i,r,a=t[0],s=t[1],o=0,d=[];o<a.length;o++)r=a[o],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&d.push(n[r][0]),n[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(l&&l(t);d.length;)d.shift()()}var i={},n={8:0,2:0};function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,r){i=n[e]=[t,r]}));t.push(i[2]=a);var s,o=document.createElement("script");o.charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.src=function(e){return r.p+""+({0:"HLS"}[e]||e)+".bundle.js"}(e),0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous");var l=new Error;s=function(t){o.onerror=o.onload=null,clearTimeout(d);var i=n[e];if(0!==i){if(i){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,i[1](l)}n[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:o})}),12e4);o.onerror=o.onload=s,document.head.appendChild(o)}return Promise.all(t)},r.m=e,r.c=i,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpSscore=window.webpackJsonpSscore||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var o=0;o<a.length;o++)t(a[o]);var l=s;return r(r.s=288)}([function(e,t,i){"use strict";i.d(t,"i",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"f",(function(){return a})),i.d(t,"g",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"e",(function(){return l})),i.d(t,"d",(function(){return d})),i.d(t,"b",(function(){return c})),i.d(t,"l",(function(){return h})),i.d(t,"k",(function(){return u})),i.d(t,"h",(function(){return m})),i.d(t,"n",(function(){return f})),i.d(t,"p",(function(){return p})),i.d(t,"o",(function(){return g})),i.d(t,"m",(function(){return _})),i.d(t,"j",(function(){return S}));const n=.001;var r;!function(e){e[e.topLeft=0]="topLeft",e[e.top=1]="top",e[e.topRight=2]="topRight",e[e.left=3]="left",e[e.center=4]="center",e[e.right=5]="right",e[e.bottomLeft=6]="bottomLeft",e[e.bottom=7]="bottom",e[e.bottomRight=8]="bottomRight"}(r||(r={}));class a{static Flip(e,t){return new a(e?-1:1,t?-1:1)}negate(){return new a(-this.x,-this.y)}inverse(){return new a(1/this.x,1/this.y)}normalized(){const e=this.length();return e?this.scale(1/e):void 0}abs(){return new a(Math.abs(this.x),Math.abs(this.y))}floor(){return new a(Math.floor(this.x),Math.floor(this.y))}ceil(){return new a(Math.ceil(this.x),Math.ceil(this.y))}sign(){return new a(this.x<0?-1:1,this.y<0?-1:1)}isZero(){return 0==this.x&&0==this.y}isFinite(){return isFinite(this.x)&&isFinite(this.y)}isFinitePositive(){return this.isFinite()&&this.x>0&&this.y>0}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}static Distance(e,t){return e.subtract(t).length()}equals(e){return this.x==e.x&&this.y==e.y}equalsWithEpsilon(e,t=n){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t}add(e){return new a(this.x+e.x,this.y+e.y)}subtract(e){return new a(this.x-e.x,this.y-e.y)}multiply(e){return new a(this.x*e.x,this.y*e.y)}divide(e){return new a(this.x/e.x,this.y/e.y)}dot(e){return this.x*e.x+this.y*e.y}scale(e){return new a(this.x*e,this.y*e)}rotate(e){return e?new a(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e)):this}transformVector(e){return e.transformVector(this)}transformPoint(e){return e.transformPoint(this)}static InterpolateLinear(e,t,i){return e.add(t.subtract(e).scale(i))}static InterpolateQuadratic(e,t,i,n){return a.InterpolateLinear(a.InterpolateLinear(e,t,n),a.InterpolateLinear(t,i,n),n)}static QuadraticTangent(e,t,i,n){return a.InterpolateLinear(t,i,n).subtract(a.InterpolateLinear(e,t,n)).normalized()}static CalculateLineIntersection(e,t,i,r,s=n){const o=(r.x-i.x)*(e.y-i.y)-(r.y-i.y)*(e.x-i.x),l=(r.y-i.y)*(t.x-e.x)-(r.x-i.x)*(t.y-e.y);if(Math.abs(l)>s)return a.InterpolateLinear(e,t,o/l)}static MeasureQuadraticLength(e,t,i){return g(e.x,e.y,t.x,t.y,i.x,i.y)}static GetQuadraticParameterForDistance(e,t,i,n){return function e(t,i,n,r,a,s,o,l){if(l<=0){const e=g(t,i,n,r,a,s);return e>0?o/e:0}const d=.5*t+.5*n,c=.5*i+.5*r,h=.5*n+.5*a,u=.5*r+.5*s,m=.5*d+.5*h,f=.5*c+.5*u,p=g(t,i,d,c,m,f);return o<p?.5*e(t,i,d,c,m,f,o,l-1):.5+.5*e(m,f,h,u,a,s,o-p,l-1)}(e.x,e.y,t.x,t.y,i.x,i.y,n,4)}constructor(e,t){this.x=e,this.y=t}}a.Zero=new a(0,0),a.One=new a(1,1);class s{constructor(e,t,i){this.x=e,this.y=t,this.z=i}}s.Zero=new s(0,0,0),s.One=new s(1,1,1);class o{toMatrix3(){return this}isIdentity(){return this==o.Identity||this.equals(o.Identity)}multiply(e){const t=this.m,i=e.m;return new o(t[0]*i[0]+t[1]*i[3]+t[2]*i[6],t[0]*i[1]+t[1]*i[4]+t[2]*i[7],t[0]*i[2]+t[1]*i[5]+t[2]*i[8],t[3]*i[0]+t[4]*i[3]+t[5]*i[6],t[3]*i[1]+t[4]*i[4]+t[5]*i[7],t[3]*i[2]+t[4]*i[5]+t[5]*i[8],t[6]*i[0]+t[7]*i[3]+t[8]*i[6],t[6]*i[1]+t[7]*i[4]+t[8]*i[7],t[6]*i[2]+t[7]*i[5]+t[8]*i[8])}inverse(){const e=this.m,t=e[0]*e[4]-e[1]*e[3];return 0==t?void 0:new o(e[4]/t,-e[1]/t,0,-e[3]/t,e[0]/t,0,(e[3]*e[7]-e[4]*e[6])/t,(-e[0]*e[7]+e[1]*e[6])/t,1)}transformVector(e){return new a(e.x*this.m[0]+e.y*this.m[3],e.x*this.m[1]+e.y*this.m[4])}transformPoint(e){return new a(e.x*this.m[0]+e.y*this.m[3]+this.m[6],e.x*this.m[1]+e.y*this.m[4]+this.m[7])}isSimpleScaleTranslationOnly(){return 0==this.m[1]&&0==this.m[2]&&0==this.m[3]&&0==this.m[5]&&1==this.m[8]}getSimpleScale(){return new a(this.m[0],this.m[4])}getSimpleTranslation(){return new a(this.m[6],this.m[7])}equals(e){for(let t=0;t<9;t++)if(this.m[t]!=e.m[t])return!1;return!0}tryGetTransform(e){const t=this.transformVector(new a(1,0)),i=this.transformVector(new a(0,1));if(Math.abs(t.x*i.x+t.y*i.y)>n)return;const r=t.x*i.y-t.y*i.x>0?new a(t.length(),i.length()):new a(t.length(),-i.length()),s=t.y>0?Math.acos(t.x/r.x):-Math.acos(t.x/r.x),o=this.transformPoint(e.negate());return new l(e,r,s,o)}static Translation2D(e){return new o(1,0,0,0,1,0,e.x,e.y,1)}static Scale2D(e){return new o(e.x,0,0,0,e.y,0,0,0,1)}static ScaleTranslation2D(e,t){return new o(e.x,0,0,0,e.y,0,t.x,t.y,1)}static RotationZ(e){const t=Math.cos(e),i=Math.sin(e);return new o(t,i,0,-i,t,0,0,0,1)}static RotationAroundPoint(e,t){return new l(t.negate(),a.One,e,t).toMatrix3()}static FromTransforms(...e){if(0==e.length)return o.Identity;let t=e[0].toMatrix3();for(let i=1;i<e.length;i++)t=t.multiply(e[i].toMatrix3());return t}constructor(e,t,i,n,r,a,s,o,l){this.m=new Float32Array([e,t,i,n,r,a,s,o,l])}}o.Identity=new o(1,0,0,0,1,0,0,0,1);class l{toMatrix3(){const e=Math.cos(this.rotation),t=Math.sin(this.rotation),i=this.scale.x*e,n=this.scale.x*t,r=this.scale.y*-t,a=this.scale.y*e;return new o(i,n,0,r,a,0,this.preTranslation.x*i+this.preTranslation.y*r+this.translation.x,this.preTranslation.y*a+this.preTranslation.x*n+this.translation.y,1)}isIdentity(){return this==l.Identity||this.equals(l.Identity)}toInverseMatrix3(){const e=Math.cos(-this.rotation),t=Math.sin(-this.rotation),i=e/this.scale.x,n=t/this.scale.y,r=-t/this.scale.x,a=e/this.scale.y;return new o(i,n,0,r,a,0,-this.translation.x*i-this.translation.y*r-this.preTranslation.x,-this.translation.y*a-this.translation.x*n-this.preTranslation.y,1)}transformVector(e){return e.multiply(this.scale).rotate(this.rotation)}transformPoint(e){return e.add(this.preTranslation).multiply(this.scale).rotate(this.rotation).add(this.translation)}applyScaleAndTranslationBefore(e,t){return new l(this.preTranslation.add(t).divide(e),this.scale.multiply(e),this.rotation,this.translation)}applyTranslationAfter(e){return new l(this.preTranslation,this.scale,this.rotation,this.translation.add(e))}equals(e){return this.preTranslation.equals(e.preTranslation)&&this.scale.equals(e.scale)&&this.rotation==e.rotation&&this.translation.equals(e.translation)}static fromScaleAndTranslation(e,t){return new l(void 0,e,void 0,t)}static fromTransformAndPretranslation(e,t){return new l(t,e.scale,e.rotation,e.translation)}static fromTransformAndScale(e,t){return new l(e.preTranslation,t,e.rotation,e.translation)}static fromTransformAndRotation(e,t){return new l(e.preTranslation,e.scale,t,e.translation)}static fromTransformAndTranslation(e,t){return new l(e.preTranslation,e.scale,e.rotation,t)}constructor(e,t,i,n){this.preTranslation=e||a.Zero,this.scale=t||a.One,this.rotation=null!=i?i:0,this.translation=n||a.Zero}}l.Identity=new l;class d{static FromSize(e){return new d(0,0,e.x,e.y)}static FromSizeAndCenter(e,t){return new d(t.x-.5*e.x,t.y-.5*e.y,t.x+.5*e.x,t.y+.5*e.y)}static FromPoints(e,t){return new d(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.x,t.x),Math.max(e.y,t.y))}isEmpty(){return this.left==this.right&&this.top==this.bottom}isValid(){return this.left<=this.right&&this.top<=this.bottom}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get size(){return new a(this.right-this.left,this.bottom-this.top)}get center(){return new a((this.left+this.right)/2,(this.top+this.bottom)/2)}get leftTop(){return new a(this.left,this.top)}get rightBottom(){return new a(this.right,this.bottom)}isPointInRect(e){return this.left<=e.x&&e.x<=this.right&&this.top<=e.y&&e.y<=this.bottom}equals(e){return this.left==e.left&&this.top==e.top&&this.right==e.right&&this.bottom==e.bottom}inflate(e){return new d(this.left-e,this.top-e,this.right+e,this.bottom+e)}inflateToInteger(){return new d(Math.floor(this.left),Math.floor(this.top),Math.ceil(this.right),Math.ceil(this.bottom))}multiply(e){return d.FromPoints(this.leftTop.multiply(e),this.rightBottom.multiply(e))}divide(e){return d.FromPoints(this.leftTop.divide(e),this.rightBottom.divide(e))}translate(e){return new d(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}transformedBounds(e){let t=void 0,i=[new a(this.left,this.top),new a(this.right,this.top),new a(this.right,this.bottom),new a(this.left,this.bottom)];for(let n=0;n<4;n++)t=d.UnionPoint(t,i[n].transformPoint(e));return t}relativeToAbsolute(e){return new a(p(this.left,this.right,e.x),p(this.top,this.bottom,e.y))}static UnionPoint(e,t){return e&&e.isValid()?new d(Math.min(e.left,t.x),Math.min(e.top,t.y),Math.max(e.right,t.x),Math.max(e.bottom,t.y)):new d(t.x,t.y,t.x,t.y)}static UnionRect(e,t){return e&&t&&e.isValid()&&t.isValid()?new d(Math.min(e.left,t.left),Math.min(e.top,t.top),Math.max(e.right,t.right),Math.max(e.bottom,t.bottom)):e&&e.isValid()?e:t&&t.isValid()?t:void 0}static IntersectRect(e,t){if(e&&t&&e.isValid()&&t.isValid()){const i=new d(Math.max(e.left,t.left),Math.max(e.top,t.top),Math.min(e.right,t.right),Math.min(e.bottom,t.bottom));return i.isValid()?i:void 0}}static SegmentBounds(e,t){return new d(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.x,t.x),Math.max(e.y,t.y))}static QuadraticBezierBounds(e,t,i){let n;n=d.SegmentBounds(e,i);const r=(e.x-t.x)/(e.x+i.x-2*t.x);0<r&&r<1&&(n=d.UnionPoint(n,a.InterpolateQuadratic(e,t,i,r)));const s=(e.y-t.y)/(e.y+i.y-2*t.y);return 0<s&&s<1&&(n=d.UnionPoint(n,a.InterpolateQuadratic(e,t,i,s))),n}static InterpolateLinear(e,t,i){return new d(p(e.left,t.left,i),p(e.top,t.top,i),p(e.right,t.right,i),p(e.bottom,t.bottom,i))}constructor(e=0,t=0,i=0,n=0){this.left=e,this.top=t,this.right=i,this.bottom=n}}d.Zero=new d(0,0,0,0);class c{equals(e){return this.xMin===e.xMin&&this.yMin===e.yMin&&this.xMax===e.xMax&&this.yMax===e.yMax}clip(e){const t=new d(void 0===this.xMin?e.left:this.xMin,void 0===this.yMin?e.top:this.yMin,void 0===this.xMax?e.right:this.xMax,void 0===this.yMax?e.bottom:this.yMax);return d.IntersectRect(e,t)}static CreateFromRect(e){return new c(e.left,e.top,e.right,e.bottom)}constructor(e,t,i,n){this.xMin=e,this.yMin=t,this.xMax=i,this.yMax=n}}function h(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))}function u(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}function m(e,t,i){return Math.min(i,Math.max(t,e))}function f(e,t,i){const n=(i-e)/(t-e);return Math.min(Math.max(n,0),1)}function p(e,t,i){return e+(t-e)*i}function g(e,t,i,r,a,s){const o=a-e,l=s-t;if(Math.abs(o*(r-t)-l*(i-e))<n)return Math.sqrt(o*o+l*l);const d=a-2*i+e,c=s-2*r+t,h=2*i-2*a,u=2*r-2*s,m=4*(d*d+c*c),f=4*(d*h+c*u),p=h*h+u*u,g=2*Math.sqrt(m+f+p),_=Math.sqrt(m),S=2*Math.sqrt(p),v=f/_;return(_*(2*m*g+f*(g-S))+(4*p*m-f*f)*Math.log((2*_+v+g)/(v+S)))/(8*m*_)}function _(e,t,i,n){let r=(t-e)/(2*Math.PI);return r-=Math.floor(r),(n&&r>0||null==n&&r>.5)&&r--,p(e,e+r*(2*Math.PI),i)}function S(e,t){return e==t||null!=e&&null!=t&&e.equals(t)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static load(e){for(const t in e)n.m_settings[t]=e[t]}static readBooleanOrDefault(e,t){const i=void 0===n.m_settings?"":typeof n.m_settings[e];return"string"===i?"true"===n.m_settings[e].toLowerCase():"boolean"===i?n.m_settings[e]:t}static readNumberOrDefault(e,t){const i=void 0===n.m_settings?"":typeof n.m_settings[e];return"string"===i||"number"===i?Number(n.m_settings[e]):t}static readStringOrDefault(e,t){return void 0===n.m_settings||"string"!=typeof n.m_settings[e]?t:n.m_settings[e]}static addOrUpdateSettingsFromUrl(e,t){const i=t.get("wdset");if(!i)return e;for(const t of i.split(",")){const i=t.split(":"),r=i[0].split("."),a=r[0],s=r[1],o=i[1];s&&o&&n.addOrUpdateSetting(e,a,s,o)}return e}static addOrUpdateSetting(e,t,i,n){"__proto__"!==t&&(e[t]||(e[t]={}),e[t][i]=n)}}n.m_settings={}},function(e,t,i){"use strict";i.d(t,"d",(function(){return b})),i.d(t,"h",(function(){return w})),i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return C})),i.d(t,"v",(function(){return I})),i.d(t,"f",(function(){return P})),i.d(t,"e",(function(){return E})),i.d(t,"y",(function(){return r})),i.d(t,"g",(function(){return x})),i.d(t,"k",(function(){return a})),i.d(t,"j",(function(){return k})),i.d(t,"w",(function(){return M})),i.d(t,"o",(function(){return s})),i.d(t,"i",(function(){return o})),i.d(t,"n",(function(){return l})),i.d(t,"m",(function(){return d})),i.d(t,"q",(function(){return c})),i.d(t,"p",(function(){return h})),i.d(t,"s",(function(){return u})),i.d(t,"r",(function(){return m})),i.d(t,"t",(function(){return f})),i.d(t,"l",(function(){return R})),i.d(t,"a",(function(){return p})),i.d(t,"u",(function(){return g})),i.d(t,"x",(function(){return O})),i.d(t,"z",(function(){return D}));var n,r,a,s,o,l,d,c,h,u,m,f,p,g,_=i(20),S=i(0),v=i(6),y=i(18),T=i(14);class b{equals(e){return this.r==e.r&&this.g==e.g&&this.b==e.b&&this.a==e.a}modulateOpacity(e){return new b(this.r,this.g,this.b,this.a*e)}add(e){return new b(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}subtract(e){return new b(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)}multiply(e){return new b(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)}divide(e){return new b(this.r/e.r,this.g/e.g,this.b/e.b,this.a/e.a)}scale(e){return new b(this.r*e,this.g*e,this.b*e,this.a*e)}static Gray(e){return new b(e,e,e,1)}static FromRGBA(e){return new b(e.r,e.g,e.b,e.a)}static FromHSL(e,t,i,n){const r=i<=.5?i+i*t:i+t-i*t,a=2*i-r,[s,o,l]=[1/3,0,-1/3].map(t=>{const i=(e+t)%1;return 6*i<1?a+(r-a)*i*6:2*i<1?r:3*i<2?a+(r-a)*(4-6*i):a});return new b(s,o,l,n)}static InterpolateLinear(e,t,i){return new b(Object(S.h)(Object(S.p)(e.r,t.r,i),0,1),Object(S.h)(Object(S.p)(e.g,t.g,i),0,1),Object(S.h)(Object(S.p)(e.b,t.b,i),0,1),Object(S.h)(Object(S.p)(e.a,t.a,i),0,1))}constructor(e,t,i,n=1){this.r=e,this.g=t,this.b=i,this.a=n}}b.Transparent=new b(0,0,0,0),b.Black=new b(0,0,0,1),b.White=new b(1,1,1,1),b.Red=new b(1,0,0,1),b.Orange=new b(1,.5,0,1),b.Yellow=new b(1,1,0,1),b.Green=new b(0,1,0,1),b.Cyan=new b(0,1,1,1),b.Blue=new b(0,0,1,1),b.Magenta=new b(1,0,1,1);class w{get changeTracker(){return this.m_changeTracker}get id(){return this.m_id}set id(e){this.m_id!=e&&(this.m_changeTracker.notifyChange(),this.m_id=e)}releaseGeneratedResources(){for(const e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}constructor(){this.renderDataMap={},this.m_changeTracker=new y.a}}!function(e){e[e.none=0]="none",e[e.solid=1]="solid",e[e.linearGradient=2]="linearGradient",e[e.radialGradient=3]="radialGradient",e[e.rectangularGradient=4]="rectangularGradient",e[e.pathGradient=5]="pathGradient",e[e.image=6]="image",e[e.pattern=7]="pattern",e[e.background=8]="background",e[e.group=9]="group"}(n||(n={}));class C{get changeTracker(){return this.m_changeTrackers.colorChangeTracker}get version(){return this.m_changeTrackers.colorChangeTracker.version}get alphaChangeTracker(){return this.m_changeTrackers.alphaChangeTracker}get rotateWithShape(){return!0}static IsGradient(e){return n.linearGradient<=e&&e<=n.pathGradient}constructor(){this.m_changeTrackers={colorChangeTracker:new y.a,alphaChangeTracker:new y.a}}}class I extends C{clone(){return new I(this.m_color)}get color(){return this.m_color}set color(e){Object(T.c)(this.changeTracker,this.m_color,e),Object(T.a)(this.alphaChangeTracker,this.m_color.a,e.a),this.m_color=e}getType(){return n.solid}constructor(e){super(),this.m_color=e}}class P{equals(e){return this.position==e.position&&this.color.equals(e.color)}constructor(e,t){this.position=e,this.color=t}}class E extends C{clone(){const e=new E(this.m_type,this.m_gradientStops);return e.m_angle=this.m_angle,e.m_fillFromRect=this.m_fillFromRect,e.m_fillToRect=this.m_fillToRect,e.m_rotateWithShape=this.m_rotateWithShape,e.m_isStretched=this.m_isStretched,e.m_shadeFromTitle=this.m_shadeFromTitle,e.m_isGammaCorrected=this.m_isGammaCorrected,e.m_alphaGamma=this.m_alphaGamma,e}get gradientStops(){return this.m_gradientStops}get angle(){return this.m_angle}get fillFromRect(){return this.m_fillFromRect}get fillToRect(){return this.m_fillToRect}get isStretched(){return this.m_isStretched}get shadeFromTitle(){return this.m_shadeFromTitle}get rotateWithShape(){return this.m_type==n.pathGradient||this.m_rotateWithShape}get isGammaCorrected(){return this.m_isGammaCorrected}get blendBellShape(){return this.m_blendBellShape}get alphaGamma(){return this.m_alphaGamma}set gradientStops(e){Object(T.d)(this.changeTracker,this.m_gradientStops,e),this.m_gradientStops=e.slice(0)}set angle(e){Object(T.a)(this.changeTracker,this.m_angle,e),this.m_angle=e}set fillFromRect(e){Object(T.c)(this.changeTracker,this.m_fillFromRect,e),this.m_fillFromRect=e}set fillToRect(e){Object(T.c)(this.changeTracker,this.m_fillToRect,e),this.m_fillToRect=e}set rotateWithShape(e){Object(T.a)(this.changeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}set isStretched(e){Object(T.a)(this.changeTracker,this.m_isStretched,e),this.m_isStretched=e}set shadeFromTitle(e){Object(T.a)(this.changeTracker,this.m_shadeFromTitle,e),this.m_shadeFromTitle=e}set isGammaCorrected(e){Object(T.a)(this.changeTracker,this.m_isGammaCorrected,e),this.m_isGammaCorrected=e}set blendBellShape(e){Object(T.c)(this.changeTracker,this.m_blendBellShape,e),this.m_blendBellShape=e}set alphaGamma(e){Object(T.a)(this.changeTracker,this.m_alphaGamma,e),this.m_alphaGamma=e}getType(){return this.m_type}constructor(e,t){super(),this.m_type=e,this.m_angle=0,this.m_fillFromRect=new S.d(0,0,1,1),this.m_fillToRect=new S.d(.5,.5,.5,.5),this.m_rotateWithShape=!0,this.m_isStretched=!1,this.m_shadeFromTitle=!1,this.m_gradientStops=t?t.slice(0):[],this.m_isGammaCorrected=!0,this.m_alphaGamma=1,y.a.AddListener(this.changeTracker,this.alphaChangeTracker)}}!function(e){e[e.tile=0]="tile",e[e.tileFlipX=1]="tileFlipX",e[e.tileFlipY=2]="tileFlipY",e[e.tileFlipXY=3]="tileFlipXY",e[e.clamp=4]="clamp"}(r||(r={}));class x extends C{clone(){var e;const t=new x(this.m_image);return t.m_isStretched=this.m_isStretched,t.m_scale=this.m_scale,t.m_offset=this.m_offset,t.m_rotation=this.m_rotation,t.m_rotationCenter=this.m_rotationCenter,t.m_alignment=this.m_alignment,t.m_opacity=this.m_opacity,t.m_rotateWithShape=this.m_rotateWithShape,t.m_pictureEffects=null===(e=this.m_pictureEffects)||void 0===e?void 0:e.clone(),t.m_isAlphaInvariant=this.m_isAlphaInvariant,t.m_fillToPreserveAspectRatio=this.m_fillToPreserveAspectRatio,t}get image(){return this.m_image}get wrapMode(){return this.m_wrapMode}get isStretched(){return this.m_isStretched}get scale(){return this.m_scale}get offset(){return this.m_offset}get rotation(){return this.m_rotation}get rotationCenter(){return this.m_rotationCenter}get alignment(){return this.m_alignment}get opacity(){return this.m_opacity}get rotateWithShape(){return this.m_rotateWithShape}get pictureEffects(){return this.m_pictureEffects}get isAlphaInvariant(){return this.m_isAlphaInvariant}get fillToPreserveAspectRatio(){return this.m_fillToPreserveAspectRatio}set image(e){this.changeTracker.replaceListener(this.m_image,e),this.m_isAlphaInvariant||this.alphaChangeTracker.replaceListener(this.m_image,e),this.m_image=e}set wrapMode(e){Object(T.a)(this.changeTracker,this.m_wrapMode,e),Object(T.a)(this.alphaChangeTracker,this.m_wrapMode,e),this.m_wrapMode=e}set isStretched(e){Object(T.a)(this.changeTracker,this.m_isStretched,e),Object(T.a)(this.alphaChangeTracker,this.m_isStretched,e),this.m_isStretched=e}set scale(e){Object(T.c)(this.changeTracker,this.m_scale,e),Object(T.c)(this.alphaChangeTracker,this.m_scale,e),this.m_scale=e}set offset(e){Object(T.c)(this.changeTracker,this.m_offset,e),Object(T.c)(this.alphaChangeTracker,this.m_offset,e),this.m_offset=e}set rotation(e){Object(T.a)(this.changeTracker,this.m_rotation,e),Object(T.a)(this.alphaChangeTracker,this.m_rotation,e),this.m_rotation=e}set rotationCenter(e){Object(T.c)(this.changeTracker,this.m_rotationCenter,e),Object(T.c)(this.alphaChangeTracker,this.m_rotationCenter,e),this.m_rotationCenter=e}set alignment(e){Object(T.a)(this.changeTracker,this.m_alignment,e),Object(T.a)(this.alphaChangeTracker,this.m_alignment,e),this.m_alignment=e}set opacity(e){Object(T.a)(this.changeTracker,this.m_opacity,e),Object(T.a)(this.alphaChangeTracker,this.m_opacity,e),this.m_opacity=e}set rotateWithShape(e){Object(T.a)(this.changeTracker,this.m_rotateWithShape,e),Object(T.a)(this.alphaChangeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}set pictureEffects(e){this.m_pictureEffects!=e&&(this.changeTracker.replaceListener(this.m_pictureEffects,e),this.alphaChangeTracker.replaceListener(this.m_pictureEffects,e),this.m_pictureEffects=e)}set isAlphaInvariant(e){this.m_isAlphaInvariant!=e&&(e?this.alphaChangeTracker.replaceListener(this.m_image,void 0):this.alphaChangeTracker.replaceListener(void 0,this.m_image),this.m_isAlphaInvariant=e)}set fillToPreserveAspectRatio(e){Object(T.a)(this.changeTracker,this.m_fillToPreserveAspectRatio,e),Object(T.a)(this.alphaChangeTracker,this.m_fillToPreserveAspectRatio,e),this.m_fillToPreserveAspectRatio=e}getType(){return n.image}constructor(e,t){super(),this.m_fillToPreserveAspectRatio=!1,this.m_isAlphaInvariant=!!t,this.changeTracker.replaceListener(void 0,e),this.m_isAlphaInvariant||this.alphaChangeTracker.replaceListener(void 0,e),this.m_image=e,this.m_isStretched=!0,this.m_scale=S.f.One,this.m_offset=S.f.Zero,this.m_rotation=0,this.m_rotationCenter=new S.f(.5,.5),this.m_alignment=S.a.center,this.m_opacity=1,this.m_rotateWithShape=!0}}!function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",e[e.forwardDiagonal=2]="forwardDiagonal",e[e.backwardDiagonal=3]="backwardDiagonal",e[e.cross=4]="cross",e[e.diagonalCross=5]="diagonalCross",e[e.percent05=6]="percent05",e[e.percent10=7]="percent10",e[e.percent20=8]="percent20",e[e.percent25=9]="percent25",e[e.percent30=10]="percent30",e[e.percent40=11]="percent40",e[e.percent50=12]="percent50",e[e.percent60=13]="percent60",e[e.percent70=14]="percent70",e[e.percent75=15]="percent75",e[e.percent80=16]="percent80",e[e.percent90=17]="percent90",e[e.lightDownwardDiagonal=18]="lightDownwardDiagonal",e[e.lightUpwardDiagonal=19]="lightUpwardDiagonal",e[e.darkDownwardDiagonal=20]="darkDownwardDiagonal",e[e.darkUpwardDiagonal=21]="darkUpwardDiagonal",e[e.wideDownwardDiagonal=22]="wideDownwardDiagonal",e[e.wideUpwardDiagonal=23]="wideUpwardDiagonal",e[e.lightVertical=24]="lightVertical",e[e.lightHorizontal=25]="lightHorizontal",e[e.narrowVertical=26]="narrowVertical",e[e.narrowHorizontal=27]="narrowHorizontal",e[e.darkVertical=28]="darkVertical",e[e.darkHorizontal=29]="darkHorizontal",e[e.dashedDownwardDiagonal=30]="dashedDownwardDiagonal",e[e.dashedUpwardDiagonal=31]="dashedUpwardDiagonal",e[e.dashedHorizontal=32]="dashedHorizontal",e[e.dashedVertical=33]="dashedVertical",e[e.smallConfetti=34]="smallConfetti",e[e.largeConfetti=35]="largeConfetti",e[e.zigZag=36]="zigZag",e[e.wave=37]="wave",e[e.diagonalBrick=38]="diagonalBrick",e[e.horizontalBrick=39]="horizontalBrick",e[e.weave=40]="weave",e[e.plaid=41]="plaid",e[e.divot=42]="divot",e[e.dottedGrid=43]="dottedGrid",e[e.dottedDiamond=44]="dottedDiamond",e[e.shingle=45]="shingle",e[e.trellis=46]="trellis",e[e.sphere=47]="sphere",e[e.smallGrid=48]="smallGrid",e[e.smallCheckerBoard=49]="smallCheckerBoard",e[e.largeCheckerBoard=50]="largeCheckerBoard",e[e.outlinedDiamond=51]="outlinedDiamond",e[e.solidDiamond=52]="solidDiamond",e[e.count=53]="count"}(a||(a={}));class k extends C{clone(){return new k(this.m_pattern,this.m_foregroundColor,this.m_backgroundColor)}get pattern(){return this.m_pattern}get foregroundColor(){return this.m_foregroundColor}get backgroundColor(){return this.m_backgroundColor}get rotateWithShape(){return!1}set pattern(e){Object(T.a)(this.changeTracker,this.m_pattern,e),Object(T.a)(this.alphaChangeTracker,this.m_pattern,e),this.m_pattern=e}set foregroundColor(e){Object(T.c)(this.changeTracker,this.m_foregroundColor,e),Object(T.a)(this.changeTracker,this.m_foregroundColor.a,e.a),this.m_foregroundColor=e}set backgroundColor(e){Object(T.c)(this.changeTracker,this.m_backgroundColor,e),Object(T.a)(this.changeTracker,this.m_backgroundColor.a,e.a),this.m_backgroundColor=e}getType(){return n.pattern}constructor(e,t,i){super(),this.m_pattern=e,this.m_foregroundColor=t,this.m_backgroundColor=i}}class M extends C{clone(){return new M(this.m_type)}getType(){return this.m_type}constructor(e){super(),this.m_type=e,e!=n.background&&e!=n.group&&v.a.Error(592520774,"SpecialBrush must be background or group")}}!function(e){e[e.solid=0]="solid",e[e.sysDash=1]="sysDash",e[e.sysDot=2]="sysDot",e[e.sysDashDot=3]="sysDashDot",e[e.sysDashDotDot=4]="sysDashDotDot",e[e.dot=5]="dot",e[e.dash=6]="dash",e[e.longDash=7]="longDash",e[e.dashDot=8]="dashDot",e[e.longDashDot=9]="longDashDot",e[e.longDashDotDot=10]="longDashDotDot"}(s||(s={})),function(e){e[e.bevel=0]="bevel",e[e.miter=1]="miter",e[e.round=2]="round",e[e.miterOrBevel=3]="miterOrBevel"}(o||(o={})),function(e){e[e.simple=0]="simple",e[e.double=1]="double",e[e.thickThin=2]="thickThin",e[e.thinThick=3]="thinThick",e[e.triple=4]="triple"}(l||(l={})),function(e){e[e.center=0]="center",e[e.in=1]="in",e[e.out=2]="out"}(d||(d={})),function(e){e[e.none=0]="none",e[e.triangle=1]="triangle",e[e.stealth=2]="stealth",e[e.diamond=3]="diamond",e[e.oval=4]="oval",e[e.arrow=5]="arrow"}(c||(c={})),function(e){e[e.round=0]="round",e[e.square=1]="square",e[e.capFlat=2]="capFlat"}(h||(h={})),function(e){e[e.narrow=0]="narrow",e[e.medium=1]="medium",e[e.wide=2]="wide"}(u||(u={})),function(e){e[e.short=0]="short",e[e.medium=1]="medium",e[e.long=2]="long"}(m||(m={}));class A{constructor(e,t,i,n,r){this.widthMin=e,this.end=t,this.cap=i,this.width=n,this.length=r}}!function(e){e[e.ball=0]="ball",e[e.square=1]="square"}(f||(f={}));class R{clone(){const e=new R(this.m_lineWidth);return e.m_lineJoin=this.m_lineJoin,e.m_miterLimit=this.m_miterLimit,e.m_dashType=this.m_dashType,e.m_compoundType=this.m_compoundType,e.m_alignment=this.m_alignment,e.m_useRoundDash=this.m_useRoundDash,e}get changeTracker(){return this.m_changeTracker}get version(){return this.m_changeTracker.version}get lineWidth(){return this.m_lineWidth?this.m_lineWidth:this.m_lineHeight?this.m_lineHeight:0}get adjustedLineWidth(){return Math.max(_.w,this.lineWidth)}get adjustedLineWidthForArrowHead(){return Math.max(_.x,this.lineWidth)}get lineHeight(){return this.m_lineHeight?this.m_lineHeight:this.m_lineWidth?this.m_lineWidth:0}get tipScale(){return this.m_lineWidth&&this.m_lineHeight?new S.f(1,this.m_lineHeight/this.m_lineWidth):S.f.One}get lineJoin(){return this.m_lineJoin}get miterLimit(){return this.m_miterLimit}get dashType(){return this.m_dashType}get useRoundDash(){return this.m_useRoundDash}get dashOffset(){return null==this.m_dashOffset?0:this.m_dashOffset}get compoundType(){return this.m_compoundType}get alignment(){return this.m_alignment}get tipType(){return null==this.m_tipType?f.ball:this.m_tipType}set lineWidth(e){Object(T.a)(this.changeTracker,this.m_lineWidth,e),this.m_lineWidth=e}set lineHeight(e){Object(T.a)(this.changeTracker,this.m_lineHeight,e),this.m_lineHeight=e}set lineJoin(e){Object(T.a)(this.changeTracker,this.m_lineJoin,e),this.m_lineJoin=e}set miterLimit(e){Object(T.a)(this.changeTracker,this.m_miterLimit,e),this.m_miterLimit=e}set dashType(e){Object(T.a)(this.changeTracker,this.m_dashType,e),this.m_dashType=e}set useRoundDash(e){Object(T.a)(this.changeTracker,this.m_useRoundDash,e),this.m_useRoundDash=e}set dashOffset(e){Object(T.a)(this.changeTracker,this.m_dashOffset,e),this.m_dashOffset=e}set compoundType(e){Object(T.a)(this.changeTracker,this.m_compoundType,e),this.m_compoundType=e}set alignment(e){Object(T.a)(this.changeTracker,this.m_alignment,e),this.m_alignment=e}set tipType(e){Object(T.a)(this.changeTracker,this.m_tipType,e),this.m_tipType=e}constructor(e=0,t=o.round,i=8){this.headEnd=new A(0,c.none,h.round,u.medium,m.medium),this.tailEnd=new A(0,c.none,h.round,u.medium,m.medium),this.m_changeTracker=new y.a,this.m_lineWidth=e,this.m_lineJoin=t,this.m_miterLimit=i,this.m_dashType=s.solid,this.m_compoundType=l.simple,this.m_alignment=d.center,this.m_useRoundDash=!1}}!function(e){e[e.normal=0]="normal",e[e.darken=1]="darken",e[e.exclusion=2]="exclusion",e[e.cutout=3]="cutout",e[e.add=4]="add",e[e.multiply=5]="multiply",e[e.simulateOverlay=6]="simulateOverlay"}(p||(p={})),function(e){e[e.pictureOverFill=0]="pictureOverFill",e[e.fillMaskedOverPicture=1]="fillMaskedOverPicture",e[e.fillMaskedByPicture=2]="fillMaskedByPicture"}(g||(g={}));class O{clone(){const e=new O;return e.fillBrush=this.m_fillBrush?this.m_fillBrush.clone():void 0,e.lineBrush=this.m_lineBrush?this.m_lineBrush.clone():void 0,e.pictureBrush=this.m_pictureBrush?this.m_pictureBrush.clone():void 0,e.pictureEffects=this.m_pictureEffects?this.m_pictureEffects.clone():void 0,e.m_pictureOverflow=this.m_pictureOverflow,e.pen=this.m_pen.clone(),e.blendingMode=this.m_blendingMode,e.m_hitTransparentFill=this.m_hitTransparentFill,e.m_hitTestSlop=this.m_hitTestSlop,e.m_pictureFillMode=this.m_pictureFillMode,e}get changeTracker(){return this.m_changeTracker}get alphaChangeTracker(){return this.m_alphaChangeTracker}get penChangeTracker(){return this.m_penChangeTracker}get version(){return this.m_changeTracker.version}get fillBrush(){return this.m_fillBrush}get lineBrush(){return this.m_lineBrush}get pictureBrush(){return this.m_pictureBrush}get pictureEffects(){return this.m_pictureEffects}get pictureOverflow(){return this.m_pictureOverflow||0}get pen(){return this.m_pen}get hasLine(){return null!=this.m_lineBrush}get blendingMode(){return this.m_blendingMode}get hitTransparentFill(){return!!this.m_hitTransparentFill}get hitTestSlop(){return this.m_hitTestSlop}get pictureFillMode(){return this.m_pictureFillMode}set fillBrush(e){F(this.m_fillChangeTrackers.colorChangeTracker,this.m_fillChangeTrackers.alphaChangeTracker,this.m_fillBrush,e),this.m_fillBrush=e}set lineBrush(e){F(this.m_lineChangeTrackers.colorChangeTracker,this.m_lineChangeTrackers.alphaChangeTracker,this.m_lineBrush,e),this.m_lineBrush=e}set pictureBrush(e){F(this.m_pictureChangeTrackers.colorChangeTracker,this.m_pictureChangeTrackers.alphaChangeTracker,this.m_pictureBrush,e),this.m_pictureBrush=e}set pictureEffects(e){this.m_pictureEffects!=e&&(this.changeTracker.replaceListener(this.m_pictureEffects,e),this.m_pictureEffects=e)}set pictureOverflow(e){Object(T.a)(this.changeTracker,this.m_pictureOverflow,e),this.m_pictureOverflow=e}set pen(e){this.m_penChangeTracker.replaceListener(this.m_pen,e),this.m_pen=e}set blendingMode(e){Object(T.a)(this.changeTracker,this.m_blendingMode,e),this.m_blendingMode=e}set hitTransparentFill(e){Object(T.a)(this.changeTracker,this.m_hitTransparentFill,e),this.m_hitTransparentFill=e}set hitTestSlop(e){this.m_hitTestSlop!=e&&this.changeTracker.notifyChange(),this.m_hitTestSlop=e}set pictureFillMode(e){Object(T.a)(this.changeTracker,this.m_pictureFillMode,e),this.m_pictureFillMode=e}getBrushImages(){const e=D(this.fillBrush);return e.push(...D(this.lineBrush)),e.push(...D(this.pictureBrush)),e}constructor(e,t,i=new R,n=p.normal){this.m_changeTracker=new y.a,this.m_alphaChangeTracker=new y.a,this.m_penChangeTracker=new y.a,this.m_fillChangeTrackers={colorChangeTracker:new y.a,alphaChangeTracker:new y.a},this.m_lineChangeTrackers={colorChangeTracker:new y.a,alphaChangeTracker:new y.a},this.m_pictureChangeTrackers={colorChangeTracker:new y.a,alphaChangeTracker:new y.a},y.a.AddListener(this.m_fillChangeTrackers.colorChangeTracker,this.m_changeTracker),y.a.AddListener(this.m_lineChangeTrackers.colorChangeTracker,this.m_changeTracker),y.a.AddListener(this.m_pictureChangeTrackers.colorChangeTracker,this.m_changeTracker),y.a.AddListener(this.m_fillChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),y.a.AddListener(this.m_lineChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),y.a.AddListener(this.m_pictureChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),y.a.AddListener(this.m_penChangeTracker,this.m_changeTracker),this.m_pen=i,this.fillBrush=e,this.lineBrush=t,this.m_blendingMode=n,this.m_penChangeTracker.replaceListener(void 0,i)}}function F(e,t,i,n){i!=n&&(i&&(y.a.RemoveListener(i.changeTracker,e),y.a.RemoveListener(i.alphaChangeTracker,t)),n&&(y.a.AddListener(n.changeTracker,e),y.a.AddListener(n.alphaChangeTracker,t)))}function D(e){const t=[];if(e&&e.getType()==n.image){const i=e;i.image&&t.push(i.image)}return t}},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint"}(n||(n={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22);n.__exportStar(i(201),t),n.__exportStar(i(202),t)},function(e,t,i){"use strict";i.d(t,"g",(function(){return n})),i.d(t,"k",(function(){return r})),i.d(t,"i",(function(){return a})),i.d(t,"h",(function(){return s})),i.d(t,"e",(function(){return b})),i.d(t,"f",(function(){return w})),i.d(t,"j",(function(){return C})),i.d(t,"d",(function(){return I})),i.d(t,"n",(function(){return P})),i.d(t,"m",(function(){return E})),i.d(t,"s",(function(){return x})),i.d(t,"q",(function(){return k})),i.d(t,"b",(function(){return o})),i.d(t,"p",(function(){return M})),i.d(t,"o",(function(){return R})),i.d(t,"r",(function(){return O})),i.d(t,"a",(function(){return F})),i.d(t,"c",(function(){return D})),i.d(t,"t",(function(){return L})),i.d(t,"l",(function(){return B}));var n,r,a,s,o,l=i(0),d=i(25),c=i(90),h=i(68),u=i(2),m=i(15),f=i(18),p=i(6),g=i(91),_=i(14),S=i(20),v=i(132),y=i(104),T=i(137);!function(e){e[e.unknown=0]="unknown",e[e.shape=1]="shape",e[e.group=2]="group"}(n||(n={})),function(e){e[e.unknown=0]="unknown",e[e.background=1]="background",e[e.titlePlaceholder=2]="titlePlaceholder",e[e.text=3]="text",e[e.textImageNotLocal=4]="textImageNotLocal"}(r||(r={})),function(e){e[e.alternate=0]="alternate",e[e.winding=1]="winding"}(a||(a={})),function(e){e[e.fragment=0]="fragment",e[e.union=1]="union"}(s||(s={}));class b{constructor(e,t){this.transform=e,this.opacity=null==t?void 0:t.opacity,this.colorMatrix=null==t?void 0:t.colorMatrix,this.colorOffset=null==t?void 0:t.colorOffset,this.colorize=null==t?void 0:t.colorize,this.groupIndex=null==t?void 0:t.groupIndex}}b.DefaultArray=[new b(l.c.Identity)];class w{cloneItemData(e){var t,i;e.effects=this.m_effects.clone(),e.m_transform=this.m_transform,e.fade=this.m_fade?this.m_fade.clone():void 0,e.m_animationTransform=this.m_animationTransform,e.m_fillBoundsOverride=this.m_fillBoundsOverride,e.m_effectsBoundsOverride=this.m_effectsBoundsOverride,e.m_scene3D=this.m_scene3D,e.m_isHidden=this.m_isHidden,e.m_isHitTestHidden=this.m_isHitTestHidden,e.m_instanceOffsets=null===(t=this.m_instanceOffsets)||void 0===t?void 0:t.slice(0),e.m_instances=null===(i=this.m_instances)||void 0===i?void 0:i.slice(0),e.m_clipBounds=this.m_clipBounds,e.clientData=this.clientData}get changeTracker(){return this.m_changeTracker}get animationChangeTracker(){return this.m_animationChangeTracker}get alphaTracker(){return this.m_alphaTracker}notifyChange(){this.m_changeTracker.notifyChange()}get version(){return this.m_changeTracker.version}get effects(){return this.m_effects}get transform(){return this.m_transform}get isHidden(){return this.m_isHidden}get isHitTestHidden(){return this.m_isHitTestHidden}get instanceOffsets(){return this.m_instanceOffsets}get instances(){return this.m_instances}get fade(){return this.m_fade}get animationTransform(){return this.m_animationTransform}get fillBoundsOverride(){return this.m_fillBoundsOverride}get effectsBoundsOverride(){return this.m_effectsBoundsOverride}get scene3D(){return this.m_scene3D}get clipBounds(){return this.m_clipBounds}set effects(e){this.m_changeTracker.replaceListener(this.m_effects,e),this.m_effects&&f.a.RemoveListener(this.m_effects.animationChangeTracker,this.m_animationChangeTracker),e&&f.a.AddListener(e.animationChangeTracker,this.m_animationChangeTracker),this.m_effects=e}set transform(e){this.m_transform.equals(e)||(this.onTransformChanged(this.m_transform,e),this.notifyChange(),this.m_transform=e)}set isHidden(e){Object(_.a)(this.m_changeTracker,this.m_isHidden,e),this.m_isHidden=e}set isHitTestHidden(e){Object(_.a)(this.m_changeTracker,this.m_isHitTestHidden,e),this.m_isHitTestHidden=e}set instanceOffsets(e){this.m_instanceOffsets=e?e.slice(0):void 0,this.m_instances=e?e.map(e=>new b(l.c.Translation2D(e))):void 0}set instances(e){this.m_instances=e?e.slice(0):void 0}set fade(e){this.m_animationChangeTracker.replaceListener(this.m_fade,e),this.m_fade=e}set animationTransform(e){Object(_.c)(this.m_animationChangeTracker,this.m_animationTransform,e),this.m_animationTransform=e}set fillBoundsOverride(e){Object(_.c)(this.m_changeTracker,this.m_fillBoundsOverride,e),this.m_fillBoundsOverride=e}set effectsBoundsOverride(e){Object(_.c)(this.m_changeTracker,this.m_effectsBoundsOverride,e),this.m_effectsBoundsOverride=e}set scene3D(e){this.m_scene3D!=e&&(this.notifyChange(),this.m_scene3D=e,this.clearCache())}set clipBounds(e){Object(_.c)(this.changeTracker,this.m_clipBounds,e),Object(_.c)(this.alphaTracker,this.m_clipBounds,e),this.m_clipBounds=e}getBounds(e=!0,t=!0,i=!0,n){if(this.effects.textureEffect){const r=M(this,t,i?o.all:o.none,i?o.all:o.none,this.transform.toInverseMatrix3().multiply(l.c.Scale2D(this.transform.scale))),a=Object(T.b)(this);if(r&&a){const t=new l.e(r.center.transformPoint(this.transform).negate(),l.f.One,-this.transform.rotation,r.size.scale(.5)),i={logicalCenter:a.center.transformPoint(this.transform).transformPoint(t),logicalSize:a.size.multiply(this.transform.scale),physicalCenter:r.size.scale(.5),physicalSize:r.size,rotation:0,flipX:!1,flipY:!1},s=this.effects.textureEffect.getSizeAndLocation(r.size,i),o=new l.f(8,8),d=s.location.physicalSize.divide(s.location.logicalSize).multiply(a.size).divide(this.transform.scale).add(o),c=s.location.physicalCenter.subtract(s.location.logicalCenter).add(a.center),h=null==n?void 0:n.toMatrix3(),u=e?this.animationTransform:void 0,m=h&&u?h.multiply(u):h||u,f=m?this.transform.toMatrix3().multiply(m):this.transform.toMatrix3();return l.d.FromSizeAndCenter(d,c).transformedBounds(f)}}return M(this,t,i?o.all:o.none,i?o.all:o.none,null==n?void 0:n.toMatrix3(),!0,void 0,e)}onTransformChanged(e,t){}clearCache(){for(const e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}releaseGeneratedResources(){this.clearCache();const e=this.getBrushImages();for(let t of e)t.releaseGeneratedResources()}constructor(e=new h.a,t=l.e.Identity,i){this.m_animationChangeTracker=new f.a,this.renderDataMap={},this.m_changeTracker=new f.a(i),this.m_alphaTracker=new f.a(i),this.m_changeTracker.replaceListener(void 0,e),this.m_alphaTracker.replaceListener(void 0,e),f.a.AddListener(null==e?void 0:e.animationChangeTracker,this.m_animationChangeTracker),this.m_effects=e,this.m_isHidden=!1,this.m_isHitTestHidden=!1,this.m_transform=t,null===g.a||void 0===g.a||g.a.register(this,this.renderDataMap)}}class C extends w{clone(){let e=new C;return e.paths=this.m_paths?this.m_paths.slice(0):void 0,e.m_overlapMode=this.m_overlapMode,e.m_mergeMode=this.m_mergeMode,e.style=this.m_style.clone(),e.m_shape3D=this.m_shape3D,e.text=this.m_text?this.m_text.clone():void 0,e.m_textEffectMetrics=this.m_textEffectMetrics,e.m_role=this.m_role,this.cloneItemData(e),e}static CreateRectangle(e,t=new u.x,i=new h.a,n=l.e.Identity){return new C([m.d.CreateFromRect(e)],t,i,n)}get paths(){return this.m_paths}get incrementalPath(){return this.m_incrementalPath}get overlapMode(){return this.m_overlapMode}get mergeMode(){return this.m_mergeMode}get style(){return this.m_style}get shape3D(){return this.m_shape3D}get text(){return this.m_text}get textEffectMetrics(){return this.m_textEffectMetrics}get role(){return this.m_role}set paths(e){this.clearPathCache(),this.notifyGeometryChange(),this.m_paths=null==e?void 0:e.slice(0)}set incrementalPath(e){this.changeTracker.replaceListener(this.m_incrementalPath,e),this.alphaTracker.replaceListener(this.m_incrementalPath,e),this.m_incrementalPath=e}set overlapMode(e){this.m_overlapMode!=e&&(this.notifyGeometryChange(),this.m_overlapMode=e)}set mergeMode(e){this.m_mergeMode!=e&&(this.notifyGeometryChange(),this.m_mergeMode=e)}set style(e){this.m_style!=e&&(f.a.RemoveListener(this.m_style.penChangeTracker,this.m_geometryTracker),f.a.AddListener(e.penChangeTracker,this.m_geometryTracker),f.a.RemoveListener(this.m_style.alphaChangeTracker,this.alphaTracker),f.a.AddListener(e.alphaChangeTracker,this.alphaTracker),this.changeTracker.replaceListener(this.m_style,e),this.m_style=e)}set shape3D(e){this.m_shape3D!=e&&(this.notifyGeometryChange(),this.m_shape3D=e)}set role(e){this.m_role!=e&&(this.notifyChange(),this.m_geometryTracker.notifyChange(),this.m_role=e)}set text(e){this.m_text!=e&&(this.m_text&&(this.m_text.cache&&this.m_text.cache.clearCache(),f.a.RemoveListener(this.m_text.changeTracker,this.changeTracker),f.a.RemoveListener(this.m_text.changeTracker,this.alphaTracker),f.a.RemoveListener(this.m_text.animationChangeTracker,this.animationChangeTracker)),this.m_text=e,this.m_text&&(f.a.AddListener(this.m_text.changeTracker,this.changeTracker),f.a.AddListener(this.m_text.changeTracker,this.alphaTracker),f.a.AddListener(this.m_text.animationChangeTracker,this.animationChangeTracker)))}set textEffectMetrics(e){Object(_.c)(this.changeTracker,this.m_textEffectMetrics,e),Object(_.c)(this.alphaTracker,this.m_textEffectMetrics,e),this.m_textEffectMetrics=e}onTransformChanged(e,t){e.scale.equals(t.scale)||this.m_geometryTracker.notifyChange()}clearCache(){super.clearCache(),this.text&&this.text.cache&&(this.text.cache.clearCache(),this.text.cache=void 0),this.clearPathCache(),this.clearBoundsCache()}clearPathCache(){for(let e of this.paths||[])for(let t in e.renderDataMap)e.renderDataMap[t].releaseGeneratedResources()}clearBoundsCache(){this.shapeBoundsCache=void 0}get geometryTracker(){return this.m_geometryTracker}notifyGeometryChange(){this.notifyChange(),this.m_geometryTracker.notifyChange(),this.clearBoundsCache()}getBrushImages(){const e=this.style.getBrushImages();return this.text&&e.push(...this.text.getBrushImages()),e}isSolidRectGeometry(){return!(!this.m_paths||1!=this.m_paths.length||!this.m_paths[0].isUntransformedRect||this.m_paths[0].fillMode!=m.e.normal||this.m_paths[0].transform instanceof l.c||this.m_paths[0].transform instanceof l.e&&0!=this.m_paths[0].transform.rotation)}isSolidRect(){return!(!this.isSolidRectGeometry()||this.style.hasLine||this.style.pictureOverflow>0||this.text&&this.text.renderMode!=d.k.TextInFrontOfShape)}hasSmallDetails(){return this.role==r.text||this.style.hasLine&&this.style.pen.lineWidth<3||this.m_paths&&this.m_paths.some(e=>e.hasPressureInfo)}getType(){return n.shape}constructor(e,t=new u.x,i=new h.a,n=l.e.Identity){super(i,n),this.m_role=r.unknown,this.m_geometryTracker=new f.a,this.m_paths=e,this.m_overlapMode=a.alternate,this.m_mergeMode=s.fragment,this.changeTracker.replaceListener(void 0,t),f.a.AddListener(t.penChangeTracker,this.m_geometryTracker),f.a.AddListener(t.alphaChangeTracker,this.alphaTracker),f.a.AddListener(this.m_geometryTracker,this.alphaTracker),this.m_style=t}}class I extends w{clone(){const e=new I;for(const t of this.m_items.elements)e.items.push(t.clone());return e.groupFillBrush=this.m_groupFillBrush?this.m_groupFillBrush.clone():void 0,e.m_isDocumentShape=this.m_isDocumentShape,this.cloneItemData(e),e}get items(){return this.m_items}get groupFillBrush(){return this.m_groupFillBrush}get isDocumentShape(){return this.m_isDocumentShape}get opacity(){return this.m_opacity}set groupFillBrush(e){this.m_groupFillBrush=e}set isDocumentShape(e){this.m_isDocumentShape=e}set items(e){this.setItems(e)}set opacity(e){this.m_opacity!=e&&(this.notifyChange(),this.m_opacity=e)}setItems(e){const t=e instanceof f.b?e:new f.b(e);this.changeTracker.replaceListener(this.m_items,t),this.alphaTracker.replaceListener(this.m_items,t),this.m_items=t}clearCache(){super.clearCache();for(let e=0;e<this.m_items.length;e++)this.m_items.getAt(e).clearCache()}getBrushImages(){const e=Object(u.z)(this.groupFillBrush);for(const t of this.m_items.elements)e.push(...t.getBrushImages());return e}getType(){return n.group}constructor(e,t=new h.a,i=l.e.Identity,n){const r=e instanceof f.b?e:new f.b(e,n||S.m);super(t,i,n?()=>"":r.deferTracking?()=>r.getHash():void 0),this.changeTracker.replaceListener(void 0,r),this.alphaTracker.replaceListener(void 0,r),this.m_items=r,this.m_opacity=1}}function P(e,t){if(!e)return!0;if(e.getType()==n.shape){const i=e;if(t(i),i.text&&i.text.cache){for(const e of i.text.cache.getTextShapes())if(!P(e,t))return!1;for(const e of i.text.cache.getSelectionShapes()||[])if(!P(e,t))return!1}}else{if(e.getType()!=n.group)throw p.a.Error(591525086,"Unknown Item type");{const i=e;for(const e of i.items.elements)if(!P(e,t))return!1}}return!0}function E(e,t){P(e,e=>{for(const i of e.paths||[])if(!t(i))return!1;return!0})}function x(e){return e.alignment==u.m.in?-1:e.alignment==u.m.out?1:0}function k(e,t,i){if(e.incrementalPath)return i?e.incrementalPath.bounds.transformedBounds(i):e.incrementalPath.bounds;e.shapeBoundsCache&&e.shapeBoundsCache.geometryVersion==e.geometryTracker.version||(e.shapeBoundsCache={geometryVersion:e.geometryTracker.version});let n=0;t&&e.style.hasLine&&(n=e.style.pen.adjustedLineWidth*(.5+Math.abs(Math.max(x(e.style.pen))))),t&&e.shape3D&&e.shape3D.adjustedContourWidth>0&&(n+=.5*e.shape3D.adjustedContourWidth);const r=!i||i.isSimpleScaleTranslationOnly();let a=n?e.shapeBoundsCache.pathsBoundsWithLine:e.shapeBoundsCache.pathsBounds;if(!a&&!n&&r&&e.paths&&(a=e.shapeBoundsCache.pathsBounds=Object(c.c)(e.paths)),a){if(!i)return a;if(r)return a.multiply(i.getSimpleScale()).translate(i.getSimpleTranslation())}let s=n?e.shapeBoundsCache.pathsBoundsContributorsWithLine:e.shapeBoundsCache.pathsBoundsContributors;if(!s){const t=l.c.Scale2D(e.transform.scale);s=[],e.paths&&Object(c.a)(e.paths,n,e.style,t,null!=e.shape3D,s),n?e.shapeBoundsCache.pathsBoundsContributorsWithLine=s:e.shapeBoundsCache.pathsBoundsContributors=s}const o=l.c.Scale2D(e.transform.scale.inverse()),d=i?o.multiply(i):o;let h=void 0;for(const e of s||[]){const t=Object(c.b)(e,d);h=l.d.UnionRect(h,t)}if(h&&r){const n=null==i?void 0:i.getSimpleScale();if(!i||n&&Math.abs(n.x)>l.i&&Math.abs(n.y)>l.i){const n=i?h.translate(i.getSimpleTranslation().negate()).multiply(i.getSimpleScale().inverse()):h;t?e.shapeBoundsCache.pathsBoundsWithLine=n:e.shapeBoundsCache.pathsBounds=n}}return h}function M(e,t,i,a,s,d=!0,c,h=!1){let u=h?e.animationTransform:void 0,m=s&&u?s.multiply(u):s||u;const f=m?e.transform.toMatrix3().multiply(m):e.transform.toMatrix3();let p=void 0;if(e.getType()==n.shape){const i=e;if(c||(p=k(i,!0,f)),i.text&&t&&(d||c)){const n=new l.e(l.f.Zero,l.f.One,e.transform.rotation,e.transform.translation),r=i.text.hasAnimationProps()?s:m,a=r?n.toMatrix3().multiply(r):n.toMatrix3(),o=B(i);if(o)for(let e of o.textShapes)c&&e.textRange&&!c.intersects(e.textRange)||(p=l.d.UnionRect(p,e.getBounds(h,t,!0,a)))}}else if(e.getType()==n.group&&!c&&d){const i=e;for(let e=0;e<i.items.length;e++){const n=i.items.getAt(e),s=n instanceof C&&n.role==r.text;!t&&s||(p=l.d.UnionRect(p,M(n,t,a,a,f)))}}if(!c){let n,r;const s=i&o.replicate&&e.effects&&e.effects.replicate,d=i&o.border&&e.effects&&e.effects.border&&e.effects.border.radius,c=i&o.glow&&e.effects&&e.effects.glow&&e.effects.glow.radius,h=i&o.shadow&&e.effects&&e.effects.shadow,u=i&o.reflection&&e.effects&&e.effects.reflection;if((s||d||c||h||u)&&(r=m?M(e,t,i,a):p),(h||u)&&(n=e.effectsBoundsOverride?e.effectsBoundsOverride:M(e,!1,o.none,o.border|o.glow)),p&&r&&i&o.border&&e.effects&&e.effects.border&&e.effects.border.radius&&(r=r.inflate(e.effects.border.radius),p=p.inflate(e.effects.border.radius)),p&&r&&i&o.replicate&&e.effects.replicate){var g;const t=M(e,!0,o.none,o.none),i=(null!==(g=e.effectsBoundsOverride)&&void 0!==g?g:e instanceof C)?k(e,!1,e.transform.toMatrix3()):t;if(i&&t){const n=Object(y.b)(i,t,e.effects.replicate.bottomSlices||[]),a=Object(y.b)(i,t,e.effects.replicate.topSlices||[]),s=l.d.UnionRect(n,a);r=l.d.UnionRect(r,s),p=l.d.UnionRect(p,m?null==s?void 0:s.transformedBounds(m):s)}}if(p&&r&&i&o.glow&&e.effects&&e.effects.glow&&e.effects.glow.radius&&(r=r.inflate(2*e.effects.glow.radius),p=p.inflate(2*e.effects.glow.radius)),(h||u)&&!t&&e instanceof C&&e.text){const t=M(e,!0,i,a);t&&(r=l.d.UnionRect(r,t))}if(p&&r&&n&&i&o.shadow&&e.effects&&e.effects.shadow){const t=R(e.effects.shadow.alignment,n),i=O(e.effects.shadow.angle,e.effects.shadow.distance,e.effects.shadow.scale,e.effects.shadow.skew,t),a=(e.effects.shadow.radius?r.inflate(e.effects.shadow.radius):r).transformedBounds(m?i.multiply(m):i),s=(e.effects.shadow.radius?r.inflate(e.effects.shadow.radius):r).transformedBounds(m?i.multiply(m):i);r=l.d.UnionRect(r,a),p=l.d.UnionRect(p,s)}if(p&&r&&n&&i&o.reflection&&e.effects&&e.effects.reflection){let t=e.effects.reflection,i=n.bottom+e.effects.reflection.distance/2;e instanceof C&&e.textEffectMetrics&&(i-=e.textEffectMetrics.descent);const a=l.c.Translation2D(new l.f(0,-i)).multiply(l.c.Scale2D(new l.f(1,-1))).multiply(l.c.Translation2D(new l.f(0,i))),s=(t.radius?r.inflate(t.radius):r).transformedBounds(a),o=m?(t.radius?r.inflate(t.radius):r).transformedBounds(a.multiply(m)):s;p=l.d.UnionRect(p,o)}}return p}!function(e){e[e.none=0]="none",e[e.glow=1]="glow",e[e.shadow=2]="shadow",e[e.reflection=4]="reflection",e[e.innerShadow=8]="innerShadow",e[e.softEdges=16]="softEdges",e[e.border=32]="border",e[e.replicate=64]="replicate",e[e.all=127]="all"}(o||(o={}));const A=[new l.f(0,0),new l.f(.5,0),new l.f(1,0),new l.f(0,.5),new l.f(.5,.5),new l.f(1,.5),new l.f(0,1),new l.f(.5,1),new l.f(1,1)];function R(e,t){return t?A[e].multiply(t.size).add(t.leftTop):A[e]}function O(e,t,i,n,r){const a=l.c.Translation2D(r.negate()),s=new l.f(t,0).rotate(e).add(r),o=new l.c(i.x,n.y,0,n.x,i.y,0,s.x,s.y,1);return a.multiply(o)}var F;function D(e,t){const i=e.getType();if(i==n.shape){const i=e.style;switch(t){case F.fill:return i.fillBrush;case F.line:return i.lineBrush;case F.picture:return i.pictureBrush}}if(i==n.group&&t==F.fill)return e.groupFillBrush;p.a.Error(591192835,"Invalid item or brush")}function L(e){if(e.isSolidRectGeometry()&&!e.style.hasLine&&!e.effects.hasEffects&&!e.shape3D&&!e.text&&(e.style.fillBrush||e.style.pictureBrush)&&(!e.style.fillBrush||!e.style.pictureBrush)){const t=e.style.fillBrush||e.style.pictureBrush;if(t instanceof u.g&&t.isStretched&&t.scale.equals(l.f.One)&&t.offset.equals(l.f.Zero)&&t.rotateWithShape&&1===t.opacity)return t.image}}function B(e){if(e.text)return e.text.cache||(e.text.cache=new v.a),e.text.cache.update(e.text),e.text.cache}!function(e){e[e.fill=0]="fill",e[e.line=1]="line",e[e.picture=2]="picture"}(F||(F={}))},function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return a})),function(e){e[e.Error=10]="Error",e[e.Info=50]="Info"}(n||(n={})),function(e){e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral"}(r||(r={}));class a{static Error(e,t){return a.s_logger.sendTraceTag(e,r.msoulscat_Wac_BrowserGeneral,n.Error,t),new Error(t+" "+e)}static Message(e,t){a.s_logger.sendTraceTag(e,r.msoulscat_Wac_BrowserGeneral,n.Info,t)}static setLogger(e){e&&(a.s_logger=e)}}a.s_logger={sendTraceTag:(e,t,i,n)=>{console.log(e,n)},shipAssertTag:()=>{},debugAssertTag:()=>{}}},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(n={}))},function(e,t,i){"use strict";var n,r,a,s;i.d(t,"f",(function(){return n})),i.d(t,"i",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"g",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"e",(function(){return l})),i.d(t,"j",(function(){return d})),i.d(t,"b",(function(){return c})),i.d(t,"h",(function(){return h})),i.d(t,"c",(function(){return u})),function(e){e.Failed="Failed",e.SkippedBusy="Skipped_Busy",e.SkippedNewTarget="Skipped_NewTarget"}(n||(n={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(r||(r={})),function(e){e.Hidden="Hidden",e.Black="Black",e.White="White",e.EndOfShow="EndOfShow"}(a||(a={})),function(e){e[e.Normal=0]="Normal",e[e.Loading=1]="Loading"}(s||(s={}));const o={Mouse:"mouse",Touch:"touch",Pinch:"pinch",Scroll:"scroll",KeyboardArrowUp:"keyboardArrowUp",KeyboardArrowDown:"keyboardArrowDown",KeyboardArrowLeft:"keyboardArrowLeft",KeyboardArrowRight:"keyboardArrowRight",KeyboardEscape:"keyboardEscape",KeyboardPlus:"keyboardPlus",KeyboardMinus:"keyboardMinus",CtrlWheel:"ctrlWheel",UIPlus:"uiPlus",UIMinus:"uiMinus",SlideLocationChanged:"slideLocationChanged",Sync:"sync",RoleChanged:"roleChanged",EndOfShow:"endOfShow"},l={Highest:4,High:3,Normal:2,Low:1,Lowest:0};var d,c,h,u;!function(e){e[e.Touch=0]="Touch",e[e.Mouse=1]="Mouse",e[e.Keyboard=2]="Keyboard",e[e.API=3]="API",e[e.AutoAdvance=4]="AutoAdvance"}(d||(d={})),function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(c||(c={})),function(e){e.LoadFailed="LoadFailed",e.GetItemsFailedInvalidResponse="GetItemsFailedInvalidResponse",e.GetItemsRequestFailed="GetItemsRequestFailed",e.GetItemsFailedDownloadFile="GetItemsFailedDownloadFile",e.GetItemsTimeout="GetItemsTimeout",e.ResourceLoaderFailed="ResourceLoaderFailed",e.EnsureSlideFailed="EnsureSlideFailed",e.SetupWebGLContextFailed="SetupWebGLContextFailed",e.RestoreWebGLContextFailed="RestoreWebGLContextFailed",e.SlideVisualizationFailed="SlideVisualizationFailed",e.Unknown="ErrorUnknown",e.FailedToLaunchApp="FailedToLaunchApp",e.PostBootFailed="PostBootFailed",e.SlideViewElementUndefined="SlideViewElementUndefined",e.CurrentSlideLocationUndefined="CurrentSlideLocationUndefined",e.ViewControllerUndefined="ViewControllerUndefined",e.IsHiddenFailed="IsHiddenFailed",e.ServerFailedToDownloadMetadata="ServerFailedToDownloadMetadata"}(h||(h={})),function(e){e.Init="init",e.Next="next",e.Prev="prev",e.GoToFirst="gotoFirst",e.GoToLast="gotoLast",e.ClickTarget="clickTarget",e.GoTo="goto"}(u||(u={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));class n{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const r=new class{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,i,n){this.externalLogger.sendTraceTag(e,t,i,n)}debugAssertTag(e,t,i,n){this.externalLogger.debugAssertTag(e,t,i,n)}shipAssertTag(e,t,i,n){this.externalLogger.shipAssertTag(e,t,i,n)}constructor(){this.externalLogger=new n}};function a(e){if(!e)throw new Error("The 'logger' argument is missing");r.setLogger(e)}},function(e,t,i){"use strict";var n;i.d(t,"c",(function(){return n})),i.d(t,"e",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"f",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return h})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(n={}));var r=i(9),a=i(3),s=i(7);class o{static setVetoUtil(e,t){o.m_sessionMetadata=e,r.a.setLogger(t)}static recordVeto(e,t){if(null==t)return;const i=o.m_vetos.has(e);if(!i){const i={AppMetadata:o.m_sessionMetadata,VetoSource:e,VetoDetail:t};r.a.sendTraceTag(508842071,a.a.msoulscat_Wac_PptSession,s.a.Error,JSON.stringify(i)),o.m_vetos.set(e,t)}this.m_listeners.forEach(n=>{n(e,t,i)})}static getSessionVetos(){return o.m_vetos}static clearState(){o.m_vetos=new Map,o.m_sessionMetadata={}}static registerVetoRecordedListener(e){this.m_listeners.push(e)}static unregisterVetoRecordedListener(e){this.m_listeners=this.m_listeners.filter(t=>t!==e)}}o.m_vetos=new Map,o.m_sessionMetadata={},o.m_listeners=[];class l{static recordUserAction(e){null!=e&&null!=e.actionName&&(r.a.sendTraceTag(508842064,a.a.msoulscat_Wac_PptSession,s.a.Error,`User Action name:${e.actionName}, durationMs:${e.durationMs}, succeeded:${e.succeeded}`),this.m_actions.push(e),this.m_listeners.forEach(t=>{t(e)}))}static getUserActions(){return l.m_actions}static registerUserActionListener(e){this.m_listeners.push(e)}static unregisterUserActionListener(e){this.m_listeners=this.m_listeners.filter(t=>t!==e)}static clearState(){l.m_actions=[],l.m_listeners=[]}}function d(e){if(!e)return e;let t=e;return t.startsWith("urn%3aspo%3")?t="":t.toLowerCase().startsWith("8:orgid:")&&(t=t.substring(8,t.length)),t}l.m_actions=[],l.m_listeners=[];class c{static async init(e,t,i){const n=Date.now().valueOf();r.a.sendTraceTag(508842070,a.a.msoulscat_Wac_PptSession,s.a.Info,"HealthAdapter::init starting"),this.s_health||(this.s_health=await c.createSmallHealth(e,t),i&&c.addOrUpdatePartCDimensions(i),this.s_pillarAdditionsDuringInit.forEach(e=>{this.s_health.addQosPillar(e)}),this.s_additionalDimensionsAddedDuringInit.size>0&&c.addOrUpdatePartCDimensions(this.s_additionalDimensionsAddedDuringInit)),this.s_vetoListener||(this.s_vetoListener=(e,t)=>{c.onVetoRecorded(e,t)},o.registerVetoRecordedListener(this.s_vetoListener),o.getSessionVetos().forEach((e,t)=>{this.onVetoRecorded(t,e)}));const l=Date.now().valueOf()-n;r.a.sendTraceTag(508842069,a.a.msoulscat_Wac_PptSession,s.a.Info,"HealthAdapter::init ending. ElapsedMs: "+l)}static addToQosPillar(e){this.s_health?this.s_health.addQosPillar(e):this.s_pillarAdditionsDuringInit.push(e)}static addOrUpdatePartCDimensions(e){this.s_health?e.forEach((e,t)=>{r.a.sendTraceTag(508842068,a.a.msoulscat_Wac_PptSession,s.a.Info,`HealthAdapter::addOrUpdatePartCDimensions ${t}, ${e}`),this.s_health.addOrUpdatePartCDimension(t,e)}):e.forEach((e,t)=>{r.a.sendTraceTag(508842067,a.a.msoulscat_Wac_PptSession,s.a.Info,`HealthAdapter::addOrUpdatePartCDimensions deferring update until init ${t}, ${e}`),this.s_additionalDimensionsAddedDuringInit.set(t,e)})}static async createSmallHealth(e,t){if(!e.remoteTelemetryUrl)throw new Error("settings.remoteTelemetryUrl is not set");const n=await i.e(0).then(i.bind(null,443)),r={dimensions:t,isHealthEnabled:void 0===e.isHealthEnabled||e.isHealthEnabled,remoteTelemetryUrl:e.remoteTelemetryUrl,heartbeatIntervalMs:void 0!==e.heartbeatIntervalMs?e.heartbeatIntervalMs:this.s_defaultHearbeatIntervalMs,recordPillarToWarmPipelineIntervalMs:void 0!==e.recordQosPillarToWarmPipelineIntervalMs?e.recordQosPillarToWarmPipelineIntervalMs:this.s_defaultRecordQosPillarToWarmPipelineIntervalMs},a=n.HealthFactoryGlobal.getHealthInstance(r);if(!a)throw new Error("Unable to create health object");return a}static onVetoRecorded(e,t){if(this.s_health)try{const i=void 0!==t.errorName?t.errorName.trim():e.trim(),n=void 0!==t.qosVeto?t.qosVeto.trim():e.trim(),r=void 0!==t.isIntentional&&t.isIntentional,a=void 0===t.isInternal||t.isInternal,s=void 0===t.alertOnPillar||t.alertOnPillar,o=void 0!==t.isSessionEndingError&&t.isSessionEndingError,l={};for(const e in t)t.hasOwnProperty(e)&&"errorName"!==e&&"isIntentional"!==e&&"isInternal"!==e&&"alertOnPillar"!==e&&"isSessionEndingError"!==e&&"qosVeto"!==e&&(l[e]=t[e]);this.s_health&&this.s_health.recordQosError(i,[n],r,a,s,o,l)}catch(t){r.a.sendTraceTag(508842066,a.a.msoulscat_Wac_PptSession,s.a.Error,`HealthAdapter hit an exception recording veto: ${e}, ${t.message}`)}}static clear(){r.a.sendTraceTag(508842065,a.a.msoulscat_Wac_PptSession,s.a.Info,"HealthAdapter::clear called"),this.s_vetoListener&&(o.unregisterVetoRecordedListener(this.s_vetoListener),this.s_vetoListener=void 0),this.s_pillarAdditionsDuringInit.length>0&&(this.s_pillarAdditionsDuringInit=[]),this.s_additionalDimensionsAddedDuringInit.size>0&&(this.s_additionalDimensionsAddedDuringInit=new Map),this.s_health&&(this.s_health=void 0)}}c.s_health=void 0,c.s_pillarAdditionsDuringInit=[],c.s_additionalDimensionsAddedDuringInit=new Map,c.s_defaultHearbeatIntervalMs=3e5,c.s_defaultRecordQosPillarToWarmPipelineIntervalMs=864e5;class h{static async init(e,t){if(r.a.sendTraceTag(508842075,a.a.msoulscat_Wac_PptSession,s.a.Info,"OTelJsWrapper::init starting"),!this.s_Telemetry){this.s_Telemetry=await i.e(0).then(i.bind(null,254));const n={alwaysOnMetadata:{name:t.application,platform:"Web",version:t.clientVersion,osVersion:t.osVersion,sessionId:t.session_id,serverDocId:t.serverDocId,audienceGroup:this.getAudienceGroupFromRing(t.ring),browserName:t.browser,browserVersion:t.browserVersion,host:t.host,applicationMode:t.applicationMode,applicationModeExtended:t.applicationModeExtended,ring:t.ring,loggableUserId:t.loggableUserId,loggableUserIdSpace:t.loggableUserIdSpace,uiHost:this.getOtelLoggableUiHost(t.uiHost),appLanguage:t.applicationLcid,datacenter:t.datacenter,omsTenantId:t.tenantId},ulsLogger:e.logger,sendToAria:!0,ariaEndpointTarget:e.ariaEndpointTarget};this.s_Telemetry.setEnabledState(!0),this.s_Telemetry.initializeEventProcessor(n),this.s_Telemetry.registerEventHandler(this.s_Telemetry.processEvent),window.addEventListener("unload",()=>{r.a.sendTraceTag(508842074,a.a.msoulscat_Wac_PptSession,s.a.Info,"Shutting down otel Telemetry"),this.s_Telemetry&&this.s_Telemetry.shutdown()})}this.s_actionListener||(this.s_actionListener=e=>{h.sendUserActionEvent(e)},l.registerUserActionListener(this.s_actionListener),l.getUserActions().forEach(e=>{h.sendUserActionEvent(e)})),r.a.sendTraceTag(508842073,a.a.msoulscat_Wac_PptSession,s.a.Info,"OTelJsWrapper::init completed")}static async sendOtelEvent(e){if(!this.s_Telemetry)throw new Error("OtelJsWrapper not initialized");try{this.s_Telemetry.sendTelemetryEvent(e)}catch(e){r.a.sendTraceTag(508842072,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"Failed to sendTelemetryEvent. Ex: "+e)}}static sendUserActionEvent(e){if(!this.s_Telemetry)return;const t={name:"Office.PowerPoint.Online.UserAction."+e.actionName,dataFields:[{name:"UserAction.Name",string:e.actionName}]};e.durationMs&&t.dataFields.push({name:"Activity.DurationMs",int64:e.durationMs}),e.succeeded&&t.dataFields.push({name:"Activity.Succeeded",bool:e.succeeded}),this.sendOtelEvent(t)}static getOtelLoggableUiHost(e){switch(e){case"MSTeams":case"TeamsAndroid":case"MTRA":case"TeamsiOS":return"teams";default:return e}}static getAudienceGroupFromRing(e){if(!e)return"Automation";switch(e){case"1":return"Dogfood";case"2":return"Microsoft";case"3":case"5":case"6":return"Production";default:return"Automation"}}static reset(){this.s_Telemetry=void 0,this.s_actionListener&&(l.unregisterUserActionListener(this.s_actionListener),this.s_actionListener=void 0)}}h.s_Telemetry=void 0,h.s_actionListener=void 0},function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i(10),r=i(9),a=i(3),s=i(7),o=i(133),l=i(21),d=i(106),c=i(1);class h{static init(e,t,i,n){h.m_userSessionId=e.appSettings.userSessionId;const d=(new o.UAParser).getResult();h.m_sessionConfig={browserName:d.browser.name,browserMajor:d.browser.major,osName:d.os.name,osVersion:d.os.version,uiHost:e.appSettings.uiHost,pkgVersion:t,svmVersion:i,sbVersion:n,browserLCID:navigator.language};const u={appMetadata:{initTime:e.appSettings.initTime,uiHost:e.appSettings.uiHost,serverUrl:e.appSettings.serverUrl,scenario:e.appSettings.scenario,useDocCache:e.appSettings.useDocCache,useSnapDownloadUrl:e.appSettings.useSnapDownloadUrl,userId:e.appSettings.userId,ring:e.appSettings.ring,fileHost:e.appSettings.fileHost},config:h.m_sessionConfig,uaStr:d.ua,pkgVersion:t,svmVersion:i,sbVersion:n};r.a.sendTraceTag(506856898,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,JSON.stringify(e));const m=e.slideShowCoreSettings.settings,f=c.a.readStringOrDefault("SSSessionSettingsToLogAsWarning","");if(m)for(const e in m)for(const t in m[e]){const i=f.indexOf(t+";")>=0;r.a.sendTraceTag(506856897,a.a.msoulscat_Wac_PptSlideshow,i?s.a.Warning:s.a.Info,`${e}.${t}:${m[e][t]}`)}if(e.slideShowCoreSettings.disabledChangeGates)for(const t of e.slideShowCoreSettings.disabledChangeGates.split(";"))r.a.sendTraceTag(506856896,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,t);r.a.sendTraceTag(595641932,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,l.c.getLogString("SSCoreConstructor",u))}static logSessionStart(e){h.m_sessionStats={};const t={userSessionId:h.m_userSessionId,startFromTime:e,...h.getSessionConfig()};for(const e in h.m_sessionStats)t[e]=h.m_sessionStats[e];r.a.sendTraceTag(594137685,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,l.c.getLogString("sessionStart",t)),h.startFrom=e}static logSessionEnd(e){const t={sessionId:h.m_userSessionId,startFromTime:h.startFrom,exitFromTime:e||performance.now(),vetos:[...n.e.getSessionVetos().keys()]};d.a.logInkActivity("SessionEnd");for(const e in h.m_sessionStats)t[e]=h.m_sessionStats[e];if(h.startFrom=0,r.a.sendTraceTag(594650329,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,l.c.getLogString("sessionEnd",t)),Object.keys(h.m_sessionTransitionStats).length>0){const e={sessionId:h.m_userSessionId,startFromTime:h.startFrom,TransitionUsageData:h.m_sessionTransitionStats};r.a.sendTraceTag(506856867,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,l.c.getLogString("transitionLogObject",e))}}static recordSessionTransitionStats(e){if(e.effectId){if(h.m_sessionTransitionStats[e.effectId]){const t=h.m_sessionTransitionStats[e.effectId].count;h.m_sessionTransitionStats[e.effectId].count=t+1}else h.m_sessionTransitionStats[e.effectId]={count:1,isSupported:e.isSupported};e.metadata&&Object.keys(e.metadata).length>0&&(h.m_sessionTransitionStats[e.effectId].hasOwnProperty("metadata")?h.m_sessionTransitionStats[e.effectId].metadata.push(e.metadata):h.m_sessionTransitionStats[e.effectId].metadata=[e.metadata]),60!==e.effectId||h.getSessionStats("hasMorph")||h.recordSessionStats({hasMorph:!0})}}static recordSessionStats(e){const t={sessionId:h.m_userSessionId,startFromTime:h.startFrom};r.a.sendTraceTag(506856866,a.a.msoulscat_Wac_PptSlideshow,e.hasOwnProperty("errorName")?s.a.Warning:s.a.Info,"SessionUtils::recordSessionStats: "+JSON.stringify({...e,...t}));for(const t of Object.keys(e))"metadata"===t?(h.m_sessionStats.hasOwnProperty(t)||(h.m_sessionStats[t]=[]),h.m_sessionStats[t].includes(e[t])||(h.m_sessionStats[t]=h.m_sessionStats[t].concat(e[t]))):"errorName"===t?n.e.recordVeto("ACE",{msg:e[t]}):h.m_sessionStats[t]=e[t]}static getSessionStats(e){return h.m_sessionStats[e]}static getSessionConfig(){return h.m_sessionConfig}static performanceNowTrimmed(){return Math.round(performance.now())}}h.m_sessionStats={},h.m_sessionTransitionStats={},h.m_sessionConfig={},h.startFrom=0},function(e,t,i){"use strict";i.d(t,"i",(function(){return y})),i.d(t,"g",(function(){return T})),i.d(t,"h",(function(){return b})),i.d(t,"q",(function(){return w})),i.d(t,"p",(function(){return C})),i.d(t,"l",(function(){return I})),i.d(t,"e",(function(){return E})),i.d(t,"d",(function(){return x})),i.d(t,"r",(function(){return k})),i.d(t,"n",(function(){return M})),i.d(t,"k",(function(){return A})),i.d(t,"s",(function(){return R})),i.d(t,"c",(function(){return O})),i.d(t,"b",(function(){return F})),i.d(t,"a",(function(){return B})),i.d(t,"f",(function(){return N})),i.d(t,"j",(function(){return U})),i.d(t,"o",(function(){return H})),i.d(t,"m",(function(){return G}));var n,r=i(55),a=i(2),s=i(18),o=i(79),l=i(0),d=i(6),c=i(28),h=i(129),u=i(37),m=i(14),f=i(20);!function(e){e[e.alpha=0]="alpha",e[e.invAlpha=1]="invAlpha",e[e.effect=2]="effect",e[e.invEffect=3]="invEffect"}(n||(n={}));class p{equals(e){return this.mask===e.mask&&this.mode===e.mode}clone(){return new p(this.mask,this.mode)}get hasImpact(){return!0}constructor(e,t){this.mask=e,this.mode=t}}class g{get changeTracker(){return this.m_changeTracker}notifyChange(){this.m_changeTracker.notifyChange()}get hueSaturationLuminance(){return this.m_hueSaturationLuminance}get brightnessContrast(){return this.m_brightnessContrast}get recolor(){return this.m_recolor}get colorTemperature(){return this.m_colorTemperature}get sharpness(){return this.m_sharpness}get lookupTable(){return this.m_lookupTable}get highlightsShadows(){return this.m_highlightsShadows}get mask(){return this.m_mask}get maskChannel(){var e;return null!==(e=this.m_maskChannel)&&void 0!==e?e:0}get hasImpact(){var e,t,i,n,r,a,s;return!!(null!==(e=this.hueSaturationLuminance)&&void 0!==e&&e.hasImpact||null!==(t=this.m_brightnessContrast)&&void 0!==t&&t.hasImpact||this.m_recolor||null!==(i=this.m_colorTemperature)&&void 0!==i&&i.hasImpact||null!==(n=this.m_sharpness)&&void 0!==n&&n.hasImpact||null!==(r=this.m_lookupTable)&&void 0!==r&&r.hasImpact||null!==(a=this.m_highlightsShadows)&&void 0!==a&&a.hasImpact||null!==(s=this.m_mask)&&void 0!==s&&s.hasImpact)}set hueSaturationLuminance(e){Object(m.c)(this.changeTracker,this.m_hueSaturationLuminance,e),this.m_hueSaturationLuminance=e}set brightnessContrast(e){Object(m.c)(this.changeTracker,this.m_brightnessContrast,e),this.m_brightnessContrast=e}set recolor(e){Object(m.c)(this.changeTracker,this.m_recolor,e),this.m_recolor=e}set colorTemperature(e){Object(m.c)(this.changeTracker,this.m_colorTemperature,e),this.m_colorTemperature=e}set sharpness(e){Object(m.c)(this.changeTracker,this.m_sharpness,e),this.m_sharpness=e}set lookupTable(e){Object(m.c)(this.changeTracker,this.m_lookupTable,e),this.m_lookupTable=e}set highlightsShadows(e){Object(m.c)(this.changeTracker,this.m_highlightsShadows,e),this.m_highlightsShadows=e}set mask(e){Object(m.c)(this.changeTracker,this.m_mask,e),this.m_mask=e}set maskChannel(e){this.m_maskChannel=e}equals(e){return Object(l.j)(this.m_hueSaturationLuminance,e.hueSaturationLuminance)&&Object(l.j)(this.m_brightnessContrast,e.brightnessContrast)&&Object(l.j)(this.m_recolor,e.recolor)&&Object(l.j)(this.m_colorTemperature,e.colorTemperature)&&Object(l.j)(this.m_sharpness,e.sharpness)&&Object(l.j)(this.m_lookupTable,e.lookupTable)&&Object(l.j)(this.m_highlightsShadows,e.highlightsShadows)&&Object(l.j)(this.m_mask,e.mask)}clone(){const e=new g;return e.hueSaturationLuminance=this.hueSaturationLuminance,e.brightnessContrast=this.brightnessContrast,e.recolor=this.recolor,e.colorTemperature=this.colorTemperature,e.sharpness=this.sharpness,e.lookupTable=this.lookupTable,e.highlightsShadows=this.highlightsShadows,e.mask=this.mask,e}constructor(){this.m_changeTracker=new s.a}}i(5),i(33);var _=i(30),S=i(76),v=i(111);let y=1,T=1;const b=4096,w=2048,C=2,I=256;var P,E;!function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.ReleasedWithoutNotification=2]="ReleasedWithoutNotification",e[e.WrongRenderer=3]="WrongRenderer",e[e.WrongContext=4]="WrongContext"}(P||(P={})),function(e){e[e.KeepUntilRelease=0]="KeepUntilRelease",e[e.DisposableCache=1]="DisposableCache",e[e.ExternallyManaged=2]="ExternallyManaged"}(E||(E={}));class x{register(e){this.textureMemoryAllocated+=e.memoryUsage,this.allocatedTextures.push(e)}unregister(e){this.textureMemoryAllocated-=e.memoryUsage,this.allocatedTextures=this.allocatedTextures.filter(t=>t!==e)}constructor(){this.textureMemoryAllocated=0,this.allocatedTextures=[]}}function k(e){y=T=e}let M=!0;function A(e){M=e}function R(e,t){return{center:e.center.add(t.preTranslation).multiply(t.scale).rotate(t.rotation).add(t.translation),size:e.size.multiply(t.scale.abs()),rotation:t.rotation,flipX:t.scale.x<0,flipY:t.scale.y<0}}class O{static CreateFromByteBuffer(e,t,i,n,r,a,s,o,l,d,c){return O.CreateOrUpdateFromByteBuffer(e,void 0,t,i,n,r,a,s,o,l,d,c)}static CreateOrUpdateFromByteBuffer(e,t,i,n,r,s,o,h,m,f,p,g){if(!i.isValid())throw d.a.Message(512297122,"Unable to create/update texture on invalid renderer");const _=i.getMaxSupportedTextureSize();if(n.x>_||n.y>_)throw d.a.Error(507009026,`ByteBuffer too big: ${n.x} x ${n.y}, max: ${_}, scenario: ${e}`);let S=t;const v=i.getGraphicsProcessor();if(!v)throw d.a.Error(592525215,"No Graphics Processor");const y=s==c.d.BGR||s==c.d.NV12?c.d.RGB:s==c.d.BGRA?c.d.RGBA:s;if(!S||S.isValidForGraphicsProcessor(v)&&S.size.equals(n)&&S.m_babylonTexture&&S.format==y&&S.wrapMode==o&&S.m_babylonTexture.invertY===!!m||(S.release(),S=void 0),s==c.d.RGB||s==c.d.RGBA||s==c.d.LUMINANCE||s==c.d.LUMINANCE_ALPHA){if(S&&S.m_babylonTexture)return v.updateTextureGraphicsResourceFromByteBuffer(S.m_babylonTexture,r,r instanceof Float32Array,g||4),S.changeTracker.notifyChange(),S.m_lastRenderTime=performance.now(),S;{const t=v.needPowerOf2TexturesForTilingOrMipMap()&&o!==a.y.clamp&&!(G(n.x)&&G(n.y)),l=v.createTextureGraphicsResource(n,r,s,r instanceof Float32Array,t?a.y.clamp:o,h,!!m,g);if(t){if(s==c.d.RGB||s==c.d.RGBA){if(u.a.readBooleanOrDefault("noResample",!1))throw d.a.Error(507009025,"Invalid ByteBuffer size for non-clamp scenario: "+e);const t=O.GetRequiredSizeForWrapMode(v,n,o),r=O.ResampleBabylonTexture(i,l,n,a.y.clamp,t,o,s);if(l.dispose(),!r)throw d.a.Error(507009024,"Failed to resample ByteBuffer size for non-clamp scenario: "+e);return new O(e,i,r,t,s,o,null==f?E.KeepUntilRelease:f)}return d.a.Error(507008995,`Unable to resample ByteBuffer size for non-clamp with format ${s} scenario: ${e}`),new O(e,i,l,n,s,a.y.clamp,null==f?E.KeepUntilRelease:f)}return new O(e,i,l,n,s,o,null==f?E.KeepUntilRelease:f)}}if(s==c.d.BGR||s==c.d.BGRA||s==c.d.NV12){var T;const t=(null===(T=S)||void 0===T?void 0:T.m_textureConverterCache)||{},a=s==c.d.NV12?c.d.LUMINANCE:y,d=s==c.d.BGR||s==c.d.BGRA;t.primary=O.CreateOrUpdateFromByteBuffer(e+"/primary",t.primary,i,n,r,a,o,h,m,E.KeepUntilRelease,p,g),t.secondary=s==c.d.NV12?O.CreateOrUpdateFromByteBuffer(e+"/secondary",t.secondary,i,new l.f(Math.ceil(.5*n.x),Math.ceil(.5*n.y)),r.slice(n.x*Math.ceil(n.y/(g||4))*(g||4)),c.d.LUMINANCE_ALPHA,o,h,m,E.KeepUntilRelease,p,g):void 0;let u=void 0;var b,w;if(t.primary.m_babylonTexture)if(u=O.ConvertTexture(e,i,S instanceof F?S:void 0,t.primary,d,t.secondary,y),u&&p?u.m_textureConverterCache=t:(null===(b=t.primary)||void 0===b||b.release(),null===(w=t.secondary)||void 0===w||w.release()),u)return u.m_lastRenderTime=performance.now(),u}throw d.a.Error(507910019,"Unsupported texture format")}static CreateFromHTMLElement(e,t,i,n=a.y.clamp,r=!0,s){if(!t.isValid())throw d.a.Message(512297121,"Unable to create texture on invalid renderer");const o=t.getGraphicsProcessor();if(!o)throw d.a.Error(592525216,"No Graphics Processor");const h=new l.f(i.width,i.height),m=(f=O.GetRequiredSizeForWrapMode(o,h,n),p=t.getMaxSupportedTextureSize(),f.x<=p&&f.y<=p?new l.f(Math.max(1,f.x),Math.max(1,f.y)):f.x>f.y?new l.f(p,Math.max(1,f.y*p/f.x)):new l.f(Math.max(1,f.x*p/f.y),p));var f,p;let g=i;if(!h.equals(m)){if(u.a.readBooleanOrDefault("noResample",!1))throw d.a.Error(507008994,"Invalid image size for non-clamp scenario: "+e);g=function(e,t){const i=document.createElement("canvas");i.width=t.x,i.height=t.y;const n=i.getContext("2d");if(!n)throw d.a.Message(507012246,"context2D not supported");return n.drawImage(e,0,0,t.x,t.y),i}(i,m)}const _=o.createTextureGraphicsResource(m,g,c.d.RGBA,!1,n,r,!0,void 0,s),S=new O(e,t,_,m,c.d.RGBA,n,E.KeepUntilRelease);return S.originalSize=h,S}static CreateFromHTMLImageElement(e,t,i,n=a.y.clamp,r=!0,s){return O.CreateFromHTMLElement(e,t,i,n,r,s)}static CreateOrUpdateFromHTMLElement(e,t,i,n,r=a.y.clamp,s=!0,o){if(!i.isValid())throw d.a.Message(512297120,"Unable to create/update texture on invalid renderer");const c=i.getGraphicsProcessor();if(!c)throw d.a.Error(507910018,"No Graphics Processor");const h=new l.f(n.width,n.height);if(t){if(t.isValidForGraphicsProcessor(c)&&t.m_babylonTexture&&t.size.equals(h)&&t.wrapMode==r&&t.isMipMapped==!!o)return c.updateTextureGraphicsResourceFromHTMLElement(t.m_babylonTexture,n,!0),t.changeTracker.notifyChange(),t.m_lastRenderTime=performance.now(),t;t.release()}return O.CreateFromHTMLElement(e,i,n,r,s,o)}static CreateFromTextureAndMask(e,t,i,r,s,o=a.y.clamp,l=!0,d=n.alpha){const c=t,h=new F(e,t,s,E.KeepUntilRelease,{disableFiltering:!l,wrapMode:o}),u=new g;return u.mask=new p(new a.h,d),c.drawTextureToTexture(h,i,B.pictureEffects,{pictureEffects:u,maskTexture:r}),h}get graphicsProcessor(){return this.m_graphicsProcessor}get size(){return this.m_babylonTexture?new l.f(this.m_babylonTexture.width,this.m_babylonTexture.height):l.f.Zero}get originalSize(){return this.m_originalSize}get changeTracker(){return this.m_changeTracker}get lastUsage(){return this.m_usageRecord.length>0?Math.max(...this.m_usageRecord.map(e=>e.lastUsage)):0}get format(){return this.m_babylonTexture?this.m_babylonTexture.format:(d.a.Error(572073351,"No texture, no format"),c.d.RGBA)}get memoryUsage(){if(!this.graphicsProcessor)return 0;const{channels:e,dataSize:t,stencilDataSize:i}=this.getMemUsageData();return Math.ceil(this.size.x*this.size.y*(e*t+i)*(this.isMipMapped?4/3:1))}get usageRecord(){return this.m_usageRecord}get lastRenderTime(){return this.m_lastRenderTime}tryUseBabylonTexture(e,t,i){const n=j(e),r=this.m_usageRecord.find(e=>e.clientObject==t);return r?(r.lastScenario=i,r.lastUsage=performance.now(),r.usageCount++):this.m_usageRecord.push({clientObject:t,lastScenario:i,lastUsage:performance.now(),usageCount:1}),this.isValidForGraphicsProcessor(n)?this.m_babylonTexture:void 0}set originalSize(e){this.m_changeTracker.notifyChange(),this.m_originalSize=e}set contentLocation(e){this.m_changeTracker.notifyChange(),this.m_contentLocation=e}generateMipMap(){this.isMipMapped?d.a.Message(507775135,"generateMipMap no longer necessary. Texture already has auto-henerated mipmaps. Scenario: "+this.scenario):d.a.Error(507775136,"generateMipMap no longer supported. Please enable mipmaps ar construction time. Scenario: "+this.scenario)}isValidForGraphicsProcessor(e){return this.m_babylonTexture&&this.m_graphicsProcessor==e&&this.m_compatibleGraphicsProcessorId==e.getUniqueGraphicsProcessorId()}isValid(e){const t=e.getGraphicsProcessor();return t&&this.isValidForGraphicsProcessor(t)}getState(e){var t;const i=e.getGraphicsProcessor();return this.m_babylonTexture?i&&this.m_graphicsProcessor==i?this.isValidForGraphicsProcessor(i)?0===(null===(t=this.m_babylonTexture)||void 0===t?void 0:t._references)?P.ReleasedWithoutNotification:P.Valid:P.WrongContext:P.WrongRenderer:P.Empty}tryGetWebGLTexture(){var e;return this.m_babylonTexture&&(null===(e=this.m_babylonTexture._hardwareTexture)||void 0===e?void 0:e.underlyingResource)||void 0}unregisterFromTextureManager(){this.m_textureManager&&(this.m_textureManager.unregister(this),this.m_textureManager=void 0)}release(){var e,t;this.unregisterFromTextureManager(),this.m_babylonTexture&&this.releasePolicy!=E.ExternallyManaged&&this.m_babylonTexture.dispose(),this.m_babylonTexture=void 0,null===(e=this.m_textureConverterCache)||void 0===e||null===(e=e.primary)||void 0===e||e.release(),null===(t=this.m_textureConverterCache)||void 0===t||null===(t=t.secondary)||void 0===t||t.release(),this.m_changeTracker.notifyChange()}get contentLocation(){const e=this.size;return this.m_contentLocation?this.m_contentLocation:{logicalCenter:e.scale(.5),logicalSize:e,physicalCenter:e.scale(.5),physicalSize:e,rotation:0,flipX:!1,flipY:!1}}cloneWithNewWrapMode(e,t,i,n){const r=this.m_graphicsProcessor;if(!r||!this.m_babylonTexture||!this.isValidForGraphicsProcessor(r))return void d.a.Error(592472278,"Failed to get graphicsProcessor or valid texture");this.wrapMode==i&&d.a.Error(592472277,"Why cloning if the wrapmode is the same?");const a=O.GetRequiredSizeForWrapMode(r,this.size,i),s=O.ResampleBabylonTexture(t,this.m_babylonTexture,this.originalSize,this.wrapMode,a,i,this.format);if(!s)return;const o=new O(e,t,s,a,this.m_babylonTexture.format,i,n);return o.originalSize=this.originalSize,o}process(e,t,i){var n,r,s,o,l;const d=null!=i&&null!==(n=i.pictureEffects)&&void 0!==n&&n.lookupTable?Object(S.c)(t,null==i||null===(r=i.pictureEffects)||void 0===r?void 0:r.lookupTable,E.KeepUntilRelease):void 0,c=null!=i&&null!==(s=i.pictureEffects)&&void 0!==s&&s.mask?t.getTextureFromImage(null==i||null===(o=i.pictureEffects)||void 0===o||null===(o=o.mask)||void 0===o?void 0:o.mask):void 0,h=Object(v.a)(e,t,null==i?void 0:i.currentTargetTexture,this,null==i?void 0:i.pictureEffects,null!==(l=null==i?void 0:i.wrapMode)&&void 0!==l?l:a.y.clamp,d,c,null==i?void 0:i.cropToBounds,null==i?void 0:i.newSize,1==(null==i?void 0:i.disableFiltering),1==(null==i?void 0:i.outputStraightAlpha));return null==d||d.release(),h}getMemUsageData(){let e=c.e[this.format],t=0;if(this.m_babylonTexture)switch(this.m_babylonTexture.type){case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;default:d.a.Error(572867285,"Unknown texture type")}return{channels:e,dataSize:t,stencilDataSize:0}}static GetRequiredSizeForWrapMode(e,t,i){return e.needPowerOf2TexturesForTilingOrMipMap()&&i!=a.y.clamp?G(t.x)&&G(t.y)?t:(n=t,new l.f(Object(l.h)(Object(l.l)(n.x),1,2048),Object(l.h)(Object(l.l)(n.y),1,2048))):t;var n}static ResampleBabylonTexture(e,t,i,n,r,a,s){const o=e,l=o.getGraphicsProcessor();if(!l)return void d.a.Error(572867286,"Failed to get graphicsProcessor");const c=new O("TMP/ResampleSrc",e,t,i,t.format,n,E.ExternallyManaged),h=new F("TMP/ResampleDst",e,r,E.KeepUntilRelease,{disableFiltering:1==t.samplingMode,format:s});o.drawTextureToTexture(h,c,B.noFilter);const u=h.detachBabylonTexture();return h.release(),u&&l.setWrapMode(u,a),c.release(),u}static ConvertTexture(e,t,i,n,r,a,s){var o;const l=t;if(!l.getGraphicsProcessor())return void d.a.Error(526714142,"Failed to get graphicsProcessor");const c=1==(null===(o=n.m_babylonTexture)||void 0===o?void 0:o.samplingMode),h=F.RecycleOrReplace(e,i,t,n.size,E.KeepUntilRelease,{format:s,disableFiltering:c,wrapMode:n.wrapMode});return l.drawTextureToTexture(h,n,r?B.swapRedAndBlue:a?B.nv12:B.noFilter,{secondaryTexture:a}),h}constructor(e,t,i,n,o,c,h,m,f){if(this.m_originalSize=l.f.Zero,this.m_changeTracker=new s.a,this.m_compatibleGraphicsProcessorId=0,this.m_usageRecord=[],this.isMipMapped=!!m,!t.isValid())throw d.a.Message(512297123,"Unable to create texture on invalid renderer");z(o),this.wrapMode=c,this.releasePolicy=h,this.scenario=e,this.creationTime=performance.now(),this.m_lastRenderTime=i?performance.now():void 0;const p=t.getMaxSupportedTextureSize(),g=n.x>p||n.y>p;if(g||!n.isFinitePositive()){const t=u.a.readBooleanOrDefault("throwOnInvalidTextureSize",!1),i=g?`max: ${p}, `:"",r=d.a.Error(572319067,`Invalid texture size: ${n.x} x ${n.y}, ${i}scenario: ${e}`);if(t)throw r}else{const s=n.ceil();if(s.equals(n)||d.a.Error(572319068,`Bad texture size. Should be positive integers: ${n.x} x ${n.y}, scenario: ${e}`),this.m_graphicsProcessor=t.getGraphicsProcessor(),!this.m_graphicsProcessor)throw d.a.Error(592525214,"Unable to set texture if processor not initialized");if(this.m_graphicsProcessor.needPowerOf2TexturesForTilingOrMipMap()&&c!==a.y.clamp&&(!G(s.x)||!G(s.y))){const t=u.a.readBooleanOrDefault("throwOnInvalidTextureSize",!1),i=d.a.Error(507009027,`Incompatible texture size: ${n.x} x ${n.y}, wrapMode:${c}, scenario: ${e}`);if(t)throw i}if(this.m_originalSize=s,this.m_babylonTexture=i instanceof r.a?i:i?this.m_graphicsProcessor.createTextureGraphicsResourceFromExternalWebGLTexture(s,o,i,!0,!!m):void 0,this.m_compatibleGraphicsProcessorId=this.m_graphicsProcessor.getUniqueGraphicsProcessorId(),this.m_babylonTexture&&this.m_graphicsProcessor.needPowerOf2TexturesForTilingOrMipMap()&&c!==a.y.clamp&&(!G(s.x)||!G(s.y))){if(u.a.readBooleanOrDefault("noResample",!1))throw d.a.Error(572303306,"Invalid texture size for non-clamp scenario: ${scenario}");d.a.Error(572867283,"Texture size not supported for this wrap mode. The texture will be resampled and the copy will be managed by ShapeBuilder. Please conside resampling explicitely using WrapMode.clamp and cloneWithNewWrapMode when necessary. Scenario: "+e);const i=O.GetRequiredSizeForWrapMode(this.m_graphicsProcessor,s,c),n=O.ResampleBabylonTexture(t,this.m_babylonTexture,this.originalSize,a.y.clamp,i,c,o);this.releasePolicy==E.ExternallyManaged?this.releasePolicy=E.KeepUntilRelease:this.m_babylonTexture.dispose(),this.m_babylonTexture=n}}const _=t;this.m_textureManager=_.getTextureManager(),f||this.m_textureManager.register(this)}}class F extends O{release(){var e;null===(e=this.m_renderTargetWrapper)||void 0===e||e.dispose(),super.release()}detachBabylonTexture(){var e;const t=this.m_babylonTexture;return this.unregisterFromTextureManager(),null===(e=this.m_renderTargetWrapper)||void 0===e||e.dispose(!0),this.m_babylonTexture=void 0,this.m_renderTargetWrapper=void 0,t}tryGetBabylonTextureForRenderToTexture(e){const t=j(e);return this.m_lastRenderTime=performance.now(),this.isValidForGraphicsProcessor(t)?this.m_renderTargetWrapper:void 0}tryUseBabylonTargetTexture(e,t,i){const n=j(e),r=this.m_usageRecord.find(e=>e.clientObject==t);return r?(r.lastScenario=i,r.lastUsage=performance.now(),r.usageCount++):this.m_usageRecord.push({clientObject:t,lastScenario:i,lastUsage:performance.now(),usageCount:1}),this.isValidForGraphicsProcessor(n)?this.m_renderTargetWrapper:void 0}tryConvertToBufferRGBA(e){if(!this.m_graphicsProcessor||!this.m_renderTargetWrapper)return;const t=this.m_graphicsProcessor.copyTexturePixelsToArray(this.m_renderTargetWrapper,l.d.FromSize(this.size),!0);if(e)for(let e=0;e<t.length/4;e++){const i=4*e,n=255/Object(l.h)(t[i+3],1,255);t[i]=Object(l.h)(t[i]*n,0,255),t[i+1]=Object(l.h)(t[i+1]*n,0,255),t[i+2]=Object(l.h)(t[i+2]*n,0,255)}return t}tryConvertToCanvas(){if(!this.m_graphicsProcessor||!this.m_babylonTexture)return;const e=document.createElement("canvas");e.width=this.m_babylonTexture.width,e.height=this.m_babylonTexture.height;var t=e.getContext("2d");if(t){const i=this.tryConvertToBufferRGBA(f.n);if(i){const n=this.size,r=t.createImageData(n.x,n.y);return r.data.set(i),t.putImageData(r,0,0),t.globalCompositeOperation="copy",t.setTransform(1,0,0,-1,0,n.y),t.drawImage(e,0,0),e}}}tryConvertToDataURL(){const e=this.tryConvertToCanvas();if(e)return e.toDataURL()}getMemUsageData(){var e;const{channels:t,dataSize:i}=super.getMemUsageData();return{channels:t,dataSize:i,stencilDataSize:null!==(e=this.m_renderTargetWrapper)&&void 0!==e&&e._generateStencilBuffer?1:0}}static RecycleOrReplace(e,t,i,n,r,s){var o,l;const h=null!==(o=null==s?void 0:s.format)&&void 0!==o?o:c.d.RGBA,u=!(null==s||!s.useFloat),m=!(null==s||!s.disableFiltering),f=null!==(l=null==s?void 0:s.wrapMode)&&void 0!==l?l:a.y.clamp;z(h);const p=i.getGraphicsProcessor();if(t){var g,_;const e=0!=(null===(g=t.m_babylonTexture)||void 0===g?void 0:g.type),i=1==(null===(_=t.m_babylonTexture)||void 0===_?void 0:_.samplingMode);if(p&&t.isValidForGraphicsProcessor(p)&&t.size.equals(n)&&t.m_babylonTexture&&t.m_babylonTexture.format==h&&t.wrapMode==f&&t.isMipMapped==!(null==s||!s.isMipMapped)&&e==u&&i==m)return t.releasePolicy!=r&&d.a.Error(572867288,"RecycleOrReplace with different releasePolicy"),t;t.release()}return new F(e,i,n,r,s)}constructor(e,t,i=l.f.Zero,n,r){if(!t.isValid())throw d.a.Message(512297119,"Unable to create TargetTexture on invalid renderer");let s=i.ceil();if(!s.isFinitePositive()){const t=d.a.Error(506860951,`Bad TargetTexture size. Should be positive integers: ${i.x} x ${i.y}, scenario: ${e}`);if(u.a.readBooleanOrDefault("throwOnInvalidTextureSize",!1))throw t;s=l.f.One}let o=r&&void 0!==r.wrapMode?r.wrapMode:a.y.clamp;const h=t,m=h.getGraphicsProcessor();if(!m)return void d.a.Error(592525217,"Graphics processor not initialized");o===a.y.clamp||G(i.x)&&G(i.y)||(d.a.Error(507008993,`Incompatible TargetTexture size: ${i.x} x ${i.y}, wrapMode:${o}, scenario: ${e}`),o=a.y.clamp);const f=r&&r.format?r.format:c.d.RGBA;let p,g;if(z(f),r&&r.externalTexture)g=m.createRenderTargetWrapper(s),p=m.createTextureGraphicsResourceFromExternalWebGLTexture(s,f,r.externalTexture,!r||!r.disableFiltering,!(null==r||!r.isMipMapped)),r.externalFrameBuffer&&(g._framebuffer=r.externalFrameBuffer);else{if(g=m.createTextureGraphicsRenderTargetResource(s,void 0,f,!(null==r||!r.useFloat),!(null==r||!r.needsRenderBuffer),o,!r||!r.disableFiltering,!(null==r||!r.isMipMapped)),!g.texture)return void d.a.Error(507011861,"Failed to create render target wrapper");p=g.texture}super(e,t,p,s,f,o,n,!(null==r||!r.isMipMapped),!0),g?this.m_renderTargetWrapper=g:d.a.Error(507011860,"Failed to create render target wrapper"),this.m_textureManager&&this.m_textureManager.register(this),n!=E.ExternallyManaged&&(h.getCurrentFramePerformanceSummary().dynamicTextureAlloc+=this.memoryUsage)}}const D=[{attributeName:"a_0",attributeSize:4,offset:0}],L=[{attributeName:"a_1",attributeSize:4,offset:0}];var B;function N(e,t,i,n,r,a,s,o){const d=t.originalSize.x/t.originalSize.y;W(e,t,t,r,0,d,[new l.d(0,0,t.size.x,t.size.y)],[new l.d(0,0,r.size.x,r.size.y)],r.size,n,a,s,o),W(e,t,r,i,1,d,[new l.d(0,0,r.size.x,r.size.y)],[new l.d(0,0,i.size.x,i.size.y)],i.size,n,a,s,o)}function V(e,t,i){0==e.length&&d.a.Error(509634196,"Cannot create vertex buffer array from empty rectangle array.");const n=new Float32Array(4*i);for(let r=0;r<i;r++){const i=e[Math.min(r,e.length-1)];n[4*r+0]=i.left/t.x,n[4*r+1]=i.top/t.y,n[4*r+2]=i.right/t.x,n[4*r+3]=i.bottom/t.y}return n}function W(e,t,i,n,r,s,o,l,c,h,u,m,f){const p=e.getGraphicsProcessor();if(!p||!p.isValid())return void d.a.Error(509634336,"Invalid Graphics Processor for Sharpness Filter");if(!i.isValidForGraphicsProcessor(p))return void d.a.Error(509634335,"Invalid Texture for Sharpness Filter");const g=Math.max(o.length,l.length);if(0==g)return;const S=V(o,i.size,g),v=V(l,c,g),y=_.a.sharpnessFilter,T=p.activateShaderProgram(y);T.begin(n.tryGetBabylonTextureForRenderToTexture(p),a.d.Transparent,!0);const b=p.getBabylonEngine(),w=b.createVertexBuffer(S),C=b.createVertexBuffer(v);b.bindInstancesBuffer(w,D,!1),b.bindInstancesBuffer(C,L,!1),T.setTexture("t_0",i.tryUseBabylonTexture(p,void 0,"sharpnessFilterPass")),T.setTexture("t_1",t.tryUseBabylonTexture(p,void 0,"sharpnessFilterPass")),m&&void 0!==u?(T.getBabylonEffect().setInt("ufrag_5",u+1),T.setTexture("t_2",m.tryUseBabylonTexture(p,void 0,"drawTextureRects/maskTexture")),T.getBabylonEffect().setFloat4("ufrag_6",0!=f&&f?0:1,1==f?1:0,2==f?1:0,3==f?1:0)):(T.getBabylonEffect().setInt("ufrag_5",0),T.setTexture("t_2",void 0));const I=h.sharpness,P=I<0?10.5*-I:1.25*I,E=I<0?1+.8*-I:1,x=1==r&&I>0;T.getBabylonEffect().setFloat("ufrag_0",P),T.getBabylonEffect().setFloat("ufrag_1",E),T.getBabylonEffect().setFloat("ufrag_2",s),T.getBabylonEffect().setInt("ufrag_3",r),T.getBabylonEffect().setBool("ufrag_4",x),T.getBabylonEffect().setFloat("ufrag_7",h.depthFocusMin),T.getBabylonEffect().setBool("ufrag_8",h.enableForegroundBlur),T.getBabylonEffect().setFloat("ufrag_9",h.depthFocusMax),T.drawQuadInstances(g),T.disableInstanceAttribute("a_0"),T.disableInstanceAttribute("a_1"),b._releaseBuffer(w),b._releaseBuffer(C),T.end()}function U(e,t,i,n,r,s,o,c=1,h,u){if(!i.isValidForGraphicsProcessor(e))return void d.a.Error(591192838,"Invalid Texture");const m=Math.max(n.length,r.length);if(0==m)return;const p=V(n,i.size,m),g=V(r,s,m),S=e.getBabylonEngine(),v=S.createVertexBuffer(p),y=S.createVertexBuffer(g);if(S.bindInstancesBuffer(v,D,!1),S.bindInstancesBuffer(y,L,!1),t.setTexture("t_0",i.tryUseBabylonTexture(e,void 0,"drawTextureRects")),t.programId!=_.a.copyTextureDrawMask&&t.getBabylonEffect().setFloat("ufrag_0",c),t.programId==_.a.copyTexturePictureEffects){var T,b,w,C;const n=null==u?void 0:u.secondaryTexture;t.setTexture("t_1",null==n?void 0:n.tryUseBabylonTexture(e,void 0,"drawTextureRects/Secondary")),t.getBabylonEffect().setInt("ufrag_1",o),function(e,t){const i=null==t?void 0:t.brightnessContrast;if(i){let t,n;f.z?(t=1,n=i.brightness):i.brightness>=1?(t=0,n=1):(t=i.brightness>0?1/(1-i.brightness):Math.max(0,1+i.brightness),n=0),e.getBabylonEffect().setInt("ufrag_3",1),e.getBabylonEffect().setArray2("ufrag_4",[t,n]),e.getBabylonEffect().setArray4("ufrag_5",function(e){if(f.A)return[0,0,e,(1-e)/2];const t=Math.min(Math.abs(e/4),1/4-1/65025),i=64*t*t*t-48*t*t-4*t+3,n=-64*t/i,r=96*t/i,a=(i-32*t)/i;if(e>=0)return[n,r,a,0];const s=Math.max(0,(-r+Math.sqrt(r*r-4*n*a))/(2*n));return[(64*t-32*s)/3,-32*t+16*s,(32*t-22*s+3)/3,s]}(i.contrast))}else e.getBabylonEffect().setInt("ufrag_3",0);const n=null==t?void 0:t.hueSaturationLuminance;n?(e.getBabylonEffect().setInt("ufrag_6",1),e.getBabylonEffect().setFloat("ufrag_7",n.hueRotation),e.getBabylonEffect().setFloat("ufrag_8",n.saturationFactor),e.getBabylonEffect().setFloat("ufrag_9",n.luminanceFactor)):e.getBabylonEffect().setInt("ufrag_6",0);const r=null==t?void 0:t.recolor;if(r){const t=void 0===r.threshold?1:255,i=void 0===r.threshold?0:.5-t*r.threshold;e.getBabylonEffect().setInt("ufrag_10",1),e.getBabylonEffect().setFloat("ufrag_11",t),e.getBabylonEffect().setFloat("ufrag_12",i),e.getBabylonEffect().setVector3("ufrag_13",{x:r.darkColor.r,y:r.darkColor.g,z:r.darkColor.b}),e.getBabylonEffect().setVector3("ufrag_14",{x:r.brightColor.r,y:r.brightColor.g,z:r.brightColor.b})}else e.getBabylonEffect().setInt("ufrag_10",0);const a=null==t?void 0:t.colorTemperature;a?(e.getBabylonEffect().setInt("ufrag_15",1),e.getBabylonEffect().setFloat("ufrag_16",a.redGain),e.getBabylonEffect().setFloat("ufrag_17",a.blueGain),e.getBabylonEffect().setFloat("ufrag_18",a.greenGain)):e.getBabylonEffect().setInt("ufrag_15",0);const s=null==t?void 0:t.highlightsShadows;s?(e.getBabylonEffect().setInt("ufrag_25",1),e.getBabylonEffect().setDirectColor4("ufrag_26",s.neutral),e.getBabylonEffect().setDirectColor4("ufrag_27",s.positive),e.getBabylonEffect().setDirectColor4("ufrag_28",s.negative)):e.getBabylonEffect().setInt("ufrag_25",0)}(t,null==u?void 0:u.pictureEffects),t.getBabylonEffect().setDirectColor4("ufrag_19",h||a.d.Transparent),t.getBabylonEffect().setVector2("ufrag_22",i.size),t.getBabylonEffect().setMatrix3x3("u_1",null!==(T=null==u||null===(b=u.textureTransform)||void 0===b?void 0:b.m)&&void 0!==T?T:l.c.Identity.m);const r=null==u?void 0:u.lookupTableTexture;if(null!=u&&null!==(w=u.pictureEffects)&&void 0!==w&&w.lookupTable&&r){const i=null==u?void 0:u.pictureEffects.lookupTable;t.getBabylonEffect().setFloat4("ufrag_23",i.dimensionR,i.dimensionG,i.dimensionB,i.blocksPerRow),t.setTexture("t_2",r.tryUseBabylonTexture(e,void 0,"drawTextureRects/lookupTableTexture"))}else t.getBabylonEffect().setFloat4("ufrag_23",0,0,0,0),t.setTexture("t_2",void 0);const s=null==u?void 0:u.maskTexture;if(s&&null!=u&&null!==(C=u.pictureEffects)&&void 0!==C&&C.mask){var I;const i=null==u||null===(I=u.pictureEffects)||void 0===I?void 0:I.maskChannel;t.getBabylonEffect().setInt("ufrag_29",u.pictureEffects.mask.mode+1),t.setTexture("t_4",s.tryUseBabylonTexture(e,void 0,"drawTextureRects/maskTexture")),t.getBabylonEffect().setFloat4("ufrag_30",0!=i&&i?0:1,1==i?1:0,2==i?1:0,3==i?1:0)}else t.getBabylonEffect().setInt("ufrag_29",0),t.setTexture("t_4",void 0);const d=null==u?void 0:u.ditherPalette256;d?(t.getBabylonEffect().setInt("ufrag_24",1),t.setTexture("t_3",d.tryUseBabylonTexture(e,void 0,"drawTextureRects/ditherPalette256"))):(t.getBabylonEffect().setInt("ufrag_24",0),t.setTexture("t_3",void 0)),t.getBabylonEffect().setInt("ufrag_31",null!=u&&u.outputStraightAlpha?1:0)}else if(t.programId==_.a.copyTextureDrawMask&&null!=u&&u.textureTransform){var P,E,x,k,M,A,R,O,F;t.getBabylonEffect().setVector2("ufrag_22",i.size),t.getBabylonEffect().setMatrix3x3("u_1",null==u?void 0:u.textureTransform.m),t.getBabylonEffect().setInt("ufrag_1",null!==(P=null==u||null===(E=u.drawMaskParams)||void 0===E?void 0:E.drawMaskMode)&&void 0!==P?P:0),t.getBabylonEffect().setFloat("ufrag_2",null!==(x=null==u||null===(k=u.drawMaskParams)||void 0===k?void 0:k.drawMaskParam)&&void 0!==x?x:0),t.getBabylonEffect().setVector2("ufrag_3",null!==(M=null==u||null===(A=u.drawMaskParams)||void 0===A?void 0:A.drawMaskFlipXY)&&void 0!==M?M:l.f.One),t.getBabylonEffect().setInt("ufrag_4",null!==(R=null==u||null===(O=u.drawMaskParams)||void 0===O?void 0:O.drawMaskOrder)&&void 0!==R?R:0),t.getBabylonEffect().setInt("ufrag_5",null!=u&&null!==(F=u.drawMaskParams)&&void 0!==F&&F.drawMaskTransposeXY?1:0)}t.drawQuadInstances(m),t.disableInstanceAttribute("a_0"),t.disableInstanceAttribute("a_1"),S._releaseBuffer(v),S._releaseBuffer(y)}function z(e){switch(e){case c.d.RGB:case c.d.RGBA:case c.d.LUMINANCE:case c.d.LUMINANCE_ALPHA:break;default:throw d.a.Error(507910017,"Unsupported texture format")}}function H(e){if(e.x>o.a||e.y>o.a){const t=Math.max(e.x,e.y),i=o.a/t;return new l.f(i*e.x,i*e.y)}return e}function G(e){return 0==(e&e-1)}function j(e){if(e instanceof h.a)return e;const t=e;if(t.getGraphicsProcessor){const e=t.getGraphicsProcessor();if(e)return e}throw d.a.Error(506869774,"Unable to get GraphicsProcessor")}!function(e){e[e.noFilter=0]="noFilter",e[e.pictureEffects=1]="pictureEffects",e[e.swapRedAndBlue=2]="swapRedAndBlue",e[e.nv12=3]="nv12",e[e.drawMask=4]="drawMask"}(B||(B={}))},function(e,t,i){"use strict";i.d(t,"c",(function(){return vn})),i.d(t,"p",(function(){return kn})),i.d(t,"l",(function(){return Mn})),i.d(t,"m",(function(){return On})),i.d(t,"k",(function(){return m.f})),i.d(t,"i",(function(){return n})),i.d(t,"h",(function(){return r})),i.d(t,"g",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"n",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"j",(function(){return d})),i.d(t,"e",(function(){return c})),i.d(t,"a",(function(){return h})),i.d(t,"f",(function(){return Ii})),i.d(t,"o",(function(){return j}));var n,r,a,s,o,l,d,c,h,u,m=i(0);!function(e){e[e.Base64=0]="Base64",e[e.ObjectUrl=1]="ObjectUrl"}(n||(n={})),function(e){e[e.character=0]="character",e[e.paragraph=1]="paragraph"}(r||(r={})),function(e){e[e.letter=0]="letter",e[e.word=1]="word",e[e.whole=2]="whole"}(a||(a={})),function(e){e[e.move=0]="move",e[e.draw=1]="draw",e[e.clear=2]="clear"}(s||(s={})),function(e){e[e.Slide=0]="Slide",e[e.Section=1]="Section"}(o||(o={})),function(e){e[e.MediaPaused=0]="MediaPaused",e[e.MediaPlayed=1]="MediaPlayed",e[e.MediaStopped=2]="MediaStopped",e[e.MediaSeeked=3]="MediaSeeked",e[e.MediaVolumeChanged=4]="MediaVolumeChanged",e[e.InitMediaSync=5]="InitMediaSync",e[e.MediaEnded=6]="MediaEnded"}(l||(l={})),function(e){e[e.PauseButtonClick=0]="PauseButtonClick",e[e.PlayButtonClick=1]="PlayButtonClick",e[e.ProgressSliderInput=3]="ProgressSliderInput",e[e.VolumeButtonClick=4]="VolumeButtonClick",e[e.VolumeSliderInput=5]="VolumeSliderInput",e[e.CustomPlayButtonClick=6]="CustomPlayButtonClick",e[e.VideoFrameClick=7]="VideoFrameClick"}(d||(d={})),function(e){e[e.MediaPaused=0]="MediaPaused",e[e.MediaPlayed=1]="MediaPlayed",e[e.MediaStopped=2]="MediaStopped",e[e.MediaEnded=6]="MediaEnded"}(c||(c={})),function(e){e[e.Normal=0]="Normal",e[e.Removed=1]="Removed",e[e.Blur=2]="Blur",e[e.Custom=3]="Custom"}(h||(h={})),function(e){e[e.Shape=0]="Shape",e[e.Media=1]="Media",e[e.GIF=2]="GIF",e[e.Addin=3]="Addin",e[e.Cameo=4]="Cameo",e[e.Model3D=5]="Model3D",e[e.Ink=6]="Ink"}(u||(u={}));var f,p,g=i(9),_=i(3),S=i(7),v=i(19),y=i(2),T=i(5),b=i(25),w=i(63),C=i(15),I=i(68),P=i(18),E=i(20);class x{constructor(e,t,i,n,r,a){this.color=e,this.direction=t,this.wrapScale=i,this.wrapOffset=n,this.diffuse=r,this.specular=a}}class k{constructor(e,t){this.ambientColor=e,this.lights=t}}class M{constructor(e,t){this.profile=e,this.size=t}}!function(e){e[e.Default=0]="Default",e[e.Wireframe=1]="Wireframe",e[e.Metal=2]="Metal"}(f||(f={}));class A{constructor(e,t,i,n,r,a,s,o,l){this.materialType=e,this.diffuseColor=t,this.specularColor=i,this.ambientColor=n,this.emissiveColor=r,this.specularPower=a,this.useBlinnHighlight=s,this.diffuseFresnel=o,this.alphaFresnel=l}}class R{get adjustedContourWidth(){return Math.max(E.w,this.contourWidth)}constructor(e,t,i,n,r,a,s,o){this.topBevel=e,this.bottomBevel=t,this.material=i,this.extrusionColor=n,this.extrusionHeight=r,this.contourColor=a,this.contourWidth=s,this.zPosition=o}}!function(e){function t(t,r){if(!t)return m.e.Identity;const a=t.pt?i(t.pt).scale(r):void 0,s=t.s?n(t.s):new m.f(1,1),o=t.rSpecified?t.r*e.c_internalAngleToRadianFactor:void 0,l=t.t?i(t.t).scale(r):void 0;return new m.e(a,s,o,l)}function i(e){return new m.f(e.x,e.y)}function n(e,t=0){return new m.f(e.x||t,e.y||t)}function r(e){return new y.d(e[0]/255,e[1]/255,e[2]/255,e[3]/255)}function a(e,t=1){return new m.d(e.l*t,e.t*t,e.r*t,e.b*t)}function s(e){let t=[];for(let i of e){const e=i.pos,n=r(i.clr);t.push(new y.f(e,n))}return t.sort((e,t)=>e.position-t.position),t}function o(e,t){if(e.gradientStops=t,e.isGammaCorrected=!1,2==t.length||3==t.length){const i=t[0],n=t[t.length-1];if(0==Math.min(i.position,n.position)&&1==Math.max(i.position,n.position))if(2==t.length)e.isGammaCorrected=!0,e.blendBellShape=m.f.One;else if(3==t.length&&i.color.equals(n.color)){const n=t[1];e.gradientStops=[new y.f(0,i.color),new y.f(1,n.color)],e.isGammaCorrected=!0,e.blendBellShape=new m.f(n.position,1)}}}function l(t,i,n){switch(t.bt){case 0:return new y.v(y.d.Transparent);case 1:{let e=r(t.Item.clr);return new y.v(e)}case 2:{const i=t.Item;let n=new y.e(y.c.linearGradient);return n.isStretched=i.isStretched,n.rotateWithShape=i.rtSp,n.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(n.fillToRect=a(i.ftrct)),i.ffrct&&(n.fillFromRect=a(i.ffrct)),i.stops&&o(n,s(i.stops)),n}case 3:{const i=t.Item;let n=new y.e(y.c.radialGradient);return n.isStretched=i.isStretched,n.rotateWithShape=i.rtSp,n.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(n.fillToRect=a(i.ftrct)),i.ffrct&&(n.fillFromRect=a(i.ffrct)),i.stops&&o(n,s(i.stops)),n}case 4:{const i=t.Item;let n=new y.e(y.c.rectangularGradient);return n.isStretched=i.isStretched,n.rotateWithShape=i.rtSp,n.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(n.fillToRect=a(i.ftrct)),i.ffrct&&(n.fillFromRect=a(i.ffrct)),i.stops&&o(n,s(i.stops)),n}case 5:{const i=t.Item;let n=new y.e(y.c.pathGradient);return n.isStretched=i.isStretched,n.rotateWithShape=i.rtSp,n.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(n.fillToRect=a(i.ftrct)),i.ffrct&&(n.fillFromRect=a(i.ffrct)),i.stops&&o(n,s(i.stops)),n}case 7:{const e=t.Item;return new y.j(e.type,r(e.clrFg),r(e.clrBg))}case 6:return d(t.Item,i);case 8:case 9:n.Message(39084627,"unsupported Brush "+JSON.stringify(t))}return new y.v(y.d.Transparent)}function d(e,t){if(!e.id)return;let i=new y.h;i.id=e.id;let n=new y.g(i);return n.wrapMode=e.wrpmd,n.alignment=e.algn,n.isStretched=e.isStretched,n.offset=new m.f(e.off.x,e.off.y),n.scale=new m.f(e.scale.x,e.scale.y),n.opacity=e.opcty,n.rotateWithShape=e.rotWShp,n.isStretched||(n.scale=n.scale.divide(new m.f(e.dpi.x,e.dpi.y)).scale(t.fromInch),n.offset=n.offset.scale(t.fromHighPrecisionUnit)),n}function c(e){return{cap:e.capType,end:e.type,length:e.len,width:e.width,widthMin:e.widthMin}}function h(e,t,i){if(!e)return new y.x;let n,r;e.fillBrsh&&(n=l(e.fillBrsh,t,i)),e.outlnBrsh&&(r=l(e.outlnBrsh,t,i));const a=function(e,t,i,n){let r=new y.l(t*n);return r.lineHeight=i*n,e?(e.dtSpecified&&(r.dashType=e.dt),e.jtSpecified&&(r.lineJoin=e.jt),e.mlSpecified&&(r.miterLimit=e.ml),e.ctSpecified&&(r.compoundType=e.ct),e.atSpecified&&(r.alignment=e.at),e.doffSpecified&&(r.dashOffset=e.doff),e.dctSpecified&&(r.useRoundDash=1==e.dct),e.headEnd&&(r.headEnd=c(e.headEnd)),e.tailEnd&&(r.tailEnd=c(e.tailEnd)),e.tip&&(r.tipType=e.tip),r):r}(e.pen,e.lnWdth,e.lnHgth,t.fromHighPrecisionUnit);let s=new y.x(n,r,a);return e.pctBrush&&(s.pictureBrush=d(e.pctBrush,t)),e.blend&&(s.blendingMode=e.blend),s}function u(t,i,n){let a,s,o,l,d;if(t.glw){let e=t.glw.blrRd*i,n=r(t.glw.clr);a=new I.b(n,e)}if(t.otrSdw){let a=t.otrSdw;s=new I.e(r(a.clr),a.blrRd*i,a.ang*e.c_internalAngleToRadianFactor,a.dst*i,new m.f(a.sx*n,a.sy*n),new m.f(a.kx,a.ky)),s.alignment=a.algn,s.shadowType=a.tp}if(t.inrSdw){let n=t.inrSdw;o=new I.c(r(n.clr),n.blrRd*i,n.ang*e.c_internalAngleToRadianFactor,n.dst*i)}if(t.rflctn){let e=t.rflctn;l=new I.d(e.blrRd*i,e.sAlph,e.sPos,e.eAlph,e.ePos,e.dst*i)}return t.sftEdg&&(d=new I.f(t.sftEdg.blrRd*i)),new I.a(a,s,o,l,d)}function p(e,i,n){let r=e.pts;if(!r)return;const a=null==(s=e.f)?C.e.normal:0==s?C.e.none:2==s?C.e.lighten:3==s?C.e.lightenLess:4==s?C.e.darken:5==s?C.e.darkenLess:C.e.normal;var s;let o;if(e.h>0){let t=JSON.parse("["+r+"]");o={figures:[new C.a(t,!1,e.h)]}}else o={figures:C.i(r)};return o.fillMode=a,o.lineEnabled=e.s,e.xfrm?o.transform=t(e.xfrm,n):o.transform=m.e.Identity,o.transform=o.transform.applyScaleAndTranslationBefore(new m.f(i,i),m.f.Zero),o.extrusionEnabled=e.e,o}function g(e,i,r){let a=[];const s=e.xfrm?t(e.xfrm,i.fromHighPrecisionUnit):m.e.Identity,o=e.fontInfo;for(const t of e.glyphInstance)if(t.glyph&&r){const e=r.getGlyph(o,t.glyph);if(!e)continue;if(!e.clientData){let i=p(e.p,1,1);i&&(i.lineEnabled=!0,i.fillMode=C.e.normal,i.glyphCacheId={fontId:o,glyphId:t.glyph},e.clientData=new C.d(i))}if(!e.clientData)continue;let l=n(t.scale,1).scale(i.fromHighPrecisionUnit);l=l.scale(1/4096);let d=n(t.off).scale(i.fromHighPrecisionUnit);const c=new C.d(e.clientData,s.applyScaleAndTranslationBefore(l,d));a.push(c)}return a}function _(e){return new b.j(e.cp,e.len)}function S(e,t){const i=p(e,1,1);if(i){const e=i.figures.length?i.figures[0]:void 0;if(e){const i=e instanceof C.a?e:e.createFigure();if(1==t)return i;{const e=i.points.slice(0);for(let n=0;n<i.getPointCount();n++)e[n*i.pointDataSize]*=t,e[n*i.pointDataSize+1]*=t;return new C.a(e,i.isClosed,i.format)}}}}function v(e,t){if(!e)return b.o.highlighter;switch(e){case 0:return b.o.highlighter;case 1:return b.o.single;case 2:return b.o.double;case 3:return b.o.heavy;case 4:return b.o.dotted;case 5:return b.o.dottedHeavy;case 6:return b.o.dash;case 7:return b.o.dashHeavy;case 8:return b.o.dashLong;case 9:return b.o.dashLongHeavy;case 10:return b.o.dotDash;case 11:return b.o.dotDashHeavy;case 12:return b.o.dotDotDash;case 13:return b.o.dotDotDashHeavy;case 14:return b.o.wavy;case 15:return b.o.wavyHeavy;case 16:return b.o.wavyDouble}return t.Error(595637021,"Incorrect ShapeBuilder.TextStrokeType"),b.o.single}function w(e,t,i){const n=new P.b;for(const r of e){const e=h(r.style,t,i);n.push(new b.n(v(r.type,i),r.verticalCenter*t.fromLowPrecisionUnit,r.thickness*t.fromLowPrecisionUnit,e))}return n}function E(e,t,i,n,r,a){const s=a.getGlyph(r,e);if(s){if(!s.clientData){let t=p(s.p,1,1);t&&(t.lineEnabled=!0,t.fillMode=C.e.normal,t.glyphCacheId={fontId:r,glyphId:e},s.clientData=new C.d(t))}if(s.clientData)return new C.d(s.clientData,new m.e(m.f.Zero,t,n,i))}}function O(t,i,r,a,s,o){let l=[];const d=t.fi?t.fi.v:i;for(const i of t.gi||[])if(i.g&&s){const t=i.s?n(i.s,1).scale(a.fromHighPrecisionUnit/4096):r||m.f.Zero;t.equals(m.f.Zero)&&o.Error(0,"No glyph scale");const c=n(i.o).scale(a.fromHighPrecisionUnit),h=i.r?i.r.v*e.c_internalAngleToRadianFactor:0,u=E(i.g,t,c,h,d,s);u&&l.push(u)}return l}function F(e,t,i,n,r,s,o){let l=[];for(let a of e.g||[])l=l.concat(O(a,t,i,n,r,o));for(let t of e.p||[]){const e=p(t,n.fromHighPrecisionUnit,n.fromHighPrecisionUnit);e&&l.push(new C.d(e))}let c,h=a(e.lb,n.fromLowPrecisionUnit);if(e.i){const t=d(e.i.i,n),i=a(e.i.b,n.fromLowPrecisionUnit);null!=t&&t.image&&i&&(c=new b.f(t.image,i,s))}return new b.d(h,l,e.f?e.f.v:void 0,e.w?e.w.v:void 0,c)}function D(e,t,i,n,r,s,o){var l;let d=_(e.rng),c=a(e.lbnd,n.fromLowPrecisionUnit),h=new b.h(d,c),u=[];if(e.c)for(let a=0;a<e.c.length;a++){let l=F(e.c[a],t.getAt(h.localRange.start+a),i.getAt(h.localRange.start+a),n,r,s,o);l&&u.push(l)}else null!==(l=e.s)&&void 0!==l&&l.v&&(u=function(e,t,i,n,r,a,s,o){const l=[],d=e.split(";");for(let e=0;e<d.length;e++){const c=d[e].split(/([A-VXYZ])/),h=c.length>0?c[0]:void 0;let u,f;for(let e=1;e<c.length-1;e+=2){const t=c[e];"L"==t&&(u=c[e+1]),"R"==t&&(f=c[e+1])}if(h&&u&&f){const o=parseFloat(u)*s.fromLowPrecisionUnit,d=parseFloat(f)*s.fromLowPrecisionUnit,c="W"==h;let p;if(!c){const t=E(parseInt(h),r.getAt(a+e),new m.f(o,0),0,n.getAt(a+e),i);t&&(p=[t])}const g=new m.d(o,t.top,d,t.bottom);l.push(new b.d(g,p,!1,c))}else o.Error(0,"Wrong SimplifiedCharacterString: 0:"+h+", L:"+u+", R:"+f)}return l}(e.s.v,c,r,t,i,h.localRange.start,n,o));return h.characters=u,e.b&&(h.bender=function(e,t){return e.wenv?function(e,t){const i=S(e.tpp,t.fromLowPrecisionUnit),n=S(e.btp,t.fromLowPrecisionUnit);if(i&&n)return new b.p(a(e.rct,t.fromLowPrecisionUnit),i,n,e.vrt)}(e.wenv,t):e.plin?function(e,t){const i=S(e.pth,t.fromLowPrecisionUnit);if(i){const n=0==e.algn?0:2==e.algn?1:.5;return new b.a(a(e.rct,t.fromLowPrecisionUnit),i,n,e.s,e.pvt,e.vrt)}}(e.plin,t):void 0}(e.b,n)),e.o&&(h.offset=new m.f(e.o.x*n.fromLowPrecisionUnit,e.o.y*n.fromLowPrecisionUnit)),h.fillBounds=a(e.fb,n.fromLowPrecisionUnit),h.textEffectMetrics=new b.e(e.ea*n.fromLowPrecisionUnit,e.ed*n.fromLowPrecisionUnit,e.eh*n.fromLowPrecisionUnit),h}function L(e,t,i,r,a){let s=new b.i(_(e.gr),new y.x(new y.j(y.k.narrowHorizontal,y.d.Blue,y.d.Yellow)));e.o&&(s.offset=new m.f(e.o.x*i.fromLowPrecisionUnit,e.o.y*i.fromLowPrecisionUnit));let o=new b.b("");for(let t of e.fipr||[])o.set(t.fontInfo,_(t.range));let l=new b.b(m.f.Zero);for(let t of e.gspr||[])l.set(n(t.s,1).scale(i.fromHighPrecisionUnit/4096),_(t.rng));e.blt&&(s.bullet=function(e,t,i,n,r,a){var s;if(!e.c)return;const o=F(e.c,t,void 0,i,n,r,a),l=h(e.style,i,a),d=e.fx?u(e.fx,i.fromHighPrecisionUnit,1):void 0,c=(null===(s=e.stks)||void 0===s?void 0:s.length)>0?w(e.stks,i,a):void 0;return new b.c(o,l,d,c)}(e.blt,e.blt.fi,i,t,r,a));const d=new Array;for(let n of e.l||[]){const e=D(n,o,l,i,t,r,a);e&&d.push(e)}for(let t of e.spr||[]){const e=h(t.style,i,a);s.stylePerLocalRange.set(e,_(t.range))}for(let t of e.stkspr||[]){const e=w(t.textStrokeList,i,a);e?s.strokesPerLocalRange.set(e,_(t.range)):a.Error(39084627,"Unable to convert stroke")}for(let t of e.lwrng||[])s.addLocalWordRange(_(t));for(let t of e.fxpr||[])s.effectsPerLocalRange.set(u(t.fx,i.fromHighPrecisionUnit,1),_(t.range));return s.lines=d,s}function B(e,t){return e?new m.b(e.l?e.l.v*t:void 0,e.t?e.t.v*t:void 0,e.r?e.r.v*t:void 0,e.b?e.b.v*t:void 0):void 0}e.c_internalAngleToRadianFactor=2*Math.PI/216e5,e.getPresWidthAndHeightJson=function(e){return new m.f(e.w,e.h)};const N=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0];function V(e){let t=N[e];if(t)return t;const i=new C.b;switch(i.moveTo(0,0),e){case 0:i.cubicBezierTo(0,.367,.124605,.82,.507899,1),i.cubicBezierTo(.724115,.737,.790455,.64,1,.64);break;case 1:i.cubicBezierTo(0,.55627,.44373,1,1,1);break;case 2:i.quadBezierTo(0,.125,.025,.25),i.lineTo(.125,.75),i.cubicBezierTo(.175,1,.25,1,.375,1),i.lineTo(.5,1),i.cubicBezierTo(.625,1,.7,1,.75,.75),i.lineTo(.875,.125),i.cubicBezierTo(.9,.01,.98,.01,1,.01);break;case 3:i.cubicBezierTo(0,.05563,.04437,.1,.1,.1),i.lineTo(.4,.1),i.cubicBezierTo(.45563,.1,.5,.14437,.5,.2),i.lineTo(.5,.9),i.cubicBezierTo(.5,.95563,.54437,1,.6,1);break;case 4:i.lineTo(1,1);break;case 5:i.cubicBezierTo(0,.4775,.0968736,1,.156301,1),i.cubicBezierTo(.264179,1,.376919,.33333,1,.33333);break;case 6:i.cubicBezierTo(0,.07082,.0297458,.1,.101416,.1),i.cubicBezierTo(.501416,.1,.9,.7,.901416,.899999),i.cubicBezierTo(.9,.97167,.93343,1,1,1);break;case 7:i.cubicBezierTo(0,.138122,0,.2,.271356,.775535),i.cubicBezierTo(.377654,1,.519455,1,.583589,1);break;case 8:i.cubicBezierTo(0,.236604,.119276,.607024,.263046,.760235),i.cubicBezierTo(.361098,.864726,.457934,.909567,.537806,.925082),i.cubicBezierTo(.559245,.929246,.567625,.89793,.542066,.845567),i.cubicBezierTo(.484073,.726757,.477103,.393693,.551651,.393693),i.lineTo(.899894,.393693),i.cubicBezierTo(.99148,.393693,.958466,.746659,.907348,.779629),i.lineTo(.879394,.797658),i.cubicBezierTo(.845545,.819489,.848775,.954172,.874334,.971627),i.quadBezierTo(.915883,1,1,1);break;case 9:i.cubicBezierTo(0,.238519,.132047,.500741,.357567,.731852),i.cubicBezierTo(.513167,.891311,.563798,.912593,.735905,.912593),i.lineTo(.873887,.912593),i.cubicBezierTo(.956973,.912593,.878338,1,1,1);break;case 10:i.quadBezierTo(0,.092437,.042353,.305322),i.lineTo(.170124,.947558),i.cubicBezierTo(.177203,.983142,.2,1,.268235,.998599),i.lineTo(.614118,.998599),i.cubicBezierTo(.647059,.998599,.656471,.987395,.663529,.969188),i.cubicBezierTo(.687006,.908633,.802353,.822129,1,.822129);break;case 11:i.cubicBezierTo(0,.184095,.149238,.333333,.333333,.333333),i.cubicBezierTo(.333333,.701523,.63181,1,1,1);break;default:i.lineTo(1,0)}return t=i.createFigure(),N[e]=t,t}function W(e,i,n,r,a){const s=new b.g,o=new m.e(r.translation.negate(),m.f.One,-r.rotation,m.f.Zero);return s.paragraphs=function(e,t,i,n,r){let a=[];for(let s of e||[])a.push(L(s,t,i,n,r));return a}(e.p,i,n,o,a),s.layoutToFrame=t(e.ltfxfrm,n.fromHighPrecisionUnit),s.frameToShape=t(e.ftsxfrm,n.fromHighPrecisionUnit),s.clipBounds=B(e.c,n.fromLowPrecisionUnit),s.applyEffectsPerCharacter=!!e.s&&e.s.v,s}function U(e){return e.clientData||(e.clientData={}),e.clientData}function z(e,i,n,a,s){var o;if(!e)return;const l=(null===(o=e.bapi)||void 0===o?void 0:o.v)||"";let d;if(e.Items){let t=[];for(const r of e.Items){const e=z(r,i,n,a,s);e&&t.push(e)}const r=e.fx?u(e.fx,n.fromHighPrecisionUnit,.01):void 0;d=new T.d(t,r)}else d=function(e,i,n,a,s){try{if(!e)return;let o=[];const l=t(e.xfrm,a.fromHighPrecisionUnit);let d=new Array;if(i)for(let e of i){if(!e)continue;let t=p(e,a.fromHighPrecisionUnit,a.fromHighPrecisionUnit);t&&d.push(new C.d(t))}e.tx&&function(e,{},i,n,r,a){for(let o of e){if(!o.primitives)continue;let e=new Array;for(const t of o.primitives){var s;if(null!=t&&null!==(s=t.p)&&void 0!==s&&s.pts.length){let i=p(t.p,n.fromHighPrecisionUnit,n.fromHighPrecisionUnit);if(!i)continue;i.lineEnabled=!0,i.fillMode=C.e.normal,e.push(new C.d(i))}else if(t.r){const r=g(t.r,n,i);e.push(...r)}}const l={fromLowPrecisionUnit:n.fromLowPrecisionUnit,fromHighPrecisionUnit:n.fromLowPrecisionUnit,fromInch:n.fromInch};let d=h(o.style,l,a);const c=t(o.xfrm,n.fromHighPrecisionUnit);let u=new T.j(e,d,void 0,c);u.overlapMode=T.i.winding,u.mergeMode=o.union?T.h.union:T.h.fragment,u.role=T.k.text,r.push(u)}}(e.tx,l,n,a,o,s);let c=h(e.style,a,s);const _=e.fx?u(e.fx,a.fromHighPrecisionUnit,.01):void 0;if(e.tx){let t=_?new I.a(void 0,void 0,_.innerShadow,void 0,_.softEdges):void 0,i=_?new I.a(_.glow,_.shadow,void 0,_.reflection,void 0):void 0;const r=new T.j(d,c,t,l);return e.tl&&(r.text=W(e.tl,n,a,l,s)),new T.d([r,...o],i)}const S=new T.j(d,c,_,l);if(e.tl&&(S.text=W(e.tl,n,a,l,s)),void 0!==e.ioff){let t=[];for(const i of e.ioff){const e=new m.f(i.x*a.fromHighPrecisionUnit,i.y*a.fromHighPrecisionUnit);t.push(e)}t.length>0&&(S.instances=t.map(e=>new T.e(m.c.Translation2D(e))))}if(e.s3d){const t=e.s3d.tb?new M(V(e.s3d.tb.p),new m.f(e.s3d.tb.w*a.fromLowPrecisionUnit,e.s3d.tb.h*a.fromLowPrecisionUnit)):void 0,i=e.s3d.bb?new M(V(e.s3d.bb.p),new m.f(e.s3d.bb.w*a.fromLowPrecisionUnit,e.s3d.bb.h*a.fromLowPrecisionUnit)):void 0,n=function(e,t,i,n){let r=t,a=f.Default,s=y.d.Black,o=y.d.Black,l=y.d.Black,d=0,c=!1,h=0,u=0;switch(e){case 0:o=t,c=!0;break;case 1:s=y.d.White,o=t,d=32,c=!0;break;case 2:const e=y.d.InterpolateLinear(t,y.d.Black,1/3);r=e,s=t,o=e,d=32,c=!0,a=f.Metal;break;case 3:a=f.Wireframe;break;case 4:o=t;break;case 5:s=y.d.Gray(.6),o=t,d=12;break;case 6:let i=y.d.InterpolateLinear(t,y.d.White,.2);i=y.d.InterpolateLinear(i,y.d.White,1.4),s=i,o=t,d=12,h=4,a=f.Metal;break;case 7:s=y.d.Gray(.3),o=t,d=8;break;case 8:{const e=new y.d(t.r,t.g,t.b,.7);r=e,s=y.d.Gray(.3),o=e,d=10,c=!0,h=2,u=-1;break}case 9:r=y.d.InterpolateLinear(t,y.d.White,.5),s=y.d.Gray(.3),o=y.d.InterpolateLinear(t,y.d.White,.5),d=10,c=!0,h=2;break;case 10:s=y.d.White,o=t,d=35,h=-2;break;case 11:s=y.d.White,o=t,d=35,h=4,u=-10;break;case 12:{const e=new y.d(t.r,t.g,t.b,.1);r=e,s=y.d.Gray(.6),o=e,d=20,h=-8,u=1;break}case 13:r=new y.d(0,0,0,t.a),s=y.d.Gray(.8),l=t,d=50,h=-4,u=1;break;case 14:r=y.d.InterpolateLinear(t,y.d.White,.5),o=t,d=8,a=f.Metal;break;default:s=y.d.White,o=t,d=40}return i||0!=e&&1!=e&&2!=e||(r=new y.d(0,0,0,t.a),s=y.d.Gray(.8),o=y.d.Black,l=t,d=50,c=!1,h=-4,u=0),new A(a,r,s,o,l,d,c,h,u)}(e.s3d.mt,y.d.White,c.fillBrush instanceof y.v&&c.lineBrush instanceof y.v),s=e.s3d.cc?r(e.s3d.cc.v):n.materialType==f.Wireframe?y.d.Black:void 0,o=e.s3d.cc?e.s3d.cw*a.fromLowPrecisionUnit:0,l=e.s3d.xc?r(e.s3d.xc.v):void 0,d=new R(t,i,n,l,e.s3d.h*a.fromLowPrecisionUnit,s,o,e.s3d.z*a.fromLowPrecisionUnit);S.shape3D=d}return S}catch(e){s.Error(595637020,"Unexpected exception parsing shape")}}(e,e.pthLst||[],i,n,a),d&&e.c&&(d=new T.d([d]),d.clipBounds=B(e.c,n.fromLowPrecisionUnit));return d&&(d.scene3D=e.scn?function(e){const t=[];for(let i of e.l||[])t.push(new x(new y.d(i.cr,i.cg,i.cb,1),new m.g(i.dx,i.dy,i.dz),i.ws,i.wo,i.d,i.s));return new k(r(e.a),t)}(e.scn):void 0,U(d).partId=l,U(d).renderDataId=e.id,null!=s&&s.defaultClientData&&function(e,t){const i=U(e);for(const e of Object.keys(t))i[e]=t[e]}(d,s.defaultClientData)),d}e.convertDocShapeOrGroup=function(e,t,i,n,r){if(!e)return;const a=12700*i;return z(e,t,{fromLowPrecisionUnit:e.lpu?e.lpu.v*a:1,fromHighPrecisionUnit:e.hpu?e.hpu.v*a:i,fromInch:914400*i},n,r)},e.convertShapeOrGroupRenderData=z}(p||(p={}));var O=i(12),F=i(1);class D{pause(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())}resume(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())}setTime(e){this.isPaused&&(this.m_pausedTimeMs=Date.now()),this.m_timeoutMs=e+(Date.now()-this.m_startTimeMs),this.updateTimeout()}addTime(e){this.m_timeoutMs+=e,this.updateTimeout()}abort(){window.clearTimeout(this.m_timeoutId),this.m_callback=()=>{}}get isPaused(){return this.m_pausedTimeMs>this.m_resumedTimeMs}updateTimeout(){window.clearTimeout(this.m_timeoutId);const e=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(e)&&(this.m_timeoutId=window.setTimeout(this.m_callback,e-(Date.now()-this.m_startTimeMs)))}constructor(e,t,i){this.m_pausedTimeMs=0,this.m_resumedTimeMs=0,this.m_maxTimeoutDurationMs=i?i.maxTimeoutDurationMs:void 0,this.m_callback=e,this.m_timeoutMs=t,this.m_startTimeMs=Date.now(),this.updateTimeout()}}function L(e){const t="abcdefghijklmnopqrstuvwxyz0123456789";return e<=65535?e.toString():e>>24>=36?String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e):t.charAt(e>>24&63)+t.charAt(e>>18&63)+t.charAt(e>>12&63)+t.charAt(e>>6&63)+t.charAt(63&e)}function B(e){return e.clientData?e.clientData:e.clientData={}}function N(e,t){if(!t)return e;if((B(e).partId||"")===t)return e;if(e.getType()!==T.g.group)return null;const i=e;for(const e of i.items.elements){const i=N(e,t);if(i)return i}return null}function V(e){return e.getType()===T.g.shape?e:e.getType()===T.g.group&&e.items.getAt(0).getType()===T.g.shape?e.items.getAt(0):void 0}class W{static getInstance(){return W.s_instance||(W.s_instance=new W)}Error(e,t){g.a.sendTraceTag(e,_.a.msoulscat_Wac_PptSession,S.a.Error,t)}Message(e,t){g.a.sendTraceTag(e,_.a.msoulscat_Wac_PptSession,S.a.Info,t)}}class U{static getInstance(){return U.s_instance||(U.s_instance=new U)}sendTraceTag(e,t,i,n){if(U.s_isRenderingAnimationFrame){const i=F.a.readNumberOrDefault("maxLogsDuringAnimationByTagCooldownMs",1e3),n=F.a.readNumberOrDefault("maxLogsDuringAnimationByTag",100);this.resetRenderingLogCountTimeoutClock?this.resetRenderingLogCountTimeoutClock.setTime(i):this.resetRenderingLogCountTimeoutClock=new D(()=>{const e=[];for(const[t,i]of this.renderingLogCount)i>=n&&e.push(L(t));e.length>0&&g.a.sendTraceTag(507003932,t,S.a.Info,`log cooldown reached, reenabling tags:${e}}`),this.renderingLogCount.clear(),this.resetRenderingLogCountTimeoutClock=void 0},i);const r=this.renderingLogCount.get(e)||0;if(this.renderingLogCount.set(e,r+1),r>=n)return void(r===n&&g.a.sendTraceTag(507003931,t,S.a.Warning,`too many logs during animation, disabling tag:${L(e)}}`))}g.a.sendTraceTag(e,t,i,n)}shipAssertTag(e,t,i,n){g.a.shipAssertTag(e,t,i,n)}debugAssertTag(e,t,i,n){g.a.debugAssertTag(e,t,i,n)}constructor(){this.renderingLogCount=new Map}}let z;function H(e,t,i,n){const r=window.devicePixelRatio||1,a=e.x/t.x,s=e.y/t.y;let o=Math.min(a,s)*r;const l=new m.f(e.x*r,e.y*r);o*=Math.min(1,Math.sqrt(Math.sqrt(2073600/(l.x*l.y)))),o*=F.a.readNumberOrDefault("hackShapeBuilderQualityScale",1);const d=t.x/i.x,c=t.x/l.x,h=25400*d,u=!!(e.x&&e.y&&o);if(u)Object(O.r)(o),Object(E.J)(c,h);else{const e="attempted to set invalid shapebuilder quality";g.a.sendTraceTag(507003930,_.a.msoulscat_Wac_PptSession,S.a.Warning,n?n(new Error(e)):e)}const f=JSON.stringify({quality:o,minLineWidth:c,minLineWidthForArrowHead:h,devicePixelRatio:r,clientWidth:e.x,clientHeight:e.y,slideSizePixels:t,isValid:u});f!==z&&g.a.sendTraceTag(507003929,_.a.msoulscat_Wac_PptSession,S.a.Info,f),z=f}U.s_isRenderingAnimationFrame=!1;var G=i(4);function j(e){try{return["http:","https:","mailto:","ftp:","file:","news:","tel:","onenote:","notes:","mms:","mssv:","bookmark:"].includes(new URL(e).protocol)}catch(e){}return!1}class ${static initShapeItem(e,t,i,n,r,s){let o;if(i.shapeBuilderData){try{o=p.convertDocShapeOrGroup(i.shapeBuilderData,s.viewDataManager.glyphStore,n,W.getInstance(),{defaultClientData:{shapeId:r}})}catch(e){return void g.a.sendTraceTag(507003989,_.a.msoulscat_Wac_PptSession,S.a.Error,`ShapeViewElement::init: ParseJson.convertDocShapeOrGroup threw exception ${e}.`)}if(!o)return void g.a.sendTraceTag(507003988,_.a.msoulscat_Wac_PptSession,S.a.Error,"ShapeViewElement::init: invalid shapeItem after convertRenderData.");for(const i of e){const e=[];for(const t of i.parts){const i=$.toPositionSize(t.regionPos),n=V(o);let r;if(t.fText&&n&&n.text){let s;switch(t.splitBy){case a.letter:s=b.m.ByLetter;break;case a.word:s=b.m.ByWord;break;default:s=b.m.AllAtOnce}r=t.textRange?b.j.FromFirstLast(t.textRange.begin,t.textRange.begin+t.textRange.length-1):n.text.getFullRange();const o=n.text.getAnimatablePartRanges(s,r,!1);if(!o)continue;for(const r of o){let a;if(t.fShape||!F.a.readBooleanOrDefault("useShapeBuilderForClickTargetBounds",!1))a=i;else{const e=new m.e(m.f.Zero,m.f.One,n.transform.rotation,n.transform.translation),t=n.text.getBoundsOfRange(r,e);if(!t)continue;a={position:t.leftTop,size:t.size}}let o=r;s!==b.m.AllAtOnce||t.textRange||(o=void 0);const l={fShape:t.fShape,fText:t.fText,bigParts:t.bigParts,position:a.position,size:a.size,shapeId:t.shapeId,textRange:o};e.push(l)}continue}const s={fShape:t.fShape,fText:t.fText,bigParts:t.bigParts,position:i.position,size:i.size,shapeId:t.shapeId,textRange:r};e.push(s)}t.push({id:i.id,parts:e})}}else{const i=[];for(const n of e){const e=[];for(const t of n.parts){const n=$.toPositionSize(t.regionPos),a=new y.h;a.id=t.regionPos.region.imgID;const s=new y.g(a),o=T.j.CreateRectangle(m.d.FromSize(n.size),new y.x(s),void 0,new m.e(n.position));B(o).shapeId=r,B(o).partId=t.bigParts.length>0?t.bigParts[0]:"",i.push(o);const l={fShape:!0,fText:!0,bigParts:t.bigParts,position:new m.f(t.regionPos.pos.x,t.regionPos.pos.y),size:new m.f(t.regionPos.region.rect.right-t.regionPos.region.rect.left,t.regionPos.region.rect.bottom-t.regionPos.region.rect.top),shapeId:t.shapeId};e.push(l)}t.push({id:n.id,parts:e})}1===i.length?o=i[0]:(o=new T.d(i),B(o).shapeId=r)}return B(o).isBackground=i.isBackground,o}static attachTextures(e,t,i,n){const r={},a=e.viewDataManager.imageDataMap;if(!i.shapeBuilderData){const s=i.animatableContents;for(const o of s)for(const s of o.parts){const o=$.toPositionSize(s.regionPos);if(!a.has(s.regionPos.region.imgID))continue;const l=a.get(s.regionPos.region.imgID),d=l.size;if(!d)return r;const c=new m.f((s.regionPos.region.rect.right+s.regionPos.region.rect.left)/2,(s.regionPos.region.rect.bottom+s.regionPos.region.rect.top)/2);$.verifyTextureSize(e,"attachTextures_fallback",o.size);const h=new y.h;h.id=s.regionPos.region.imgID;const u=n&&n.shapeId&&F.a.readBooleanOrDefault("useDetailedTextureScenario",!0)?`FallbackShape-Slide:${n.shapeId.slideId.sid}-Shape:${n.shapeId.shapeId}-Image:${h.id}`:"FallbackShape";e.rendererEnvironment.attachImage(u,h,l,o.size),l.loadedShapeIDs.push(i.shapeId.shapeId);const f=new y.g(h);f.scale=d.divide(o.size),f.offset=d.scale(.5).subtract(c).divide(o.size);const p=$.findShapeWithImageId(t,s.regionPos.region.imgID);p&&(p.style=new y.x(f))}return r}for(const n of t.getBrushImages()){if(!n.id)continue;if(!a.has(n.id)){g.a.sendTraceTag(507003987,_.a.msoulscat_Wac_PptSession,S.a.Error,`ShapeViewElement::attachTextures: Missing texture. Id: ${n.id}, imageDataMap:${!!a.has(n.id)}`),r.hasOwnProperty("missingTextureIds")||(r.missingTextureIds=[]),r.missingTextureIds.push(n.id);continue}const t=a.get(n.id);$.verifyTextureSize(e,"attachTextures_nonfallback",t.size),e.rendererEnvironment.attachImage("Shape",n,t,t.size),t.loadedShapeIDs.push(i.shapeId.shapeId)}return r}static toPositionSize(e){return{position:e?new m.f(e.pos.x,e.pos.y):m.f.Zero,size:e?new m.f(e.region.rect.right-e.region.rect.left,e.region.rect.bottom-e.region.rect.top):m.f.One}}static removeFromScene(e,t){const i=e.items.elements.slice(0);i.splice(e.items.elements.indexOf(t),1),e.setItems(i)}static applyAnimationToShapeItemAndClickTarget(e,t,i){const n=e.Attributes,r=e.Shape,a=new m.f(r.position.x,r.position.y),s=new m.f(r.size.x,r.size.y),o={position:new m.f(v.b.getAnimAttributeValue(n,v.c.PosX,a.x),v.b.getAnimAttributeValue(n,v.c.PosY,a.y)),scale:new m.f(v.b.getAnimAttributeValue(n,v.c.ScaleW,1),v.b.getAnimAttributeValue(n,v.c.ScaleH,1)),fadeMaskInfo:v.b.getAnimAttributeValue(n,v.c.FadeMaskInfo,void 0),fadeMaskProgress:v.b.getAnimAttributeValue(n,v.c.FadeMaskProgress,0),angle:v.b.getAnimAttributeValue(n,v.c.Rotate,0),startingPosition:a,visible:v.b.getAnimAttributeValue(n,v.c.Visible,0)},l=new m.f(o.position.x-o.startingPosition.x,o.position.y-o.startingPosition.y),d=a.add(s.scale(.5)),c=new m.e(d.negate(),o.scale,o.angle,l.add(d)),h=!o.visible;let u;if(o.fadeMaskInfo){const e=!!(1&o.fadeMaskInfo.flags),t=!!(2&o.fadeMaskInfo.flags),i=!!(4&o.fadeMaskInfo.flags),n=!!(8&o.fadeMaskInfo.flags),r=!!(16&o.fadeMaskInfo.flags);u=new w.c(o.fadeMaskInfo.preset,o.fadeMaskInfo.param,i,n,e,t,r),u.progress=o.fadeMaskProgress}const f=function e(t,i){if(!i||0===i.length)return[t];const n=B(t).partId||"";for(const e of i)if(n===e)return[t];if(t.getType()!==T.g.group)return null;let r=[];const a=t;for(const t of a.items.elements){const n=e(t,i);n&&(r=r.concat(n))}return 0===r.length?null:r}(t,r.bigParts)||[t];for(const e of f)if(r.fShape&&(e.animationTransform=c.toMatrix3(),e.isHidden=h,e.fade=u),r.fText){const t=V(e);if(t&&t.text&&r.textRange){const e=new b.l,i=r.textRange;e.animationTransform=c.toMatrix3(),e.fade=u,e.isHidden=h,t.text.animationProps||t.text.createAnimationProps(),t.text.animationProps&&t.text.animationProps.set(e,i)}}if(i.clickTargets)for(let t=0;t<i.clickTargets.length;t+=1){const n=i.clickTargets[t],r=document.getElementById(`sp-${JSON.stringify(i.shapeId)}-i-${t}`);if(!r)continue;if($.getAnimatableContentIdFromClickTarget(n)!==(-1!==e.Id.indexOf("c")?e.Id.split("c")[0]:e.Id))continue;if(!o.visible){r.style.display="none";continue}const a=F.a.readBooleanOrDefault("useShapeBuilderForClickTargetBounds",!1)?m.d.FromSize(s):$.getAnimatableContentRegionFromClickTarget(n);a&&($.setClickTargetRegion(r,a,o.position),r.style.display="block")}}static setClickTargetRegion(e,t,i){e.style.position="absolute",e.style.left=i.x+t.left+"px",e.style.top=i.y+t.top+"px";const n={left:i.x+t.left,top:i.y+t.top,right:i.x+t.right,bottom:i.y+t.bottom},r=document.getElementById(Mn.ClickTargetsReferenceDivId);if(r){const t={left:0,top:0,right:r.offsetWidth,bottom:r.offsetHeight},i=F.a.readBooleanOrDefault("hackClickTargets",!1)?n:$.findIntersectingRect(n,t);if(!i)return e.style.display="none",e.style.width="0px",void(e.style.height="0px");e.style.display="block",e.style.width=i.right-i.left+"px",e.style.height=i.bottom-i.top+"px"}}static findShapeWithImageId(e,t){if(!e)return;const i=e=>e.getBrushImages().findIndex(e=>e.id===t)>=0;if(e.getType()===T.g.shape){const t=e;return i(t)?t:void 0}if(e.getType()!==T.g.group)return;const n=e;for(const e of n.items.elements){if(e.getType()!==T.g.shape)return;const t=e;if(i(t))return t}}static getAnimatableContentIdFromClickTarget(e){return e.action?e.action.animatableContentId:e.animation?e.animation.animatableContentId:e.hyperlink?e.hyperlink.animatableContentId:e.zoom?e.zoom.animatableContentId:void 0}static getAnimatableContentRegionFromClickTarget(e){return e.action?e.action.region:e.animation?e.animation.region:e.hyperlink?e.hyperlink.region:e.zoom?e.zoom.region:void 0}static findIntersectingRect(e,t){const i=Math.max(e.left,t.left),n=Math.min(e.right,t.right),r=Math.max(e.top,t.top),a=Math.min(e.bottom,t.bottom);if(n>=i&&a>=r)return{left:i,top:r,right:n,bottom:a}}static verifyTextureSize(e,t,i){!e.stringifyError||"number"==typeof i.x&&i.x>0&&"number"==typeof i.y&&i.y>0||g.a.sendTraceTag(507003986,_.a.msoulscat_Wac_PptSession,S.a.Error,e.stringifyError(new Error(`verifyTextureSize: invalid size. scenario: ${t}, x:${i.x}, y:${i.y}`)))}static ensureShapeViewElementParentDiv(e,t,i){const n=i?`${Mn.SlideLevelHtmlElementsDivId}-${JSON.stringify(e)}-${Mn.CrossSlideShapeId}`:`${Mn.SlideLevelHtmlElementsDivId}-${JSON.stringify(e)}`;let r=document.getElementById(n);if(r)return r;const a=document.getElementById(Mn.SlideLevelHtmlElementsParentDivId);return r=document.createElement("div"),r.style.position="absolute",r.id=n,r.style.zIndex=t,a&&a.appendChild(r),r}static ensureAccessibilityElement(e){const t=document.getElementById(Mn.SlideLevelHtmlElementsParentDivId);if(t){const i=this.generateShapeLevelAccessibilityElementId(e);if(document.getElementById(i))return;const n=document.createElement("div");n.id=i,n.style.display="none",t.appendChild(n)}}static ensureSlideTitleElement(){let e=document.getElementById(Mn.AccessibilitySlideTitleId);if(e)return e;const t=document.getElementById(Mn.SlideLevelHtmlElementsParentDivId);return e=document.createElement("span"),e.id=Mn.AccessibilitySlideTitleId,t&&t.firstChild?t.insertBefore(e,t.firstChild):t&&t.appendChild(e),e}static generateShapeLevelAccessibilityElementId(e){return`${Mn.ShapeAccessibilityElementId}-sid:${e.slideId.sid}-shapeId:${e.shapeId}`}static generateShapeIdString(e){return`sid:${e.slideId.sid}-shapeId:${e.shapeId}`}static getLinkTooltipText(e){var t;const i=e.getAttribute("data-screentip");return null===i?null!==(t=e.href.baseVal)&&void 0!==t?t:void 0:i}static handleLinkMouseEnter(e,t){var i;const n=t.target;null===(i=e.getTooltip())||void 0===i||i.showTooltip($.getLinkTooltipText(n),t.clientX,t.clientY)}static handleLinkMouseLeave(e){var t;null===(t=e.getTooltip())||void 0===t||t.hideTooltipAfterDelay()}static handleLinkFocusIn(e,t){var i;const n=t.target,r=n.getBoundingClientRect();null===(i=e.getTooltip())||void 0===i||i.showTooltip($.getLinkTooltipText(n),r.x,r.y)}static handleLinkFocusOut(e){var t;null===(t=e.getTooltip())||void 0===t||t.hideTooltip()}static ensureClickTarget(e,t,i,n){if(t.clickTargets&&!document.getElementById(`${Mn.SlideLevelHtmlElementsDivId}-${JSON.stringify(e)}`))for(const[r,a]of t.clickTargets.entries()){const s=$.getAnimatableContentIdFromClickTarget(a),l=t.animatableContents.find(e=>e.id===s);if(!l)return;const d=l.parts[0].regionPos.pos;if(a.action){const t=a.action,s=$.ensureClickTargetDiv(e);if(G.ChangeGate.isChangeGateEnabled("SVM.InternalLinkFixes")){const a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"a");o.tabIndex=0,o.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&(i.emit("clickTarget-gotoSlide",t.slideId),e.stopImmediatePropagation())},o.style.pointerEvents="auto",o.style.background="none",o.style.border="none",o.style.padding="0",o.style.cursor="pointer",o.id=`sp-${JSON.stringify(e)}-i-${r}`,o.onclick=()=>{i.emit("clickTarget-gotoSlide",t.slideId)},t.tip&&o.setAttributeNS(null,"data-screentip",t.tip),o.textContent=t.desc,o.style.color="rgba(0,0,0,0)",G.ChangeGate.isChangeGateEnabled("SVM.CustomTooltipForLink")&&(o.addEventListener("mouseenter",e=>$.handleLinkMouseEnter(n,e)),o.addEventListener("mouseleave",e=>$.handleLinkMouseLeave(n)),o.addEventListener("focusin",e=>$.handleLinkFocusIn(n,e)),o.addEventListener("focusout",e=>$.handleLinkFocusOut(n)));for(const e of t.subRegions){const i=document.createElementNS(a,"rect");i.setAttributeNS(null,"x",(e.left-t.region.left).toString()),i.setAttributeNS(null,"y",(e.top-t.region.top).toString()),i.setAttributeNS(null,"height",(e.bottom-e.top).toString()),i.setAttributeNS(null,"width",(e.right-e.left).toString()),i.setAttributeNS(null,"fill-opacity","0"),o.appendChild(i)}const l=document.createElementNS(a,"svg");l.id=`sp-${JSON.stringify(e)}-i-${r}`,l.setAttribute("role","presentation"),l.classList.add("svm-interactive-element-focus-class"),l.setAttributeNS(null,"viewbox",`${t.region.left} ${t.region.top} ${(t.region.right-t.region.left).toString()} ${(t.region.bottom-t.region.top).toString()}`),F.a.readBooleanOrDefault("hackClickTargets",!1)&&(l.style.backgroundColor="rgba(0,0,0,0.5)"),l.appendChild(o),s.appendChild(l),$.setClickTargetRegion(l,t.region,d)}else{const n=document.createElement("a");n.tabIndex=0,n.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&(i.emit("clickTarget-gotoSlide",t.slideId),e.stopImmediatePropagation())},n.style.pointerEvents="auto",n.style.background="none",n.style.border="none",n.style.padding="0",n.style.cursor="pointer",n.title="",n.id=`sp-${JSON.stringify(e)}-i-${r}`,n.onclick=()=>{i.emit("clickTarget-gotoSlide",t.slideId)},F.a.readBooleanOrDefault("hackClickTargets",!1)&&(n.style.backgroundColor="rgba(0,0,0,0.5)"),s.appendChild(n),$.setClickTargetRegion(n,t.region,d)}}if(a.hyperlink){const t=a.hyperlink;if(!j(t.url))continue;const i=this.ensureClickTargetDiv(e),s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"a");o.style.pointerEvents="auto",o.setAttributeNS(null,"href",t.url),o.setAttributeNS(null,"rel","noreferrer"),o.setAttributeNS(null,"target","_blank");const l=t.tip?t.tip:t.url;if(G.ChangeGate.isChangeGateEnabled("SVM.CustomTooltipForLink")?t.tip&&o.setAttributeNS(null,"data-screentip",t.tip):o.setAttributeNS(null,"title",l),o.textContent=t.desc?t.desc:t.url,o.style.color="rgba(0,0,0,0)",F.a.readBooleanOrDefault("stopPropagationForKeyDown",!0)&&(o.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&e.stopImmediatePropagation()}),G.ChangeGate.isChangeGateEnabled("SVM.CustomTooltipForLink"))o.addEventListener("mouseenter",e=>$.handleLinkMouseEnter(n,e)),o.addEventListener("mouseleave",e=>$.handleLinkMouseLeave(n)),o.addEventListener("focusin",e=>$.handleLinkFocusIn(n,e)),o.addEventListener("focusout",e=>$.handleLinkFocusOut(n));else{const e=document.createElementNS(s,"title");e.textContent=l,o.appendChild(e)}for(const e of t.subRegions){const i=document.createElementNS(s,"rect");i.setAttributeNS(null,"x",(e.left-t.region.left).toString()),i.setAttributeNS(null,"y",(e.top-t.region.top).toString()),i.setAttributeNS(null,"height",(e.bottom-e.top).toString()),i.setAttributeNS(null,"width",(e.right-e.left).toString()),i.setAttributeNS(null,"fill-opacity","0"),o.appendChild(i)}const c=document.createElementNS(s,"svg");c.id=`sp-${JSON.stringify(e)}-i-${r}`,c.setAttribute("role","presentation"),c.classList.add("svm-interactive-element-focus-class"),c.setAttributeNS(null,"viewbox",`${t.region.left} ${t.region.top} ${(t.region.right-t.region.left).toString()} ${(t.region.bottom-t.region.top).toString()}`),F.a.readBooleanOrDefault("hackClickTargets",!1)&&(c.style.backgroundColor="rgba(0,0,0,0.5)"),c.appendChild(o),i.appendChild(c),$.setClickTargetRegion(c,t.region,d)}if(a.zoom){const t=a.zoom,n=this.ensureClickTargetDiv(e),s=document.createElement("a");s.tabIndex=0,s.onkeydown=e=>{if(e&&e.key&&"enter"===e.key.toLowerCase()){if(t.type===o.Slide){const e={slideId:t.slideId,returnToParent:t.returnToParent};i.emit("clickTarget-gotoZoomSlide",e)}else if(t.type===o.Section){const e={sectionId:t.sectionId,returnToParent:t.returnToParent};i.emit("clickTarget-gotoZoomSection",e)}e.stopImmediatePropagation()}},s.style.pointerEvents="auto",s.style.background="none",s.style.border="none",s.style.padding="0",s.style.cursor="pointer",s.title="",s.id=`sp-${JSON.stringify(e)}-i-${r}`,s.onclick=()=>{const e={slideId:t.slideId,returnToParent:t.returnToParent};if(t.type===o.Slide)i.emit("clickTarget-gotoZoomSlide",e);else if(t.type===o.Section){const e={sectionId:t.sectionId,returnToParent:t.returnToParent};i.emit("clickTarget-gotoZoomSection",e)}},F.a.readBooleanOrDefault("hackClickTargets",!1)&&(s.style.backgroundColor="rgba(0,0,0,0.5)"),n.appendChild(s),$.setClickTargetRegion(s,t.region,d)}if(a.animation){const t=a.animation,n=this.ensureClickTargetDiv(e),s=document.createElement("a");s.tabIndex=0,s.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&(i.emit("clickTarget-interactiveAnimation",t.sequenceId),e.stopImmediatePropagation())},s.style.pointerEvents="auto",s.style.background="none",s.style.border="none",s.style.padding="0",s.style.cursor="pointer",s.title="",s.id=`sp-${JSON.stringify(e)}-i-${r}`,s.onclick=()=>{i.emit("clickTarget-interactiveAnimation",t.sequenceId)},F.a.readBooleanOrDefault("hackClickTargets",!1)&&(s.style.backgroundColor="rgba(0,0,0,0.5)"),n.appendChild(s),$.setClickTargetRegion(s,t.region,d)}}}static ensureClickTargetDiv(e){const t=$.ensureShapeViewElementParentDiv(e,"2");return t.style.pointerEvents="none",t}}class q{ensure(){return this.m_shapeItem||this.init(),this.m_shapeItem?$.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData,{shapeId:this.id}):(g.a.sendTraceTag(507004113,_.a.msoulscat_Wac_PptSession,S.a.Error,"ShapeViewElement::ensureTexture: invalid shapeItem."),{invalidShape:!0})}init(){this.animatableContentViewElements=[],this.m_shapeItem=$.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment)}getAllZoomsOnShape(){const e=[];if(this.m_shapeViewData&&this.m_shapeViewData.clickTargets)for(const[t,i]of this.m_shapeViewData.clickTargets.entries())i.zoom&&e.push(i.zoom);return e}update(){$.ensureClickTarget(this.id,this.m_shapeViewData,this.m_slideEvents,this.m_environment),$.ensureAccessibilityElement(this.id)}applyAnimation(e){this.m_shapeItem&&$.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}tryPrepare(e){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,e),this.m_environment.rendererEnvironment.flush()),this.fPrepared}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){if(this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)){const t=e.items.elements.slice(0);t.splice(e.items.elements.indexOf(this.m_shapeItem),1),e.setItems(t)}}cleanUp(){}get shapeItem(){return this.m_shapeItem}constructor(e,t,i,n,r,a){this.shapeType=u.Shape,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=e.id,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_slideEvents=n,this.m_environment=r,this.m_shapeItem=a&&a.item||void 0}}var Z=i(34),J=i(10),X=i(28);class Y{static getInstance(e){return this.m_instance||(this.m_instance=new this(e)),this.m_instance}get cameoSharedTexture(){if(!this.m_cameoSharedTexture)try{if(this.m_environment.rendererEnvironment.glContext&&this.m_environment.rendererEnvironment.isGLContextValid){const e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);this.m_cameoSharedTexture=O.c.CreateFromByteBuffer("Cameo",this.m_environment.rendererEnvironment.renderer,new m.f(2,2),new Uint8Array(e),X.d.BGRA,y.y.clamp,!0,!0),this.m_environment.viewDataManager.memoryStats.cameoTextures+=16,g.a.sendTraceTag(507003872,_.a.msoulscat_Wac_PptSession,S.a.Info,"CameoTextureManager::get_cameoSharedTexture Blank Texture initialized")}else J.e.recordVeto("CameoRenderedWithIssues",{errorName:"MorphBlankTextureInitFailed",qosVeto:"CameoRenderedWithIssues"}),g.a.sendTraceTag(507003871,_.a.msoulscat_Wac_PptSession,S.a.Warning,"CameoTextureManager::get_cameoSharedTexture glContext unavailable. Morph (if any) may not work as expected.")}catch(e){J.e.recordVeto("CameoRenderedWithIssues",{errorName:"MorphBlankTextureInitFailed",qosVeto:"CameoRenderedWithIssues"}),g.a.sendTraceTag(507003870,_.a.msoulscat_Wac_PptSession,S.a.Warning,`CameoTextureManager::get_cameoSharedTexture: Morph may not work as expected due to exception creating blank texture=${e}.`)}return this.m_cameoSharedTexture}subscribeToSharedTexture(){this.m_subscriberCount+=1,g.a.sendTraceTag(507003869,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoTextureManager::subscribeToSharedTexture: subscribersCount=${this.m_subscriberCount}.`)}unsubscribeFromSharedTexture(){this.m_subscriberCount>0&&(this.m_subscriberCount-=1,g.a.sendTraceTag(507003868,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoTextureManager::unsubscribeFromSharedTexture: subscribersCount=${this.m_subscriberCount}.`),0===this.m_subscriberCount&&this.releaseTexture())}processFrameForCameo(e,t){if(F.a.readBooleanOrDefault("forceSvg",!1))this.m_fSVGFallbackMode||(this.m_fSVGFallbackMode=!0,g.a.sendTraceTag(507003867,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoTextureManager::processFrameForCameo: Modern SS has fallen back to SVG mode"),J.e.recordVeto("CameoInSVG",{errorName:"WebGLNotAvailable",qosVeto:"CameoInSVG",isIntentional:!0}));else{if(this.m_fSVGFallbackMode&&!this.m_fSVGFallbackModeErrorLogged&&(g.a.sendTraceTag(507003866,_.a.msoulscat_Wac_PptSession,S.a.Warning,"CameoTextureManager::processFrameForCameo: Modern SS seems to have unexpectedly recovered from SVG mode."),this.m_fSVGFallbackModeErrorLogged=!0),!t||!e)return g.a.sendTraceTag(507003865,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoTextureManager::processFrameForCameo: invalid input buffer or buffer metadata not provided."),this.logVetoIfCameoNotRendering(Date.now(),"EmptyBufferOrMetadata"),void this.releaseTexture();if(this.m_subscriberCount>0){const i=this.parseArrayBufferMetadata(e);i&&this.updateTextureFromArrayBuffer(t,i)}}}releaseTexture(){if(this.m_cameoSharedTexture){const e=this.m_cameoSharedTexture.size;this.m_cameoSharedTexture.release(),this.m_environment.viewDataManager.memoryStats.cameoTextures-=e.x*e.y*4,this.m_cameoSharedTexture=void 0,this.events.emit("cameoSharedTextureReleased"),g.a.sendTraceTag(507003864,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoTextureManager::releaseTexture: subscribersCount=${this.m_subscriberCount}.`)}}setVideoElement(e){this.m_videoElement=e}updateTextureFromVideoElement(){try{if(!this.m_videoElement||this.m_subscriberCount<=0)return;if(F.a.readBooleanOrDefault("forceSvg",!1))return void(this.m_fSVGFallbackMode||(this.m_fSVGFallbackMode=!0,g.a.sendTraceTag(507003863,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoTextureManager::updateTextureFromVideoElement: In SVG mode thus unable to render"),J.e.recordVeto("CameoInSVG",{errorName:"WebGLNotAvailable",qosVeto:"CameoInSVG",isIntentional:!0})));const e=this.m_environment.rendererEnvironment.glContext;if(!e||e.isContextLost())return this.m_fGLContextLostErrorLogged||(g.a.sendTraceTag(507003862,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoTextureManager::updateTextureFromVideoElement: Unable to update frame due to missing gl context"),this.m_fGLContextLostErrorLogged=!0),this.logVetoIfCameoNotRendering(Date.now(),"RenderingContextLost"),void this.releaseTexture();if(!this.isVideoReadyForTextureExtraction(this.m_videoElement))return this.logVetoIfCameoNotRendering(Date.now(),"VideoElementError"),void this.releaseTexture();G.ChangeGate.isChangeGateEnabled("SVM.enableResizeSupportForMediaStreamCameo")&&this.updateVideoElementDimensions();const t=this.m_frameSize?this.m_frameSize.x*this.m_frameSize.y*4:0;this.m_frameSize=new m.f(this.m_videoElement.width,this.m_videoElement.height),this.m_cameoSharedTexture=O.c.CreateOrUpdateFromHTMLElement("Cameo",this.m_cameoSharedTexture,this.m_environment.rendererEnvironment.renderer,this.m_videoElement),this.m_lastGoodTextureUpdateTime=Date.now(),this.events.emit("cameoSharedTextureUpdated",this.m_frameSize);const i=this.m_frameSize.x*this.m_frameSize.y*4;i!==t&&(this.m_environment.viewDataManager.memoryStats.cameoTextures+=i-t)}catch(e){g.a.sendTraceTag(507003861,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoTextureManager::updateTextureFromVideoElement: exception ${e}.`),this.logVetoIfCameoNotRendering(Date.now(),"TextureCreateOrUpdateException"),this.releaseTexture()}}isVideoReadyForTextureExtraction(e){return!(!e||e.paused||e.ended||e.error||!e.srcObject||!e.srcObject.active||!this.isVideoLoaded(e))}isVideoLoaded(e){return!!e&&e.readyState>=3}updateVideoElementDimensions(){if(this.m_videoElement&&(this.m_videoTrack||(this.m_videoTrack=this.getVideoTrackFromElement(this.m_videoElement)),this.m_videoTrack)){const e=this.m_videoTrack.getSettings();e.width&&e.height&&(e.width!==this.m_videoElement.width||e.height!==this.m_videoElement.height)&&(this.m_videoElement.width=e.width,this.m_videoElement.height=e.height,g.a.sendTraceTag(507003860,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoTextureManager::updateVideoElementDimensions: detected resolution change to width=${e.width}, height=${e.height}`))}}getVideoTrackFromElement(e){if(!e||!e.srcObject)return;const t=e.srcObject;if(!t)return;const i=t.getVideoTracks();return i&&i.length>0?i[0]:void 0}parseArrayBufferMetadata(e){try{const t=JSON.parse(e),i=t.width,n=t.height;return i&&n?"number"==typeof i&&i>0&&"number"==typeof n&&n>0?{width:i,height:n,format:this.getTextureFormatFromString(t.format)}:(g.a.sendTraceTag(507003857,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoTextureManager::parseArrayBufferMetadata: invalid frame size, x:${i}, y:${n}`),this.logVetoIfCameoNotRendering(Date.now(),"InvalidFrameSize"),void this.releaseTexture()):(0===i&&0===n?this.m_cameoSharedTexture&&g.a.sendTraceTag(507003859,_.a.msoulscat_Wac_PptSession,S.a.Info,"CameoTextureManager::parseArrayBufferMetadata: Received 0x0 frame from MSTeams. Cleared texture."):(g.a.sendTraceTag(507003858,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoTextureManager::parseArrayBufferMetadata: unable to parse valid frame metadata."),this.logVetoIfCameoNotRendering(Date.now(),"FrameDimensionsMissing")),void this.releaseTexture())}catch(e){return g.a.sendTraceTag(507003856,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoTextureManager::parseArrayBufferMetadata: exception ${e}.`),this.logVetoIfCameoNotRendering(Date.now(),"FrameMetadataParseFailure"),void this.releaseTexture()}}updateTextureFromArrayBuffer(e,t){try{const i=this.m_environment.rendererEnvironment.glContext;if(!i||i.isContextLost())return this.m_fGLContextLostErrorLogged||(g.a.sendTraceTag(507003855,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoTextureManager::updateTextureFromArrayBuffer: Unable to update frame due to missing gl context"),this.m_fGLContextLostErrorLogged=!0),this.logVetoIfCameoNotRendering(Date.now(),"RenderingContextLost"),void this.releaseTexture();const n=this.m_frameSize?this.m_frameSize.x*this.m_frameSize.y*4:0;this.m_frameSize=new m.f(t.width,t.height),this.m_cameoSharedTexture=O.c.CreateOrUpdateFromByteBuffer("Cameo",this.m_cameoSharedTexture,this.m_environment.rendererEnvironment.renderer,this.m_frameSize,new Uint8Array(e),t.format,y.y.clamp,!0,!0,void 0,!0),this.m_lastGoodTextureUpdateTime=Date.now(),this.events.emit("cameoSharedTextureUpdated",this.m_frameSize);const r=this.m_frameSize.x*this.m_frameSize.y*4;r!==n&&(this.m_environment.viewDataManager.memoryStats.cameoTextures+=r-n)}catch(e){g.a.sendTraceTag(507003854,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoTextureManager::updateTextureFromArrayBuffer: exception ${e}.`),this.logVetoIfCameoNotRendering(Date.now(),"TextureCreateOrUpdateException"),this.releaseTexture()}}getTextureFormatFromString(e){if(e){const t=e.toUpperCase();if(this.m_supportedFormats.includes(t)){if("BGRA"===t)return X.d.BGRA;if("NV12"===t)return X.d.NV12}}return X.d.RGBA}logVetoIfCameoNotRendering(e,t){if(!this.m_lastGoodTextureUpdateTime)return;const i=e-this.m_lastGoodTextureUpdateTime;i>=F.a.readNumberOrDefault("cameoNotRenderingThresholdMs",5e3)&&(g.a.sendTraceTag(507003853,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoTextureManager::logVetoIfCameoNotRendering: No successful texture update in ${i/1e3} seconds, latest error: ${t}`),J.e.recordVeto("CameoNotRendering",{qosVeto:"CameoNotRendering",errorName:t,textureUpdateDelay:i}),this.m_lastGoodTextureUpdateTime=void 0)}constructor(e){this.events=new Z.EventEmitter,this.m_subscriberCount=0,this.m_fGLContextLostErrorLogged=!0,this.m_fSVGFallbackMode=!1,this.m_fSVGFallbackModeErrorLogged=!1,this.m_supportedFormats=["RGBA","BGRA","NV12"],this.m_lastGoodTextureUpdateTime=void 0,this.m_environment=e}}class K{ensure(){this.m_shapeItem||this.init();const e={};return this.m_shapeItem?{...e}:(g.a.sendTraceTag(507004174,_.a.msoulscat_Wac_PptSession,S.a.Error,"CameoViewElement::ensure: invalid shapeItem."),J.e.recordVeto("CameoNotRendering",{errorName:"FailedShapeItemInit",qosVeto:"CameoNotRendering"}),e.invalidShape=!0,e)}ensureCameoTextureAttached(){this.attachSharedTextureToShapeImage()}init(){if(this.animatableContentViewElements=[],this.m_shapeItem=$.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.isFallbackCameoBrush()&&(g.a.sendTraceTag(507004173,_.a.msoulscat_Wac_PptSession,S.a.Warning,"CameoViewElement::init: Cameo in FillBrush fallback"),J.e.recordVeto("CameoRenderedWithIssues",{errorName:"CameoFillBrushFallback",qosVeto:"CameoRenderedWithIssues"})),this.m_originalLineBrush=this.getLineBrush(),this.clearLineBrush(),this.m_originalScale&&this.m_originalOffset||(this.m_originalScale=this.getImageBrushScale(),this.m_originalOffset=this.getImageBrushOffset(),g.a.sendTraceTag(507004172,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoViewElement::init: originalBrushScale=${this.getFormattedVectorString(this.m_originalScale)}, originalBrushOffset=${this.getFormattedVectorString(this.m_originalOffset)}`)),this.setAlphaInvariant(),this.m_shapeItem){let e;if(this.m_shapeItem.transform&&0!==this.m_shapeItem.transform.rotation){const t=this.m_shapeItem.transform.toInverseMatrix3().tryGetTransform(this.m_shapeItem.transform.preTranslation);t||(g.a.sendTraceTag(507004171,_.a.msoulscat_Wac_PptSession,S.a.Warning,"CameoViewElement::init: element is rotated but failed to grab inverse transform. Aspect ratio adjustment may be incorrect!"),J.e.recordVeto("CameoRenderedWithIssues",{errorName:"AspectRatioForRotatedCameo",qosVeto:"CameoRenderedWithIssues"})),e=this.m_shapeItem.getBounds(!1,!1,!1,t)}else e=this.m_shapeItem.getBounds(!1,!1,!1);if(e){const t=e.width,i=e.height;this.isCropped()&&this.m_originalScale?this.m_size=new m.f(t*this.m_originalScale.x,i*this.m_originalScale.y):this.m_size=new m.f(t,i)}}this.ensureCameoTextureAttached()}update(){G.ChangeGate.isChangeGateEnabled("SVM.LinkForCameo")&&$.ensureClickTarget(this.id,this.m_shapeViewData,this.m_slideEvents,this.m_environment)}applyAnimation(e){this.m_shapeItem&&$.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem),this.m_cameoTextureManager.events.on("cameoSharedTextureUpdated",this.onCameoSharedTextureUpdated),this.m_cameoTextureManager.events.on("cameoSharedTextureReleased",this.onCameoSharedTextureReleased),this.m_cameoTextureManager.subscribeToSharedTexture()}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&$.removeFromScene(e,this.m_shapeItem),this.m_cameoTextureManager.events.off("cameoSharedTextureUpdated",this.onCameoSharedTextureUpdated),this.m_cameoTextureManager.events.off("cameoSharedTextureReleased",this.onCameoSharedTextureReleased),this.m_cameoTextureManager.unsubscribeFromSharedTexture(),this.clearLineBrush()}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.rendererEnvironment.flush()),this.fPrepared}cleanUp(){}get shapeItem(){return this.m_shapeItem}getCameoInfo(){return{m_cameoId:$.generateShapeIdString(this.id),m_heightInPixels:this.m_size.y,m_widthInPixels:this.m_size.x,m_formats:this.m_supportedFormats,m_backgroundType:this.m_backgroundProps.backgroundType}}attachSharedTextureToShapeImage(){if(this.m_shapeItem&&this.m_cameoTextureManager.cameoSharedTexture)for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_cameoTextureManager.cameoSharedTexture),this.m_cameoTextureManager.cameoSharedTexture.changeTracker.notifyChange());else g.a.sendTraceTag(507004170,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoViewElement::attachSharedTextureToShapeImage: Unexpectedly ShapeItem:${!!this.m_shapeItem} or CameoSharedTexture:${!!this.m_cameoTextureManager.cameoSharedTexture} is undefined`)}getCameoDataLog(e){return{id:JSON.stringify(this.id),fTeams:this.m_fTeams,backgroundType:this.m_backgroundProps.backgroundType,msg:e}}isFallbackCameoBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof T.j){const e=this.m_shapeItem;if(e.style&&e.style.fillBrush&&e.style.fillBrush instanceof y.g&&!e.style.pictureBrush)return!0}return!1}isCropped(){return!(!this.m_originalScale||!this.m_originalOffset||1===this.m_originalScale.x&&1===this.m_originalScale.y&&0===this.m_originalOffset.x&&0===this.m_originalOffset.y)}setAlphaInvariant(){if(this.m_backgroundProps.backgroundType===h.Removed)return;const e=this.getImageBrush();e&&(e.isAlphaInvariant=!0,g.a.sendTraceTag(507004169,_.a.msoulscat_Wac_PptSession,S.a.Info,"CameoViewElement::setAlphaInvariant: Successfully set isAlphaInvariant"))}getImageBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof T.j){const e=this.m_shapeItem;if(e.style&&e.style.pictureBrush&&e.style.pictureBrush instanceof y.g)return e.style.pictureBrush}g.a.sendTraceTag(507004168,_.a.msoulscat_Wac_PptSession,S.a.Warning,"CameoViewElement::getImageBrush: failed to grab ImageBrush (picture)")}getImageBrushOffset(){const e=this.getImageBrush();return e&&e.offset?new m.f(e.offset.x,e.offset.y):new m.f(0,0)}getImageBrushScale(){const e=this.getImageBrush();return e&&e.scale?new m.f(e.scale.x,e.scale.y):new m.f(1,1)}getLineBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof T.j){const e=this.m_shapeItem;if(e.style&&e.style.lineBrush)return e.style.lineBrush}}clearLineBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof T.j){const e=this.m_shapeItem;e.style&&e.style.lineBrush&&(e.style.lineBrush=void 0)}}restoreLineBrushIfNeeded(){if(this.m_shapeItem&&this.m_shapeItem instanceof T.j){const e=this.m_shapeItem;this.m_originalLineBrush&&e.style&&!e.style.lineBrush&&(e.style.lineBrush=this.m_originalLineBrush)}}getFormattedVectorString(e){return e?`[x:${e.x.toFixed(4)}, y:${e.y.toFixed(4)}]`:"undefined"}maintainAspectRatio(){if(this.m_size&&this.m_frameSize){const e=this.m_frameSize.x,t=this.m_frameSize.y,i=this.m_size.x,n=this.m_size.y,r=this.getImageBrush();if(g.a.sendTraceTag(507004167,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoViewElement::maintainAspectRatio: Frame Size(WxH)=${e}x${t}.`),r&&r.scale&&r.offset&&0!==n&&0!==i&&0!==t&&0!==e){const a=i/n,s=e/t;if(a===s)return;g.a.sendTraceTag(507004166,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoViewElement::maintainAspectRatio: Started aspect ratio adjustment - frameAspectRatio=[${s.toFixed(6)}], shapeAspectRatio=[${a.toFixed(6)}], scale=${this.getFormattedVectorString(r.scale)}, offset=${this.getFormattedVectorString(r.offset)}`),r.alignment=m.a.center;let o=0,l=0;if(a>s?(l=i,o=t/e*i):(o=n,l=e/t*n),this.isCropped()){g.a.sendTraceTag(507004165,_.a.msoulscat_Wac_PptSession,S.a.Info,"CameoViewElement::maintainAspectRatio: crop detected - new offset will be calculated"),r.alignment=m.a.topLeft;const e=(l-i)/2,t=(o-n)/2;if(this.m_originalOffset&&this.m_originalScale){const a=e*this.m_originalScale.x/i,s=t*this.m_originalScale.y/n,o=new m.f(this.m_originalOffset.x-a,this.m_originalOffset.y-s);r.offset=o}}const d=l/i,c=o/n;if(this.m_originalScale){const e=new m.f(this.m_originalScale.x*d,this.m_originalScale.y*c);r.scale=e}g.a.sendTraceTag(507004164,_.a.msoulscat_Wac_PptSession,S.a.Info,`CameoViewElement::maintainAspectRatio: Completed aspect ratio adjustment - scale=${this.getFormattedVectorString(r.scale)}, offset=${this.getFormattedVectorString(r.offset)}`)}}}constructor(e,t,i,n,r){if(this.shapeType=u.Cameo,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_supportedFormats=["RGBA","BGRA","NV12"],this.onCameoSharedTextureUpdated=e=>{this.m_frameSize&&this.m_frameSize.equals(e)||(this.m_frameSize=e,this.maintainAspectRatio()),this.attachSharedTextureToShapeImage(),this.restoreLineBrushIfNeeded()},this.onCameoSharedTextureReleased=()=>{this.clearLineBrush()},this.id=e.id,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_slideEvents=n,this.m_environment=r,this.m_cameoTextureManager=Y.getInstance(this.m_environment),!t.cameo)throw g.a.sendTraceTag(507004177,_.a.msoulscat_Wac_PptSession,S.a.Error,`CameoViewElement:: Invalid shapeViewData. cameo:${!!t.cameo}.`),J.e.recordVeto("CameoNotRendering",{errorName:"ShapeViewDataMissing",qosVeto:"CameoNotRendering"}),new Error("Invalid cameo");this.m_backgroundProps=t.cameo.backgroundProps;const a=this.m_environment.settings.uiHost;this.m_fTeams=null!=a&&-1!==a.toLowerCase().indexOf("teams");const s=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_size=new m.f(s.region.rect.right-s.region.rect.left,s.region.rect.bottom-s.region.rect.top),!F.a.readBooleanOrDefault("forceSvg",!1)&&this.m_environment.rendererEnvironment.glContext||g.a.sendTraceTag(507004176,_.a.msoulscat_Wac_PptSession,S.a.Warning,"CameoViewElement::ctor: in SVG fallback"),g.a.sendTraceTag(507004175,_.a.msoulscat_Wac_PptSession,S.a.Info,"CameoViewElement ctor: "+JSON.stringify(this.getCameoDataLog("CameoViewElement::ctor")))}}let Q={info(e,t){},warn(e,t){},error(e,t){}};var ee=i(29);const te=[2,1.75,1.5,1.25,1,.5],ie="Inserted URL is either not a valid video or can't be embedded",ne={YouTube:["https://(\\w+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist|v|embed)/.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist)\\?.*","https://youtu\\.be/.*","https://youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/shorts.*"],Vimeo:["https://(\\w+\\.)?(player\\.)?vimeo\\.com/.*"],Flip:["https://(\\w+\\.)?flipgrid\\.com/s/.*","https://(\\w+\\.)?flip\\.com/s/.*","https://(\\w+\\.)?shorts\\.flipgrid\\.com/watch/.*","https://(\\w+\\.)?shorts\\.flip\\.com/watch/.*"],StreamClassic:["https://(\\w+\\.)?microsoftstream\\.com/embed/video/.*","https://(\\w+\\.)?microsoftstream\\.com/video/.*"],Ted:["https://embed\\.ted\\.com/talks/.*","https://www\\.ted\\.com/talks/.*","https://www\\.ted\\.com/index\\.php/talks/.*\\.html.*"],SlideShare:["https://(\\w+\\.)?slideshare\\.net/.*"]},re="aria-label",ae="84a0e9dd-6e58-4aad-82af-ebe485acd09d";class se extends Error{constructor(e,t){super(t),this.statusCode=e}}function oe(e){for(const[t,i]of Object.entries(ne))for(const n of i)if(new RegExp(n).test(e))return t;Q.error(512271065,"Error getting provider name from URL (scheme not found in ONLINE_PROVIDER_URL_SCHEMES)")}function le(e,t){Object.assign(e.style,t)}function de(e){le(e,{zIndex:"6",pointerEvents:"all",position:"absolute",objectFit:"fill",height:"100%",width:"100%"})}class ce{play(){""===this.iFrame.src&&(this.iFrame.src=this.url),this.appSettings.fixOnlineVideoControlFocus?setTimeout(()=>{var e,t;null===(e=this.iFrame)||void 0===e||e.focus(),null===(t=this.iFrame)||void 0===t||t.addEventListener("blur",this.blurHandler)},0):this.setFocus()}pause(){}stop(){this.iFrame.src=""}togglePause(){}setVisible(){this.iFrame.style.visibility="visible"}setHidden(){this.iFrame.style.visibility="hidden"}getPlayer(){return this.iFrame}getCurrentTime(){}getDuration(){}getPlaybackData(){return void 0!==this.playbackTracker?this.playbackTracker.getPlaybackData():void 0}seekTo(e){}ensureMediaClient(){var e,t;null===(e=this.playbackTracker)||void 0===e||e.cleanup(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet()}cleanUpMediaClient(){var e;null===(e=this.playbackTracker)||void 0===e||e.cleanup()}setFocus(){null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}constructor(e,t,i,n){var r;this.url=e,this.iFrame=document.createElement("iframe"),this.appSettings=i,this.parent=t,this.playbackTracker=n,this.iFrame.src=e,this.iFrame.setAttribute("frameBorder","0"),this.iFrame.setAttribute("allow","autoplay"),de(this.iFrame),null===(r=this.playbackTracker)||void 0===r||r.onSourceSet(),this.blurHandler=()=>{var e;null===(e=this.iFrame)||void 0===e||e.blur(),this.parent.focus()},this.iFrame.addEventListener("load",()=>{null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}),t.appendChild(this.iFrame)}}class he{play(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-play",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}this.appSettings.fixOnlineVideoControlFocus&&setTimeout(()=>{var e,t;null===(e=this.flipIFrame)||void 0===e||e.focus(),null===(t=this.flipIFrame)||void 0===t||t.addEventListener("blur",this.blurHandler)},0)}pause(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-pause",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}stop(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-stop",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}togglePause(){this.paused?this.play():this.pause()}setVisible(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="visible")}setHidden(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="hidden")}getPlayer(){return this.flipIFrame}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}seekTo(e){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const t=this.getMessage("fg-wvp-seek",{time:e});this.flipIFrame.contentWindow.postMessage(t,this.url.origin)}}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}isPaused(){return this.paused}cleanUpMediaClient(){void 0!==this.flipIFrame&&this.flipIFrame.remove(),this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.flipIFrame=void 0,window.removeEventListener("message",this.onMessage),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.flipIFrame=document.createElement("iframe"),this.flipIFrame.src=this.url.toString(),this.setProperties(this.flipIFrame),this.parent.append(this.flipIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),de(e),e.style.border="0px",this.setVisible())}handlePlayerEvent(e){switch(e.data.name){case"fg-wvp-onReady":case"fg-wvp-onInitialReady":if(this.isFirstReady){if(this.isFirstReady=!1,void 0===this.duration&&void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-getDuration",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}void 0!==this.onReadyCallback&&this.onReadyCallback()}break;case"fg-wvp-onPlay":this.paused=!1,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1);break;case"fg-wvp-onPause":this.paused=!0,(void 0===this.duration||this.currentTime<this.duration)&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0);break;case"fg-wvp-onSeek":void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"fg-wvp-onTimeUpdate":this.currentTime=e.data.data.currentTime;break;case"fg-wvp-onBuffering":break;case"fg-wvp-onEnded":this.paused=!0,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6);break;case"fg-wvp-onError":Q.error(508895832,"Flipgrid player entered error state "+e.data.data.error);break;case"fg-wvp-getDurationResult":this.duration=e.data.data.duration;break;case"fg-wvp-getCurrentTimeResult":this.currentTime=e.data.data.currentTime}}capturePlaybackTelemetry(e){const t=e.data.name;if(void 0!==this.playbackTracker)switch(t){case"fg-wvp-onReady":this.playbackTracker.onCanPlay(),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.playbackTracker.onPlaying();break;case"fg-wvp-onPause":this.playbackTracker.onPause();break;case"fg-wvp-onSeek":break;case"fg-wvp-onEnded":this.playbackTracker.onEnded();break;case"fg-wvp-onError":const t="Flipgrid player entered error state "+e.data.data.error;this.playbackTracker.onError(t,!0)}}getMessage(e,t){return{name:e,data:t}}constructor(e,t,i,n,r,a){this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.onMessage=e=>{e.origin===this.url.origin&&void 0!==this.flipIFrame&&this.flipIFrame.contentWindow===e.source&&(this.handlePlayerEvent(e),void 0!==this.playbackTracker&&this.capturePlaybackTelemetry(e))},this.url=new URL(e),this.parent=t,this.appSettings=i,this.playbackTracker=n,this.onReadyCallback=r,this.onMediaEventCallback=a,this.blurHandler=()=>{var e;null===(e=this.flipIFrame)||void 0===e||e.blur(),this.parent.focus()},this.url.searchParams.set("options","messaging");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Flip video client: "+e.message,!0)}}}class ue{play(){const e=this.getMessage("playerfunction","play");this.sendMessage(e)}pause(){const e=this.getMessage("playerfunction","pause");this.sendMessage(e)}stop(){this.pause(),this.seekTo(0)}togglePause(){this.paused?this.play():this.pause()}getPlayer(){return this.streamIFrame}isPaused(){return this.paused}getCurrentTime(){return this.currentTime}getDuration(){}seekTo(e){const t=this.getMessage("playerfunction","setplaytime",e.toString());this.sendMessage(t)}setVisible(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="visible")}setHidden(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="hidden")}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.streamIFrame&&this.streamIFrame.remove(),this.paused=!0,this.currentTime=0,this.streamIFrame=void 0,this.streamAuthFailed=!1,window.removeEventListener("message",this.onMessage),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}postAuthToken(e){if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;null!==t&&void 0!==this.streamAuthContext?(void 0===this.streamAuthContext.messageObj.eventData&&(this.streamAuthContext.messageObj.eventData={}),this.streamAuthContext.messageObj.eventData.token=e,this.streamAuthContext.messageObj.result=!0,t.postMessage(this.streamAuthContext.messageObj,this.streamAuthContext.origin),Q.info(508895831,"StreamAuth: Posted Aad Token back to Stream Player")):Q.error(508895830,"StreamAuth: Got a Stream iframe but unable to get ContentWindow or cached Context")}}init(){var e;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.streamIFrame=document.createElement("iframe"),this.streamIFrame.src=this.url.toString(),this.setProperties(this.streamIFrame),this.parent.append(this.streamIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),de(e),e.style.border="0px",this.setVisible())}handleTokenRequest(e){var t,i;if(this.streamAuthFailed)return;if(void 0===this.onTokenRequestCallback)return this.streamAuthFailed=!0,void(null===(t=this.playbackTracker)||void 0===t||t.onError("Authentication Error - onTokenRequestCallback is undefined",!0));Q.info(508895827,"StreamAuth: Requesting AAD token from Host");const n=e.data,r=e.origin;this.streamAuthContext={messageObj:n,origin:r},this.onTokenRequestCallback(null===(i=n.eventData)||void 0===i?void 0:i.resourceId)}handlePlayerEvent(e){var t,i,n,r;const a=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname;if(void 0!==this.onMediaEventCallback){switch(a){case"play":this.onMediaEventCallback(1);break;case"playing":this.paused=!1,this.onMediaEventCallback(1);break;case"pause":this.paused=!0,this.onMediaEventCallback(0);break;case"ready":void 0!==this.onReadyCallback&&this.onReadyCallback();break;case"timeupdate":{const t=this.currentTime;this.currentTime=null===(i=e.data.eventData)||void 0===i?void 0:i.time,void 0!==this.currentTime&&Math.abs(this.currentTime-t)>=1&&this.onMediaEventCallback(3);break}case"error":Q.error(538039177,`Stream media error: ${null===(n=e.data.eventData)||void 0===n?void 0:n.errorcode}, message: ${null===(r=e.data.eventData)||void 0===r?void 0:r.message}`)}Q.info(508895824,"Stream Media Event: "+a)}}trackPlaybackTelemetry(e){var t,i;if(void 0!==this.playbackTracker){const n=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname,r=null===(i=e.data.eventData)||void 0===i?void 0:i.message;switch(n){case"play":this.playbackTracker.onPlay();break;case"playing":this.playbackTracker.onPlaying();break;case"pause":this.playbackTracker.onPause();break;case"ready":this.playbackTracker.onCanPlay();break;case"error":void 0!==r&&this.playbackTracker.onError(r,!0)}}}getMessage(e,t,i){return void 0!==i?{name:e,methodData:{methodname:t,data:i},eventData:{}}:{name:e,methodData:{methodname:t},eventData:{}}}sendMessage(e){void 0!==this.streamIFrame&&null!==this.streamIFrame.contentWindow&&(Q.info(528623694,`sendMessage: Calling postMessage with: msg = ${JSON.stringify(e)}, target = ${this.streamIFrame.src}`),this.streamIFrame.contentWindow.postMessage(e,this.streamIFrame.src))}constructor(e,t,i,n,r,a,s){this.paused=!0,this.currentTime=0,this.streamAuthFailed=!1,this.onMessage=e=>{var t,i,n,r;if(this.url.origin===e.origin&&void 0!==this.streamIFrame&&this.streamIFrame.contentWindow===e.source)switch(e.data.name){case"initializestreamconnection":Q.info(508895829,"StreamAuth: Received handshake request");let a=!1;if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;if(null!==t){const i=e.data;i.result=!0,t.postMessage(i,e.origin),a=!0}}a||Q.info(508895828,"StreamAuth: Received handshake request, but unable to reply");break;case"getstreamtoken":this.handleTokenRequest(e);break;case"signinevent":this.streamAuthFailed||"signinfailed"===(null===(t=e.data.eventData)||void 0===t?void 0:t.eventname)&&(null===(i=this.playbackTracker)||void 0===i||i.onError("Authentication Error - User failed to authenticate",!0),this.streamAuthFailed=!0);break;case"loaddata":const s=null===(n=e.data.eventData)||void 0===n?void 0:n.responsecode;"200"!==s&&(null===(r=this.playbackTracker)||void 0===r||r.onError("Load Error - Video responded with status code "+s,!0));break;case"playerevent":this.handlePlayerEvent(e),this.trackPlaybackTelemetry(e)}},this.url=new URL(e),this.parent=t,this.playbackTracker=n,this.onReadyCallback=r,this.onMediaEventCallback=a,this.onTokenRequestCallback=s,void 0!==i.App&&this.url.searchParams.set("app",i.App),void 0!==i.AppPlatform&&this.url.searchParams.set("appPlatform",i.AppPlatform),void 0!==i.AppCorrelation&&this.url.searchParams.set("appCorrelation",i.AppCorrelation),this.url.searchParams.set("thinEmbed","true");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream Classic video client: "+e.message,!0)}}}var me,fe=new Uint8Array(16);function pe(){if(!me&&!(me="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return me(fe)}for(var ge=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,_e=function(e){return"string"==typeof e&&ge.test(e)},Se=[],ve=0;ve<256;++ve)Se.push((ve+256).toString(16).substr(1));var ye=function(e,t,i){var n=(e=e||{}).random||(e.rng||pe)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(Se[e[t+0]]+Se[e[t+1]]+Se[e[t+2]]+Se[e[t+3]]+"-"+Se[e[t+4]]+Se[e[t+5]]+"-"+Se[e[t+6]]+Se[e[t+7]]+"-"+Se[e[t+8]]+Se[e[t+9]]+"-"+Se[e[t+10]]+Se[e[t+11]]+Se[e[t+12]]+Se[e[t+13]]+Se[e[t+14]]+Se[e[t+15]]).toLowerCase();if(!_e(i))throw TypeError("Stringified UUID is invalid");return i}(n)};class Te{get name(){return this._name}get guid(){return this._guid}constructor(e,t){this._name=e,this._guid=t}}Te.graph=new Te("Graph","00000003-0000-0000-c000-000000000000"),Te.hubble=new Te("Hubble",ae),Te.resourceConstrained=new Te("ResourceConstrained","ResourceConstrainedToken.PAC"),Te.all=[Te.graph,Te.hubble,Te.resourceConstrained];class be{get timeout(){return this.timeValid}updateSettings(e){void 0!==e.TokenCacheTimeout?this.timeValid=e.TokenCacheTimeout:this.timeValid=33e5}update(e,t){0!==t.length?this.cache.set(e,[Date.now(),t]):Q.error(509167387,"Error: Empty token")}find(e){if(!this.cache.has(e))return;const[t,i]=this.cache.get(e);return Date.now()>t+this.timeValid?void 0:i}constructor(){this.cache=new Map,this.timeValid=33e5}}class we{add(e,t){const i=this.clients.get(e);void 0!==i?i.has(t)?Q.error(509171084,"Error: Client already exists"):i.add(t):this.clients.set(e,new Set([t]))}has(e,t){const i=this.clients.get(e);return void 0!==i&&i.has(t)}remove(e,t){const i=this.clients.get(e);return void 0===i?(Q.error(509171083,"Error: AppId does not exist"),!1):i.delete(t)?0===i.size:(Q.error(509171082,"Error: Client does not exist"),!1)}getClients(e){const t=this.clients.get(e);if(void 0===t)return Q.error(509171081,"Error: AppId does not exist"),[];if(0===t.size)return Q.error(509171080,"Error: Clients do not exist"),[];const i=Array.from(t);return t.clear(),i}getPendingAppId(){for(const[e,t]of this.clients)if(0!==t.size)return e}constructor(){this.clients=new Map}}class Ce{get timeout(){return this.waitBeforeRetry}get maxRetryCount(){return this.maxRetries}get elapsedTime(){return Date.now()-this.startTime}get numberOfRetries(){return this.retries}get willRetry(){return this.numberOfRetries<=this.maxRetryCount}get currentAppId(){return this.appId}get isPending(){return void 0!==this.tokenRequestTimeout}updateSettings(e,t){void 0!==e.MaxAADTokenWaitingTime?this.waitBeforeRetry=e.MaxAADTokenWaitingTime:this.waitBeforeRetry=3e3,void 0!==e.MaxAADTokenRequestRetries?this.maxRetries=e.MaxAADTokenRequestRetries:this.maxRetries=3,void 0!==t?this.tokenRequestCallback=t:Q.error(509166869,"Error: No token request callback")}start(e){void 0!==this.tokenRequestCallback?void 0===this.currentAppId?this.isPending?Q.error(509171090,"Error: Request is already pending"):(this.startTime=Date.now(),this.retries=0,this.appId=e,this.tryRequest()):Q.error(509166861,"Error: AppId already set"):Q.error(509166818,"Error: No token request callback")}completeOrCancel(e){if(void 0===this.currentAppId)return void Q.error(509166860,"Error: AppId is not set");if(!this.isPending)return void Q.error(509171089,"Error: Request is not pending");clearTimeout(this.tokenRequestTimeout),this.tokenRequestTimeout=void 0;const t={tokenLength:e,isCompleted:void 0!==e,tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};Q.info(509194645,JSON.stringify(t)),this.appId=void 0}tryRequest(){if(void 0===this.tokenRequestCallback)return void Q.error(509171088,"Error: No token request callback");if(void 0===this.currentAppId)return void Q.error(509171087,"Error: AppId is not set");if(this.isPending)return void Q.error(509171086,"Error: Request is already pending");if(!this.willRetry)return void Q.error(508700001,"Error: Request will not be retried");const e={tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};Q.info(509166817,JSON.stringify(e)),this.tokenRequestTimeout=window.setTimeout(()=>{this.tokenRequestTimeout=void 0,this.retries+=1,this.tryRequest()},this.timeout),this.tokenRequestCallback(this.currentAppId.guid,this.currentAppId.name)}constructor(){this.waitBeforeRetry=3e3,this.maxRetries=3,this.startTime=0,this.retries=0}}class Ie{updateSettings(e,t){this.cache.updateSettings(e),this.requestWithRetry.updateSettings(e,t)}request(e,t){const i=this.cache.find(e);void 0===i?(this.clients.add(e,t),this.requestWithRetry.isPending||this.requestWithRetry.start(e)):t.onTokenSet(e,i)}cancelAllIfPending(e){for(const t of Te.all)this.cancelIfPending(t,e);this.requestWithRetry.isPending||this.startPendingRequest()}setAADToken(e){const t=this.requestWithRetry.currentAppId;if(void 0===t)return void Q.error(509166815,"Error: AppId is not set");if(0===e.length)return void Q.error(509171016,"Error: Got empty token");this.cache.update(t,e),this.requestWithRetry.completeOrCancel(e.length);const i=this.clients.getClients(t);for(const n of i)n.onTokenSet(t,e);this.startPendingRequest()}startPendingRequest(){const e=this.clients.getPendingAppId();void 0!==e&&this.requestWithRetry.start(e)}cancelIfPending(e,t){this.clients.has(e,t)&&this.clients.remove(e,t)&&e===this.requestWithRetry.currentAppId&&this.requestWithRetry.completeOrCancel(void 0)}constructor(){this.cache=new be,this.clients=new we,this.requestWithRetry=new Ce}}let Pe={getBoolean:e=>!1,getNumber(e){},getString(e){}};class Ee{static setAADTokenForWaitingClients(e,t){!0===Ee.stream2PacAuthEnabled?t===ae?Ee.hubbleAadTokenRequestor.setAADToken(e):"ResourceConstrainedToken.PAC"===t&&Ee.resourceConstrainedAadTokenRequestor.setAADToken(e):Ee.hubbleAadTokenRequestor.setAADToken(e)}play(){this.postMessage({command:"one-player-play"}),this.appSettings.fixOnlineVideoControlFocus&&setTimeout(()=>{var e,t;null===(e=this.stream2iFrame)||void 0===e||e.focus(),null===(t=this.stream2iFrame)||void 0===t||t.addEventListener("blur",this.blurHandler)},0)}pause(){this.postMessage({command:"one-player-pause"})}stop(){this.postMessage({command:"one-player-stop"})}seekTo(e){this.postMessage({command:"one-player-seek",position:e})}togglePause(){this.paused?this.play():this.pause()}setMute(){!0!==this.muted&&this.postMessage({command:"one-player-mute"})}setUnMute(){!1!==this.muted&&this.postMessage({command:"one-player-unmute"})}setVolume(e){const t=Math.min(Math.max(e,0),1);this.postMessage({command:"one-player-set-volume",volumeLevel:t})}getVolume(){return this.volume}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){Ee.hubbleAadTokenRequestor.cancelAllIfPending(this),!0===this.appSettings.stream2PacAuthEnabled&&Ee.resourceConstrainedAadTokenRequestor.cancelAllIfPending(this),void 0!==this.oEmbedRequestRetryTimeout&&window.clearTimeout(this.oEmbedRequestRetryTimeout),void 0!==this.stream2iFrame&&this.stream2iFrame.remove(),void 0!==this.errorMessageDiv&&this.errorMessageDiv.remove(),this.paused=!0,this.currentTime=0,this.muted=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.messagePort=void 0,this.stream2iFrame=void 0,this.oEmbedResponseTimeStamp=void 0,this.oEmbedRequestRetried=!1,this.oEmbedRequestRetryTimeout=void 0,this.channelId=void 0,this.navigatedToEmbedUrl=!1,this.embedURL=void 0,this.errorMessageDiv=void 0,window.removeEventListener("message",this.initPostMessageCommunication),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}isPaused(){return this.paused}isMuted(){return this.muted}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}setVisible(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="visible"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="visible")}setHidden(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="hidden"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="hidden")}getPlayer(){return this.stream2iFrame}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}onTokenSet(e,t){switch(e){case Te.hubble:this.onHubbleTokenSet(t);break;case Te.resourceConstrained:this.onResourceConstrainedTokenSet(t);break;default:Q.error(509194507,"Unknown appId: "+e.name)}}showErrorMessage(e){this.errorMessageDiv=document.createElement("div"),this.errorMessageDiv.style.backgroundColor="black",this.errorMessageDiv.style.justifyContent="center",this.errorMessageDiv.style.alignItems="center",this.errorMessageDiv.style.color="white",this.errorMessageDiv.style.fontSize="10",this.errorMessageDiv.style.borderRadius="5",this.errorMessageDiv.style.display="flex",this.errorMessageDiv.style.textAlign="center",this.errorMessageDiv.textContent=e,de(this.errorMessageDiv),this.parentElement.append(this.errorMessageDiv)}onHubbleTokenSet(e){var t;null===(t=this.playbackTracker)||void 0===t||t.onHubbleTokenSet(),!0===this.appSettings.stream2PacAuthEnabled?this.getHubblePAC(e):this.initOnePlayer(e)}onResourceConstrainedTokenSet(e){this.initOnePlayerWithPAC(e)}postMessage(e){var t;null===(t=this.messagePort)||void 0===t||t.postMessage({type:"command",id:0,data:e})}onMessage(e){const t=e.data.type;"notification"===t?this.handleNotificationMessage(e.data):"result"===t?this.handleResultMessage(e.data):"command"===t?this.handleCommandMessage(e.data):"acknowledge"===t||Q.warn(509219079,`Received unrecognized postmessage (type: ${t})`)}handleCommandMessage(e){if("getToken"===e.data.command){Q.warn(508924038,`Received unexpected getToken request from OnePlayer (type: ${e.data.tokenType})`);const t={type:"result",id:e.id,data:{result:"error",isExpected:!0,error:{code:"",message:"Token request not supported"}}};void 0!==this.messagePort&&this.messagePort.postMessage(t)}}handleResultMessage(e){if("error"!==e.data.result)void 0!==e.data.durationInSeconds?(this.duration=e.data.durationInSeconds,void 0!==this.playbackTracker&&this.playbackTracker.setDuration(this.duration)):void 0!==e.data.volume?(this.volume=e.data.volume,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playbackTracker&&this.playbackTracker.setVolume(this.volume)):void 0!==e.data.isMute?(this.muted=e.data.isMute,void 0!==this.playbackTracker&&this.playbackTracker.setIsMuted(this.muted)):Q.warn(509215635,`Unrecognized result type received (type: ${e.data.result})`);else{const t=e.data;Q.error(509437569,`OnePlayer Error - Result: ${t.error.code} (${t.error.message})`)}}handleNotificationMessage(e){var t;switch(e.data.notification){case"one-player-player-ready":e.data.isReady&&this.onReady(e.data.ttlMs);break;case"one-player-play-state":const i=e.data.playState;this.onPlayStateChanged(i);break;case"one-player-current-time":const n=this.currentTime;this.currentTime=e.data.currentTime,Math.abs(this.currentTime-n)>2&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"one-player-muted":if(this.muted=e.data.isMuted,!this.muted){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.022))}void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playbackTracker&&this.playbackTracker.onMuteChanged(this.muted);break;case"one-player-volume":this.volume=e.data.volume,0===this.volume?this.setMute():this.lastNonZeroVolume=this.volume,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume);break;case"error":case"one-player-fatal-playback-error":null===(t=this.playbackTracker)||void 0===t||t.onError("OnePlayer Error - Notification: "+JSON.stringify(e.data),!0);break;default:Q.warn(509437568,`Unrecognized notification type received (type: ${e.data.notification})`)}}onReady(e){this.postMessage({command:"one-player-get-duration"}),this.postMessage({command:"one-player-get-volume"}),this.postMessage({command:"one-player-get-mute"}),void 0!==this.playbackTracker&&void 0!==e&&this.playbackTracker.onODSPVideoLoad(e),void 0!==this.playbackTracker&&this.playbackTracker.onCanPlay(),void 0!==this.onReadyCallback&&this.onReadyCallback()}onPlayStateChanged(e){this.paused="Playing"!==e,"Playing"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1),void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()):"Paused"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0),void 0!==this.playbackTracker&&this.playbackTracker.onPause()):"Ended"===e&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6),void 0!==this.playbackTracker&&this.playbackTracker.onEnded())}init(){var e;this.stream2iFrame=document.createElement("iframe"),this.setProperties(this.stream2iFrame),null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),Ee.hubbleAadTokenRequestor.request(Te.hubble,this)}getHubblePAC(e){Ee.resourceConstrainedAadTokenRequestor.request(Te.resourceConstrained,this)}initOnePlayerWithPAC(e){}initOnePlayer(e){this.initOEmbedIFrame(e).then(()=>{void 0!==this.messagePort&&Q.info(508432459,"Cross-window communication channel is already initialized")}).catch(e=>{void 0!==this.playbackTracker&&this.playbackTracker.onError(`Init iFrame Error - Error creating iFrame from OEmbed response (${e.message})`)})}initOEmbedIFrame(e){var t,i;return Object(ee.b)(this,void 0,void 0,(function*(){let n;try{n=yield function(e,t){return Object(ee.b)(this,void 0,void 0,(function*(){const i=function(e,t){if(void 0===e.apiBaseUrl)throw new Error("Hubble API base URL is undefined");const i=new URL(e.apiBaseUrl);if(i.pathname=t,void 0!==e.app){const t=function(e){if(void 0!==e)switch(e){case"Word":return"0";case"Excel":return"1";case"Teams":case"PowerPoint":return"3";case"Outlook":return"5";case"OneNote":return"8";case"Publisher":return"10";case"Visio":return"12";case"SharePoint":return"1001";default:return}}(e.app);void 0!==t&&i.searchParams.set("app",t)}return void 0!==e.appPlatform&&i.searchParams.set("platform",e.appPlatform),i}(t,"/mediasvc/api/media/oembed"),n=function(e){const t=new Headers;return void 0!==e.correlationId&&t.set("X-CorrelationId",e.correlationId),void 0!==e.acceptLanguage&&t.set("Accept-Language",e.acceptLanguage),void 0!==e.aadToken&&t.set("Authorization",e.aadToken),t.set("Content-Type","application/json; charset=utf-8"),t}(t);i.searchParams.set("url",e);const r=yield fetch(i.toString(),{method:"GET",headers:n}),a=yield r.json();if(!r.ok){let e="status: "+r.status;throw void 0!==a.Error&&void 0!==a.Error.Message&&(e+=", message: "+a.Error.Message),new se(r.status,e)}return a}))}(this.videoUrl,{aadToken:e,apiBaseUrl:this.appSettings.HubbleVideoEndpoint,app:this.appSettings.App,appPlatform:this.appSettings.AppPlatform,correlationId:void 0!==this.playbackTracker?this.playbackTracker.getCorrelationId():this.appSettings.AppCorrelation,acceptLanguage:this.appSettings.AcceptLanguage})}catch(n){if(Pe.getBoolean("retryOEmbedRequestIf429")&&!this.oEmbedRequestRetried){const i=n.message;if(i.indexOf("status: 429")>-1){const n=i.match(/Retry-After:\s*(\d+)/),r=null!==n&&2===n.length?parseFloat(n[1]):void 0;let a=11.5;if(void 0!==Pe.getNumber("retryOEmbedRequestIf429Threshold")&&(a=Pe.getNumber("retryOEmbedRequestIf429Threshold")),void 0!==r&&r<=a)return this.oEmbedRequestRetried=!0,this.oEmbedRequestRetryTimeout=window.setTimeout(()=>this.initOnePlayer(e),1e3*r),void(null===(t=this.playbackTracker)||void 0===t||t.onError(`OEmbed Request Error - status: 429 (will retry request in ${r}s)`))}}let r=ie;return void 0!==this.appSettings.LocalizedHubble404ErrorMessage&&(r=this.appSettings.LocalizedHubble404ErrorMessage),n instanceof se&&(r=this.getErrorMessage(n.statusCode)),this.showErrorMessage(r),void(null===(i=this.playbackTracker)||void 0===i||i.onError("OEmbed Request Error - "+n.message,!0))}void 0!==this.playbackTracker&&this.playbackTracker.onOEmbedResponse(),this.setOEmbedURL(n)}))}setOEmbedURL(e){if(void 0===e.embed_url)return void 0!==this.playbackTracker&&this.playbackTracker.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0),void this.showErrorMessage(ie);this.oEmbedResponseTimeStamp=Date.now(),this.embedURL=new URL(e.embed_url);const t=this.embedURL.searchParams.get("access_token");if(void 0!==this.stream2iFrame&&null!==t){this.embedURL.searchParams.delete("access_token"),this.embedURL.searchParams.set("auth","readwrite");const e="PowerPointLive"===this.appSettings.hostView;e&&this.embedURL.searchParams.set("forceMeta","1"),this.channelId=ye(),this.embedURL.searchParams.set("origin",new URL(location.href).origin),this.embedURL.searchParams.set("channelId",this.channelId),this.embedURL.searchParams.set("embed",JSON.stringify({hp:"Web",hv:this.appSettings.hostView,hc:this.appSettings.hostComponent,ha:this.appSettings.App,hsi:void 0!==this.playbackTracker?this.playbackTracker.getCorrelationId():this.appSettings.AppCorrelation,af:!1,disableHybrid:e,ol:this.appSettings.AcceptLanguage}));const i=new URL(this.videoUrl).searchParams.get("nav");null!==i&&this.embedURL.searchParams.set("nav",i),this.stream2iFrame.setAttribute("allow","autoplay "+this.embedURL.origin),this.stream2iFrame.addEventListener("load",()=>this.onStream2iFrameLoad(t)),this.parentElement.append(this.stream2iFrame)}}onStream2iFrameLoad(e){var t,i;if(Pe.getBoolean("navigateToEmbedIfIFrameIsBlank")){if(!this.stream2iFrame||"about:blank"!==(null===(t=this.stream2iFrame.contentDocument)||void 0===t?void 0:t.location.href))return}else if(this.navigatedToEmbedUrl)return;void 0===this.oEmbedResponseTimeStamp||Date.now()-this.oEmbedResponseTimeStamp>=24e4?this.ensureMediaClient():void 0!==this.embedURL&&void 0!==this.stream2iFrame&&null!==this.stream2iFrame.contentWindow&&(window.addEventListener("message",this.initPostMessageCommunication),this.navigateToEmbedUrl(this.stream2iFrame.contentWindow,this.embedURL,e),this.navigatedToEmbedUrl=!0,null===(i=this.playbackTracker)||void 0===i||i.onNavigatedToEmbedPage())}getErrorMessage(e){return 400===e?void 0!==this.appSettings.LocalizedHubble400ErrorMessage?this.appSettings.LocalizedHubble400ErrorMessage:"Inserted URL is not from a currently supported video provider":404===e?void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:ie:403===e?void 0!==this.appSettings.LocalizedHubble403ErrorMessage?this.appSettings.LocalizedHubble403ErrorMessage:"This video could not be played because it either was not found or you do not have access to it.":500===e||503===e||429===e?void 0!==this.appSettings.LocalizedHubble500ErrorMessage?this.appSettings.LocalizedHubble500ErrorMessage:"The online video service failed, please try again":void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:ie}navigateToEmbedUrl(e,t,i){const n=e.document.createElement("form");n.setAttribute("action",t.toString()),n.setAttribute("method","POST");const r=e.document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","access_token"),r.setAttribute("value",i),n.appendChild(r),e.document.body.appendChild(n),n.submit()}setProperties(e){e.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-forms allow-top-navigation-by-user-activation allow-downloads"),de(e),e.style.border="0px",this.setVisible()}constructor(e,t,i,n,r,a,s){this.paused=!0,this.currentTime=0,this.oEmbedRequestRetried=!1,this.navigatedToEmbedUrl=!1,this.initPostMessageCommunication=e=>{var t,i,n;const r=(null===(t=this.embedURL)||void 0===t?void 0:t.origin)===e.origin,a=this.channelId===e.data.channelId;if(r&&a&&"initialize"===e.data.type)try{e.data.replyTo.onmessage=e=>this.onMessage(e),e.data.replyTo.postMessage({type:"activate"}),this.messagePort=e.data.replyTo,null===(n=this.playbackTracker)||void 0===n||n.onPostMessagingInitialized()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError(`Post Messaging Error - Error initializing communication channel (${e.message})`,!0)}else Q.warn(508371414,"Message failed source verification: "+JSON.stringify({isOriginMatching:r,isChannelMatching:a,messageType:e.data.type,correlationId:null===(i=this.playbackTracker)||void 0===i?void 0:i.getCorrelationId()}))},this.videoUrl=e,this.appSettings=i,this.parentElement=t,this.playbackTracker=n,this.onReadyCallback=r,this.onMediaEventCallback=a,Ee.stream2PacAuthEnabled=this.appSettings.stream2PacAuthEnabled,Ee.hubbleAadTokenRequestor.updateSettings(i,s),Ee.resourceConstrainedAadTokenRequestor.updateSettings(i,s),this.blurHandler=()=>{var e;null===(e=this.stream2iFrame)||void 0===e||e.blur(),this.parentElement.focus()};try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream 2.0 video client: "+e.message,!0)}}}Ee.hubbleAadTokenRequestor=new Ie,Ee.resourceConstrainedAadTokenRequestor=new Ie,Ee.stream2PacAuthEnabled=!1;var xe,ke,Me,Ae=i(188);class Re{play(){void 0!==this.player&&this.player.play().catch(e=>{Q.error(508572036,`Vimeo error while playing video (error: ${e.message})`)}),this.appSettings.fixOnlineVideoControlFocus&&setTimeout(()=>{var e,t;null===(e=this.vimeoIframe)||void 0===e||e.focus(),null===(t=this.vimeoIframe)||void 0===t||t.addEventListener("blur",this.blurHandler)},0)}pause(){void 0!==this.player&&this.player.pause().catch(e=>{Q.error(508572035,`Vimeo error while pausing video (error: ${e.message})`)})}stop(){void 0!==this.player&&(this.pause(),this.seekTo(0))}togglePause(){void 0!==this.player&&void 0!==this.paused&&(this.paused?this.play():this.pause())}setVisible(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="visible"),void 0!==this.backDrop&&(this.backDrop.style.visibility="visible")}setHidden(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="hidden"),void 0!==this.backDrop&&(this.backDrop.style.visibility="hidden")}getPlayer(){return this.vimeoIframe}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}isPaused(){return this.paused}seekTo(e){void 0!==this.player&&this.player.setCurrentTime(e).catch(e=>{Q.error(508572034,`Vimeo error while setting current time (error: ${e.message})`)})}setVolume(e){void 0!==this.player&&this.player.setVolume(e).catch(e=>{Q.error(508572033,`Vimeo error while setting video volume (error: ${e.message})`)})}setMute(){void 0!==this.player&&this.player.setMuted(!0).catch(e=>{Q.error(508572032,`Vimeo error while setting muted true (error: ${e.message})`)})}setUnMute(){if(void 0!==this.player){if(0===this.volume){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.25))}this.player.setMuted(!1).catch(e=>{Q.error(508572003,`Vimeo error while setting muted false (error: ${e.message})`)})}}getVolume(){return this.volume}isMuted(){return this.muted}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.vimeoIframe&&this.vimeoIframe.remove(),void 0!==this.backDrop&&this.backDrop.remove(),this.paused=void 0,this.player=void 0,this.currentTime=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.muted=void 0,this.vimeoIframe=void 0,this.backDrop=void 0,void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.backDrop=document.createElement("div"),this.backDrop.style.backgroundColor="black",this.setProperties(this.backDrop),this.parent.append(this.backDrop),this.vimeoIframe=document.createElement("iframe"),this.vimeoIframe.src=this.url,this.vimeoIframe.setAttribute("allow","autoplay"),this.setProperties(this.vimeoIframe),this.parent.append(this.vimeoIframe),this.player=new Ae.a(this.vimeoIframe,{controls:!0,responsive:!1}),this.player.ready().then(()=>Object(ee.b)(this,void 0,void 0,(function*(){if(void 0!==this.player){this.registerOnStateChange();try{this.paused=yield this.player.getPaused(),this.currentTime=yield this.player.getCurrentTime(),this.duration=yield this.player.getDuration(),this.volume=yield this.player.getVolume(),this.muted=yield this.player.getMuted()}catch(e){Q.error(509354830,`Vimeo error while getting video info on player ready (error: ${e.message})`)}this.paused=!0,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),void 0!==this.volume&&this.playbackTracker.setVolume(this.volume),void 0!==this.muted&&this.playbackTracker.setIsMuted(this.muted),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration)),void 0!==this.onReadyCallback&&this.onReadyCallback(),void 0!==this.player.setAutopause&&this.player.setAutopause(!1).catch(e=>{Q.error(508572002,`Vimeo error while setting video autopause (error: ${e.message})`)})}}))).catch(e=>{void 0!==this.playbackTracker&&this.playbackTracker.onError(`Error loading Vimeo player (error: ${e.message})`,!0)})}registerOnStateChange(){void 0!==this.player&&(this.player.on("play",e=>{this.paused=!1,this.onStateChange(1,e.seconds),void 0!==this.playbackTracker&&this.playbackTracker.onPlay()}),this.player.on("pause",e=>{this.paused=!0,Math.abs(e.seconds-e.duration)>.1&&this.onStateChange(0,e.seconds),void 0!==this.playbackTracker&&this.playbackTracker.onPause()}),this.player.on("seeked",e=>{this.onStateChange(3,e.seconds)}),this.player.on("volumechange",e=>Object(ee.b)(this,void 0,void 0,(function*(){const t=this.volume,i=this.muted;this.volume=e.volume,void 0!==this.player&&(this.muted=yield this.player.getMuted()),0!==this.volume&&(this.lastNonZeroVolume=this.volume);const n=t!==this.volume,r=i!==this.muted;(n||r)&&this.onStateChange(4),n&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),r&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted)}))),this.player.on("playing",()=>{void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()}),this.player.on("ended",e=>{this.paused=!0,this.onStateChange(6,e.seconds),void 0!==this.playbackTracker&&this.playbackTracker.onEnded()}),this.player.on("error",e=>{if(void 0!==this.playbackTracker){const t=`${e.name} error raised by Vimeo player's "${e.method}" method: (${e.message})`;this.playbackTracker.onError(t)}}),this.player.on("timeupdate",e=>{this.currentTime=e.seconds}))}onStateChange(e,t){void 0!==t&&(this.currentTime=t),void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){null!==e&&(de(e),e.style.border="0px",this.setVisible())}constructor(e,t,i,n,r,a){this.url=e,this.parent=t,this.appSettings=i,this.playbackTracker=n,this.onReadyCallback=r,this.onMediaEventCallback=a,this.blurHandler=()=>{var e;null===(e=this.vimeoIframe)||void 0===e||e.blur(),this.parent.focus()};try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Vimeo video client: "+e.message,!0)}}}function Oe(){return!!document.head.querySelector('script[src="https://www.youtube.com/iframe_api"]')}function Fe(){const e=document.createElement("script");e.setAttribute("type","text/javascript"),e.src="https://www.youtube.com/iframe_api",document.head.appendChild(e)}class De{play(){void 0!==this.player&&void 0!==this.player.playVideo&&this.player.playVideo(),this.appSettings.fixOnlineVideoControlFocus&&setTimeout(()=>{var e,t;null===(e=this.youTubeIFrame)||void 0===e||e.focus(),null===(t=this.youTubeIFrame)||void 0===t||t.addEventListener("blur",this.blurHandler)},0)}getVolume(){if(void 0!==this.player&&void 0!==this.player.getVolume)return this.player.getVolume()}pause(){void 0!==this.player&&void 0!==this.player.pauseVideo&&this.player.pauseVideo()}getPlayer(){return this.youTubeIFrame}stop(){void 0!==this.player&&void 0!==this.player.stopVideo&&this.player.stopVideo()}togglePause(){void 0!==this.player&&(this.paused?this.play():this.pause())}setVisible(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="visible")}setHidden(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="hidden")}getCurrentTime(){if(void 0!==this.player&&void 0!==this.player.getCurrentTime)return this.player.getCurrentTime();Q.warn(508895497,"Attempted to getCurrentTime www.youtube.com but undefined player")}getDuration(){if(void 0!==this.player&&void 0!==this.player.getDuration)return this.player.getDuration()}seekTo(e){void 0!==this.player?this.shouldSeekOnlineMedia(e)&&void 0!==this.player.seekTo&&this.player.seekTo(e,!0):Q.warn(508895496,"Attempted to seek www.youtube.com but undefined player")}setMute(){void 0!==this.player&&void 0!==this.player.mute&&this.player.mute()}setUnMute(){void 0!==this.player&&void 0!==this.player.unMute&&this.player.unMute()}isMuted(){if(void 0!==this.player&&void 0!==this.player.isMuted)return this.player.isMuted()}setVolume(e){void 0!==this.player&&void 0!==this.player.setVolume&&this.player.setVolume(e)}isPaused(){return this.paused}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.youTubeIFrame&&this.youTubeIFrame.remove(),void 0!==this.pollPlayerVol&&clearInterval(this.pollPlayerVol),this.paused=!0,this.player=void 0,this.muted=void 0,this.volume=void 0,this.youTubeIFrame=void 0,this.pollPlayerVol=void 0,void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.url.searchParams.set("enablejsapi","1"),this.youTubeIFrame=document.createElement("iframe"),this.youTubeIFrame.src=this.url.toString(),this.youTubeIFrame.id="gfx-video-youtube-"+ye(),this.setProperties(this.youTubeIFrame),this.parent.append(this.youTubeIFrame),void 0!==this.mediaSizeInfo&&this.mediaSizeInfo.fEnableCropping&&this.handlePartiallyOffSlideLinkedMedia(this.mediaSizeInfo),!0===this.appSettings.fixAutoPlayEnabled?(Q.warn(507576588,`YouTube script loaded: ${Oe()} IFrameAPI Ready: ${null!==(t=window.isYouTubeIFrameAPIReady)&&void 0!==t&&t}`),Oe()&&!0===window.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(Q.warn(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),De.clientsWaitingForIFrameAPI.push(this),window.onYouTubeIframeAPIReady=()=>{window.isYouTubeIFrameAPIReady=!0;for(const e of De.clientsWaitingForIFrameAPI)e.initYouTubePlayer();De.clientsWaitingForIFrameAPI=[]},Oe()||Fe())):(Oe()||(window.onYouTubeIframeAPIReady=()=>{De.isYouTubeIFrameAPIReady=!0;for(const e of De.clientsWaitingForIFrameAPI)e.initYouTubePlayer();De.clientsWaitingForIFrameAPI=[]},Fe()),De.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(Q.info(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),De.clientsWaitingForIFrameAPI.push(this)))}initYouTubePlayer(){void 0!==this.youTubeIFrame&&(document.body.contains(this.youTubeIFrame)?this.player=new YT.Player(this.youTubeIFrame.id,{events:{onReady:e=>{this.onPlayerReady(e)},onError:e=>{void 0!==this.playbackTracker&&this.playbackTracker.onError("YouTube player entered error state "+e.data,!0)}}}):this.youTubeIFrame.onload=()=>{this.initYouTubePlayer()})}shouldSeekOnlineMedia(e){if(void 0!==this.player){const t=this.getCurrentTime();if(void 0!==t&&Math.abs(e-t)>=1)return!0}return!1}handlePartiallyOffSlideLinkedMedia(e){let t=0,i=0;e.mediaPosition.x<0&&(t=e.mediaPosition.x,this.parent.style.left="0px",this.parent.style.width=e.mediaSize.x+e.mediaPosition.x+"px"),e.mediaPosition.y<0&&(i=e.mediaPosition.y,this.parent.style.top="0px",this.parent.style.height=e.mediaSize.y+e.mediaPosition.y+"px"),e.mediaPosition.x+e.mediaSize.x>e.slideSize.x&&(e.mediaPosition.x<=0?this.parent.style.width=e.slideSize.x+"px":this.parent.style.width=e.slideSize.x-e.mediaPosition.x+"px"),e.mediaPosition.y+e.mediaSize.y>e.slideSize.y&&(e.mediaPosition.y<=0?this.parent.style.height=e.slideSize.y+"px":this.parent.style.height=e.slideSize.y-e.mediaPosition.y+"px"),this.parent.style.overflow="hidden",void 0!==this.youTubeIFrame?(this.youTubeIFrame.style.width=e.mediaSize.x+"px",this.youTubeIFrame.style.height=e.mediaSize.y+"px",this.youTubeIFrame.style.position="relative",this.youTubeIFrame.style.left=t+"px",this.youTubeIFrame.style.top=i+"px"):Q.warn(541881949,"Attempted to adjust iframe bounds but iframe is null")}onPlayerReady(e){this.onVolumeChangeHandler(),this.pollPlayerVol=setInterval(()=>this.onVolumeChangeHandler(),500),void 0!==this.player&&void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),this.playbackTracker.setVolume(this.player.getVolume()),this.playbackTracker.setIsMuted(this.player.isMuted()),this.playbackTracker.setDuration(this.player.getDuration())),e.target.addEventListener("onStateChange",e=>{this.onStateChange(e),this.capturePlaybackTelemetry(e)}),void 0!==this.onReadyCallback&&this.onReadyCallback()}onVolumeChangeHandler(){if(void 0===this.player)return;const e=this.player.isMuted(),t=this.player.getVolume(),i=void 0===this.muted||void 0===this.volume,n=this.muted!==e,r=this.volume!==t;this.muted=e,this.volume=t,i||((n||r)&&this.sendMediaEvent(4),r&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),n&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted))}onStateChange(e){switch(e.data){case-1:break;case 0:this.paused=!0,this.sendMediaEvent(6);break;case 1:this.paused=!1,this.sendMediaEvent(1);break;case 2:this.paused=!0,this.sendMediaEvent(0);break;case 3:this.sendMediaEvent(3);break;case 5:break;default:Q.info(508895495,"Unexpected Youtube Media Event: "+e.data)}}capturePlaybackTelemetry(e){if(void 0!==this.playbackTracker)switch(e.data){case 0:this.playbackTracker.onEnded();break;case 1:this.playbackTracker.onPlaying();break;case 2:this.playbackTracker.onPause();break;case 3:this.playbackTracker.onBuffering()}}sendMediaEvent(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){e.style.zIndex="6",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="all",e.style.position="absolute",e.style.objectFit="fill",e.style.border="0px",e.setAttribute("allow","autoplay"),this.setVisible()}constructor(e,t,i,n,r,a,s){this.paused=!0,this.url=new URL(e),this.parent=t,this.playbackTracker=i,this.mediaSizeInfo=n,this.onReadyCallback=r,this.onMediaEventCallback=a,this.appSettings=null!=s?s:{},this.blurHandler=()=>{var e;null===(e=this.youTubeIFrame)||void 0===e||e.blur(),this.parent.focus()};try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating YouTube video client: "+e.message,!0)}}}function Le(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Be(e){const t=Le("svg");t.setAttribute("viewBox","-1 -1 2 2"),t.setAttribute("role","button"),t.setAttribute(re,null!=e?e:"Play"),le(t,{height:"56.6px",width:"56.6px",position:"absolute",zIndex:"6",top:"calc(50% - 28.3px)",left:"calc(50% - 28.3px)",cursor:"pointer",pointerEvents:"all"});const i=Le("circle");i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","1"),i.setAttribute("fill","#404040");const n=Le("path");return n.setAttribute("d","M.5 0 L-.25 -.5 L-.25 .5 Z"),n.setAttribute("fill","none"),n.setAttribute("stroke","white"),n.setAttribute("stroke-width",".05"),n.setAttribute("opacity",".5"),t.appendChild(i),t.appendChild(n),t}De.isYouTubeIFrameAPIReady=Oe(),De.clientsWaitingForIFrameAPI=[];class Ne{get isVisible(){return"none"!==this.poster.style.display&&"none"!==this.playButton.style.display}hide(){this.poster.style.display="none",this.playButton.style.display="none"}show(){this.poster.style.display="inline",this.playButton.style.display="inline"}constructor(e,t,i,n){this.poster=document.createElement("img"),this.poster.src=e,this.poster.tabIndex=-1,this.poster.style.position="absolute",this.poster.style.width="100%",this.poster.style.height="100%",this.poster.style.zIndex="7",this.playButton=Be(n),this.poster.tabIndex=-1,this.playButton.style.zIndex="8",this.playButton.addEventListener("click",()=>{i()}),t.addEventListener("mousedown",e=>{e.preventDefault()}),t.addEventListener("keydown",e=>{!this.isVisible||"Enter"!==e.key&&" "!==e.key||(e.stopImmediatePropagation(),i())}),t.appendChild(this.poster),t.appendChild(this.playButton)}}class Ve{play(){this.logCommand("play"),this.isReady?this.client.play():this.pendingPlay=!0,this.playbackTracker.onPlayCommand()}pause(){this.logCommand("pause"),this.pendingPlay=!1,this.isReady&&this.client.pause(),this.playbackTracker.onPauseCommand()}stop(){this.logCommand("stop"),this.pendingPlay=!1,this.isReady&&this.client.stop(),this.playbackTracker.onStopCommand()}seekTo(e){this.logCommand(`seek to ${e}s`),this.isReady?this.client.seekTo(e):this.pendingSeekTime=e}togglePlayPause(){this.logCommand("togglePlayPause"),this.isReady?void 0===this.client.isPaused||void 0===this.client.isPaused()||!0===this.client.isPaused()?this.play():this.pause():this.pendingPlay?this.pause():this.play()}onReady(){this.isReady=!0,void 0!==this.pendingSeekTime&&(this.client.seekTo(this.pendingSeekTime),this.pendingSeekTime=void 0),this.pendingPlay&&(this.client.play(),this.pendingPlay=!1)}cleanup(){this.isReady=!1,this.pendingPlay=!1,this.pendingSeekTime=void 0}logCommand(e){Q.info(508870985,"OnlineVideoController recieved command: "+JSON.stringify({command:e,isReady:this.isReady,pendingPlay:this.pendingPlay,pedingSeekTime:this.pendingSeekTime,correlationId:this.playbackTracker.getCorrelationId()}))}constructor(e,t){this.isReady=!1,this.pendingPlay=!1,this.client=e,this.playbackTracker=t}}class We{get wasVetoLogged(){return this.vetoLogged}getError(){return this.error}setError(e){this.error=e}setProviderName(e){this.providerName=e}setLoggableId(e){this.mediaId=e}setCorrelationId(e){this.correlationId=e}onError(e,t,i,n,r,a){const s=this.getPrefix();let o=s+"VideoError";i?o=s+"VideoErrorWhilePlaying":void 0!==n?o=s+"VideoErrorAfterPlaying":"Stream2"===this.providerName&&(e.indexOf("status: 403")>-1?o="Stream2VideoAuthenticationError":(e.indexOf("status: 429")>-1||e.indexOf("status: 408")>-1||e.indexOf("status: 503")>-1)&&(o="Stream2VideoRedemptionStormError"));const l=e.replace(/(?:https?|ftp):\/\/[\S]+/g,"[URL]");Q.error(508671629,"Media raised error: "+JSON.stringify({isCritical:t,app:this.appSettings.App,hostView:this.appSettings.hostView,name:o,message:l,provider:this.providerName,correlationId:this.correlationId}));const d=t?1:3;(void 0===this.error||d<=this.error.severity)&&(this.error={severity:d,name:o,message:l,timestamp:Date.now()}),t&&(this.clearVideoNotPlayedTimeout(),void 0===r&&void 0===a||this.sendVeto(s+"MediaPlaybackFailure",this.error.name,this.error.message))}hasCriticalError(){return void 0!==this.error&&1===this.error.severity}logPlaybackFailure(){if(void 0!==this.error&&1===this.error.severity){const e=this.getPrefix();this.sendVeto(e+"MediaPlaybackFailure",this.error.name,this.error.message)}}logIfSlowPlaybackStart(e){this.clearVideoNotPlayedTimeout(),e>this.slowPlayVetoThreshold&&this.onSlowPerfError("VideoPlayedSlow",`Video played after ${e} ms`)}setVideoNotPlayedTimeout(e){this.videoNotYetPlayedTimeout=window.setTimeout(()=>{this.videoNotYetPlayedTimeout=void 0,void 0===e()&&this.onSlowPerfError("VideoNotYetPlayed",`Video hasn't played after ${this.notYetPlayedVetoThreshold} ms`)},this.notYetPlayedVetoThreshold)}clearVideoNotPlayedTimeout(){void 0!==this.videoNotYetPlayedTimeout&&(window.clearTimeout(this.videoNotYetPlayedTimeout),this.videoNotYetPlayedTimeout=void 0)}cleanup(){this.clearVideoNotPlayedTimeout(),this.error=void 0,this.vetoLogged=!1}onSlowPerfError(e,t){const i=this.getPrefix(),n=i+e;Q.error(508671628,"Media slow perf: "+JSON.stringify({name:n,message:t,app:this.appSettings.App,hostView:this.appSettings.hostView,provider:this.providerName,correlationId:this.correlationId})),(void 0===this.error||2<=this.error.severity)&&(this.error={name:n,severity:2,message:t,timestamp:Date.now()}),this.sendVeto(i+"MediaPerfSlow",n,t)}getPrefix(){return"Local"===this.providerName?"Local":"Stream2"===this.providerName?"Stream2":"Online"}sendVeto(e,t,i){this.vetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback({vetoName:e,errorName:t,details:i,correlationId:this.correlationId,mediaId:this.mediaId,providerName:this.providerName})}constructor(e,t,i,n,r){this.providerName="",this.mediaId="",this.vetoLogged=!1,this.slowPlayVetoThreshold=11500,this.notYetPlayedVetoThreshold=11500,this.appSettings=e,this.correlationId=t,void 0!==i&&(this.providerName=i),void 0!==n&&(this.mediaId=n),this.onVetoCallback=r,void 0!==e.SlowPlayVetoThreshold&&(this.slowPlayVetoThreshold=e.SlowPlayVetoThreshold),void 0!==e.NotYetPlayedVetoThreshold&&(this.notYetPlayedVetoThreshold=e.NotYetPlayedVetoThreshold)}}class Ue{setLoggableId(e){this.baseData.loggableMediaId=e,this.vetoHandler.setLoggableId(e)}setProviderName(e){this.baseData.providerName=e,this.vetoHandler.setProviderName(e)}setMediaType(e){this.baseData.mediaType=e}setTimeOfCreation(){this.baseData.timeOfCreation=Date.now()}setUiHostType(e){this.baseData.uiHostType=e}setFlights(e){this.baseData.flights=e}onLoadStart(){this.logEvent("loadstart"),void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now(),this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onCanPlay(){this.logEvent("canplay"),void 0===this.baseData.timeOfCanPlay&&(this.baseData.timeOfCanPlay=Date.now(),this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onSourceSet(){this.logEvent("sourceset"),void 0===this.baseData.timeOfSourceSet&&(this.baseData.timeOfSourceSet=Date.now())}onPlayRequested(){this.logEvent("playrequested"),void 0===this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=Date.now())}onPlay(){this.logEvent("play"),void 0===this.baseData.timeOfPlay&&(this.baseData.timeOfPlay=Date.now(),this.baseData.timeOfPlaying=void 0),this.lastPlayingTime=void 0}onPlaying(){this.logEvent("playing"),void 0===this.baseData.timeOfPlaying&&(this.baseData.timeOfPlaying=Date.now(),void 0!==this.baseData.timeOfPlayRequest&&this.vetoHandler.logIfSlowPlaybackStart(this.baseData.timeOfPlaying-this.baseData.timeOfPlayRequest)),this.isPlaying=!0,this.calculateBufferingTime(),void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}onPlayCommand(e=!0){if(this.logEvent("playcommand"),void 0===this.baseData.timeOfPlaying&&void 0===this.baseData.timeOfPlayRequest){if(this.baseData.timeOfPlayRequest=Date.now(),this.vetoHandler.hasCriticalError())return void this.vetoHandler.logPlaybackFailure();if(e){const e=()=>this.baseData.timeOfPlaying;this.vetoHandler.setVideoNotPlayedTimeout(e)}}}onStopCommand(){this.logEvent("stopcommand"),void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}onPause(){this.logEvent("pause"),this.isPlaying=!1,this.calculatePlayingTime()}onEnded(){this.logEvent("ended"),this.isPlaying=!1,this.baseData.wasPlayedUntilEnd=!0,this.calculatePlayingTime()}onVolumeChanged(e){this.logEvent("volumeChanged"),this.baseData.lastVolume=e}onMuteChanged(e){this.logEvent("muteChanged"),this.baseData.lastMuteState=e}onBuffering(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}onError(e,t=!1){this.logEvent("error"),this.vetoHandler.onError(e,t,this.isPlaying,this.baseData.timeOfPlaying,this.baseData.timeOfPlayRequest,this.baseData.timeOfCanPlay)}cleanup(){this.baseData.timeOfSourceSet=void 0,this.baseData.timeOfLoadStart=void 0,this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlayRequest=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0,this.baseData.timeOfError=void 0,this.baseData.totalPlayingTime=0,this.baseData.totalBufferingTime=0,this.baseData.lastVolume=void 0,this.baseData.lastMuteState=void 0,this.baseData.wasPlayedUntilEnd=void 0,this.baseData.errorName=void 0,this.baseData.errorMessage=void 0,this.baseData.wasVetoLogged=void 0,this.isPlaying=!1,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.vetoHandler.cleanup(),this.baseData.requestGuid=ye(),this.vetoHandler.setCorrelationId(this.baseData.requestGuid)}getPlaybackData(){const e=this.vetoHandler.getError();return this.baseData.errorName=null==e?void 0:e.name,this.baseData.errorMessage=null==e?void 0:e.message,this.baseData.timeOfError=null==e?void 0:e.timestamp,this.baseData.wasVetoLogged=this.vetoHandler.wasVetoLogged,this.calculatePlayingTime(),this.calculateBufferingTime(),this.baseData}getCorrelationId(){var e;return null!==(e=this.baseData.requestGuid)&&void 0!==e?e:""}setViewDimensions(e,t){this.baseData.viewWidth=e,this.baseData.viewHeight=t}setMediaId(e){this.baseData.loggableMediaId=e}setDuration(e){this.baseData.duration=e}setVolume(e){this.baseData.lastVolume=e}setIsMuted(e){this.baseData.lastMuteState=e}logEvent(e){Q.info(508704415,"Media emitted event: "+JSON.stringify({event:e,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid}))}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;void 0===this.baseData.totalBufferingTime&&(this.baseData.totalBufferingTime=0),this.baseData.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;void 0===this.baseData.totalPlayingTime&&(this.baseData.totalPlayingTime=0),this.baseData.totalPlayingTime+=e,this.lastPlayingTime=void 0}}constructor(e,t,i,n,r){this.isPlaying=!1;const a=ye();this.baseData={requestGuid:a,providerName:t,loggableMediaId:i,mediaType:n},this.vetoHandler=new We(e,a,t,i,r)}}class ze extends Ue{getPlaybackData(){return Object.assign(Object.assign({},super.getPlaybackData()),this.onlineData)}onHubbleTokenSet(){void 0===this.onlineData.timeOfHubbleToken&&(this.onlineData.timeOfHubbleToken=Date.now())}onOEmbedResponse(){void 0===this.onlineData.timeOfOEmbedResponse&&(this.onlineData.timeOfOEmbedResponse=Date.now())}onNavigatedToEmbedPage(){void 0===this.onlineData.timeOfNavigatedToEmbedPage&&(this.onlineData.timeOfNavigatedToEmbedPage=Date.now())}onPostMessagingInitialized(){void 0===this.onlineData.timeOfPostMessagingInitialized&&(this.onlineData.timeOfPostMessagingInitialized=Date.now())}onODSPVideoLoad(e){void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now()-e)}onVideoElementStopPlaying(){const e=this.baseData.lastVolume,t=this.baseData.lastMuteState,i=this.vetoHandler.getError();this.cleanup(),void 0!==e&&this.setVolume(e),void 0!==t&&this.setIsMuted(t),void 0!==i&&this.vetoHandler.setError(i)}onPlayCommand(){const e="Other"!==this.baseData.providerName&&"Ted"!==this.baseData.providerName&&"SlideShare"!==this.baseData.providerName;super.onPlayCommand(e)}onPauseCommand(){void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}cleanup(){this.onlineData.timeOfHubbleToken=void 0,this.onlineData.timeOfOEmbedResponse=void 0,this.onlineData.timeOfPostMessagingInitialized=void 0,super.cleanup()}constructor(e,t,i,n){super(e,t,i,t,n),this.onlineData={}}}class He{static setAADToken(e){Ee.setAADTokenForWaitingClients(e)}playMedia(){var e;void 0!==this.poster&&this.poster.isVisible&&this.hidePoster(),null===(e=this.controller)||void 0===e||e.play()}pauseMedia(){var e;null===(e=this.controller)||void 0===e||e.pause()}seekMedia(e){var t;null===(t=this.controller)||void 0===t||t.seekTo(e)}stopMedia(){var e;null===(e=this.controller)||void 0===e||e.stop()}togglePauseMedia(){var e;null===(e=this.controller)||void 0===e||e.togglePlayPause()}isPaused(){if(void 0!==this.client&&void 0!==this.client.isPaused)return this.client.isPaused()}setMute(){void 0!==this.client&&void 0!==this.client.setMute&&this.client.setMute()}setUnMute(){void 0!==this.client&&void 0!==this.client.setUnMute&&this.client.setUnMute()}isMuted(){if(void 0!==this.client&&void 0!==this.client.isMuted)return this.client.isMuted()}setVolume(e){void 0!==this.client&&void 0!==this.client.setVolume&&this.client.setVolume(e)}getVolume(){if(void 0!==this.client&&void 0!==this.client.getVolume)return this.client.getVolume()}getPlaybackData(){if(void 0!==this.client&&void 0!==this.client.getPlaybackData)return this.client.getPlaybackData()}getCurrentTime(){if(void 0!==this.client&&void 0!==this.client.getCurrentTime)return this.client.getCurrentTime()}getDuration(){if(void 0!==this.client&&void 0!==this.client.getDuration)return this.client.getDuration()}ensure(){void 0!==this.client&&void 0!==this.client.ensureMediaClient&&this.client.ensureMediaClient(),this.showPoster()}postAuthToken(e){void 0!==this.client&&void 0!==this.client.postAuthToken&&this.client.postAuthToken(e)}cleanup(){var e;this.hidePoster(),void 0!==this.client&&void 0!==this.client.cleanUpMediaClient&&this.client.cleanUpMediaClient(),null===(e=this.controller)||void 0===e||e.cleanup()}showPoster(){var e;void 0!==this.poster&&(Q.info(508691866,`Showing poster frame (correlationId: ${this.playbackTracker.getCorrelationId()})`),this.poster.show(),null===(e=this.client)||void 0===e||e.setHidden())}hidePoster(){var e;void 0!==this.poster&&(Q.info(508691865,`Hiding poster frame (correlationId: ${this.playbackTracker.getCorrelationId()})`),this.poster.hide(),null===(e=this.client)||void 0===e||e.setVisible())}setUiHostType(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setUiHostType(e)}setFlights(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setFlights(e)}constructor(e,t,i,n,r,a,s,o,l,d,c,h){var u;this.url=e,this.parent=t,this.appSettings=i,this.mediaSizeInfo=n,this.playbackTracker=new ze(i,void 0,c,d),this.onReadyCallback=a,this.onMediaEventCallback=s,this.onTokenRequestCallback=o,void 0!==r&&(this.poster=new Ne(r,t,()=>{this.playMedia(),void 0!==l&&l()},h)),this.onReadyCallback=()=>{var e;null===(e=this.controller)||void 0===e||e.onReady(),void 0!==a&&a()};try{this.client=function(e,t,i,n,r,a,s,o){if(!function(e){try{return void 0!==new URL(e)}catch(e){return!1}}(e))throw new Error("Attempted to create an online video client with an invalid URL");if("https:"!==new URL(e).protocol)throw new Error("Attempted to create an online video client with an unsafe URL");null==r||r.setTimeOfCreation();let l=oe(e);return!0===i.IsStream2Enabled&&void 0===l&&(l="Stream2"),void 0!==r&&void 0!==l&&r.setProviderName(l),"YouTube"===l?new De(e,t,r,n,a,s,i):"Vimeo"===l?new Re(e,t,i,r,a,s):"Flip"===l?new he(e,t,i,r,a,s):"StreamClassic"===l?new ue(e,t,i,r,a,s,o):"Ted"===l||"SlideShare"===l?new ce(e,t,i,r):"Stream2"===l?new Ee(e,t,i,r,a,s,o):(Q.warn(512271066,"Creating Default client for unidentified provider URL"),new ce(e,t,i,r))}(this.url,this.parent,this.appSettings,this.mediaSizeInfo,this.playbackTracker,this.onReadyCallback,this.onMediaEventCallback,this.onTokenRequestCallback),void 0!==this.poster&&this.poster.isVisible&&(null===(u=this.client)||void 0===u||u.setHidden()),this.controller=new Ve(this.client,this.playbackTracker)}catch(e){this.playbackTracker.onError("Error creating online video client: "+e.message,!0)}}}function Ge(e){return e.settings&&e.settings.uiHost?e.settings.uiHost.toLowerCase().indexOf("msteams")>-1?ke.MSTeams:e.settings.uiHost.toLowerCase().indexOf("teamsandroid")>-1?ke.TeamsAndroid:e.settings.uiHost.toLowerCase().indexOf("teamsios")>-1?ke.TeamsiOS:e.settings.uiHost.toLowerCase().indexOf("mtra")>-1?ke.MTRA:e.settings.uiHost.toLowerCase().indexOf("unified app")>-1?ke.UnifiedApp:e.settings.uiHost.toLowerCase().indexOf("bluechicken")>-1?ke.BlueChicken:e.settings.uiHost.toLowerCase().indexOf("ssctestapp")>-1?ke.SSCTestApp:(g.a.sendTraceTag(507004120,_.a.msoulscat_Wac_PptSession,S.a.Warning,"MediaHelper::getUIHostType Host type does not match known hosts. uiHost: "+e.settings.uiHost),ke.Unknown):(g.a.sendTraceTag(507004121,_.a.msoulscat_Wac_PptSession,S.a.Warning,"MediaHelper::getUIHostType Unknown host type due to null settings or uiHost"),ke.Unknown)}function je(e){return!(!e.settings||!e.settings.uiHost||-1===e.settings.uiHost.toLowerCase().indexOf("teams")&&-1===e.settings.uiHost.toLowerCase().indexOf("mtra"))}function $e(e){return!!je(e)&&(Ye(e)?Ze():-1===window.navigator.userAgent.indexOf("Electron"))}function qe(e){return Ge(e)===ke.UnifiedApp||Ge(e)===ke.BlueChicken||Ge(e)===ke.SSCTestApp}function Ze(){const e=window.navigator.userAgent||window.navigator.vendor;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4)))}function Je(e){return!!F.a.readBooleanOrDefault("iOSHostOverride",!1)||e===ke.TeamsiOS}function Xe(e){return!!F.a.readBooleanOrDefault("iOSHostOverride",!1)||Je(Ge(e))}function Ye(e){return Xe(e)||G.ChangeGate.isChangeGateEnabled("SVM.isMtraMobileDevice")&&Ge(e)===ke.MTRA||Ge(e)===ke.TeamsAndroid||Ze()}!function(e){e[e.None=0]="None",e[e.Image=1]="Image",e[e.Hlink=2]="Hlink",e[e.Silverlight=3]="Silverlight",e[e.HTML5=4]="HTML5",e[e.FlashObject=5]="FlashObject"}(xe||(xe={})),function(e){e[e.UnifiedApp=0]="UnifiedApp",e[e.MSTeams=1]="MSTeams",e[e.TeamsiOS=2]="TeamsiOS",e[e.TeamsAndroid=3]="TeamsAndroid",e[e.MTRA=4]="MTRA",e[e.BlueChicken=5]="BlueChicken",e[e.SSCTestApp=6]="SSCTestApp",e[e.Unknown=7]="Unknown"}(ke||(ke={})),function(e){e[e.Low=0]="Low",e[e.Med=1]="Med",e[e.High=2]="High",e[e.Raw=3]="Raw"}(Me||(Me={}));class Ke{static getCanPlayType(e){let t;if(-1!==e.indexOf("video"))t=document.createElement("video");else{if(-1===e.indexOf("audio"))return g.a.sendTraceTag(507004119,_.a.msoulscat_Wac_PptSession,S.a.Error,`MediaHelper::getCanPlayType(): Unexpected contentType ${e}.`),"";t=document.createElement("audio")}if(!t)return"";let i="";try{i=t.canPlayType(e)}catch(e){g.a.sendTraceTag(507004118,_.a.msoulscat_Wac_PptSession,S.a.Warning,`MediaHelper::getCanPlayType() throws exception: ${e}.`)}return i}static getMediaRenderAs(e){if("application/x-shockwave-flash"===e)return xe.FlashObject;const t=Ke.getCanPlayType(e);return"probably"===t||"maybe"===t||"video/quicktime"===e.toLowerCase()?xe.HTML5:xe.None}static getTranscodeMediaQuality(e,t,i,n){let r=Me.Raw,a=Me.Raw;F.a.readBooleanOrDefault("useNetworkForTranscodedMediaQuality",!0)&&e&&(a=e>=5?Me.High:e>=2.5?Me.Med:Me.Low);let s=Me.Low;const o=t.y*i.y;t&&(s=o>=900?Me.High:o>=600?Me.Med:Me.Low);const l=Ye(n),d=l?Me.Low:Me.High;return r=Math.min(a,s,d),g.a.sendTraceTag(507004117,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify({connectionSpeedInMbps:e,mediaSize:o,isMobile:l,networkBasedQuality:a,sizeBasedQuality:s,deviceBasedQuality:d,selectedMediaQuality:r})),r}static isStreamURL(e){try{return new URL(e).hostname.toLowerCase().endsWith("microsoftstream.com")}catch{return!1}}static convertYouTubeFlashUrlToIFrameUrl(e){let t=e;const i=t.indexOf("?");i>=0&&(t=t.substring(0,i));const n="youtube.com/v/".length,r=t.toLowerCase().indexOf("youtube.com/v/");return r>=0?(t=t.substring(0,r)+"youtube.com/embed/"+t.substring(r+n,t.length),t):e}static fIsSafeHyperlink(e){const t=document.createElement("a");t.href=e;try{return Ke.isLinkable(t.href)}catch(e){return!1}}static stripIgnoredLinkChars(e){let t=0,i=e.length;for(;i>t&&-1!=="#%&*{}:<>?+.;(),!']\"".indexOf(e.charAt(i-1));)i-=1;for(;t<i&&-1!=="(['\"".indexOf(e.charAt(t));)t+=1;return e.substr(t,i-t)}static isLinkable(e){const t=["http://","https://","file://","file:\\\\","ftp://","mailto:","news:","\\\\","www.","onenote:"];let i=e.toLowerCase();i=Ke.stripIgnoredLinkChars(i);const n=t.length;for(let i=0;i<n;i+=1)if(e.startsWith(t[i]))return!0;return!1}static controlVersion(){let e,t;try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),e=t.GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e="WIN 6,0,21,0",t.AllowScriptAccess="always",e=t.GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),e=t.GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),e="WIN 3,0,18,0"}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e="WIN 2,0,0,11"}catch(t){e=-1}return e}static getSwfVer(){const e=-1!==navigator.appVersion.indexOf("MSIE"),t=-1!==navigator.appVersion.toLowerCase().indexOf("win"),i=-1!==navigator.userAgent.indexOf("Opera");let n="-1";if(null!=navigator.plugins&&navigator.plugins.length>0){if("object"==typeof navigator.plugins.namedItem("Shockwave Flash 2.0")||"object"==typeof navigator.plugins.namedItem("Shockwave Flash")){const e="object"==typeof navigator.plugins.namedItem("Shockwave Flash 2.0")?" 2.0":"",t=navigator.plugins.namedItem("Shockwave Flash"+e).description.split(" "),i=t[2].split("."),r=i[0],a=i[1];let s=t[3];""===s&&(s=t[4]),"d"===s[0]?s=s.substring(1):"r"===s[0]&&(s=s.substring(1),s.indexOf("d")>0&&(s=s.substring(0,s.indexOf("d")))),n=`${r}.${a}.${s}`}}else-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?n="4":-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?n="3":-1!==navigator.userAgent.toLowerCase().indexOf("webtv")?n="2":e&&t&&!i&&(n=Ke.controlVersion());return n}static get fFlashInstalled(){let e;const t=Ke.getSwfVer();if("-1"===t)return!1;if("0"!==t){e=-1!==t.indexOf("WIN")?t.split(" ")[1].split(","):t.split(".");const i=e[0],n=e[1],r=e[2];if(parseFloat(i)>10)return!0;if(10===parseFloat(i)){if(parseFloat(n)>1)return!0;if(1===parseFloat(n)&&parseFloat(r)>=0)return!0}return!1}return!1}static parseSeekTimeFromMediaCommandString(e,t){if(!e)return-1;const i=e.toLowerCase();if(i.length<=0)return-1;const n=i.indexOf("(");if(n<=0)return-1;const r=i.substring(0,n);if(r.length<=0)return-1;const a=i.indexOf(")");if("playfrom"===r){const e=i.substring(n+1,a),t=parseFloat(e);return isNaN(t)?-1:t}if("playfrombookmark"===r){const e=i.substring(n+1,a),r=t.find(t=>e.indexOf(t.name.toLowerCase())>=0);return r?r.time/1e3:-1}return-1}static getMediaTypeFromContentType(e){const t=e.indexOf("/");if(t>0)switch(e.substring(0,t)){case"video":return"Video";case"audio":return"Audio";default:return""}return""}static isBrowserSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}class Qe{static setNewStreamPlayer(e){void 0!==e?Qe.newStreamPlayer=e:g.a.sendTraceTag(507004116,_.a.msoulscat_Wac_PptSession,S.a.Error,"StreamAuth: Trying to set newStreamPlayer when newStreamPlayer is undefined")}static postAadTokenToStream(e){He.setAADToken(e),void 0===this.newStreamPlayer||this.newStreamPlayer.postAuthToken(e)}}function et(e,t,i){if(!i.metadata||!i.metadata.mediaSyncTimeLine)return void g.a.sendTraceTag(507004115,_.a.msoulscat_Wac_PptLive,S.a.Info,t+"::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine.");const n=`${t}: ${e}`;i.metadata.mediaSyncTimeLine.push(n),g.a.sendTraceTag(507004114,_.a.msoulscat_Wac_PptLive,S.a.Info,JSON.stringify({fileName:t,mediaSyncState:i}))}function tt(e){J.e.recordVeto("CustomControlFailure",{errorName:e,qosVeto:"CustomControlFailure",isIntentional:!0})}Qe.newStreamPlayer=void 0;class it{shouldSendMediaUpdate(){if(void 0!==this.lastRecievedEvent){const e=Date.now(),t=e-this.lastRecievedEvent,i=t<this.presenterToPresenterWaitTimeMs;if(g.a.sendTraceTag(507004183,_.a.msoulscat_Wac_PptSession,S.a.Info,`shouldSendMediaUpdate: Date.now(): ${e}, lastReceivedEvent: ${this.lastRecievedEvent}, timeElapsed: ${t},\n        presenterToPresenterWaitTimeMs: ${this.presenterToPresenterWaitTimeMs}, fSuppressUpdate: ${i}`),i)return!1}else g.a.sendTraceTag(507004182,_.a.msoulscat_Wac_PptSession,S.a.Info,"shouldSendMediaUpdate: lastReceivedEvent is undefined");return!0}updateLastTimeRecievedEvent(){this.lastRecievedEvent=Date.now()}constructor(e){this.presenterToPresenterWaitTimeMs=e}}const nt='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">',rt='<path d="M12.4014 13.2403C13.222 12.83 14.2039 12.9967 14.8536 13.6464C15.0488 13.8417 15.0488 14.1583 14.8535 14.3536C14.6583 14.5488 14.3417 14.5488 14.1464 14.3535C13.7961 14.0032 13.278 13.92 12.8486 14.1347C12.4366 14.3407 12 14.8852 12 16C12 17.1148 12.4366 17.6593 12.8486 17.8653C13.278 18.08 13.7961 17.9967 14.1464 17.6464C14.3417 17.4512 14.6583 17.4512 14.8536 17.6464C15.0488 17.8417 15.0488 18.1583 14.8536 18.3535C14.2039 19.0032 13.222 19.17 12.4014 18.7597C11.5634 18.3407 11 17.3852 11 16C11 14.6149 11.5634 13.6593 12.4014 13.2403ZM20.3536 13.6465C19.7039 12.9968 18.722 12.83 17.9014 13.2403C17.0634 13.6593 16.5 14.6149 16.5 16C16.5 17.3852 17.0634 18.3407 17.9014 18.7597C18.722 19.17 19.7039 19.0033 20.3536 18.3536C20.5488 18.1583 20.5488 17.8417 20.3536 17.6465C20.1583 17.4512 19.8417 17.4512 19.6464 17.6465C19.2961 17.9968 18.778 18.08 18.3486 17.8653C17.9366 17.6593 17.5 17.1148 17.5 16C17.5 14.8852 17.9366 14.3408 18.3486 14.1347C18.778 13.9201 19.2961 14.0033 19.6464 14.3536C19.8417 14.5488 20.1583 14.5488 20.3535 14.3536C20.5488 14.1583 20.5488 13.8417 20.3536 13.6465ZM8 13C8 11.3431 9.34315 10 11 10H21C22.6569 10 24 11.3431 24 13V19C24 20.6569 22.6569 22 21 22H11C9.34315 22 8 20.6569 8 19V13ZM11 11C9.89543 11 9 11.8954 9 13V19C9 20.1046 9.89543 21 11 21H21C22.1046 21 23 20.1046 23 19V13C23 11.8954 22.1046 11 21 11H11Z" fill="white"/>',at=`${nt}${rt}</svg>`,st=`${nt}${rt}<rect y="31.885" width="2" height="32" transform="rotate(-90 0 31.885)" fill="white"/></svg>`;function ot(e){let t="";switch(e){case"play-pause-gfxicon":t='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path id="play-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M24.1059 15.0879C25.1413 15.6575 25.1413 17.1443 24.1059 17.7139L14.1089 23.2129C13.1092 23.7628 11.8855 23.0402 11.8855 21.9L11.8855 10.9018C11.8855 9.76156 13.1092 9.03893 14.1089 9.58883L24.1059 15.0879ZM23.6236 16.8385C23.9688 16.6487 23.9688 16.1531 23.6236 15.9632L13.6266 10.4641C13.2934 10.2808 12.8855 10.5217 12.8855 10.9018L12.8855 21.9C12.8855 22.28 13.2934 22.5209 13.6266 22.3376L23.6236 16.8385Z"/><path  id="pause-gfxicon" fill="#FFFFFF" fill-opacity="1.000" d="M11.8855 8.77393C10.7809 8.77393 9.8855 9.66936 9.8855 10.7739V22.7739C9.8855 23.8785 10.7809 24.7739 11.8855 24.7739H13.8855C14.9901 24.7739 15.8855 23.8785 15.8855 22.7739V10.7739C15.8855 9.66936 14.9901 8.77393 13.8855 8.77393H11.8855ZM10.8855 10.7739C10.8855 10.2216 11.3332 9.77393 11.8855 9.77393H13.8855C14.4378 9.77393 14.8855 10.2216 14.8855 10.7739V22.7739C14.8855 23.3262 14.4378 23.7739 13.8855 23.7739H11.8855C11.3332 23.7739 10.8855 23.3262 10.8855 22.7739V10.7739ZM19.8855 8.77393C18.7809 8.77393 17.8855 9.66936 17.8855 10.7739V22.7739C17.8855 23.8785 18.7809 24.7739 19.8855 24.7739H21.8855C22.9901 24.7739 23.8855 23.8785 23.8855 22.7739V10.7739C23.8855 9.66936 22.9901 8.77393 21.8855 8.77393H19.8855ZM18.8855 10.7739C18.8855 10.2216 19.3332 9.77393 19.8855 9.77393H21.8855C22.4378 9.77393 22.8855 10.2216 22.8855 10.7739V22.7739C22.8855 23.3262 22.4378 23.7739 21.8855 23.7739H19.8855C19.3332 23.7739 18.8855 23.3262 18.8855 22.7739V10.7739Z"/></svg>';break;case"volume-gfxicon":t='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path id="volume-low-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995Z"/><path id="volume-medium-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM20.0814 18.9332C19.8421 18.7954 19.7599 18.4897 19.8977 18.2504C20.6739 16.9028 20.7294 15.1916 19.897 13.7499C19.759 13.5108 19.8409 13.205 20.08 13.0669C20.3192 12.9288 20.625 13.0108 20.7631 13.2499C21.7811 15.0132 21.7112 17.1054 20.7642 18.7495C20.6264 18.9888 20.3207 19.0711 20.0814 18.9332Z"/><path id="volume-high-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM22.1422 10.7746C22.3478 10.5903 22.6639 10.6076 22.8482 10.8133C25.5644 13.8449 25.5645 18.449 22.8483 21.4806C22.664 21.6863 22.3479 21.7036 22.1422 21.5194C21.9365 21.3351 21.9192 21.019 22.1035 20.8133C24.4794 18.1615 24.4794 14.1324 22.1034 11.4806C21.9192 11.2749 21.9365 10.9588 22.1422 10.7746ZM20.0814 18.9332C19.8421 18.7954 19.7599 18.4897 19.8977 18.2504C20.6739 16.9028 20.7294 15.1916 19.897 13.7499C19.759 13.5108 19.8409 13.205 20.08 13.0669C20.3192 12.9288 20.625 13.0108 20.7631 13.2499C21.7811 15.0132 21.7112 17.1054 20.7642 18.7495C20.6264 18.9888 20.3207 19.0711 20.0814 18.9332Z"/><path id="volume-muted-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM20.029 14.1665C20.2243 13.9712 20.5409 13.9712 20.7361 14.1665L22.3826 15.8129L24.029 14.1665C24.2243 13.9712 24.5409 13.9712 24.7361 14.1665C24.9314 14.3617 24.9314 14.6783 24.7361 14.8736L23.0897 16.52L24.7361 18.1665C24.9314 18.3617 24.9314 18.6783 24.7361 18.8736C24.5409 19.0688 24.2243 19.0688 24.029 18.8736L22.3826 17.2271L20.7361 18.8736C20.5409 19.0688 20.2243 19.0688 20.029 18.8736C19.8338 18.6783 19.8338 18.3617 20.029 18.1665L21.6755 16.52L20.029 14.8736C19.8338 14.6783 19.8338 14.3617 20.029 14.1665Z"/></svg>';break;case"captions-gfxicon":t=at;break;case"captions-active-gfxicon":t=st;break;case"checkmark-gfxicon":t='<svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.3516 1.35156L5 9.71094L0.648438 5.35156L1.35156 4.64844L5 8.28906L12.6484 0.648438L13.3516 1.35156Z" fill="white"/></svg>';break;case"fullscreen-gfxicon":t='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path id="fullscreen-enter-gfxicon" d="M9.8855 11.8931C9.8855 10.7885 10.7809 9.89307 11.8855 9.89307H13.8855C14.1616 9.89307 14.3855 10.1169 14.3855 10.3931C14.3855 10.6692 14.1616 10.8931 13.8855 10.8931H11.8855C11.3332 10.8931 10.8855 11.3408 10.8855 11.8931V13.8931C10.8855 14.1692 10.6616 14.3931 10.3855 14.3931C10.1094 14.3931 9.8855 14.1692 9.8855 13.8931V11.8931ZM19.3855 10.3931C19.3855 10.1169 19.6094 9.89307 19.8855 9.89307H21.8855C22.9901 9.89307 23.8855 10.7885 23.8855 11.8931V13.8931C23.8855 14.1692 23.6616 14.3931 23.3855 14.3931C23.1094 14.3931 22.8855 14.1692 22.8855 13.8931V11.8931C22.8855 11.3408 22.4378 10.8931 21.8855 10.8931H19.8855C19.6094 10.8931 19.3855 10.6692 19.3855 10.3931ZM10.3855 19.3931C10.6616 19.3931 10.8855 19.6169 10.8855 19.8931V21.8931C10.8855 22.4454 11.3332 22.8931 11.8855 22.8931H13.8855C14.1616 22.8931 14.3855 23.1169 14.3855 23.3931C14.3855 23.6692 14.1616 23.8931 13.8855 23.8931H11.8855C10.7809 23.8931 9.8855 22.9976 9.8855 21.8931V19.8931C9.8855 19.6169 10.1094 19.3931 10.3855 19.3931ZM23.3855 19.3931C23.6616 19.3931 23.8855 19.6169 23.8855 19.8931V21.8931C23.8855 22.9976 22.9901 23.8931 21.8855 23.8931H19.8855C19.6094 23.8931 19.3855 23.6692 19.3855 23.3931C19.3855 23.1169 19.6094 22.8931 19.8855 22.8931H21.8855C22.4378 22.8931 22.8855 22.4454 22.8855 21.8931V19.8931C22.8855 19.6169 23.1094 19.3931 23.3855 19.3931Z" fill="white"/><path id="fullscreen-exit-gfxicon" d="M20.8855 11.2661C20.8855 11.8184 21.3332 12.2661 21.8855 12.2661L23.8855 12.2661C24.1616 12.2661 24.3855 12.49 24.3855 12.7661C24.3855 13.0423 24.1616 13.2661 23.8855 13.2661H21.8855C20.7809 13.2661 19.8855 12.3707 19.8855 11.2661V9.26611C19.8855 8.98997 20.1094 8.76611 20.3855 8.76611C20.6616 8.76611 20.8855 8.98997 20.8855 9.26611V11.2661ZM12.8855 21.2661C12.8855 20.7138 12.4378 20.2661 11.8855 20.2661H9.8855C9.60936 20.2661 9.3855 20.0423 9.3855 19.7661C9.3855 19.49 9.60936 19.2661 9.8855 19.2661H11.8855C12.9901 19.2661 13.8855 20.1615 13.8855 21.2661V23.2661C13.8855 23.5423 13.6616 23.7661 13.3855 23.7661C13.1094 23.7661 12.8855 23.5423 12.8855 23.2661V21.2661ZM20.8855 21.2661C20.8855 20.7138 21.3332 20.2661 21.8855 20.2661H23.8855C24.1616 20.2661 24.3855 20.0423 24.3855 19.7661C24.3855 19.49 24.1616 19.2661 23.8855 19.2661H21.8855C20.7809 19.2661 19.8855 20.1615 19.8855 21.2661V23.2661C19.8855 23.5423 20.1094 23.7661 20.3855 23.7661C20.6616 23.7661 20.8855 23.5423 20.8855 23.2661V21.2661ZM11.8855 12.2661C12.4378 12.2661 12.8855 11.8184 12.8855 11.2661L12.8855 9.26611C12.8855 8.98997 13.1094 8.76611 13.3855 8.76611C13.6616 8.76611 13.8855 8.98997 13.8855 9.26611V11.2661C13.8855 12.3707 12.9901 13.2661 11.8855 13.2661H9.8855C9.60936 13.2661 9.3855 13.0423 9.3855 12.7661C9.3855 12.49 9.60936 12.2661 9.8855 12.2661L11.8855 12.2661Z" fill="white"/></svg>'}const i=(new DOMParser).parseFromString(t,"image/svg+xml"),n=document.importNode(i.documentElement,!0);return n.classList.add(e),n.setAttribute("aria-hidden","true"),n}const lt=new Map([["af","Afrikaans"],["am","አማርኛ"],["ar","العربية"],["as","অসমীয়া"],["bg","Български"],["bn","বাংলা"],["bs","Bosanski"],["ca","Català"],["cs","Česky"],["cy","Cymraeg"],["da","Dansk"],["de","Deutsch"],["el","Ελληνικά"],["en","English"],["es","Español"],["et","Eesti"],["fa","فارسی"],["fi","Suomi"],["fil","Filipino"],["fj","Viti"],["fr","Français"],["ga","Gaeilge (Éire)"],["gu","ગુજરાતી"],["he","עברית"],["hi","हिन्दी"],["hr","Hrvatski"],["ht","Ayisyen"],["hu","Magyar"],["id","Bahasa Indonesia"],["is","Íslenska"],["it","Italiano"],["ja","日本語"],["jv","Jawa"],["kk","Қазақша"],["km","ខ្មែរ"],["kmr","Kurdî (Bakurî)"],["kn","ಕನ್ನಡ"],["ko","한국어"],["ku","کوردی (ناوەند)"],["lt","Lietuvių"],["lo","ລາວ"],["lv","Latviešu"],["mg","Malagasy"],["mi","Te reo Māori"],["mk","македонски"],["ml","മലയാളം"],["mr","मराठी"],["ms","Melayu"],["mt","Malti"],["mww","Hmoob"],["my","မြန်မာနိုင်ငံ"],["nb","Norsk Bokmål"],["nl","Nederlands"],["no","Norsk"],["or","ଓଡିଆ"],["otq","Maxei hñäñho"],["pa","ਪੰਜਾਬੀ"],["pl","Polski"],["prs","دری"],["ps","پښتو"],["pt","Português"],["ro","Română"],["ru","Русский"],["si","සිංහල"],["sk","Slovenčina"],["sl","Slovenščina"],["sm","Samoa"],["sr-cyrl","српски (ћирилица)"],["sr-latn","srpski (latinica)"],["sv","Svenska"],["sw","Kiswahili"],["ta","தமிழ்"],["te","తెలుగు"],["th","ไทย"],["to","Tonga"],["tr","Türkçe"],["ty","Tahiti"],["uk","Українська"],["ur","اردو"],["uz","o‘zbek"],["vi","Tiếng Việt"],["yua","Yucateco"],["yue","粵語"],["zh","中文"],["zh-cn","中文 (简体)"],["zh-hans","中文 (简体)"],["zh-hant","中文 (繁體)"],["zh-hk","中文 (繁體)"],["zh-tw","中文 (繁體)"],["zu","isiZulu"],["unknown","Unknown"]]);function dt(e){let t,i=e.toLowerCase();for(;void 0===t&&(t=lt.get(i),!(i.indexOf("-")<0));)i=i.substring(0,i.lastIndexOf("-"));return void 0===t?e:t}function ct(e,t){return null!==e&&null!==t&&e.toLowerCase().startsWith(t.toLowerCase())&&e.length>t.length&&"-"===e.charAt(t.length)}function ht(){return window.matchMedia("screen and (forced-colors: active)").matches}function ut(e,t,i){let n;try{n=JSON.stringify({value:t,expiration:i.toISOString()})}catch(e){return}window.localStorage.setItem(e,n)}function mt(e){const t=localStorage.getItem(e);if(null===t)return null;let i;try{i=JSON.parse(t)}catch(t){return localStorage.removeItem(e),null}return!Number.isInteger(i.expiration)&&Number.isNaN(Date.parse(i.expiration))||new Date(i.expiration)<=new Date?(localStorage.removeItem(e),null):i.value}const ft=["B","I","U"];function pt(e,t){const i=new DOMParser;t.replaceChildren(i.parseFromString(e,"text/html").body),function e(t){for(const i of t.childNodes)if(i.nodeType===Node.ELEMENT_NODE){e(i);const t=i;ft.indexOf(i.nodeName.toUpperCase())>=0?[...t.attributes].forEach(e=>t.removeAttribute(e.name)):t.replaceWith(...t.childNodes)}}(t)}class gt{get getDefaultLang(){return this.defaultLang}set setDefaultLang(e){this.defaultLang=e}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}visible(){return"block"===this.container.style.display}onNavigatingFrom(){this.stopCaptionTrack()}setScreenCoords(e){var t,i;null===(t=this.resizeObserver)||void 0===t||t.disconnect(),this.screenCoords=e,this.screenCoordsProvided=null!=e,this.screenCoordsProvided&&(null===(i=this.resizeObserver)||void 0===i||i.observe(this.screenCoords),this.setHorizontalPosition(void 0),this.setVerticalPosition(!0))}selectCaptionsTrack(e){this.activeTextTrackIndex=e,this.activeCues=[],this.cloneCues()}renderCaptionTrack(e,t,i,n){le(this.container,{fontSize:this.fontSize*t.getCaptionsScalingFactor()+"px"}),!n&&e.paused||(void 0!==this.activeVideoEl&&void 0!==this.activeControls&&this.activeVideoEl.id!==e.id&&(this.activeControls.disableCaptionsInPlayer(),this.stopRendering(),this.screenCoordsProvided||(this.screenCoords=e)),this.activeVideoEl=e,this.activeControls=t,this.activeTextTrackIndex=i,this.activeCues=[],this.cloneCues()),e.addEventListener("timeupdate",this.onTimeUpdate),e.addEventListener("seeked",this.onSeeked),e.addEventListener("play",this.onPlay),e.addEventListener("pause",this.onPause),Q.info(508155723,JSON.stringify({Description:"CaptionsRenderer.renderCaptionTrack: Info",Font:this.container.style.font,FontOpticalSizing:this.container.style.fontOpticalSizing,FontSize:this.container.style.fontSize,FontSizeAdjust:this.container.style.fontSizeAdjust,FontStretch:this.container.style.fontStretch,Height:this.container.style.height,Scale:this.container.style.scale})),this.startRendering()}stopCaptionTrack(){var e;0!==(null===(e=this.activeControls)||void 0===e?void 0:e.getCaptionSelection)&&(void 0!==this.activeVideoEl&&(this.activeVideoEl.removeEventListener("timeupdate",this.onTimeUpdate),this.activeVideoEl.removeEventListener("seeked",this.onSeeked),this.activeVideoEl.removeEventListener("play",this.onPlay),this.activeVideoEl.removeEventListener("pause",this.onPause)),this.stopRendering())}updateContainer(e){null===this.container.parentElement&&this.setParent(),this.setZIndex(e)}reduceOpacity(){this.currentOpacity=this.reducedOpacity,this.container.style.opacity=this.currentOpacity}resetOpacity(){this.currentOpacity=this.visibleOpacity,this.container.style.opacity=this.currentOpacity}setHorizontalPosition(e){var t;if(null===this.container.parentElement)return void Q.warn(508954693,"CaptionsRenderer.setHorizontalPosition: Parent element is null");if(null===(null===(t=this.screenCoords)||void 0===t?void 0:t.parentElement))return void Q.warn(508954692,"CaptionsRenderer.setHorizontalPosition: screenCoords parent element is null");const i=this.screenCoords.getBoundingClientRect().width,n=Math.min(.6*i,this.maxCharacterWidth),r=.5*(this.container.parentElement.getBoundingClientRect().width-n);if(this.container.style.left=r+"px",this.container.style.right=r+"px",this.container.style.left="0",this.container.style.right="0",this.container.style.marginLeft="auto",this.container.style.marginRight="auto",void 0!==e&&void 0!==this.activeControls&&this.activeControls.isVisible()&&void 0!==e&&this.boxIntersects(e)){const t=i/2<(e.left+e.right)/2;this.container.style.transform=t?`translateX(-${this.maxCharacterWidth}px)`:`translateX(${this.maxCharacterWidth}px)`,Q.info(508954691,"CaptionsRenderer.setHorizontalPosition: Box overlaps controls, adjusting position: "+(t?"left":"right"))}}resetHorizontalPosition(){var e;1===(null===(e=this.activeControls)||void 0===e?void 0:e.getPositioningStrategy)&&(this.container.style.transform="")}setVerticalPosition(e){var t;if(null===this.container.parentElement)return void Q.warn(510252311,"CaptionsRenderer.setVerticalPosition: Parent element is null");if(null===(null===(t=this.screenCoords)||void 0===t?void 0:t.parentElement))return void Q.warn(509691528,"CaptionsRenderer.setVerticalPosition: screenCoords parent element is null");if(void 0===this.activeControls)return;if(!e&&1===this.activeControls.getPositioningStrategy&&!this.activeControls.isVisible())return;const i=.6*Ft(this.screenCoords.style.width);this.container.style.maxWidth=Math.min(i,this.maxCharacterWidth)+"px",this.container.style.maxHeight=this.boxHeight+"px";const n=this.screenCoords.getBoundingClientRect(),r=n.height,a=.04*r,s=this.container.parentElement.getBoundingClientRect().bottom-n.bottom+a;Q.info(510252309,`CaptionsRenderer.setVerticalPosition: Current bottom: ${this.container.style.bottom}, new bottom: ${s}, pageHeight: ${r}, boxHeight: ${this.boxHeight}, bottomOffset: ${a}, maxBoxWidth: ${i}, maxCharacterWidth: ${this.maxCharacterWidth}`),this.container.style.bottom=s+"px",2!==this.activeControls.getPositioningStrategy&&this.activeControls.getPositioningStrategy}boxIntersects(e){if(void 0===this.activeControls)return!1;const t=this.container.getBoundingClientRect(),i=t.right-t.left,n=Ft(this.container.style.maxWidth)/2-i/2,r=t.left-n,a=t.right+n,s=t.bottom,o=s-this.boxHeight;return!(e.right<r||e.left>a||e.bottom<o||e.top>s)}setCuePreview(e,t,i){var n,r;if(t>=i||t>=(null!==(r=null===(n=this.activeVideoEl)||void 0===n?void 0:n.duration)&&void 0!==r?r:Number.NEGATIVE_INFINITY))return this.clearCuePreview(),void this.hide();this.cuePreview=e,this.cuePreviewStartTime=t,this.cuePreviewEndTime=i,this.show()}clearCuePreview(){this.cuePreview=void 0,this.cuePreviewStartTime=void 0,this.cuePreviewEndTime=void 0}hasCuePreview(){return void 0!==this.cuePreview&&void 0!==this.cuePreviewStartTime&&void 0!==this.cuePreviewEndTime}isCuePreviewActive(){return void 0!==this.cuePreview&&void 0!==this.cuePreviewStartTime&&void 0!==this.cuePreviewEndTime&&void 0!==this.activeVideoEl&&!this.activeVideoEl.paused&&this.activeVideoEl.currentTime>=this.cuePreviewStartTime-.1&&this.activeVideoEl.currentTime<=this.cuePreviewEndTime+.25}cloneCues(){var e,t,i;const n=void 0!==(null===(e=this.activeVideoEl)||void 0===e?void 0:e.textTracks)&&this.activeTextTrackIndex>=0&&this.activeTextTrackIndex<(null===(t=this.activeVideoEl)||void 0===t?void 0:t.textTracks.length)?null===(i=this.activeVideoEl)||void 0===i?void 0:i.textTracks[this.activeTextTrackIndex].cues:void 0;if(null!=n){const e=[];for(const t of n)e.push(new VTTCue(t.startTime,t.endTime,t.text));this.activeCues=e,this.setInitialCue()}else this.clearText()}setParent(){const e=document.getElementById(this.parentName);null!==e?(this.container.addEventListener("resize",this.onResize),e.appendChild(this.container),this.setHorizontalPosition(void 0),this.setVerticalPosition(!0)):Q.warn(510252312,"CaptionsRenderer.setParent: Parent was null, parentName: "+this.parentName)}setZIndex(e){this.container.style.zIndex=""+e}setInitialCue(){if(0!==this.activeCues.length){this.lastUpdate=0,this.clearText();for(let e=0;e<this.activeCues.length;e+=1){const t=this.activeCues[e];if(void 0===this.activeVideoEl)return;if(t.startTime>this.activeVideoEl.currentTime)return void(e>0?this.setTextById(e-1):this.activeCueIndex=-1);if(this.activeCueIndex=e,this.activeVideoEl.currentTime-t.startTime<=this.minCueMargin)return void this.setText(t.text)}}else this.activeCueIndex=0}startRendering(){this.visible()||void 0===this.activeVideoEl||this.activeVideoEl.paused||this.show(),this.setHorizontalPosition(void 0),this.setVerticalPosition(!0),0!==this.activeCues.length||void 0!==this.cuePreview?this.setInitialCue():Q.warn(509670627,"CaptionsRenderer.startRendering: activeCues is empty")}stopRendering(){this.visible()&&this.hide(),this.clearText(),this.clearCuePreview()}clearText(){void 0===this.cuePreview&&(this.container.style.opacity="0",this.container.textContent="")}setText(e){var t;this.container.style.opacity=this.currentOpacity,this.isCuePreviewActive()?pt(null!==(t=this.cuePreview)&&void 0!==t?t:"",this.container):pt(e,this.container)}setTextById(e){var t;if(this.isCuePreviewActive())return void pt(null!==(t=this.cuePreview)&&void 0!==t?t:"",this.container);if(0===this.activeCues.length)return void(this.container.textContent="");const i=this.activeCues[e];void 0!==i?(this.container.style.opacity=this.currentOpacity,pt(i.text,this.container)):this.container.textContent=""}constructor(e,t){var i;this.visibleOpacity=".8",this.reducedOpacity=".1",this.updateDelay=.1,this.minCueMargin=.5,this.boxHeight=94,this.maxCharacterWidth=400,this.fontSize=24,this.lastUpdate=0,this.activeTextTrackIndex=0,this.activeCueIndex=0,this.currentOpacity=this.visibleOpacity,this.defaultLang="",this.activeCues=[],this.onResize=()=>{var e;setTimeout(()=>{this.setHorizontalPosition(void 0),this.setVerticalPosition(!0)},0),1===(null===(e=this.activeControls)||void 0===e?void 0:e.getPositioningStrategy)&&this.resetHorizontalPosition()},this.onPlay=()=>{},this.onPause=()=>{this.clearCuePreview()},this.onSeeked=()=>{this.setInitialCue()},this.onTimeUpdate=()=>{var e;if(0===this.activeCues.length&&this.cloneCues(),void 0!==this.activeControls&&this.updateContainer(this.activeControls.getZIndex()-1),void 0===this.activeVideoEl||this.activeVideoEl.paused||this.visible()||this.show(),this.isCuePreviewActive()?(this.container.style.opacity=this.currentOpacity,pt(null!==(e=this.cuePreview)&&void 0!==e?e:"",this.container)):this.clearCuePreview(),-2===this.activeCueIndex||!this.visible()||0===this.activeCues.length||void 0===this.activeVideoEl||this.activeVideoEl.paused)return;if(this.activeVideoEl.currentTime-this.lastUpdate<this.updateDelay)return;this.lastUpdate=this.activeVideoEl.currentTime;const t=this.activeCueIndex+1>=this.activeCues.length;this.activeCueIndex>=0&&this.activeCues[this.activeCueIndex].endTime<=this.activeVideoEl.currentTime&&(this.clearText(),t&&(this.activeCueIndex=-2)),t||this.activeCues[this.activeCueIndex+1].startTime<=this.activeVideoEl.currentTime&&(this.activeCueIndex+=1,this.setTextById(this.activeCueIndex))},this.container=Dt("div","captions-render-container"),this.container.id="video-captions-render-window",this.hide(),le(this.container,{alignSelf:"center",background:"solid",backgroundColor:"#292827",borderRadius:"2px",fontFamily:'"Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontSize:this.fontSize+"px",color:"#F3F2F1",padding:"6px",pointerEvents:"none",position:"absolute",opacity:"0",overflow:"hidden",overflowWrap:"break-word",textAlign:"center",webkitLineClamp:"3",fontSizeAdjust:"100%"}),this.screenCoords=t,this.screenCoordsProvided=null!=t,this.parentName=e,""===this.parentName&&Q.warn(509726802,"CaptionsRenderer constructor: parentName is empty"),this.resizeObserver=new ResizeObserver((e,t)=>{this.onResize()}),this.screenCoordsProvided&&(null===(i=this.resizeObserver)||void 0===i||i.observe(this.screenCoords))}}function _t(e){const t=[];for(const i of e)t.push({language:i.language,label:i.label,id:i.id,cues:[]});return t}function St(e){return e/1e3}function vt(e){const t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60);return[t,i,Math.floor(e-3600*t-60*i)]}function yt(e){const[t,i,n]=vt(e);return t>0?`${t}:${i<10?"0":""}${i}:${i<10?"0":""}${n}`:`${i}:${n<10?"0":""}${n}`}function Tt(e,t){if(isNaN(e)||!isFinite(e))return Q.error(506306976,"PlaybackControlsUtils::formatTimeForScreenReader invalid time."),"";const i=(()=>{const e=t.localizedLabelsStr;return void 0!==t.localizedTimeStr&&null!==t.localizedTimeStr&&Array.isArray(e)&&void 0!==e[0]&&null!==e[0]&&void 0!==e[1]&&null!==e[1]&&void 0!==e[2]&&null!==e[2]&&void 0!==e[3]&&null!==e[3]&&void 0!==e[4]&&null!==e[4]&&void 0!==e[5]&&null!==e[5]})();i||Q.error(507381641,"PlaybackControlsUtils::formatTimeForScreenReader invalid string resources.");const[n,r,a]=vt(e);return i?t.localizedTimeStr.replace("{0}",""+(n>0?n.toFixed(0):"")).replace("{1}",""+(n>0?(l=n,1===l?t.localizedLabelsStr[0]:t.localizedLabelsStr[1]):"")).replace("{2}",""+(r>0?r.toFixed(0):"")).replace("{3}",""+(r>0?(o=r,1===o?t.localizedLabelsStr[2]:t.localizedLabelsStr[3]):"")).replace("{4}",(s=a,0===e?"0":s>0?s.toFixed(0):"")).replace("{5}",(i=>e>0&&0===i?"":1===i?t.localizedLabelsStr[4]:t.localizedLabelsStr[5])(a)):"";var s,o,l}function bt(e){e.classList.add("visible")}function wt(e){e.classList.remove("visible")}function Ct(e){return e.classList.contains("invisible")}function It(e){e.classList.add("invisible")}function Pt(e){e.classList.remove("invisible")}function Et(e){e.classList.toggle("invisible")}function xt(e,t){void 0!==e&&(e.style.display=t)}function kt(e,t){void 0!==t&&e.appendChild(t)}class Mt{onHeightChanged(e){if(void 0===this.volumeSliderContainer)return;const t=e>=165;this.volumeSliderFitsInVideoRect!==t&&(t?this.volumeContainer.appendChild(this.volumeSliderContainer):this.volumeSliderContainer.remove(),this.volumeSliderFitsInVideoRect=t)}onWidthChanged(e){if(0===e)return;let t=0;for(;t<this.breakPoints.length&&!(e>=this.breakPoints[t]);)t++;if(this.breakPointsIdx===t)return;let i=!0,n=!0,r=!0,a=void 0!==this.captionsButton,s=void 0!==this.speedButton,o=void 0!==this.fullscreenButton,l=!1;switch(t){case this.breakPoints.length:case 5:i=!1,n=!1,r=!1,a=!1,s=!1,o=!1,l=!0;break;case 4:i=!1,r=!1,a=!1,s=!1,o=!1,l=!0;break;case 3:i=!1,r=!1;for(let e=0;e<2;e+=1)s?s=!1:o?o=!1:a&&(a=!1);l=!0;break;case 2:i=!1,r=!1,s?s=!1:o?o=!1:a&&(a=!1),l=!0;break;case 1:i=!1,r=!1}this.organize(i,r,n,s,a,o,l),this.breakPointsIdx=t}setCaptionsButton(e){this.captionsButton=e}organize(e,t,i,n,r,a,s){xt(this.progressBar,e?"":"none"),xt(this.timeContainer,t?"":"none"),xt(this.volumeContainer,i?"":"none"),xt(this.speedButton,n?"":"none"),xt(this.captionsButton,r?"":"none"),xt(this.fullscreenButton,a?"":"none"),s?(kt(this.leftControls,this.captionsButton),kt(this.leftControls,this.speedButton),kt(this.leftControls,this.fullscreenButton),this.leftControls.style.width="100%",this.leftControls.style.justifyContent="space-between"):(kt(this.rightControls,this.captionsButton),kt(this.rightControls,this.speedButton),kt(this.rightControls,this.fullscreenButton),this.leftControls.style.width="",this.leftControls.style.justifyContent="")}constructor(e,t,i,n,r,a,s,o,l){this.leftControls=e,this.rightControls=t,this.progressBar=i,this.timeContainer=n,this.volumeContainer=r,this.volumeSliderContainer=a,this.speedButton=s,this.captionsButton=o,this.fullscreenButton=l;let d=0;for(const e of[this.speedButton,this.captionsButton,this.fullscreenButton])void 0!==e&&(d+=32);const c=166+d;this.breakPoints=[c],this.breakPoints.push(c-86);for(const e of[this.speedButton,this.captionsButton,this.fullscreenButton])void 0!==e&&this.breakPoints.push(this.breakPoints[this.breakPoints.length-1]-32)}}class At{constructor(e,t,i){this.presenter=e,this.attendee=t,this.noRole=i}}function Rt(e,t,i){e.style.background=ht()?`linear-gradient(to right, Highlight ${t}%, ButtonText ${t}% ${i}%, ButtonFace ${i}% 100%`:`linear-gradient(to right, #FFFFFF ${t}%, #FFFFFFB2 ${t}% ${i}%, #FFFFFF59 ${i}% 100%`}function Ot(e,t){e.style.background=ht()?`linear-gradient(to right, Highlight ${t}%, ButtonFace ${t}% 100%`:`linear-gradient(to right, #FFFFFF ${t}%, #FFFFFF59 ${t}% 100%`}function Ft(e){return Number(e.replace(/px$/,""))}function Dt(e,t){const i=document.createElement(e);return i.classList.add(t),i}class Lt{get getCaptionSelection(){return this.captionSelection}get getPositioningStrategy(){return this.positioningStrategy}get getBounds(){return this.container.getBoundingClientRect()}isFullScreen(){return this.isFullscreenMode}isVisible(){return"flex"===this.container.style.display}getCaptionsScalingFactor(){return this.captionsScaleFactor}show(){this.container.style.display="flex",this.fixCaptionsOverlap(this.getBounds)}hide(){this.updatePopOuts(),this.container.style.display="none",this.resetCaptionsOverlap()}onKeyDown(e){if(this.nestedTabbingEnabled&&void 0!==e){if("ArrowRight"===e.key&&("none"===this.progressBar.style.display?this.playButton.focus():this.progressBar.focus()),"ArrowLeft"===e.key)for(let e=this.focusableElements.length-1;e>=0;e--){const t=this.focusableElements[e];if((t!==this.captionsButton||this.captionsButtonEnabled)&&(t!==this.volumeButton||"none"!==this.volumeContainer.style.display)&&void 0!==t&&"none"!==t.style.display&&this.container.contains(t)){t.focus();break}}e.stopPropagation()}}setParent(e){try{null===e.shadowRoot?this.root=e.attachShadow({mode:"open"}):this.root=e.shadowRoot,this.root.appendChild(this.container),this.addCssRef(this.root),this.setPlayPauseIcon(!this.videoElement.paused),void 0!==this.captionsRenderer&&(this.captionsRenderer.updateContainer(this.zIndex-1),this.setDefaultCaptionTrack()),void 0!==this.currentTimeContainer&&(this.controlsOrganizer=new Mt(this.leftControls,this.rightControls,this.progressBar,this.currentTimeContainer,this.volumeContainer,this.volumeSliderContainer,this.speedButton,this.captionsButton,this.fullscreenButton),void 0!==this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(e=>{var t,i;for(const n of e){const e=n.contentRect;null===(t=this.controlsOrganizer)||void 0===t||t.onWidthChanged(e.width),null===(i=this.controlsOrganizer)||void 0===i||i.onHeightChanged(e.height)}}),this.container.style.pointerEvents="auto",this.container.style.justifyContent="flex-end",this.resizeObserver.observe(e))}catch(e){Q.error(526485603,"Exception in setParent: "+e.message)}}enableCaptionTrack(e,t,i){void 0!==this.captionsRenderer&&(e<0||void 0===this.captionsMenu||e>=this.captionsMenu.children.length-1||e>this.videoElement.textTracks.length||(this.captionSelection=e,this.captionsMenu.children[e].setAttribute("aria-checked","true"),0===e?(this.hideCaptionsUnderlineIcon(),this.captionsPlaybackInPlayer?t&&this.disableCaptionsInPlayer():this.captionsRenderer.renderCaptionTrack(this.videoElement,this,-1,i)):("hidden"!==this.videoElement.textTracks[e-1].mode&&(this.videoElement.textTracks[e-1].mode="hidden"),this.showCaptionsUnderlineIcon(),this.captionsPlaybackInPlayer?(this.videoElement.textTracks[e-1].mode="showing",this.captionsPlaybackInPlayer=!1):(this.captionsRenderer.renderCaptionTrack(this.videoElement,this,e-1,i),2!==this.positioningStrategy&&3!==this.positioningStrategy||!this.isVisible()||this.fixCaptionsOverlap(this.getBounds)))))}disableCaptionsInPlayer(){this.captionsPlaybackInPlayer=!1;for(let e=0;e<this.videoElement.textTracks.length;e+=1)if("showing"===this.videoElement.textTracks[e].mode)return this.videoElement.textTracks[e].mode="hidden",e}getZIndex(){return this.zIndex}focusPlayButton(){this.isVisible()||this.show(),this.playButton.focus()}toggleCaptionsMenu(e){this.isVisible()||this.show(),this.captionsButtonEnabled?this.toggleCaptionsMenuInternal(e):this.focusPlayButton()}selectCaptionsTrackById(e){if(void 0!==this.textTracks&&null!==this.textTracks)for(let t=0;t<this.textTracks.length;t++)if(this.textTracks[t].id.endsWith(e))return this.updateCaptionTrack(t+1),void(this.isCaptionsMenuVisible()&&this.setCaptionsCheckmarkPosition())}updateCaptionsMenu(){var e,t,i,n,r,a,s,o,l;let d,c=!1,h=0,u=-1;const m=this.captionsButton,f=null!=m&&m===this.root.activeElement;this.container.contains(null!==(e=this.captionsMenu)&&void 0!==e?e:null)&&(c=this.isCaptionsMenuVisible(),h=null!==(i=null===(t=this.captionsMenu)||void 0===t?void 0:t.scrollTop)&&void 0!==i?i:0,d=this.captionSelection>0&&this.captionSelection<=(null===(n=this.textTracks)||void 0===n?void 0:n.length)?null===(r=this.textTracks)||void 0===r?void 0:r[this.captionSelection-1].id:void 0,!f&&null!==this.root.activeElement&&null!==(null===(a=this.captionsMenu)||void 0===a?void 0:a.children)&&(null===(s=this.captionsMenu)||void 0===s?void 0:s.contains(this.root.activeElement))&&(u=Array.from(null===(o=this.captionsMenu)||void 0===o?void 0:o.children).indexOf(this.root.activeElement))),this.captionsButtonEnabled=this.captionsButtonVisible&&this.videoElement.textTracks.length>0,this.createCaptionsMenu(),this.createCaptionsButton(),m.replaceWith(this.captionsButton),null===(l=this.controlsOrganizer)||void 0===l||l.setCaptionsButton(this.captionsButton),this.nestedTabbingEnabled?this.initTabIndex():this.setTabOrder(),this.restoreCaptionsMenuState(c,h,d,u,f)}onProgressSliderInput(){if(this.videoElement.currentTime!==this.progressBar.valueAsNumber){void 0!==this.mediaCallbacks?this.mediaCallbacks.seekMediaCallback(this.progressBar.valueAsNumber):this.videoElement.currentTime=this.progressBar.valueAsNumber,this.progressBar.value=""+this.videoElement.currentTime,this.setProgressForScreenReader();const e=St(this.mediaInfo.trimStartMs);Rt(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100)}}onVolumeSliderInput(){this.videoElement.volume=this.volumeSlider.valueAsNumber/100,this.videoElement.volume>0&&this.videoElement.muted&&(this.videoElement.muted=!1),Ot(this.volumeSlider,this.volumeSlider.valueAsNumber),void 0!==this.mediaCallbacks&&this.mediaCallbacks.volumeChangedCallback()}onVolumeClick(){this.videoElement.muted=!this.videoElement.muted;const e=this.videoElement.muted,t=e?0:this.videoElement.volume;this.setVolumeIcon(t,e),this.volumeSliderEnabled&&(this.volumeSlider.value=""+100*t,Ot(this.volumeSlider,this.volumeSlider.valueAsNumber)),void 0!==this.mediaCallbacks&&this.mediaCallbacks.muteUnmuteCallback()}onPlayPauseClick(){return Object(ee.b)(this,void 0,void 0,(function*(){this.updatePopOuts(),this.videoElement.paused?void 0!==this.mediaCallbacks?this.mediaCallbacks.playMediaCallback():yield this.videoElement.play():void 0!==this.mediaCallbacks?this.mediaCallbacks.pauseMediaCallback():this.videoElement.pause()}))}onPlaybackSpeedClick(){this.setDefaultPlaybackSpeed(),Ct(this.speedMenu)?(this.hideCaptionsMenu("Programmatic"),this.ensureMenuPosition(1),this.speedButton.setAttribute("aria-expanded","true")):this.speedButton.setAttribute("aria-expanded","false"),Et(this.speedMenu),Et(this.speedCheckmark),Ct(this.speedMenu)?2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap():this.fixCaptionsOverlap(this.speedMenu.getBoundingClientRect())}hidePlaybackSpeedMenu(e){this.speedButtonEnabled&&(Ct(this.speedMenu)||(It(this.speedMenu),It(this.speedCheckmark),this.speedButton.setAttribute("aria-expanded","false"),"Programmatic"!==e&&this.speedButton.focus(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap()))}setDefaultPlaybackSpeed(){this.defaultSpeedSet||(this.defaultSpeedSet=!0,this.speedSelection=te.indexOf(this.mediaInfo.playbackSpeed),-1===this.speedSelection?Q.warn(509670626,"PlaybackControls.setDefaultPlaybackSpeed: default video speed not in list of playback speed options"):this.setPlaybackSpeed(this.speedSelection))}setPlaybackSpeedFromElement(){const e=te.indexOf(this.videoElement.playbackRate);e!==this.speedSelection&&this.setPlaybackSpeed(e)}setPlaybackSpeed(e){this.speedMenu.children[this.speedSelection].setAttribute("aria-checked","false"),this.speedSelection=e,this.mediaInfo.playbackSpeed=te[e],this.videoElement.playbackRate=this.mediaInfo.playbackSpeed,this.speedButton.innerText=this.mediaInfo.playbackSpeed.toString()+"x",this.speedMenu.children[this.speedSelection].setAttribute("aria-checked","true"),this.speedCheckmark.style.top=this.speedMenu.children[e].offsetTop+14+"px",It(this.speedMenu),It(this.speedCheckmark),this.speedButton.setAttribute("aria-expanded","false")}onFullscreenClick(){this.isFullscreenMode?this.isFullscreenMode=!1:(this.isFullscreenMode=!0,this.videoElement.requestFullscreen().catch(e=>{Q.warn(509346562,"PlayerControls.onFullscreenClick: unable to fullscreen video - "+e.message),this.isFullscreenMode=!1}))}getMediaInfo(){const e=isNaN(this.mediaControlInfo.trimInfo.trimEndMs)?0:this.mediaControlInfo.trimInfo.trimEndMs,t=isNaN(this.videoElement.duration)?0:1e3*this.videoElement.duration-e;return{trimStartMs:isNaN(this.mediaControlInfo.trimInfo.trimStartMs)?0:this.mediaControlInfo.trimInfo.trimStartMs,trimEndMs:e,max:St(t),autoplay:this.videoElement.autoplay,playbackSpeed:this.videoElement.playbackRate,screenReaderInfo:this.mediaControlInfo.screenReaderInfo}}addCssRef(e){if(null==e||e.styleSheets.length>0)return;const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",this.mediaControlInfo.cssUrl),t.addEventListener("error",()=>{Q.error(508864334,"PlaybackControls.css failed to load")}),e.appendChild(t)}getBufferedSec(){let e=St(this.mediaInfo.trimStartMs);if(this.videoElement.buffered.length>0)try{e=this.videoElement.buffered.end(0)}catch(e){}return e}createControls(){this.setControlFlags(),this.createContainer(!0),this.createTopControls(this.container),this.createBottomControls(this.container),this.speedButtonEnabled&&this.createPlaybackSpeedMenu(this.container),this.videoElement.addEventListener("fullscreenchange",this.onFullScreenChange),this.videoElement.addEventListener("play",this.onPlay),this.videoElement.addEventListener("timeupdate",this.onTimeUpdate),this.videoElement.addEventListener("loadedmetadata",this.refreshControls),this.videoElement.addEventListener("canplay",this.refreshControls),null!==this.videoElement.textTracks&&void 0!==this.videoElement.textTracks&&(this.hideCaptionsInPlayer(),this.videoElement.textTracks.addEventListener("change",this.hideCaptionsInPlayer)),this.nestedTabbingEnabled?this.initTabIndex():this.setTabOrder(),this.setVolumeIcon(this.videoElement.volume,this.videoElement.muted),this.fullscreenButtonEnabled&&this.setFullscreenIcon(this.isFullscreenMode),this.textTracks=_t(this.videoElement.textTracks),this.setDefaultCaptionTrack()}setControlFlags(){if(this.captionsButtonVisible=void 0!==this.mediaControlInfo.captionsEnabled&&this.mediaControlInfo.captionsEnabled,this.captionsButtonVisible&&this.videoElement.textTracks.length>0&&(this.captionsButtonEnabled=!0),void 0!==this.mediaControlInfo.captionsPositioningStrategy&&(this.positioningStrategy=this.mediaControlInfo.captionsPositioningStrategy),Q.info(509163655,JSON.stringify({Description:"PlaybackControls - Captions settings",captionsButtonVisible:this.captionsButtonVisible,captionsButtonEnabled:this.captionsButtonEnabled,textTracks:this.videoElement.textTracks.length,children:this.videoElement.children.length})),this.captionsRenderer=this.mediaControlInfo.captionsRenderer,this.volumeSliderEnabled=void 0===this.mediaControlInfo.volumeSliderEnabled||this.mediaControlInfo.volumeSliderEnabled,this.speedButtonEnabled=void 0!==this.mediaControlInfo.speedEnabled&&this.mediaControlInfo.speedEnabled,this.fullscreenButtonEnabled=void 0!==this.mediaControlInfo.fullscreenEnabled&&this.mediaControlInfo.fullscreenEnabled,this.nestedTabbingEnabled=void 0!==this.mediaControlInfo.nestedTabbingEnabled&&this.mediaControlInfo.nestedTabbingEnabled,!this.volumeSliderEnabled){const e=Pe.getNumber("captionsScaleFactor");this.captionsScaleFactor=void 0===e||0===e?.6:e}}setNextArrowFocus(e,t){let i=e;switch(e){case this.progressBar:i=this.playButton;break;case this.playButton:i=this.volumeButton;break;case this.volumeButton:this.volumeSliderEnabled?(bt(this.volumeSliderContainer),i=this.volumeSlider):this.captionsButtonEnabled?i=this.captionsButton:this.speedButtonEnabled?i=this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;case this.volumeSlider:this.captionsButtonEnabled?i=this.captionsButton:this.speedButtonEnabled?i=this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;case this.captionsButton:this.speedButtonEnabled?i=this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;case this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton)}i!==e?"none"!==i.style.display&&this.container.contains(i)?(t.stopImmediatePropagation(),i.focus()):this.setNextArrowFocus(i,t):t.stopImmediatePropagation()}setPreviousArrowFocus(e,t){let i=e;switch(e){case this.playButton:i=this.progressBar;break;case this.volumeButton:i=this.playButton;break;case this.volumeSlider:i=this.volumeButton;break;case this.captionsButton:this.volumeSliderEnabled?(bt(this.volumeSliderContainer),i=this.volumeSlider):i=this.volumeButton;break;case this.speedButton:this.captionsButtonEnabled?i=this.captionsButton:this.volumeSliderEnabled?(bt(this.volumeSliderContainer),i=this.volumeSlider):i=this.volumeButton;break;case this.fullscreenButton:this.speedButtonEnabled?i=this.speedButton:this.captionsButtonEnabled?i=this.captionsButton:this.volumeSliderEnabled?(bt(this.volumeSliderContainer),i=this.volumeSlider):i=this.volumeButton}i!==e?"none"!==i.style.display&&this.container.contains(i)?(t.stopImmediatePropagation(),i.focus()):this.setPreviousArrowFocus(i,t):t.stopImmediatePropagation()}createControlsPlayPause(){this.createContainer(!1),this.setContainerStyle(),this.container.style.display="none";const e=Dt("div","controls-left");le(e,{left:this.container.style.left}),this.createPlayButton(e),this.container.appendChild(e)}setContainerStyle(){const e=this.mediaControlInfo;le(this.container,{bottom:"0px",width:"100%",height:e.size.y+"px",zIndex:""+e.zIndex,direction:"ltr"})}createContainer(e){const t=Dt("div",e?"control-container":"control-container-no-background");t.id="video-controls-container",this.container=t,this.setContainerStyle(),this.container.style.display="none",void 0!==this.mediaControlInfo.cssPositionOverride&&(t.style.position=this.mediaControlInfo.cssPositionOverride),t.addEventListener("mousedown",()=>{t.classList.add("no-outline")}),t.addEventListener("click",e=>{e.stopPropagation(),1===e.button&&this.updatePopOuts()}),t.addEventListener("keydown",e=>{this.updatePopOuts(e),t.classList.remove("no-outline")})}createTopControls(e){const t=Dt("div","controls-top");this.createProgressBar(t),e.appendChild(t)}createBottomControls(e){const t=Dt("div","controls-bottom");this.createLeftControls(t),this.createRightControls(t),e.appendChild(t)}createLeftControls(e){this.leftControls=Dt("div","controls-left"),this.createPlayButton(this.leftControls),this.createVolumeControls(this.leftControls),this.createTimeControl(this.leftControls),e.appendChild(this.leftControls)}createRightControls(e){this.rightControls=Dt("div","controls-right"),this.createCaptionsControls(this.rightControls),this.speedButtonEnabled&&this.createPlaybackSpeedControl(this.rightControls),this.fullscreenButtonEnabled&&this.createFullscreenControl(this.rightControls),e.appendChild(this.rightControls)}initTabIndex(){if(this.progressBar.tabIndex=-1,this.playButton.tabIndex=-1,this.volumeButton.tabIndex=-1,this.volumeSliderEnabled&&(this.volumeSlider.tabIndex=-1),this.captionsButtonVisible&&(this.captionsButton.tabIndex=-1,this.captionsButtonEnabled))for(const e of this.captionsMenu.children)e.tabIndex=-1;if(this.speedButtonEnabled){this.speedButton.tabIndex=-1;for(const e of this.speedMenu.children)e.tabIndex=-1}this.fullscreenButtonEnabled&&(this.fullscreenButton.tabIndex=-1)}setTabOrder(){this.progressBar.tabIndex=1,this.playButton.tabIndex=2,this.volumeButton.tabIndex=3;let e=this.volumeButton.tabIndex+1;if(this.volumeSliderEnabled&&(this.volumeSlider.tabIndex=e,e+=1),this.captionsButtonVisible&&(this.captionsButton.tabIndex=e,e+=1),this.captionsButtonEnabled)for(const t of this.captionsMenu.children)t instanceof SVGSVGElement||(t.tabIndex=e,e+=1);if(this.speedButtonEnabled){this.speedButton.tabIndex=e,e+=1;for(const t of this.speedMenu.children)t.tabIndex=e,e+=1}this.fullscreenButtonEnabled&&(this.fullscreenButton.tabIndex=e,e+=1)}updatePopOuts(e){(this.nestedTabbingEnabled||void 0===e||"Tab"!==e.key&&"Shift"!==e.key)&&(void 0!==e&&e.getModifierState(e.key)||this.handleCaptionsKeyboardEvent(e)||(this.captionsButtonEnabled&&this.isCaptionsMenuVisible()&&this.hideCaptionsMenu(void 0===e?"Programmatic":"Keyboard"),this.handleSpeedKeyboardEvent(e)||this.speedButtonEnabled&&void 0!==this.speedMenu&&!Ct(this.speedMenu)&&this.hidePlaybackSpeedMenu(void 0===e?"Programmatic":"Keyboard")))}handleCaptionsKeyboardEvent(e){if(!this.captionsButtonEnabled||void 0===e)return!1;if(("j"===e.key||"∆"===e.key)&&e.altKey)return this.toggleCaptionsMenuInternal("Shortcut"),e.stopPropagation(),!0;if(this.isCaptionsMenuVisible())switch(e.key){case"ArrowUp":case"PageUp":e.preventDefault(),this.captionFocus>0&&(this.captionFocus-=1,this.captionsMenu.children[this.captionFocus].focus());break;case"ArrowDown":case"PageDown":e.preventDefault(),this.captionFocus>=0&&this.captionFocus<this.captionsMenu.children.length-2&&(this.captionFocus+=1,this.captionsMenu.children[this.captionFocus].focus());break;case"ArrowLeft":case"ArrowRight":break;case"Escape":this.hideCaptionsMenu("Keyboard");break;default:return!1}else switch(e.key){case"c":"none"===this.container.style.display&&this.show(),this.toggleCaptionsMenuInternal("Shortcut"),this.showOptionFocus(this.captionsMenu.children[this.captionSelection],0);break;default:return!1}return e.stopPropagation(),!0}handleSpeedKeyboardEvent(e){if(!this.speedButtonEnabled||void 0===e)return!1;if(!Ct(this.speedMenu)){switch(e.key){case"ArrowUp":case"PageUp":e.preventDefault(),this.speedFocus>0&&(this.speedFocus-=1,this.speedMenu.children[this.speedFocus].focus());break;case"ArrowDown":case"PageDown":e.preventDefault(),this.speedFocus>=0&&this.speedFocus<this.speedMenu.children.length-2&&(this.speedFocus+=1,this.speedMenu.children[this.speedFocus].focus());break;case"ArrowLeft":case"ArrowRight":break;case"Escape":this.hidePlaybackSpeedMenu("Keyboard");break;default:return!1}return e.stopPropagation(),!0}return!1}getProgressStep(){const e=this.mediaInfo.max-St(this.mediaInfo.trimStartMs);return Math.max(e/100,.01)}createProgressBar(e){const t=document.createElement("input");this.progressBar=t,t.type="range",t.classList.add("progress-slider"),t.min=""+St(this.mediaInfo.trimStartMs),t.max=""+this.mediaInfo.max,t.value=t.min,t.step=""+this.getProgressStep(),t.addEventListener("input",()=>this.onProgressSliderInput()),void 0!==this.mediaInfo.screenReaderInfo&&t.setAttribute(re,this.mediaInfo.screenReaderInfo.progressBarStr),t.addEventListener("focus",()=>this.setProgressForScreenReader()),t.addEventListener("click",()=>this.updatePopOuts()),!0===this.mediaControlInfo.stopPropagateMouseDownOnSlider&&t.addEventListener("mousedown",e=>{e.stopPropagation()}),t.addEventListener("keydown",e=>{this.updatePopOuts(e),this.nestedTabbingEnabled?"ArrowRight"===e.key?(e.preventDefault(),this.setNextArrowFocus(t,e)):"ArrowLeft"===e.key?(e.preventDefault(),e.stopImmediatePropagation()):"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation():"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowUp"!==e.key&&"ArrowRight"!==e.key&&"PageDown"!==e.key&&"PageUp"!==e.key||e.stopPropagation()}),void 0!==this.mediaControlInfo.tooltipMap&&t.addEventListener("mouseenter",()=>{t.title=this.getTooltip("Seek")});const i=St(this.mediaInfo.trimStartMs);Rt(this.progressBar,(this.progressBar.valueAsNumber-i)/(this.mediaInfo.max-i)*100,(this.getBufferedSec()-i)/(this.mediaInfo.max-i)*100),e.appendChild(t)}createPlayButton(e){const t=Dt("button","playpause");this.playButton=t,t.type="button";const i=ot("play-pause-gfxicon");t.appendChild(i),void 0!==this.mediaInfo.screenReaderInfo&&t.setAttribute(re,this.videoElement.paused?this.mediaInfo.screenReaderInfo.playButtonStr:this.mediaInfo.screenReaderInfo.pauseButtonStr),this.videoElement.addEventListener("play",this.togglePlayPauseIcon),this.videoElement.addEventListener("pause",this.togglePlayPauseIcon),this.videoElement.addEventListener("keydown",this.onVideoKeyDown),t.addEventListener("click",()=>{this.onPlayPauseClick().catch(e=>Q.warn(508413404,"PlayerControls.onPlayPauseClick: unable to play/pause video - "+e.message))}),t.addEventListener("keydown",e=>{if(this.updatePopOuts(e),void 0!==e.key)switch(e.key){case"Enter":case" ":e.preventDefault(),e.stopPropagation(),this.onPlayPauseClick().catch(e=>Q.warn(526952129,"PlayerControls.onPlayPauseClick: unable to play/pause video - "+e.message));break;case"ArrowRight":this.nestedTabbingEnabled&&this.setNextArrowFocus(t,e);break;case"ArrowLeft":this.nestedTabbingEnabled&&this.setPreviousArrowFocus(t,e);break;case"ArrowUp":case"ArrowDown":this.nestedTabbingEnabled&&e.stopImmediatePropagation()}}),e.appendChild(t)}setPlayPauseIcon(e){const t=this.playButton.querySelector("#play-gfxicon"),i=this.playButton.querySelector("#pause-gfxicon");null!==t&&null!==i?e?(Pt(i),It(t),void 0!==this.mediaInfo.screenReaderInfo&&this.playButton.setAttribute(re,this.mediaInfo.screenReaderInfo.pauseButtonStr),void 0!==this.mediaControlInfo.tooltipMap&&(this.playButton.title=this.getTooltip("Pause"))):(Pt(t),It(i),void 0!==this.mediaInfo.screenReaderInfo&&this.playButton.setAttribute(re,this.mediaInfo.screenReaderInfo.playButtonStr),void 0!==this.mediaControlInfo.tooltipMap&&(this.playButton.title=this.getTooltip("Play"))):(Q.warn(541882011,"PlayerControls.setPlayPauseIcon: querySelector returned null."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectPlayPauseIcon"))}createVolumeControls(e){this.volumeContainer=Dt("div","volume-container"),this.createVolumeButton(this.volumeContainer),this.volumeSliderEnabled&&(this.createVolumeSlider(this.volumeContainer),this.volumeContainer.addEventListener("focusin",()=>{bt(this.volumeSliderContainer)}),this.volumeContainer.addEventListener("mouseleave",()=>{wt(this.volumeSliderContainer)})),this.volumeContainer.addEventListener("click",()=>this.updatePopOuts()),this.volumeContainer.addEventListener("keydown",e=>this.updatePopOuts(e)),e.appendChild(this.volumeContainer)}createVolumeButton(e){const t=Dt("button","volume");this.volumeButton=t,t.type="button";const i=ot("volume-gfxicon");t.appendChild(i),this.videoElement.addEventListener("volumechange",this.onVideoVolumeChange),void 0!==this.mediaInfo.screenReaderInfo&&(t.setAttribute(re,this.videoElement.muted?this.mediaInfo.screenReaderInfo.unmuteButtonStr:this.mediaInfo.screenReaderInfo.muteButtonStr),t.addEventListener("keydown",e=>{if(this.updatePopOuts(e),void 0!==e.key)switch(e.key){case"Enter":case" ":e.preventDefault(),e.stopPropagation(),this.onVolumeClick()}})),t.addEventListener("click",()=>{this.updatePopOuts(),this.onVolumeClick()}),t.addEventListener("keydown",e=>{this.updatePopOuts(e),this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(t,e):"ArrowRight"===e.key?this.setNextArrowFocus(t,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),this.volumeSliderEnabled&&t.addEventListener("mouseenter",()=>{bt(this.volumeSliderContainer)}),e.appendChild(t)}createVolumeSlider(e){this.volumeSlider=Dt("input","volume-slider"),this.volumeSlider.type="range",this.volumeSlider.min="0",this.volumeSlider.max="100",this.volumeSlider.value=this.videoElement.muted?"0":""+100*this.videoElement.volume,void 0!==this.mediaInfo.screenReaderInfo&&this.volumeSlider.setAttribute(re,this.mediaInfo.screenReaderInfo.volumeSliderStr),Ot(this.volumeSlider,this.volumeSlider.valueAsNumber),this.volumeSlider.addEventListener("input",()=>this.onVolumeSliderInput()),!0===this.mediaControlInfo.stopPropagateMouseDownOnSlider&&this.volumeSlider.addEventListener("mousedown",e=>{e.stopPropagation()}),this.volumeSlider.addEventListener("click",()=>this.updatePopOuts()),this.volumeSlider.addEventListener("keydown",e=>{this.updatePopOuts(e),this.nestedTabbingEnabled?"ArrowLeft"===e.key?(e.preventDefault(),this.setPreviousArrowFocus(this.volumeSlider,e)):"ArrowRight"===e.key?(e.preventDefault(),this.setNextArrowFocus(this.volumeSlider,e)):"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation():"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowUp"!==e.key&&"ArrowRight"!==e.key&&"PageDown"!==e.key&&"PageUp"!==e.key||e.stopPropagation()}),this.volumeSlider.addEventListener("focusout",e=>{wt(this.volumeSlider),e.stopPropagation()}),this.volumeSlider.style.display="block",this.volumeSlider.style.margin="auto",this.volumeSlider.style.width="75%",this.volumeSliderContainer=Dt("div","volume-slider-container"),this.volumeSliderContainer.appendChild(this.volumeSlider),e.style.position="relative",e.appendChild(this.volumeSliderContainer),Ot(this.volumeSlider,this.volumeSlider.valueAsNumber)}setVolumeIcon(e,t){const i=this.volumeButton.querySelector("#volume-low-gfxicon"),n=this.volumeButton.querySelector("#volume-medium-gfxicon"),r=this.volumeButton.querySelector("#volume-high-gfxicon"),a=this.volumeButton.querySelector("#volume-muted-gfxicon");if(null===i||null===n||null===r||null===a)return Q.warn(541882012,"PlayerControls.setVolumeIcon: querySelector returned null, unable to set volume button icon"),void(void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectVolumeIndicator"));It(a),It(i),It(n),It(r),void 0!==this.mediaControlInfo.tooltipMap&&(this.volumeButton.title=t?this.getTooltip("Unmute"):this.getTooltip("Mute")),Pt(t?a:e<.33?i:e<.67?n:r),void 0!==this.mediaInfo.screenReaderInfo&&this.volumeButton.setAttribute(re,t?this.mediaInfo.screenReaderInfo.unmuteButtonStr:this.mediaInfo.screenReaderInfo.muteButtonStr)}getTextTracks(){return this.textTracks}findMatchingCaptionTrack(e,t){if(null===e&&null===t)return-1;if(0===(null==e?void 0:e.length)&&0===(null==t?void 0:t.length))return 0;const i=this.getTextTracks();let n=-1,r=-1;for(let a=0;a<i.length;a+=1){let s=i[a].language.toLowerCase();"unknown"===s&&(s="");const o=0!==(null==e?void 0:e.length)&&s===(null==e?void 0:e.toLowerCase()),l=0!==(null==t?void 0:t.length)&&i[a].label.toLowerCase()===(null==t?void 0:t.toLowerCase());if(r<0&&l&&(r=a+1),o){if(l)return a+1;n=a+1}n<0&&(ct(i[a].language,e)||ct(e,i[a].language))&&(n=a+1)}return n>0?n:r>0?r:-1}getLastSelectedCaptionTrack(){return[mt("CaptionsLang"),mt("CaptionsLabel")]}setLastSelectedCaptionTrack(e){const t=this.getTextTracks().length;if(e<0||e>t)return;let i="",n="";if(e>0){const t=this.getTextTracks()[e-1];i="unknown"===t.language.toLowerCase()?"":t.language,n=t.label}const r=new Date((new Date).setFullYear((new Date).getFullYear()+1));ut("CaptionsLang",i,r),ut("CaptionsLabel",n,r)}setDefaultCaptionTrack(){if(!this.captionsButtonEnabled)return;if(this.getTextTracks().length<=0)return;if(this.captionSelection>0)return void this.enableCaptionTrack(this.captionSelection,!1,!1);let e=null,t=null;[e,t]=this.getLastSelectedCaptionTrack();const i=this.findMatchingCaptionTrack(e,t);if(i>=0)this.enableCaptionTrack(i,!1,!1);else{if(void 0!==this.captionsRenderer&&""!==this.captionsRenderer.getDefaultLang)for(let e=0;e<this.getTextTracks().length;e+=1)if(this.getTextTracks()[e].language.toLowerCase()===this.captionsRenderer.getDefaultLang)return void this.enableCaptionTrack(e+1,!1,!1);null===e&&null===t?this.captionsMenu.children[0].setAttribute("aria-checked","true"):this.enableCaptionTrack(1,!1,!1)}}disableCaptionTrack(e){var t;e<0||(this.captionsMenu.children[e].setAttribute("aria-checked","false"),0!==e&&(void 0!==this.captionsRenderer?null===(t=this.captionsRenderer)||void 0===t||t.stopCaptionTrack():(this.videoElement.textTracks[e-1].mode="hidden",this.captionsPlaybackInPlayer=!1)))}updateCaptionTrack(e){Q.info(512550666,`PlaybackControls - Captions: Updating selected caption track new selection: ${e}, previous selection: ${this.captionSelection}`),this.setLastSelectedCaptionTrack(e),e!==this.captionSelection&&(this.disableCaptionTrack(this.captionSelection),this.enableCaptionTrack(e,!1,!0))}showCaptionsUnderlineIcon(){Pt(this.captionsButton.children[1]),this.captionsButton.children[1].style.position="",It(this.captionsButton.children[0]),this.captionsButton.children[0].style.position="absolute"}hideCaptionsUnderlineIcon(){Pt(this.captionsButton.children[0]),this.captionsButton.children[0].style.position="",It(this.captionsButton.children[1]),this.captionsButton.children[1].style.position="absolute"}isCaptionsMenuVisible(){return!Ct(this.captionsMenu)}setCaptionsCheckmarkPosition(){const e=14*(1===this.captionsScaleFactor?1:this.captionsScaleFactor/2);this.captionsCheckmark.style.top=this.captionsMenu.children[this.captionSelection].offsetTop+e+"px",this.captionsCheckmark.style.display="block"}showCaptionsMenu(e){try{if(!this.captionsButtonEnabled)return;if(this.setDefaultCaptionTrack(),Q.info(512521174,JSON.stringify({Description:"PlaybackControls - Showing captions menu",Source:e})),this.hidePlaybackSpeedMenu("Programmatic"),this.ensureMenuPosition(0),Pt(this.captionsMenu),this.setCaptionsCheckmarkPosition(),this.captionsButton.setAttribute("aria-expanded","true"),!this.volumeSliderEnabled&&0===this.captionsMenu.offsetWidth){const e="75px",t="50px";Q.info(508867395,JSON.stringify({Description:"PlaybackControls - Captions menu has no dimensions, setting minimums",PreviousWidth:this.captionsMenu.style.width,PreviousHeight:this.captionsMenu.style.height,NewWidth:e,NewHeight:t})),this.captionsMenu.style.width=e,this.captionsMenu.style.height=t}this.captionsMenuShown||(this.captionsMenuShown=!0,this.logCaptionsMenuInfo()),"Keyboard"===e||"Shortcut"===e?this.showOptionFocus(this.captionsMenu.children[this.captionSelection],0):"Click"===e&&this.captionsMenu.children[this.captionSelection].focus(),this.fixCaptionsOverlap(this.captionsMenu.getBoundingClientRect())}catch(e){throw Q.error(509130720,"PlaybackControls.showCaptionsMenu - Exception caught: "+e.message),e}}logCaptionsMenuInfo(){const e=this.captionsMenu.getBoundingClientRect(),t=this.container.getBoundingClientRect();Q.info(508942554,JSON.stringify({MenuClassList:this.captionsMenu.classList,MenuDisplay:this.captionsMenu.style.display,MenuHidden:this.captionsMenu.hidden,MenuOpacity:this.captionsMenu.style.opacity,MenuVisibility:this.captionsMenu.style.visibility,MenuTop:e.top,MenuBottom:e.bottom,MenuLeft:e.left,MenuRight:e.right,MenuWidth:this.captionsMenu.style.width,MenuHeight:this.captionsMenu.style.height,MenuOffsetHeight:this.captionsMenu.offsetHeight,MenuOffsetTop:this.captionsMenu.offsetTop,MenuOffsetLeft:this.captionsMenu.offsetLeft,MenuOffsetWidth:this.captionsMenu.offsetWidth,ContainerTop:t.top,ContainerBottom:t.bottom,ContainerLeft:t.left,ContainerRight:t.right}));for(const e of this.captionsMenu.children)this.logOptionInfo("Showing menu - option info",e)}fixCaptionsOverlap(e){0!==this.captionSelection&&void 0!==this.captionsRenderer&&0!==this.positioningStrategy&&this.captionsRenderer.boxIntersects(e)&&(1===this.positioningStrategy&&(this.captionsRenderer.setHorizontalPosition(this.getMenuBoxRect()),this.captionsRenderer.setVerticalPosition(!1)),2===this.positioningStrategy&&this.transferCaptionsToPlayer(),3===this.positioningStrategy&&this.captionsRenderer.reduceOpacity())}getMenuBoxRect(){return void 0!==this.captionsMenu&&this.isCaptionsMenuVisible()?this.captionsMenu.getBoundingClientRect():void 0===this.speedMenu||Ct(this.speedMenu)?void 0:this.speedMenu.getBoundingClientRect()}resetCaptionsOverlap(){void 0!==this.captionsRenderer&&0!==this.positioningStrategy&&(2===this.positioningStrategy&&this.transferCaptionsToRenderer(),0!==this.captionSelection&&(1===this.positioningStrategy&&(this.captionsRenderer.resetHorizontalPosition(),this.captionsRenderer.setVerticalPosition(!0)),3===this.positioningStrategy&&this.captionsRenderer.resetOpacity()))}hideCaptionsMenu(e){It(this.captionsMenu),this.captionsButtonEnabled&&(Q.info(512521173,JSON.stringify({Description:"PlaybackControls - Hiding captions menu",Source:e})),this.captionsCheckmark.style.display="none",this.captionsButton.setAttribute("aria-expanded","false"),"Programmatic"!==e&&this.captionsButton.focus(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap())}toggleCaptionsMenuInternal(e){if(!this.captionsButtonEnabled)return void Q.info(509162691,JSON.stringify({Description:"PlaybackControls - Captions button is not enabled, skipping menu toggle",Source:e}));this.isVisible()||this.show();const t=Date.now()-this.lastToggleTime;t<=this.captionsMinUIDelay?Q.info(509162690,JSON.stringify({Description:"PlaybackControls - Suppressing duplicate captions menu toggle",Source:e,LastClickDelay:t,MinDelay:this.captionsMinUIDelay})):(Q.info(512521172,JSON.stringify({Description:"PlaybackControls - Toggling captions menu",Source:e})),this.lastToggleTime=Date.now(),this.isCaptionsMenuVisible()?this.hideCaptionsMenu(e):this.showCaptionsMenu(e))}showOptionFocus(e,t){switch(e.style.backgroundColor="#000000",e.style.background="solid",e.focus(),e.scrollIntoView({behavior:"smooth",block:"nearest"}),t){case 0:this.captionFocus=parseInt(e.id,10);break;case 1:this.speedFocus=parseInt(e.id,10)}}hideOptionFocus(e){e.style.background="none"}createCaptionsControls(e){this.captionsButtonVisible&&void 0===this.captionsButton&&(Q.info(512550661,"PlaybackControls - Captions: Creating captions menu"),this.createCaptionsMenu(),this.createCaptionsButton(),e.appendChild(this.captionsButton),this.hideCaptionsMenu("Programmatic"))}createCaptionsMenu(){var e;const t=Dt("div","closed-captions-menu");if(this.container.contains(null!==(e=this.captionsMenu)&&void 0!==e?e:null)?this.captionsMenu.replaceWith(t):this.container.appendChild(t),this.captionsMenu=t,this.videoElement.textTracks.length<=0)return void t.setAttribute("aria-hidden","true");this.captionsMenu.setAttribute(re,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsMenuStr:"Closed captions menu"),this.captionsMenu.setAttribute("role","menu"),le(this.captionsMenu,{display:"block",opacity:".8",position:"absolute",right:"0px",borderRadius:"2px"});const i=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsMenuOffOptionStr:"Off";if(this.captionsMenu.appendChild(this.createOptionElement(0,"",i)),this.captionsButtonEnabled)for(let e=0;e<this.videoElement.textTracks.length;e+=1){const t=this.videoElement.textTracks[e];Q.info(512550665,`PlaybackControls - Captions: Adding track index: ${e}, language: ${t.language}`);const i=dt(t.language);let n;i===t.language&&Q.info(512550664,"PlaybackControls - Captions: Unknown language code: "+t.language),n="Unknown"!==i?""!==t.label&&t.label.toLowerCase()!==i.toLowerCase()?`${t.label} - ${i}`:i:""!==t.label?t.label:"Track "+(e+1),this.captionsMenu.addEventListener("focusout",e=>{e.stopImmediatePropagation()}),this.captionsMenu.addEventListener("wheel",e=>{e.preventDefault();const t=Date.now();this.lastScrollTime+35<t&&(this.captionsMenu.scrollTop+=e.deltaY>0?Math.min(e.deltaY,35):Math.max(e.deltaY,-35),this.lastScrollTime=t)});const r=this.createOptionElement(e+1,t.language,n);this.captionsMenu.appendChild(r),this.logOptionInfo("Finished adding option to menu",r)}this.createMenuCheckmark(0),this.captionsMenu.appendChild(this.captionsCheckmark)}logOptionInfo(e,t){Q.info(508905682,JSON.stringify({Description:"PlaybackControls - Captions: "+e,Index:t.id,Font:t.style.font,FontFamily:t.style.fontFamily,FontSize:t.style.fontSize,FillOpacity:t.style.fillOpacity,Opacity:t.style.opacity,OptionOffsetHeight:t.offsetHeight,OptionOffsetTop:t.offsetTop,OptionOffsetLeft:t.offsetLeft,OptionOffsetWidth:t.offsetWidth}))}createOptionElement(e,t,i){Q.info(512550663,"PlaybackControls - Captions: Creating option index: "+e);const n=Dt("div","closed-captions-menu-item");return t.length>0&&(n.lang=t),n.innerText=i,n.textContent=i,n.id=""+e,n.setAttribute(re,i),n.setAttribute("role","menuitemradio"),n.setAttribute("aria-checked","false"),this.setOptionStyle(n),n.addEventListener("click",t=>{0===t.button&&(this.logOptionActivation(n,"Click"),this.updateCaptionTrack(e),this.hideCaptionsMenu("Click"),t.stopImmediatePropagation())}),n.addEventListener("touchend",()=>{this.logOptionActivation(n,"Touch")}),n.addEventListener("keydown",t=>{"Spacebar"!==t.key&&" "!==t.key&&"Enter"!==t.key||(this.logOptionActivation(n,"Keyboard"),this.updateCaptionTrack(e),this.hideCaptionsMenu("Keyboard"),this.captionsButton.focus(),t.preventDefault(),t.stopImmediatePropagation())}),n.addEventListener("mouseenter",()=>{this.showOptionFocus(n,0)}),n.addEventListener("focusin",()=>{this.showOptionFocus(n,0)}),n.addEventListener("mouseleave",()=>{this.hideOptionFocus(n)}),n.addEventListener("focusout",()=>{this.hideOptionFocus(n)}),n}logOptionActivation(e,t){Q.info(509162655,JSON.stringify({Description:"PlaybackControls - Captions option activation",Source:t,Index:e.id,InnerText:e.innerText,TextContent:e.textContent}))}setOptionStyle(e){const t=8*this.captionsScaleFactor+"px";le(e,{paddingTop:t,paddingBottom:t,paddingLeft:32*this.captionsScaleFactor+"px",paddingRight:40*this.captionsScaleFactor+"px",color:"#F3F2F1",fontFamily:'"Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontSize:14*this.captionsScaleFactor+"px",textAlign:"left",fillOpacity:".8",background:"none"})}createCaptionsButton(){Q.info(512550662,"PlaybackControls - Captions: Creating captions button");const e=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsButtonStr:"Closed captions",t=Dt("button","closed-captions-button");this.captionsButton=t,t.type="button",t.name=e,t.setAttribute(re,e),t.setAttribute("aria-haspopup","menu"),t.disabled=!this.captionsButtonEnabled,this.addCaptionbuttonIcons(),this.captionsButtonEnabled?(t.addEventListener("click",e=>{this.logCaptionsButtonEvent("Click"),this.toggleCaptionsMenuInternal("Click"),e.stopImmediatePropagation()}),t.addEventListener("touchend",()=>{this.logCaptionsButtonEvent("Touch")}),t.addEventListener("keydown",e=>{"Spacebar"===e.key||" "===e.key||"Enter"===e.key?(this.logCaptionsButtonEvent("Keyboard"),this.toggleCaptionsMenuInternal("Keyboard"),e.preventDefault(),e.stopImmediatePropagation()):this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(this.captionsButton,e):"ArrowRight"===e.key?this.setNextArrowFocus(this.captionsButton,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),void 0!==this.mediaControlInfo.tooltipMap&&t.addEventListener("mouseenter",()=>{t.title=this.getTooltip("Captions")})):void 0!==this.mediaControlInfo.tooltipMap&&(t.title=this.getTooltip("Captions disabled"))}logCaptionsButtonEvent(e){Q.info(509163653,JSON.stringify({Description:"PlaybackControls - Captions button event received",Source:e}))}addCaptionbuttonIcons(){const e=ot("captions-gfxicon");this.captionsButtonEnabled||(e.style.opacity=".40"),this.captionsButton.appendChild(e);const t=ot("captions-active-gfxicon");It(t),this.captionsButton.appendChild(t)}ensureMenuPosition(e){const t=this.playButton.offsetParent;switch(e){case 0:this.ensureMenuDivPosition(t,this.captionsMenu);break;case 1:this.ensureMenuDivPosition(t,this.speedMenu)}}ensureMenuDivPosition(e,t){var i,n,r,a,s;const o=null!==(i=null==e?void 0:e.offsetHeight)&&void 0!==i?i:0;le(t,{bottom:o-2+"px",width:"auto",height:"auto",maxWidth:((null===(r=null===(n=this.root)||void 0===n?void 0:n.host)||void 0===r?void 0:r.offsetWidth)>0?this.root.host.offsetWidth:this.videoElement.offsetWidth)-4+"px",maxHeight:((null===(s=null===(a=this.root)||void 0===a?void 0:a.host)||void 0===s?void 0:s.offsetHeight)>0?this.root.host.offsetHeight:this.videoElement.offsetHeight)-o-2+"px",overflowWrap:"break-word"})}createMenuCheckmark(e){const t=ot("checkmark-gfxicon");switch(e){case 0:this.captionsCheckmark=t,this.captionsCheckmark.style.scale=""+this.captionsScaleFactor;break;case 1:this.speedCheckmark=t,this.speedCheckmark.style.display="block"}le(t,{position:"absolute",left:10*(1===this.captionsScaleFactor?1:this.captionsScaleFactor/2.5)+"px",zIndex:"5"})}createTimeControl(e){this.currentTime=document.createElement("span"),this.currentTime.classList.add("text-formatting"),this.currentTime.style.marginLeft="4px",this.currentTime.innerText="0:00";const t=document.createElement("span");t.classList.add("text-formatting"),t.textContent=" / ",this.endTime=document.createElement("span"),this.endTime.classList.add("text-formatting"),this.endTime.id="video-end-time",this.updateTimeControl(),this.currentTime.style.alignSelf="center",t.style.alignSelf="center",this.endTime.style.alignSelf="center",this.shouldHideTimeControls()&&(this.currentTime.style.display="none",t.style.display="none",this.endTime.style.display="none"),this.currentTimeContainer=Dt("div","current-time-container"),this.currentTime.style.marginLeft="",this.shouldHideTimeControls()&&(this.currentTimeContainer.style.display="none"),this.currentTimeContainer.appendChild(this.currentTime),this.currentTimeContainer.appendChild(t),this.currentTimeContainer.appendChild(this.endTime),e.appendChild(this.currentTimeContainer)}updateTimeControl(){let e;try{e=new Date(1e3*this.mediaInfo.max).toISOString(),this.mediaInfo.max>0&&(e=new Date(1e3*this.mediaInfo.max-this.mediaInfo.trimStartMs).toISOString())}catch(t){e="1970-01-01T00:00:00.000Z",Q.warn(506307151,"PlaybackControls.updateTime exception: "+t.message)}const t="00"===e.substring(11,13)?e.substring(14,19):e.substring(11,19);this.endTime.innerText=t,this.formattedEndTime=t}transferCaptionsToPlayer(){this.captionsPlaybackInPlayer||(this.captionsPlaybackInPlayer=!0,this.captionSelection<1||void 0===this.videoElement.textTracks[this.captionSelection-1]||(this.videoElement.textTracks[this.captionSelection-1].mode="showing",this.disableCaptionTrack(this.captionSelection)))}transferCaptionsToRenderer(){if(!this.captionsPlaybackInPlayer)return;const e=this.disableCaptionsInPlayer();void 0!==e&&this.enableCaptionTrack(e+1,!1,!1)}createPlaybackSpeedControl(e){const t=Dt("button","speed");this.speedButton=t,t.type="button",t.classList.add("text-formatting"),t.innerText=this.mediaInfo.playbackSpeed.toString()+"x",t.setAttribute(re,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.speedButtonStr:"Playback speed"),t.setAttribute("aria-haspopup","menu"),t.setAttribute("aria-expanded","false"),t.addEventListener("click",e=>{this.onPlaybackSpeedClick(),e.stopImmediatePropagation(),Ct(this.speedMenu)||this.speedMenu.children[this.speedSelection].focus()}),t.addEventListener("keydown",e=>{"Spacebar"===e.key||" "===e.key||"Enter"===e.key?(this.onPlaybackSpeedClick(),e.preventDefault(),e.stopImmediatePropagation(),Ct(this.speedMenu)||this.showOptionFocus(this.speedMenu.children[this.speedSelection],1)):this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(this.speedButton,e):"ArrowRight"===e.key?this.setNextArrowFocus(this.speedButton,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),e.appendChild(this.speedButton)}createPlaybackSpeedMenu(e){this.speedMenu=Dt("div","speed-menu-div"),this.speedMenu.classList.add("text-formatting","invisible"),this.speedMenu.style.display="block",this.speedMenu.setAttribute("role","menu");for(let e=0;e<te.length;e+=1){const t=Dt("div","speed-menu-option");t.classList.add("text-formatting");let i="";i=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.speedMenuOptionStr.replace("{0}",te[e].toString()):te[e].toString()+"x",t.innerText=i,t.id=""+e,t.setAttribute(re,i),t.setAttribute("role","menuitemradio"),t.setAttribute("aria-checked","false"),t.addEventListener("click",t=>{this.setPlaybackSpeed(e),t.stopImmediatePropagation(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap(),this.speedButton.focus()}),t.addEventListener("keydown",t=>{"Spacebar"!==t.key&&" "!==t.key&&"Enter"!==t.key||(this.setPlaybackSpeed(e),this.speedButton.focus(),t.preventDefault(),t.stopImmediatePropagation())}),t.addEventListener("mouseenter",()=>{this.showOptionFocus(t,1)}),t.addEventListener("focusin",()=>{this.showOptionFocus(t,1)}),t.addEventListener("mouseleave",()=>{this.hideOptionFocus(t)}),t.addEventListener("focusout",e=>{this.hideOptionFocus(t),e.stopImmediatePropagation()}),this.speedMenu.appendChild(t)}this.speedMenu.addEventListener("focusout",e=>{e.stopImmediatePropagation()}),this.speedMenu.addEventListener("wheel",e=>{e.preventDefault();const t=Date.now();this.lastScrollTime+35<t&&(this.speedMenu.scrollTop+=e.deltaY>0?Math.min(e.deltaY,35):Math.max(e.deltaY,-35),this.lastScrollTime=t)}),e.appendChild(this.speedMenu),this.createMenuCheckmark(1),It(this.speedCheckmark),this.speedMenu.appendChild(this.speedCheckmark)}createFullscreenControl(e){this.fullscreenButton=Dt("button","fullscreen"),this.fullscreenButton.type="button",this.fullscreenButton.setAttribute(re,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.fullScreenButtonStr:"Full screen");const t=ot("fullscreen-gfxicon");this.fullscreenButton.appendChild(t),this.fullscreenButton.addEventListener("click",()=>this.onFullscreenClick()),this.fullscreenButton.addEventListener("keydown",e=>{"Spacebar"===e.key||" "===e.key||"Enter"===e.key?this.onFullscreenClick():this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(this.fullscreenButton,e):"ArrowRight"!==e.key&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),e.appendChild(this.fullscreenButton)}setFullscreenIcon(e){const t=this.fullscreenButton.querySelector("#fullscreen-enter-gfxicon"),i=this.fullscreenButton.querySelector("#fullscreen-exit-gfxicon");null!==t&&null!==i?e?(Pt(i),It(t)):(Pt(t),It(i)):(Q.warn(509346561,"PlayerControls.setFullscreenIcon: querySelector returned null."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectFullscreenIcon"))}getTooltip(e){if(void 0===this.mediaControlInfo.tooltipMap)return e.toString();const t=this.mediaControlInfo.tooltipMap.get(e);if(void 0===t||void 0===this.mediaCallbacks)return e.toString();const i=this.mediaCallbacks.isPresenterCallback();return void 0===i?t.noRole:i?t.presenter:t.attendee}setProgressForScreenReader(){if(void 0!==this.mediaInfo.screenReaderInfo){const e=Tt(this.videoElement.currentTime,this.mediaInfo.screenReaderInfo),t=Tt(this.videoElement.duration,this.mediaInfo.screenReaderInfo),i=this.mediaInfo.screenReaderInfo.progressStr.replace("{0}",e).replace("{1}",t);this.progressBar.setAttribute("aria-valuetext",i)}}shouldHideTimeControls(){if(void 0===this.mediaControlInfo.controlHidingEnabled||!this.mediaControlInfo.controlHidingEnabled||void 0===this.mediaControlInfo.widthThresholdForHidingControls)return!1;let e=!1;return this.volumeSliderEnabled&&(e=this.mediaControlInfo.size.x<this.mediaControlInfo.widthThresholdForHidingControls-(this.speedButtonEnabled?0:36)-(this.captionsButtonVisible?0:36)),e}restoreCaptionsMenuState(e,t,i,n,r){var a,s;if(this.captionSelection=0,this.captionFocus=0,r&&(this.captionsButtonEnabled?this.captionsButton.focus():this.playButton.focus()),void 0!==this.videoElement&&null!==this.videoElement&&(this.textTracks=_t(this.videoElement.textTracks)),this.container.contains(null!==(a=this.captionsMenu)&&void 0!==a?a:null))if(void 0!==i&&this.selectCaptionsTrackById(i),null===(s=this.captionsRenderer)||void 0===s||s.selectCaptionsTrack(this.captionSelection-1),e&&this.captionsButtonEnabled){if(this.showCaptionsMenu("Programmatic"),this.captionsMenu.scrollTop=t,!r&&n>=0){const e=Math.max(Math.min(n,this.captionsMenu.children.length-2),0);this.showOptionFocus(this.captionsMenu.children[e],0)}}else this.hideCaptionsMenu("Programmatic")}constructor(e,t,i){this.captionsMinUIDelay=250,this.captionsButtonVisible=!1,this.captionsButtonEnabled=!1,this.captionsPlaybackInPlayer=!1,this.captionsMenuShown=!1,this.captionsScaleFactor=1,this.positioningStrategy=0,this.volumeSliderEnabled=!0,this.speedButtonEnabled=!1,this.fullscreenButtonEnabled=!1,this.nestedTabbingEnabled=!1,this.textTracks=[],this.captionSelection=0,this.captionFocus=0,this.speedSelection=0,this.speedFocus=0,this.lastToggleTime=0,this.defaultSpeedSet=!1,this.isFullscreenMode=!1,this.lastScrollTime=Date.now(),this.refreshControls=()=>{this.mediaInfo=this.getMediaInfo(),this.progressBar.max=""+this.mediaInfo.max,this.setProgressForScreenReader();const e=St(this.mediaInfo.trimStartMs);Rt(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100),this.updateTimeControl()},this.refreshControlsEx=(e,t,i,n)=>{this.mediaControlInfo.position=e,this.mediaControlInfo.cssPositionOverride=t,this.mediaControlInfo.size=i,this.mediaControlInfo.trimInfo=n,this.setContainerStyle(),void 0!==this.captionsMenu&&this.ensureMenuPosition(0),void 0!==this.speedMenu&&this.ensureMenuPosition(1),this.refreshControls()},this.dispose=()=>{void 0!==this.videoElement&&null!==this.videoElement&&(this.videoElement.removeEventListener("fullscreenchange",this.onFullScreenChange),this.videoElement.removeEventListener("play",this.onPlay),this.videoElement.removeEventListener("timeupdate",this.onTimeUpdate),this.videoElement.removeEventListener("loadedmetadata",this.refreshControls),this.videoElement.removeEventListener("canplay",this.refreshControls),null!==this.videoElement.textTracks&&void 0!==this.videoElement.textTracks&&this.videoElement.textTracks.removeEventListener("change",this.hideCaptionsInPlayer),this.videoElement.removeEventListener("play",this.togglePlayPauseIcon),this.videoElement.removeEventListener("pause",this.togglePlayPauseIcon),this.videoElement.removeEventListener("keydown",this.onVideoKeyDown),this.videoElement.removeEventListener("volumechange",this.onVideoVolumeChange)),void 0!==this.container&&null!==this.container&&this.container.remove(),void 0!==this.resizeObserver&&this.resizeObserver.disconnect()},this.togglePlayPauseIcon=()=>{this.setPlayPauseIcon(!this.videoElement.paused)},this.onVideoKeyDown=e=>{this.handleCaptionsKeyboardEvent(e)},this.onVideoVolumeChange=()=>{const e=this.videoElement.muted?0:this.videoElement.volume;this.setVolumeIcon(e,this.videoElement.muted||0===this.videoElement.volume),this.volumeSliderEnabled&&(this.volumeSlider.value=""+100*e,Ot(this.volumeSlider,this.volumeSlider.valueAsNumber))},this.onTimeUpdate=()=>{isFinite(this.mediaInfo.max)||(this.mediaInfo=this.getMediaInfo(),this.updateTimeControl()),this.videoElement.currentTime<=this.mediaInfo.max?this.mediaInfo.trimStartMs>0?this.currentTime.innerText=yt(Math.max(0,this.videoElement.currentTime-St(this.mediaInfo.trimStartMs))):this.currentTime.innerText=yt(this.videoElement.currentTime):this.mediaInfo.max>0&&this.currentTime.innerText!==this.formattedEndTime&&(this.currentTime.innerText=this.formattedEndTime);const e=St(this.mediaInfo.trimStartMs);this.progressBar.value=""+this.videoElement.currentTime,Rt(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100)},this.onPlay=()=>{this.setDefaultCaptionTrack()},this.hideCaptionsInPlayer=()=>{if(!this.captionsPlaybackInPlayer)for(const e of this.videoElement.textTracks)"showing"===e.mode&&(e.mode="hidden")},this.onFullScreenChange=()=>{if(!this.captionsButtonEnabled||void 0!==this.mediaControlInfo.transferCaptionsFullScreen&&!this.mediaControlInfo.transferCaptionsFullScreen)return;const e=document.fullscreenElement===this.videoElement;this.videoElement.controls=e,e?this.transferCaptionsToPlayer():(this.transferCaptionsToRenderer(),this.setPlaybackSpeedFromElement())},this.videoElement=e,this.mediaControlInfo=t,this.mediaCallbacks=i,this.zIndex=t.zIndex,this.mediaInfo=this.getMediaInfo(),void 0!==t.playPauseOnly&&t.playPauseOnly?(Q.info(509109908,"PlaybackControls: Creating only play and pause controls"),this.createControlsPlayPause()):this.createControls(),this.focusableElements=[this.progressBar,this.playButton,this.volumeButton,this.volumeSlider,this.captionsButton,this.speedButton,this.fullscreenButton],!isNaN(this.videoElement.duration)&&isFinite(this.videoElement.duration)||(Q.warn(541882010,"PlaybackControls: Video duration not set."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectProgressAndTiming"))}}function Bt(e){if(!e)return 0;let t=0;for(let i=0;i<e.length;i++)t=Math.imul(31,t)+e.charCodeAt(i)|0;return t}var Nt,Vt,Wt,Ut,zt,Ht,Gt,jt,$t,qt,Zt,Jt,Xt,Yt,Kt=i(105);class Qt{constructor(){this.totalBufferingTime=0,this.totalPlayingTime=0}}class ei{static useLoadedMetadataAsInteractivityEvent(e){return Je(e)}static logEvent(e,t){g.a.sendTraceTag(542770816,_.a.msoulscat_Wac_PptSession,S.a.Info,`LocalMediaPlaybackPerf event tracking: Received ${e} event on media: ${t}`)}addPlayerEventListeners(e){this.player.addEventListener("loadstart",()=>{ei.logEvent("loadstart",this.summary.mediaName),this.isFirstLoadStart&&(this.isFirstLoadStart=!1,this.summary.timeToLoadStartMs=Date.now()-this.creationTime,this.summary.timeToLoadedMetadataMs=void 0,this.summary.timeToInteractivityMs=void 0,this.summary.timeToCanPlayThroughMs=void 0,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0)}),this.player.addEventListener("loadedmetadata",()=>{ei.logEvent("loadedmetadata",this.summary.mediaName),this.isFirstLoadedMetadata&&(this.isFirstLoadedMetadata=!1,this.summary.timeToLoadedMetadataMs=Date.now()-this.creationTime,ei.useLoadedMetadataAsInteractivityEvent(e)?this.summary.timeToInteractivityMs=this.summary.timeToLoadedMetadataMs:this.summary.timeToInteractivityMs=void 0,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0,this.summary.durationMs=Math.round(1e3*this.player.duration),"Video"!==this.summary.mediaType&&"Audio"===this.summary.mediaType||(this.summary.sourceVideoWidth=this.player.videoWidth,this.summary.sourceVideoHeight=this.player.videoHeight,this.summary.width=Math.round(this.player.width*this.pixelScale.x),this.summary.height=Math.round(this.player.height*this.pixelScale.y)))}),this.player.addEventListener("canplay",()=>{ei.logEvent("canplay",this.summary.mediaName),this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(ei.useLoadedMetadataAsInteractivityEvent(e)||(this.summary.timeToInteractivityMs=Date.now()-this.creationTime,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0)),this.isFirstCanPlay&&(this.isFirstCanPlay=!1,this.isFirstCanPlayThrough||g.a.sendTraceTag(540137693,_.a.msoulscat_Wac_PptSession,S.a.Error,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: "+this.summary.mediaName))}),this.player.addEventListener("canplaythrough",()=>{ei.logEvent("canplaythrough",this.summary.mediaName),this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(ei.useLoadedMetadataAsInteractivityEvent(e)||(this.summary.timeToInteractivityMs=Date.now()-this.creationTime,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0)),this.isFirstCanPlayThrough&&(this.isFirstCanPlayThrough=!1,this.summary.timeToCanPlayThroughMs=Date.now()-this.creationTime,this.isFirstCanPlay&&g.a.sendTraceTag(540137694,_.a.msoulscat_Wac_PptSession,S.a.Error,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: "+this.summary.mediaName))}),this.player.addEventListener("play",()=>{this.checkPlayerNotReady("play"),ei.logEvent("play",this.summary.mediaName),this.lastPlayTime=Date.now(),this.isFirstPlay&&(this.isFirstPlay=!1,this.summary.timeToPlayMs=this.lastPlayTime-this.creationTime,this.summary.timeToPlayingMs=void 0,this.isFirstCanPlay&&g.a.sendTraceTag(537773265,_.a.msoulscat_Wac_PptSession,S.a.Error,"No 'canplay' event was triggered before triggering the 'play' event on media: "+this.summary.mediaName))}),this.player.addEventListener("playing",()=>{ei.logEvent("playing",this.summary.mediaName),this.isPlaying=!0,this.setTimeSincePlay(),this.isFirstPlaying&&void 0!==this.lastPlayTime&&(this.isFirstPlaying=!1,this.summary.timeToPlayingMs=Date.now()-this.lastPlayTime,this.isFirstPlay&&g.a.sendTraceTag(537773266,_.a.msoulscat_Wac_PptSession,S.a.Error,"No 'play' event was triggered before triggering the 'playing' event on media: "+this.summary.mediaName)),this.lastPlayTime=void 0,this.calculateBufferingTime(),void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}),this.player.addEventListener("pause",()=>{this.checkPlayerNotReady("pause"),ei.logEvent("pause",this.summary.mediaName),this.isPlaying=!1,this.isStalled=!1,this.setTimeSincePlay(),this.lastPlayTime=void 0,this.calculatePlayingTime()}),this.player.addEventListener("ended",()=>{this.checkPlayerNotReady("ended"),ei.logEvent("ended",this.summary.mediaName),this.summary.wasPlayedUntilEnd=!0}),this.player.addEventListener("seeking",()=>{ei.logEvent("seeking",this.summary.mediaName),this.setTimeSinceSeek(),this.lastSeekTime=Date.now()}),this.player.addEventListener("seeked",()=>{this.checkPlayerNotReady("seeked"),ei.logEvent("seeked",this.summary.mediaName),this.setTimeSinceSeek(),this.lastSeekTime=void 0}),this.player.addEventListener("volumechange",()=>{this.checkPlayerNotReady("volumechange"),ei.logEvent("volumechange",this.summary.mediaName)}),this.player.addEventListener("progress",()=>{ei.logEvent("progress",this.summary.mediaName),this.isStalled=!1}),this.player.addEventListener("stalled",()=>{ei.logEvent("stalled",this.summary.mediaName),this.isPlaying&&(this.isStalled=!0,void 0===this.summary.numberOfStalls?this.summary.numberOfStalls=1:this.summary.numberOfStalls+=1),this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}),this.player.addEventListener("error",()=>{ei.logEvent("error",this.summary.mediaName);const e=null!==this.player.error?this.player.error.code:-1;void 0===this.summary.errorCode&&(this.summary.errorCode=e),this.isPlaying&&(this.playError=e)}),this.player.addEventListener("abort",()=>{ei.logEvent("abort",this.summary.mediaName),this.calculatePlayingTime(),this.calculateBufferingTime()}),this.player.addEventListener("emptied",()=>{ei.logEvent("emptied",this.summary.mediaName)}),this.player.addEventListener("loadeddata",()=>{ei.logEvent("loadeddata",this.summary.mediaName)}),this.player.addEventListener("waiting",()=>{ei.logEvent("waiting",this.summary.mediaName),this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}),this.player.addEventListener("suspend",()=>{ei.logEvent("suspend",this.summary.mediaName)})}isAutoPlay(){return!!this.summary.isAutoPlay}onSourceSet(e){this.cleanup(),this.summary.timeToSourceSet=Date.now()-this.creationTime;const t=new URL(e);e.includes("MediaDownloadHandler")&&(this.summary.isMediaSnap=!0);const i=t.searchParams.get("mediaName");null!==i&&(this.summary.mediaName=i);const n=t.searchParams.get("ext");if(null!==n)this.summary.mediaExtension=n;else{const e=t.searchParams.get("mediaId");if(null!==e){const t=/^.+\.([^\.]+)\.media$/.exec(e);null!==t&&2===t.length&&(this.summary.mediaExtension=t[1])}}const r=t.searchParams.get("mediaLength");null!==r&&(this.summary.mediaLength=parseInt(r,10));const a=t.searchParams.get("retries");null!==a&&(this.summary.retriesLeft=parseInt(a,10));const s=t.searchParams.get("requestGuid");null!==s&&(this.summary.requestGuid=s),this.summary.isEnabledTranscodingFlight=null===t.searchParams.get("disableTranscode");const o=t.searchParams.get("docId");null!==o&&G.ChangeGate.isChangeGateEnabled("SVM.LogDocIdHash")&&(this.summary.docIdHash=Bt(o).toString()),g.a.sendTraceTag(507004126,_.a.msoulscat_Wac_PptSession,S.a.Info,"SourceSet "+JSON.stringify(this.summary))}setInClickSequence(){this.summary.isInClickSequence=!0,g.a.sendTraceTag(507004125,_.a.msoulscat_Wac_PptSession,S.a.Info,"Video playback started through animation.")}setMediaQuality(e){void 0===this.summary.initialQuality&&(this.summary.initialQuality=e),this.summary.finalQuality=e,this.summary.initialQuality!==Me.Raw&&e===Me.Raw&&void 0===this.summary.fallbackTime&&(this.summary.fallbackTime=Date.now(),this.summary.fallbackRetryCount=this.summary.retriesLeft)}setHls(e){e?this.summary.isHls=!0:this.summary.isHls&&void 0===this.summary.hlsFallbackTime&&(this.summary.hlsFallbackTime=Date.now(),this.summary.hlsFallbackRetryCount=this.summary.retriesLeft)}setHlsAndTranscoding(e,t){e&&t&&void 0===this.summary.hlsTranscodingTime?this.summary.hlsTranscodingTime=Date.now():e&&!t&&void 0===this.summary.hlsRawTime?this.summary.hlsRawTime=Date.now():e||t||void 0!==this.summary.progressiveRawTime||(this.summary.progressiveRawTime=Date.now())}setPlayRequestTime(){void 0===this.summary.playRequestTime&&(this.summary.playRequestTime=Date.now())}setPlaybackControlsFlag(){this.summary.isUsingPlaybackControls=!0}onNavigatingTo(){this.wasNavigatingFrom&&(this.wasNavigatingFrom=!1)}setWhenClickedOn(){this.summary.isWhenClickedOn=!0,g.a.sendTraceTag(507004124,_.a.msoulscat_Wac_PptSession,S.a.Info,"Video playback started by clicking on custom play button.")}addSlideEventListeners(e){e.on("navigatedTo",()=>{this.isOnSlide?g.a.sendTraceTag(556048642,_.a.msoulscat_Wac_PptSession,S.a.Error,"Already on this slide"):(this.isOnSlide=!0,this.summary.timeToNavigatedTo=Date.now()-this.creationTime,this.summary.timeToNavigatingFrom=void 0,this.summary.isInClickSequence=void 0,this.summary.isWhenClickedOn=void 0,ei.sendNavigatedTo&&(ei.sendNavigatedTo=!1,g.a.sendTraceTag(559453667,_.a.msoulscat_Wac_PptSession,S.a.Info,"Navigated to a slide with a local "+this.summary.mediaType)))}),e.on("navigatingFrom",()=>{this.isOnSlide?(this.isOnSlide=!1,this.summary.timeToNavigatingFrom=Date.now()-this.creationTime,void 0===this.summary.numberOfStalls&&void 0===this.summary.errorCode&&!this.isStalled&&void 0===this.playError&&void 0===this.lastPlayTime&&void 0===this.timeSincePlay&&void 0===this.lastSeekTime&&void 0===this.timeSinceSeek&&this.isFirstLoadStart&&this.isFirstLoadedMetadata&&this.isFirstCanPlay&&this.isFirstPlay&&this.isFirstPlaying||(void 0!==this.summary.timeToPlayingMs&&(this.summary.lastVolume=Math.round(100*this.player.volume),this.summary.lastIsMuted=this.player.muted),F.a.readBooleanOrDefault("forceSvg",!1)&&(this.summary.isSVG=!0),this.calculatePlayingTime(),this.calculateBufferingTime(),void 0===this.summary.navigationCount&&(this.summary.navigationCount=0),g.a.sendTraceTag(570750435,_.a.msoulscat_Wac_PptSession,S.a.Info,"NavigatingFrom "+JSON.stringify(this.summary)),this.summary.hlsBandwidthEstimate=void 0,this.summary.hlsTranscodingTime=void 0,this.summary.hlsRawTime=void 0,this.summary.progressiveRawTime=void 0,this.summary.playRequestTime=void 0,this.summary.wasVetoLogged=void 0,this.summary.navigationCount+=1,this.cleanup(),this.playError=void 0,this.wasNavigatingFrom=!0)):g.a.sendTraceTag(556048643,_.a.msoulscat_Wac_PptSession,S.a.Error,"Not on this slide yet")})}cleanup(){this.summary.wasPlayedUntilEnd=void 0,this.summary.numberOfStalls=void 0,this.summary.errorCode=void 0,this.isPlaying=!1,this.isStalled=!1,this.lastPlayTime=void 0,this.timeSincePlay=void 0,this.lastSeekTime=void 0,this.timeSinceSeek=void 0,this.isFirstLoadStart=!0,this.isFirstLoadedMetadata=!0,this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.isFirstPlaying=!0,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.summary.totalBufferingTime=0,this.summary.totalPlayingTime=0}setTimeSincePlay(){if(void 0===this.lastPlayTime)return 0;const e=Date.now()-this.lastPlayTime;return e<this.minTimeAfterAction?0:(this.timeSincePlay=void 0!==this.timeSincePlay?Math.max(this.timeSincePlay,e):e,e)}setTimeSinceSeek(){if(void 0===this.lastSeekTime)return 0;const e=Date.now()-this.lastSeekTime;return e<this.minTimeAfterAction?0:(this.timeSinceSeek=void 0!==this.timeSinceSeek?Math.max(this.timeSinceSeek,e):e,e)}checkPlayerNotReady(e){void 0===this.summary.timeToInteractivityMs&&g.a.sendTraceTag(529332098,_.a.msoulscat_Wac_PptSession,S.a.Info,`${this.summary.mediaType} ${this.summary.mediaName} emitted ${e} event before being interactive.`)}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;this.summary.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;this.summary.totalPlayingTime+=e,this.lastPlayingTime=void 0}}setHlsBandwidthEstimate(e){this.summary.hlsBandwidthEstimate=e}vetoLogged(){this.summary.wasVetoLogged=!0}constructor(e,t,i,n,r,a,s,o,l,d,c,h,u){this.isOnSlide=!1,this.isPlaying=!1,this.isStalled=!1,this.isFirstLoadStart=!0,this.isFirstLoadedMetadata=!0,this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.isFirstPlaying=!0,this.wasNavigatingFrom=!1,this.player=e,this.creationTime=Date.now(),this.minTimeAfterAction=F.a.readNumberOrDefault("minTimeAfterActionForVideoVeto",5e3),this.summary=new Qt,this.summary.uiHostType=ke[n];const m={hlsJsFirst:F.a.readBooleanOrDefault("initializeHLSJsFirst",!1),iOSPreload:F.a.readBooleanOrDefault("iOSHlsPreload",!0),cleanupHlsJs:F.a.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0),cleanupNativeHls:F.a.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)};this.summary.flights=JSON.stringify(m),r&&(this.summary.mediaType=a===Kt.a.Video?"Video":"Audio",r.autoPlay&&(this.summary.isAutoPlay=!0),r.fullscreen&&(this.summary.fullscreen=!0),r.hideWhenStopped&&(this.summary.hideWhenStopped=!0),r.narration&&(this.summary.isNarration=!0),r.playAcrossSlides>0&&(this.summary.playAcrossSlides=r.playAcrossSlides),r.trimStartMs>0&&(this.summary.trimStartMs=r.trimStartMs),r.trimEndMs>0&&(this.summary.trimEndMs=r.trimEndMs),r.volume>0&&(this.summary.volume=r.volume),void 0!==r.repeat&&0!==r.repeat&&(this.summary.repeat=r.repeat),r.contentType&&(this.summary.contentType=r.contentType)),d&&(this.summary.mediaType="GIF",this.summary.isGif=!0,this.summary.isAutoPlay=!0,this.summary.repeat=-1),this.summary.slideNumber=s,this.summary.startFromTime=o,this.summary.initTime=l,this.summary.initialRetryCount=c,h&&(this.summary.isPrefetch=!0),this.pixelScale=t,this.addPlayerEventListeners(n),this.addSlideEventListeners(i),u&&(this.summary.teamsCallId=u)}}ei.sendNavigatedTo=!0,function(e){e.MediaPlaybackFailed="MediaPlaybackFailed",e.MediaPlaybackInterrupted="MediaPlaybackInterrupted",e.MediaPerfSlow="MediaPerfSlow"}(Nt||(Nt={})),function(e){e.VideoNotPlayedWithSeek="VideoNotPlayedWithSeek",e.VideoNotPlayed="VideoNotPlayed",e.VideoNotPlayedWithSeekOnLastRetry="VideoNotPlayedWithSeekOnLastRetry",e.VideoNotPlayedOnLastRetry="VideoNotPlayedOnLastRetry"}(Vt||(Vt={})),function(e){e.VideoNotPlayedWithSeekSubsequent="VideoNotPlayedWithSeekSubsequent",e.VideoNotPlayedSubsequent="VideoNotPlayedSubsequent",e.VideoNotResumed="VideoNotResumed",e.VideoErrorAfterPlaying="VideoErrorAfterPlaying",e.VideoNotSeeked="VideoNotSeeked"}(Wt||(Wt={})),function(e){e.VideoStalledExcessively="VideoStalledExcessively",e.VideoNotPlayedWaiting="VideoNotPlayedWaiting",e.VideoPlayedSlow="VideoPlayedSlow",e.VideoResumedSlow="VideoResumedSlow",e.VideoSeekedSlow="VideoSeekedSlow"}(Ut||(Ut={}));class ti{onSourceSet(e,t,i,n,r,a){this.requestGuid=e,this.retriesLeft=t,this.mediaLength=i,this.isTranscoding=n,this.isHls=r,this.navigationCount=a,this.isSeekInProgress=!1,this.isReady=!1,this.numberOfStalls=0,g.a.sendTraceTag(528599056,_.a.msoulscat_Wac_PptSession,S.a.Info,"Setting source "+this.state)}onNavigatingTo(){g.a.sendTraceTag(528599057,_.a.msoulscat_Wac_PptSession,S.a.Info,"Navigating to "+this.state),this.isPlayOrPausePending=void 0,this.pendingSeekTime=void 0,this.clearTimeoutHelper(),this.playTime=void 0,this.seekTime=void 0,this.clearStallTracking()}onNavigatingFrom(){if(g.a.sendTraceTag(528599058,_.a.msoulscat_Wac_PptSession,S.a.Info,"Navigating from "+this.state),this.clearTimeoutHelper(),void 0!==this.playTime&&void 0!==this.seekTime){const e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.notPlayingTime&&this.onQualityImpactError(this.wasPlaying?Nt.MediaPlaybackInterrupted:Nt.MediaPlaybackFailed,this.wasPlaying?Wt.VideoNotPlayedWithSeekSubsequent:Vt.VideoNotPlayedWithSeek,`${this.mediaType} is not playing with seek ${this.wasPlaying?"during subsequent playback ":""}after: ${e}`),this.playTime=void 0,this.seekTime=void 0}if(void 0!==this.playTime){const e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.notPlayingTime&&this.onQualityImpactError(this.wasPlaying?Nt.MediaPlaybackInterrupted:Nt.MediaPlaybackFailed,this.wasPlaying?Wt.VideoNotPlayedSubsequent:Vt.VideoNotPlayed,`${this.mediaType} is not playing ${this.wasPlaying?"during subsequent playback ":""}after: ${e}`),this.playTime=void 0}if(void 0!==this.seekTime){const e=this.timeElapsedWhileVisibleFrom(this.seekTime);e>=this.notSeekedTime&&this.onQualityImpactError(Nt.MediaPlaybackInterrupted,Wt.VideoNotSeeked,`${this.mediaType} is not seeked after: ${e}`),this.seekTime=void 0}if(void 0!==this.stallTime){const e=this.timeElapsedWhileVisibleFrom(this.stallTime);if(G.ChangeGate.isChangeGateEnabled("SVM.FixVideoNotResumedVeto")){const t=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t},i=e=>{if(void 0!==e)return Math.abs(e)},n=t(this.player.currentTime,this.playerTimeAtStall),r=i(t(n,e/1e3));g.a.sendTraceTag(507003906,_.a.msoulscat_Wac_PptSession,S.a.Info,`Stall tracking. timeSinceStall: ${e}, playerTimeElapsedSinceStallSec: ${n}, diffPlayedTimeStallTimeSec: ${r}, ${this.state}`),e>=this.notResumedTime&&(!r||r>this.seekPrecision)&&this.onQualityImpactError(Nt.MediaPlaybackInterrupted,Wt.VideoNotResumed,`${this.mediaType} is not resumed after: ${e}`)}else e>=this.notResumedTime&&this.onQualityImpactError(Nt.MediaPlaybackInterrupted,Wt.VideoNotResumed,`${this.mediaType} is not resumed after: ${e}`);this.clearStallTracking()}0!==this.numberOfStalls&&(this.numberOfStalls>=this.minStallCount&&this.onQualityImpactError(Nt.MediaPerfSlow,Ut.VideoStalledExcessively,`${this.mediaType} was stalled excessively: ${this.numberOfStalls}`),this.numberOfStalls=0),this.shouldCleanupLocalPlayerOnNavigatedFrom()&&(this.isSeekInProgress=!1,this.isReady=!1,this.firstPlayingTime=void 0)}shouldCleanupLocalPlayerOnNavigatedFrom(){return!(!F.a.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)&&this.localMediaPlaybackPerf&&this.localMediaPlaybackPerf.isAutoPlay())}playOrPause(e){e&&void 0===this.m_maxWaitingMediaNotPlayingTimeout&&(this.m_maxWaitingMediaNotPlayingTimeout=window.setTimeout(()=>{this.mediaPlayingWaitingTimeout()},this.mediaMaxNotPlayingTime)),e&&void 0===this.playTime&&(this.playTime=Date.now()),this.isReady?this.doPlayOrPause(e):(e?g.a.sendTraceTag(528599059,_.a.msoulscat_Wac_PptSession,S.a.Info,"Delaying playing "+this.state):g.a.sendTraceTag(528599060,_.a.msoulscat_Wac_PptSession,S.a.Info,"Delaying pausing "+this.state),this.isPlayOrPausePending=e)}seek(e){void 0===this.seekTime&&(this.seekTime=Date.now()),this.isReady?this.doSeek(e):(g.a.sendTraceTag(528599061,_.a.msoulscat_Wac_PptSession,S.a.Info,`Delaying seeking ${this.state} to: ${e}`),this.pendingSeekTime=e)}setHls(e){this.isHls=e}setIsTranscoding(e){this.isTranscoding=e}isSeeking(){return!!this.isSeekInProgress&&!(this.player.paused&&this.player.currentTime<=this.seekPrecision)}onLoadedMetadata(){g.a.sendTraceTag(528599062,_.a.msoulscat_Wac_PptSession,S.a.Info,"LoadedMetadata event "+this.state),this.isReadyOnLoadedMetadata&&this.onReady()}onCanPlay(){g.a.sendTraceTag(528599063,_.a.msoulscat_Wac_PptSession,S.a.Info,"CanPlay event "+this.state),this.onReady()}onPlay(){g.a.sendTraceTag(528599064,_.a.msoulscat_Wac_PptSession,S.a.Info,"Play event "+this.state),this.isReady=!1}mediaPlayingWaitingTimeout(){if(void 0!==this.playTime){const e=Date.now()-this.playTime;this.onQualityImpactError(Nt.MediaPerfSlow,Ut.VideoNotPlayedWaiting,`${this.mediaType} is still not playing after: ${e}`)}}clearTimeoutHelper(){window.clearTimeout(this.m_maxWaitingMediaNotPlayingTimeout),this.m_maxWaitingMediaNotPlayingTimeout=void 0,window.clearTimeout(this.mediaNotResumedAfterErrorTimeout),this.mediaNotResumedAfterErrorTimeout=void 0}onPlaying(){if(g.a.sendTraceTag(528599065,_.a.msoulscat_Wac_PptSession,S.a.Info,"Playing event "+this.state),this.clearTimeoutHelper(),this.firstPlayingTime=Date.now(),void 0!==this.playTime){const e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.slowToPlayingTime&&this.onQualityImpactError(Nt.MediaPerfSlow,Ut.VideoPlayedSlow,`${this.mediaType} was playing after: ${e}`),this.playTime=void 0}if(void 0!==this.stallTime){const e=this.timeElapsedWhileVisibleFrom(this.stallTime);e>=this.slowToResumedTime&&this.onQualityImpactError(Nt.MediaPerfSlow,Ut.VideoResumedSlow,`${this.mediaType} was resumed after: ${e}`),this.clearStallTracking()}this.onReady()}onSeeking(){g.a.sendTraceTag(528599104,_.a.msoulscat_Wac_PptSession,S.a.Info,"Seeking event "+this.state),this.isSeekInProgress=!0,this.isReady=!1}onSeeked(){if(g.a.sendTraceTag(528599105,_.a.msoulscat_Wac_PptSession,S.a.Info,"Seeked event "+this.state),void 0!==this.seekTime){const e=Date.now()-this.seekTime;e>=this.slowToSeekedTime&&this.onQualityImpactError(Nt.MediaPerfSlow,Ut.VideoSeekedSlow,`${this.mediaType} was seeked after: ${e}`),this.seekTime=void 0}this.isSeekInProgress=!1,this.onReady()}onPause(){g.a.sendTraceTag(528599106,_.a.msoulscat_Wac_PptSession,S.a.Info,"Pause event "+this.state),this.clearTimeoutHelper(),this.playTime=void 0,this.clearStallTracking(),this.onReady()}onEnded(){g.a.sendTraceTag(528599107,_.a.msoulscat_Wac_PptSession,S.a.Info,"Ended event "+this.state),this.clearStallTracking()}setVetoTimerForPlaybackInterruptionAfterError(e){window.clearTimeout(this.mediaNotResumedAfterErrorTimeout),this.mediaNotResumedAfterErrorTimeout=window.setTimeout((e,t)=>{this.onQualityImpactError(Nt.MediaPlaybackInterrupted,Wt.VideoErrorAfterPlaying,`${this.mediaType} error, not resumed after playing with error code ${e} after: ${this.timeElapsedWhileVisibleFrom(t)}`)},this.notPlayingAfterErrorTime,e,this.firstPlayingTime)}getLastErrorCode(){return null!==this.player.error?this.player.error.code:-1}onError(){const e=this.getLastErrorCode();if(g.a.sendTraceTag(528599108,_.a.msoulscat_Wac_PptSession,S.a.Info,`Error event ${this.state} errorCode: ${e}`),0===this.retriesLeft&&!this.wasPlaying){if(void 0!==this.playTime&&void 0!==this.seekTime){const t=Date.now()-this.playTime;t>=this.notPlayingTime&&this.onQualityImpactError(Nt.MediaPlaybackFailed,Vt.VideoNotPlayedWithSeekOnLastRetry,`${this.mediaType} is not playing with seek on last retry with error code ${e} after: ${t}`),this.playTime=void 0,this.seekTime=void 0}if(void 0!==this.playTime){const t=Date.now()-this.playTime;t>=this.notPlayingTime&&this.onQualityImpactError(Nt.MediaPlaybackFailed,Vt.VideoNotPlayedOnLastRetry,`${this.mediaType} is not playing on last retry with error code ${e} after: ${t}`),this.playTime=void 0}}void 0!==this.firstPlayingTime&&(g.a.sendTraceTag(507003905,_.a.msoulscat_Wac_PptSession,S.a.Error,`${this.mediaType} playback interrupted after playing with error code: ${e} for mediaName: ${this.mediaName}`),void 0===this.mediaNotResumedAfterErrorTimeout&&this.setVetoTimerForPlaybackInterruptionAfterError(e)),this.isSeekInProgress=!1,this.isReady=!1}get wasPlaying(){return void 0!==this.firstPlayingTime}doPlayOrPause(e){if(this.isPlayOrPausePending=void 0,g.a.sendTraceTag(507003904,_.a.msoulscat_Wac_PptSession,S.a.Info,`LocalMediaPlaybackController.doPlayOrPause: isPlay: ${e}, this.player.paused: ${this.player.paused}, this.state: ${this.state}`),e===this.player.paused){let t=!1;return e?(g.a.sendTraceTag(528599109,_.a.msoulscat_Wac_PptSession,S.a.Info,"Playing "+this.state),this.player.play().catch(e=>{g.a.sendTraceTag(528599110,_.a.msoulscat_Wac_PptSession,S.a.Error,`Play promise failed ${this.state} error: ${e.name} muted: ${this.player.muted} isTeams: ${this.isTeams} isTeamsWeb: ${this.isTeamsWeb} message: ${e.message}`),"NotAllowedError"===e.name&&!this.player.muted&&this.isTeamsWeb?(this.player.muted=!0,this.doPlayOrPause(!0)):(g.a.sendTraceTag(507003875,_.a.msoulscat_Wac_PptSession,S.a.Error,`Play promise failed unexepectedly ${this.state} error: ${e.name} muted: ${this.player.muted} isTeams: ${this.isTeams} isTeamsWeb: ${this.isTeamsWeb} message: ${e.message} isCloseToEndOfMediaResource: ${this.isCloseToEndOfMediaResource()}`),G.ChangeGate.isChangeGateEnabled("SVM.ShowPlayButtonOnNotAllowedError")&&"NotAllowedError"===e.name&&"Video"===this.mediaType&&(t=!0,this.isReady=!0,this.clearTimeoutHelper(),this.playTime=void 0,this.onNotAllowedError()))})):(g.a.sendTraceTag(528599111,_.a.msoulscat_Wac_PptSession,S.a.Info,"Pausing "+this.state),this.clearTimeoutHelper(),this.playTime=void 0,this.clearStallTracking(),this.player.pause()),void(t||(this.isReady=!1))}e?g.a.sendTraceTag(527241492,_.a.msoulscat_Wac_PptSession,S.a.Info,"Skipping playing "+this.state):g.a.sendTraceTag(527241493,_.a.msoulscat_Wac_PptSession,S.a.Info,"Skipping pausing "+this.state),this.clearTimeoutHelper(),this.playTime=void 0}doSeek(e){return this.pendingSeekTime=void 0,e<0||e>this.player.duration?(g.a.sendTraceTag(526984739,_.a.msoulscat_Wac_PptSession,S.a.Info,`Skipping out-of-bounds seeking ${this.state} to: ${e}`),this.seekTime=void 0,!1):Math.abs(e-this.player.currentTime)>this.seekPrecision?(g.a.sendTraceTag(528599112,_.a.msoulscat_Wac_PptSession,S.a.Info,`Seeking ${this.state} to: ${e}`),this.clearStallTracking(),this.isSeekInProgress=!0,this.isReady=!1,this.player.currentTime=e,!0):(g.a.sendTraceTag(527241494,_.a.msoulscat_Wac_PptSession,S.a.Info,`Skipping seeking ${this.state} to: ${e}`),this.seekTime=void 0,!1)}onStalled(){void 0!==this.playTime||void 0!==this.seekTime||void 0!==this.stallTime||this.isSeekInProgress||this.player.paused?g.a.sendTraceTag(507003874,_.a.msoulscat_Wac_PptSession,S.a.Info,"Skipped stalled event "+this.state):(this.stallTime=Date.now(),this.playerTimeAtStall=this.player.currentTime,this.numberOfStalls+=1,g.a.sendTraceTag(527193424,_.a.msoulscat_Wac_PptSession,S.a.Info,"Stalled event "+this.state))}onReady(){this.isReady=!0,void 0!==this.pendingSeekTime&&this.doSeek(this.pendingSeekTime)||void 0===this.isPlayOrPausePending||this.isSeekInProgress||this.doPlayOrPause(this.isPlayOrPausePending)}get state(){return`mediaName: ${this.mediaName}\n      requestGuid: ${this.requestGuid}\n      networkState: ${this.player.networkState}\n      readyState: ${this.player.readyState}\n      isReadyOnLoadedMetadata: ${this.isReadyOnLoadedMetadata}\n      currentTime: ${this.player.currentTime}\n      visibility: ${document.visibilityState}`}onQualityImpactError(e,t,i){if(g.a.sendTraceTag(507003873,_.a.msoulscat_Wac_PptSession,S.a.Info,`${i} ${this.state}`),!this.isMobileDevice||"hidden"!==document.visibilityState){this.localMediaPlaybackPerf&&this.localMediaPlaybackPerf.vetoLogged();const n={impactType:e,errorName:t,details:i,mediaName:this.mediaName,mediaType:this.mediaType,requestGuid:this.requestGuid,networkState:this.player.networkState,readyState:this.player.readyState,isReadyOnLoadedMetadata:this.isReadyOnLoadedMetadata,currentTime:this.player.currentTime,paused:this.player.paused,muted:this.player.muted,mediaLength:this.mediaLength,visibility:document.visibilityState,retriesLeft:this.retriesLeft,isTeams:this.isTeams,isTeamsWeb:this.isTeamsWeb,isTranscoding:this.isTranscoding,isHls:this.isHls,navigationCount:this.navigationCount,hlsErrorTypes:Array.from(this.hlsErrorTypes),hlsErrorDetails:Array.from(this.hlsErrorDetails),hlsBandwidthEstimate:this.hlsBandwidthEstimate};this.onQualityImpactErrorCallback(n),F.a.readBooleanOrDefault("alertMediaVeto",!1)&&window.alert(`MediaQualityImpactInfo: ${e}-${t}, ${i} ${this.state}`),this.clearHlsErrors()}}isCloseToEndOfMediaResource(){return!isNaN(this.player.duration)&&this.player.currentTime>this.player.duration-this.seekPrecision}addHlsError(e,t){this.hlsErrorTypes.add(e),this.hlsErrorDetails.add(t)}clearHlsErrors(){this.hlsErrorTypes.clear(),this.hlsErrorDetails.clear()}setHlsBandwidthEstimate(e){this.hlsBandwidthEstimate=e}clearStallTracking(){this.stallTime=void 0,this.playerTimeAtStall=void 0}onVisibilityChange(){"visible"===document.visibilityState?this.lastBecameVisibleTime=Date.now():"hidden"===document.visibilityState&&(this.lastHideTime=Date.now())}timeElapsedWhileVisibleFrom(e){const t=Date.now();if(void 0===this.lastBecameVisibleTime&&void 0===this.lastHideTime)return t-e;const i=void 0===this.lastHideTime?0:Math.max(0,this.lastHideTime-e);return void 0!==this.lastBecameVisibleTime?i+(void 0!==this.lastHideTime&&this.lastHideTime>this.lastBecameVisibleTime?0:t-Math.max(this.lastBecameVisibleTime,e)):i}setLocalMediaPlaybackPerf(e){this.localMediaPlaybackPerf=e}constructor(e,t,i,n,r,a,s,o,l){this.isSeekInProgress=!1,this.isReady=!1,this.numberOfStalls=0,this.hlsErrorTypes=new Set,this.hlsErrorDetails=new Set,this.player=e,this.mediaName=t,this.mediaType=i===Kt.a.Video?"Video":"Audio",this.isTeams=a,this.isTeamsWeb=s,this.isMobileDevice=r,this.isReadyOnLoadedMetadata=n,this.onQualityImpactErrorCallback=o,this.onNotAllowedError=l,g.a.sendTraceTag(528599055,_.a.msoulscat_Wac_PptSession,S.a.Info,"Creating controller "+this.state),this.seekPrecision=F.a.readNumberOrDefault("videoSeekPrecision",.1),this.slowToPlayingTime=F.a.readNumberOrDefault("minTimeForSlowToPlayingVeto",1e4),this.notPlayingTime=F.a.readNumberOrDefault("minTimeForNotPlayingVeto",1e4),this.slowToSeekedTime=F.a.readNumberOrDefault("minTimeForSlowToSeekedVeto",1e4),this.notSeekedTime=F.a.readNumberOrDefault("minTimeForNotSeekedVeto",1e4),this.slowToResumedTime=F.a.readNumberOrDefault("minTimeForSlowToResumedVeto",1e4),this.notResumedTime=F.a.readNumberOrDefault("minTimeForNotResumedVeto",1e4),this.mediaMaxNotPlayingTime=F.a.readNumberOrDefault("maxTimeForVideoNotPlayedVeto",1e4),this.notPlayingAfterErrorTime=F.a.readNumberOrDefault("minTimeForNotPlayingAfterErrorVeto",1e3),this.minStallCount=F.a.readNumberOrDefault("stalledCountForGoodStalledVeto",3),e.addEventListener("loadedmetadata",()=>this.onLoadedMetadata()),e.addEventListener("canplay",()=>this.onCanPlay()),e.addEventListener("play",()=>this.onPlay()),e.addEventListener("playing",()=>this.onPlaying()),e.addEventListener("seeking",()=>this.onSeeking()),e.addEventListener("seeked",()=>this.onSeeked()),e.addEventListener("pause",()=>this.onPause()),e.addEventListener("ended",()=>this.onEnded()),e.addEventListener("error",()=>this.onError()),e.addEventListener("stalled",()=>this.onStalled()),this.isMobileDevice&&document.addEventListener("visibilitychange",()=>this.onVisibilityChange())}}!function(e){e[e.DisabledNotVideo=0]="DisabledNotVideo",e[e.DisabledNotMediaSnap=1]="DisabledNotMediaSnap",e[e.DisabledUrlParameter=2]="DisabledUrlParameter",e[e.EnabledOriginalNotPlayable=3]="EnabledOriginalNotPlayable",e[e.DisabledOnlyPlayableBrs=4]="DisabledOnlyPlayableBrs",e[e.DisabledNoMp4Brs=5]="DisabledNoMp4Brs",e[e.DisabledTooSmallForDesktopBrs=6]="DisabledTooSmallForDesktopBrs",e[e.Enabled=7]="Enabled",e[e.DisabledNoHls=8]="DisabledNoHls"}(zt||(zt={})),function(e){e[e.DisabledNotVideo=0]="DisabledNotVideo",e[e.DisabledNotMediaSnap=1]="DisabledNotMediaSnap",e[e.DisabledUrlParameter=2]="DisabledUrlParameter",e[e.DisabledNotMp4AndNotTranscoding=3]="DisabledNotMp4AndNotTranscoding",e[e.Enabled=4]="Enabled"}(Ht||(Ht={})),function(e){e[e.Raw=0]="Raw",e[e.LowNoMultivariantMobileBrs=1]="LowNoMultivariantMobileBrs",e[e.All=2]="All"}(Gt||(Gt={})),function(e){e[e.DisabledNoHls=0]="DisabledNoHls",e[e.EnabledProbably=1]="EnabledProbably",e[e.EnabledMaybe=2]="EnabledMaybe",e[e.DisabledNotSupported=3]="DisabledNotSupported"}(jt||(jt={})),function(e){e[e.DisabledNoHls=0]="DisabledNoHls",e[e.DisabledOriginalNotPlayable=1]="DisabledOriginalNotPlayable",e[e.DisabledNotMp4=2]="DisabledNotMp4",e[e.Enabled=3]="Enabled"}($t||($t={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.HLSTranscoding=1]="HLSTranscoding",e[e.HLSRaw=2]="HLSRaw",e[e.ProgressiveRaw=3]="ProgressiveRaw"}(qt||(qt={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.Progressive=1]="Progressive",e[e.HLSjs=2]="HLSjs",e[e.NativeHLS=3]="NativeHLS",e[e.ProgressiveNoHLS=4]="ProgressiveNoHLS"}(Zt||(Zt={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.Raw=1]="Raw",e[e.RawNoHLS=2]="RawNoHLS",e[e.Transcoding=3]="Transcoding"}(Jt||(Jt={})),function(e){e[e.Raw=0]="Raw",e[e.Low=1]="Low",e[e.All=2]="All"}(Xt||(Xt={})),function(e){e[e.StoppedRetrying=0]="StoppedRetrying",e[e.Unloaded=1]="Unloaded",e[e.NotYetStarted=2]="NotYetStarted",e[e.Retrying=3]="Retrying",e[e.SourceSet=4]="SourceSet",e[e.LoadStart=5]="LoadStart",e[e.LoadedMetadata=6]="LoadedMetadata",e[e.CanPlay=7]="CanPlay"}(Yt||(Yt={}));class ii{isUnplayable(){return 0===this.m_playbackOptions.length}shouldSkipCleanup(){return!(F.a.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)||!this.m_localMediaPlaybackPerf.isAutoPlay())||!F.a.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0)&&this.m_hlsOption===Zt.HLSjs||!F.a.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)&&this.m_hlsOption===Zt.NativeHLS}cleanupPlayerOnNavigatedFrom(){this.m_navigationCount+=1,this.shouldSkipCleanup()||(g.a.sendTraceTag(507003927,_.a.msoulscat_Wac_PptSession,S.a.Info,"cleanupPlayerOnNavigatedFrom mediaName: "+this.m_mediaName),this.m_loadingState=Yt.Unloaded,this.cancelRetryTimeout(),this.destroyHlsJsInstance(),this.m_element.src&&(this.m_element.removeAttribute("src"),this.m_element.load()))}resetPlayerOnNavigatingTo(){this.m_loadingState>=Yt.Retrying||(g.a.sendTraceTag(507003926,_.a.msoulscat_Wac_PptSession,S.a.Info,"resetPlayerOnNavigatingTo mediaName: "+this.m_mediaName),this.setSource())}setSource(){this.m_loadingState!==Yt.NotYetStarted&&this.m_loadingState!==Yt.StoppedRetrying&&g.a.sendTraceTag(507003925,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected loadingState in setSourceAsync"),this.m_retriesRemaining=this.m_initialRetryCount,this.m_retryDelayMs=this.m_initialRetryDelayMs,this.m_loadingState=Yt.NotYetStarted,this.cancelRetryTimeout(),this.setSourceAsync()}async setSourceAsync(){if(this.isUnplayable())return g.a.sendTraceTag(507003924,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected setSourceAsync with isUnplayable"),void this.stopRetrying();this.destroyHlsJsInstance(),this.m_hlsJsManifestLoaded=!1,this.m_hlsJsAutoRecoverRetryCount=0,await this.importHlsJsIfNecessaryAsync(),this.m_playbackOption=this.getPlaybackOption(),this.m_hlsOption=this.getHlsOption(),this.m_transcodingOption=this.getTranscodingOption(),this.m_transcodingUrlParam=this.getTranscodingUrlParam();const e=this.isHlsSelected(),t=this.isTranscodingSelected(),i=!t&&!this.m_isOriginalPlayable,n={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:qt[this.m_playbackOption],hlsOption:Zt[this.m_hlsOption],transcodingOption:Jt[this.m_transcodingOption],transcodingUrlParam:Xt[this.m_transcodingUrlParam],isHls:e,isTranscoding:t,isUnplayable:i},r=i?S.a.Error:S.a.Info;if(g.a.sendTraceTag(507003923,_.a.msoulscat_Wac_PptSession,r,JSON.stringify(n)),i)return void this.stopRetrying();this.updateUrlParams(),this.m_localMediaPlaybackPerf.onSourceSet(this.m_url.toString()),this.m_localMediaPlaybackPerf.setHlsAndTranscoding(e,t),this.m_localMediaPlaybackTelemetry&&(this.m_localMediaPlaybackTelemetry.onSourceSet(this.m_url.toString()),this.m_localMediaPlaybackTelemetry.setHlsAndTranscoding(e,t)),this.m_localMediaPlaybackController.onSourceSet(this.m_requestGuid,this.m_retriesRemaining,this.m_originalMediaLength,t,e,this.m_navigationCount),this.m_loadingState=Yt.SourceSet;const a=this.addPreloadParam(this.getUrlWithSlashes());this.m_hlsOption===Zt.HLSjs&&this.m_hls?(this.m_hls.loadSource(a),this.m_hls.attachMedia(this.m_element)):this.m_element.src=a}updateUrlParams(){this.m_url.searchParams.set("retries",this.m_retriesRemaining.toString()),this.m_url.searchParams.set("transcode",Xt[this.m_transcodingUrlParam])}getUrlWithSlashes(){const e=this.m_url.toString();return this.isHlsSelected()?e.replace(/[?&]/g,"/")+"/index.m3u8":e}addPreloadParam(e){return Je(this.m_uiHostType)&&F.a.readBooleanOrDefault("iOSHlsPreload",!0)?e+"#t=0.1":e}getHlsOption(){if(this.isUnplayable())return Zt.Unplayable;if(!this.isHls())return Zt.Progressive;if(F.a.readBooleanOrDefault("initializeHLSJsFirst",!1)){if(this.tryInitializeHlsJsInstance())return Zt.HLSjs;if(this.isNativeHlsEnabled())return Zt.NativeHLS}else{if(this.isNativeHlsEnabled())return Zt.NativeHLS;if(this.tryInitializeHlsJsInstance())return Zt.HLSjs}return Zt.ProgressiveNoHLS}isHlsSelected(){return this.m_hlsOption===Zt.HLSjs||this.m_hlsOption===Zt.NativeHLS}getTranscodingOption(){return this.isUnplayable()?Jt.Unplayable:this.isHlsTranscoding()?this.isHlsSelected()?Jt.Transcoding:Jt.RawNoHLS:Jt.Raw}isTranscodingSelected(){return this.m_transcodingOption===Jt.Transcoding}getTranscodingUrlParam(){if(!this.isTranscodingSelected())return Xt.Raw;switch(this.m_transcodingQuality){case Gt.All:return Xt.All;case Gt.LowNoMultivariantMobileBrs:return Xt.Low;default:return Xt.Raw}}async importHlsJsIfNecessaryAsync(){if(!this.isHls())return;if(ii.s_hlsJs)return;if(!self.MediaSource&&!self.WebKitMediaSource)return;const e=Date.now();try{ii.s_hlsJs=await i.e(0).then(i.bind(null,431)),g.a.sendTraceTag(507003922,_.a.msoulscat_Wac_PptSession,S.a.Info,`HLS.js successfully loaded in ${Date.now()-e} ms`)}catch(t){g.a.sendTraceTag(507003921,_.a.msoulscat_Wac_PptSession,S.a.Error,`HLS.js failed to load in ${Date.now()-e} ms exception: ${t} mediaName: ${this.m_mediaName}`)}}tryInitializeHlsJsInstance(){if(this.m_hls)return!0;if(!ii.s_hlsJs)return!1;if(!ii.s_hlsJs.default.isSupported())return g.a.sendTraceTag(507003920,_.a.msoulscat_Wac_PptSession,S.a.Error,"HLS.js is not supported mediaName: "+this.m_mediaName),!1;const e=!G.ChangeGate.isChangeGateEnabled("SVM.DisableHLSProgressiveStream"),t=this.m_isMobileDevice?F.a.readNumberOrDefault("hlsBackBufferLengthMobile",1/0):F.a.readNumberOrDefault("hlsBackBufferLength",1/0);return this.m_hls=new ii.s_hlsJs.default({progressive:e,backBufferLength:t}),this.m_hls.on(ii.s_hlsJs.default.Events.MANIFEST_LOADED,e=>{this.m_hlsJsManifestLoaded=!0}),this.m_hls.on(ii.s_hlsJs.default.Events.FRAG_BUFFERED,e=>{if(this.m_hls){const e=this.m_hls.bandwidthEstimate;this.m_localMediaPlaybackPerf.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackController.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.setHlsBandwidthEstimate(e)}}),this.m_hls.on(ii.s_hlsJs.default.Events.ERROR,(e,t)=>{this.onHlsJsError(t)}),!0}destroyHlsJsInstance(){this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0)}onHlsJsError(e){const t=this.m_hlsJsManifestLoaded&&this.m_hlsJsAutoRecoverRetryCount<=F.a.readNumberOrDefault("maxHlsAutoRecoverRetryCount",2),i={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:qt[this.m_playbackOption],hlsOption:Zt[this.m_hlsOption],transcodingOption:Jt[this.m_transcodingOption],transcodingUrlParam:Xt[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),isFatal:e.fatal,errorType:e.type,errorReason:e.reason,errorDetails:e.details,loadingState:Yt[this.m_loadingState],wasManifestLoaded:this.m_hlsJsManifestLoaded,isAutorecoveryEnabled:t,autorecoveryRetryCount:this.m_hlsJsAutoRecoverRetryCount},n=e.fatal?S.a.Error:S.a.Warning;if(g.a.sendTraceTag(507003919,_.a.msoulscat_Wac_PptSession,n,JSON.stringify(i)),e.fatal){if(this.m_localMediaPlaybackController.addHlsError(e.type,e.details),t&&ii.s_hlsJs&&this.m_hls)switch(e.type){case ii.s_hlsJs.default.ErrorTypes.NETWORK_ERROR:return this.m_hls.startLoad(),void(this.m_hlsJsAutoRecoverRetryCount+=1);case ii.s_hlsJs.default.ErrorTypes.MEDIA_ERROR:return this.m_hls.recoverMediaError(),void(this.m_hlsJsAutoRecoverRetryCount+=1)}this.retryLoading()}}onError(){const e=this.m_element.error?this.m_element.error.code:-1,t=this.m_element.error?this.m_element.error.message:"",i={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:qt[this.m_playbackOption],hlsOption:Zt[this.m_hlsOption],transcodingOption:Jt[this.m_transcodingOption],transcodingUrlParam:Xt[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),isFatal:!0,errorCode:e,errorMessage:t,loadingState:Yt[this.m_loadingState]};g.a.sendTraceTag(507003918,_.a.msoulscat_Wac_PptSession,S.a.Error,JSON.stringify(i)),this.m_loadingState<Yt.LoadStart?g.a.sendTraceTag(507003917,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected error before loadstart"):this.retryLoading()}onCanPlay(){const e={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:qt[this.m_playbackOption],hlsOption:Zt[this.m_hlsOption],transcodingOption:Jt[this.m_transcodingOption],transcodingUrlParam:Xt[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),loadingState:Yt[this.m_loadingState]};g.a.sendTraceTag(507003916,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify(e))}stopRetrying(){this.m_loadingState=Yt.StoppedRetrying,this.cancelRetryTimeout(),this.m_onFatalError()}retryLoading(){this.m_retriesRemaining<=0?this.stopRetrying():(this.m_retriesRemaining-=1,this.m_loadingState=Yt.Retrying,this.cancelRetryTimeout(),this.m_retryTimeoutId=window.setTimeout(()=>{this.setSourceAsync()},this.getRetryDelay()))}cancelRetryTimeout(){void 0!==this.m_retryTimeoutId&&(window.clearTimeout(this.m_retryTimeoutId),this.m_retryTimeoutId=void 0)}getRetryDelay(){if(this.getRetryCount()<this.m_playbackOptions.length)return 1;const e=F.a.readNumberOrDefault("mediaRetryMultiplier",ii.RETRY_DELAY_MULTIPLIER);return this.m_retryDelayMs*=e,this.m_retryDelayMs}getInitialRetryCount(e){let t=e;return this.isHlsTranscodingEnabled()&&(t+=1),this.isHlsRawEnabled()&&(t+=1),t}getInitialRetryDelay(){return F.a.readNumberOrDefault("mediaRetryInitialDelayMs",ii.RETRY_INITIAL_DELAY_MS)}getTranscodingState(){return this.m_isVideo?this.m_isMediaSnap?null!==this.m_url.searchParams.get("disableTranscode")?zt.DisabledUrlParameter:this.m_isOriginalPlayable?F.a.readBooleanOrDefault("onlyTranscodeUnplayableVideos",!1)?zt.DisabledOnlyPlayableBrs:F.a.readBooleanOrDefault("noMP4Transcoding",!1)&&this.m_isMP4?zt.DisabledNoMp4Brs:this.m_originalMediaLength>0&&this.m_originalMediaLength<F.a.readNumberOrDefault("minVideoSizeToTranscodeForDesktopBytes",1e7)&&!this.m_isMobileDevice?zt.DisabledTooSmallForDesktopBrs:zt.Enabled:zt.EnabledOriginalNotPlayable:zt.DisabledNotMediaSnap:zt.DisabledNotVideo}getHlsState(){return this.m_isVideo?this.m_isMediaSnap?null!==this.m_url.searchParams.get("disableHLS")?Ht.DisabledUrlParameter:this.m_isMP4||this.isTranscodingEnabled()?Ht.Enabled:Ht.DisabledNotMp4AndNotTranscoding:Ht.DisabledNotMediaSnap:Ht.DisabledNotVideo}getTranscodingQuality(){return this.isTranscodingEnabled()?!F.a.readBooleanOrDefault("multivariantPlaylistEnabledOnMobile",!1)&&this.m_isMobileDevice?Gt.LowNoMultivariantMobileBrs:Gt.All:Gt.Raw}getNativeHlsState(){if(!this.isHlsEnabled())return jt.DisabledNoHls;const e=this.m_element.canPlayType("application/vnd.apple.mpegurl");return"probably"===e?jt.EnabledProbably:"maybe"===e?jt.EnabledMaybe:jt.DisabledNotSupported}getHlsRawState(){return this.isHlsEnabled()?this.m_isOriginalPlayable?this.m_isMP4?$t.Enabled:$t.DisabledNotMp4:$t.DisabledOriginalNotPlayable:$t.DisabledNoHls}isTranscodingEnabled(){return this.m_transcodingState===zt.EnabledOriginalNotPlayable||this.m_transcodingState===zt.Enabled}isHlsEnabled(){return this.m_hlsState===Ht.Enabled}isNativeHlsEnabled(){return this.m_nativeHlsState===jt.EnabledProbably||this.m_nativeHlsState===jt.EnabledMaybe}isHlsRawEnabled(){return this.m_hlsRawState===$t.Enabled}isHlsTranscodingEnabled(){return this.isHlsEnabled()&&this.isTranscodingEnabled()}getRetryCount(){return this.m_initialRetryCount-this.m_retriesRemaining}getPlaybackOption(){return this.isUnplayable()?qt.Unplayable:this.m_playbackOptions[Math.min(this.getRetryCount(),this.m_playbackOptions.length-1)]}isHlsTranscoding(){return this.getPlaybackOption()===qt.HLSTranscoding}isHlsRaw(){return this.getPlaybackOption()===qt.HLSRaw}isHls(){return this.isHlsTranscoding()||this.isHlsRaw()}constructor(e,t,i,n,r,a,s,o,l,d,c,h,u,m,f,p,v){this.m_playbackOptions=[],this.m_navigationCount=0,this.m_loadingState=Yt.NotYetStarted,this.m_hlsJsManifestLoaded=!1,this.m_hlsJsAutoRecoverRetryCount=0,this.m_playbackOption=qt.Unplayable,this.m_hlsOption=Zt.Unplayable,this.m_transcodingOption=Jt.Unplayable,this.m_transcodingUrlParam=Xt.Raw,this.m_element=e,this.m_url=t,this.m_mediaName=i,this.m_isMediaSnap=n,this.m_originalMediaLength=r,this.m_isOriginalPlayable=a,this.m_isVideo=s,this.m_isMP4=o,this.m_isMobileDevice=l,this.m_uiHostType=d,this.m_requestGuid=u,this.m_localMediaPlaybackPerf=m,this.m_localMediaPlaybackController=f,this.m_localMediaPlaybackTelemetry=v,this.m_onFatalError=p,this.m_transcodingState=this.getTranscodingState(),this.m_hlsState=this.getHlsState(),this.m_transcodingState=this.isHlsEnabled()?this.m_transcodingState:zt.DisabledNoHls,this.m_transcodingQuality=this.getTranscodingQuality(),this.m_nativeHlsState=this.getNativeHlsState(),this.m_hlsRawState=this.getHlsRawState(),this.m_initialRetryCount=this.getInitialRetryCount(c),this.m_initialRetryDelayMs=this.getInitialRetryDelay();const y=[];this.isHlsTranscodingEnabled()&&(this.m_playbackOptions.push(qt.HLSTranscoding),y.push(qt[qt.HLSTranscoding])),this.isHlsRawEnabled()&&(this.m_playbackOptions.push(qt.HLSRaw),y.push(qt[qt.HLSRaw])),this.m_isOriginalPlayable&&(this.m_playbackOptions.push(qt.ProgressiveRaw),y.push(qt[qt.ProgressiveRaw]));const T={mediaName:i,isMediaSnap:n,originalMediaLength:r,isOriginalPlayable:a,isVideo:s,isMP4:o,isMobileDevice:l,uiHostType:ke[d],requestGuid:u,transcodingState:zt[this.m_transcodingState],transcodingQuality:Gt[this.m_transcodingQuality],hlsState:Ht[this.m_hlsState],nativeHlsState:jt[this.m_nativeHlsState],hlsRawState:$t[this.m_hlsRawState],initialRetryCount:this.m_initialRetryCount,initialRetryDelayMs:this.m_initialRetryDelayMs,playbackOptions:y.toString()};g.a.sendTraceTag(507003928,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify(T)),this.m_retriesRemaining=this.m_initialRetryCount,this.m_retryDelayMs=this.m_initialRetryDelayMs,this.m_url.hostname=this.m_url.hostname.toLowerCase().replace(".pods.",".media."),this.m_url.searchParams.set("usid",h),this.m_url.searchParams.set("requestGuid",this.m_requestGuid),this.m_element.addEventListener("loadstart",()=>{this.m_loadingState=Yt.LoadStart}),this.m_element.addEventListener("loadedmetadata",()=>{this.m_loadingState=Yt.LoadedMetadata}),this.m_element.addEventListener("canplay",()=>{this.m_loadingState!==Yt.CanPlay&&(this.m_loadingState=Yt.CanPlay,this.onCanPlay())}),this.m_element.addEventListener("error",()=>{this.onError()})}}ii.RETRY_INITIAL_DELAY_MS=600,ii.RETRY_DELAY_MULTIPLIER=2;var ni,ri=i(36);class ai{setPlayButtonVisible(){this.m_mediaPlayButton.style.display="block",this.m_mediaPlayButton.style.pointerEvents="visible"}setPlayButtonHidden(){this.m_mediaPlayButton.style.display="none"}isPlayButtonVisible(){return"none"!==this.m_mediaPlayButton.style.display}constructor(e,t){this.m_mediaPlayButton=e,t?this.setPlayButtonVisible():this.setPlayButtonHidden()}}function si(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}class oi{setRetryButtonVisible(){this.m_mediaRetryButton.style.display="block",this.m_mediaRetryButton.style.pointerEvents="visible"}setRetryButtonHidden(){this.m_mediaRetryButton.style.display="none"}constructor(e){this.m_mediaRetryButton=e}}class li{start(){this.m_startTime=performance.now(),this.m_renderFrameCount=0,this.m_videoFrameCount=0,this.m_presentedFrameCount=0,this.m_isActive=!0,"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(this.m_lastMediaTime=0,this.m_videoEl.requestVideoFrameCallback(this.videoFrameCallback))}stop(e){const t=performance.now()-this.m_startTime;if(t>0){const i=1e3*this.m_renderFrameCount/t,n=1e3*this.m_videoFrameCount/t,r={Metadata:{...this.m_metadata,...e},VideoFrameCount:this.m_videoFrameCount,VideoFrameRate:n.toFixed(2),RenderedFrameCount:this.m_renderFrameCount,PresentedFrameCount:this.m_presentedFrameCount,RenderFrameRate:i.toFixed(2),Duration:t.toFixed(0),Length:this.m_videoEl.duration};g.a.sendTraceTag(507004178,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify(r))}this.m_isActive=!1}updateRenderFrameCount(){this.m_renderFrameCount+=1}get isActive(){return this.m_isActive}constructor(e,t){this.m_startTime=0,this.m_lastMediaTime=0,this.m_videoFrameCount=0,this.m_isActive=!1,this.m_renderFrameCount=0,this.m_presentedFrameCount=0,this.videoFrameCallback=(e,t)=>{Math.abs(t.mediaTime-this.m_lastMediaTime)>0&&(this.m_videoFrameCount+=1,this.m_lastMediaTime=t.mediaTime),t.presentedFrames>0&&(this.m_presentedFrameCount=t.presentedFrames),this.m_isActive&&this.m_videoEl.requestVideoFrameCallback(this.videoFrameCallback)},this.m_videoEl=e,this.m_metadata=t,this.m_metadata.dirtyRectTracking=F.a.readBooleanOrDefault("enableDirtyRectTracking",!1),this.m_metadata.hostContainer=F.a.readStringOrDefault("hostContainer","undefined")}}class di{onPlayClick(){this.emitEventAndAction(l.MediaPlayed,d.PlayButtonClick)}onPauseClick(){this.emitEventAndAction(l.MediaPaused,d.PauseButtonClick)}onVolumeClick(){this.emitEvent(l.MediaVolumeChanged,d.VolumeButtonClick)}onVolumeChanged(){this.emitEvent(l.MediaVolumeChanged,d.VolumeSliderInput)}onSeeked(){this.emitEventAndAction(l.MediaSeeked,d.ProgressSliderInput)}emitEvent(e,t){this.m_mediaSyncEmitter&&this.m_mediaSyncEmitter(e,t)}emitEventAndAction(e,t){this.m_mediaSyncEmitter&&this.m_mediaSyncEmitter(e,t),this.m_mediaActionEmitter&&this.m_mediaActionEmitter(t)}constructor(e,t){this.m_mediaSyncEmitter=e,this.m_mediaActionEmitter=t}}class ci{static getPosition(e){const t=e.bottom-this.s_videoControlsHeight,i=e.left;return new m.f(i,t)}static getMediaControlInfo(e,t,i){return{position:this.getPosition(t),size:{x:t.width,y:this.s_videoControlsHeight},zIndex:2,trimInfo:{trimStartMs:e.props.trimStartMs,trimEndMs:e.props.trimEndMs},cssUrl:this.getCssPath(i),screenReaderInfo:this.getLocalizedStrings(),controlHidingEnabled:F.a.readBooleanOrDefault("playbackControlHidingEnabled",!1),widthThresholdForHidingControls:F.a.readNumberOrDefault("thresholdForHidingPlaybackControls",275)}}static getLocalizedStrings(){return"undefined"!=typeof PowerpointSlideshowStringsManager?{progressBarStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlAccessibilityLabelProgressBar),playButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelPlayButton),pauseButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelPauseButton),muteButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelMuteButton),unmuteButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelUnmuteButton),volumeSliderStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelVolumeSlider),localizedLabelsStr:[PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelHour),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelHours),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelMinute),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelMinutes),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelSecond),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelSeconds)],localizedTimeStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelVideoTime),progressStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelVideoProgress),captionsButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelClosedCaptionsButton),speedButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelPlaybackSpeedButton),fullScreenButtonStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelFullScreenButton),captionsMenuStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelClosedCaptionsMenu),captionsMenuOffOptionStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelClosedCaptionsMenuOffOption),speedMenuOptionStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelPlaybackSpeedMenuOption)}:{progressBarStr:"Video Progress Bar",playButtonStr:"Video Play",pauseButtonStr:"Video Pause",muteButtonStr:"Video Mute",unmuteButtonStr:"Video Unmute",volumeSliderStr:"Volume Level Slider",localizedLabelsStr:["hour","hours","minute","minutes","second","seconds"],localizedTimeStr:"{0} {1} {2} {3} {4} {5}",progressStr:"{0} of {1}",captionsButtonStr:"Video Closed Captions",speedButtonStr:"Video Playback Speed",fullScreenButtonStr:"Video Full Screen",captionsMenuStr:"Video Closed Captions Menu",captionsMenuOffOptionStr:"Off",speedMenuOptionStr:"{0}x"}}static getTooltipMap(){return G.ChangeGate.isChangeGateEnabled("SVM.useLocalizedTooltipStrings")&&"undefined"!=typeof PowerpointSlideshowStringsManager?new Map([["Play",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPlayPresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPlayAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPlay))],["Pause",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPausePresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPauseAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPause))],["Mute",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelMutePresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelMuteAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelMute))],["Unmute",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelUnmutePresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelUnmuteAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelUnmute))],["Captions",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelCaptionsPresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelCaptionsAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelCaptions))],["Captions disabled",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelCaptionsDisabledPresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelCaptionsDisabledAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelCaptionsDisabled))],["Seek",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelSeekPresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelSeekAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelSeek))],["Playback speed",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelSpeedPresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelSpeedAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelSpeed))],["Volume slider",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelVolumeSliderPresenter),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelVolumeSliderAttendee),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelVolumeSlider))],["Full screen",new At(PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelFullScreen),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelFullScreen),PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelFullScreen))]]):new Map([["Play",new At("Play for everyone","Play for me only","Play")],["Pause",new At("Pause for everyone","Pause for me only","Pause")],["Mute",new At("Mute for everyone","Mute for me only","Mute")],["Unmute",new At("Unmute for everyone","Unmute for me only","Unmute")],["Captions",new At("Show closed captions for me only","Show closed captions for me only","Show closed captions")],["Captions disabled",new At("Video does not contain closed captions","Video does not contain closed captions","Video does not contain closed captions")],["Seek",new At("Play from here for everyone","Play from here for me only","Play from here")],["Playback speed",new At("Set playback speed for me only","Set playback speed for me only","Set playback speed")],["Volume slider",new At("Adjust volume for me only","Adjust volume for me only","Adjust volume")],["Full screen",new At("Full screen","Full screen","Full screen")]])}static getCssPath(e){if(Ge(e)===ke.SSCTestApp)return"PlaybackControls.css";if(e.settings.jsScriptsBasePath&&e.settings.applicationLcid){const t=G.ChangeGate.isChangeGateEnabled("SVM.useRegexForPlaybackControlsReplace")?/pptscripts\/ssapp\//i:"pptscripts/ssapp/";return G.ChangeGate.isChangeGateEnabled("SVM.lowercaseUrl")?e.settings.jsScriptsBasePath.replace(t,`pptresources/${e.settings.applicationLcid}/PlaybackControls.css`):e.settings.jsScriptsBasePath.replace(t,`PptResources/${e.settings.applicationLcid}/PlaybackControls.css`)}return g.a.sendTraceTag(507004189,_.a.msoulscat_Wac_PptSession,S.a.Warning,"PlaybackControls: Custom controls css path is empty"),J.e.recordVeto("CustomControlFailure",{errorName:"NoCssPath",qosVeto:"CustomControlFailure",isIntentional:!0}),""}}ci.s_videoControlsHeight=50;class hi extends Ue{onLoadStart(){void 0===this.baseData.timeOfLoadStart&&(this.localData.timeOfLoadedMetadata=void 0,this.localData.timeOfCanPlayThrough=void 0),super.onLoadStart()}onLoadedMetadata(){void 0===this.localData.timeOfLoadedMetadata&&(this.localData.timeOfLoadedMetadata=Date.now(),this.useLoadedMetadataAsInteractivityEvent?this.baseData.timeOfCanPlay=this.localData.timeOfLoadedMetadata:this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onCanPlay(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||super.onCanPlay()),this.isFirstCanPlay&&(this.isFirstCanPlay=!1,this.isFirstCanPlayThrough||Q.error(508695704,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: "+this.baseData.loggableMediaId))}onCanPlayThrough(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||super.onCanPlay()),this.isFirstCanPlayThrough&&(this.isFirstCanPlayThrough=!1,this.localData.timeOfCanPlayThrough=Date.now(),this.isFirstCanPlay&&Q.error(508704418,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: "+this.baseData.loggableMediaId))}onPlay(){this.checkPlayerNotReady("play"),super.onPlay(),this.isFirstPlay&&(this.isFirstPlay=!1,this.isFirstCanPlay&&Q.error(508704417,"No 'canplay' event was triggered before triggering the 'play' event on media: "+this.baseData.loggableMediaId))}onPlaying(){this.checkPlayerNotReady("playing"),super.onPlaying(),this.isFirstPlay&&Q.error(507540381,"No 'play' event was triggered before triggering the 'playing' event on media: "+this.baseData.loggableMediaId)}onStalled(){this.isPlaying&&(void 0===this.localData.numberOfStalls?this.localData.numberOfStalls=1:this.localData.numberOfStalls+=1)}cleanup(){this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,super.cleanup()}getPlaybackData(){return Object.assign(Object.assign({},super.getPlaybackData()),this.localData)}setSrcDimensions(e,t){this.localData.sourceVideoWidth=e,this.localData.sourceVideoHeight=t}setMediaExtension(e){this.localData.mediaExtension=e}setContentType(e){this.localData.contentType=e}setMediaLength(e){this.localData.mediaLength=e}setRetriesLeft(e){this.localData.retriesLeft=e}setIsUsingPlaybackControls(){this.localData.isUsingPlaybackControls=!0}checkPlayerNotReady(e){void 0===this.baseData.timeOfCanPlay&&Q.info(507540380,"Event emitted before media became interactive: "+JSON.stringify({event:e,media:this.baseData.loggableMediaId,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid}))}constructor(e,t,i,n){super(e,"Local",t,i,n),this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.useLoadedMetadataAsInteractivityEvent=!1,this.localData={},this.useLoadedMetadataAsInteractivityEvent=Pe.getBoolean("useLoadedMetadataAsInteractivityEvent")}}function ui(e,t){for(const[i,n]of Object.entries(t))e.setAttribute(i,n)}class mi{registerEventListeners(e){this.player.addEventListener("loadstart",()=>{this.playbackTracker.onLoadStart(),this.sendEvent(0)}),this.player.addEventListener("loadedmetadata",()=>{this.playbackTracker.onLoadedMetadata(),this.playbackTracker.setDuration(Math.round(1e3*this.player.duration)),this.player instanceof HTMLVideoElement&&this.playbackTracker.setSrcDimensions(this.player.videoWidth,this.player.videoHeight),this.sendEvent(1)}),this.player.addEventListener("loadeddata",()=>{this.sendEvent(2)}),this.player.addEventListener("canplay",()=>{this.playbackTracker.onCanPlay(),this.sendEvent(3)}),this.player.addEventListener("canplaythrough",()=>{this.playbackTracker.onCanPlayThrough()}),this.player.addEventListener("play",()=>{this.playbackTracker.onPlay(),this.sendEvent(4)}),this.player.addEventListener("playing",()=>{this.playbackTracker.onPlaying(),this.sendEvent(5)}),this.player.addEventListener("pause",()=>{this.playbackTracker.onPause(),this.sendEvent(6)}),this.player.addEventListener("seeked",()=>{this.sendEvent(7)}),this.player.addEventListener("seeking",()=>{this.sendEvent(8)}),e&&this.player.addEventListener("timeupdate",()=>{this.sendEvent(9)}),this.player.addEventListener("volumechange",()=>{this.playbackTracker.onVolumeChanged(this.player.volume),this.playbackTracker.setIsMuted(this.player.muted),this.sendEvent(10)}),this.player.addEventListener("stalled",()=>{this.playbackTracker.onStalled(),this.sendEvent(8)}),this.player.addEventListener("ended",()=>{this.playbackTracker.onEnded(),this.sendEvent(11)}),this.player.addEventListener("error",()=>{const e="Local media error."+(this.player.error?` Code: ${this.player.error.code}, message: ${this.player.error.message}`:"");this.playbackTracker.onError(e),this.sendEvent(12)})}getPlaybackData(){return this.playbackTracker.getPlaybackData()}cleanup(){this.playbackTracker.cleanup()}sendEvent(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}constructor(e,t,i,n){this.player=e,this.playbackTracker=i,this.onMediaEventCallback=n,this.playbackTracker.setIsMuted(this.player.muted),this.playbackTracker.setVolume(this.player.volume),this.registerEventListeners(t)}}class fi{play(){return Object(ee.b)(this,void 0,void 0,(function*(){try{yield this.player.play()}catch(e){Q.error(541882e3,`Local.play: Failed to play local video. ${e instanceof DOMException?e.name:""} ${e instanceof DOMException?e.message:""}`)}Q.info(520378572,"Local.play: this.player.paused: "+this.player.paused)}))}pause(){this.player.pause()}setVisible(){this.isDesignerElement&&(this.player.loop=!0),this.player.style.visibility="visible",this.setFocus()}setHidden(){this.isDesignerElement&&(this.player.loop=!1,this.player.autoplay=!1),this.player.style.pointerEvents="none",this.player.style.visibility="hidden"}stop(){this.player.pause(),this.player.currentTime=0}togglePause(){return Object(ee.b)(this,void 0,void 0,(function*(){if(Q.info(520378573,"Local.togglePause: Before toggle, this.player.paused: "+this.player.paused),this.player.paused)try{yield this.play()}catch(e){Q.info(541882001,"Error local video play while toggle pause")}else this.pause();Q.info(520378574,"Local.togglePause: After toggle, this.player.paused: "+this.player.paused)}))}isPaused(){return this.player.paused}getPlayer(){return this.player}setSource(e){if(this.player.src!==e){const t=this.player.currentTime;this.player.src=e,!isNaN(t)&&isFinite(t)&&(this.player.currentTime=t)}}getCurrentTime(){return this.player.currentTime}setEndTime(e){this.endTime=e,this.player.addEventListener("timeupdate",this.onTimeUpdateForEndTime),this.player.addEventListener("pause",this.onPauseForEndTime)}clearEndTime(){this.pause(),this.endTime=void 0,this.player.removeEventListener("timeupdate",this.onTimeUpdateForEndTime),this.player.removeEventListener("pause",this.onPauseForEndTime)}getDuration(){return this.player.duration}seekTo(e){this.player.currentTime=e}ensureMediaClient(){}cleanUpMediaClient(){void 0!==this.eventHandler&&void 0!==this.eventHandler.cleanup&&this.eventHandler.cleanup()}setMute(){this.player.muted=!0}setUnMute(){this.player.muted=!1}isMuted(){return this.player.muted}setVolume(e){this.player.volume=e}getVolume(){return this.player.volume}getPlaybackData(){if(void 0!==this.eventHandler&&void 0!==this.eventHandler.getPlaybackData)return this.eventHandler.getPlaybackData()}updateTrackList(e){this.removeCaptionsTracks(this.player),this.createCaptionsTracks(this.player,e)}setFocus(){void 0!==this.player&&this.player.focus()}seekToTrimStartIfNeeded(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&(this.player.currentTime<this.mediaProperties.trimStartSec||this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec)&&void 0===this.endTime&&(this.player.currentTime=this.mediaProperties.trimStartSec)}onTimeUpdate(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec&&void 0===this.endTime&&this.player.pause()}isTrimValid(){return void 0!==this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimEndSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec+this.mediaProperties.trimEndSec<this.mediaProperties.durationSec}setTrim(e){void 0===e||isNaN(e.duration)||(this.mediaProperties.durationSec=e.duration,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec-this.mediaProperties.trimEndSec,this.isTrimValid()?(e.addEventListener("timeupdate",()=>{this.onTimeUpdate()}),e.addEventListener("play",()=>{this.seekToTrimStartIfNeeded()})):(this.mediaProperties.trimStartSec=0,this.mediaProperties.trimEndSec=0,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec))}removeCaptionsTracks(e){const t=e.getElementsByTagName("track");for(let e=t.length-1;e>=0;e--)t[e].remove()}createCaptionsTracks(e,t){t.forEach(t=>{var i;const n=document.createElement("track"),r=t.lang&&""!==t.lang?t.lang:"unknown";n.setAttribute("kind","captions"),n.setAttribute("label",null!==(i=t.label)&&void 0!==i?i:""),n.setAttribute("src",decodeURIComponent(t.src)),n.setAttribute("srclang",r),n.setAttribute("id",t.name),e.appendChild(n)})}createLocalPlayer(e,t,i,n,r,a,s){const o=n===Kt.a.Audio?document.createElement("audio"):document.createElement("video");return void 0!==e&&e.appendChild(o),o.style.visibility=i||r||a?"hidden":"visible",o.style.pointerEvents=r||a?"none":"all",this.setProperties(o),void 0!==this.mediaProperties.attributes?ui(o,this.mediaProperties.attributes):ui(o,{disablePictureInPicture:"true",controlsList:"nodownload nofullscreen noremoteplayback"}),void 0!==this.mediaProperties.styles?le(o,this.mediaProperties.styles):de(o),i?(o.loop=!0,o.muted=!0,o.addEventListener("canplay",()=>{o.style.visibility="visible"},{once:!0})):this.setFocus(),(this.mediaProperties.trimStartSec>0||this.mediaProperties.trimEndSec>0)&&o.addEventListener("loadedmetadata",()=>{this.setTrim(o)},{once:!0}),null!=s&&this.createCaptionsTracks(o,s),o.src=t,o}setProperties(e){e.autoplay=void 0===this.mediaProperties.autoPlay||this.mediaProperties.autoPlay,e.controls=void 0===this.mediaProperties.controls||this.mediaProperties.controls,void 0!==this.mediaProperties.elementId&&(e.id=this.mediaProperties.elementId),void 0!==this.mediaProperties.crossOrigin&&(e.crossOrigin=this.mediaProperties.crossOrigin),void 0!==this.mediaProperties.zIndex&&(e.style.zIndex=this.mediaProperties.zIndex),void 0!==this.mediaProperties.preload&&(e.preload=this.mediaProperties.preload),e instanceof HTMLVideoElement&&(void 0!==this.mediaProperties.playsInline&&(e.playsInline=this.mediaProperties.playsInline),void 0!==this.mediaProperties.width&&(e.width=this.mediaProperties.width),void 0!==this.mediaProperties.height&&(e.height=this.mediaProperties.height))}constructor(e,t,i,n,r,a,s,o,l){this.onTimeUpdateForEndTime=()=>{void 0!==this.player&&void 0!==this.endTime&&this.player.currentTime>=this.endTime&&(this.player.pause(),this.endTime=void 0,this.player.removeEventListener("timeupdate",this.onTimeUpdateForEndTime),this.player.removeEventListener("pause",this.onPauseForEndTime))},this.onPauseForEndTime=()=>{void 0!==this.player&&(this.endTime=void 0,this.player.removeEventListener("pause",this.onPauseForEndTime))},this.isDesignerElement=i,this.mediaProperties=n,this.player=this.createLocalPlayer(e,t,i,n.mediaType,r,a,l),void 0!==s?(this.eventHandler=new mi(this.player,this.mediaProperties.trimEndSec>0,s,o),s.setTimeOfCreation()):Q.info(507573786,"Local: playbackTracker is undefined")}}class pi{playMedia(){void 0!==this.client&&this.client.play()}pauseMedia(){void 0!==this.client&&this.client.pause()}seekMedia(e){if(void 0!==this.client)if(Pe.getBoolean("sanitizeLocalInputs")){const t=Math.max(e,0);this.client.seekTo(t)}else this.client.seekTo(e)}stopMedia(){void 0!==this.client&&this.client.stop()}togglePauseMedia(){void 0!==this.client&&this.client.togglePause()}isPaused(){if(void 0!==this.client&&void 0!==this.client.isPaused)return this.client.isPaused()}setMute(){void 0!==this.client&&void 0!==this.client.setMute&&this.client.setMute()}setUnMute(){void 0!==this.client&&void 0!==this.client.setUnMute&&this.client.setUnMute()}isMuted(){if(void 0!==this.client&&void 0!==this.client.isMuted)return this.client.isMuted()}setVolume(e){if(void 0!==this.client&&void 0!==this.client.setVolume)if(Pe.getBoolean("sanitizeLocalInputs")){const t=Math.min(Math.max(e,0),1);this.client.setVolume(t)}else this.client.setVolume(e)}getVolume(){if(void 0!==this.client&&void 0!==this.client.getVolume)return this.client.getVolume()}setCrossOrigin(e){const t=this.getMediaElement();void 0!==t&&(t.crossOrigin=e)}setSource(e){void 0!==this.client&&void 0!==this.client.setSource&&this.client.setSource(e),this.onSourceSet()}onSourceSet(){void 0!==this.playbackTracker&&this.playbackTracker.onSourceSet()}setMediaExtension(e){void 0!==this.playbackTracker&&this.playbackTracker.setMediaExtension(e)}setMediaLength(e){void 0!==this.playbackTracker&&this.playbackTracker.setMediaLength(e)}setRetriesLeft(e){void 0!==this.playbackTracker&&this.playbackTracker.setRetriesLeft(e)}setUiHostType(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setUiHostType(e)}setFlights(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setFlights(e)}setPlayRequestTime(){var e;null===(e=this.playbackTracker)||void 0===e||e.onPlayRequested()}getMediaElement(){if(void 0!==this.client)return this.client.getPlayer()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}getCurrentTime(){if(void 0!==this.client&&void 0!==this.client.getCurrentTime)return this.client.getCurrentTime()}getDuration(){if(void 0!==this.client&&void 0!==this.client.getDuration)return this.client.getDuration()}cleanup(){void 0!==this.client&&void 0!==this.client.cleanUpMediaClient&&this.client.cleanUpMediaClient()}constructor(e,t,i,n,r,a,s,o){const l=void 0!==r.loggableId?r.loggableId:"",d=void 0!==r.mediaType?Kt.a[r.mediaType]:"Unknown";this.playbackTracker=new hi(n,l,d,s);try{this.client=function(e,t,i,n,r,a,s){return new fi(t,e,i,n,!1,!1,r,a,s)}(e,t,i,r,this.playbackTracker,a,o)}catch(e){Q.info(508650255,"Error creating local video client: "+e.message)}void 0!==r.contentType&&this.playbackTracker.setContentType(r.contentType),!0===r.useCustomControls&&this.playbackTracker.setIsUsingPlaybackControls()}}class gi{onNavigatedTo(){this.isOnSlide?g.a.sendTraceTag(507004112,_.a.msoulscat_Wac_PptSession,S.a.Error,`Already on slide with local media (name: ${this.mediaName})`):(this.isOnSlide=!0,this.summary.timeOfNavigatedTo=Date.now(),this.summary.timeOfNavigatingFrom=void 0,gi.sendNavigatedTo&&(gi.sendNavigatedTo=!1,g.a.sendTraceTag(507004111,_.a.msoulscat_Wac_PptSession,S.a.Info,`Navigated to a slide with local media (name: ${this.mediaName})`)))}onNavigatingFrom(e){this.isOnSlide?e?(this.isOnSlide=!1,this.summary.timeOfNavigatingFrom=Date.now(),g.a.sendTraceTag(508355554,_.a.msoulscat_Wac_PptSession,S.a.Info,"NavigatingFrom "+JSON.stringify({...this.summary,...e})),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0):g.a.sendTraceTag(507004109,_.a.msoulscat_Wac_PptSession,S.a.Error,`No local video playback data was collected for local media (name: ${this.mediaName})`):g.a.sendTraceTag(507004110,_.a.msoulscat_Wac_PptSession,S.a.Error,`Not on slide with local media (name: ${this.mediaName}) yet`)}onSourceSet(e){const t=new URL(e).searchParams.get("docId");null!==t&&G.ChangeGate.isChangeGateEnabled("SVM.LogDocIdHash")&&(this.summary.docIdHash=Bt(t).toString()),this.m_onSetSource(e)}setInClickSequence(){this.summary.isInClickSequence=!0,g.a.sendTraceTag(507004107,_.a.msoulscat_Wac_PptSession,S.a.Info,`Playback started through animation for local media (name: ${this.mediaName})`)}setDocIdHash(e){this.summary.docIdHash=e}setHlsBandwidthEstimate(e){this.summary.hlsBandwidthEstimate=e}setHlsAndTranscoding(e,t){e&&t&&void 0===this.summary.timeOfHlsTranscoding?this.summary.timeOfHlsTranscoding=Date.now():e&&!t&&void 0===this.summary.timeOfHlsRaw?this.summary.timeOfHlsRaw=Date.now():e||t||void 0!==this.summary.timeOfProgressiveRaw||(this.summary.timeOfProgressiveRaw=Date.now())}constructor(e,t,i,n,r,a){this.isOnSlide=!1,this.mediaName=e.name,this.m_onSetSource=n,this.summary={isAutoPlay:e.autoPlay||void 0,slideNumber:t.viewDataManager.getSlideIndex(i),startFromTime:t.settings.startFromTime,fullscreen:e.fullscreen,hideWhenStopped:e.hideWhenStopped,playAcrossSlides:e.playAcrossSlides,isSVG:F.a.readBooleanOrDefault("forceSvg",!1),isPrefetch:r,isNarration:e.narration,navigationCount:0,isTeams:je(t),isTeamsWeb:$e(t),teamsCallId:t.settings.teamsCallId,isWebGL:a}}}gi.sendNavigatedTo=!0;class _i{onNavigatedTo(){this.isOnSlide?g.a.sendTraceTag(507004160,_.a.msoulscat_Wac_PptSession,S.a.Error,`Already on slide with online video (name: ${this.mediaName})`):(this.isOnSlide=!0,this.summary.timeOfNavigatedTo=Date.now(),this.summary.timeOfNavigatingFrom=void 0,_i.sendNavigatedTo&&(_i.sendNavigatedTo=!1,g.a.sendTraceTag(507004131,_.a.msoulscat_Wac_PptSession,S.a.Info,`Navigated to a slide with an online video (name: ${this.mediaName})`)))}onNavigatingFrom(e){this.isOnSlide?e?(this.isOnSlide=!1,this.summary.timeOfNavigatingFrom=Date.now(),g.a.sendTraceTag(508348002,_.a.msoulscat_Wac_PptSession,S.a.Info,"NavigatingFrom "+JSON.stringify({...this.summary,...e})),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0,this.summary.wasMediaSyncedOnReady=void 0):g.a.sendTraceTag(507004129,_.a.msoulscat_Wac_PptSession,S.a.Error,`No online video performance data was collected (name: ${this.mediaName})`):g.a.sendTraceTag(507004130,_.a.msoulscat_Wac_PptSession,S.a.Error,`Not on slide with online video (name: ${this.mediaName}) yet`)}setInClickSequence(){this.summary.isInClickSequence=!0,g.a.sendTraceTag(507004128,_.a.msoulscat_Wac_PptSession,S.a.Info,`Online video playback started through animation (name: ${this.mediaName})`)}setMediaSyncedOnReady(){this.summary.wasMediaSyncedOnReady=!0,g.a.sendTraceTag(507004127,_.a.msoulscat_Wac_PptSession,S.a.Info,`Online video synced to Media Sync state on ready (name: ${this.mediaName})`)}constructor(e,t,i){this.isOnSlide=!1,this.mediaName=e.name,this.summary={slideNumber:t.viewDataManager.getSlideIndex(i),isAutoPlay:e.autoPlay||void 0,isTeams:je(t)||void 0,isTeamsWeb:$e(t)||void 0,teamsCallId:t.settings.teamsCallId,navigationCount:0}}}_i.sendNavigatedTo=!0;class Si{beforeFirstRender(){if(this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!1),this.m_fChangingSlide=!0,this.m_localMediaInfo&&this.m_localMediaInfo.el){const e=this.m_localMediaInfo.el;this.m_localMediaInfo.fMutedInFile||(e.muted=!1),this.addCaptionTracks(this.m_localMediaInfo.el),g.a.sendTraceTag(507003848,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement: Local video muted: "+e.muted);const t=this.useLoadedMetadataAsInteractivityEvent();this.verifyPlatfromSpecificReadyState(this.m_localMediaInfo)?this.onPlayerReadyCallBack():e.addEventListener(t?"loadedmetadata":"canplay",()=>{this.onPlayerReadyCallBack()},{once:!0}),this.shouldRenderToCanvas&&(this.m_localMediaInfo.el.style.opacity="0",this.m_localMediaInfo.el.controls=!1),this.usePlaybackControls()&&(this.m_localMediaInfo.el.controls=!1,this.isCaptionsEnabled()&&this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer.stopCaptionTrack())}}shouldCleanupLocalPlayerOnNavigatedFrom(){return!(!F.a.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)&&this.m_media.autoPlay)}cleanupLocalPlayerOnNavigatedFrom(){this.m_localMediaPlayer&&this.m_localMediaPlayer.cleanup(),this.m_localMediaPlaybackSource?this.m_media.playAcrossSlides||this.m_localMediaPlaybackSource.cleanupPlayerOnNavigatedFrom():this.shouldCleanupLocalPlayerOnNavigatedFrom()&&!this.m_media.playAcrossSlides&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_localMediaInfo.mediaUrl&&(this.m_localMediaInfo.el.src&&g.a.sendTraceTag(507003847,_.a.msoulscat_Wac_PptSession,S.a.Info,"Cancelling media request requestGuid: "+this.m_requestGuid),G.ChangeGate.isChangeGateEnabled("SVM.DestroyHLSBeforeRemove")||(this.m_localMediaInfo.el.removeAttribute("src"),this.m_localMediaInfo.el.load()),this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0),this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsErrorCount=0,this.m_hlsAutoRecoverRetryCount=0,this.m_wasLoadStarted=!1,this.m_wasMetadataLoaded=!1,this.m_wasTranscodingRequested=!1,G.ChangeGate.isChangeGateEnabled("SVM.DestroyHLSBeforeRemove")&&(this.m_localMediaInfo.el.removeAttribute("src"),this.m_localMediaInfo.el.load()),g.a.sendTraceTag(507003846,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::cleanupLocalPlayerOnNavigatedFrom"))}cleanupOnlinePlayerOnNavigatedFrom(){this.m_localMediaInfo&&this.m_localMediaInfo.el||this.m_onlineVideoPlayer&&(g.a.sendTraceTag(507003845,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement::cleanupOnlinePlayerOnNavigatedFrom: ${this.m_media.name}.`),this.m_onlineVideoPlayer.cleanup())}resetLocalPlayerOnNavigatingTo(){this.m_localMediaPlaybackSource?this.m_media.playAcrossSlides||this.m_localMediaPlaybackSource.resetPlayerOnNavigatingTo():this.shouldCleanupLocalPlayerOnNavigatedFrom()&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_localMediaInfo.mediaUrl&&!this.m_localMediaInfo.el.src&&(this.m_localMediaInfo.retriesRemaining=this.m_initialRetryCount,G.ChangeGate.isChangeGateEnabled("SVM.ResetRetryTimeout")&&(this.m_localMediaInfo.retryTimeoutMs=F.a.readNumberOrDefault("mediaRetryInitialDelayMs",Si.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS)),this.setSourceAsync(this.m_localMediaInfo.el,this.m_localMediaInfo),g.a.sendTraceTag(507003844,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::resetLocalPlayerOnNavigatingTo"))}ensure(){this.m_shapeItem||this.init();const e={name:this.m_media.name,type:Kt.a[this.m_mediaType],contentType:this.m_media.contentType,fPlayable:this.isMediaPlayable(this.m_media.contentType),fAutoPlay:this.m_media.autoPlay,playAcrossSlides:this.m_media.playAcrossSlides,fullBleed:this.m_mediaType!==Kt.a.Video&&this.m_mediaType!==Kt.a.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fFullBleed):"undefined",looping:this.m_mediaType!==Kt.a.Video&&this.m_mediaType!==Kt.a.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fLooping):"undefined",muted:this.m_mediaType!==Kt.a.Video&&this.m_mediaType!==Kt.a.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fMutedInFile):"undefined"};this.shouldRenderToCanvas||!this.m_environment.settings.transparentCanvasForVideoEnabled||this.m_transparentShapeItem||(e.fTransparentCanvas=this.initTransparentShape());const t={mediaInfo:e};if(!this.m_shapeItem)return g.a.sendTraceTag(507003843,_.a.msoulscat_Wac_PptSession,S.a.Error,"MediaViewElement::ensure: invalid shapeItem."),t.invalidShape=!0,t;const i=$.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return{...t,...i}}init(){if(this.animatableContentViewElements=[],this.m_shapeItem=$.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),Q={info:(e,t)=>{g.a.sendTraceTag(e,_.a.msoulscat_Wac_PptSession,S.a.Info,t)},warn:(e,t)=>{g.a.sendTraceTag(e,_.a.msoulscat_Wac_PptSession,S.a.Warning,t)},error:(e,t)=>{g.a.sendTraceTag(e,_.a.msoulscat_Wac_PptSession,S.a.Error,t)}},this.m_mediaType!==Kt.a.Audio&&this.m_mediaType!==Kt.a.Video||!this.m_shapeItem)this.initLinkedMediaInfo();else if(this.initLocalMediaInfo(),this.m_localMediaInfo&&F.a.readBooleanOrDefault("forceSvg",!1)){const e=this.m_environment.rendererEnvironment.renderer;this.m_shapeItem.getType()===T.g.group?e.attachCustomHTMLToShape(this.m_localMediaInfo.el,this.m_shapeItem.items.getAt(0)):e.attachCustomHTMLToShape(this.m_localMediaInfo.el,this.m_shapeItem)}}initTransparentShape(){return!!this.isUnderlayElements()&&!!this.isMediaPlayable(this.m_media.contentType)&&(this.m_transparentShapeItem=T.j.CreateRectangle(new m.d(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaPosition.x+this.m_mediaSize.x,this.m_mediaPosition.y+this.m_mediaSize.y),new y.x(new y.v(y.d.White),void 0,void 0,y.a.cutout)),!0)}setAlphaInvariant(){if(this.m_shapeItem&&this.m_shapeItem instanceof T.j){const e=this.m_shapeItem;e.style.pictureBrush&&(e.style.pictureBrush.isAlphaInvariant=!0,g.a.sendTraceTag(507003842,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::setAlphaInvariant: Successfully set isAlphaInvariant"))}}isUnderlayElements(){return this.m_mediaType===Kt.a.Video&&!this.shouldRenderToCanvas||this.m_mediaType===Kt.a.YouTube||this.m_mediaType===Kt.a.StreamClassic||this.m_mediaType===Kt.a.Vimeo||this.m_mediaType===Kt.a.Flip||this.m_mediaType===Kt.a.Ted||this.m_mediaType===Kt.a.Stream2}get shouldRenderToCanvas(){return this.m_shouldRenderToCanvas}usePlaybackControls(){return this.m_mediaType===Kt.a.Video&&""!==ci.getCssPath(this.m_environment)}static isVideoCroppedToShape(e){return!(!e.paths||0===e.paths.length||1===e.paths.length&&e.paths[0].isUntransformedRect)}isVideoCropped(e){var t;if(!e.style.pictureBrush)return!1;if(1!==e.style.pictureBrush.scale.x||1!==e.style.pictureBrush.scale.y||0!==e.style.pictureBrush.offset.x||0!==e.style.pictureBrush.offset.y)return!0;const i=null===(t=this.m_shapeViewData.shapeBuilderData)||void 0===t?void 0:t.style.pctBrush;return!!i&&!!(i.cs&&1!==i.cs.x&&0!==i.cs.x||i.cs&&1!==i.cs.y&&0!==i.cs.y||i.co&&0!==i.co.x||i.co&&0!==i.co.y)&&(this.m_fCropForCanvasRender=!0,!0)}static isVideoRotated(e){return!(!e.transform||!e.transform.rotation||0===e.transform.rotation)}shouldRenderLocalVideoToCanvas(e){if(!e)return!1;if(e instanceof T.j){const t=e,i=this.isVideoCropped(t),n=Si.isVideoCroppedToShape(t),r=Si.isVideoRotated(t);if(g.a.sendTraceTag(507003841,_.a.msoulscat_Wac_PptSession,S.a.Info,`Media:${this.m_media.name} has crop:${i}, crop-to-shape:${n}, outline:${t.style.lineBrush}, rotation:${r}, effects:${t.effects.hasEffects}. Rendering canvas: ${this.m_environment.rendererEnvironment}.`),t.effects.hasEffects&&g.a.sendTraceTag(507003840,_.a.msoulscat_Wac_PptSession,S.a.Info,`Media has effects applied. Glow:${void 0!==t.effects.glow}, Shadow:${t.effects.shadow}, InnerShadow:${void 0!==t.effects.innerShadow}, Reflection:${t.effects.reflection}, SoftEdges:${t.effects.softEdges}. Rendering canvas: ${this.m_environment.rendererEnvironment}.`),i||n||t.style.lineBrush||r)return!0}return e.effects.hasEffects}removeEffects(e){e.effects.hasEffects&&(e.effects.shadow=void 0,e.effects.innerShadow=void 0,e.effects.reflection=void 0,e.effects.softEdges=void 0,e.effects.glow=void 0,this.isVideoCropped(e)||Si.isVideoCroppedToShape(e)||(e.paths=void 0,e.clearPathCache()),g.a.sendTraceTag(507003811,_.a.msoulscat_Wac_PptSession,S.a.Info,`removeEffects: media = ${this.m_media.name}. shouldRenderToCanvas = ${this.m_shouldRenderToCanvas}`))}isPlaying(){const e=this.getMediaCurrentState();return void 0===e&&g.a.sendTraceTag(507003810,_.a.msoulscat_Wac_PptSession,S.a.Info,"isPlaying: mediaState is undefined"),void 0!==e&&e.playerState===c.MediaPlayed}shouldUpdateMediaOnCanvas(){return this.shouldRenderToCanvas&&(this.isPlaying()||this.m_hasPendingRender)}update(){this.m_mediaType===Kt.a.Audio||this.m_mediaType===Kt.a.Video?this.updateLocalMediaElement():this.updateLinkedMediaElement(),this.shouldUpdateMediaOnCanvas()&&this.renderFrame()}renderFrame(){if(!this.m_fIsPlayerReady)return void g.a.sendTraceTag(507003809,_.a.msoulscat_Wac_PptSession,S.a.Info,"renderFrame called while m_fIsPlayerReady = "+this.m_fIsPlayerReady);this.m_hasPendingRender=!1;const e=this.m_environment.rendererEnvironment.glContext;if(!this.m_localMediaInfo||!this.m_localMediaInfo.el||!e||e.isContextLost())return void(this.m_fLogCanvasRenderError&&(g.a.sendTraceTag(507003808,_.a.msoulscat_Wac_PptSession,S.a.Error,`MediaViewElement::renderFrame: Unable to draw video frame. m_localMediaInfo: ${!!this.m_localMediaInfo}.\n          m_localMediaInfo.el: ${this.m_localMediaInfo?!!this.m_localMediaInfo.el:""}.\n          gl: ${!!e}.\n          isContextLost: ${e?e.isContextLost():""}`),J.e.recordVeto("RenderToCanvasFailure",{errorName:"RenderingContextLost",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1));try{this.m_videoTexture=O.c.CreateOrUpdateFromHTMLElement("video",this.m_videoTexture,this.m_environment.rendererEnvironment.renderer,this.m_localMediaInfo.el),this.m_logCanvasInfo&&(g.a.sendTraceTag(507003807,_.a.msoulscat_Wac_PptSession,S.a.Info,"CreateOrUpdateFromHTMLElement succeeded for media: "+this.m_media.name),this.m_logCanvasInfo=!1)}catch(e){return void(this.m_fLogCanvasRenderError&&(g.a.sendTraceTag(507003806,_.a.msoulscat_Wac_PptSession,S.a.Error,`MediaViewElement::renderFrame: Unable to draw video frame. CreateOrUpdateFromHTMLElement threw an exception: ${e} for media: ${this.m_media.name}.`),J.e.recordVeto("RenderToCanvasFailure",{errorName:"CreateOrUpdateFromHTMLElementException",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1))}if(!this.m_shapeItem)return void(this.m_fLogCanvasRenderError&&(g.a.sendTraceTag(507003805,_.a.msoulscat_Wac_PptSession,S.a.Error,"MediaViewElement::renderFrame: Unable to draw video frame. ShapeItem:"+!!this.m_shapeItem),J.e.recordVeto("RenderToCanvasFailure",{errorName:"MissingShapeItem",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1));const t=this.m_shapeItem;if(t.style.pictureBrush&&this.m_fCropForCanvasRender){if(!this.m_shapeViewData.shapeBuilderData)throw new Error("shapeBuilderData is null");const e=this.m_shapeViewData.shapeBuilderData.style.pctBrush;t.style.pictureBrush.scale=new m.f(e.cs.x,e.cs.y),t.style.pictureBrush.offset=new m.f(e.co.x,e.co.y)}for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_videoTexture),this.m_videoTexture.changeTracker.notifyChange());this.m_frameTracker&&this.m_frameTracker.updateRenderFrameCount()}applyAnimation(e,t){if(this.m_shapeItem){for(const t of e.Attributes)if(t.AttrId!==v.c.Visible&&t.AttrId!==v.c.MediaPlaybackCmd)return;if(!this.m_fChangingSlide){const i=v.b.getAnimAttributeValue(e.Attributes,v.c.MediaPlaybackCmd,null);if(null!=i){const e=F.a.readNumberOrDefault("minMediaAnimationSpacing",200),n=Date.now()-this.m_lastAnimTimeMS;if(n<e)g.a.sendTraceTag(507003804,_.a.msoulscat_Wac_PptSession,S.a.Info,`Skipping animation command as it's been less than minMediaAnimationSpacing: ${e}(ms), actual: ${n}(ms), mediaCmd: ${i.mediaCmd}`);else{this.m_lastAnimTimeMS=Date.now();const e=!(this.m_localMediaInfo&&this.m_localMediaInfo.el||!this.m_onlineVideoPlayer);if(g.a.sendTraceTag(507003803,_.a.msoulscat_Wac_PptSession,S.a.Info,`Animation media cmd: ${i.mediaCmd}; Online: ${e}`),-1!==i.mediaCmd.toLowerCase().indexOf("play")){let e=Ke.parseSeekTimeFromMediaCommandString(i.mediaCmd,this.m_media.bmkLst?this.m_media.bmkLst:[]);if(-1===e)this.m_lastAnimTimeMS=0,g.a.sendTraceTag(507003802,_.a.msoulscat_Wac_PptSession,S.a.Warning,`Not able to parse time from media cmd : ${i.mediaCmd}.`);else{if(this.shouldSkipAnimation(t))return;this.m_firstPlayAnimation=!1,this.m_media.trimStartMs>0&&(e+=this.m_media.trimStartMs/1e3),this.seekMedia(e),this.playMedia(),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setInClickSequence(),this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.setInClickSequence(),this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.setInClickSequence()}}else-1!==i.mediaCmd.toLowerCase().indexOf("togglepause")?this.togglePauseMedia():-1!==i.mediaCmd.toLowerCase().indexOf("stop")?this.stopMedia():(this.m_lastAnimTimeMS=0,g.a.sendTraceTag(507003801,_.a.msoulscat_Wac_PptSession,S.a.Warning,`Unsupported animation media command : ${i.mediaCmd}.`))}}}$.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData),this.m_mediaType===Kt.a.Audio&&this.m_media&&this.m_media.hideWhenStopped&&this.shapeItem&&(this.shapeItem.isHidden=!0)}}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem),this.m_transparentShapeItem&&e.items.push(this.m_transparentShapeItem)}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&$.removeFromScene(e,this.m_shapeItem),this.m_transparentShapeItem&&-1!==e.items.elements.indexOf(this.m_transparentShapeItem)&&$.removeFromScene(e,this.m_transparentShapeItem)}playMedia(){this.restorePreviousMuteState(),this.muteAllPlayingMediaiOS(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(g.a.sendTraceTag(507003799,_.a.msoulscat_Wac_PptSession,S.a.Info,`Playing media for received event, from host. media: ${this.m_media.name}.`),this.playLocalMedia()):this.m_onlineVideoPlayer&&(g.a.sendTraceTag(507003800,_.a.msoulscat_Wac_PptSession,S.a.Info,`Playing online media for received event, from host. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.playMedia())}playLocalMedia(){if(!this.m_localMediaInfo||!this.m_localMediaInfo.el)return;const e=this.playHelper(this.m_localMediaInfo);void 0!==e&&e.then(()=>{g.a.sendTraceTag(507003798,_.a.msoulscat_Wac_PptSession,S.a.Info,`Local media playback started for media: ${this.m_media.name}.`)}).catch(e=>{g.a.sendTraceTag(507003797,_.a.msoulscat_Wac_PptSession,S.a.Error,`Local media playback failed to start for media: ${this.m_media.name}, error: ${e.name}, isTeams: ${je(this.m_environment)}, isTeamsWeb: ${$e(this.m_environment)}.`),"NotAllowedError"===e.name&&$e(this.m_environment)?this.playLocalMediaMuted():J.e.recordVeto("MediaPlaybackFailure",{qosVeto:"MediaPlaybackFailure",errorName:"MediaPlayPromiseFailed_"+e.name,media:this.m_media.name,msg:e.message})})}playLocalMediaMuted(){this.m_localMediaInfo&&this.m_localMediaInfo.el&&(g.a.sendTraceTag(507003796,_.a.msoulscat_Wac_PptSession,S.a.Info,`Starting local media playback muted: ${this.m_media.name}.`),this.m_localMediaInfo.el.muted=!0,this.playHelper(this.m_localMediaInfo))}pauseMedia(){this.restorePreviousMuteState(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(g.a.sendTraceTag(507003794,_.a.msoulscat_Wac_PptSession,S.a.Info,`Pausing media for received event, from host. media: ${this.m_media.name}.`),this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&(g.a.sendTraceTag(507003795,_.a.msoulscat_Wac_PptSession,S.a.Info,`Pausing online media for received event, from host. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.pauseMedia())}togglePauseMedia(){this.restorePreviousMuteState(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(g.a.sendTraceTag(507003792,_.a.msoulscat_Wac_PptSession,S.a.Info,`Toggle pausing media. media: ${this.m_media.name}.`),this.m_localMediaInfo.el.paused?(this.muteAllPlayingMediaiOS(),this.playHelper(this.m_localMediaInfo)):this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&(g.a.sendTraceTag(507003793,_.a.msoulscat_Wac_PptSession,S.a.Info,`Toggle pause online media. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.isPaused()&&this.muteAllPlayingMediaiOS(),this.m_onlineVideoPlayer.togglePauseMedia())}syncOnlineVideoPoster(e){(e.origin.isFromLocalCache||e.origin.isFromRoleChange)&&(e.origin.isInitial?e.state.playerState===c.MediaPaused&&this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.showPoster():this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.hidePoster())}updateMediaState(e){if(this.m_fHasOnlineVideoPlayButtonBeenClicked&&(!this.m_fIsPlayerReady||e.origin.isFromLocalCache))return void et("Blocking - Preserving pending play command for online video is executed before syncing state to presenter","MediaViewElement",e);if(this.m_fIsPlayerReady&&(this.m_fHasMediaBeenSynced=!0),this.m_mediaSyncLock&&this.m_mediaSyncLock.updateLastTimeRecievedEvent(),this.m_fIsPlayerReady&&(this.m_onlineVideoPlayer?this.syncOnlineVideoPoster(e):F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===Kt.a.Video&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&(e.origin.isFromLocalCache||e.origin.isFromRoleChange)&&(e.origin.isInitial?e.state.playerState===c.MediaPaused&&(this.setCustomPlayButtonVisible(),this.usePlaybackControls()||this.m_media.autoPlay||this.m_localMediaInfo.fLooping||(this.m_localMediaInfo.el.controls=!1)):(this.m_fHasCustomPlayButtonBeenSynced=!0,this.setCustomPlayButtonHidden(),this.usePlaybackControls()||this.m_media.autoPlay||this.m_localMediaInfo.fLooping||(this.m_localMediaInfo.el.controls=!0)))),!this.shouldSyncMediaEnded(e))return void et("Blocking - Media Sync Message Originated from MediaEnded Event","MediaViewElement",e);if(this.shouldSyncMediaVolumeChanged(e)){const t=this.m_environment.isGlobalMute;if(t||this.m_fMuteSyncDisabled||(void 0!==e.state.volume&&this.setMediaVolume(e.state.volume),void 0!==e.state.muted&&this.setMediaMute(e.state.muted)),!e.origin.isFromLocalCache&&!e.origin.isFromRoleChange&&!e.origin.isFromStateServiceCache)return void et(`Only Attempted to Sync Mute/Volume State (globalMuteOverride: ${t}, fMuteSyncDisabled: ${this.m_fMuteSyncDisabled})`,"MediaViewElement",e)}const t=.001*e.state.playerPositionSkew;void 0!==e.state.position&&this.seekMedia(e.state.position+t),this.syncPlayerState(e.state.playerState),et("Media Sync Attempt Finished","MediaViewElement",e)}updateVideoPlayButtonVisibility(e){if(F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&F.a.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&(this.m_environment.settings.showCustomPlayButtonForVideo=e,this.m_mediaType===Kt.a.Video&&!this.m_media.autoPlay&&this.m_localMediaInfo&&this.m_localMediaInfo.el)){const t=this.isCustomPlayButtonVisible();!e&&t?this.setCustomPlayButtonHidden():!e||t||this.isPlaying()||(this.setCustomPlayButtonVisible(),this.m_localMediaInfo.el.controls=!1)}}syncPlayerState(e){if(void 0!==e)switch(e){case c.MediaPlayed:this.playMedia();break;case c.MediaPaused:this.pauseMedia();break;case c.MediaEnded:break;default:g.a.sendTraceTag(507003791,_.a.msoulscat_Wac_PptSession,S.a.Info,`Unexpected player state when updating media state ${this.m_media.name}, ${this.m_mediaType}, ${e}.`)}}initAfterSlideContentChanged(){const e=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2",t=$.ensureShapeViewElementParentDiv(this.id,e,this.m_media&&this.m_media.playAcrossSlides>0);if(this.m_localMediaInfo&&this.m_localMediaInfo.el){if((this.usePlaybackControls()||this.shouldRenderToCanvas)&&this.ensureVideoEventsDiv(t),F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&F.a.readBooleanOrDefault("forceSVG",!1)&&this.m_mediaType===Kt.a.Video&&!this.m_playButtonHandler){const e=this.getBounds(),i=this.createCustomPlayButton(t,e);this.m_playButtonHandler=new ai(i,this.m_isNotAllowedError),this.m_media.autoPlay||!1===this.m_environment.settings.showCustomPlayButtonForVideo||this.isPlaying()?this.setCustomPlayButtonHidden():this.setCustomPlayButtonVisible()}this.beforeFirstRender()}}seekMedia(e){this.m_localMediaInfo&&this.m_localMediaInfo.el?(g.a.sendTraceTag(507003789,_.a.msoulscat_Wac_PptSession,S.a.Info,`Seek media for received event, from host. media: ${this.m_media.name} at position: ${e}.`),this.setCurrentTime(this.m_localMediaInfo,e)):this.m_onlineVideoPlayer&&(this.m_onlineVideoPlayer.seekMedia(e),g.a.sendTraceTag(507003790,_.a.msoulscat_Wac_PptSession,S.a.Info,`Seek online media for received event, from host. media: ${this.m_media.name} at position: ${e}.`))}async setSourceAsync(e,t){if(this.m_localMediaPlaybackSource)return void g.a.sendTraceTag(507003788,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected setSourceAsync with LocalMediaPlaybackSource");const i=this.generateMediaSrcUrl(t.mediaUrl,t.retriesRemaining);if(this.isMediaPlayable(this.m_media.contentType)){try{this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onSourceSet(i),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onSourceSet(i)}catch(e){g.a.sendTraceTag(507003787,_.a.msoulscat_Wac_PptSession,S.a.Error,"Exception in LocalVideoPlaybackSummary.onSourceSet: "+e)}if(g.a.sendTraceTag(507003786,_.a.msoulscat_Wac_PptSession,S.a.Info,`Creating media request requestGuid: ${this.m_requestGuid}, retriesRemaining: ${t.retriesRemaining}`),this.m_localMediaPlaybackController){const e=new URL(i);this.m_localMediaPlaybackController.onSourceSet(this.m_requestGuid,t.retriesRemaining,Si.getMediaLengthFromMediaUrl(e),this.m_isTranscoded)}if(!await this.setHlsSourceAsync(i,e)){this.m_hlsError=!1,this.m_wasLoadStarted=!1;const n=new URL(i);if(G.ChangeGate.isChangeGateEnabled("SVM.DisableProgressiveTranscoding")&&this.m_isTranscoded){if(!this.isPlayable())return g.a.sendTraceTag(507003785,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement::setSourceAsync setHlsSource failed for unplayable media, mediaName: ${this.m_media.name}, retrying.`),this.m_hlsError=!0,void this.onMediaError(t);n.searchParams.delete("transcode"),this.m_isTranscoded=!1,this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setIsTranscoding(!1),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setMediaQuality(Me.Raw)}e.src=n.toString()}}}async setHlsSourceAsync(e,t){this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsAutoRecoverRetryCount=0,this.setHlsBandwidthEstimatesForTelemetry(void 0),this.setIsHlsForTelemetry(!1);const i=!G.ChangeGate.isChangeGateEnabled("SVM.UnplayableUsesHLS")||this.isPlayable(),n=this.m_hlsErrorCount>=this.getHLSRetryCount();if(i&&n)return!1;if(this.m_mediaType!==Kt.a.Video)return!1;if(!this.isMediaDownloadHandlerEnabled(e))return!1;if(-1!==e.indexOf("disableHLS"))return g.a.sendTraceTag(507003784,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::generateMediaSrcUrl disable HLS for mediaName: "+this.m_media.name),!1;if(!this.isMP4()&&!this.m_isTranscoded)return g.a.sendTraceTag(507003783,_.a.msoulscat_Wac_PptSession,S.a.Error,"MediaViewElement::setHlsSourceAsync Tried using HLS+Raw for non-MP4 file, mediaName: "+this.m_media.name),!1;let r=e;if(this.m_isTranscoded&&!Ye(this.m_environment)){const e=new URL(r);e.searchParams.set("transcode","All"),r=e.toString()}if(F.a.readBooleanOrDefault("initializeHLSJsFirst",!1)){if(await this.tryImportHLSJsInstance()&&(this.tryInitializeHLSJs(),g.a.sendTraceTag(507003782,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::setHlsSourceAsync() HLS js initialized successfully")),void 0===this.m_hls&&this.setNativeHlsSource(r,t))return g.a.sendTraceTag(507003781,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::setHlsSourceAsync() Native HLS set successfully"),!0}else{if(this.setNativeHlsSource(r,t))return!0;await this.tryImportHLSJsInstance()&&this.tryInitializeHLSJs()}const a=ke[Ge(this.m_environment)];return this.m_hls?(g.a.sendTraceTag(507003780,_.a.msoulscat_Wac_PptSession,S.a.Info,`HLS mediaName: ${this.m_media.name} requestGuid: ${this.m_requestGuid} uiHostType: ${a}`),this.m_wasLoadStarted=!1,this.m_hls.loadSource(this.getHLSUrlWithSlashes(r)),this.m_hls.attachMedia(t),this.setIsHlsForTelemetry(!0),!0):(g.a.sendTraceTag(507003779,_.a.msoulscat_Wac_PptSession,S.a.Info,"HLS is not supported: "+a),!1)}isMP4(){return"video/mp4"===this.m_media.contentType}isPlayable(){return this.getMediaRenderAs(this.m_media.contentType)!==xe.None}getHLSRetryCount(){return this.isMP4()&&this.m_wasTranscodingRequested?2:1}async tryImportHLSJsInstance(){try{Si.m_hlsJs=await i.e(0).then(i.bind(null,431))}catch(e){g.a.sendTraceTag(507003778,_.a.msoulscat_Wac_PptSession,S.a.Error,"Exception importing hls.js: "+e)}return!!Si.m_hlsJs}tryInitializeHLSJs(){if(Si.m_hlsJs&&g.a.sendTraceTag(507003777,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement::tryInitializeHLSJs(): HLS.js supported for uiHostType ${ke[Ge(this.m_environment)]}: ${Si.m_hlsJs.default.isSupported()}`),Si.m_hlsJs&&!this.m_hls&&Si.m_hlsJs.default.isSupported()){const e=Ye(this.m_environment)?F.a.readNumberOrDefault("hlsBackBufferLengthMobile",1/0):F.a.readNumberOrDefault("hlsBackBufferLength",1/0),t=!G.ChangeGate.isChangeGateEnabled("SVM.DisableHLSProgressiveStream");this.m_hls=new Si.m_hlsJs.default({progressive:t,backBufferLength:e}),this.m_hls.on(Si.m_hlsJs.default.Events.MANIFEST_LOADED,e=>{this.m_hlsJsManifestLoaded=!0}),this.m_hls.on(Si.m_hlsJs.default.Events.FRAG_BUFFERED,e=>{this.m_hls&&this.setHlsBandwidthEstimatesForTelemetry(this.m_hls.bandwidthEstimate)}),this.m_hls.on(Si.m_hlsJs.default.Events.ERROR,(e,t)=>{const i=t.type,n=t.fatal;if(g.a.sendTraceTag(507003776,_.a.msoulscat_Wac_PptSession,S.a.Error,`HLS error: mediaName: ${this.m_media.name}, errorFatal: ${n}, errorType: ${i}, errorMessage: ${t.reason}, errorDetail: ${t.details}, uiHostType: ${ke[Ge(this.m_environment)]}.`),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.addHlsError(t.type,t.details),n){if(this.m_hlsJsManifestLoaded&&Si.m_hlsJs&&this.m_hls&&this.m_hlsAutoRecoverRetryCount<=F.a.readNumberOrDefault("maxHlsAutoRecoverRetryCount",2))switch(t.type){case Si.m_hlsJs.default.ErrorTypes.NETWORK_ERROR:return g.a.sendTraceTag(507003747,_.a.msoulscat_Wac_PptSession,S.a.Info,`HLS network error: mediaName: ${this.m_media.name}, autoRecoverRetryCount: ${this.m_hlsAutoRecoverRetryCount}.`),this.m_hls.startLoad(),void(this.m_hlsAutoRecoverRetryCount+=1);case Si.m_hlsJs.default.ErrorTypes.MEDIA_ERROR:return g.a.sendTraceTag(507003746,_.a.msoulscat_Wac_PptSession,S.a.Info,`HLS media error: mediaName: ${this.m_media.name}, autoRecoverRetryCount: ${this.m_hlsAutoRecoverRetryCount}.`),this.m_hls.recoverMediaError(),void(this.m_hlsAutoRecoverRetryCount+=1)}this.m_wasMetadataLoaded||(this.m_hlsError=!0,this.m_hlsErrorCount+=1),this.m_localMediaInfo&&this.onMediaError(this.m_localMediaInfo)}})}}setNativeHlsSource(e,t){if(t.canPlayType("application/vnd.apple.mpegurl"))try{let i=this.getHLSUrlWithSlashes(e);return Xe(this.m_environment)&&(i+="#t=0.1"),g.a.sendTraceTag(507003745,_.a.msoulscat_Wac_PptSession,S.a.Info,`Native HLS mediaName: ${this.m_media.name} requestGuid: ${this.m_requestGuid}`),this.m_wasLoadStarted=!1,t.src=i,this.setIsHlsForTelemetry(!0),!0}catch(e){g.a.sendTraceTag(507003744,_.a.msoulscat_Wac_PptSession,S.a.Error,`Exception in setting native hls video source: ${e}.`),this.m_hlsError=!0,this.m_hlsErrorCount=1/0}return!1}getHLSUrlWithSlashes(e){return e.replace(/[?&]/g,"/")+"/index.m3u8"}isMediaDownloadHandlerEnabled(e){return e.includes("MediaDownloadHandler")}resetCurrentTime(e){this.setCurrentTime(e,e.props.trimStartMs/1e3)}setCurrentTime(e,t){try{if(this.m_localMediaPlaybackController)return void this.m_localMediaPlaybackController.seek(t);e.el&&(g.a.sendTraceTag(507003743,_.a.msoulscat_Wac_PptSession,S.a.Info,`Changed the current position on media:${e.props.name} from ${e.el.currentTime} to ${t}`),e.el.currentTime=t)}catch(e){g.a.sendTraceTag(507003742,_.a.msoulscat_Wac_PptSession,S.a.Error,"Exception in setCurrentTime: "+e)}}stopMedia(){this.m_localMediaInfo&&this.m_localMediaInfo.el?(g.a.sendTraceTag(507003740,_.a.msoulscat_Wac_PptSession,S.a.Info,`Stop local media. media: ${this.m_media.name}.`),this.resetCurrentTime(this.m_localMediaInfo),this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&(g.a.sendTraceTag(507003741,_.a.msoulscat_Wac_PptSession,S.a.Info,`Stop online media. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.stopMedia())}setMediaVolume(e){this.enableVolumeSync()&&!this.m_fMuteSyncDisabled&&(e<0||(this.m_localMediaInfo&&this.m_localMediaInfo.el?(this.m_localMediaInfo.el.volume=e,g.a.sendTraceTag(507003739,_.a.msoulscat_Wac_PptSession,S.a.Info,`Set volume local media. media: ${this.m_media.name}. Volume: ${e}`)):this.m_onlineVideoPlayer&&(this.m_onlineVideoPlayer.setVolume(e),g.a.sendTraceTag(507003738,_.a.msoulscat_Wac_PptSession,S.a.Info,`Set volume online media. media: ${this.m_media.name}. Volume: ${e}`))))}setMediaMute(e){this.m_fMuteSyncDisabled||(this.m_localMediaInfo&&this.m_localMediaInfo.el?(this.m_localMediaInfo.el.muted=e,e?g.a.sendTraceTag(507003737,_.a.msoulscat_Wac_PptSession,S.a.Info,`Mute local media. media: ${this.m_media.name}.`):g.a.sendTraceTag(507003736,_.a.msoulscat_Wac_PptSession,S.a.Info,`Unmute local media. media: ${this.m_media.name}.`)):this.m_onlineVideoPlayer&&(e?(this.m_onlineVideoPlayer.setMute(),g.a.sendTraceTag(507003735,_.a.msoulscat_Wac_PptSession,S.a.Info,`Mute volume online media. media: ${this.m_media.name}.`)):(this.m_onlineVideoPlayer.setUnMute(),g.a.sendTraceTag(507003734,_.a.msoulscat_Wac_PptSession,S.a.Info,`Unmute volume online media. media: ${this.m_media.name}.`))))}getMediaName(){return this.m_media.name}getMediaInfo(){return{name:this.m_media.name,type:this.m_mediaType,isLoopingBackgroundVideo:void 0!==this.m_localMediaInfo&&this.isLoopingBackgroundVideo(this.m_localMediaInfo),isRenderedToCanvas:this.shouldRenderToCanvas,duration:this.getMediaDuration()}}getMediaDuration(){let e;return this.m_localMediaInfo&&this.m_localMediaInfo.el&&!isNaN(this.m_localMediaInfo.el.duration)?e=this.m_localMediaInfo.el.duration:this.m_onlineVideoPlayer&&(e=this.m_onlineVideoPlayer.getDuration()),e||g.a.sendTraceTag(507003733,_.a.msoulscat_Wac_PptSession,S.a.Info,"getMediaDuration: Unable to get duration for "+this.m_media.name),e}cleanUp(){const e=this.m_environment.rendererEnvironment.glContext;e&&!e.isContextLost()&&this.m_videoTexture&&(this.m_videoTexture.release(),this.m_environment.viewDataManager.memoryStats.videoTextures-=this.m_mediaSize.x*this.m_mediaSize.y*4),this.m_videoTexture=void 0;const t=this.m_shapeItem;this.m_fCropForCanvasRender&&t.style.pictureBrush&&(t.style.pictureBrush.scale=new m.f(1,1),t.style.pictureBrush.offset=new m.f(0,0)),this.m_localMediaEventsDiv&&this.m_localMediaEventsDiv.remove(),this.m_controls=void 0}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.settings.transparentCanvasForVideoEnabled&&this.m_transparentShapeItem&&(this.fPrepared=this.fPrepared&&this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_transparentShapeItem,!1,5)),this.m_environment.rendererEnvironment.flush()),this.fPrepared}getMediaRenderAs(e){return void 0===this.m_renderAs&&(this.m_renderAs=Ke.getMediaRenderAs(e)),this.m_renderAs}isMediaPlayable(e){if(!this.m_localMediaPlaybackSource&&this.m_isTranscoded)return!0;if(void 0!==this.m_fMediaPlayable)return this.m_fMediaPlayable;let t=xe.None;if(t=this.m_localMediaPlaybackSource?this.m_localMediaPlaybackSource.isUnplayable()?xe.None:xe.HTML5:this.getMediaRenderAs(e),t===xe.None){this.m_fMediaPlayable=!1,g.a.sendTraceTag(507003732,_.a.msoulscat_Wac_PptSession,S.a.Error,`Slide ${this.m_slideId.sid} shape ${this.id.shapeId} has media with unplayable contentType ${e}.`);const t={errorCode:0,mediaName:`${this.m_slideId.sid}s${this.id.shapeId}`,contentType:e,mediaType:Ke.getMediaTypeFromContentType(e)};g.a.sendTraceTag(570750435,_.a.msoulscat_Wac_PptSession,S.a.Info,"NavigatingFrom "+JSON.stringify(t)),J.e.recordVeto("MediaPlaybackFailed",{slideId:this.m_slideId.sid,shapeId:this.id.shapeId,contentType:e,mediaType:Ke.getMediaTypeFromContentType(e),errorName:"UnplayableContentType",mediaName:t.mediaName,qosVeto:"MediaPlaybackFailed",isIntentional:!0})}else this.m_fMediaPlayable=!0,g.a.sendTraceTag(507003731,_.a.msoulscat_Wac_PptSession,S.a.Info,`Slide ${this.m_slideId.sid} shape ${this.id.shapeId} has media with contentType ${e}, will play back via ${xe[t]}.`);return this.m_fMediaPlayable}isLoopingBackgroundVideo(e){return void 0!==this.m_isLoopingBackgroundVideo?this.m_isLoopingBackgroundVideo:!!e.el&&!isNaN(e.el.duration)&&(g.a.sendTraceTag(507003730,_.a.msoulscat_Wac_PptSession,S.a.Info,"Video duration: "+e.el.duration),this.m_mediaType===Kt.a.Video&&e.autoPlay&&e.fLooping&&e.fMutedInFile&&e.el.duration<15?(g.a.sendTraceTag(507003729,_.a.msoulscat_Wac_PptSession,S.a.Info,"Media is Looping Background Video: "+this.m_media.name),this.m_isLoopingBackgroundVideo=!0):this.m_isLoopingBackgroundVideo=!1,this.m_isLoopingBackgroundVideo)}isVideoPartiallyOffSlide(){return this.m_mediaPosition.x<0&&this.m_mediaPosition.x+this.m_mediaSize.x>0||this.m_mediaPosition.y<0&&this.m_mediaPosition.y+this.m_mediaSize.y>0||this.m_mediaPosition.x<this.m_slideSizePixels.x&&this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x||this.m_mediaPosition.y<this.m_slideSizePixels.y&&this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y}isFullSizeVideo(){return this.m_mediaType===Kt.a.Video&&(this.m_mediaSize.x>.95*this.m_slideSizePixels.x&&this.m_mediaSize.x<1.05*this.m_slideSizePixels.x&&this.m_mediaSize.y>.95*this.m_slideSizePixels.y&&this.m_mediaSize.y<1.05*this.m_slideSizePixels.y)}static getLocalizedString(){let e;return e="undefined"!=typeof PowerpointSlideshowStringsManager?{audioStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.AudioMediaElementLabel),videoStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.VideoMediaElementLabel)}:{audioStr:"Audio",videoStr:"Video"},e}getAdjustedBounds(){const e=this.getBounds();let t=e.left,i=e.right,n=e.top,r=e.bottom;return G.ChangeGate.isChangeGateEnabled("SVM.AdjustPlaybackControlBounds")&&(e.left<0&&e.right>0&&(t=0),e.top<0&&e.bottom>0&&(n=0),e.right>this.m_slideSizePixels.x&&e.left<this.m_slideSizePixels.x&&(i=this.m_slideSizePixels.x),e.bottom>this.m_slideSizePixels.y&&e.top<this.m_slideSizePixels.y&&(r=this.m_slideSizePixels.y)),new m.d(t,n,i,r)}onGfxControlsPlay(){this.playMedia(),!this.m_playbackControlCallbacks||G.ChangeGate.isChangeGateEnabled("SVM.disableLoopingCallbacks")&&this.m_isLoopingBackgroundVideo||this.m_playbackControlCallbacks.onPlayClick()}onGfxControlsPause(){this.pauseMedia(),!this.m_playbackControlCallbacks||G.ChangeGate.isChangeGateEnabled("SVM.disableLoopingCallbacks")&&this.m_isLoopingBackgroundVideo||this.m_playbackControlCallbacks.onPauseClick()}onGfxControlsSeek(e){this.seekMedia(e),this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onSeeked()}onGfxControlsVolumeChange(){this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onVolumeChanged()}onGfxControlsVolumeClick(){this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onVolumeClick()}isPresenter(){if(this.m_environment.rendererEnvironment.viewController.mediaCommandScope!==vn.None)return this.m_environment.rendererEnvironment.viewController.mediaCommandScope===vn.All}initPlaybackControls(e){if(this.m_playbackControlCallbacks||(this.m_playbackControlCallbacks=new di((e,t)=>this.sendMediaSyncEvent(e,t),e=>this.sendUserMediaActionEvent(e))),!this.m_controls){const t={playMediaCallback:()=>this.onGfxControlsPlay(),pauseMediaCallback:()=>this.onGfxControlsPause(),seekMediaCallback:e=>this.onGfxControlsSeek(e),muteUnmuteCallback:()=>this.onGfxControlsVolumeClick(),volumeChangedCallback:()=>this.onGfxControlsVolumeChange(),logVetoCallback:e=>tt(e),isPresenterCallback:()=>this.isPresenter()},i=this.m_localMediaInfo,n=ci.getMediaControlInfo(i,this.getAdjustedBounds(),this.m_environment);n.captionsEnabled=this.isCaptionsEnabled(),this.isCaptionsEnabled()&&(n.captionsRenderer=this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer),n.volumeSliderEnabled=this.isVolumeSliderEnabled(),n.speedEnabled=this.isSpeedEnabled(),n.fullscreenEnabled=this.isFullscreenEnabled(),n.nestedTabbingEnabled=this.isNestedTabbingEnabled(),this.isTooltipsEnabled()&&(n.tooltipMap=ci.getTooltipMap()),void 0!==this.m_localMediaInfo&&(n.playPauseOnly=this.isLoopingBackgroundVideo(this.m_localMediaInfo)),n.captionsPositioningStrategy=F.a.readNumberOrDefault("captionsPositioningStrategy",0),n.transferCaptionsFullScreen=G.ChangeGate.isChangeGateEnabled("SVM.transferCaptionsFullScreen"),this.m_controls=new Lt(e,n,t),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setPlaybackControlsFlag()}}sendUserMediaActionEvent(e){g.a.sendTraceTag(507003728,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement: Emitting User Media Action Event (actionType: ${e}, mediaName: ${this.m_media.name})`),this.m_slideEvents.emit("userMediaAction",{actionType:e,mediaName:this.m_media.name})}sendMediaSyncEvent(e,t){if(void 0!==t&&G.ChangeGate.isChangeGateEnabled("SVM.dontSendMediaSyncEventsFromUserMediaActions"))return;if(this.shouldSuppressMediaSyncEvent(e,this.m_localMediaInfo))return void g.a.sendTraceTag(507003727,_.a.msoulscat_Wac_PptSession,S.a.Info,`Media Sync event ${Si.getEventName(e)} for ${this.m_media.name} suppressed.`);let i,n,r;this.m_localMediaInfo&&this.m_localMediaInfo.el?(i=this.m_localMediaInfo.el.currentTime,n=this.m_localMediaInfo.el.volume,r=this.m_localMediaInfo.el.muted):this.m_onlineVideoPlayer&&(i=this.m_onlineVideoPlayer.getCurrentTime(),n=this.m_onlineVideoPlayer.getVolume(),r=this.m_onlineVideoPlayer.isMuted()),this.m_environment.isGlobalMute&&(r=void 0);const a={mediaName:this.m_media.name,isAutoPlay:this.m_media.autoPlay,event:{eventType:e,position:i||0,volume:n,muted:r},origin:{hostName:Kt.a[this.m_mediaType],actionType:t},correlationId:Object(ri.v4)()};Si.logMediaSyncEmission(a),this.m_slideEvents.emit(Si.getEventName(e),a)}isCropInSVGSupported(){return!!F.a.readBooleanOrDefault("forceSvg",!1)&&(!(!je(this.m_environment)&&!$e(this.m_environment))||F.a.readBooleanOrDefault("cropSupportInSVG",!1))}isCropInSVGEnabled(){return void 0!==this.m_fCropInSVG||(this.m_media.cropInfo&&this.isCropInSVGSupported()&&(0!==this.m_media.cropInfo.top||0!==this.m_media.cropInfo.left||1!==this.m_media.cropInfo.bottom||1!==this.m_media.cropInfo.right)?(this.m_fCropInSVG=!0,g.a.sendTraceTag(507003726,_.a.msoulscat_Wac_PptSession,S.a.Info,"Cropped media is rendered in SVG.")):this.m_fCropInSVG=!1),this.m_fCropInSVG}localMediaEventHandler(e){0===e?this.m_wasLoadStarted=!0:2===e&&this.m_localMediaInfo?this.onLoadedData(this.m_localMediaInfo):1===e&&this.m_localMediaInfo?Xe(this.m_environment)&&this.onLoadedMetaData(this.m_localMediaInfo):3===e&&this.m_localMediaInfo?Xe(this.m_environment)||this.onLoadedMetaData(this.m_localMediaInfo):4===e&&this.m_localMediaInfo?this.onPlay(this.m_localMediaInfo):5===e?this.onPlaying():6===e&&this.m_localMediaInfo?this.onPause(this.m_localMediaInfo):7===e&&this.m_localMediaInfo?this.onSeeked(this.m_localMediaInfo):9===e&&this.m_localMediaInfo?this.onTimeUpdate(this.m_localMediaInfo):11===e&&this.m_localMediaInfo?this.onEnded(this.m_localMediaInfo):10===e&&this.m_localMediaInfo?this.onVolumeChange(this.m_localMediaInfo):12===e&&this.m_localMediaInfo&&this.onMediaError(this.m_localMediaInfo)}initLocalMediaTelemetry(){this.m_localMediaPlaybackTelemetry=new gi(this.m_media,this.m_environment,this.m_slideId,e=>{if(this.m_localMediaPlayer){const t=new URL(e),i=t.searchParams.get("ext");if(null!==i)this.m_localMediaPlayer.setMediaExtension(i);else{const e=t.searchParams.get("mediaId");if(null!==e){const t=/^.+\.([^\.]+)\.media$/.exec(e);null!==t&&2===t.length&&this.m_localMediaPlayer.setMediaExtension(t[1])}}const n=t.searchParams.get("mediaLength");null!==n&&this.m_localMediaPlayer.setMediaLength(parseInt(n,10));const r=t.searchParams.get("retries");null!==r&&this.m_localMediaPlayer.setRetriesLeft(parseInt(r,10)),this.m_localMediaPlayer.onSourceSet()}},this.m_isPrefetch,this.shouldRenderToCanvas)}initLocalMediaInfo(){if(g.a.sendTraceTag(507003725,_.a.msoulscat_Wac_PptSession,S.a.Info,"Local video type: "+this.m_media.contentType),!this.isMediaPlayable(this.m_media.contentType))return;if(F.a.readBooleanOrDefault("disableOffSlideVideoInSVG",!1)&&this.isVideoPartiallyOffSlide()&&F.a.readBooleanOrDefault("forceSvg",!1)){const e={errorCode:-1,mediaName:`${this.m_slideId.sid}s${this.id.shapeId}`};return g.a.sendTraceTag(507003724,_.a.msoulscat_Wac_PptSession,S.a.Error,`Unable to render media on slide ${this.m_slideId.sid} shape ${this.id.shapeId}: off-slide media is rendered as image in SVG.`),g.a.sendTraceTag(570750435,_.a.msoulscat_Wac_PptSession,S.a.Info,"NavigatingFrom "+JSON.stringify(e)),void J.e.recordVeto("MediaPlaybackFailed",{slideId:this.m_slideId.sid,shapeId:this.id.shapeId,mediaName:e.mediaName,errorName:"MediaRenderedAsImage",qosVeto:"MediaPlaybackFailed",isIntentional:!0})}let e=`${this.m_environment.settings.serverUrl}${this.m_media.src.substring(1)}`;this.isMediaDownloadHandlerEnabled(this.m_media.src)&&(e=""+this.m_media.src);const t={elID:this.ShapeMediaTargetId,autoPlay:this.m_media.autoPlay,nativeWidth:this.m_mediaSize.x,nativeHeight:this.m_mediaSize.y,retriesRemaining:this.m_initialRetryCount,retryTimeoutMs:F.a.readNumberOrDefault("mediaRetryInitialDelayMs",Si.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS),numRepeatsRemaining:this.m_media.repeat,numRepeatsOriginal:this.m_media.repeat,fFullBleed:0===this.m_mediaPosition.x&&0===this.m_mediaPosition.y&&this.m_mediaSize.x===this.m_slideSizePixels.x&&this.m_mediaSize.y===this.m_slideSizePixels.y,fLooping:-1===this.m_media.repeat||this.m_media.repeat>1,fMutedInFile:0===this.m_media.volume,fReachedEnd:!1,fPositionInitialized:!1,fPendingPlay:!1,fPendingPause:!1,props:this.m_media,el:void 0,mediaUrl:decodeURIComponent(e)};let i;if(this.m_mediaType!==Kt.a.Audio&&this.m_mediaType!==Kt.a.Video)return void g.a.sendTraceTag(507003721,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::initLocalMediaInfo: It is not local media, skipping...");{t.props.ariaLabel=this.m_mediaType===Kt.a.Video?Si.getLocalizedString().videoStr:Si.getLocalizedString().audioStr;const e={mediaInfo:t,id:this.id,type:this.m_mediaType,size:this.getMediaSize(),position:this.m_mediaPosition,settings:this.m_environment.settings,isTeams:je(this.m_environment),uiHostType:ke[Ge(this.m_environment)],cropInfo:this.m_media.cropInfo,shouldRenderToCanvas:this.shouldRenderToCanvas,usePlaybackControls:this.usePlaybackControls(),isCropInSVGEnabled:this.isCropInSVGEnabled(),isHostIOS:Xe(this.m_environment),onMediaEventCallbacks:e=>this.localMediaEventHandler(e)};if(this.m_localMediaPlayer=function(e){const t=function(e){const t=e.isTeams;return{App:t?"Teams":"PowerPoint",AppPlatform:t?"Previewer":"WAC",AppCorrelation:e.settings.sessionId,AcceptLanguage:e.settings.acceptLanguage,hostComponent:t?"SlideshowApp":"Unified",hostView:t?"PowerPointLive":"Present"}}(e),i=function(e){const t=e.mediaInfo.props,i={trimStartSec:t.trimStartMs/1e3,trimEndSec:t.trimEndMs/1e3,volume:t.volume,mute:e.mediaInfo.fMutedInFile,repeat:e.mediaInfo.fLooping,rewind:!1,playAcrossSlides:t.playAcrossSlides>0,hideDuringShow:!1,startOption:"",trimmedEndTimeSec:void 0,durationSec:void 0,loggableId:t.name,elementId:e.mediaInfo.elID,mediaType:e.type,contentType:t.contentType,autoPlay:!1,crossOrigin:"anonymous",controls:!e.shouldRenderToCanvas&&!e.usePlaybackControls,useCustomControls:e.usePlaybackControls,handleTimeUpdate:t.trimEndMs>0,playsInline:!(e.type!==Kt.a.Video||!e.isHostIOS)||void 0,zIndex:e.settings.transparentCanvasForVideoEnabled&&e.type===Kt.a.Video&&!e.shouldRenderToCanvas?"0":"2",height:e.size.y,width:e.size.x,preload:e.isHostIOS?"metadata":"auto",styles:{pointerEvents:"auto",position:"absolute",objectFit:"fill",opacity:e.shouldRenderToCanvas?"0":void 0},attributes:{"aria-label":e.mediaInfo.props.ariaLabel,controlsList:"nodownload",disablePictureInPicture:"true"}};if(e.settings.transparentCanvasForVideoEnabled||F.a.readBooleanOrDefault("forceSvg",!1)||(i.zIndex="4"),i.styles){if(e.type===Kt.a.Video&&e.isCropInSVGEnabled&&t.cropInfo){i.styles.clipPath=`inset(${100*t.cropInfo.top}% ${100*(1-t.cropInfo.right)}% ${100*(1-t.cropInfo.bottom)}% ${100*t.cropInfo.left}%)`;const e=1/(t.cropInfo.right-t.cropInfo.left),n=1/(t.cropInfo.bottom-t.cropInfo.top);i.styles.transform=`translate(${(1-t.cropInfo.right-t.cropInfo.left)*e*100/2}%, ${(1-t.cropInfo.bottom-t.cropInfo.top)*n*100/2}%) scale(${e}, ${n})`}F.a.readBooleanOrDefault("forceSvg",!1)||(i.styles.left=e.position.x+"px",i.styles.top=e.position.y+"px"),e.type===Kt.a.Audio&&(i.styles.visibility=t.hideWhenStopped?"hidden":"visible",i.styles.width=e.size.x+"px",i.styles.height=e.size.y+"px",e.settings.editAudioEnabled&&(e.size.x<240&&(i.styles.width="240px"),e.size.y<30&&(i.styles.height="30px")))}return i.attributes&&e.type===Kt.a.Audio&&(i.attributes.role="link",i.attributes["aria-role"]="link"),i}(e),n=new pi(e.mediaInfo.mediaUrl,void 0,!1,t,i,e.onMediaEventCallbacks,t=>{g.a.sendTraceTag(507004181,_.a.msoulscat_Wac_PptSession,S.a.Error,"Local media sent veto: "+JSON.stringify({vetoName:t.vetoName,errorName:t.errorName,details:t.details,correlationId:t.correlationId,mediaType:Kt.a[e.type],mediaName:e.mediaInfo.props.name,uiHostType:e.uiHostType,teamsCallId:e.settings.teamsCallId}))});if(n){g.a.sendTraceTag(507004180,_.a.msoulscat_Wac_PptSession,S.a.Info,"Created LocalMediaPlayer.  Media name: "+e.mediaInfo.props.name);const t={hlsJsFirst:F.a.readBooleanOrDefault("initializeHLSJsFirst",!1),iOSPreload:F.a.readBooleanOrDefault("iOSHlsPreload",!0),cleanupHlsJs:F.a.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0),cleanupNativeHls:F.a.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)};n.setFlights(JSON.stringify(t)),n.setUiHostType(e.uiHostType),0===e.mediaInfo.props.volume?n.setMute():(!G.ChangeGate.isChangeGateEnabled("SVM.disableSetIOSVolumeMax")&&e.isHostIOS&&(e.mediaInfo.props.volume=1),n.setVolume(e.mediaInfo.props.volume))}else g.a.sendTraceTag(507004179,_.a.msoulscat_Wac_PptSession,S.a.Error,"Failed to create LocalMediaPlayer. Media name: "+e.mediaInfo.props.name);return n}(e),!this.m_localMediaPlayer||!this.m_localMediaPlayer.getMediaElement())return void g.a.sendTraceTag(507003723,_.a.msoulscat_Wac_PptSession,S.a.Error,`Failed to create LocalMediaPlayer for ${Kt.a[this.m_mediaType]} element:  ${this.m_media.name}`);if(i=this.m_localMediaPlayer.getMediaElement(),this.initLocalMediaTelemetry(),this.m_mediaType===Kt.a.Video&&!this.isCropInSVGEnabled()){const e=this.getVideoPosterFrameUri();e?i.poster=e:g.a.sendTraceTag(507003722,_.a.msoulscat_Wac_PptSession,S.a.Error,"Failed to find local video poster frame")}}if(void 0===this.m_localMediaPlaybackPerf&&(G.ChangeGate.isChangeGateEnabled("SVM.playAcrossSlidesWithController")||!this.m_media.playAcrossSlides))try{const e=Ye(this.m_environment),n=()=>{this.m_isNotAllowedError=!0,this.setCustomPlayButtonVisible()};this.m_localMediaPlaybackController=new ti(i,this.m_media.name,this.m_mediaType,Xe(this.m_environment),e,je(this.m_environment),$e(this.m_environment),this.onLocalPlaybackQualityImpactError,n),this.m_localMediaPlaybackPerf=new ei(i,this.m_pixelScale,this.m_slideEvents,Ge(this.m_environment),this.m_media,this.m_mediaType,this.m_environment.viewDataManager.getSlideIndex(this.m_slideId),this.m_environment.settings.startFromTime,this.m_environment.settings.initTime,void 0,this.m_initialRetryCount,this.m_isPrefetch,this.m_environment.settings.teamsCallId),G.ChangeGate.isChangeGateEnabled("SVM.AddWasVetoLogged")&&this.m_localMediaPlaybackController.setLocalMediaPlaybackPerf(this.m_localMediaPlaybackPerf);const r=new URL(t.mediaUrl),a=Si.getMediaLengthFromMediaUrl(r),s=()=>{this.isRetryUxEnabledForMedia()&&(this.setCustomPlayButtonHidden(),this.setRetryButtonVisible())};this.m_localMediaPlaybackSource=new ii(i,r,this.m_media.name,this.isMediaDownloadHandlerEnabled(this.m_media.src),void 0===a?0:a,this.isPlayable(),this.m_mediaType===Kt.a.Video,"video/mp4"===this.m_media.contentType,e,Ge(this.m_environment),this.getTotalRetryCount(),this.m_environment.settings.sessionId,this.m_requestGuid,this.m_localMediaPlaybackPerf,this.m_localMediaPlaybackController,s,this.m_localMediaPlaybackTelemetry)}catch(e){g.a.sendTraceTag(507003720,_.a.msoulscat_Wac_PptSession,S.a.Error,"MediaViewElement::initLocalMediaInfo Failed to construct LocalMediaPlaybackPerf "+e)}if(this.m_localMediaPlaybackSource?this.isMediaPlayable(this.m_media.contentType)&&this.m_localMediaPlaybackSource.setSource():this.setSourceAsync(i,t),this.m_media.playAcrossSlides){const e=(this.m_environment.crossSlideMediaMap?this.m_environment.crossSlideMediaMap[JSON.stringify(this.m_slideId)]:null)||[];e.push({mediaElement:i,mediaProps:this.m_media}),this.m_environment.crossSlideMediaMap[JSON.stringify(this.m_slideId)]=e}this.m_mediaType===Kt.a.Video&&this.isVideoPartiallyOffSlide()&&!F.a.readBooleanOrDefault("forceSvg",!1)&&(this.handlePartiallyOffSlideLocalVideo(i),g.a.sendTraceTag(507003718,_.a.msoulscat_Wac_PptSession,S.a.Info,"Local media is partially off slide.")),this.isFullSizeVideo()&&g.a.sendTraceTag(507003717,_.a.msoulscat_Wac_PptSession,S.a.Info,"Embedded video is full screen size"),t.el=i,this.m_shouldRenderToCanvas=!F.a.readBooleanOrDefault("forceSvg",!1)&&this.m_mediaType===Kt.a.Video&&(!!F.a.readBooleanOrDefault("renderLocalVideoToCanvasMobile",!1)||!Ye(this.m_environment))&&this.shouldRenderLocalVideoToCanvas(this.m_shapeItem);const n=this.m_shapeItem;G.ChangeGate.isChangeGateEnabled("SVM.removeEffectsIfNotRenderingToCanvas")&&!this.m_shouldRenderToCanvas&&n.effects.hasEffects&&this.removeEffects(n),g.a.sendTraceTag(507003716,_.a.msoulscat_Wac_PptSession,S.a.Info,`Media ${this.m_media.name} shouldRenderToCanvas: ${this.m_shouldRenderToCanvas}`),this.m_shouldRenderToCanvas&&this.setAlphaInvariant(),t.el.tabIndex=0,F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&(t.el.onkeydown=e=>{"Enter"===e.key||" "===e.key?this.isCustomPlayButtonVisible()?(e.stopImmediatePropagation(),this.customPlayButtonAction(!0)):this.usePlaybackControls()&&this.m_localMediaInfo&&(e.stopImmediatePropagation(),this.sendUserMediaActionEvent(d.VideoFrameClick),this.togglePauseMedia()):"j"!==e.key&&"∆"!==e.key||!e.altKey||this.m_controls&&(e.stopImmediatePropagation(),this.isCustomPlayButtonVisible()&&this.customPlayButtonAction(!1),this.m_controls.toggleCaptionsMenu("Keyboard"))}),this.m_mediaType!==Kt.a.Video||this.m_frameTracker||(this.m_frameTracker=new li(t.el,{mediaName:this.m_media.name})),this.m_localMediaInfo=t}getVideoPosterFrameUri(){if(void 0!==this.m_shapeItem){const e=this.m_shapeItem.getBrushImages();for(const t of e)if(t.id){const e=this.m_environment.viewDataManager.imageDataMap.get(t.id);if(e&&e.dataUri)return e.dataUri}}}isVolumeSliderEnabled(){return!Xe(this.m_environment)}isNestedTabbingEnabled(){return!(!this.usePlaybackControls()||Ye(this.m_environment))}isCaptionsEnabled(){return!!this.usePlaybackControls()}isTooltipsEnabled(){return!!this.usePlaybackControls()&&F.a.readBooleanOrDefault("enablePlaybackControlTooltips",!1)}addCaptionTracks(e){if(!this.isCaptionsEnabled()||!e||!this.m_media)return;const t=e;if(!t||!this.m_media.tracksInfo||!this.m_media.tracksInfo.trackLst)return;let i=!1;for(const e of t.children)if("captions"===e.getAttribute("kind")){i=!0;break}if(i){if(!G.ChangeGate.isChangeGateEnabled("SVM.RebuildCaptionTracks"))return;if(0===e.textTracks.length||e.textTracks[0].cues&&e.textTracks[0].cues.length>0)return;for(let e=t.children.length-1;e>=0;e-=1)"captions"===t.children[e].getAttribute("kind")&&t.children[e].remove()}this.m_media.tracksInfo.trackLst.forEach((e,i)=>{const n=document.createElement("track"),r=e.lang&&""!==e.lang?e.lang:"unknown";n.setAttribute("mode","hidden"),n.setAttribute("kind","captions"),n.setAttribute("label",e.label),n.setAttribute("src",decodeURIComponent(e.src)),n.setAttribute("srclang",r),g.a.sendTraceTag(507003715,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement.addCaptionTracks: Adding caption track. Media name: ${this.m_media.name}, index: ${i}, language: ${r}`),t.appendChild(n)})}isSpeedEnabled(){return!!this.usePlaybackControls()&&qe(this.m_environment)}isFullscreenEnabled(){return!this.shouldRenderToCanvas&&qe(this.m_environment)&&this.usePlaybackControls()&&!Ke.isBrowserSafari()}handlePartiallyOffSlideLocalVideo(e){let t=0,i=0,n=this.m_mediaPosition.x,r=this.m_mediaPosition.y;this.m_mediaPosition.x<0&&(t=this.m_mediaPosition.x,n=0),this.m_mediaPosition.y<0&&(i=this.m_mediaPosition.y,r=0),this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x&&(t=this.m_mediaSize.x+this.m_mediaPosition.x-this.m_slideSizePixels.x,n=this.m_slideSizePixels.x-this.m_mediaSize.x),this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y&&(i=this.m_mediaSize.y+this.m_mediaPosition.y-this.m_slideSizePixels.y,r=this.m_slideSizePixels.y-this.m_mediaSize.y);const a=e;a.style.objectFit="fill",a.style.objectPosition=`${t}px ${i}px`,e.style.left=n+"px",e.style.top=r+"px"}updateLocalMediaElement(){if(!this.m_localMediaInfo||!this.m_localMediaInfo.el)return;let e=document.getElementById(this.ShapeMediaTargetId);if(!e){const t=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2",i=$.ensureShapeViewElementParentDiv(this.id,t,this.m_media&&this.m_media.playAcrossSlides>0),n=Mn.SlideLevelHtmlElementsParentDivId;if(!i)return void g.a.sendTraceTag(507003714,_.a.msoulscat_Wac_PptSession,S.a.Error,`MediaViewElement::updateLocalMediaElement: couldn't find ${n}.`);if(e=F.a.readBooleanOrDefault("forceSvg",!1)?this.m_localMediaInfo.el:i.appendChild(this.m_localMediaInfo.el),F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===Kt.a.Video){const t=this.getBounds(),n=this.createCustomPlayButton(i,t);this.m_playButtonHandler=new ai(n,this.m_isNotAllowedError),this.m_fHasCustomPlayButtonBeenSynced||(this.m_media.autoPlay||!1===this.m_environment.settings.showCustomPlayButtonForVideo?this.setCustomPlayButtonHidden():this.setCustomPlayButtonVisible(),e.controls=!1);const r=this.createRetryButton(i,t);this.m_retryButtonHandler=new oi(r)}if(this.usePlaybackControls()){const e=this.ensureVideoEventsDiv(i);e&&this.m_controls&&this.m_controls.setParent(e)}else this.shouldRenderToCanvas&&this.ensureVideoEventsDiv(i)}if(this.m_mediaType===Kt.a.Video){const t=e;t.setAttribute("aria-label",this.m_media.ariaLabel||Si.getLocalizedString().videoStr),this.isVideoPartiallyOffSlide()&&!F.a.readBooleanOrDefault("forceSvg",!1)?(this.handlePartiallyOffSlideLocalVideo(e),g.a.sendTraceTag(507003713,_.a.msoulscat_Wac_PptSession,S.a.Info,"Local media is partially off slide.")):(this.isFullscreenEnabled()&&this.m_controls&&this.m_controls.isFullScreen()?t.style.objectFit="contain":t.style.objectFit="fill",F.a.readBooleanOrDefault("forceSvg",!1)||(e.style.left=this.m_mediaPosition.x+"px",e.style.top=this.m_mediaPosition.y+"px"))}else F.a.readBooleanOrDefault("forceSvg",!1)||(e.style.top=this.m_mediaPosition.y+"px",e.style.left=this.m_mediaPosition.x+"px");if(this.m_mediaType===Kt.a.Audio){const t=Math.max(this.m_mediaSize.x,Si.MIN_AUDIO_PLAYBACK_BAR_WIDTH),i=Math.max(this.m_mediaSize.y,Si.MIN_AUDIO_PLAYBACK_BAR_HEIGHT);if(e.style.width=t+"px",e.style.height=i+"px",this.m_mediaPosition.x<0)e.style.left="0px";else if(this.m_mediaPosition.x+t>this.m_slideSizePixels.x){const i=this.m_mediaPosition.x+t-this.m_slideSizePixels.x;this.m_mediaPosition.x-i>=0&&(e.style.left=this.m_mediaPosition.x-i+"px",e.style.width=t-1+"px")}if(this.m_mediaPosition.y<0)e.style.top="0px";else if(this.m_mediaPosition.y+i>this.m_slideSizePixels.y){const t=this.m_mediaPosition.y+i-this.m_slideSizePixels.y;this.m_mediaPosition.y-t>=0&&(e.style.top=this.m_mediaPosition.y-t+"px")}}}ensureVideoEventsDiv(e){let t=document.querySelector("#video-events-"+this.m_media.name);return t||(t=this.createEventHandlerDiv(),F.a.readBooleanOrDefault("enableOpticalZoom",!1)&&(t.style.pointerEvents="auto"),t.setAttribute("lang",Mn.appLanguage),e.appendChild(t)),this.m_localMediaEventsDiv=t,t}getBounds(){if(this.m_shapeItem){const e=this.m_shapeItem.getBounds(!1,!1,!1);if(e)return new m.d(e.left,e.top,e.right,e.bottom);if(this.m_mediaType===Kt.a.Video&&this.m_localMediaInfo&&this.m_localMediaInfo.el){const e=this.m_localMediaInfo.el;if(e)return new m.d(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaPosition.x+e.width,this.m_mediaPosition.y+e.height)}}return g.a.sendTraceTag(507003712,_.a.msoulscat_Wac_PptSession,S.a.Warning,"MediaViewElement::getBounds: Not able to get bounds from shapebuilder."),tt("IncorrectPosition"),new m.d(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaSize.x,this.m_mediaSize.y)}createEventHandlerDiv(){const e=document.createElement("div");e.id="video-events-"+this.m_media.name,e.style.position="absolute",F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()?e.tabIndex=-1:e.tabIndex=0,e.setAttribute("aria-label",this.m_media.ariaLabel||Si.getLocalizedString().videoStr),e.setAttribute("role","undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelGroup):"group");const t=this.getAdjustedBounds();return e.style.left=t.left+"px",e.style.top=t.top+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",this.setSizeAndScale(e,new m.f(t.width,t.height)),this.addListenersForMediaFocus(e),e.addEventListener("mouseenter",()=>{this.m_controls&&!this.isCustomPlayButtonVisible()&&this.m_controls.show()}),e.addEventListener("mouseleave",()=>{this.m_controls&&this.m_controls.hide()}),e.addEventListener("focusin",()=>{this.m_controls&&!this.isCustomPlayButtonVisible()&&this.m_controls.show()}),e.addEventListener("focusout",()=>{this.m_controls&&this.m_controls.hide()}),G.ChangeGate.isChangeGateEnabled("SVM.PlayPauseVideoWithMouseClick")&&e.addEventListener("click",()=>{this.usePlaybackControls()&&this.m_localMediaInfo&&!this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&(this.sendUserMediaActionEvent(d.VideoFrameClick),this.togglePauseMedia())}),e.addEventListener("keydown",e=>{"Enter"===e.key||" "===e.key?F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()?(e.stopImmediatePropagation(),this.customPlayButtonAction(!0)):this.usePlaybackControls()&&this.m_localMediaInfo&&!this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&(e.stopImmediatePropagation(),this.sendUserMediaActionEvent(d.VideoFrameClick),this.togglePauseMedia()):"ArrowLeft"===e.key||"ArrowRight"===e.key?!this.m_controls||!this.isNestedTabbingEnabled()||F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()||this.m_controls.onKeyDown(e):"j"!==e.key&&"∆"!==e.key||!e.altKey||!this.m_controls||F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()||this.m_controls.toggleCaptionsMenu("Keyboard")}),e}isRetryUxEnabledForMedia(){return!(!F.a.readBooleanOrDefault("enableCustomPlayButton",!1)||this.m_mediaType!==Kt.a.Video||this.m_media.autoPlay&&(-1===this.m_media.repeat||this.m_media.repeat>1)&&0===this.m_media.volume)}getTotalRetryCount(){let e=F.a.readNumberOrDefault("mediaRetryCount",Si.BD_HTML5_MEDIA_RETRY_COUNT);return e>5&&this.isRetryUxEnabledForMedia()&&(e-=3),this.m_localMediaPlaybackSource||this.m_useTranscodedVideos&&(e+=F.a.readNumberOrDefault("transcodingRetryCount",Si.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT)),e}generateMediaSrcUrl(e,t){try{const i=new URL(e);return i.searchParams.set("usid",this.m_environment.settings.sessionId),i.searchParams.set("retries",t.toString()),i.searchParams.set("requestGuid",this.m_requestGuid),i.hostname=i.hostname.toLowerCase().replace(".pods.",".media."),this.m_useTranscodedVideos&&(-1===e.indexOf("disableTranscode")?this.generateTranscodedMediaSrcUrl(t,i):g.a.sendTraceTag(507003683,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::generateMediaSrcUrl disable transcoding for mediaName: "+this.m_media.name)),g.a.sendTraceTag(507003682,_.a.msoulscat_Wac_PptSession,S.a.Info,"Media URL includes media domain: "+i.hostname.includes(".media.")),i.toString()}catch(e){g.a.sendTraceTag(507003681,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::generateMediaSrcUrl Invalid URL "+e)}return-1===e.indexOf("?")?`${e}?retries=${t}`:`${e}&retries=${t}`}generateTranscodedMediaSrcUrl(e,t){let i=!1;const n=Si.getMediaLengthFromMediaUrl(t);void 0!==n&&(i=n<F.a.readNumberOrDefault("minVideoSizeToTranscodeForDesktopBytes",1e7)&&!Ye(this.m_environment));const r=!this.isPlayable(),a=!G.ChangeGate.isChangeGateEnabled("SVM.TryTranscodingOnce")||!this.m_wasTranscodingRequested,s=!F.a.readBooleanOrDefault("noMP4Transcoding",!1)||!this.isMP4(),o=!F.a.readBooleanOrDefault("onlyTranscodeUnplayableVideos",!1)||r,l=e>=this.m_initialRetryCount-F.a.readNumberOrDefault("transcodingRetryCount",Si.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT),d=!G.ChangeGate.isChangeGateEnabled("SVM.DisableTranscodedVideosPrefetch")&&!this.m_fOnSlide;this.m_isTranscoded=r||a&&s&&o&&!i&&(l||d),this.m_wasTranscodingRequested=this.m_wasTranscodingRequested||this.m_isTranscoded,this.updatePixelScale();const c=this.m_environment.rendererEnvironment.isCanvasSizeSet||!G.ChangeGate.isChangeGateEnabled("SVM.CheckIfCanvasIsSet")?this.m_pixelScale:new m.f(1,1);let h=this.m_isTranscoded?Me.Low:Me.Raw;var u;!F.a.readBooleanOrDefault("onlyLowTranscoding",!1)&&this.m_isTranscoded&&(h=Ke.getTranscodeMediaQuality(null!==(u=Si.getNetworkBandwidthInMbps())&&void 0!==u?u:0,this.m_mediaSize,c,this.m_environment)),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setMediaQuality(h),t.searchParams.set("transcode",Me[h]),g.a.sendTraceTag(507003680,_.a.msoulscat_Wac_PptSession,S.a.Info,""+JSON.stringify({requestTranscodedMedia:this.m_isTranscoded,retryCount:e,selMediaQuality:Me[h],onSlide:this.m_fOnSlide}))}static getNetworkBandwidthInMbps(){const e=window.navigator,t=null!=e?e.connection||e.mozConnection||e.webkitConnection:null;let i=void 0;return t?i=t.downlink:g.a.sendTraceTag(507003679,_.a.msoulscat_Wac_PptSession,S.a.Warning,`MediaViewElement::getNetworkBandwidthInMbps: Could not find network connection as connection is ${t} `),i}onMediaError(e){e.el&&e.props&&(this.m_wasLoadStarted||this.m_hlsError)&&(e.el.error&&g.a.sendTraceTag(507003678,_.a.msoulscat_Wac_PptSession,S.a.Warning,`MediaViewElement::onMediaError {errorCode: ${e.el.error.code}, errorMessage: ${e.el.error.message}}`),e.retriesRemaining>0?window.setTimeout(()=>{this.retryMediaDownload(e)},G.ChangeGate.isChangeGateEnabled("SVM.NoWaitHLSRetry")&&this.m_hlsError&&this.m_hlsErrorCount<=this.getHLSRetryCount()?1:e.retryTimeoutMs):(g.a.sendTraceTag(507003677,_.a.msoulscat_Wac_PptSession,S.a.Error,`MediaViewElement::onMediaError No retries left mediaName: ${this.m_media.name}.`),this.isRetryUxEnabledForMedia()&&(this.setCustomPlayButtonHidden(),this.setRetryButtonVisible())))}onEnded(e){e.el&&e.props&&(this.sendMediaSyncEvent(l.MediaEnded),-1===e.numRepeatsRemaining||e.numRepeatsRemaining>1?(this.resetCurrentTime(e),e.numRepeatsRemaining>1&&(e.numRepeatsRemaining-=1),this.playHelper(e)):(e.fReachedEnd=!0,this.stopVideoFrameTracker("onEnded"),this.pauseHelper(e),e.numRepeatsRemaining=e.numRepeatsOriginal))}onLoadedData(e){if(g.a.sendTraceTag(507003676,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement::onLoadedData: Media name: ${e.props.name}, content type: ${e.props.contentType}`),F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===Kt.a.Video){if(!e.el)return;if(this.usePlaybackControls())return;F.a.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&this.m_media.autoPlay&&this.m_environment.settings.showCustomPlayButtonForVideo&&!this.isLoopingBackgroundVideo(e)?e.el.controls=!0:!this.m_media.autoPlay&&!1!==this.m_environment.settings.showCustomPlayButtonForVideo||this.isLoopingBackgroundVideo(e)||(e.el.controls=!0)}}onLoadedMetaData(e){g.a.sendTraceTag(507003675,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement::onLoadedMetaData: Media name: ${e.props.name}, content type: ${e.props.contentType}`);const t=e.el;if(!t)return;const i=this.isLoopingBackgroundVideo(e);if((this.m_environment.settings.transparentCanvasForVideoEnabled||F.a.readBooleanOrDefault("forceSvg",!1))&&i)t.style.pointerEvents="none",t.controls=!1;else{if(t.style.pointerEvents="auto",this.usePlaybackControls())return;F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType!==Kt.a.Audio&&(i||!this.m_media.autoPlay||F.a.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&!this.m_environment.settings.showCustomPlayButtonForVideo)||(t.controls=!0)}}retryMediaDownload(e){if(!e.el)return;if(!e.props)return;if(!e.el.src&&!this.m_hlsError)return;this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0),g.a.sendTraceTag(507003674,_.a.msoulscat_Wac_PptSession,S.a.Warning,`MediaViewElement::retryMediaDownload: retrying media with id= ${e.elID}, retriesRemaining=${e.retriesRemaining}`),e.retriesRemaining-=1,this.setSourceAsync(e.el,e);const t=F.a.readNumberOrDefault("mediaRetryMultiplier",Si.BD_HTML5_MEDIA_RETRY_MULTIPLIER);e.retryTimeoutMs*=t}onTimeUpdate(e){if(!e.el)return;if(!e.props)return;const t=e.el.duration-e.props.trimEndMs/1e3;e.el.currentTime>=t&&!e.fReachedEnd&&this.onEnded(e)}onPlay(e){if(!e.el)return;if(!e.props)return;F.a.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===Kt.a.Video&&(this.setCustomPlayButtonHidden(),G.ChangeGate.isChangeGateEnabled("SVM.SingleTabForMedia")&&this.m_localMediaEventsDiv&&(this.m_localMediaEventsDiv.tabIndex=0),this.usePlaybackControls()||this.m_media.autoPlay||e.fLooping||(e.el.controls=!0));const t=e.el.duration-e.props.trimEndMs/1e3,i=e.props.trimStartMs/1e3;e.el.currentTime<i&&this.resetCurrentTime(e),e.el.currentTime>=t&&e.fReachedEnd&&this.resetCurrentTime(e),e.fReachedEnd=!1,this.sendMediaSyncEvent(l.MediaPlayed)}onPlaying(){this.m_frameTracker&&!this.m_frameTracker.isActive&&(g.a.sendTraceTag(507003673,_.a.msoulscat_Wac_PptSession,S.a.Info,"Starting VideoFrameTracker for media "+this.m_media.name),this.m_frameTracker.start())}setAccessibleNameForLocalMedia(e){if(G.ChangeGate.isChangeGateEnabled("SVM.UpdateVideoNameWithPlayPauseState")&&this.m_localMediaInfo&&this.m_localMediaInfo.el){let t=(this.m_media.ariaLabel||Si.getLocalizedString().videoStr)+" ";t+="undefined"!=typeof PowerpointSlideshowStringsManager?e?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelPlayButton):PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsAccessibilityLabelPauseButton):e?"Video Play":"Video Pause",this.m_localMediaInfo.el.setAttribute("aria-label",t),this.m_localMediaEventsDiv&&this.m_localMediaEventsDiv.setAttribute("aria-label",t)}}playHelper(e){return e.el?(this.setAccessibleNameForLocalMedia(!0),this.m_localMediaPlaybackController?(this.m_localMediaPlaybackController.playOrPause(!0),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setPlayRequestTime(),this.m_localMediaPlayer&&this.m_localMediaPlayer.setPlayRequestTime(),Promise.resolve(void 0)):(g.a.sendTraceTag(507003671,_.a.msoulscat_Wac_PptSession,S.a.Info,`Calling play() media: ${this.m_media.name} Ready state:${e.el.readyState}.`),this.verifyPlatfromSpecificReadyState(e)||g.a.sendTraceTag(507003670,_.a.msoulscat_Wac_PptSession,S.a.Error,`Player haven't reached to ready state and started playing media: ${this.m_media.name}.`),e.el.play())):(g.a.sendTraceTag(507003672,_.a.msoulscat_Wac_PptSession,S.a.Error,"mediaInfo is null/undefined"),Promise.resolve(void 0))}pauseHelper(e){e.el?(this.setAccessibleNameForLocalMedia(!1),this.m_localMediaPlaybackController?this.m_localMediaPlaybackController.playOrPause(!1):(g.a.sendTraceTag(507003668,_.a.msoulscat_Wac_PptSession,S.a.Info,`Calling pause() media: ${this.m_media.name} Ready state:${e.el.readyState}.`),e.el.pause())):g.a.sendTraceTag(507003669,_.a.msoulscat_Wac_PptSession,S.a.Error,"mediaInfo is null/undefined")}verifyPlatfromSpecificReadyState(e){if(!e.el)return g.a.sendTraceTag(507003667,_.a.msoulscat_Wac_PptSession,S.a.Error,"mediaInfo is null/undefined"),!1;const t=this.useLoadedMetadataAsInteractivityEvent();return e.el.readyState>=(t?HTMLMediaElement.HAVE_METADATA:HTMLMediaElement.HAVE_FUTURE_DATA)}useLoadedMetadataAsInteractivityEvent(){return Xe(this.m_environment)}onPause(e){if(e.el){const t=e.el.duration-(e.props?e.props.trimEndMs/1e3:0);if(e.el.currentTime>=t)return;this.stopVideoFrameTracker("onPause"),this.sendMediaSyncEvent(l.MediaPaused),g.a.sendTraceTag(507003666,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement::onPause - currentTime: ${e.el.currentTime} (seconds), media: ${this.m_media.name}, isNarration: ${this.m_media.narration}`)}}stopVideoFrameTracker(e){if(this.m_frameTracker&&this.m_frameTracker.isActive){let t={};if(this.m_shapeItem instanceof T.j){const i=this.m_shapeItem;t={renderToCanvas:this.shouldRenderToCanvas,cropped:this.isVideoCropped(i),croppedToShape:Si.isVideoCroppedToShape(i),rotated:Si.isVideoRotated(i),effects:i.effects.hasEffects,outline:void 0!==i.style.lineBrush,trackingStopped:e}}this.m_frameTracker.stop(t)}}onSeeked(e){e.el&&(e.el.currentTime<e.el.duration&&(e.fReachedEnd=!1),this.shouldRenderToCanvas&&e.el.paused&&(this.m_hasPendingRender=!0),this.sendMediaSyncEvent(l.MediaSeeked))}onVolumeChange(e){e.el&&this.sendMediaSyncEvent(l.MediaVolumeChanged)}getPlayButtonTooltip(){return void 0===this.isPresenter()?"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPlay):"Play":this.isPresenter()?"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPlayPresenter):"Play for everyone":"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.CustomControlsTooltipLabelPlayAttendee):"Play for me only"}initLinkedMediaInfo(){const e=this.m_shapeViewData.media;if(!e||document.getElementById("media-element-"+JSON.stringify(this.id)))return;if(!this.isMediaPlayable(e.contentType))return;const t=Ke.getMediaRenderAs(e.contentType);if(t!==xe.FlashObject)return void(this.m_transparentShapeItem=void 0);let i;try{i=new URL(e.src)}catch{return void g.a.sendTraceTag(507003665,_.a.msoulscat_Wac_PptSession,S.a.Error,"Media src URL is invalid")}this.isFullScreenByDefault()&&(i.searchParams.set("playsinline","true"),g.a.sendTraceTag(507003664,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::initLinkedMediaInfo: Set playsinline flag to true"));const n=document.createElement("div");n.id="LinkedMedia-Container",n.style.visibility="visible",n.style.position="absolute",n.style.pointerEvents="auto",n.style.left=this.m_mediaPosition.x+"px",n.style.top=this.m_mediaPosition.y+"px";const r=this.getAdjustedBounds();if(this.setSizeAndScale(n,new m.f(r.width,r.height)),n.tabIndex=0,this.addListenersForMediaFocus(n),this.m_environment.settings.transparentCanvasForVideoEnabled||F.a.readBooleanOrDefault("forceSvg",!1)||(n.style.zIndex="3"),t===xe.FlashObject){const e=this.isVideoPartiallyOffSlide(),t={mediaPosition:this.m_mediaPosition,mediaSize:this.m_mediaSize,slideSize:this.m_slideSizePixels,fEnableCropping:e};let r;je(this.m_environment)&&!this.m_media.autoPlay&&(r=this.getVideoPosterFrameUri(),void 0===r&&g.a.sendTraceTag(507003663,_.a.msoulscat_Wac_PptSession,S.a.Info,"Failed to find online video poster frame"));const a=e=>{g.a.sendTraceTag(507003662,_.a.msoulscat_Wac_PptSession,S.a.Error,"Online media sent veto: "+JSON.stringify({veto:e.vetoName,error:e.errorName,details:e.details,correlationId:e.correlationId,mediaType:Kt.a[this.m_mediaType],mediaName:this.m_media.name,uiHostType:ke[Ge(this.m_environment)],teamsCallId:this.m_environment.settings.teamsCallId})),G.ChangeGate.isChangeGateEnabled("SVM.RecordOnlineMediaVeto")&&J.e.recordVeto(e.vetoName,{qosVeto:e.vetoName,errorName:e.errorName,errorDetails:e.details,mediaName:this.m_media.name,mediaType:Kt.a[this.m_mediaType]})};this.m_onlineVideoPlayer=new He(i.toString(),n,this.m_gfxVideoSettings,t,r,()=>this.onPlayerReadyCallBack(),e=>this.onlineVideoEventEmitter(e),e=>this.onlineVideoAuthEventEmitter(e),()=>this.m_fHasOnlineVideoPlayButtonBeenClicked=!0,a,this.m_media.name,this.getPlayButtonTooltip()),void 0!==this.m_onlineVideoPlaybackTelemetry||this.m_media.playAcrossSlides||(this.m_onlineVideoPlaybackTelemetry=new _i(this.m_media,this.m_environment,this.m_slideId)),null!==this.m_onlineVideoPlayer&&(g.a.sendTraceTag(507003661,_.a.msoulscat_Wac_PptSession,S.a.Info,`Successful creation of OnlineVideoPlayer of type ${Kt.a[this.m_mediaType]}.`),this.m_onlineVideoPlayer.setUiHostType(ke[Ge(this.m_environment)]))}else g.a.sendTraceTag(507003660,_.a.msoulscat_Wac_PptSession,S.a.Info,`Unable to play media: unknown RenderAs type ignored: ${t}.`);this.isVideoPartiallyOffSlide()&&(this.handlePartiallyOffSlideLinkedMedia(n),g.a.sendTraceTag(507003659,_.a.msoulscat_Wac_PptSession,S.a.Info,`Linked media with type:${this.m_mediaType} is partially off slide.`)),this.m_linkedMediaEl=n}isFullScreenByDefault(){if(Xe(this.m_environment))switch(this.m_mediaType){case Kt.a.Flip:case Kt.a.StreamClassic:case Kt.a.Ted:case Kt.a.Vimeo:case Kt.a.YouTube:case Kt.a.Stream2:return!0}return!1}setCustomPlayButtonHidden(){this.m_playButtonHandler&&!this.m_isNotAllowedError&&this.m_playButtonHandler.setPlayButtonHidden()}setCustomPlayButtonVisible(){this.m_playButtonHandler&&this.m_playButtonHandler.setPlayButtonVisible()}isCustomPlayButtonVisible(){return!!this.m_playButtonHandler&&this.m_playButtonHandler.isPlayButtonVisible()}customPlayButtonOnClick(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),this.customPlayButtonAction(!0)}customPlayButtonAction(e){this.m_isNotAllowedError=!1,this.setCustomPlayButtonHidden(),e&&(this.playMedia(),this.m_fIsPlayerReady&&this.sendMediaSyncEvent(l.MediaPlayed,d.CustomPlayButtonClick),this.sendUserMediaActionEvent(d.CustomPlayButtonClick),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setWhenClickedOn()),this.m_localMediaInfo&&this.m_localMediaInfo.el&&!this.m_media.autoPlay&&this.m_fIsPlayerReady&&!this.usePlaybackControls()&&(this.m_localMediaInfo.el.controls=!0)}createCustomPlayButton(e,t){const i=Be(this.getPlayButtonTooltip());return i.style.top=t.top+t.height/2-28.3+"px",i.style.left=t.left+t.width/2-28.3+"px",i.addEventListener("click",e=>this.customPlayButtonOnClick(e),!1),e.appendChild(i),i}setRetryButtonHidden(){this.m_retryButtonHandler&&(this.m_retryButtonHandler.setRetryButtonHidden(),g.a.sendTraceTag(507003658,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::setRetryButtonHidden: Retry button hidden for media: "+this.m_media.name))}setRetryButtonVisible(){this.m_retryButtonHandler&&(this.m_retryButtonHandler.setRetryButtonVisible(),g.a.sendTraceTag(507003657,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement::setRetryButtonVisible: Retry button shown for media: "+this.m_media.name))}retryButtonOnClick(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),this.setRetryButtonHidden(),this.m_localMediaPlaybackSource?this.isMediaPlayable(this.m_media.contentType)&&this.m_localMediaPlaybackSource.setSource():this.m_localMediaInfo&&this.retryMediaDownload(this.m_localMediaInfo)}createRetryButton(e,t){const i=function(){const e=si("svg");e.style.height=56.6.toString()+"px",e.style.width=56.6.toString()+"px",e.setAttribute("viewBox","0 0 57 58"),e.style.position="absolute",e.style.zIndex="99",e.style.top=`calc(50% - ${28.3.toString()}px)`,e.style.left=`calc(50% - ${28.3.toString()}px)`,e.style.cursor="pointer",e.style.pointerEvents="all";const t=si("path");t.setAttribute("d","M52.977 15.15C60.7919 28.6857 56.1542 45.9937 42.6185 53.8085C29.0828 61.6234 11.7748 56.9857 3.95999 43.45C-3.85483 29.9143 0.782832 12.6063 14.3185 4.79151C27.8542 -3.02332 45.1622 1.61434 52.977 15.15Z"),t.setAttribute("fill","#404040");const i=si("path");return i.setAttribute("d","M40.2575 18.4817L41.7287 18.8673L39.7805 25.7953L32.7936 24.0261L33.2082 22.5516L37.6683 23.6987L37.4485 23.318C36.965 22.4806 36.3926 21.7395 35.7314 21.0949C35.0566 20.4467 34.3244 19.8995 33.5349 19.453C32.7366 19.0115 31.897 18.6786 31.0159 18.4541C30.1262 18.2346 29.2241 18.1239 28.3095 18.1217C27.3863 18.1246 26.4691 18.2481 25.558 18.4922C24.6333 18.7328 23.7418 19.1009 22.8834 19.5965C22.025 20.0921 21.2647 20.6776 20.6027 21.3531C19.9271 22.0252 19.3572 22.7602 18.8931 23.5583C18.429 24.3564 18.0739 25.193 17.8278 26.0683C17.5816 26.9435 17.4501 27.8372 17.4333 28.7492C17.4165 29.6612 17.5244 30.569 17.757 31.4724C17.976 32.3723 18.3272 33.241 18.8108 34.0785C19.2943 34.916 19.8734 35.6588 20.5482 36.3069C21.2094 36.9515 21.9391 37.4946 22.7374 37.9361C23.5356 38.3775 24.3753 38.7105 25.2563 38.935C26.1374 39.1594 27.0395 39.2702 27.9627 39.2673C28.8859 39.2644 29.8099 39.1427 30.7346 38.9021C31.6457 38.658 32.5305 38.2882 33.3889 37.7926C34.386 37.2169 35.2481 36.5274 35.9751 35.7242C36.7021 34.9209 37.2982 34.041 37.7633 33.0845L38.6497 34.6198C38.1196 35.5237 37.4787 36.3561 36.7273 37.1171C35.971 37.8696 35.1072 38.5262 34.1361 39.0868C33.1563 39.6525 32.1404 40.0755 31.0883 40.3558C30.0314 40.6277 28.979 40.7672 27.9311 40.7744C26.8832 40.7816 25.851 40.6557 24.8344 40.3967C23.8178 40.1377 22.8575 39.756 21.9535 39.2515C21.0495 38.747 20.2178 38.1275 19.4584 37.3929C18.6854 36.6548 18.023 35.8079 17.4711 34.852C16.9192 33.8961 16.5194 32.9031 16.2716 31.8732C16.0102 30.8398 15.8871 29.8055 15.9022 28.7704C15.9173 27.7353 16.0668 26.7127 16.3508 25.7028C16.6348 24.6929 17.0419 23.736 17.5721 22.8321C18.1023 21.9282 18.7518 21.0908 19.5206 20.3199C20.2845 19.5405 21.1563 18.8679 22.1361 18.3022C23.1159 17.7365 24.1343 17.3178 25.1912 17.0459C26.2346 16.7706 27.2803 16.6294 28.3281 16.6221C29.376 16.6149 30.4083 16.7408 31.4249 16.9998C32.4415 17.2588 33.4018 17.6406 34.3058 18.1451C35.2098 18.6495 36.0482 19.2708 36.8212 20.0089C37.5806 20.7434 38.2362 21.5887 38.7881 22.5446L39.0079 22.9253L40.2575 18.4817Z"),i.setAttribute("fill","white"),i.setAttribute("opacity",".5"),e.appendChild(t),e.appendChild(i),e}();return i.style.top=t.top+t.height/2-28.3+"px",i.style.left=t.left+t.width/2-28.3+"px",i.style.display="none",i.addEventListener("click",e=>this.retryButtonOnClick(e),!1),e.appendChild(i),i}onPlayerReadyCallBack(){if(!this.m_fIsPlayerReady){if(this.m_fIsPlayerReady=!0,this.m_fSuppressMediaSyncEvents=!1,this.isSupportedMediaPlayer()&&!this.m_fHasMediaBeenSynced){if(this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_mediaType===Kt.a.Video){const e=this.m_localMediaInfo.el;let t;this.usePlaybackControls()?(this.initPlaybackControls(e),t=e.parentElement?this.ensureVideoEventsDiv(e.parentElement):void 0,t&&this.m_controls&&this.m_controls.setParent(t)):this.shouldRenderToCanvas&&e.parentElement&&this.ensureVideoEventsDiv(e.parentElement)}this.emitMediaInitState()}this.m_fHasMediaBeenSynced&&this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.setMediaSyncedOnReady(),!this.m_onlineVideoPlayer||this.m_mediaType!==Kt.a.YouTube&&this.m_mediaType!==Kt.a.Vimeo||this.m_fHasMediaBeenSynced||(g.a.sendTraceTag(507003656,_.a.msoulscat_Wac_PptSession,S.a.Info,`Setting ${Kt.a[this.m_mediaType]} video to be unmuted by default: ${this.m_media.name}`),this.m_onlineVideoPlayer.setUnMute()),this.m_localMediaInfo&&!this.m_fHasMediaBeenSynced&&(g.a.sendTraceTag(507003655,_.a.msoulscat_Wac_PptSession,S.a.Info,`Seeking media ${this.m_media.name} to start at initial position ${this.m_localMediaInfo.props.trimStartMs/1e3}s`),this.resetCurrentTime(this.m_localMediaInfo)),this.m_environment.isGlobalMute&&(g.a.sendTraceTag(507003654,_.a.msoulscat_Wac_PptSession,S.a.Info,"Setting global mute on media: "+this.m_media.name),this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!0:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setMute())}}isSupportedMediaPlayer(){return this.m_mediaType!==Kt.a.Other}emitMediaInitState(){const e={mediaName:this.m_media.name,slideId:this.m_slideId};let t;if(this.m_localMediaInfo&&this.m_localMediaInfo.el){if(this.isLoopingBackgroundVideo(this.m_localMediaInfo))return;t={playerState:!this.m_localMediaInfo.el.paused||this.m_media.autoPlay?c.MediaPlayed:c.MediaPaused,volume:this.m_localMediaInfo.el.volume,muted:this.m_localMediaInfo.el.muted,position:this.m_localMediaInfo.props.trimStartMs/1e3,mediaName:this.m_media.name,playerPositionSkew:-1}}else if(this.m_onlineVideoPlayer){let e=this.m_onlineVideoPlayer.isMuted();this.m_mediaType!==Kt.a.YouTube&&this.m_mediaType!==Kt.a.Vimeo||(e=!1),t={playerState:!this.m_onlineVideoPlayer.isPaused()||this.m_media.autoPlay?c.MediaPlayed:c.MediaPaused,volume:this.m_onlineVideoPlayer.getVolume(),muted:e,position:this.m_onlineVideoPlayer.getCurrentTime(),mediaName:this.m_media.name,playerPositionSkew:-1}}if(t){const i={mediaName:this.m_media.name,state:t,origin:{isInitial:!0,hostName:Kt.a[this.m_mediaType]},correlationId:Object(ri.v4)()};Si.logMediaSyncEmission(i,!0),this.m_slideEvents.emit("mediaInitState",{mediaSlideInfo:e,mediaSyncInitState:i})}}onlineVideoEventEmitter(e){e===l.MediaEnded?this.m_fLinkedMediaReachedEnd=!0:e!==l.MediaVolumeChanged&&(this.m_fLinkedMediaReachedEnd=!1),this.sendMediaSyncEvent(e)}onlineVideoAuthEventEmitter(e){Qe.setNewStreamPlayer(this.m_onlineVideoPlayer),g.a.sendTraceTag(507003653,_.a.msoulscat_Wac_PptSession,S.a.Info,`Emitting AADTokenRequest for media (name: ${this.m_media.name}, type: ${Kt.a[this.m_mediaType]})`),this.m_slideEvents.emit("aadTokenRequest",e)}static getEventName(e){switch(e){case l.MediaPlayed:return"mediaPlayed";case l.MediaPaused:return"mediaPaused";case l.MediaSeeked:return"mediaSeeked";case l.MediaVolumeChanged:return"mediaVolumeChanged";case l.MediaEnded:return"mediaEnded";default:return""}}createGfxVideoAppSettings(){const e=je(this.m_environment);return{App:e?"Teams":"PowerPoint",AppPlatform:e?"Previewer":"WAC",AppCorrelation:this.m_environment.settings.sessionId,HubbleVideoEndpoint:this.m_environment.settings.hubbleVideoEndpoint||F.a.readStringOrDefault("PPTLiveHubbleEndpoint","https://hubble.officeapps.live.com"),IsStream2Enabled:!0,AcceptLanguage:this.m_environment.settings.acceptLanguage,MaxAADTokenWaitingTime:F.a.readNumberOrDefault("MaxAADTokenWaitingTime",3e3),TokenCacheTimeout:F.a.readNumberOrDefault("tokenCacheTimeout",3e4),hostComponent:e?"SlideshowApp":"Unified",hostView:e?"PowerPointLive":"Present",LocalizedHubble400ErrorMessage:"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.Hubble400Error):"400",LocalizedHubble404ErrorMessage:"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.Hubble404Error):"404",LocalizedHubble500ErrorMessage:"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.Hubble500Error):"500",LocalizedHubble403ErrorMessage:"undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.Hubble403Error):"403",fixAutoPlayEnabled:G.ChangeGate.isChangeGateEnabled("fixAutoPlayEnabled")}}ensureLinkedMediaElementDiv(){let e=document.getElementById(this.ShapeMediaTargetId);if(e)return e;e=document.createElement("div"),e.id=this.ShapeMediaTargetId;const t=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2";return $.ensureShapeViewElementParentDiv(this.id,t).appendChild(e),e}handlePartiallyOffSlideLinkedMedia(e){let t=0,i=0;const n=Mn.getElementFromCollectionByLocalName(e.children,"iframe");if(!n)return;this.m_mediaPosition.x<0&&(t=this.m_mediaPosition.x,e.style.left="0px",e.style.width=this.m_mediaSize.x+this.m_mediaPosition.x+"px"),this.m_mediaPosition.y<0&&(i=this.m_mediaPosition.y,e.style.top="0px",e.style.height=this.m_mediaSize.y+this.m_mediaPosition.y+"px"),this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x&&(this.m_mediaPosition.x<=0?e.style.width=this.m_slideSizePixels.x+"px":e.style.width=this.m_slideSizePixels.x-this.m_mediaPosition.x+"px"),this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y&&(this.m_mediaPosition.y<=0?e.style.height=this.m_slideSizePixels.y+"px":e.style.height=this.m_slideSizePixels.y-this.m_mediaPosition.y+"px"),e.style.overflow="hidden";const r=n;r.style.width=this.m_mediaSize.x+"px",r.style.height=this.m_mediaSize.y+"px",r.style.position="relative",r.style.left=t+"px",r.style.top=i+"px"}updateLinkedMediaElement(){if(!this.m_linkedMediaEl)return;const e=this.ensureLinkedMediaElementDiv();let t=Mn.getElementFromCollection(e.children,Si.LinkedMediaContainerName);t||(t=e.appendChild(this.m_linkedMediaEl));const i=t;i.style.left=this.m_mediaPosition.x+"px",i.style.top=this.m_mediaPosition.y+"px";const n=this.getAdjustedBounds();if(this.setSizeAndScale(i,new m.f(n.width,n.height)),this.isVideoPartiallyOffSlide())this.handlePartiallyOffSlideLinkedMedia(i),g.a.sendTraceTag(507003652,_.a.msoulscat_Wac_PptSession,S.a.Info,`Linked media with type:${this.m_mediaType} is partially off slide.`);else{const e=Mn.getElementFromCollection(i.children,Si.LinkedMediaIFramename);if(!e)return;const t=e;t.style.width=this.m_mediaSize.x+"px",t.style.height=this.m_mediaSize.y+"px",t.setAttribute("aria-label",this.m_media.ariaLabel||Si.getLocalizedString().videoStr)}}addListenersForMediaFocus(e){const t=F.a.readNumberOrDefault("mediaFocusIndicatorWidth",4);e.onfocus=()=>{const i=e.getBoundingClientRect();e.style.width=i.width-2*t+"px",e.style.height=i.height-2*t+"px",this.addFocusBorder(e)},e.onblur=()=>{const t=this.getAdjustedBounds();this.setSizeAndScale(e,new m.f(t.width,t.height)),this.removeFocusBorder(e)}}addFocusBorder(e){const t=F.a.readNumberOrDefault("mediaFocusStyleOutlineWidth",2),i=F.a.readNumberOrDefault("mediaFocusStyleOutlineOffset",-4),n=F.a.readNumberOrDefault("mediaFocusStyleBorderWidth",4);this.addStyleToHTMLElement(e,{outline:`solid ${t}px white`,outlineOffset:i+"px",border:`solid ${n}px black`})}removeFocusBorder(e){this.addStyleToHTMLElement(e,{outlineWidth:"0px",borderWidth:"0px"})}getMediaSize(){const e=this.getBounds();return new m.f(e.width,e.height)}setSizeAndScale(e,t){const i=this.m_slideScale;this.addStyleToHTMLElement(e,{transform:`scale(${1/i}, ${1/i})`,transformOrigin:"top left",width:t.x*i+"px",height:t.y*i+"px"})}addStyleToHTMLElement(e,t){for(const i in t)e.style[i]=t[i]}static getMediaType(e){if(e.isLocal)return 0===e.contentType.toLowerCase().indexOf("audio/")?Kt.a.Audio:Kt.a.Video;const t=oe(e.src);return"YouTube"===t?Kt.a.YouTube:"Vimeo"===t?Kt.a.Vimeo:"StreamClassic"===t?Kt.a.StreamClassic:"Flip"===t?Kt.a.Flip:"Ted"===t?Kt.a.Ted:"SlideShare"===t?Kt.a.SlideShare:Kt.a.Stream2}get shapeItem(){return this.m_shapeItem}enableVolumeSync(){return!Xe(this.m_environment)&&F.a.readBooleanOrDefault("mediaVolumeSync",!1)}getMediaCurrentState(){if(this.m_fIsPlayerReady){if(this.m_localMediaInfo&&this.m_localMediaInfo.el){let e=this.m_localMediaInfo.fReachedEnd?c.MediaEnded:void 0;return e||(e=this.m_localMediaInfo.el.paused?c.MediaPaused:c.MediaPlayed),{mediaName:this.m_media.name,playerState:e,position:this.m_localMediaInfo.el.currentTime,volume:this.m_localMediaInfo.el.volume,muted:this.m_localMediaInfo.el.muted,playerPositionSkew:0}}if(this.m_onlineVideoPlayer){let e=this.m_fLinkedMediaReachedEnd?c.MediaEnded:void 0;return e||(e=this.m_onlineVideoPlayer.isPaused()?c.MediaPaused:c.MediaPlayed),{mediaName:this.m_media.name,playerState:e,position:this.m_onlineVideoPlayer.getCurrentTime(),volume:this.m_onlineVideoPlayer.getVolume(),muted:this.m_onlineVideoPlayer.isMuted(),playerPositionSkew:0}}}}shouldSyncMediaVolumeChanged(e){return e.origin.isFromLocalCache||e.origin.isFromRoleChange||e.origin.isFromStateServiceCache||e.origin.eventTrigger===l.MediaVolumeChanged}shouldSyncMediaEnded(e){return e.origin.isFromLocalCache||e.origin.isFromRoleChange||e.origin.isFromStateServiceCache||e.origin.eventTrigger!==l.MediaEnded}shouldSuppressMediaSyncEvent(e,t){return!((e!==l.MediaVolumeChanged||!this.shouldSuppressVolumeChangedEvents())&&(!t||!this.isLoopingBackgroundVideo(t))&&(!this.m_mediaSyncLock||this.m_mediaSyncLock.shouldSendMediaUpdate())&&!this.m_fSuppressMediaSyncEvents)}shouldSuppressVolumeChangedEvents(){return g.a.sendTraceTag(507003651,_.a.msoulscat_Wac_PptSession,S.a.Info,"shouldSuppressVolumeChangedEvents: "+JSON.stringify({mediaName:this.m_media.name,globalMuteEnabled:!0,isGlobalMute:this.m_environment.isGlobalMute,globallyUnmuting:this.m_fIsGloballyUnmuting})),!(!this.m_environment.isGlobalMute&&!this.m_fIsGloballyUnmuting||(this.m_fIsGloballyUnmuting=!1,0))}updateGlobalMute(e){let t=!1;this.m_localMediaInfo&&this.m_localMediaInfo.el?(t=this.m_localMediaInfo.el.muted&&!e,this.m_localMediaInfo.el.muted=e):this.m_linkedMediaEl&&this.m_onlineVideoPlayer&&(t=!e&&this.m_fOnSlide&&!0===this.m_onlineVideoPlayer.isMuted(),e?this.m_onlineVideoPlayer.setMute():this.m_onlineVideoPlayer.setUnMute()),this.m_fIsGloballyUnmuting=t,g.a.sendTraceTag(507003650,_.a.msoulscat_Wac_PptSession,S.a.Info,`Updated global mute state for media ${this.m_media.name} (isGlobalMute: ${this.m_environment.isGlobalMute}, muted: ${e}, isGloballyUnmuting: ${this.m_fIsGloballyUnmuting})`)}resizeToScale(e){if(this.m_slideScale===e)return;let t;if(this.m_slideScale=e,this.m_localMediaEventsDiv&&(t=this.m_localMediaEventsDiv),this.m_linkedMediaEl&&(t=this.m_linkedMediaEl),t){const e=this.getAdjustedBounds();this.setSizeAndScale(t,new m.f(e.width,e.height))}}mutePlayingMedia(){if(!this.m_fMutingOtherMedia&&this.isPlaying())if(g.a.sendTraceTag(507003649,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement.mutePlayingMedia: Muting media name: ${this.m_media.name}}`),this.m_fMuteSyncDisabled=!0,this.m_localMediaInfo&&this.m_localMediaInfo.el)this.m_fPreviouslyMuted=this.m_localMediaInfo.el.muted,this.m_localMediaInfo.el.muted=!0;else if(this.m_onlineVideoPlayer){const e=this.m_onlineVideoPlayer.isMuted();void 0!==e&&(this.m_fPreviouslyMuted=e),this.m_onlineVideoPlayer.setMute()}}muteAllPlayingMediaiOS(){const e=this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.isSeeking();Xe(this.m_environment)&&!e&&(g.a.sendTraceTag(507003648,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement: Muting all playing media (iOS only)"),this.m_fMutingOtherMedia=!0,this.m_environment.muteAllPlayingMedia(),this.m_fMutingOtherMedia=!1)}restorePreviousMuteState(){this.m_fMuteSyncDisabled&&(g.a.sendTraceTag(507003619,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement.restorePreviousMuteState: Previously muted: ${this.m_fPreviouslyMuted}, media name: ${this.m_media.name}}`),this.m_fPreviouslyMuted?this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!0:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setMute():this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!1:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setUnMute(),this.m_fMuteSyncDisabled=!1)}static logMediaSyncEmission(e,t){g.a.sendTraceTag(507003618,_.a.msoulscat_Wac_PptSession,S.a.Info,`MediaViewElement: Emitting Media Sync ${t?"Initial State":"Event"}: ${JSON.stringify(e)}`)}updatePixelScale(){this.m_pixelScale=this.m_environment.rendererEnvironment.getPixelScale(this.m_slideSizePixels),this.m_localMediaPlaybackPerf&&(this.m_localMediaPlaybackPerf.pixelScale=this.m_pixelScale)}static getMediaLengthFromMediaUrl(e){let t;const i=e.searchParams.get("mediaLength");return null!==i&&(t=Number(i)),Number.isNaN(t)?void 0:t}setIsHlsForTelemetry(e){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setHls(e),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setHls(e)}setHlsBandwidthEstimatesForTelemetry(e){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setHlsBandwidthEstimate(e)}shouldSkipAnimation(e){if(!G.ChangeGate.isChangeGateEnabled("SVM.SkipAnimationIfPlayed")||!this.m_firstPlayAnimation||1!==e)return!1;const t=this.getMediaCurrentState(),i=t&&t.playerState&&(t.playerState===c.MediaPlayed||t.playerState===c.MediaEnded),n=this.getMediaCurrentState(),r=n&&n.position?n.position:0;let a=!1;if(a=G.ChangeGate.isChangeGateEnabled("SVM.checkTrimStartTime")?Math.abs(r-this.m_media.trimStartMs/1e3)>.1:0!==r,!i&&!a)return!1;if(g.a.sendTraceTag(507003617,_.a.msoulscat_Wac_PptSession,S.a.Info,""+JSON.stringify({Description:"MediaViewElement.shouldSkipAnimation - Skipping play animation since the video has already played",playerPlayed:i,playerNotAtStart:a,position:r,trimStartMs:this.m_media.trimStartMs,playerState:t?t.playerState:"undefined"})),G.ChangeGate.isChangeGateEnabled("SVM.suppressMediaNextStep")&&!this.isPresenter())return g.a.sendTraceTag(507003616,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaViewElement.shouldSkipAnimation - Skipping mediaAnimation-nextStep since we're an attendee"),!0;this.m_firstPlayAnimation=!1;const s=F.a.readNumberOrDefault("mediaNextStepDelay",100);return window.setTimeout(()=>this.m_slideEvents.emit("mediaAnimation-nextStep"),s),!0}onLocalPlaybackQualityImpactError(e){const t=e;t.qosVeto=e.impactType,J.e.recordVeto(t.qosVeto,t)}constructor(e,t,i,n,r,a,s){if(this.shapeType=u.Media,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_fChangingSlide=!1,this.m_lastAnimTimeMS=0,this.m_fHasMediaBeenSynced=!1,this.m_fHasCustomPlayButtonBeenSynced=!1,this.m_fHasOnlineVideoPlayButtonBeenClicked=!1,this.m_fIsPlayerReady=!1,this.m_fSuppressMediaSyncEvents=!0,this.m_fIsGloballyUnmuting=!1,this.m_shouldRenderToCanvas=!1,this.m_hasPendingRender=!1,this.m_fLogCanvasRenderError=!0,this.m_logCanvasInfo=!0,this.m_fCropForCanvasRender=!1,this.m_firstPlayAnimation=!0,this.m_fOnSlide=!1,this.m_isNotAllowedError=!1,this.m_fMuteSyncDisabled=!1,this.m_fPreviouslyMuted=!1,this.m_fMutingOtherMedia=!1,this.m_fIsFirstNavigation=!0,this.m_requestGuid=Object(ri.v4)(),this.m_slideScale=1,this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsErrorCount=0,this.m_hlsAutoRecoverRetryCount=0,this.m_wasLoadStarted=!1,this.m_wasMetadataLoaded=!1,this.m_pixelScale=new m.f(1,1),this.m_wasTranscodingRequested=!1,this.id=e.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_slideSizePixels=r,this.m_shapeViewData=t,this.m_slideEvents=a,this.m_isLoopingBackgroundVideo=void 0,this.m_fCropInSVG=void 0,this.m_presenterToPresenterMediaCycleLockMs=F.a.readNumberOrDefault("presenterToPresenterMediaCycleLockMs",1e3),(je(n)||F.a.readBooleanOrDefault("enablePresenterToPresenterMediaCycleLock",!1))&&(this.m_mediaSyncLock=new it(this.m_presenterToPresenterMediaCycleLockMs)),this.m_slideEvents.on("navigatingFrom",()=>{if(this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!0),this.m_fSuppressMediaSyncEvents=!0,this.m_localMediaPlaybackController&&!this.m_media.playAcrossSlides&&this.m_localMediaPlaybackController.onNavigatingFrom(),this.m_localMediaInfo&&this.m_localMediaInfo.el){if(this.m_media.playAcrossSlides&&this.m_mediaType===Kt.a.Audio)return;this.shouldCleanupLocalPlayerOnNavigatedFrom()||(this.resetCurrentTime(this.m_localMediaInfo),this.m_localMediaInfo.el.muted=!0,this.pauseMedia())}this.stopVideoFrameTracker("navigatingFrom"),this.isCaptionsEnabled()&&this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer.onNavigatingFrom(),this.m_onlineVideoPlayer&&this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.onNavigatingFrom(this.m_onlineVideoPlayer.getPlaybackData()),this.m_localMediaPlayer&&this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onNavigatingFrom(this.m_localMediaPlayer.getPlaybackData())}),this.m_slideEvents.on("navigatedFrom",()=>{this.m_fOnSlide=!1,this.m_fHasMediaBeenSynced=!1,this.m_fIsPlayerReady=!1,this.m_fHasCustomPlayButtonBeenSynced=!1,this.m_fHasOnlineVideoPlayButtonBeenClicked=!1,this.m_fLinkedMediaReachedEnd&&(this.m_fLinkedMediaReachedEnd=!1),this.m_localMediaInfo&&(this.m_localMediaInfo.fReachedEnd=!1),this.cleanupLocalPlayerOnNavigatedFrom(),this.cleanupOnlinePlayerOnNavigatedFrom()}),this.m_slideEvents.on("navigatingTo",()=>{this.m_isPrefetch=!1,this.m_localMediaPlaybackController&&!this.m_media.playAcrossSlides&&this.m_localMediaPlaybackController.onNavigatingTo(),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onNavigatingTo(),this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!0),this.resetLocalPlayerOnNavigatingTo()}),this.m_slideEvents.on("navigatedTo",()=>{if(this.m_fOnSlide=!0,this.m_onlineVideoPlayer&&(this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.onNavigatedTo(),this.m_fIsFirstNavigation||this.m_onlineVideoPlayer.ensure(),(this.m_mediaType===Kt.a.YouTube||this.m_mediaType===Kt.a.Vimeo)&&this.isVideoPartiallyOffSlide())){const e=this.ensureLinkedMediaElementDiv(),t=Mn.getElementFromCollection(e.children,Si.LinkedMediaContainerName);this.handlePartiallyOffSlideLinkedMedia(t),g.a.sendTraceTag(507003851,_.a.msoulscat_Wac_PptSession,S.a.Info,`Linked media with type:${this.m_mediaType} is partially off slide.`)}this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onNavigatedTo(),this.m_media.autoPlay&&(g.a.sendTraceTag(507003850,_.a.msoulscat_Wac_PptSession,S.a.Info,`Calling playMedia on autoplay media ${this.m_media.name} upon arrival to slide`),this.playMedia()),this.m_fChangingSlide=!1,this.m_firstPlayAnimation=!0,this.m_isPrefetch=!1,this.m_fIsFirstNavigation=!1}),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",()=>this.beforeFirstRender()),!t.media)throw g.a.sendTraceTag(507003849,_.a.msoulscat_Wac_PptSession,S.a.Error,`MediaViewElement:: Invalid shapeViewData. media:${!!t.media}, animatableContents.length:${this.m_shapeViewData.animatableContents.length}, parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid media");const o=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_mediaSize=new m.f(o.region.rect.right-o.region.rect.left,o.region.rect.bottom-o.region.rect.top),this.m_mediaPosition=new m.f(o.pos.x,o.pos.y),this.m_media=t.media,this.m_mediaType=Si.getMediaType(this.m_media),this.m_isPrefetch=s||!1,this.m_environment=n,this.ShapeMediaTargetId="media-element-"+JSON.stringify(this.id),this.m_fLogCanvasRenderError=!0,this.updatePixelScale(),this.m_useTranscodedVideos=this.m_mediaType===Kt.a.Video&&(!F.a.readBooleanOrDefault("useTranscodingForMobileOnly",!1)||Ye(this.m_environment))&&this.isMediaDownloadHandlerEnabled(this.m_media.src),this.m_isTranscoded=this.m_useTranscodedVideos,this.m_initialRetryCount=this.getTotalRetryCount(),xn.updateMediaSource=e=>{this.m_localMediaInfo&&this.m_localMediaInfo.el&&(this.m_localMediaInfo.el.src=e),this.playLocalMedia()},xn.updateMediaSourceHLS=e=>{this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.setHlsSourceAsync(e,this.m_localMediaInfo.el),this.playLocalMedia()},this.m_gfxVideoSettings=this.createGfxVideoAppSettings(),Pe={getBoolean:e=>{const t=this.m_gfxVideoSettings[e];return"boolean"==typeof t?t:F.a.readBooleanOrDefault(e,!1)},getNumber:e=>{const t=this.m_gfxVideoSettings[e];return"number"==typeof t?t:F.a.readNumberOrDefault(e,0)},getString:e=>{const t=this.m_gfxVideoSettings[e];return"string"==typeof t?t:F.a.readStringOrDefault(e,"")}}}}Si.BD_HTML5_MEDIA_RETRY_COUNT=6,Si.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT=1,Si.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS=600,Si.BD_HTML5_MEDIA_RETRY_MULTIPLIER=2,Si.MIN_AUDIO_PLAYBACK_BAR_WIDTH=240,Si.MIN_AUDIO_PLAYBACK_BAR_HEIGHT=30,Si.LinkedMediaContainerName="LinkedMedia-Container",Si.LinkedMediaIFramename="LinkedMedia-IFrame",function(e){e[e.ShowAsImageEl=0]="ShowAsImageEl",e[e.ShowAsVideoEl=1]="ShowAsVideoEl",e[e.FramesToCanvas=2]="FramesToCanvas"}(ni||(ni={}));class vi{ensure(){this.m_shapeItem||this.init();const e={};if(!this.m_shapeItem)return g.a.sendTraceTag(507003983,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::ensure: invalid shapeItem."),e.invalidShape=!0,e;const t=$.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return{...e,...t}}init(){this.animatableContentViewElements=[],this.m_shapeItem=$.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.m_gifInfo?this.m_gifInfo.mode===ni.ShowAsImageEl?(this.initImageEl(this.m_gifInfo),this.m_gifInfo.imageEl.addEventListener("load",()=>this.onMediaLoaded())):(this.initVideoEl(this.m_gifInfo),this.m_gifInfo.videoEl.addEventListener("load",()=>this.onMediaLoaded())):g.a.sendTraceTag(507003982,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::init: invalid gifInfo.")}initImageEl(e){const t=document.createElement("img");t.id=e.elID,t.width=e.size.x,t.height=e.size.y,t.style.left=e.position.x+"px",t.style.top=e.position.y+"px",t.style.position="absolute",t.style.pointerEvents="none",t.style.zIndex="4",e.props.imageUrl?(t.addEventListener("error",()=>this.onImageError(e)),t.src=this.getRetryUrl(e.props.imageUrl,e.retriesRemaining,!1)):t.src=e.props.src,G.ChangeGate.isChangeGateEnabled("SVM.AnimatedGIFAriaHidden")&&t.setAttribute("aria-hidden","true"),e.imageEl=t}initVideoEl(e){const t=document.createElement("video");t.id=e.elID,t.width=e.size.x,t.height=e.size.y,t.style.left=e.position.x+"px",t.style.top=e.position.y+"px",t.style.position="absolute",t.style.pointerEvents="none",t.style.zIndex="4",t.crossOrigin="anonymous",t.autoplay=!0,t.controls=!1,t.loop=!0,t.muted=!0,t.playsInline=!0,g.a.sendTraceTag(507003981,_.a.msoulscat_Wac_PptSession,S.a.Info,"GifViewElement::initVideoEl: Set playsInline flag to true"),e.props.videoUrl?(t.addEventListener("error",()=>this.onVideoError(e)),t.src=this.getRetryUrl(e.props.videoUrl,e.retriesRemaining,!0)):t.src=e.props.src,G.ChangeGate.isChangeGateEnabled("SVM.AnimatedGIFAriaHidden")&&t.setAttribute("aria-hidden","true"),e.videoEl=t,this.initLocalMediaPlaybackPerf()}initLocalMediaPlaybackPerf(){if(!this.m_localMediaPlaybackPerf&&this.m_gifInfo&&this.m_gifInfo.videoEl)try{this.m_localMediaPlaybackPerf=new ei(this.m_gifInfo.videoEl,this.m_pixelScale,this.m_slideEvents,Ge(this.m_environment),null,null,this.m_environment.viewDataManager.getSlideIndex(this.m_slideId),this.m_environment.settings.startFromTime,this.m_environment.settings.initTime,this.m_gifInfo,vi.s_downloadMaxRetryCount,!1,this.m_environment.settings.teamsCallId)}catch(e){g.a.sendTraceTag(507003980,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::initVideoEl Failed to construct LocalVideoPlaybackPerf "+e)}if(this.m_localMediaPlaybackPerf&&this.m_gifInfo&&this.m_gifInfo.videoEl)try{this.m_localMediaPlaybackPerf.onSourceSet(this.m_gifInfo.videoEl.src)}catch(e){g.a.sendTraceTag(507003979,_.a.msoulscat_Wac_PptSession,S.a.Error,"Exception in LocalVideoPlaybackSummary.onSourceSet: "+e)}}update(){if(!this.m_gifInfo)return;const e=this.m_gifInfo.mode;let t=!1;if(G.ChangeGate.isChangeGateEnabled("SVM.LinkForAnimatedGIF")&&$.ensureClickTarget(this.id,this.m_shapeViewData,this.m_slideEvents,this.m_environment),this.m_gifInfo.videoEl&&(e===ni.ShowAsVideoEl||e===ni.FramesToCanvas)){t=vi.isVideoLoaded(this.m_gifInfo.videoEl);const i=vi.ensureDOMElement(this.m_gifInfo.elID,this.m_gifInfo.videoEl,this.id,t);i&&t&&(i.style.left=this.m_gifInfo.position.x+"px",i.style.top=this.m_gifInfo.position.y+"px",i.width=this.m_gifInfo.size.x,i.height=this.m_gifInfo.size.y,i.hidden=e===ni.FramesToCanvas,i.paused&&i.play(),i.hidden?this.drawFrame(this.m_gifInfo.videoEl):this.m_fInSlideTransition||this.unloadPoster(),this.m_gifInfo.imageEl=void 0)}if(this.m_gifInfo.imageEl&&(e===ni.ShowAsImageEl||!t)){t=vi.isImageLoaded(this.m_gifInfo.imageEl);const e=vi.ensureDOMElement(this.m_gifInfo.elID,this.m_gifInfo.imageEl,this.id,t);e&&t&&(e.style.left=this.m_gifInfo.position.x+"px",e.style.top=this.m_gifInfo.position.y+"px",e.width=this.m_gifInfo.size.x,e.height=this.m_gifInfo.size.y,this.m_fInSlideTransition||this.unloadPoster())}t||this.m_fLoadedPoster||this.loadPoster(!0),$.ensureAccessibilityElement(this.id)}loadPoster(e){this.m_posterImage&&this.m_posterImage.src?e&&vi.isImageLoaded(this.m_posterImage)&&(this.drawFrame(this.m_posterImage),this.m_fLoadedPoster=!0):this.m_gifInfo&&this.m_gifInfo.props.src.startsWith("data")&&(this.m_posterImage=new Image,e&&(this.m_posterImage.onload=()=>{this.drawFrame(this.m_posterImage),this.m_fLoadedPoster=!0}),this.m_posterImage.src=this.m_gifInfo.props.src)}unloadPoster(){if(this.m_shapeItem)for(const e of this.m_shapeItem.getBrushImages())e.id&&(e.releaseGeneratedResources(),this.m_fLoadedPoster=!1)}drawFrame(e){const t=this.m_environment.rendererEnvironment.glContext;if(!t||t.isContextLost())return void g.a.sendTraceTag(507003978,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::drawFrame: missing glContext.");let i=this.m_gifTexture?this.m_gifTexture.tryGetWebGLTexture():void 0;if(!this.m_gifTexture||!i){this.m_gifTexture&&this.cleanUp();const e=new m.f(this.m_gifInfo.size.x,this.m_gifInfo.size.y);$.verifyTextureSize(this.m_environment,"gif",e);const t=new O.b("Gif",this.m_environment.rendererEnvironment.renderer,e,O.e.KeepUntilRelease);if(i=t.tryGetWebGLTexture(),this.m_environment.viewDataManager.memoryStats.gifTextures+=this.m_gifInfo.size.x*this.m_gifInfo.size.y*4,!i)return void g.a.sendTraceTag(507003977,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::drawFrame: failed to create gif target texture.");this.m_gifTexture=t}if(this.m_shapeItem){t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.bindTexture(t.TEXTURE_2D,null);for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_gifTexture),this.m_gifTexture.changeTracker.notifyChange())}else g.a.sendTraceTag(507003976,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::drawFrame: ShapeItem:"+!!this.m_shapeItem)}applyAnimation(e){this.m_shapeItem&&$.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&$.removeFromScene(e,this.m_shapeItem)}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.rendererEnvironment.flush()),this.fPrepared}cleanUp(){const e=this.m_environment.rendererEnvironment.glContext;e&&!e.isContextLost()&&this.m_gifTexture&&(this.m_gifTexture.release(),this.m_environment.viewDataManager.memoryStats.gifTextures-=this.m_gifInfo.size.x*this.m_gifInfo.size.y*4),this.m_gifTexture=void 0}get shapeItem(){return this.m_shapeItem}onNavigatingTo(){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onNavigatingTo(),this.m_fInSlideTransition=!0,this.m_gifInfo&&(this.m_gifInfo.mode===ni.FramesToCanvas&&vi.isVideoLoaded(this.m_gifInfo.videoEl)||this.loadPoster(!0),vi.isVideoLoaded(this.m_gifInfo.videoEl)&&(this.m_gifInfo.videoEl.currentTime=0))}onNavigatingFrom(){this.m_fInSlideTransition=!0,this.m_gifInfo&&(this.m_gifInfo.mode===ni.FramesToCanvas&&vi.isVideoLoaded(this.m_gifInfo.videoEl)||this.loadPoster(!0))}onBeforeFirstRenderAfterNavigation(){this.m_fInSlideTransition=!1}onMediaLoaded(){this.m_gifInfo&&(this.m_gifInfo.mode!==ni.FramesToCanvas&&this.update(),g.a.sendTraceTag(507003975,_.a.msoulscat_Wac_PptSession,S.a.Info,"MediaLoaded: "+JSON.stringify(vi.getGifInfoLog(this.m_gifInfo,"GifViewElement::onMediaLoaded"))))}onImageError(e){const t=e.imageEl;t?e.retriesRemaining<=0?J.e.recordVeto("GIFFailure",{errorName:"GIFAsImageRetryFailed",qosVeto:"GIFFailure",mediaType:"GIF",mediaName:`${this.id.slideId.sid}s${this.id.shapeId}`,requestGuid:this.m_imageRequestGuid,...vi.getGifInfoLog(e,"GIFAsImageRetryFailed")}):window.setTimeout(()=>{!vi.isImageLoaded(t)&&e.props.imageUrl&&(e.mode===ni.ShowAsImageEl&&(e.retriesRemaining-=1,e.retryTimeoutMs*=2),t.src=this.getRetryUrl(e.props.imageUrl,e.retriesRemaining,!1))},e.retryTimeoutMs):g.a.sendTraceTag(507003974,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::onImageError: "+JSON.stringify(vi.getGifInfoLog(e,"Invalid gif element.")))}onVideoError(e){const t=e.videoEl;if(!t)return void g.a.sendTraceTag(507003973,_.a.msoulscat_Wac_PptSession,S.a.Error,"GifViewElement::onVideoError: "+JSON.stringify(vi.getGifInfoLog(e,"Invalid gif element")));const i=vi.getGifInfoLog(e,"GIFAsVideoRetryFailed"),n={errCode:t.error?t.error.code:"unknown",errMessage:t.error?t.error.message:"unknown",canPlayType:t.canPlayType(i.type),fallbackLoaded:vi.isImageLoaded(e.imageEl)};if(i.err=n,g.a.sendTraceTag(507003972,_.a.msoulscat_Wac_PptSession,S.a.Warning,"GifViewElement::onVideoError: "+JSON.stringify(i)),e.retriesRemaining<=0)n.fallbackLoaded?J.e.recordVeto("GIFFallbackToImage",{qosVeto:"ContentFallback"}):J.e.recordVeto("GIFFailure",{errorName:"GIFAsVideoRetryFailed",qosVeto:"GIFFailure",mediaType:"GIF",mediaName:`${this.id.slideId.sid}s${this.id.shapeId}`,requestGuid:this.m_videoRequestGuid,...i});else{if(!n.canPlayType)return e.mode=ni.ShowAsImageEl,void this.initImageEl(e);e.retriesRemaining!==vi.s_downloadGifFallbackInRetry||n.fallbackLoaded||this.initImageEl(e),window.setTimeout(()=>{!vi.isVideoLoaded(e.videoEl)&&e.props.videoUrl&&(e.retriesRemaining-=1,e.retryTimeoutMs*=2,e.videoEl.src=this.getRetryUrl(e.props.videoUrl,e.retriesRemaining,!0),this.m_localMediaPlaybackPerf&&e.videoEl&&e.videoEl.src&&this.m_localMediaPlaybackPerf.onSourceSet(e.videoEl.src))},e.retryTimeoutMs)}}static ensureDOMElement(e,t,i,n){let r=document.getElementById(e);if(!r||r!==t){if(!document.getElementById(Mn.SlideLevelHtmlElementsParentDivId))return g.a.sendTraceTag(507003971,_.a.msoulscat_Wac_PptSession,S.a.Error,`GifViewElement::ensureDOMElement: couldn't find ${Mn.SlideLevelHtmlElementsParentDivId}.`),null;const e=$.ensureShapeViewElementParentDiv(i,"2");n&&(r=r?e.replaceChild(t,r):e.appendChild(t))}return r}static isImageLoaded(e){return!!e&&e.complete&&0!==e.naturalWidth&&0!==e.naturalHeight}static isVideoLoaded(e){return!!e&&e.readyState>=3}getRetryUrl(e,t,i){const n=new URL(e);n.searchParams.append("retries",t.toString());const r=`${this.id.slideId.sid}s${this.id.shapeId}`;return n.searchParams.append("mediaName",r),n.searchParams.set("usid",this.m_environment.settings.sessionId),n.searchParams.append("requestGuid",i?this.m_videoRequestGuid:this.m_imageRequestGuid),n.toString()}static getGifInfoLog(e,t){let i=["",""];try{const t=e.mode===ni.ShowAsImageEl?e.props.imageUrl:e.props.videoUrl,n=new URL(t||"").searchParams.get("mediaId")||"",r=new RegExp(/^(\w+).(\w+).media$/i).exec(n);if(r&&3===r.length){const t=e.mode===ni.ShowAsImageEl?"image":"video";i=[r[1],`${t}/${r[2]}`.toLowerCase()]}}catch{i=["err","err"]}return{elId:e.elID,mediaId:i[0],type:i[1],mode:e.mode,src:e.props.src.split(";",1)[0],retry:e.retriesRemaining,msg:t}}constructor(e,t,i,n,r,a){if(this.shapeType=u.GIF,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_fLoadedPoster=!1,this.m_fInSlideTransition=!1,this.m_videoRequestGuid=Object(ri.v4)(),this.m_imageRequestGuid=Object(ri.v4)(),this.id=e.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_environment=r,this.m_pixelScale=r.rendererEnvironment.clientSize.scale(window.devicePixelRatio).divide(a),!t.gif)throw g.a.sendTraceTag(507003985,_.a.msoulscat_Wac_PptSession,S.a.Error,`GifViewElement:: Invalid shapeViewData. gif:${!!t.gif},\n        animatableContents.length:${this.m_shapeViewData.animatableContents.length},\n        parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid gif");const s=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_gifInfo={elID:"gif-element-"+JSON.stringify(this.id),size:new m.f(s.region.rect.right-s.region.rect.left,s.region.rect.bottom-s.region.rect.top),position:new m.f(s.pos.x,s.pos.y),retriesRemaining:vi.s_downloadMaxRetryCount,retryTimeoutMs:vi.s_downloadInitialRetryDelayMs,mode:ni.ShowAsImageEl,props:t.gif};let o=decodeURIComponent(r.settings.serverUrl);"/"===o.slice(-1)&&(o=o.slice(0,-1)),this.m_gifInfo.props.imageUrl&&(this.m_gifInfo.mode=ni.ShowAsImageEl,this.m_gifInfo.props.imageUrl.includes("MediaDownloadHandler")||(this.m_gifInfo.props.imageUrl=`${o}${this.m_gifInfo.props.imageUrl.substring(1)}`)),this.m_gifInfo.props.videoUrl&&(this.m_gifInfo.mode=ni.FramesToCanvas,this.m_gifInfo.props.videoUrl.includes("MediaDownloadHandler")||(this.m_gifInfo.props.videoUrl=`${o}${this.m_gifInfo.props.videoUrl.substring(1)}`)),this.m_slideEvents=n,this.m_slideEvents.on("navigatingTo",()=>this.onNavigatingTo()),this.m_slideEvents.on("navigatingFrom",()=>this.onNavigatingFrom()),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",()=>this.onBeforeFirstRenderAfterNavigation()),this.loadPoster(!1),g.a.sendTraceTag(507003984,_.a.msoulscat_Wac_PptSession,S.a.Info,"GifViewElement ctor: "+JSON.stringify(vi.getGifInfoLog(this.m_gifInfo,"GifViewElement::ctor")))}}vi.s_downloadMaxRetryCount=5,vi.s_downloadGifFallbackInRetry=3,vi.s_downloadInitialRetryDelayMs=800;class yi{ensure(){let e={addinInfo:{instanceId:this.m_appForOffice.InstanceId,solutionId:this.m_appForOffice.AppForOfficeRef.Id,storeId:this.m_appForOffice.AppForOfficeRef.Store,storeType:this.m_appForOffice.AppForOfficeRef.StoreType}};if(!this.m_shapeItem){const t=this.init();e={...e,...t}}if(!this.m_shapeItem)return g.a.sendTraceTag(507004122,_.a.msoulscat_Wac_PptSession,S.a.Error,"AddinViewElement::ensure: invalid shapeItem."),e.invalidShape=!0,e;const t=$.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return{...e,...t}}init(){const e={showAppForOffice:{start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()}};if(this.animatableContentViewElements=[],this.m_shapeItem=$.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.m_environment.addinManager){this.m_addinElement=this.ensureAddinElementDiv();const t=this.m_environment.addinManager.showAppForOffice(this.m_addinElement,this.m_slideId,this.m_appForOffice,this.m_appForOfficeTheme);e.showAppForOffice=t}return e}update(){this.m_environment.addinManager&&this.m_addinElement&&($.ensureShapeViewElementParentDiv(this.id,"2").appendChild(this.m_addinElement),this.m_environment.addinManager.updateAppForOfficeLayout(this.m_addinElement,this.m_appForOffice),this.shapeItem&&(this.shapeItem.isHidden=!0)),$.ensureAccessibilityElement(this.id)}ensureAddinElementDiv(){let e=document.getElementById(this.ShapeAddinTargetId);if(e)return e;e=document.createElement("div"),e.id=this.ShapeAddinTargetId;const t=document.getElementById(Mn.PreactivedAddinsDivId);return t&&t.appendChild(e),e}applyAnimation(e){}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&$.removeFromScene(e,this.m_shapeItem)}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,10),this.m_environment.rendererEnvironment.flush()),this.fPrepared}cleanUp(){}get shapeItem(){return this.m_shapeItem}constructor(e,t,i,n){if(this.shapeType=u.Addin,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=e.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_environment=n,!t.appForOffice)throw g.a.sendTraceTag(507004123,_.a.msoulscat_Wac_PptSession,S.a.Error,`AddinViewElement:: Invalid shapeViewData. Addin:${!!t.appForOffice}, animatableContents.length:${this.m_shapeViewData.animatableContents.length}, parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid Addin");this.m_appForOffice=t.appForOffice,this.m_appForOfficeTheme=t.appForOfficeTheme,this.ShapeAddinTargetId="addin-element-"+JSON.stringify(this.id)}}var Ti=i(79),bi=i(43);class wi{ensure(){return this.m_shapeItem||this.init(),this.m_shapeItem?$.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData,{shapeId:this.id}):(g.a.sendTraceTag(506545103,_.a.msoulscat_Wac_PptSession,S.a.Error,"ShapeViewElement::ensureTexture: invalid shapeItem."),{invalidShape:!0})}init(){this.animatableContentViewElements=[];const e=this.m_shapeViewData.model3d.data,t=Object(bi.b)(e.txW,e.txH);let n;n=t>Ti.a?bi.a.TextureSizeMax:Object(bi.c)(t);const r={size:new m.f(n,n),position:new m.f(Object(bi.e)(this.m_shapeViewData.model3d.cx)-n/2,Object(bi.e)(this.m_shapeViewData.model3d.cy)-n/2)};$.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment);const a=new y.h;a.id=`${this.id.shapeId}-${this.id.slideId.cid}-${this.id.slideId.sid}`;const s=new y.g(a),o=T.j.CreateRectangle(m.d.FromSize(r.size),new y.x(s),void 0,new m.e(r.position));if(B(o).shapeId=this.id,this.m_shapeItem=o,!this.m_modelUrl)return void g.a.sendTraceTag(506545102,_.a.msoulscat_Wac_PptSession,S.a.Error,"Model3DViewElement::init: invalid model3DInfo.");if(!this.m_environment.rendererEnvironment.glContext)return void g.a.sendTraceTag(506545101,_.a.msoulscat_Wac_PptSession,S.a.Error,"Model3DViewElement::init: no gl context available.");if(!this.m_shapeItem)return void g.a.sendTraceTag(506545100,_.a.msoulscat_Wac_PptSession,S.a.Error,"Model3DViewElement::init: no shape item available.");const l=this.m_environment.rendererEnvironment.renderer.getBabylonEngine();l?i.e(0).then(i.bind(null,440)).then(({Model3DInstance:e})=>{this.m_model3dInstance=new e(l,this.m_environment,{position:this.m_mediaPosition,size:this.m_mediaSize,url:this.m_modelUrl,filename:this.m_shapeViewData.model3d.data.mId},this.m_shapeViewData.model3d.data),this.m_model3dInstance.onAfterRenderCallback=()=>{for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_model3dInstance.getTargetTexture()),this.m_model3dInstance.getTargetTexture().changeTracker.notifyChange())}}).catch(e=>{g.a.sendTraceTag(506545098,_.a.msoulscat_Wac_PptSession,S.a.Error,"Model3DViewElement::init: error importing Model3DInstance: "+e)}):g.a.sendTraceTag(506545099,_.a.msoulscat_Wac_PptSession,S.a.Error,"Model3DViewElement::init: no engine available.")}ensureClickTarget(){this.m_shapeItem||console.log("ensureClickTarget",this.m_slideEvents),this.ensureClickTargetDiv()}ensureClickTargetDiv(){const e=$.ensureShapeViewElementParentDiv(this.id,"2");return e.style.pointerEvents="none",e}update(){this.ensureClickTarget(),$.ensureAccessibilityElement(this.id),this.m_model3dInstance&&this.m_model3dInstance.isReady&&this.m_model3dInstance.renderFrame()}applyAnimation(e){if(this.m_model3dInstance&&e.Attributes.some(e=>e.AttrId===v.c.Visible)){const t={};let i=!1;e.Attributes.forEach(e=>{e.AttrId!==v.c.ViewRotationX&&e.AttrId!==v.c.ViewRotationY&&e.AttrId!==v.c.ViewRotationZ&&e.AttrId!==v.c.ViewScaleX&&e.AttrId!==v.c.ViewScaleY&&e.AttrId!==v.c.ViewScaleZ&&e.AttrId!==v.c.ViewTranslateX&&e.AttrId!==v.c.ViewTranslateY&&e.AttrId!==v.c.ViewTranslateZ&&e.AttrId!==v.c.ObjectRotationX&&e.AttrId!==v.c.ObjectRotationY&&e.AttrId!==v.c.ObjectRotationZ&&e.AttrId!==v.c.ObjectScaleX&&e.AttrId!==v.c.ObjectScaleY&&e.AttrId!==v.c.ObjectScaleZ&&e.AttrId!==v.c.ObjectTranslateX&&e.AttrId!==v.c.ObjectTranslateY&&e.AttrId!==v.c.ObjectTranslateZ||(i=!0),t[e.AttrId]=e.Value}),this.m_model3dInstance.applyAnimationState(t,i)}}tryPrepare(e){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,e),this.m_environment.rendererEnvironment.flush()),this.fPrepared}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){if(this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)){const t=e.items.elements.slice(0);t.splice(e.items.elements.indexOf(this.m_shapeItem),1),e.setItems(t)}}cleanUp(){this.m_model3dInstance&&(this.m_model3dInstance.release(),this.m_model3dInstance=void 0)}onNavigatingTo(){this.m_model3dInstance&&this.m_model3dInstance.resetTransformation()}onNavigatingFrom(){this.m_model3dInstance&&this.m_model3dInstance.stopAllAnimations()}onBeforeFirstRenderAfterNavigation(){this.m_model3dInstance&&this.m_model3dInstance.onBeforeFirstRenderAfterNavigation()}get shapeItem(){return this.m_shapeItem}constructor(e,t,i,n,r,a){if(this.shapeType=u.Model3D,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=e.id,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_slideEvents=n,this.m_environment=r,this.m_shapeItem=a&&a.item||void 0,!this.m_shapeViewData.model3d)throw g.a.sendTraceTag(506545104,_.a.msoulscat_Wac_PptSession,S.a.Error,`Model3DViewElement:: Invalid shapeViewData. Missing model3d.\nanimatableContents.length:${this.m_shapeViewData.animatableContents.length},\nparts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid 3d model");if(!this.m_environment.rendererEnvironment.renderer.getBabylonEngine())throw new Error("No ThinEngine instance found");const s=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_mediaSize=new m.f(s.region.rect.right-s.region.rect.left,s.region.rect.bottom-s.region.rect.top),this.m_mediaPosition=new m.f(s.pos.x,s.pos.y),this.m_modelUrl=Object(bi.g)(this.m_shapeViewData.model3d.data.mId,this.m_environment.settings.serverUrl),this.m_slideEvents.on("navigatingTo",()=>this.onNavigatingTo()),this.m_slideEvents.on("navigatingFrom",()=>this.onNavigatingFrom()),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",()=>this.onBeforeFirstRenderAfterNavigation())}}class Ci{ensure(){this.shapeItem||this.init();const e={};return this.shapeItem||(g.a.sendTraceTag(506523667,_.a.msoulscat_Wac_PptSession,S.a.Error,"InkViewElement::ensure: invalid shapeItem."),e.invalidShape=!0),e}makeShape(e){const t=e.color.r/255,i=e.color.g/255,n=e.color.b/255,r=new y.l(e.width);r.lineHeight=e.height;let a=y.a.normal;e.height>Ci.standardPenWidth&&(a=y.a.darken);const s=this.getTexture(),o=new y.x(void 0,new y.v(new y.d(t,i,n,1)),r,a),l=new T.j(void 0,o);l.incrementalPath=new C.c(s,C.g.position|C.g.type|C.g.pressure),this.shapeItem&&(this.shapeItem.items.push(l),this.currIncrementalPath=null==l?void 0:l.incrementalPath)}getTexture(){let e=0,t=this.m_slidePixelSize.x,i=0,n=this.m_slidePixelSize.y;if(this.m_shapeViewData.ink){const r=this.m_shapeViewData.ink.points;for(let a=this.m_pointIndex;a<r.length&&!(a>=r.length)&&r[a].k!==s.move;a++)r[a].pos.x<e&&(e=r[a].pos.x),r[a].pos.x>t&&(t=r[a].pos.x),r[a].pos.x<i&&(i=r[a].pos.x),r[a].pos.x>n&&(n=r[a].pos.x)}return new m.d(e-30,i-30,t+30,n+30)}init(){this.animatableContentViewElements=[];for(const e of this.m_shapeViewData.animatableContents){const t=[];for(const i of e.parts){const e=$.toPositionSize(i.regionPos),n={fShape:i.fShape,fText:i.fText,bigParts:i.bigParts,position:e.position,size:e.size,shapeId:i.shapeId};t.push(n)}this.animatableContentViewElements.push({id:e.id,parts:t})}const e=this.m_shapeViewData.ink;void 0!==e?(this.shapeItem=new T.d([]),this.m_lastTime=e.lastTime):g.a.sendTraceTag(506523666,_.a.msoulscat_Wac_PptSession,S.a.Error,"InkViewElement::init: inkDataList is undefined.")}applyAnimation(e,t){var i;if(!this.shapeItem||!this.m_shapeViewData.ink)return;const n=v.b.getAnimAttributeValue(e.Attributes,v.c.InkProgress,0)*this.m_lastTime;if(this.m_prevTime>n&&(this.m_pointIndex=0,this.clearScreen()),this.m_pointIndex>=this.m_shapeViewData.ink.points.length)this.m_prevTime=n;else{for(;this.m_pointIndex<this.m_shapeViewData.ink.points.length;){const e=this.m_shapeViewData.ink.points[this.m_pointIndex];if(!(e.time<=n))break;e.k!==s.clear?(e.k===s.move&&(this.m_shapeIndex++,this.m_prevPoint=void 0),this.drawPoint(e),this.m_pointIndex++):(this.clearScreen(),this.m_pointIndex++)}null===(i=this.currIncrementalPath)||void 0===i||i.changeTracker.notifyChange(),this.m_prevTime=n}}clearScreen(){if(this.shapeItem){for(let e=0;e<this.shapeItem.items.elements.length;e++)this.shapeItem.items.elements[e].isHidden=!0,this.shapeItem.items.elements[e].changeTracker.notifyChange();this.shapeItem.changeTracker.notifyChange()}}drawPoint(e){const t=new m.f(e.pos.x,e.pos.y);if(e.k===s.move){if(void 0===e.pen)return void g.a.sendTraceTag(506523665,_.a.msoulscat_Wac_PptSession,S.a.Error,"InkViewElement::drawPoint: On pen move, pen is undefined.");if(this.makeShape(e.pen),void 0===this.currIncrementalPath)return void g.a.sendTraceTag(506523664,_.a.msoulscat_Wac_PptSession,S.a.Error,"InkViewElement::drawPoint: On pen move, currIncrementalPath is undefined.");this.currIncrementalPath.currentFigure.moveToPoint(t,[4096])}else if(e.k===s.draw&&this.m_prevPoint){if(void 0===this.currIncrementalPath)return void g.a.sendTraceTag(506523663,_.a.msoulscat_Wac_PptSession,S.a.Error,"InkViewElement::drawPoint: On pen move, currIncrementalPath is undefined.");const e=m.f.InterpolateLinear(this.m_prevPoint,t,.5);this.currIncrementalPath.currentFigure.quadBezierToPoint(this.m_prevPoint,e,[4096])}this.m_prevPoint=t}update(){}tryPrepare(){return!0}addToScene(e){this.shapeItem&&e.items.push(this.shapeItem)}removeFromScene(e){this.shapeItem&&-1!==e.items.elements.indexOf(this.shapeItem)&&$.removeFromScene(e,this.shapeItem)}cleanUp(){}constructor(e,t,i){this.shapeType=u.Ink,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_shapeIndex=-1,this.m_pointIndex=0,this.m_lastTime=0,this.m_prevTime=0,this.id=e.id,this.m_shapeViewData=t,this.m_slidePixelSize=i,t.ink||g.a.sendTraceTag(506523668,_.a.msoulscat_Wac_PptSession,S.a.Error,`InkViewElement:: Invalid shapeViewData. ink:${!!t.ink},\n              animatableContents.length:${this.m_shapeViewData.animatableContents.length},\n              parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`)}}Ci.standardPenWidth=2.4;class Ii{async ensure(e){const t={sid:this.slideId.sid,ensureSlideViewData:{start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()}},i=await this.m_environment.viewDataManager.getSlideViewData(this.slideId,e?e.loadDataOptions:void 0);if(t.ensureSlideViewData.end=Mn.performanceNowTrimmed(),!i.resource)return g.a.sendTraceTag(506545113,_.a.msoulscat_Wac_PptSession,S.a.Warning,`SlideViewElement::ensure: missing slideViewData. sid:${this.slideId.sid}, correlation:${e?e.loadDataOptions?e.loadDataOptions.meta_correlationId:"":void 0}, errorName:${i.metadata.errorName}`),i.metadata.hasOwnProperty("errorName")&&(t.errorName=i.metadata.errorName),t;const n=i.resource;this.m_slideSizePixels=new m.f(n.slideSizePixels.x,n.slideSizePixels.y);let r={};if(0===this.shapeViewElements.length)n.fHasAddinShape&&n.fHasAddinShape&&this.m_environment.addinManager&&!this.m_environment.addinManager.fOsfruntimeLoaded()&&(t.loadOsfRuntime=await this.m_environment.addinManager.loadOsfRuntime()),r=await this.init(n,e);else for(const e of this.shapeViewElements){const i=e.ensure();Ii.processEnsureShapeResult(t,i,e.id.shapeId)}return{...t,...r}}async init(e,t){const i={initSlideVE_bg:{start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()}},n={slideId:this.slideId,shapeId:-1},r=this.m_slideSizePixels.x/this.m_environment.slideSizeEmus.x;let a;const s={shapeId:n,isBackground:!0,shapeBuilderData:{},animatableContents:[]};if(e.slideBackground&&e.slideBackground.solidFill){const t=e.slideBackground.solidFill.t/100,i=new y.d(Math.floor(255*t+(1-t)*e.slideBackground.solidFill.r)/255,Math.floor(255*t+(1-t)*e.slideBackground.solidFill.g)/255,Math.floor(255*t+(1-t)*e.slideBackground.solidFill.b)/255,1);a=T.j.CreateRectangle(new m.d(0,0,this.m_slideSizePixels.x,this.m_slideSizePixels.y),new y.x(new y.v(i)))}else if(e.slideBackground&&e.slideBackground.imageFill){const t=new y.h;t.id=e.slideBackground.imageFill.imgID;const i=new y.g(t);a=T.j.CreateRectangle(m.d.FromSize(new m.f(this.m_slideSizePixels.x,this.m_slideSizePixels.y)),new y.x(i))}if(a){B(a).isBackground=!0;const e=new q({id:s.shapeId},s,r,this.events,this.m_environment,{item:a});e.ensure(),this.shapeViewElements.push(e)}else g.a.sendTraceTag(506545112,_.a.msoulscat_Wac_PptSession,S.a.Error,"failed to create background");if(i.initSlideVE_bg.end=Mn.performanceNowTrimmed(),!this.m_slide.spLst)return i;i.initSlideVE_shapeViewData={start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()};const o=await this.getShapeViewDataInSlideAsync();i.initSlideVE_shapeViewData.end=Mn.performanceNowTrimmed(),i.initSlideVE_ensureShapeVE={start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()};const l={Media:0,Media_canvas:0,Gif:0,Addin:0,Cameo:0,Shape:0,Model3D:0,Ink:0};for(let e=0;e<this.m_slide.spLst.length;e+=1){const n=o[e];if(n)if(n.media){const a=Si.getMediaType(n.media);g.a.sendTraceTag(506545110,_.a.msoulscat_Wac_PptSession,S.a.Info,`SlideViewElement::init: MediaType:${a}, glContext:${this.m_environment.rendererEnvironment.glContext}`);const s=new Si(this.m_slide.spLst[e],n,r,this.m_environment,this.m_slideSizePixels,this.events,!!t&&t.isPrefetch),o=s.ensure();i.hasOwnProperty("metadata")?i.metadata.push(o):i.metadata=[o],Ii.processEnsureShapeResult(i,o,n.shapeId.shapeId),this.shapeViewElements.push(s),this.fHasContinuouslyAnimatedContent||F.a.readBooleanOrDefault("useIsMediaPlaying",!0)||(this.fHasContinuouslyAnimatedContent=s.shouldRenderToCanvas),s.shouldRenderToCanvas?l.Media_canvas+=1:l.Media+=1}else if(n.gif&&this.m_environment.rendererEnvironment.supportsGif){const t=new vi(this.m_slide.spLst[e],n,r,this.events,this.m_environment,this.m_slideSizePixels),a=t.ensure();a.hasOwnProperty("mediaType")&&(i.hasOwnProperty("metadata")?i.metadata.includes(a.mediaType)||i.metadata.push(a.mediaType):i.metadata=[a.mediaType]),Ii.processEnsureShapeResult(i,a,n.shapeId.shapeId),this.shapeViewElements.push(t),this.fHasContinuouslyAnimatedContent=!0,l.Gif+=1}else if(n.appForOffice){const t=new yi(this.m_slide.spLst[e],n,r,this.m_environment),a=t.ensure();Ii.processEnsureShapeResult(i,a,n.shapeId.shapeId),g.a.sendTraceTag(506545109,_.a.msoulscat_Wac_PptSlideshow,S.a.Info,"initSlideVE::ensureAddinVE::"+JSON.stringify(a)),this.shapeViewElements.push(t),l.Addin+=1}else if(n.cameo){const t=new K(this.m_slide.spLst[e],n,r,this.events,this.m_environment),a=t.ensure();Ii.processEnsureShapeResult(i,a,n.shapeId.shapeId),this.shapeViewElements.push(t),l.Cameo+=1}else if(F.a.readBooleanOrDefault("enableModel3DInPPTLive",!1)&&n.model3d){const t=new wi(this.m_slide.spLst[e],n,r,this.events,this.m_environment),a=t.ensure();Ii.processEnsureShapeResult(i,a,n.shapeId.shapeId),this.shapeViewElements.push(t),l.Model3D+=1}else if(n.ink&&!F.a.readBooleanOrDefault("forceSvg",!1)){const t=new Ci(this.m_slide.spLst[e],n,this.m_slideSizePixels),r=t.ensure();Ii.processEnsureShapeResult(i,r,n.shapeId.shapeId),this.shapeViewElements.push(t),l.Ink+=1}else{const t=new q(this.m_slide.spLst[e],n,r,this.events,this.m_environment),a=t.ensure();Ii.processEnsureShapeResult(i,a,t.id.shapeId),this.shapeViewElements.push(t),l.Shape+=1}else g.a.sendTraceTag(506545111,_.a.msoulscat_Wac_PptSession,S.a.Error,"SlideViewElement::init: Invalid shapeViewData. Continue...")}i.initSlideVE_ensureShapeVE.end=Mn.performanceNowTrimmed(),this.slideContentTelemetry.contentCounts=l;const d=[].concat(...this.shapeViewElements.map(e=>e.animatableContentViewElements));F.a.readBooleanOrDefault("hackAnimationsEnabled",!0)||(this.m_slide.animSeqs=[{AnimationList:[],SequenceId:"0_anim"}]);const{animObjectList:c,needsDummyClick:h}=new v.j(this.animTimeline).createAnimObjectListForSlide(this.m_slide.animSeqs,d,this.m_slideSizePixels);this.fNeedsDummyClick=h,this.m_animObjects=c;const u=this.m_slide.animSeqs.map(e=>e.SequenceId),f=new Map;for(const e of u)f.set(e,{ClickNum:h&&e===v.e.MainTimelineId?1:0,Offs:0});return this.animTimeline.initTimeline(this.m_animObjects,u,f,0),i}async getShapeViewDataInSlideAsync(){return await Promise.all(this.m_slide.spLst.map(e=>this.m_environment.viewDataManager.getShapeViewData(this.m_slide.id,e.id))||[])}static processEnsureShapeResult(e,t,i){t.hasOwnProperty("missingTextureIds")&&(e.hasOwnProperty("missingTextureIds")||(e.missingTextureIds=[]),e.missingTextureIds.push(...t.missingTextureIds)),t.hasOwnProperty("invalidShape")&&t.invalidShape&&(e.hasOwnProperty("invalidShapeIds")||(e.invalidShapeIds=[]),e.invalidShapeIds.push(i)),t.hasOwnProperty("showAppForOffice")&&t.showAppForOffice&&(e.hasOwnProperty("initSlideVE_ensureAddinVEs")||(e.initSlideVE_ensureAddinVEs=[]),e.initSlideVE_ensureAddinVEs.push(t.showAppForOffice))}get slideSizePixels(){return this.m_slideSizePixels}get fPrepared(){return this.m_fPrepared}set fPrepared(e){if(e!==this.m_fPrepared){this.m_fPrepared=e;for(const e of this.shapeViewElements)e.fPrepared=this.m_fPrepared}}tryPrepare(){for(const e of this.shapeViewElements)if(!e.fPrepared){try{e.tryPrepare(this.m_timeoutMs)?this.m_timeoutMs=5:this.m_timeoutMs=2*this.m_timeoutMs}catch(e){let t=e;e instanceof Error&&this.m_environment.stringifyError&&(t=this.m_environment.stringifyError(e)),g.a.sendTraceTag(506545108,_.a.msoulscat_Wac_PptSlideshow,S.a.Error,"SlideViewElement::preRender Exception while in tryPrepare:"+t)}return!1}return this.m_fPrepared=!0,g.a.sendTraceTag(506545107,_.a.msoulscat_Wac_PptSession,S.a.Info,"SlideViewElement::preRender Done preRendering - slideId:"+this.slideId.sid),!0}tryPrepareAllAtOnce(e){const t=performance.now();for(const i of this.shapeViewElements){const n=e-(performance.now()-t);if(!i.fPrepared)try{if(!i.tryPrepare(n))return!1}catch(e){let t=e;e instanceof Error&&this.m_environment.stringifyError&&(t=this.m_environment.stringifyError(e)),g.a.sendTraceTag(506545106,_.a.msoulscat_Wac_PptSlideshow,S.a.Error,"SlideViewElement::preRender Exception while in tryPrepare:"+t)}}return this.m_fPrepared=!0,!0}async updateAccessibilityTag(e,t,i){if(!i)return;const n=await this.m_environment.viewDataManager.getSlideViewData(t);if(n.resource&&n.resource.accessibilityModelPromise){const i=await n.resource.accessibilityModelPromise,r=this.animTimeline.getEndTime(v.e.MainTimelineId),a=r?r.ClickNum:0;let s=this.animTimeline.getNumTimelineClicks(v.e.MainTimelineId);s=s>a?a:s;const o=JSON.stringify({slideIndex:e,sldId:t,animationIndex:s});if(Ii.s_lastAccessibilityTagHash===o)return;Ii.s_lastAccessibilityTagHash=o,await this.updateAccessibilityLiveRegion(e,i,s,a);const l=Ii.getLocalizedString();if(i&&i.shapeAccessibilityDataList){i.shapeAccessibilityDataList.forEach(e=>{const t={slideId:e.slideId,shapeId:parseInt(e.shapeId?e.shapeId:"",10)},i=$.generateShapeLevelAccessibilityElementId(t),n=document.getElementById(i);n&&(n.appendChild(e.val),n.classList.add("show-accessibility-element"),n.style.display="")});const t=$.ensureSlideTitleElement();t&&(t.innerText=this.getSlideTitleElementStr(l.slideTitleElementStr,e,i.slideTitleString),t.classList.add("show-accessibility-element"),t.style.display="")}}else{const e=document.getElementById(Mn.AccessibilitySlideTitleId);e&&(e.style.display="none"),g.a.sendTraceTag(506545105,_.a.msoulscat_Wac_PptSession,S.a.Error,"SlideViewElement::updateAccessibilityTag - missing slideViewData. sid:"+this.slideId.sid)}}async updateAccessibilityLiveRegion(e,t,i,n){const r=Ii.getLocalizedString();let a=document.getElementById(Mn.AccessibilityLiveRegionContainerDivId);a&&(""!==Mn.accessibilityLanguage&&Mn.appLanguage&&!Mn.appLanguage.includes(Mn.accessibilityLanguage)?a=this.addLangAttributeToLiveRegion(a):(""===Mn.accessibilityLanguage||Mn.appLanguage&&Mn.appLanguage.includes(Mn.accessibilityLanguage))&&a.removeAttribute("lang"),a.innerText=this.getSlideTitleElementStr(r.slideTitleElementStr,e,t.slideTitleString));let s=i,o=n;if(this.fNeedsDummyClick&&(s-=1,o-=1),s<=0){if(o>0){let i=1===n?r.animTotalSingularStr:r.animTotalPluralStr;i&&a&&(i=i.replace("{0}",""+o),a.innerText=r.accessibilityLiveRegionAnimStepStr.replace("{0}",""+(e+1)).replace("{1}",t.slideTitleString).replace("{2}",i))}}else{const i=t.slideTitleString?r.slideNameWithTooltipStr:r.slideNameWithoutTooltipStr,n=r.slideStr,l=r.animNumStr;if(i&&l&&n){const r=i.replace("{0}",""+n).replace("{1}",""+(e+1)).replace("{2}",""+t.slideTitleString),d=l.replace("{0}",""+s).replace("{1}",""+o).replace("{2}",""+r);a&&(a.innerText=d)}}}addLangAttributeToLiveRegion(e){const t=document.createElement("div");t.id=Mn.AccessibilityLiveRegionContainerDivId,t.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),t.setAttribute("aria-live","assertive"),t.setAttribute("aria-atomic","true"),t.setAttribute("role","alert"),t.setAttribute("lang",Mn.accessibilityLanguage);const i=document.getElementsByClassName("slide-container-class");return i.length>0&&i[0]&&i[0].replaceChild(t,e),t}getSlideTitleElementStr(e,t,i){return e.replace("{0}",""+(t+1)).replace("{1}",i)}static getLocalizedString(){return"undefined"!=typeof PowerpointSlideshowStrings?{slideTitleElementStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideIndexAndSlideTitle,animTotalSingularStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimTotalSingular,animTotalPluralStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimTotalPlural,accessibilityLiveRegionAnimStepStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelForLiveRegionAnimationStepReadout,slideNameWithTooltipStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSldNameWithTooltip,slideNameWithoutTooltipStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSldNameWithoutTooltip,slideStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideStr,animNumStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimationNumber}:{slideTitleElementStr:"Slide {0}:{1}. ",animTotalSingularStr:"Has 1 animation",animTotalPluralStr:"Has {0} animations",accessibilityLiveRegionAnimStepStr:"Slide {0}:{1}, {2}",slideNameWithTooltipStr:"{0} {1} - {2}",slideNameWithoutTooltipStr:"{0} {1}",slideStr:"Slide",animNumStr:"Animation {0} of {1} on {2}"}}updateShapeViewElements(){for(const e of this.shapeViewElements)-1!==e.id.shapeId&&e.update();for(const e of this.m_animObjects){const t=e.Shape.shapeId,i=this.shapeViewElements.find(e=>e.id.shapeId===t.shapeId&&e.id.slideId.sid===t.slideId.sid);if(i){const t=this.animTimeline.getEndTime(v.e.MainTimelineId),n=t?t.ClickNum:0;i.applyAnimation(e,n)}}}updateMediaViewElement(e,t,i){for(const n of this.shapeViewElements)if(n.shapeType===u.Media&&n.getMediaName()===e)switch(t){case l.MediaPlayed:n.playMedia();break;case l.MediaPaused:n.pauseMedia();break;case l.MediaSeeked:n.seekMedia(i||0)}}updateMediaState(e){for(const t of this.shapeViewElements)if(t.shapeType===u.Media&&t.getMediaName()===e.mediaName)return et("Passing to MediaViewElement","SlideViewElement",e),void t.updateMediaState(e);et("Blocking - MediaViewElement of media wasn't found","SlideViewElement",e)}initMediaAfterSlideContentChanged(){for(const e of this.shapeViewElements)e.shapeType===u.Media&&e.initAfterSlideContentChanged()}updateVideoPlayButtonVisibility(e){for(const t of this.shapeViewElements)t.shapeType===u.Media&&t.updateVideoPlayButtonVisibility(e)}setAadToken(e){Qe.postAadTokenToStream(e)}static setStream2AadToken(e){He.setAADToken(e)}getMediaNamesOnSlide(){const e=[];for(const t of this.shapeViewElements)t.shapeType===u.Media&&e.push(t.getMediaName());return e}async isMediaPresentInSlideAsync(){const e=await this.getShapeViewDataInSlideAsync();for(const t of e)if(t&&void 0!==t.media)return!0;return!1}getAllZoomsOnSlide(){const e=[];for(const t of this.shapeViewElements)if(t.shapeType===u.Shape)for(const i of t.getAllZoomsOnShape())e.push(i);return e}async isCameoPresentInSlideAsync(){const e=await this.getShapeViewDataInSlideAsync();for(const t of e)if(t&&void 0!==t.cameo)return!0;return!1}getCameoInfoInSlide(){const e=[];for(const t of this.shapeViewElements)t.shapeType===u.Cameo&&e.push(t.getCameoInfo());return e}addToScene(e){for(let t=0;t<this.shapeViewElements.length;t+=1)this.shapeViewElements[t].addToScene(e)}removeFromScene(e){for(let t=0;t<this.shapeViewElements.length;t+=1)this.shapeViewElements[t].shapeType===u.Cameo&&this.shapeViewElements[t].removeFromScene(e)}cleanUp(){for(let e=0;e<this.shapeViewElements.length;e+=1)this.shapeViewElements[e].cleanUp()}getMediaCurrentState(e){for(const t of this.shapeViewElements)if(t.shapeType===u.Media&&t.getMediaName()===e)return t.getMediaCurrentState()}updateGlobalMute(e){for(const t of this.shapeViewElements)t.shapeType===u.Media&&t.updateGlobalMute(e)}onSlideScaled(e){for(const t of this.shapeViewElements)t.shapeType===u.Media&&t.resizeToScale(e)}muteAllPlayingMedia(){for(const e of this.shapeViewElements)e.shapeType===u.Media&&e.mutePlayingMedia()}getMediaInfo(e){for(const t of this.shapeViewElements)if(t.shapeType===u.Media&&t.getMediaName()===e)return t.getMediaInfo()}isMediaPlayingOnSlideCanvas(){for(const e of this.shapeViewElements)if(e.shapeType===u.Media&&e.shouldUpdateMediaOnCanvas())return!0;return!1}constructor(e,t,i){this.shapeViewElements=[],this.events=new Z.EventEmitter,this.fImageTextureLoaded=!1,this.fImageTextureLoading=!1,this.fOnMouseClickAdvance=!0,this.fHasContinuouslyAnimatedContent=!1,this.fNeedsDummyClick=!1,this.isHidden=!1,this.fHasAddin=!1,this.slideContentTelemetry=[],this.m_animObjects=[],this.m_fPrepared=!1,this.m_timeoutMs=5,this.slideId=e.id,this.m_slide=e,this.animTimeline=new v.i,this.animClock=new v.d,this.m_environment=i,this.m_slideSizePixels=new m.f(t.x,t.y),this.isHidden=e.hidden,this.m_slide.ssTimes&&(this.fOnMouseClickAdvance=this.m_slide.ssTimes.manualAdv)}}Ii.s_lastAccessibilityTagHash="";var Pi=i(45),Ei=i(153),xi=i(184);class ki{createMorphKeyFrame(e,t,n,r){if(!e)return;const a=[];if(e.isBg){const e={slideId:t.slideId,shapeId:-1},i=t.shapeViewElements.filter(t=>t.id.slideId.sid===e.slideId.sid&&t.id.shapeId===e.shapeId);for(const e of i)if(e.shapeItem){const t={item:e.shapeItem,textRange:void 0,includeSubtree:!0};a.push(t),this.metadata.numOtherElement+=1}}for(const i of e.parts){const e=t.shapeViewElements.find(e=>i.shapeId?e.id.slideId.sid===i.shapeId.slideId.sid&&e.id.shapeId===i.shapeId.shapeId:void 0);if(e&&e.shapeItem){let t=e.shapeItem;const n=e.shapeType===u.Cameo&&!this.m_cameoViewElements.includes(e);n&&this.m_cameoViewElements.push(e),i.bigPart&&(t=N(t,i.bigPart)||t);let r=!0,s=void 0;const o=V(t);i.textRange&&(o&&o.text?(s=new b.j(i.textRange.begin,i.textRange.length),t=o):(g.a.sendTraceTag(506545118,_.a.msoulscat_Wac_PptSession,S.a.Error,"MorphTransition::createMorphKeyFrame: text not found for shapebuilder shape."),this.fallbackReasons.add("text missing"))),r=i.isSubtreeIncluded;const l={item:t,textRange:s,includeSubtree:r};a.push(l),s?this.metadata.numTextElement+=1:n?this.metadata.numCameoElement+=1:this.metadata.numOtherElement+=1}}if(0===a.length)for(const i of e.parts){let e,n;for(const r of t.shapeViewElements)if(i.animatableContentId)for(const t of r.animatableContentViewElements){const a=i.animatableContentId.toString();t.id===a&&(e=r,n=t)}if(e&&e.shapeItem&&n){const t=e.shapeItem;if(i.animatablePartIndicies&&0!==i.animatablePartIndicies.length)for(const e of i.animatablePartIndicies){const i={item:N(t,`${n.id}c${e}`)||t,includeSubtree:!1};a.push(i),this.metadata.numFallbackElement+=1}else{const e={item:N(t,n.id)||t,includeSubtree:!1};a.push(e),this.metadata.numFallbackElement+=1}}}if(0===a.length&&e.model3DData){var s;let t,n=Object(bi.b)(e.size.x,e.size.y);n=Math.max(e.size.x,e.size.y),t=n>Ti.a?bi.a.TextureSizeMax:Object(bi.c)(n);const r={size:new m.f(t,t),position:new m.f(50,50)},o=new y.h;o.id=`${e.model3DData.mId}-${this.m_model3DCounter}`,this.m_model3DCounter+=1;const l=new y.g(o),d=T.j.CreateRectangle(m.d.FromSize(r.size),new y.x,void 0,new m.e(r.position));d.style.pictureBrush=l;const c=this.m_environment.rendererEnvironment.renderer.getBabylonEngine();if(!c)throw new Error("No ThinEngine instance found");const h=c.createRenderTargetTexture({width:t,height:t},{generateMipMaps:!1,generateDepthBuffer:!0,generateStencilBuffer:!0});this.m_environment.rendererEnvironment.attachImage("Morph3DContent",o,{loadedShapeIDs:[],loadedSlideIDs:[],size:r.size,texture:null===(s=h.texture)||void 0===s||null===(s=s._hardwareTexture)||void 0===s?void 0:s.underlyingResource},r.size),i.e(0).then(i.bind(null,440)).then(i=>{if(!e||!e.model3DData)return;const n=i.Model3DInstance,r=Object(bi.g)(e.model3DData.mId,this.m_environment.settings.serverUrl),a=new n(c,this.m_environment,{position:e.center,size:e.size,url:r,filename:e.model3DData.mId},e.model3DData,{skipRenderOnReady:!0,overrideTextureSize:new m.f(t,t),preparedRenderTargetTexture:h});a.onAfterRenderCallback=()=>{for(const e of d.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,a.getTargetTexture()),a.getTargetTexture().changeTracker.notifyChange())},a.onReady=()=>{a.renderFrame()},this.m_3DModelViewElements.push({instance:a,keyFrame:e,item:d})}).catch(e=>{g.a.sendTraceTag(506545117,_.a.msoulscat_Wac_PptSession,S.a.Error,"MorphTransition::createMorphKeyFrame model3DInstance not found: "+e)}),this.createdItems.push(d);const u={item:d,includeSubtree:!1};a.push(u),this.metadata.num3DModelElement+=1}if(0===a.length&&e.fallbackImage){const t=this.m_environment.viewDataManager.imageDataMap.get(e.fallbackImage.imgID);if(t&&t.size){const i=t.size,n=t.size,r=t.size.scale(.5);$.verifyTextureSize(this.m_environment,"morph_fallback",i);const s=new y.h;s.id=e.fallbackImage.imgID,this.m_environment.rendererEnvironment.attachImage("MorphImageFallback",s,t,t.size);const o=new y.g(s);o.scale=n.divide(i),o.offset=n.scale(.5).subtract(r).divide(i);const l=new m.d(e.fallbackImage.rect.left,e.fallbackImage.rect.top,e.fallbackImage.rect.right,e.fallbackImage.rect.bottom),d=T.j.CreateRectangle(l,new y.x(o));this.createdItems.push(d);const c={item:d,includeSubtree:!1};a.push(c),this.metadata.numFallbackElement+=1}else g.a.sendTraceTag(506545116,_.a.msoulscat_Wac_PptSession,S.a.Error,"MorphTransition::createMorphKeyFrame: fallback image not found for shapebuilder shape."),this.fallbackReasons.add("fallback image missing")}const o={center:r?ki.toVector2(e.center).transformPoint(r):ki.toVector2(e.center),flipX:e.flipX,flipY:e.flipY,rotation:e.angleRadians,size:r?ki.toVector2(e.size).transformVector(r):ki.toVector2(e.size)},l=e.grid?{data:e.grid.data,size:ki.toVector2(e.grid.size)}:void 0;return new Ei.c(a,o,e.zIndex,l,n)}static toVector2(e){return new m.f(e.x,e.y)}static applyShotgunToPillowCurve(e){return.5-.5*Math.cos(2*Math.PI*(1-1/(e+1)))}init(e){}tryPrepareMorph(e){return this.m_isDisposed?(g.a.sendTraceTag(506545115,_.a.msoulscat_Wac_PptSession,S.a.Error,"MorphTransition tried to prepare after being disposed."),!0):this.m_environment.rendererEnvironment.renderer.tryPrepareMorph(this.morph,e)}draw(e){if(this.m_isDisposed)return g.a.sendTraceTag(506545114,_.a.msoulscat_Wac_PptSession,S.a.Error,"MorphTransition tried to draw after being disposed."),!1;for(const e of this.m_cameoViewElements)e.ensureCameoTextureAttached();if((F.a.readBooleanOrDefault("enableCameoInPPTOSlideShow",!1)||F.a.readBooleanOrDefault("enableCameoInT2",!1))&&this.m_cameoViewElements.length>0&&this.m_environment.updateCameoTextureFromVideoElement(),F.a.readBooleanOrDefault("enableMorphFor3DModels",!1))for(const t of this.m_3DModelViewElements){const i=this.m_3DModelViewElements.indexOf(t),n=t.keyFrame.model3DData,r=i%2?i-1:i+1,a=this.m_3DModelViewElements[r].keyFrame.model3DData;if(!n||!a)continue;const s=i%2?n:a,o=i%2?a:n,l=Object(xi.d)(o,s,e);t.instance.resetTransformation(l),t.instance.renderFrame()}const t=this.isForwards?ki.applyShotgunToPillowCurve(e):1-ki.applyShotgunToPillowCurve(1-e),i=new m.f(this.m_slideSizePixels.x,this.m_slideSizePixels.y).scale(F.a.readNumberOrDefault("hackMorphRenderSizeScale",1)),n=this.m_environment.rendererEnvironment.calculateRenderTransform(i);return this.m_environment.rendererEnvironment.renderer.renderMorph(this.morph,t,y.d.White,n),!0}dispose(){this.morph.clearCache();for(const e of this.createdItems)e.releaseGeneratedResources();this.m_isDisposed=!0}constructor(e,t,i,n,r,a){this.createdItems=[],this.fallbackReasons=new Set,this.isForwards=!1,this.m_cameoViewElements=[],this.m_3DModelViewElements=[],this.m_isDisposed=!1,this.m_model3DCounter=0,this.metadata={numFallbackElement:0,numTextElement:0,numOtherElement:0,numCameoElement:0,num3DModelElement:0},this.m_environment=e,this.morph=new Ei.a,r.slideSizePixels.x===a.slideSizePixels.x&&r.slideSizePixels.y===a.slideSizePixels.y||g.a.sendTraceTag(506545120,_.a.msoulscat_Wac_PptSession,S.a.Warning,"MorphTransition::createMorphKeyFrame: slide size mismatch."),this.m_slideSizePixels=a.slideSizePixels;const s=new m.f(this.m_slideSizePixels.x,this.m_slideSizePixels.y).scale(F.a.readNumberOrDefault("hackMorphRenderSizeScale",1)),o=this.m_environment.rendererEnvironment.calculateRenderTransform(r.slideSizePixels),l=this.m_environment.rendererEnvironment.calculateRenderTransform(a.slideSizePixels),d=this.m_environment.rendererEnvironment.calculateRenderTransform(t.slideSizePixels),c=this.m_environment.rendererEnvironment.calculateRenderTransform(s),h=o.toMatrix3().multiply(c.toInverseMatrix3()),u=l.toMatrix3().multiply(c.toInverseMatrix3()),f=d.toMatrix3().multiply(c.toInverseMatrix3());for(const e of t.elements){const t=[this.createMorphKeyFrame(e.keyFrameA,r,h,f),this.createMorphKeyFrame(e.keyFrameB,a,u,f)],i=new Ei.b(t);if(i.keyFrames[0]&&i.keyFrames[0].contents[0]&&i.keyFrames[0].contents[0].item&&i.keyFrames[1]&&i.keyFrames[1].contents[0]&&i.keyFrames[1].contents[0].item)for(const e of this.m_cameoViewElements)if(e.shapeItem===i.keyFrames[0].contents[0].item||e.shapeItem===i.keyFrames[1].contents[0].item){i.hasDynamicContent=!0;break}e.keyFrameA&&e.keyFrameA.model3DData&&(i.hasDynamicContent=!0),i.rotateClockwise=e.rotateClockwise,this.morph.elements.push(i)}if(i===Pi.h.PPT_TRANSITION_PAN)switch(n){case Pi.g.Left:this.morph.panVector=new m.f(-this.m_slideSizePixels.x,0);break;case Pi.g.Top:this.morph.panVector=new m.f(0,-this.m_slideSizePixels.y);break;case Pi.g.Right:this.morph.panVector=new m.f(this.m_slideSizePixels.x,0);break;case Pi.g.Bottom:this.morph.panVector=new m.f(0,this.m_slideSizePixels.y)}if(g.a.sendTraceTag(506545119,_.a.msoulscat_Wac_PptSlideshow,S.a.Info,JSON.stringify(this.metadata)),F.a.readBooleanOrDefault("hackVerifyMorphDuplicateZOrder",!1)){const e=[new Set,new Set];for(const t of this.morph.elements)for(let i=0;i<2;i+=1){const n=t.keyFrames[i]?t.keyFrames[i].zPosition:void 0;if(void 0!==n){if(e[i].has(n))return void this.fallbackReasons.add("duplicate z position");e[i].add(n)}}}}}var Mi,Ai,Ri=i(52);function Oi(e,t,i,n,r){return e.scale(r).add(i.scale(n/2)).subtract(t)}function Fi(e,t,i,n,r){return e.scale(r).add(i.scale(n/2)).subtract(t)}function Di(e,t,i,n,r,a){let s=a,o=e.x,l=e.y;s||(s=n);const d=new m.f(t.x/2,t.y/2);return o=Math.min(o,d.x*s),o=Math.max(o,i.x*r-d.x*s),l=Math.min(l,d.y*s),l=Math.max(l,i.y*r-d.y*s),new m.e(d.scale(-1),new m.f(s,s),void 0,new m.f(o,l))}!function(e){e.SetupWebGLContextFailed="SetupWebGLContextFailed",e.RestoreWebGLContextFailed="RestoreWebGLContextFailed",e.CannotLoadTextureNoWebGLContext="CannotLoadTextureNoWebGLContext",e.CreateTextureFailed="CreateTextureFailed",e.CannotLoadImageTexture="CannotLoadImageTexture",e.FailedToRenderContextLost="FailedToRenderContextLost",e.FailedToRenderSBNotReady="FailedToRenderSBNotReady",e.FailedToRenderMissingSceneView="FailedToRenderMissingSceneView",e.TexturesNotLoaded="TexturesNotLoaded",e.MissingSceneView="MissingSceneView",e.TryPrepareTimeout="TryPrepareTimeout"}(Mi||(Mi={})),function(e){e[e.ShapeBuilder=0]="ShapeBuilder",e[e.Transitions=1]="Transitions"}(Ai||(Ai={}));class Li{get gl(){return this.m_shapeBuilderCanvasContext.gl}get isGLContextValid(){return!!this.gl&&!this.gl.isContextLost()}get isSBValid(){return this.m_shapeBuilderCanvasContext.isReady}get glContext(){return this.gl}get renderer(){return this.m_shapeBuilderCanvasContext.renderer}get webGLRenderer(){return this.renderer}get canvas(){return this.m_shapeBuilderCanvasContext.canvas}get tech(){return this.m_tech}get clientSize(){return this.viewController.getBounds.getClientSizeFromCanvas()}onInitStateRestorer(){this.setRenderingScenario(Ai.ShapeBuilder)}logContextCreation(e){if(!e.fSuccess)return g.a.sendTraceTag(561639883,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unable to initialize WebGL"),void J.e.recordVeto("SetupWebGLContextFailed",{msg:Mi.SetupWebGLContextFailed});e.data&&(Mn.s_rendererTech=e.data.rendererTech,e.data.unmaskedRenderer&&(Mn.s_isBadGpu=F.a.readStringOrDefault("badGpuList","").toLowerCase().indexOf(e.data.unmaskedRenderer)>=0),Mn.s_gpuHardwareDisabled=e.data.hasPerfCaveat,e.data.hasPerfCaveat&&g.a.sendTraceTag(520897678,_.a.msoulscat_Wac_PptSession,S.a.Info,"WebGL initialized with gpu hardware disabled"),g.a.sendTraceTag(561639882,_.a.msoulscat_Wac_PptSession,S.a.Info,"WebGL initialized "+JSON.stringify({rendererTech:Mn.s_rendererTech,isBadGpu:Mn.s_isBadGpu,fPerfCaveat:Mn.s_gpuHardwareDisabled})))}setRenderingScenario(e){if(e===this.m_renderingScenario)return;const t=this.renderer.getBabylonEngine();t&&t.wipeCaches(!0),this.m_renderingScenario=e}removeCanvas(e){this.releaseResources(),this.m_shapeBuilderCanvasContext.removeCanvas(e),this.isCanvasSizeSet=!1}releaseResources(){this.viewController.viewDataManager.imageDataMap=new Map,this.viewController.viewDataManager.memoryStats.gifTextures=0,this.viewController.viewDataManager.memoryStats.transitionTextures=0,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport=new Pi.b,this.viewController.viewDataManager.memoryStats.videoTextures=0,this.viewController.viewDataManager.memoryStats.cameoTextures=0;for(const e of this.viewController.viewDataManager.externalTexturesToRelease)e.texture.release();this.viewController.viewDataManager.externalTexturesToRelease=[];for(const e of this.viewControllerInternals.slideSceneView)e.scene&&this.viewControllerInternals.deleteScene(e),e.slideViewElement.shapeViewElements=[],F.a.readBooleanOrDefault("enableFailTextureLoadOnContextLost",!1)&&(e.slideViewElement.fImageTextureLoaded=!1,e.slideViewElement.fImageTextureLoading=!1);this.events.emit("releasedResources"),xn.gl=this.gl}setupCanvas(e){this.m_shapeBuilderCanvasContext.setupCanvas(e,{useRemovableCanvas:this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled,useZIndex1:this.viewControllerInternals.settings.transparentCanvasForVideoEnabled}),xn.gl=this.gl,this.canvas.style.pointerEvents="none",this.isCanvasSizeSet=!1}setCanvasSize(e,t){const i=e.scale(window.devicePixelRatio*t),n=new m.f(Math.round(i.x),Math.round(i.y));this.m_shapeBuilderCanvasContext.setCanvasSize(e,n)&&(this.isCanvasSizeSet=!0,this.devicePixelsToRenderedPixelsScale=t)}calculateRenderTransform(e){const t=this.getPixelScale(e),i=Math.min(t.x,t.y);return new m.e(new m.f(-e.x/2,-e.y/2),new m.f(i,i),void 0,new m.f(this.canvas.width/2,this.canvas.height/2))}calculateRenderTransformWithZoom(e,t,i){const n=this.getPixelScale(e);let r=t,a=i;return r&&a||(r=Math.min(n.x,n.y),a=new m.f(r*e.x/2,r*e.y/2)),new m.e(new m.f(-e.x/2,-e.y/2),new m.f(r,r),void 0,Oi(new m.f(this.clientSize.x/2,this.clientSize.y/2),a,e,r,window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale))}async preloadShadersAsync(e){await this.m_shapeBuilderCanvasContext.preloadShadersAsync(e)}flush(){this.gl&&this.gl.flush()}getPerformanceSummary(){return this.renderer.getPerformanceSummary()}generateTextureMemoryReport(e,t){return this.renderer.generateTextureMemoryReport(e,t)}verifyGlyphCacheIntegrityAndTryRecover(){return this.renderer.verifyGlyphCacheIntegrityAndTryRecover()}attachImage(e,t,i,n){if(!i.texture)throw g.a.sendTraceTag(561639876,_.a.msoulscat_Wac_PptSession,S.a.Error,"texture missing"),new Error("texture missing");const r=new O.c(e,this.renderer,i.texture,n,X.d.RGBA,y.y.clamp,O.e.ExternallyManaged);i.size.equals(n)||g.a.sendTraceTag(559269018,_.a.msoulscat_Wac_PptSession,S.a.Warning,`attachImage imageData.size:${JSON.stringify(i.size)} != size:${JSON.stringify(n)}`),t.id||g.a.sendTraceTag(561639877,_.a.msoulscat_Wac_PptSession,S.a.Error,"Missing imageContainer.id: "+t.id),this.viewController.viewDataManager.externalTexturesToRelease.push({imageId:t.id||"unknown",texture:r}),this.renderer.attachTextureToImage(t,r)}releaseImageData(e){e.texture&&this.gl&&this.gl.deleteTexture(e.texture)}saveImageData(e,t,i,n,r){const a=this.gl;if(!a)return g.a.sendTraceTag(561639878,_.a.msoulscat_Wac_PptSession,S.a.Error,"No webGL Context found"),{errorName:Mi.CannotLoadTextureNoWebGLContext};const s=a.createTexture();if(!s)return g.a.sendTraceTag(561639879,_.a.msoulscat_Wac_PptSession,S.a.Error,"Failed to create texture"),{errorName:Mi.CreateTextureFailed};if(F.a.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){const i=F.a.readNumberOrDefault("maxSvgTextureSize",2048),a=Math.max(t.size.width,t.size.height),s=r.x/n.x,o=r.y/n.y,l=a*Math.min(s,o)*(n.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(Math.max(e.naturalHeight,e.naturalWidth,l),i),g.a.sendTraceTag(561639880,_.a.msoulscat_Wac_PptSession,S.a.Info,`loadImageTexture: SVG width = ${e.width}px, height = ${e.height}`)}a.bindTexture(a.TEXTURE_2D,s),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null);const o=e.ID,l=this.viewController.viewDataManager.imageDataMap.get(o);return l&&(this.viewController.viewDataManager.memoryStats.externalTextureLeaks+=l.size.x*l.size.y*4,F.a.readBooleanOrDefault("releaseExistingExternalImages",!1)&&(this.releaseImageData(l),this.viewController.viewDataManager.onExternalTextureReleased(o))),this.viewController.viewDataManager.imageDataMap.set(o,{dataUri:e.src,texture:s,size:new m.f(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[i]}),g.a.sendTraceTag(561639881,_.a.msoulscat_Wac_PptSession,S.a.Info,"loadImageTexture - loaded "+JSON.stringify({id:e.ID,slideId:i,size:new m.f(e.width,e.height),naturalSize:new m.f(e.naturalWidth,e.naturalHeight),byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType})),{}}async createTransition(e,t,i,n,r,a,s){const o={fSuccess:!1},l=e.type,d=e.dir,c=e.dur,h={};o.effectId=l;const u=s&&s.correlationId,f={aspectRatio:r,direction:d,forward:n,gl:this.gl,engine:this.renderer.getBabylonEngine(),incomingSlideBackground:void 0,outgoingSlideBackground:void 0,incomingSlideForeground:void 0,outgoingSlideForeground:void 0};let p,g,_=!0,S=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(S=Mn.performanceNowTrimmed());const v=this.viewController.getSlideViewElement(i),T=this.viewController.getSlideViewElement(t);G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h.getSlideViewElementMS=Mn.performanceNowTrimmed()-S);let b=()=>{},w=()=>{};if(a&&v&&T&&e.morph&&(l===Pi.h.PPT_TRANSITION_MORPH||l===Pi.h.PPT_TRANSITION_PAN)){G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o.metadata||(o.metadata={}),h.morphTransitionFlow=!0);const e=this.viewController.viewDataManager.getSlideIndex(i),r=this.viewController.viewDataManager.getSlideIndex(t),a=this.slideIdsToMorphKey(i,t);if(a&&-1!==e&&-1!==r&&1===Math.abs(r-e)){let e=0;e=Mn.performanceNowTrimmed();const r=await this.viewControllerInternals.morphCache.load(a,{meta_prevSlideId:n?i:t,meta_nextSlideId:n?t:i});if(h.generateMorphResource=Mn.performanceNowTrimmed()-e,r.resource){g=r.resource,g.tryPrepareMorph();const e=this.morphKeyToSlideIds(a);g.isForwards=e.slideIdA.sid===i.sid&&e.slideIdA.cid===i.cid}}if(!g)return{fSuccess:!1};if(g.fallbackReasons.size>0)return{fSuccess:!1,metadata:{fallbackReasons:Array.from(g.fallbackReasons).join(", ")}};p=g,o.metadata=g.metadata}else{let e=[];if(!this.viewControllerInternals.transitionFactory.isTransitionDisabled(l,d)&&Object(Pi.f)(l,d)){let n=0;n=Mn.performanceNowTrimmed();const r={incomingSlideBackground:this.renderToTexture(t,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!0),correlationId:u,isContentTransition:!0}),outgoingSlideBackground:this.renderToTexture(i,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!0),correlationId:u,isContentTransition:!0}),incomingSlideForeground:this.renderToTexture(t,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:y.d.Transparent,correlationId:u,isContentTransition:!0}),outgoingSlideForeground:this.renderToTexture(i,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:y.d.Transparent,correlationId:u,isContentTransition:!0})};h.renderTransitionTextures=Mn.performanceNowTrimmed()-n,f.incomingSlideBackground=r.incomingSlideBackground?r.incomingSlideBackground.tryGetWebGLTexture():void 0,f.outgoingSlideBackground=r.outgoingSlideBackground?r.outgoingSlideBackground.tryGetWebGLTexture():void 0,f.incomingSlideForeground=r.incomingSlideForeground?r.incomingSlideForeground.tryGetWebGLTexture():void 0,f.outgoingSlideForeground=r.outgoingSlideForeground?r.outgoingSlideForeground.tryGetWebGLTexture():void 0,e=Object.values(r)}else{let n=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(n=Mn.performanceNowTrimmed());const r={incomingSlideBackground:this.renderToTexture(t,{correlationId:u}),outgoingSlideBackground:this.renderToTexture(i,{correlationId:u})};G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h.renderToTexture=Mn.performanceNowTrimmed()-n),f.incomingSlideBackground=r.incomingSlideBackground?r.incomingSlideBackground.tryGetWebGLTexture():void 0,f.outgoingSlideBackground=r.outgoingSlideBackground?r.outgoingSlideBackground.tryGetWebGLTexture():void 0,e=Object.values(r)}const n=new m.f(this.canvas.width,this.canvas.height);this.setRenderingScenario(Ai.Transitions);const r=new Pi.c(f);let a=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(a=Mn.performanceNowTrimmed());const s=await this.viewControllerInternals.transitionFactory.getTransition(l,d,r,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport);if(G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h.transitionFactoryMS=Mn.performanceNowTrimmed()-a),!s.transition)return o.isSupported=!1,o;_=s.isSupported,p=s.transition,b=()=>{const t=this.gl;if(t&&!t.isContextLost()){for(const t of e)t&&(this.viewController.viewDataManager.memoryStats.transitionTextures-=n.x*n.y*4,t.release());p.dispose()}},w=()=>{this.setRenderingScenario(Ai.Transitions)}}return this.viewControllerInternals.transitionController=new En(p,c,n,w,b),o.fSuccess=!0,o.isSupported=_,G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o.metadata||(o.metadata={}),o.metadata.rendererEnvironment=h),o}enableVerboseRenderLogging(e){this.renderer.enableVerboseRenderLogging(e)}getPixelScale(e){const t=this.clientSize.x/e.x,i=this.clientSize.y/e.y;return new m.f(t,i).scale(window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale)}logContextCreationError(e){g.a.sendTraceTag(555018370,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unable to initialize WebGL - "+(e.statusMessage||"Unknown error"))}onContextLost(){g.a.sendTraceTag(561639884,_.a.msoulscat_Wac_PptSession,S.a.Warning,`WebGL context lost. CurrentSceneCount:${this.viewControllerInternals.currentSceneCount}, MaxSceneCount:${this.viewControllerInternals.forwardSceneCount+this.viewControllerInternals.backwardSceneCount+1},\n       CurrentRenderedSlideId:${JSON.stringify(this.viewControllerInternals.currentRenderedSlideId)}, SlideSize:${JSON.stringify(this.viewController.slideSizeEmus)},\n        CanvasWidth:${this.canvas.width}, CanvasHeight:${this.canvas.height},\n        CanvasSizeWidth:${this.clientSize.x}, CanvasSizeHeight:${this.clientSize.y},\n        DPI:${window.devicePixelRatio}, ImageTextureMapSize:${this.viewController.viewDataManager.imageDataMap.size},\n        MemoryStats:${JSON.stringify(this.viewController.viewDataManager.memoryStats)}`),this.viewController.viewDataManager.imageDataMap.forEach((e,t)=>{g.a.sendTraceTag(561639885,_.a.msoulscat_Wac_PptSession,S.a.Warning,`WebGL context lost. imageDataMap Key:${t} Size:${JSON.stringify(e.size)} SlideIds:${JSON.stringify(e.loadedSlideIDs)} Memory:${e.size.x*e.size.y*4}`)});const e=this.viewControllerInternals.slideSceneView.filter(e=>e.scene).map(e=>e.scene),t=this.viewControllerInternals.morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource.morph);g.a.sendTraceTag(561639886,_.a.msoulscat_Wac_PptSession,S.a.Warning,"WebGL context lost. SB Scene Memory:"+JSON.stringify(this.generateTextureMemoryReport(e,t))),this.releaseResources(),this.viewController.events.emit("webglcontextlost")}onRestoreContextFailed(){g.a.sendTraceTag(561639887,_.a.msoulscat_Wac_PptSession,S.a.Error,"webglcontextrestored not raised after 3 seconds"),this.viewController.events.emit("restoreWebGLContextFailed")}renderToTexture(e,t){if(!this.gl)return;const i=new m.f(this.canvas.width,this.canvas.height);$.verifyTextureSize(this.viewController,"transition",i);const n=new O.b("Transition",this.renderer,i,O.e.KeepUntilRelease);if(!n.tryGetWebGLTexture())return;this.viewController.viewDataManager.memoryStats.transitionTextures+=this.canvas.width*this.canvas.height*4,g.a.sendTraceTag(561639888,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::renderToTexture - SlideId: "+e.sid);const r={zoomLevel:F.a.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},a=!F.a.readBooleanOrDefault("saveVerifyGlyphForTransition",!1),s=this.viewController.renderSlideByIdExtended(e,!0,n,t&&t.renderFilter,t&&t.backgroundColor,a,!1,r);return g.a.sendTraceTag(507650462,_.a.msoulscat_Wac_PptSession,S.a.Warning,""+JSON.stringify({...s,correlationId:t&&t.correlationId,isContentTransition:t&&t.isContentTransition})),n}slideIdsToMorphKey(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?`${JSON.stringify(e)}_${JSON.stringify(t)}`:`${JSON.stringify(t)}_${JSON.stringify(e)}`}morphKeyToSlideIds(e){const t=e.split("_");return{slideIdA:JSON.parse(t[0]),slideIdB:JSON.parse(t[1])}}async onContextRestored(){if(xn.gl=this.gl,this.viewControllerInternals.currentRenderedSlideId){const e=this.viewControllerInternals.slideSceneView.find(e=>e.slideId.sid===this.viewControllerInternals.currentRenderedSlideId.sid);if(e){const t=await this.viewControllerInternals.createImageTextureMapData(e);t.hasOwnProperty("invalidImageIds")&&(g.a.sendTraceTag(561639890,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::contextRestoredHandler - "+JSON.stringify(t)),J.e.recordVeto("ACE",t));const i=await e.slideViewElement.ensure();(i.hasOwnProperty("invalidShapeIds")||i.hasOwnProperty("missingTextureIds")||i.hasOwnProperty("errorName"))&&(g.a.sendTraceTag(561639891,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::contextRestoredHandler - "+JSON.stringify(i)),J.e.recordVeto("ACE",i),i.hasOwnProperty("errorName")&&this.viewController.events.emit("restoreWebGLContextFailed"));const n={zoomLevel:F.a.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}};this.viewController.renderSlideById(this.viewControllerInternals.currentRenderedSlideId,n)}}this.viewController.events.emit("webglcontextrestored")}createImageFromTexture(e,t){const i=this.gl;if(!i||!this.isGLContextValid)return void console.log("createImageFromTexture: gl invalid");let n,r,a;e instanceof O.c?(n=e.tryGetWebGLTexture(),0===e.size.x||0===e.size.y?(r=e.originalSize.x,a=e.originalSize.y):(r=e.size.x,a=e.size.y)):(n=e.texture,r=e.size.x,a=e.size.y);const s=i.createFramebuffer(),o=i.getParameter(i.FRAMEBUFFER_BINDING);i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0);const l=new Uint8Array(r*a*4);function d(){const e=document.createElement("canvas");G.ChangeGate.isChangeGateEnabled("SVM.CanvasAriaHidden")&&e.setAttribute("aria-hidden","true"),e.width=r,e.height=a;const t=e.getContext("2d");return{canvas:e,context:t}}i.readPixels(0,0,r,a,i.RGBA,i.UNSIGNED_BYTE,l),i.bindFramebuffer(i.FRAMEBUFFER,o),i.deleteFramebuffer(s);const c=d(),{canvas:h,context:u}=d();if(!u||!c.context)return void console.log("createImageFromTexture: cannot create 2D context");const m=c.context.createImageData(r,a);m.data.set(l),c.context.putImageData(m,0,0),u.translate(0,a),u.scale(1,-1),u.drawImage(c.canvas,0,0);const f=h.toDataURL();if(t&&t.fNewWindow){const e=window.open();if(e){const t=new Image;t.src=f,e.document.write(t.outerHTML)}}return f}constructor(e){this.supportsTransitions=!0,this.supportsGif=!0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,this.m_tech="WebGL",this.events=new Z.EventEmitter,g.a.sendTraceTag(561639874,_.a.msoulscat_Wac_PptSession,S.a.Info,"creating WebGLRendererEnvironment"),console.log("creating WebGLRendererEnvironment"),this.m_shapeBuilderCanvasContext=e,e.addUser(this.events),e.events.on("initStateRestorer",this.onInitStateRestorer.bind(this)),e.events.on("contextLost",this.onContextLost.bind(this)),e.events.on("contextRestored",this.onContextRestored.bind(this)),e.events.on("restoreContextFailed",this.onRestoreContextFailed.bind(this)),e.events.on("logContextCreation",this.logContextCreation.bind(this)),e.events.on("logContextCreationError",this.logContextCreationError.bind(this)),xn.createImageFromTexture=this.createImageFromTexture.bind(this)}}var Bi=i(137),Ni=i(62);class Vi{getDebugStringForItem(e,t){return function e(t,i,n){let r="";const a=function(e,t,i){if(e instanceof T.j){const t=e.role==T.k.background?" background":e.role==T.k.titlePlaceholder?" title Placeholder":e.role==T.k.text?" text":"";let n;if(e.isSolidRect())n=["■ Solid rect"];else if(e.isSolidRectGeometry())n=["□ Rect with line"];else if(n=[e.paths?"〽️"+Ui(e.paths.length,"path"):"❌ no paths!"],e.paths instanceof Array)for(let t of e.paths){let e=[" "," "," "," "];for(let i of t.figures)Wi(i,e,8);if(t.glyphCacheId&&i){const e=i.getDebugGlyphCacheInfo(t.glyphCacheId);n.push(" Font:"+t.glyphCacheId.fontId+", Glyph: "+t.glyphCacheId.glyphId+e==void 0?"Not cached":"Cached on page "+e)}n.push(...e)}const r=e.getBounds()?Xi(e.getBounds()||m.d.Zero):"undefined:",a=[(e.isHidden?"👻 HIDDEN":"🔸")+" Shape"+t+", Bounds: "+r+(e.textRange?", TextRange: "+Yi(e.textRange):""),...n,"📍 Transform: "+Ji(e.transform),"🖍 Style: "+ji(e.style,i)];return(e.effects.replicate||e.effects.glow||e.effects.border||e.effects.shadow||e.effects.innerShadow||e.effects.reflection||e.effects.softEdges)&&a.push("✨ Effects: "+$i(e.effects)),e.text&&a.push(...function(e,t){const i=["🔠 Text "+Ui(e.paragraphs.length,"paragraph")];i.push("📍 LayoutToFrame: "+Ji(e.layoutToFrame)),i.push("📍 FrameToShape:  "+Ji(e.frameToShape));for(let n=0;n<e.paragraphs.length;n++){const r=e.paragraphs[n];i.push(" ¶ Paragraph "+n+(r.bullet?" (with bullet)":" ")+"globalRange: "+Yi(r.globalRange)+", "+r.globalRange.length+" characters");const a=r.stylePerLocalRange.dataPerRange,s=r.effectsPerLocalRange.dataPerRange,o=r.strokesPerLocalRange.dataPerRange;if(a){let e="";for(let i=0;i<a.length;i++)e+=(0==i?"":", ")+Yi(a[i].range)+"("+ji(a[i].data,t)+")";i.push("  🖍 Styles:  "+e)}if(s){let e="";for(let t=0;t<s.length;t++)e+=(0==t?"":", ")+Yi(s[t].range)+"("+$i(s[t].data)+")";i.push("  ✨ Effects: "+e)}if(o){let e="";for(let t=0;t<o.length;t++)e+=(0==t?"":", ")+Yi(o[t].range)+"("+Qi(o[t].data)+")";i.push("  📏 Stokes:  "+e)}for(let e=0;e<r.lines.length;e++){const t=r.lines[e];i.push("  💬 Line "+e+" localRange:"+Yi(t.localRange)+", bounds:"+Xi(t.layoutBounds));let n="    〽️ Paths/Char: ";for(let e of t.characters)n+=e.textImage?"🖼":e.paths instanceof C.d?"〽️":e.paths?0==e.paths.length?"⭕":e.paths.length>9?"+":e.paths.length:"❌";i.push(n),t.bender instanceof b.p?i.push("    Warping Source Bounds "+Xi(t.bender.sourceRect)):t.bender instanceof b.a&&i.push("    Pathing Source Bounds "+Xi(t.bender.lineRect))}}return i}(e.text,i)),a}if(e instanceof T.d){const t=e.getBounds()?Xi(e.getBounds()||m.d.Zero):"undefined:",n=[(e.isHidden?"👻 HIDDEN":"💠")+" Group: "+Ui(e.items.length,"item")+", Bounds: "+t,"📍 Transform: "+Ji(e.transform)];return(e.effects.replicate||e.effects.glow||e.effects.border||e.effects.shadow||e.effects.innerShadow||e.effects.reflection||e.effects.softEdges)&&n.push("✨ Effects: "+$i(e.effects)),e.groupFillBrush&&n.push("🖍 Group Fill: "+Hi(e.groupFillBrush,i)),n}return["❌Unknown"]}(t,0,n);for(let e=0;e<a.length;e++)r+=" ".repeat(i+(0==e?0:2))+a[e]+"\n";if(t instanceof T.d)for(const a of t.items.elements)r+=e(a,i+1,n);return r}(e,0,t)}getDebugStringForMorph(e,t){return function(e,t){let i="Morph "+Ui(e.elements.length,"MorphElement")+":\n";for(let n=0;n<e.elements.length;n++){const r=e.elements[n];let a=[];for(let e of r.keyFrames)a.push(en(e,70,16,t));let s="-----"+"-".repeat(71).repeat(r.keyFrames.length);0==n&&(i+=s+"\n");for(let e=0;e<16;e++){i+="|",i+=3==e?n<10?" "+n+" ":n<100?" "+n:n<1e3?n:"1K+":5==e?null==r.rotateClockwise?"   ":r.rotateClockwise?" ↻ ":" ↺ ":"   ";for(let t=0;t<a.length;t++)i+="|"+a[t][e];i+="|\n"}i+=s+"\n"}return i}(e,t)}}function Wi(e,t,i){const n=new m.f(2*i,2*t.length),r=new Array(n.x*n.y).fill(!1),a=(e,t)=>{e[Object(m.h)(Math.floor(t.x),0,n.x-1)+Object(m.h)(Math.floor(t.y),0,n.y-1)*n.x]=!0},s=Object(C.h)([e]);s&&n.x>0&&e.forEachSegment((e,t,i)=>{for(let s=0;s<=1;s+=1/n.x)a(r,t?m.f.InterpolateQuadratic(e,t,i,s):m.f.InterpolateLinear(e,i,s));return!0},new m.e(s.leftTop.negate(),n.scale(1/Math.max(s.size.x,s.size.y))));for(let e=0;e<t.length;e++)for(let a=0;a<i;a++){const s=2*a+2*e*n.x;t[e]=t[e]+" ▘▝▀▖▌▞▛▗▚▐▜▄▙▟█"[(r[s]?1:0)+(r[s+1]?2:0)+(r[s+n.x]?4:0)+(r[s+1+n.x]?8:0)]+(a==i-1?"  ":"")}}function Ui(e,t){return e+" "+(e>1?t+"s":t)}function zi(e){const t=Math.round(1e4*e)/1e4;return e!=t?t+"…":t}function Hi(e,t){if(e instanceof y.v)return Ki(e.color);if(e instanceof y.e)return"🌈 "+["Linear","Radial","Rectangular","Path"][e.getType()-y.c.linearGradient]+" Gradient";if(e instanceof y.g){let i="🖼 ImageBrush(";if(e.image){if(e.image.id&&(i+="id:"+e.image.id+" "),t){let n=t.tryGetImageDebugData(e.image);if(n){const e=n.getState(),t=n.getSize();e==Ni.b.uninitialized?i+="❌uninitialized":e==Ni.b.deleted?i+="❌deleted":i+=t?t.x+"x"+t.y:"❌no texture + bad state"}}}else i+="❌no image";return 1!=e.opacity&&(i+=", opacity="+e.opacity),i+")"}return e instanceof y.j?"🦓 Pattern":e instanceof y.w?e.getType()==y.c.background?"Background":e.getType()==y.c.group?"Group":"❌ Unknown Custom":"❌ Unknown Brush"}function Gi(e){let t="(";return e.cap!=y.p.round&&(t+=(e.cap==y.p.square?"square":"flat")+"cap"),t+=", ↔"+function(e){switch(e){case y.s.medium:return"medium";case y.s.narrow:return"narrow";case y.s.wide:return"wide"}}(e.width),t+=", ↕"+function(e){switch(e){case y.r.long:return"long";case y.r.medium:return"medium";case y.r.short:return"short"}}(e.length),t+=")",t}function ji(e,t){let i=(e.fillBrush?Hi(e.fillBrush,t):"No ")+" fill";return e.pictureBrush&&(i+=" + Picture "+Hi(e.pictureBrush,t)),e.lineBrush&&(i+=", "+Hi(e.lineBrush,t)+" line, width="+zi(e.pen.lineWidth),e.pen.lineHeight!=e.pen.lineWidth&&(i+=", height="+zi(e.pen.lineHeight)),e.pen.tipType==y.t.square?i+=", ■ Square Tip":e.pen.tipType==y.t.ball&&(i+=", ● Ball Tip"),e.pen.headEnd.end==y.q.none&&e.pen.tailEnd.end==y.q.none||(i+=", LineEnd ("+function(e,t){let i="";switch(e){case y.q.arrow:i+="<";break;case y.q.diamond:i+="◆";break;case y.q.none:i+="";break;case y.q.oval:i+="●";break;case y.q.stealth:i+="⮜";break;case y.q.triangle:i+="◀"}switch(i+="───",t){case y.q.arrow:i+=">";break;case y.q.diamond:i+="◆";break;case y.q.none:i+="";break;case y.q.oval:i+="●";break;case y.q.stealth:i+="➤";break;case y.q.triangle:i+="▶"}return i}(e.pen.headEnd.end,e.pen.tailEnd.end),e.pen.headEnd.end!=y.q.none&&(i+=" head "+Gi(e.pen.headEnd)),e.pen.tailEnd.end!=y.q.none&&(i+=" tail "+Gi(e.pen.tailEnd)),i+=")")),e.blendingMode!=y.a.normal&&(i+=", blendingMode: "+(e.blendingMode==y.a.cutout?"cutout":e.blendingMode==y.a.darken?"darken":e.blendingMode==y.a.exclusion?"exclusion":"❌ unknown")),i}function $i(e){return(e.glow?"Glow ":"")+(e.shadow?"Shadow ":"")+(e.innerShadow?"InnerShadow ":"")+(e.reflection?"Reflection ":"")+(e.softEdges?"SoftEdges ":"")+(e.border?"Border ":"")+(e.replicate?"Replicate ":"")}function qi(e){return"("+zi(e.x)+", "+zi(e.y)+")"}function Zi(e,t){const i=Math.round(10*e.x)/10,n=Math.round(10*(t?e.y:-e.y))/10;return(n<0?i<0?"↖":0==i?"↑":"↗":0==n?i<0?"←":0==i?"∅":"→":i<0?"↙":0==i?"↓":"↘")+qi(e)}function Ji(e){let t="";return 0!=e.preTranslation.x&&0!=e.preTranslation.y&&(t+="PreTranslation "+Zi(e.preTranslation,!0)),1!=e.scale.x&&1!=e.scale.y&&(t+=", Scale x"+qi(e.scale)),0!=e.rotation&&(t+=", Rotation "+(e.rotation>0?"↻":"↺")+Math.round(180*e.rotation/Math.PI)+"°"),t+", Translation "+Zi(e.translation,!0)}function Xi(e){return"[("+zi(e.left)+", "+zi(e.top)+"), ("+zi(e.right)+", "+zi(e.bottom)+")]"}function Yi(e){return 0==e.length?"]"+e.start+"[":1==e.length?"["+e.start+"]":e.length>1?"["+e.start+"-"+e.last+"]":"❌invalid(start="+e.start+", length="+e.length+")"}function Ki(e,t=!1){const i=e=>{const t=Math.floor(255*e);return t<16?"0"+t.toString(16):t.toString(16)};if(t)return"#"+i(e.r)+i(e.g)+i(e.b);const n="#"+i(e.r)+i(e.g)+i(e.b)+i(e.a);switch(n){case"#00000000":return"👻Transparent";case"#000000ff":return"⬛Black";case"#ffffffff":return"⬜White";case"#ff0000ff":return"🟥Red";case"fffff00ff":return"🟨Yellow";case"#00ff00ff":return"🟩Green";case"#0000ffff":return"🟦Blue"}return n}function Qi(e){let t="";if(e.elements)for(let i=0;i<e.elements.length;i++)switch(t+=0==i?"":", ",e.elements[i].type){case b.o.highlighter:t+="🐥";break;case b.o.single:t+="-";break;case b.o.double:t+="=";break;default:t+="~"}return t}function en(e,t,i,n){let r=new Array(i);if(!e)return r.fill(" ".repeat(t)),r[Math.floor(i/2)]=" ".repeat(Math.floor((t-1)/2))+"👻",r[Math.floor(i/2)]+=" ".repeat(t-r[i/2].length),r;n?r=function(e,t,i,n){const r=new Array(i);if(r.fill(""),n){const a=n.tryGetImageDebugDataForMorphKeyFrame(e);if(a){const e=a.getSize();if(e){const n=a.tryConvertToBufferRGBA();if(n){const s=Math.max(e.x,e.y),o=Math.max(1,Math.floor(s/t)),l=Math.max(1,Math.floor(s/i)),d=1/(255*o*l);for(let a=0;a<i;a++)for(let i=0;i<t;i++)if(i*o<e.x&&a*l<e.y){let t=0,s=0,c=0,h=0;for(let r=0;r<l;r++)for(let u=0;u<o;u++){let m=4*(Math.min(i*o+u,e.x-1)+(e.y-1-Math.min(a*l+r,e.y-1))*e.x);t+=n[m]*d,s+=n[m+1]*d,c+=n[m+2]*d,h+=n[m+3]*d}const u=0==h?0:(.2126*t+.7152*s+.0722*c)/h,m="█▓▒░ ";r[a]+=h<.1?"┈":m[Math.max(0,Math.min(4,Math.floor(5*u)))]}else r[a]+=" ";const c=a.getLogicalCenter();if(c){const e=Math.floor(c.x/o),n=Math.floor(c.y/l);e>=0&&e<t&&n>=0&&n<i&&(r[n]=r[n].slice(0,e)+"X"+r[n].slice(e+1,r[n].length))}}else r[0]="❌ Failed to get bufffer"}else r[0]="No texture yet?"}for(let e=0;e<i;e++)r[e].length<t&&(r[e]+=" ".repeat(t-r[e].length)),r[e].length>t&&(r[e]=r[e].slice(0,t));return r}return r}(e,2*i,i,n):r.fill(" ".repeat(t));let a=[];if(0==e.contents.length)a.push("❌ KeyFrame has no content");else if(1==e.contents.length){const r=e.contents[0];if(r.item instanceof T.j){let e;if(r.textRange)a.push("TEXT Only: "+Yi(r.textRange)),r.item.text?e=new T.j(r.item.text.getTextPathsForRange(r.textRange)):a.push("❌ Shape has no text");else{a.push(r.includeSubtree?"SHAPE + Text":"SHAPE Only");const t=r.item.getBounds();a.push("Bounds:"+(t?Xi(t):"❌ bad rect")),r.item.paths||a.push("❌ Shape has no path"),r.item.paths&&r.item.isSolidRectGeometry()?a.push("Rect Geometry"):e=r.item,a.push((r.item.style.fillBrush?Hi(r.item.style.fillBrush,n):"No ")+" fill"),r.item.style.pictureBrush&&a.push("+ 🖼 picture"),r.item.style.lineBrush&&(a.push(Hi(r.item.style.lineBrush,n)+" line"),a.push("width = "+zi(r.item.style.pen.lineWidth)))}if(e){let n=[" "," "," "," "," "," "];const r=t-2*i-2;!function(e,t,i,n=m.c.Identity){const r=new m.f(2*i,2*t.length),a=new Array(r.x*r.y).fill(!1),s=(e,t)=>{e[Object(m.h)(Math.floor(t.x),0,r.x-1)+Object(m.h)(Math.floor(t.y),0,r.y-1)*r.x]=!0};let o=Object(T.q)(e,!1,n);if(o&&r.x>0)for(let t of e.paths||[])for(let e of t.figures)e.forEachSegment((e,t,i)=>{for(let n=0;n<=1;n+=1/r.x)s(a,t?m.f.InterpolateQuadratic(e,t,i,n):m.f.InterpolateLinear(e,i,n));return!0},m.c.FromTransforms(t.transform,n,new m.e(o.leftTop.negate(),r.scale(1/Math.max(o.size.x,o.size.y)))));for(let e=0;e<t.length;e++)for(let n=0;n<i;n++){const s=2*n+2*e*r.x;t[e]=t[e]+" ▘▝▀▖▌▞▛▗▚▐▜▄▙▟█"[(a[s]?1:0)+(a[s+1]?2:0)+(a[s+r.x]?4:0)+(a[s+1+r.x]?8:0)]+(n==i-1?"  ":"")}}(e,n,r,m.c.Scale2D(new m.f(2,r/n.length)));for(let e of n)a.push(e)}}else if(r.item instanceof T.d){a.push(r.textRange?"❌ Group with TextRange ?!":r.includeSubtree?"Group + Subtree":"Group Effects Only"),a.push(function e(t){let i="";for(let n of t.items.elements)i+=n instanceof T.d?"G("+e(n)+")":n instanceof T.j?"S":"❌";return i}(r.item));const e=r.item.getBounds();a.push("Bounds:"+(e?Xi(e):"❌ bad rect"))}}else{a.push(Ui(e.contents.length,"content"));let t="";for(let i=0;i<e.contents.length;i++){const n=e.contents[i];n.item instanceof T.j?t+=n.textRange?"T"+Yi(n.textRange):n.includeSubtree?"S+":"S-":n.item instanceof T.d&&(t+=n.textRange?"❌GT":n.includeSubtree?"G+":"G-"),i!=e.contents.length-1&&(t+=",")}a.push(t)}a.push(""),a.push("Center: ("+Math.floor(e.location.center.x)+", "+Math.floor(e.location.center.y)+")"),a.push("Size: "+Math.floor(e.location.size.x)+" x "+Math.floor(e.location.size.y)),a.push("Rotation: "+Math.round(180*e.location.rotation/Math.PI)),a.push("Flip: "+(e.location.flipX||e.location.flipY?(e.location.flipX?"FlipX ":"")+(e.location.flipY?"FlipY":""):"none")),a.push("Grid: "+(e.morphingGrid?e.morphingGrid.size.x+"x"+e.morphingGrid.size.y:"none")),a.push("ZPos: "+e.zPosition);for(let e=0;e<i;e++)e<a.length&&(r[e]+=" "+a[e]),r[e].length<t&&(r[e]+=" ".repeat(t-r[e].length)),r[e].length>t&&(r[e]=r[e].slice(0,t));return r}var tn=i(6);class nn{static Record(e,t){nn.s_recorder.recordVeto(e,t)}static setRecorder(e){e&&(nn.s_recorder=e)}}nn.s_recorder={recordVeto:(e,t)=>{console.log("Veto",e,t)}};var rn=i(37);class an{detachSVG(){this.svgElement=void 0,this.svgElementContainer=void 0,this.customHtmlElementContainer=void 0,this.localRenderBounds=void 0,this.lastTransform=m.c.Identity,this.lastFadeProgress=1}releaseGeneratedResources(){this.detachSVG(),this.imgUri=void 0}onFinalization(){}constructor(){this.lastTransform=m.c.Identity,this.lastFadeProgress=1}}class sn{releaseGeneratedResources(){}onFinalization(){}}class on{getImageUriFromShape(e){const t=Object(T.t)(e);if(t){const e=this.ensureImageRenderData(t);return e.uri||(ln("simple image has no uri"),tn.a.Error(560989846,"simple image has no uri")),e.uri}}attachCustomHTMLToShape(e,t){this.ensureRenderNode(t).customHtmlElement=e}addOrUpdateShape(e,t,i){const n=this.ensureRenderNode(e),r=n.customHtmlElement;if(!n.svgElement&&!r){n.customHtmlElementContainer=void 0,n.imgUri&&n.versionCached==e.changeTracker.currentUniqueId||(n.imgUri=this.getImageUriFromShape(e),n.versionCached=e.changeTracker.currentUniqueId);const t=n.imgUri;if(n.imgUri){const i="SBSVG_image_"+this.m_nextId;n.svgElement=document.createElementNS("http://www.w3.org/2000/svg","image"),n.svgElement.setAttribute("id",i),n.svgElement.setAttributeNS("http://www.w3.org/1999/xlink","href",t||"");const r=Object(T.q)(e,!1);r?(n.svgElement.setAttribute("width",r.width.toString()),n.svgElement.setAttribute("height",r.height.toString()),n.svgElement.setAttribute("x",r.left.toString()),n.svgElement.setAttribute("y",r.top.toString()),n.localRenderBounds=r):(ln("simple image has no bounds"),tn.a.Error(562042566,"simple image has no bounds"))}else{n.svgElement=function(e,t){if(e.style.pictureBrush)return ln("pictureBrush not SimpleImage"),void tn.a.Error(562042571,'pictureBrush only supported for "SimpleImage"');if(e.style.fillBrush&&!(e.style.fillBrush instanceof y.v))return ln("fillBrush type "+e.style.fillBrush.getType()),void tn.a.Error(562042572,"unsupported fillBrush type "+e.style.fillBrush.getType());if(e.style.lineBrush&&!(e.style.lineBrush instanceof y.v))return ln("lineBrush type "+e.style.lineBrush.getType()),void tn.a.Error(562042573,"unsupported lineBrush type "+e.style.lineBrush.getType());if(e.effects.hasEffects||e.shape3D||e.scene3D)return ln("effects"),void tn.a.Error(562042574,"unsupported effects");if(e.text)return ln("text"),void tn.a.Error(562042575,"unsupported text");if(e.style.pen.dashType!=y.o.solid||e.style.pen.compoundType!=y.n.simple)return ln("dash/compound line"),void tn.a.Error(562042576,"unsupported dash/compound line");if(e.style.blendingMode!=y.a.normal)return ln("blending mode"),void tn.a.Error(560989847,"unsupported blending mode "+e.style.blendingMode);let i="";for(let t of e.paths||[])for(let e of t.figures){let n=!0;e.forEachSegment((e,t,r)=>(n&&(i+=`M ${e.x} ${e.y} `,n=!1),i+=t?`Q ${t.x} ${t.y}, ${r.x} ${r.y} `:`L ${r.x} ${r.y} `,!0),t.transform),e.isClosed&&(i+="Z")}if(""==i)return ln("empty path"),void tn.a.Error(562042577,"empty path");const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("id",t),n.setAttribute("d",i),rn.a.readBooleanOrDefault("redPathSVG",!1)?(n.setAttribute("stroke","red"),n.setAttribute("stroke-width","4")):(e.style.fillBrush instanceof y.v&&(n.setAttribute("fill",Ki(e.style.fillBrush.color,!0)),n.setAttribute("fill-opacity",e.style.fillBrush.color.a.toString())),e.style.lineBrush instanceof y.v&&(n.setAttribute("stroke",Ki(e.style.lineBrush.color,!0)),n.setAttribute("stroke-opacity",e.style.lineBrush.color.a.toString())),n.setAttribute("stroke-width",e.style.lineBrush?e.style.pen.lineWidth.toString():"0")),n}(e,"SBSVG_path_"+this.m_nextId);const t=Object(T.q)(e,!0);n.localRenderBounds=t}if(!n.svgElement)return void tn.a.Error(562042567,"Unsupported SVG scenario");{let e=document.createElementNS("http://www.w3.org/2000/svg","svg");const t=document.createElement("span");t.style.position="absolute",t.style.display="flex",t.appendChild(e),this.canvas.appendChild(t),n.svgElementContainer=t,n.localRenderBounds&&(e.setAttribute("width",n.localRenderBounds.width.toString()),e.setAttribute("height",n.localRenderBounds.height.toString()),n.svgElement.setAttribute("transform",`translate(${-n.localRenderBounds.left},${-n.localRenderBounds.top})`)),e.appendChild(n.svgElement)}this.m_nextId++}if(r&&!n.customHtmlElementContainer){const e=document.createElement("div");e.style.position="absolute",e.appendChild(r),this.canvas.appendChild(e),n.customHtmlElementContainer=e}const a=n.svgElementContainer&&n.localRenderBounds?m.c.Translation2D(n.localRenderBounds.size.scale(.5)):m.c.Identity,s=n.svgElementContainer&&n.localRenderBounds?m.c.Translation2D(n.localRenderBounds.size.scale(-.5)):m.c.Identity,o=m.c.FromTransforms(a,t,e.animationTransform||m.c.Identity,i&&i.transform?i.transform:m.c.Identity,s);if(!n.lastTransform.equals(o)){const e=n.customHtmlElementContainer||n.svgElementContainer;e?e.style.transform=`matrix(${o.m[0]},${o.m[1]},${o.m[3]},${o.m[4]},${o.m[6]},${o.m[7]})`:n.svgElement&&n.svgElement.setAttribute("transform",`matrix(${o.m[0]} ${o.m[1]} ${o.m[3]} ${o.m[4]} ${o.m[6]} ${o.m[7]})`)}const l=(e.fade?e.fade.progress:1)*(e.isHidden?0:1);n.lastFadeProgress!=l&&(n.customHtmlElementContainer&&(n.customHtmlElementContainer.style.opacity=l.toString()),n.svgElement&&n.svgElement.setAttribute("opacity",l.toString()))}buildTreeSvg(e,t,i){const n=e.transform.toMatrix3().multiply(t);if(e instanceof T.j)this.addOrUpdateShape(e,n,i);else if(e instanceof T.d)for(let t of e.items.elements)this.buildTreeSvg(t,n,i)}clearNodes(e){if(this.ensureRenderNode(e).detachSVG(),e instanceof T.d)for(let t of e.items.elements)this.clearNodes(t)}static clearElement(e){let t;for(;t=e.firstChild;)e.removeChild(t)}render(e,t,i){this.m_rootId!=e.changeTracker.currentUniqueId&&(on.clearElement(this.canvas),this.m_rootId=e.changeTracker.currentUniqueId,this.clearNodes(e)),t&&(this.canvas instanceof SVGElement?this.canvas.style.background=Ki(t,!0):this.canvas.style.backgroundColor=Ki(t,!0)),this.buildTreeSvg(e,m.c.Identity,i),Ni.a.OnRender(this,[{item:e,eraseBackground:t,options:i}])}renderMorph(e,t,i,n,r){throw tn.a.Error(562042568,"Morph not supported in SVG mode")}hitTestScene(e,t,i,n){throw tn.a.Error(562042569,"Hit Test not supported in SVG mode")}tryPrepareItem(e,t,i){return!0}tryPrepareMorph(e,t){throw tn.a.Error(562042570,"Morph not supported in SVG mode")}getDebugString(e){return"NYI"}tryGetImageDebugData(e){}tryGetImageDebugDataForMorphKeyFrame(e){}getDebugGlyphCacheInfo(e){}attachUriToImage(e,t){this.ensureImageRenderData(e).uri=t}ensureRenderNode(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new an,e.renderDataMap[this.m_rendererId]=t),t}ensureImageRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new sn,e.renderDataMap[this.m_rendererId]=t),t}constructor(e){this.m_nextId=1,this.canvas=e,this.m_rendererId="SVG"+on.s_nextSVGRendererId++}}function ln(e){nn.Record("ShapeNotRendered",[{Renderer:"SVGRenderer"},{Scenario:e}])}function dn(e={}){return new Bi.a(e)}on.s_nextSVGRendererId=1;class cn{get clientSize(){return this.viewController.getBounds.getClientSizeFromCanvas()}removeCanvas(e){this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.container=void 0,this.isCanvasSizeSet=!1)}setupCanvas(e){if(!Mn.getElementFromCollection(e.children,"svg-canvas")){if(this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&this.container){const t=Mn.getElementFromCollection(this.container.children,"svg-canvas");if(t)return e.appendChild(t),void(this.container=e)}this.canvas.id="svg-canvas",this.canvas.style.pointerEvents="none",this.canvas.style.background="white",this.viewControllerInternals.settings.transparentCanvasForVideoEnabled&&(this.canvas.style.zIndex="1"),e.appendChild(this.canvas),this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&(this.container=e),this.isCanvasSizeSet=!1}}setCanvasSize(e,t){this.canvas.style.width=e.x+"px",this.canvas.style.height=e.y+"px",this.canvas.style.minWidth=e.x+"px",this.canvas.style.minHeight=e.y+"px",this.svgRoot.style.width=e.x+"px",this.svgRoot.style.height=e.y+"px",this.isCanvasSizeSet=!0}calculateRenderTransform(e){const t=this.getPixelScale(e),i=Math.min(t.x,t.y);return new m.e(new m.f(-e.x/2,-e.y/2),new m.f(i,i),void 0,new m.f(this.clientSize.x/2,this.clientSize.y/2))}calculateRenderTransformWithZoom(e,t,i){const n=this.getPixelScale(e);let r=t,a=i;return r&&a||(r=Math.min(n.x,n.y),a=new m.f(r*e.x/2,r*e.y/2)),new m.e(new m.f(-e.x/2,-e.y/2),new m.f(r,r),void 0,Oi(new m.f(this.clientSize.x/2,this.clientSize.y/2),a,e,r,1))}async preloadShadersAsync(e){}flush(){}getPerformanceSummary(){}generateTextureMemoryReport(e,t){}verifyGlyphCacheIntegrityAndTryRecover(){return!0}attachImage(e,t,i,n){if(!i.dataUri)throw g.a.sendTraceTag(507004186,_.a.msoulscat_Wac_PptSession,S.a.Error,"dataUrl missing"),new Error("dataUrl missing");this.renderer.attachUriToImage(t,i.dataUri)}releaseImageData(e){}saveImageData(e,t,i,n,r){if(F.a.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){const i=F.a.readNumberOrDefault("maxSvgTextureSize",2048),a=Math.max(t.size.width,t.size.height),s=r.x/n.x,o=r.y/n.y,l=a*Math.min(s,o)*(n.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(i,l),g.a.sendTraceTag(507004185,_.a.msoulscat_Wac_PptSession,S.a.Info,`loadImageTexture: SVG width = ${e.width}px, height = ${e.height}`)}return this.viewController.viewDataManager.imageDataMap.set(e.ID,{dataUri:e.src,size:new m.f(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[i]}),g.a.sendTraceTag(507004184,_.a.msoulscat_Wac_PptSession,S.a.Info,"loadImageTexture - loaded "+JSON.stringify({id:e.ID,slideId:i,width:e.naturalWidth,height:e.naturalHeight,byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType})),{}}async createTransition(e,t,i,n,r,a){return{fSuccess:!1}}enableVerboseRenderLogging(e){}getPixelScale(e){const t=this.clientSize.x/e.x,i=this.clientSize.y/e.y;return new m.f(t,i)}constructor(){this.supportsTransitions=!1,this.supportsGif=!1,this.isGLContextValid=!0,this.isSBValid=!0,this.glContext=void 0,this.webGLRenderer=void 0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,g.a.sendTraceTag(507004187,_.a.msoulscat_Wac_PptSession,S.a.Info,"creating SVGRendererEnvironment"),console.log("creating SVGRendererEnvironment");const e=document.createElement("div");e.style.position="absolute",e.style.overflow="hidden",e.setAttribute("aria-hidden","true"),this.renderer=new on({canvas:e}.canvas),F.a.readBooleanOrDefault("enableOpticalZoom",!1)&&e.addEventListener("scroll",()=>{e.scrollLeft=0,e.scrollTop=0}),this.canvas=document.createElement("div"),this.canvas.appendChild(e),this.svgRoot=e,Mn.s_rendererTech="SVG",Mn.s_isBadGpu=!1}}var hn=i(53);class un{ensureCachedBounds(){const e=this.m_rendererEnvironment.canvas;return this.m_lastBoundingClientRectFromContainer||(this.m_lastBoundingClientRectFromContainer=this.m_container.getBoundingClientRect()),!this.m_lastBoundingClientRectFromCanvas&&e&&(this.m_lastBoundingClientRectFromCanvas=e.getBoundingClientRect()),this.m_lastClientSizeFromContainer===m.f.Zero&&e&&(this.m_lastClientSizeFromContainer=new m.f(e.clientWidth,e.clientHeight)),this.m_lastClientSizeFromCanvas===m.f.Zero&&e&&(this.m_lastClientSizeFromCanvas=new m.f(e.clientWidth,e.clientHeight)),!(!this.m_lastBoundingClientRectFromContainer||!this.m_lastBoundingClientRectFromCanvas||this.m_lastClientSizeFromContainer===m.f.Zero||this.m_lastClientSizeFromCanvas===m.f.Zero)}getBoundingClientRectFromContainer(){if(F.a.readBooleanOrDefault("useCachedClientSize",!1)){const e=this.m_container.getBoundingClientRect();return 0===e.width||0===e.height?this.m_lastBoundingClientRectFromContainer?this.m_lastBoundingClientRectFromContainer:(g.a.sendTraceTag(507003970,_.a.msoulscat_Wac_PptSession,S.a.Error,"unable to getBoundingClientRect from canvas"),e):(this.m_lastBoundingClientRectFromContainer=e,e)}return this.m_container.getBoundingClientRect()}getBoundingClientRectFromCanvas(){if(F.a.readBooleanOrDefault("useCachedClientSize",!1)){const e=this.m_rendererEnvironment.canvas.getBoundingClientRect();return 0===e.width||0===e.height?this.m_lastBoundingClientRectFromCanvas?this.m_lastBoundingClientRectFromCanvas:(g.a.sendTraceTag(507003969,_.a.msoulscat_Wac_PptSession,S.a.Error,"unable to getBoundingClientRect from canvas"),e):(this.m_lastBoundingClientRectFromCanvas=e,e)}return this.m_rendererEnvironment.canvas.getBoundingClientRect()}getClientSizeFromCanvas(){const e=this.m_rendererEnvironment.canvas;if(F.a.readBooleanOrDefault("useCachedClientSize",!1)){const t=new m.f(e.clientWidth,e.clientHeight);return 0===t.x||0===t.y?(0!==this.m_lastClientSizeFromCanvas.x&&0!==this.m_lastClientSizeFromCanvas.y||g.a.sendTraceTag(507003968,_.a.msoulscat_Wac_PptSession,S.a.Error,"unable to get clientWidth or clientHeight from canvas"),this.m_lastClientSizeFromCanvas):(this.m_lastClientSizeFromCanvas=t,t)}return new m.f(e.clientWidth,e.clientHeight)}getClientSizeFromContainer(){if(F.a.readBooleanOrDefault("useCachedClientSize",!1)){const e=new m.f(this.m_container.clientWidth,this.m_container.clientHeight);return 0===e.x||0===e.y?this.m_lastClientSizeFromContainer?this.m_lastClientSizeFromContainer:(g.a.sendTraceTag(507003939,_.a.msoulscat_Wac_PptSession,S.a.Error,"unable to clientWidth or clientHeight from container"),e):(this.m_lastClientSizeFromContainer=e,e)}return new m.f(this.m_container.clientWidth,this.m_container.clientHeight)}constructor(e,t){this.m_lastClientSizeFromCanvas=m.f.Zero,this.m_lastClientSizeFromContainer=m.f.Zero,this.m_container=e,this.m_rendererEnvironment=t,F.a.readBooleanOrDefault("useCachedClientSize",!1)&&Object(hn.e)(()=>this.ensureCachedBounds())}}var mn=i(131);function fn(e){return new mn.a(!!e)}var pn=i(113);function gn(){return new pn.c}function _n(){return new Vi}var Sn,vn,yn=i(30),Tn=i(40);class bn{init(e){this.m_onInitStateRestorer()}setDefaults(){}restore(){}constructor(e){this.m_onInitStateRestorer=e}}class wn{get isReady(){return this.m_isSBRendererReady}addUser(e){e.on("releasedResources",()=>{this.gl=void 0})}setupCanvas(e,t){const i=Mn.getElementFromCollection(e.children,"webgl-canvas");if(i)return this.canvas=i,void this.setupWebGLContext();if(t&&t.useRemovableCanvas&&this.m_container){const t=Mn.getElementFromCollection(this.m_container.children,"webgl-canvas");if(t)return e.appendChild(t),void(this.m_container=e)}this.canvas=document.createElement("canvas"),this.canvas.id="webgl-canvas",G.ChangeGate.isChangeGateEnabled("SVM.CanvasAriaHidden")&&this.canvas.setAttribute("aria-hidden","true"),t&&t.useZIndex1&&(this.canvas.style.zIndex="1"),this.setupWebGLContext(),this.canvas.addEventListener("webglcontextlost",e=>this.lostContextHandler(e)),this.canvas.addEventListener("webglcontextrestored",()=>this.contextRestoredHandler()),e.appendChild(this.canvas),t&&t.useRemovableCanvas&&(this.m_container=e)}setCanvasSize(e,t){return this.canvas.style.width=e.x+"px",this.canvas.style.height=e.y+"px",this.canvas.width=Math.round(t.x),this.canvas.height=Math.round(t.y),this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),!0}lostContextHandler(e){e.preventDefault(),F.a.readBooleanOrDefault("deleteStateObjectOnContextLostWorkaround",!1)&&this.gl&&(Object(Tn.i)(this.gl),g.a.sendTraceTag(561639885,_.a.msoulscat_Wac_PptSession,S.a.Warning,"lostContextHandler: called deleteStateObject")),this.events.emit("contextLost"),this.m_webGLContextLostStartTime=new Date,this.m_isSBRendererReady=!1,this.renderer.onWebGLContextLost(),G.ChangeGate.isChangeGateEnabled("SSC.WebGLContextRestoreLogging")&&g.a.sendTraceTag(505943489,_.a.msoulscat_Wac_PptSession,S.a.Warning,`Wait for webgl restore. DocumentVisibility:${document.visibilityState}, webGLContextRestoreStartTime:${this.m_webGLContextRestoreStartTime}, webGLContextLostStartTime:${this.m_webGLContextLostStartTime}`),G.ChangeGate.isChangeGateEnabled("SSC.VisibilityChangeRefactoring")?"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)&&(this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{var e;this.m_lostContextExtension=void 0,null===(e=this.m_forceContextLostClock)||void 0===e||e.abort(),this.events.emit("restoreContextFailed")},F.a.readNumberOrDefault("webGLContextRestoredTimeout",3e3))):("visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)&&(this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{document.removeEventListener("visibilitychange",this.onVisibilityChangeDeprecated),this.events.emit("restoreContextFailed")},F.a.readNumberOrDefault("webGLContextRestoredTimeout",3e3))),document.addEventListener("visibilitychange",this.onVisibilityChangeDeprecated))}setActiveTab(){if(this.m_useLocalStorageToDetectActiveTab)try{localStorage.setItem(wn.s_activeTabKey,wn.s_tabId)}catch(e){g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Warning,"disabling m_useLocalStorageToDetectActiveTab due to localStorage exception: "+e),this.m_useLocalStorageToDetectActiveTab=!1}}isActiveTab(){return"visible"===document.visibilityState||!this.m_forceContextLostIfTabIsInactive||this.m_useLocalStorageToDetectActiveTab&&localStorage.getItem(wn.s_activeTabKey)===wn.s_tabId}handleActiveTab(){var e;if(null===(e=this.m_forceContextLostClock)||void 0===e||e.abort(),this.m_lostContextExtension)try{return g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"Restoring context after losing it to save resources"),this.m_lostContextExtension.restoreContext(),this.m_lostContextExtension=void 0,g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"Restored context after losing it to save resources"),!0}catch(e){return g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Warning,"restoreContext failed losing context to save resources: "+e),this.events.emit("restoreContextFailed"),!0}return!1}handleInactiveTab(){if(this.m_useLocalStorageToDetectActiveTab)return g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"Tab inactive, forcing context lost immediately"),void this.forceContextLost();g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"Tab inactive, starting the clock to force context lost"),this.m_forceContextLostClock=new D(()=>this.forceContextLost(),F.a.readNumberOrDefault("loseContextWhenHiddenTimeoutMs",3e3))}forceContextLost(){var e;if(this.gl){var t;if(this.isActiveTab())return null===(t=this.m_forceContextLostClock)||void 0===t||t.abort(),void(this.m_forceContextLostClock=void 0);this.m_lostContextExtension||(this.m_lostContextExtension=this.gl.getExtension("WEBGL_lose_context")),g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"Forcing context lost to save resources"),null===(e=this.m_lostContextExtension)||void 0===e||e.loseContext()}}async contextRestoredHandler(){this.m_webGLContextRestoreStartTime=new Date;const e=this.m_webGLContextLostStartTime?this.m_webGLContextRestoreStartTime.getTime()-this.m_webGLContextLostStartTime.getTime():-1;g.a.sendTraceTag(561639889,_.a.msoulscat_Wac_PptSession,S.a.Info,`WebGL context restored in ${e}ms`),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0,G.ChangeGate.isChangeGateEnabled("SSC.VisibilityChangeRefactoring")||document.removeEventListener("visibilitychange",this.onVisibilityChangeDeprecated),this.setupWebGLContext(),this.gl&&(await this.preloadShadersAsync(this.gl),this.events.emit("contextRestored"))}setupWebGLContext(){this.canvas.addEventListener("webglcontextcreationerror",e=>this.events.emit("logContextCreationError",e));const e={failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0},t={failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0};let i=[{contextId:"webgl",options:e},{contextId:"experimental-webgl",options:e},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t}];F.a.readBooleanOrDefault("webgl2Enabled",!1)&&(i=[{contextId:"webgl2",options:e},{contextId:"webgl",options:e},{contextId:"experimental-webgl",options:e},{contextId:"webgl2",options:t},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t}]);for(const e of i)if(this.gl=this.canvas.getContext(e.contextId,e.options)||void 0,this.gl){const i="webgl2"===e.contextId?"WebGL2":"WebGL",n=e.options===t;let r;const a=this.gl.getExtension("WEBGL_debug_renderer_info");a&&(r=this.gl.getParameter(a.UNMASKED_RENDERER_WEBGL).toLowerCase()),this.events.emit("logContextCreation",{fSuccess:!0,data:{rendererTech:i,unmaskedRenderer:r,hasPerfCaveat:n}});break}this.gl?this.gl.viewport(0,0,this.canvas.width,this.canvas.height):this.events.emit("logContextCreation",{fSuccess:!1})}removeCanvas(e){this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.m_container=void 0)}async preloadShadersAsync(e){try{null==e.getExtension("KHR_parallel_shader_compile")&&g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"WebGL extension KHR_parallel_shader_compile is unsupported.");const t=Mn.performanceNowTrimmed();let i;this.m_isSBRendererReady=!1,F.a.readBooleanOrDefault("useMinimalShaderSet",!1)&&(i={programIds:[yn.a.distanceField,yn.a.shapeRender,yn.a.gradient,yn.a.blur,yn.a.fade,yn.a.copyTexture,yn.a.copyTexturePictureEffects,yn.a.draw3D,yn.a.copyTextureDrawMask,yn.a.sharpnessFilter,yn.a.magic]});const n=this.renderer.initializeAsync(e,i),r=this.renderer.getBabylonEngine();if(!r)throw g.a.sendTraceTag(538981318,_.a.msoulscat_Wac_PptSession,S.a.Error,"engine missing"),Error("no babylon engine");const a=Object(Pi.e)(r);await Promise.all([n,a]),this.m_isSBRendererReady=!0;const s=Mn.performanceNowTrimmed();g.a.sendTraceTag(561639875,_.a.msoulscat_Wac_PptSession,S.a.Info,`SB Shader Compilation finished in ${s-t}ms`)}catch(e){g.a.sendTraceTag(507884681,_.a.msoulscat_Wac_PptSession,S.a.Warning,"preloadShaders failed: "+e)}}constructor(){this.events=new Z.EventEmitter,this.m_isSBRendererReady=!1,this.onVisibilityChangeDeprecated=()=>{this.m_webGLContextLostStartTime&&"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)?this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{document.removeEventListener("visibilitychange",this.onVisibilityChangeDeprecated),this.events.emit("restoreContextFailed")},F.a.readNumberOrDefault("webGLContextRestoredTimeout",3e3)):"hidden"===document.visibilityState&&(g.a.sendTraceTag(509723856,_.a.msoulscat_Wac_PptSession,S.a.Info,"Clearing the restore WebGL timeout as visibility is lost"),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0)},this.onVisibilityChange=()=>{const e=this.m_webGLContextLostStartTime&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime);if("visible"===document.visibilityState){if(this.setActiveTab(),this.handleActiveTab())return;e&&!this.m_lostContextExtension&&(this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{this.events.emit("restoreContextFailed")},F.a.readNumberOrDefault("webGLContextRestoredTimeout",3e3)))}else"hidden"===document.visibilityState&&(g.a.sendTraceTag(509723856,_.a.msoulscat_Wac_PptSession,S.a.Info,"Clearing the restore WebGL timeout as visibility is lost"),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0,e||this.isActiveTab()||this.handleInactiveTab())},this.onStorageChange=e=>{this.m_useLocalStorageToDetectActiveTab&&e.key===wn.s_activeTabKey&&(this.isActiveTab()||this.handleInactiveTab())},g.a.sendTraceTag(0,_.a.msoulscat_Wac_PptSession,S.a.Info,"Using the default ShapeBuilderCanvasContext"),console.log("Using the default ShapeBuilderCanvasContext");let e=new bn(()=>{this.events.emit("initStateRestorer")});F.a.readBooleanOrDefault("hackStateRestorerOn",!1)&&(e=fn(!1)),this.renderer=dn({stateRestorer:e,morphPlayer:gn(),debugStringProvider:_n()}),this.m_forceContextLostIfTabIsInactive=F.a.readBooleanOrDefault("forceContextLostIfTabIsInactive",!1),this.m_useLocalStorageToDetectActiveTab=F.a.readBooleanOrDefault("useLocalStorageToDetectActiveTab",!1),G.ChangeGate.isChangeGateEnabled("SSC.VisibilityChangeRefactoring")&&(document.addEventListener("visibilitychange",this.onVisibilityChange),window.addEventListener("storage",this.onStorageChange)),this.setActiveTab()}}wn.s_tabId=Math.random().toString(36).substring(2,15),wn.s_activeTabKey="activeTabId";class Cn{init(e){this.m_env.setRenderingScenario(0)}setDefaults(){}restore(){}constructor(e){this.m_env=e}}class In{get isGLContextValid(){return!!this.gl&&!this.gl.isContextLost()}get isSBValid(){return this.m_isSBRendererReady}get glContext(){return this.gl}get webGLRenderer(){return this.renderer}get tech(){return this.m_tech}get clientSize(){return this.viewController.getBounds.getClientSizeFromCanvas()}setRenderingScenario(e){if(e===this.m_renderingScenario)return;const t=this.renderer.getBabylonEngine();t&&t.wipeCaches(!0),this.m_renderingScenario=e}removeCanvas(e){this.releaseResources(),this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.isCanvasSizeSet=!1,this.container=void 0)}releaseResources(){this.viewController.viewDataManager.imageDataMap=new Map,this.viewController.viewDataManager.memoryStats.gifTextures=0,this.viewController.viewDataManager.memoryStats.transitionTextures=0,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport=new Pi.b,this.viewController.viewDataManager.memoryStats.videoTextures=0,this.viewController.viewDataManager.memoryStats.cameoTextures=0;for(const e of this.viewController.viewDataManager.externalTexturesToRelease)e.texture.release();this.viewController.viewDataManager.externalTexturesToRelease=[];for(const e of this.viewControllerInternals.slideSceneView)e.scene&&this.viewControllerInternals.deleteScene(e),e.slideViewElement.shapeViewElements=[],F.a.readBooleanOrDefault("enableFailTextureLoadOnContextLost",!1)&&(e.slideViewElement.fImageTextureLoaded=!1,e.slideViewElement.fImageTextureLoading=!1);this.gl=void 0,xn.gl=this.gl}setupCanvas(e){const t=Mn.getElementFromCollection(e.children,"webgl-canvas");if(t)return this.canvas=t,void this.setupWebGLContext();if(this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&this.container){const t=Mn.getElementFromCollection(this.container.children,"webgl-canvas");if(t)return e.appendChild(t),void(this.container=e)}this.canvas=document.createElement("canvas"),G.ChangeGate.isChangeGateEnabled("SVM.CanvasAriaHidden")&&this.canvas.setAttribute("aria-hidden","true"),this.canvas.id="webgl-canvas",this.canvas.style.pointerEvents="none",this.viewControllerInternals.settings.transparentCanvasForVideoEnabled&&(this.canvas.style.zIndex="1"),this.setupWebGLContext(),this.canvas.addEventListener("webglcontextlost",e=>this.lostContextHandler(e)),this.canvas.addEventListener("webglcontextrestored",()=>this.contextRestoredHandler()),e.appendChild(this.canvas),this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&(this.container=e),this.isCanvasSizeSet=!1}setCanvasSize(e,t){this.devicePixelsToRenderedPixelsScale=t,this.canvas.style.width=e.x+"px",this.canvas.style.height=e.y+"px",this.canvas.width=Math.round(e.x*window.devicePixelRatio*t),this.canvas.height=Math.round(e.y*window.devicePixelRatio*t),this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.isCanvasSizeSet=!0}calculateRenderTransform(e){const t=this.getPixelScale(e),i=Math.min(t.x,t.y);return new m.e(new m.f(-e.x/2,-e.y/2),new m.f(i,i),void 0,new m.f(this.canvas.width/2,this.canvas.height/2))}calculateRenderTransformWithZoom(e,t,i){const n=this.getPixelScale(e);let r=t,a=i;return r&&a||(r=Math.min(n.x,n.y),a=new m.f(r*e.x/2,r*e.y/2)),new m.e(new m.f(-e.x/2,-e.y/2),new m.f(r,r),void 0,Oi(new m.f(this.clientSize.x/2,this.clientSize.y/2),a,e,r,window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale))}async preloadShadersAsync(e){try{e.getExtension("KHR_parallel_shader_compile");const t=Mn.performanceNowTrimmed();let i;this.m_isSBRendererReady=!1,F.a.readBooleanOrDefault("useMinimalShaderSet",!1)&&(i={programIds:[yn.a.distanceField,yn.a.shapeRender,yn.a.gradient,yn.a.blur,yn.a.fade,yn.a.copyTexture,yn.a.copyTexturePictureEffects,yn.a.draw3D,yn.a.copyTextureDrawMask,yn.a.sharpnessFilter,yn.a.magic]});const n=this.renderer.initializeAsync(e,i),r=this.renderer.getBabylonEngine();if(!r)throw g.a.sendTraceTag(538981318,_.a.msoulscat_Wac_PptSession,S.a.Error,"engine missing"),Error("no babylon engine");const a=Object(Pi.e)(r);await Promise.all([n,a]),this.m_isSBRendererReady=!0;const s=Mn.performanceNowTrimmed();g.a.sendTraceTag(561639875,_.a.msoulscat_Wac_PptSession,S.a.Info,`SB Shader Compilation finished in ${s-t}ms`)}catch(e){g.a.sendTraceTag(507884681,_.a.msoulscat_Wac_PptSession,S.a.Warning,"preloadShaders failed: "+e)}}flush(){this.gl&&this.gl.flush()}getPerformanceSummary(){return this.renderer.getPerformanceSummary()}generateTextureMemoryReport(e,t){return this.renderer.generateTextureMemoryReport(e,t)}verifyGlyphCacheIntegrityAndTryRecover(){return this.renderer.verifyGlyphCacheIntegrityAndTryRecover()}attachImage(e,t,i,n){if(!i.texture)throw g.a.sendTraceTag(561639876,_.a.msoulscat_Wac_PptSession,S.a.Error,"texture missing"),new Error("texture missing");const r=new O.c(e,this.renderer,i.texture,n,X.d.RGBA,y.y.clamp,O.e.ExternallyManaged);i.size.equals(n)||g.a.sendTraceTag(559269018,_.a.msoulscat_Wac_PptSession,S.a.Warning,`attachImage imageData.size:${JSON.stringify(i.size)} != size:${JSON.stringify(n)}`),t.id||g.a.sendTraceTag(561639877,_.a.msoulscat_Wac_PptSession,S.a.Error,"Missing imageContainer.id: "+t.id),this.viewController.viewDataManager.externalTexturesToRelease.push({imageId:t.id||"unknown",texture:r}),this.renderer.attachTextureToImage(t,r)}releaseImageData(e){e.texture&&this.gl&&this.gl.deleteTexture(e.texture)}saveImageData(e,t,i,n,r){const a=this.gl;if(!a)return g.a.sendTraceTag(561639878,_.a.msoulscat_Wac_PptSession,S.a.Error,"No webGL Context found"),{errorName:Mi.CannotLoadTextureNoWebGLContext};const s=a.createTexture();if(!s)return g.a.sendTraceTag(561639879,_.a.msoulscat_Wac_PptSession,S.a.Error,"Failed to create texture"),{errorName:Mi.CreateTextureFailed};if(F.a.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){const i=F.a.readNumberOrDefault("maxSvgTextureSize",2048),a=Math.max(t.size.width,t.size.height),s=r.x/n.x,o=r.y/n.y,l=a*Math.min(s,o)*(n.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(Math.max(e.naturalHeight,e.naturalWidth,l),i),g.a.sendTraceTag(561639880,_.a.msoulscat_Wac_PptSession,S.a.Info,`loadImageTexture: SVG width = ${e.width}px, height = ${e.height}`)}a.bindTexture(a.TEXTURE_2D,s),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null);const o=e.ID,l=this.viewController.viewDataManager.imageDataMap.get(o);return l&&(this.viewController.viewDataManager.memoryStats.externalTextureLeaks+=l.size.x*l.size.y*4,F.a.readBooleanOrDefault("releaseExistingExternalImages",!1)&&(this.releaseImageData(l),this.viewController.viewDataManager.onExternalTextureReleased(o))),this.viewController.viewDataManager.imageDataMap.set(o,{dataUri:e.src,texture:s,size:new m.f(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[i]}),g.a.sendTraceTag(561639881,_.a.msoulscat_Wac_PptSession,S.a.Info,"loadImageTexture - loaded "+JSON.stringify({id:e.ID,slideId:i,size:new m.f(e.width,e.height),naturalSize:new m.f(e.naturalWidth,e.naturalHeight),byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType})),{}}async createTransition(e,t,i,n,r,a,s){const o={fSuccess:!1},l=e.type,d=e.dir,c=e.dur,h={};o.effectId=l;const u=s&&s.correlationId,f={aspectRatio:r,direction:d,forward:n,gl:this.gl,engine:this.renderer.getBabylonEngine(),incomingSlideBackground:void 0,outgoingSlideBackground:void 0,incomingSlideForeground:void 0,outgoingSlideForeground:void 0};let p,g,_=!0,S=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(S=Mn.performanceNowTrimmed());const v=this.viewController.getSlideViewElement(i),T=this.viewController.getSlideViewElement(t);G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h.getSlideViewElementMS=Mn.performanceNowTrimmed()-S);let b=()=>{},w=()=>{};if(a&&v&&T&&e.morph&&(l===Pi.h.PPT_TRANSITION_MORPH||l===Pi.h.PPT_TRANSITION_PAN)){G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o.metadata||(o.metadata={}),h.morphTransitionFlow=!0);const e=this.viewController.viewDataManager.getSlideIndex(i),r=this.viewController.viewDataManager.getSlideIndex(t),a=this.slideIdsToMorphKey(i,t);if(a&&-1!==e&&-1!==r&&1===Math.abs(r-e)){let e=0;G.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(e=Mn.performanceNowTrimmed());const r=await this.viewControllerInternals.morphCache.load(a,{meta_prevSlideId:n?i:t,meta_nextSlideId:n?t:i});if(G.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(h.generateMorphResource=Mn.performanceNowTrimmed()-e),r.resource){g=r.resource,g.tryPrepareMorph();const e=this.morphKeyToSlideIds(a);g.isForwards=e.slideIdA.sid===i.sid&&e.slideIdA.cid===i.cid}}if(!g)return{fSuccess:!1};if(g.fallbackReasons.size>0)return{fSuccess:!1,metadata:{fallbackReasons:Array.from(g.fallbackReasons).join(", ")}};p=g,o.metadata=g.metadata}else{let e=[];if(!this.viewControllerInternals.transitionFactory.isTransitionDisabled(l,d)&&Object(Pi.f)(l,d)){let n=0;G.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n=Mn.performanceNowTrimmed());const r={incomingSlideBackground:this.renderToTexture(t,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!0),correlationId:u,isContentTransition:!0}),outgoingSlideBackground:this.renderToTexture(i,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!0),correlationId:u,isContentTransition:!0}),incomingSlideForeground:this.renderToTexture(t,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:y.d.Transparent,correlationId:u,isContentTransition:!0}),outgoingSlideForeground:this.renderToTexture(i,{renderFilter:Mn.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:y.d.Transparent,correlationId:u,isContentTransition:!0})};G.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(h.renderTransitionTextures=Mn.performanceNowTrimmed()-n),f.incomingSlideBackground=r.incomingSlideBackground?r.incomingSlideBackground.tryGetWebGLTexture():void 0,f.outgoingSlideBackground=r.outgoingSlideBackground?r.outgoingSlideBackground.tryGetWebGLTexture():void 0,f.incomingSlideForeground=r.incomingSlideForeground?r.incomingSlideForeground.tryGetWebGLTexture():void 0,f.outgoingSlideForeground=r.outgoingSlideForeground?r.outgoingSlideForeground.tryGetWebGLTexture():void 0,e=Object.values(r)}else{let n=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(n=Mn.performanceNowTrimmed());const r={incomingSlideBackground:this.renderToTexture(t,{correlationId:u}),outgoingSlideBackground:this.renderToTexture(i,{correlationId:u})};G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h.renderToTexture=Mn.performanceNowTrimmed()-n),f.incomingSlideBackground=r.incomingSlideBackground?r.incomingSlideBackground.tryGetWebGLTexture():void 0,f.outgoingSlideBackground=r.outgoingSlideBackground?r.outgoingSlideBackground.tryGetWebGLTexture():void 0,e=Object.values(r)}const n=new m.f(this.canvas.width,this.canvas.height);this.setRenderingScenario(1);const r=new Pi.c(f);let a=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(a=Mn.performanceNowTrimmed());const s=await this.viewControllerInternals.transitionFactory.getTransition(l,d,r,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport);if(G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h.transitionFactoryMS=Mn.performanceNowTrimmed()-a),!s.transition)return o.isSupported=!1,o;_=s.isSupported,p=s.transition,b=()=>{const t=this.gl;if(t&&!t.isContextLost()){for(const t of e)t&&(this.viewController.viewDataManager.memoryStats.transitionTextures-=n.x*n.y*4,t.release());p.dispose()}},w=()=>{this.setRenderingScenario(1)}}return this.viewControllerInternals.transitionController=new En(p,c,n,w,b),o.fSuccess=!0,o.isSupported=_,G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o.metadata||(o.metadata={}),o.metadata.rendererEnvironment=h),o}enableVerboseRenderLogging(e){this.renderer.enableVerboseRenderLogging(e)}getPixelScale(e){const t=this.clientSize.x/e.x,i=this.clientSize.y/e.y;return new m.f(t,i).scale(window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale)}setupWebGLContext(){this.canvas.addEventListener("webglcontextcreationerror",e=>this.logContextCreationError(e));const e={failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0},t={failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0};let i=[{contextId:"webgl",options:e},{contextId:"experimental-webgl",options:e},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t}];F.a.readBooleanOrDefault("webgl2Enabled",!1)&&(i=[{contextId:"webgl2",options:e},{contextId:"webgl",options:e},{contextId:"experimental-webgl",options:e},{contextId:"webgl2",options:t},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t}]);for(const e of i)if(this.gl=this.canvas.getContext(e.contextId,e.options)||void 0,this.gl){const i="webgl2"===e.contextId?"WebGL2":"WebGL",n=e.options===t;Mn.s_rendererTech=i;let r=!1;const a=this.gl.getExtension("WEBGL_debug_renderer_info");if(a){const e=this.gl.getParameter(a.UNMASKED_RENDERER_WEBGL).toLowerCase();r=F.a.readStringOrDefault("badGpuList","").toLowerCase().indexOf(e)>=0}Mn.s_isBadGpu=r,g.a.sendTraceTag(561639882,_.a.msoulscat_Wac_PptSession,S.a.Info,"WebGL initialized "+JSON.stringify({rendererTech:i,isBadGpu:r,fPerfCaveat:n})),n&&(Mn.s_gpuHardwareDisabled=!0,g.a.sendTraceTag(520897678,_.a.msoulscat_Wac_PptSession,S.a.Info,"WebGL initialized with gpu hardware disabled"));break}if(!this.gl)return g.a.sendTraceTag(561639883,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unable to initialize WebGL"),void J.e.recordVeto("SetupWebGLContextFailed",{msg:Mi.SetupWebGLContextFailed});xn.gl=this.gl,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}logContextCreationError(e){g.a.sendTraceTag(555018370,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unable to initialize WebGL - "+(e.statusMessage||"Unknown error"))}lostContextHandler(e){e.preventDefault(),g.a.sendTraceTag(561639884,_.a.msoulscat_Wac_PptSession,S.a.Warning,`WebGL context lost. CurrentSceneCount:${this.viewControllerInternals.currentSceneCount}, MaxSceneCount:${this.viewControllerInternals.forwardSceneCount+this.viewControllerInternals.backwardSceneCount+1},\n        CurrentRenderedSlideId:${JSON.stringify(this.viewControllerInternals.currentRenderedSlideId)}, SlideSize:${JSON.stringify(this.viewController.slideSizeEmus)},\n        CanvasWidth:${this.canvas.width}, CanvasHeight:${this.canvas.height},\n        CanvasSizeWidth:${this.clientSize.x}, CanvasSizeHeight:${this.clientSize.y},\n        DPI:${window.devicePixelRatio}, ImageTextureMapSize:${this.viewController.viewDataManager.imageDataMap.size},\n        MemoryStats:${JSON.stringify(this.viewController.viewDataManager.memoryStats)}`),F.a.readBooleanOrDefault("deleteStateObjectOnContextLostWorkaround",!1)&&this.gl&&(Object(Tn.i)(this.gl),g.a.sendTraceTag(561639885,_.a.msoulscat_Wac_PptSession,S.a.Warning,"lostContextHandler: called deleteStateObject")),this.viewController.viewDataManager.imageDataMap.forEach((e,t)=>{g.a.sendTraceTag(561639885,_.a.msoulscat_Wac_PptSession,S.a.Warning,`WebGL context lost. imageDataMap Key:${t} Size:${JSON.stringify(e.size)} SlideIds:${JSON.stringify(e.loadedSlideIDs)} Memory:${e.size.x*e.size.y*4}`)});const t=this.viewControllerInternals.slideSceneView.filter(e=>e.scene).map(e=>e.scene),i=this.viewControllerInternals.morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource.morph);g.a.sendTraceTag(561639886,_.a.msoulscat_Wac_PptSession,S.a.Warning,"WebGL context lost. SB Scene Memory:"+JSON.stringify(this.generateTextureMemoryReport(t,i))),this.m_webGLContextLostStartTime=new Date,this.m_isSBRendererReady=!1,this.renderer.onWebGLContextLost(),this.releaseResources(),this.viewController.events.emit("webglcontextlost"),G.ChangeGate.isChangeGateEnabled("SSC.WebGLContextRestoreLogging")&&g.a.sendTraceTag(505943490,_.a.msoulscat_Wac_PptSession,S.a.Warning,`Wait for webgl restore. DocumentVisibility:${document.visibilityState}, webGLContextRestoreStartTime:${this.m_webGLContextRestoreStartTime}, webGLContextLostStartTime:${this.m_webGLContextLostStartTime}`),"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)&&(this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{g.a.sendTraceTag(561639887,_.a.msoulscat_Wac_PptSession,S.a.Error,"webglcontextrestored not raised after 3 seconds"),document.removeEventListener("visibilitychange",this.onVisibilityChange),this.viewController.events.emit("restoreWebGLContextFailed")},F.a.readNumberOrDefault("webGLContextRestoredTimeout",3e3))),document.addEventListener("visibilitychange",this.onVisibilityChange)}renderToTexture(e,t){if(!this.gl)return;const i=new m.f(this.canvas.width,this.canvas.height);$.verifyTextureSize(this.viewController,"transition",i);const n=new O.b("Transition",this.renderer,i,O.e.KeepUntilRelease);if(!n.tryGetWebGLTexture())return;this.viewController.viewDataManager.memoryStats.transitionTextures+=this.canvas.width*this.canvas.height*4,g.a.sendTraceTag(561639888,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::renderToTexture - SlideId: "+e.sid);const r={zoomLevel:F.a.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},a=!F.a.readBooleanOrDefault("saveVerifyGlyphForTransition",!1),s=this.viewController.renderSlideByIdExtended(e,!0,n,t&&t.renderFilter,t&&t.backgroundColor,a,!1,r);return g.a.sendTraceTag(507650462,_.a.msoulscat_Wac_PptSession,S.a.Warning,""+JSON.stringify({...s,correlationId:t&&t.correlationId,isContentTransition:t&&t.isContentTransition})),n}slideIdsToMorphKey(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?`${JSON.stringify(e)}_${JSON.stringify(t)}`:`${JSON.stringify(t)}_${JSON.stringify(e)}`}morphKeyToSlideIds(e){const t=e.split("_");return{slideIdA:JSON.parse(t[0]),slideIdB:JSON.parse(t[1])}}async contextRestoredHandler(){this.m_webGLContextRestoreStartTime=new Date;const e=this.m_webGLContextLostStartTime?this.m_webGLContextRestoreStartTime.getTime()-this.m_webGLContextLostStartTime.getTime():-1;if(g.a.sendTraceTag(561639889,_.a.msoulscat_Wac_PptSession,S.a.Info,`WebGL context restored in ${e}ms`),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0,document.removeEventListener("visibilitychange",this.onVisibilityChange),this.setupWebGLContext(),this.gl){if(await this.preloadShadersAsync(this.gl),this.viewControllerInternals.currentRenderedSlideId){const e=this.viewControllerInternals.slideSceneView.find(e=>e.slideId.sid===this.viewControllerInternals.currentRenderedSlideId.sid);if(e){const t=await this.viewControllerInternals.createImageTextureMapData(e);t.hasOwnProperty("invalidImageIds")&&(g.a.sendTraceTag(561639890,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::contextRestoredHandler - "+JSON.stringify(t)),J.e.recordVeto("ACE",t));const i=await e.slideViewElement.ensure();(i.hasOwnProperty("invalidShapeIds")||i.hasOwnProperty("missingTextureIds")||i.hasOwnProperty("errorName"))&&(g.a.sendTraceTag(561639891,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::contextRestoredHandler - "+JSON.stringify(i)),J.e.recordVeto("ACE",i),i.hasOwnProperty("errorName")&&this.viewController.events.emit("restoreWebGLContextFailed"));const n={zoomLevel:F.a.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}};this.viewController.renderSlideById(this.viewControllerInternals.currentRenderedSlideId,n)}}this.viewController.events.emit("webglcontextrestored")}}createImageFromTexture(e,t){const i=this.gl;if(!i||!this.isGLContextValid)return void console.log("createImageFromTexture: gl invalid");let n,r,a;e instanceof O.c?(n=e.tryGetWebGLTexture(),r=e.size.x,a=e.size.y):(n=e.texture,r=e.size.x,a=e.size.y);const s=i.createFramebuffer(),o=i.getParameter(i.FRAMEBUFFER_BINDING);i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0);const l=new Uint8Array(r*a*4);function d(){const e=document.createElement("canvas");G.ChangeGate.isChangeGateEnabled("SVM.CanvasAriaHidden")&&e.setAttribute("aria-hidden","true"),e.width=r,e.height=a;const t=e.getContext("2d");return{canvas:e,context:t}}i.readPixels(0,0,r,a,i.RGBA,i.UNSIGNED_BYTE,l),i.bindFramebuffer(i.FRAMEBUFFER,o),i.deleteFramebuffer(s);const c=d(),{canvas:h,context:u}=d();if(!u||!c.context)return void console.log("createImageFromTexture: cannot create 2D context");const m=c.context.createImageData(r,a);m.data.set(l),c.context.putImageData(m,0,0),u.translate(0,a),u.scale(1,-1),u.drawImage(c.canvas,0,0);const f=h.toDataURL();if(t&&t.fNewWindow){const e=window.open();if(e){const t=new Image;t.src=f,e.document.write(t.outerHTML)}}return f}constructor(){this.supportsTransitions=!0,this.supportsGif=!0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,this.m_tech="WebGL",this.m_isSBRendererReady=!1,this.onVisibilityChange=()=>{this.m_webGLContextLostStartTime&&"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)?this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{g.a.sendTraceTag(561639887,_.a.msoulscat_Wac_PptSession,S.a.Error,"webglcontextrestored not raised after 3 seconds"),document.removeEventListener("visibilitychange",this.onVisibilityChange),this.viewController.events.emit("restoreWebGLContextFailed")},F.a.readNumberOrDefault("webGLContextRestoredTimeout",3e3)):"hidden"===document.visibilityState&&(g.a.sendTraceTag(509723856,_.a.msoulscat_Wac_PptSession,S.a.Info,"Clearing the restore WebGL timeout as visibility is lost"),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0)},g.a.sendTraceTag(561639874,_.a.msoulscat_Wac_PptSession,S.a.Info,"creating WebGLRendererEnvironment"),console.log("creating WebGLRendererEnvironment");let e=void 0;e=new Cn(this),F.a.readBooleanOrDefault("hackStateRestorerOn",!1)&&(e=fn(!1)),this.renderer=dn({stateRestorer:e,morphPlayer:gn(),debugStringProvider:_n()}),xn.createImageFromTexture=this.createImageFromTexture.bind(this)}}class Pn{dispose(){this.m_tooltipElem&&this.m_container.removeChild(this.m_tooltipElem),document.removeEventListener("keydown",this.handleDocumentKeyDown)}constructor(e){this.m_tooltipTimer=0,this.handleDocumentKeyDown=e=>{e&&e.ctrlKey&&this.hideTooltip()},this.clearTooltipTimer=()=>{0!==this.m_tooltipTimer&&window.clearTimeout(this.m_tooltipTimer),this.m_tooltipTimer=0},this.showTooltip=(e,t,i)=>{if(!this.m_tooltipElem)return;if(!e)return void this.hideTooltip();this.m_tooltipElem.innerText=e,this.m_tooltipElem.style.display="block";let n=i-this.m_tooltipElem.offsetHeight-Pn.TooltipVerticalOffset;n<this.m_container.offsetTop&&(n=Math.min(i+Pn.TooltipVerticalOffset,this.m_container.offsetTop+this.m_container.offsetHeight-this.m_tooltipElem.offsetHeight)),n=Math.max(n,this.m_container.offsetTop);let r=Math.min(t,this.m_container.offsetLeft+this.m_container.offsetWidth-this.m_tooltipElem.offsetWidth-Pn.TooltipHorizontalBuffer);r=Math.max(r,this.m_container.offsetLeft),this.m_tooltipElem.style.left=r+"px",this.m_tooltipElem.style.top=n+"px",this.clearTooltipTimer()},this.hideTooltip=()=>{this.m_tooltipElem&&(this.m_tooltipElem.innerText="",this.m_tooltipElem.style.display="none",this.m_tooltipElem.style.left="0",this.m_tooltipElem.style.top="0",this.clearTooltipTimer())},this.hideTooltipAfterDelay=()=>{this.m_tooltipTimer=window.setTimeout(this.hideTooltip,Pn.TooltipHideDelayMs)},this.m_container=e,this.m_tooltipElem=document.createElement("div"),this.m_tooltipElem.className=Pn.TooltipClassName,this.m_tooltipElem.setAttribute("aria-hidden","true"),this.m_tooltipElem.addEventListener("mouseenter",this.clearTooltipTimer),this.m_tooltipElem.addEventListener("mouseleave",this.hideTooltipAfterDelay),this.m_container.appendChild(this.m_tooltipElem),document.addEventListener("keydown",this.handleDocumentKeyDown)}}Pn.TooltipClassName="slideshowcore-tooltip",Pn.TooltipVerticalOffset=20,Pn.TooltipHorizontalBuffer=4,Pn.TooltipHideDelayMs=200,function(e){e[e.Start=1]="Start",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed"}(Sn||(Sn={})),function(e){e[e.None=0]="None",e[e.Local=1]="Local",e[e.All=2]="All"}(vn||(vn={}));class En{get transition(){return this.m_transition}get duration(){return this.m_duration}get clock(){return this.m_clock}render(e){const t=Math.max(0,Math.min(1,e/this.m_duration)),i=this.m_fForwards?t:1-t;try{this.m_onDraw();const e=this.m_transition.draw(i);if(F.a.readBooleanOrDefault("enableEndTransitionOnFailedDraw",!1)&&!e)return g.a.sendTraceTag(505991808,_.a.msoulscat_Wac_PptSession,S.a.Warning,"Ending Transition due to failed draw"),!1}catch(e){return g.a.sendTraceTag(507004106,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected exception in m_transition.draw: "+e),!1}return e<this.m_duration}constructor(e,t,i,n,r){this.m_transition=e,this.m_duration=t,this.m_fForwards=i,this.m_onDraw=n,this.onDispose=r,this.m_clock=new v.d,this.m_clock.start(0)}}let xn={};function kn(e){e.logger&&(g.a.setLogger(e.logger),Object(v.g)(e.logger),Object(E.I)(e.logger)),e.settings&&(F.a.load(e.settings?e.settings.slideshowcore:{}),Object(E.K)(e.settings?e.settings.shapebuilder:{})),e.disabledChangeGates&&G.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=xn),Object(v.l)(e),F.a.readBooleanOrDefault("useShapeBuilderUlsLogger",!1)&&Object(E.I)(U.getInstance())}class Mn{static get s_isGlyphCacheDisabled(){return Mn.s_glyphCacheFailedCount>1}getTooltip(){return this.m_liteTooltip}async dispose(){var e;g.a.sendTraceTag(507004104,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::dispose - Disposing rendererEnvironment and removing the elements from the dom tree"),Mn.s_preloadedRendererEnvironment=void 0,this.m_container.removeChild(this.m_inScreenCoordsContainer),this.m_container.removeChild(this.m_accessibilityLiveRegionContainer),this.m_container.contains(this.m_crossSlideAudioContainer)&&this.m_container.removeChild(this.m_crossSlideAudioContainer),this.cleanUpAccessibilityContainer(),this.m_container.removeChild(this.m_slideLevelHtmlElementsParentContainer),this.m_clickTargetsReferenceDiv&&this.m_container.removeChild(this.m_clickTargetsReferenceDiv),this.m_notesPaneParagraphReaderContainer&&this.m_container.removeChild(this.m_notesPaneParagraphReaderContainer),this.m_preActivedAddinsContainer&&this.m_container.removeChild(this.m_preActivedAddinsContainer),G.ChangeGate.isChangeGateEnabled("SVM.CustomTooltipForLink")&&(null===(e=this.m_liteTooltip)||void 0===e||e.dispose()),F.a.readBooleanOrDefault("enableFailTextureLoadOnContextLost",!1)&&this.events.off("webglcontextlost",this.onContextLost),this.rendererEnvironment.removeCanvas(this.m_container),xn={}}static ensureRendererEnvironment(e){Mn.s_preloadedRendererEnvironment||(Mn.s_preloadedRendererEnvironment=F.a.readBooleanOrDefault("forceSvg",!1)?new cn:F.a.readBooleanOrDefault("useNewWebGLRendererEnvironment",!1)?new Li(e||new wn):new In)}async init(){this.rendererEnvironment.glContext&&await Mn.preloadShaders(this.rendererEnvironment.glContext),this.isChromeFocusAccessibilityEnabled()&&this.m_container.addEventListener("focus",()=>this.updateAccessibilityTag())}isChromeFocusAccessibilityEnabled(){const e=navigator.userAgent.toLowerCase(),t=this.settings.uiHost&&this.settings.uiHost.toLowerCase().search("unified app")>=0;return!!(e.search("edg/")<0&&e.search("chrome/")>=0&&t)}slideIdsToMorphKey(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?`${JSON.stringify(e)}_${JSON.stringify(t)}`:`${JSON.stringify(t)}_${JSON.stringify(e)}`}async morphLoader(e,t){if(!t||!t.meta_prevSlideId||!t.meta_nextSlideId)return g.a.sendTraceTag(507004103,_.a.msoulscat_Wac_PptSession,S.a.Error,"morphLoader: options missing."),{resourceId:e,metadata:{errorName:"missingOptions"}};const i=(await this.viewDataManager.getSlideViewData(t.meta_nextSlideId)).resource;if(!i||!i.transData||!i.transData.morph)return g.a.sendTraceTag(507004102,_.a.msoulscat_Wac_PptSession,i?S.a.Info:S.a.Warning,`morphLoader: morph data missing. id:${e}, slideViewData exists:${!!i}, transdata exists:${i&&!!i.transData}`),{resourceId:e,metadata:{errorName:"missingSlideData"}};const n=this.getSlideViewElement(t.meta_prevSlideId),r=this.getSlideViewElement(t.meta_nextSlideId);return n&&r?{resourceId:e,resource:new ki(this,i.transData.morph,i.transData.type,i.transData.dir,n,r),metadata:{}}:(g.a.sendTraceTag(507004101,_.a.msoulscat_Wac_PptSession,S.a.Error,`morphLoader: slidePrev exists:${!!n} slideNext exists:${!!r}.`),{resourceId:e,metadata:{errorName:"missingSlideViewElement"}})}async ensureSlideViewElement(e){g.a.sendTraceTag(507004100,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::ensureSlideViewElement - slideId:"+e.id.sid);const t={};t.getSlideViewData={start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()};const i=await this.viewDataManager.getSlideViewData(e.id);if(t.getSlideViewData.end=Mn.performanceNowTrimmed(),!i.resource)return g.a.sendTraceTag(507004099,_.a.msoulscat_Wac_PptSession,S.a.Error,"ensureSlideViewElement: missing slideView data. id:"+e.id.sid),i.metadata.hasOwnProperty("errorName")&&(t.errorName=i.metadata.errorName),t;g.a.sendTraceTag(507004098,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::ensureSlideViewElement - slideSceneViews: "+JSON.stringify(this.m_slideSceneView.map(e=>e.slideId.sid)));let n=this.m_slideSceneView.find(t=>t.slideId.sid===e.id.sid);return n?(g.a.sendTraceTag(507004096,_.a.msoulscat_Wac_PptSession,S.a.Info,`ViewController::ensureSlideViewElement - slideSceneView already exists for slide ${e.id.sid} sceneExists:${!!n.scene}`),n.scene&&this.deleteScene(n),n.slideId=e.id,n.slideViewElement=new Ii(e,i.resource.slideSizePixels,this)):(n={slideId:e.id,slideViewElement:new Ii(e,i.resource.slideSizePixels,this),lastRenderedTimeMs:Number.NEGATIVE_INFINITY},this.m_slideSceneView.push(n),g.a.sendTraceTag(507004097,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::ensureSlideViewElement - Created new slideSceneView for slide "+e.id.sid)),this.viewDataManager.slideMetadataMap.set(e.id.sid,{slideId:e.id,isHidden:e.hidden}),g.a.sendTraceTag(507004067,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::ensureSlideViewElement - Current SlideMetadataMap:"+JSON.stringify(Array.from(this.viewDataManager.slideMetadataMap))),t}async ensureTextureLoaded(e,t){g.a.sendTraceTag(507004066,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::ensureTextureLoaded - slideId:"+e.sid);const i=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!i)return g.a.sendTraceTag(507004065,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewController::ensureTextureLoaded - missing scene view. slideId:"+e.sid),{errorName:Mi.MissingSceneView};if(i.slideViewElement.fImageTextureLoaded)return g.a.sendTraceTag(507004064,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::ensureTextureLoaded - Texture already loaded for slide:"+e.sid),{};const n={createTexture:{start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()}};try{i.slideViewElement.fImageTextureLoading=!0;const e=await this.createImageTextureMapData(i);n.createTexture.end=Mn.performanceNowTrimmed();const r=await i.slideViewElement.ensure(t);return{...n,...e,...r}}catch(e){return g.a.sendTraceTag(507004063,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected exception in ensureTextureLoaded: "+e),{errorName:Mi.TexturesNotLoaded}}}getSlideViewElement(e){const t=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);return t?t.slideViewElement:null}onResize(){this.m_captionsRenderer&&this.m_captionsRenderer.onResize()}get getCaptionsRenderer(){return this.m_captionsRenderer||(this.m_captionsRenderer=new gt(this.m_container.id,this.m_inScreenCoordsContainer),this.m_captionsRenderer.setDefaultLang=Mn.accessibilityLanguage),this.m_captionsRenderer}static performanceNowTrimmed(){return Math.round(performance.now())}static trimTo100th(e){return Math.round(1e3*e)/1e3}renderSlideAnimationFrameById(e,t){return this.renderSlideByIdExtended(e,!1,void 0,void 0,void 0,!1,!1,t)}renderSlideByIdCollectingPerfData(e,t,i){return this.renderSlideByIdExtended(e,!0,void 0,void 0,void 0,!0,!(!i||!i.isBoot)&&i.isBoot,t,i)}renderSlideById(e,t){return this.renderSlideByIdExtended(e,!1,void 0,void 0,void 0,!0,!1,t)}renderSlideByIdExtended(e,t,i,n,r,a,s,o,l){const d=this.rendererEnvironment.clientSize,c={CanvasWidth:d.x*window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,CanvasHeight:d.y*window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,DevicePixelRatio:window.devicePixelRatio,devicePixelsToRenderedPixelsScale:this.rendererEnvironment.devicePixelsToRenderedPixelsScale,render:{start:Mn.performanceNowTrimmed(),end:Mn.performanceNowTrimmed()}};a&&g.a.sendTraceTag(507004062,_.a.msoulscat_Wac_PptSession,S.a.Info,"renderSlideById slide:"+e.sid),s&&this.rendererEnvironment.glContext&&this.events.emit("renderingStageChanged","FlushingShaders");const h=Mn.performanceNowTrimmed();c.shaders=Mn.performanceNowTrimmed()-h,c.additionalPerfMeta={};const u=Mn.performanceNowTrimmed(),f=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!f||!this.rendererEnvironment.isGLContextValid||!this.rendererEnvironment.isSBValid){const t=`ViewController::renderSlideById - Cannot render slide:${e.sid} SceneView:${!!f} WebGlContext:${this.rendererEnvironment.isGLContextValid} SBReady:${this.rendererEnvironment.isSBValid}`;return g.a.sendTraceTag(507004061,_.a.msoulscat_Wac_PptSession,S.a.Error,t),this.settings.stringifyError&&g.a.sendTraceTag(507004060,_.a.msoulscat_Wac_PptSession,S.a.Error,this.settings.stringifyError(new Error(t))),{...c,errorName:this.rendererEnvironment.isGLContextValid?this.rendererEnvironment.isSBValid?Mi.FailedToRenderMissingSceneView:Mi.FailedToRenderSBNotReady:Mi.FailedToRenderContextLost}}if(!f.slideViewElement.fImageTextureLoaded)return g.a.sendTraceTag(507004059,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::renderSlideById - tried to render a slide without loading textures:"+e.sid),{...c,errorName:Mi.TexturesNotLoaded};if(!f.scene){const e=F.a.readBooleanOrDefault("ignoreSceneBeingRendered",!1)?[f.slideId]:[];for(;this.m_currentSceneCount>=this.m_forwardSceneCount+this.m_backwardSceneCount+1&&this.deleteOldestScene(e););f.scene=this.createNewScene(),f.slideViewElement.fImageTextureLoading=!1,f.slideViewElement.addToScene(f.scene)}if(c.additionalPerfMeta.sceneView=Mn.performanceNowTrimmed()-u,c.fPrepared=f.slideViewElement.fPrepared,null!=l&&l.id){this.m_renderStateSnapshot.preRendered=f.slideViewElement.fPrepared,this.m_renderStateSnapshot.prerenWindRange=l&&l.prefetchWindowRange,this.m_renderStateSnapshot.navSlideIndex=l&&l.slideIndex,this.m_renderStateSnapshot.id=l&&l.id,this.m_renderStateSnapshot.step=l&&l.step,this.m_renderStateSnapshot.navType=l&&l.navType,this.m_renderStateSnapshot.navInitTime=l&&l.navInitTimestamp;const e=Mn.performanceNowTrimmed();this.logSlideRenderSnapshot(),g.a.sendTraceTag(507004058,_.a.msoulscat_Wac_PptSlideshow,S.a.Warning,"ViewController::renderSlideByIdExtended: Render Snapshot LogTime: "+(Mn.performanceNowTrimmed()-e))}const p=f.slideViewElement.slideSizePixels;this.showUnderlaysAndOverlays(JSON.stringify(e)),this.showHideCrossSlideAudios(JSON.stringify(e)),f.slideViewElement.updateShapeViewElements(),f.lastRenderedTimeMs=Date.now();const v=d.x/p.x,y=d.y/p.y,T=Math.min(v,y),b=Mn.performanceNowTrimmed();this.applyResizeTransform(this.m_slideLevelHtmlElementsParentContainer,T,p,!0,o,!0),c.additionalPerfMeta.resizeTransformation=Mn.performanceNowTrimmed()-b;const w=Mn.performanceNowTrimmed();H(d,p,this.slideSizeEmus,this.stringifyError),c.additionalPerfMeta.setShapeBuilderGlobals=Mn.performanceNowTrimmed()-w;const C=F.a.readNumberOrDefault("bootRenderTimeoutMs",-1);if(this.rendererEnvironment.glContext&&s&&!f.slideViewElement.fPrepared&&C>0){this.events.emit("renderingStageChanged","PreparingSBItems");const e=f.slideViewElement.tryPrepareAllAtOnce(C);if(g.a.sendTraceTag(507004057,_.a.msoulscat_Wac_PptSession,e?S.a.Info:S.a.Error,JSON.stringify({prepareSucceeded:e})),!e&&F.a.readBooleanOrDefault("renderTimeoutReturnEarly",!1))return c.errorName=Mi.TryPrepareTimeout,c}s&&this.events.emit("renderingStageChanged","RenderingSlide"),(s||F.a.readBooleanOrDefault("hackEnableVerboseRenderLogging",!1))&&this.rendererEnvironment.enableVerboseRenderLogging(!0);const I=Mn.performanceNowTrimmed();let P=this.rendererEnvironment.calculateRenderTransform(p);if(c.additionalPerfMeta.renderTransform=Mn.performanceNowTrimmed()-I,F.a.readBooleanOrDefault("enableOpticalZoom",!1)){const e=o.zoomLevel*P.scale.x,t=new m.f(o.canvasCenterSlidePointPercent.x*e*p.x,o.canvasCenterSlidePointPercent.y*e*p.y),i=Mn.performanceNowTrimmed();P=this.rendererEnvironment.calculateRenderTransformWithZoom(new m.f(p.x,p.y),e,t),c.additionalPerfMeta.renderTransformZoom=Mn.performanceNowTrimmed()-i}G.ChangeGate.isChangeGateEnabled("SVM.ResetDirtyRectOnOpticalZoomChange")&&(!this.m_lastRenderedOpticalZoomState||this.m_lastRenderedOpticalZoomState.zoomLevel===o.zoomLevel&&this.m_lastRenderedOpticalZoomState.canvasCenterSlidePointPercent.x===o.canvasCenterSlidePointPercent.x&&this.m_lastRenderedOpticalZoomState.canvasCenterSlidePointPercent.y===o.canvasCenterSlidePointPercent.y||(this.m_lastRenderRectMap=void 0),this.m_lastRenderedOpticalZoomState=o),this.m_currentRenderedSlideId=e;const E={filter:n,target:i,transform:P};U.s_isRenderingAnimationFrame=!a;const x=Mn.performanceNowTrimmed();if(F.a.readBooleanOrDefault("enableDirtyRectTracking",!1)&&this.rendererEnvironment.glContext){const e={enableDirtyRect:!0,previousRenderRectMap:this.m_lastRenderRectMap};this.rendererEnvironment.renderer.render(f.scene,r,E,e),this.m_lastRenderRectMap=this.rendererEnvironment.renderer.getLastRenderRectMap()}else this.rendererEnvironment.renderer.render(f.scene,r,E);c.additionalPerfMeta.shapeBuilderRender=Mn.performanceNowTrimmed()-x,U.s_isRenderingAnimationFrame=!1,xn.lastRenderedScene=f.scene,this.rendererEnvironment.enableVerboseRenderLogging(!1);const k=this.viewDataManager.slideIdOrder.findIndex(t=>t.sid===e.sid&&t.cid===e.cid);let M=!1;this.isChromeFocusAccessibilityEnabled()&&(this.m_container.contains(document.activeElement)||(M=!0)),M||f.slideViewElement.updateAccessibilityTag(k,e,this.m_slideLevelHtmlElementsParentContainer);const A=Mn.getElementFromCollection(this.m_inScreenCoordsContainer.children,Mn.BlankSlideDivId);A&&this.m_inScreenCoordsContainer.removeChild(A),c.render.end=Mn.performanceNowTrimmed(),G.ChangeGate.isChangeGateEnabled("SlideshowRenderedVerifyGlyphStartEventRaiseEnabled")&&s&&(this.events.emit("verifyGlyphStart"),g.a.sendTraceTag(507004056,_.a.msoulscat_Wac_PptSession,S.a.Info,`ViewController::renderSlideByIdExtended: ${performance.now()}, verifyGlyphStartEvent raised`));const R=F.a.readBooleanOrDefault("enableTriangleTest",!1);if(a||this.m_fCheckGlyphCacheOnNextRender){const t=this.m_fCheckGlyphCacheOnNextRender;this.m_fCheckGlyphCacheOnNextRender=!1;let i=Mn.performanceNowTrimmed();this.settings.flights&&this.settings.flights.verifyGlyphAsynchronously?G.ChangeGate.isChangeGateEnabled("EnableAsyncVerifyGlyphInvocation")&&setTimeout(()=>{i=Mn.performanceNowTrimmed(),this.rendererEnvironment.verifyGlyphCacheIntegrityAndTryRecover()?R&&setTimeout(()=>{this.runRenderFidelityTest(R,!1,t,e)},0):(c.render.end=Mn.performanceNowTrimmed(),g.a.sendTraceTag(553788171,_.a.msoulscat_Wac_PptSession,S.a.Error,"GlyphCacheIntegrity failed"),this.runRenderFidelityTest(R,!0,t,e),Mn.s_glyphCacheFailedCount+=1,this.m_fCheckGlyphCacheOnNextRender=!0,this.events.emit("glyphCacheFailed")),g.a.sendTraceTag(507004055,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewController::renderSlideByIdExtended: verifyGlyphs: "+(Mn.performanceNowTrimmed()-i))},0):(this.rendererEnvironment.verifyGlyphCacheIntegrityAndTryRecover()?R&&setTimeout(()=>{this.runRenderFidelityTest(R,!1,t,e)},0):(c.render.end=Mn.performanceNowTrimmed(),g.a.sendTraceTag(553788171,_.a.msoulscat_Wac_PptSession,S.a.Error,"GlyphCacheIntegrity failed"),this.runRenderFidelityTest(R,!0,t,e),Mn.s_glyphCacheFailedCount+=1,this.m_fCheckGlyphCacheOnNextRender=!0,this.events.emit("glyphCacheFailed")),c.verifyGlyphs=Mn.performanceNowTrimmed()-i)}if(t){c.slideWidth=p.x,c.slideHeight=p.y;const t=this.rendererEnvironment.getPerformanceSummary(),i=t&&t.perfInfoCurrentFrame;i&&(F.a.readBooleanOrDefault("addSbToNavLogs",!0)?c.sbMs={total:i.totalCostMs,dfSp:i.distanceFieldForShapeCostMs,dfTxt:i.distanceFieldForTextCostMs,dfGph:i.distanceFieldForGlyphTableCostMs,rnd:i.shapeRenderCostMs,tp:i.drawTapeCostMs,spCnt:i.shapeLayerCount,spCntTxt:i.shapeLayerCountText,pCntDf:i.pixelCountDistanceField,pCntSp:i.pixelCountShapeRender,spr:i.cacheToSpriteCostMs,tx:Mn.trimTo100th(i.fadeTextureCostMs+i.patternTextureCostMs+i.gradientTextureCostMs+i.pathGradientTextureCostMs),res:Mn.trimTo100th(i.glResetCostMs+i.glRestoreCostMs)}:c.SBTotalCost=i.totalCostMs);const n={slideId:e.sid,isBoot:s,isBadGPU:Mn.s_isBadGpu,SBCurrentFrameSummary:i,...c};g.a.sendTraceTag(507004054,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify(n)),g.a.sendTraceTag(507004053,_.a.msoulscat_Wac_PptSession,S.a.Warning,JSON.stringify(this.getGpuMemory()));try{Object.fromEntries&&g.a.sendTraceTag(507004052,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewController::renderSlideByIdExtended leaks: "+JSON.stringify(Object.fromEntries(this.checkForLeaksByScenario())))}catch(e){let t=e;e instanceof Error&&this.stringifyError&&(t=this.stringifyError(e)),g.a.sendTraceTag(507004051,_.a.msoulscat_Wac_PptSlideshow,S.a.Warning,"ViewController::renderSlideByIdExtended Exception calling fromEntries:"+t)}return c}}runRenderFidelityTest(e,t,i,n){const r=!!this.rendererEnvironment.isGLContextValid,a=e?this.rendererEnvironment.webGLRenderer&&this.rendererEnvironment.webGLRenderer.testRenderFidelity():void 0,s=t||i||a&&!a.fSucceeded,o=this.rendererEnvironment.webGLRenderer&&s?this.rendererEnvironment.webGLRenderer.getWebGLState():void 0;g.a.sendTraceTag(507004050,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify({glyphCacheFailed:t,isAfterGlyphCacheRecovery:i,sid:n.sid,glValid:r,enableTriangleTest:e,results:a,webGLState:o}))}getRelativeSlideIndex(e,t){return e-t}logSlideRenderSnapshot(){const e=(({slideRendMap:e,...t})=>t)(this.m_renderStateSnapshot);e.relSlideRendMap={};const t=this.m_renderStateSnapshot.navSlideIndex;if(t)for(const i in this.m_renderStateSnapshot.slideRendMap)e.relSlideRendMap[this.getRelativeSlideIndex(parseInt(i,10),t)]=this.m_renderStateSnapshot.slideRendMap[i];g.a.sendTraceTag(507004049,_.a.msoulscat_Wac_PptSession,S.a.Warning,JSON.stringify(e))}calculateCanvasCenterSlidePointPercentAfterZoom(e,t,i,n){const r=this.m_slideSceneView.find(e=>e.slideId.sid===i.sid);if(!r)return g.a.sendTraceTag(507004048,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewController::calculateCanvasCenterSlidePointPercentAfterZoom - missing scene view."),null;const a=new m.f(r.slideViewElement.slideSizePixels.x,r.slideViewElement.slideSizePixels.y),s=this.rendererEnvironment.clientSize,o=new m.f(n.canvasCenterSlidePointPercent.x,n.canvasCenterSlidePointPercent.y),l=this.rendererEnvironment.calculateRenderTransform(a).scale.x,d=n.zoomLevel*l,c=t*l,h=function(e,t,i,n,r,a,s){const o=Oi(r.scale(.5),i,n,a,s);return Di(Oi(e,Fi(e,o,n,a,s).scale(t/a),n,t,s),n,r,a,s,t)}(e,c,o.scale(d).multiply(a),a,s,d,F.a.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale);return Fi(s.scale(.5),h.translation,a,c,F.a.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale).divide(a.scale(c))}calculateCanvasCenterPointPercentAfterPan(e,t,i){const n=this.m_slideSceneView.find(e=>e.slideId.sid===t.sid);if(!n)return g.a.sendTraceTag(507004047,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewController::calculateCanvasCenterPointPercentAfterPan - missing scene view."),null;const r=new m.f(n.slideViewElement.slideSizePixels.x,n.slideViewElement.slideSizePixels.y),a=this.rendererEnvironment.clientSize,s=new m.f(i.canvasCenterSlidePointPercent.x,i.canvasCenterSlidePointPercent.y),o=this.rendererEnvironment.calculateRenderTransform(r).scale.x,l=i.zoomLevel*o,d=s.scale(l).multiply(r),c=function(e,t,i,n,r,a){return Di(Oi(n.scale(.5),t,i,r,a).add(e.scale(a)),i,n,r,a)}(new m.f(e.x,e.y),d,r,a,l,F.a.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale);return Fi(a.scale(.5),c.translation,r,l,F.a.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale).divide(r.scale(l))}getGpuMemory(){const e=performance.now(),t=this.m_slideSceneView.filter(e=>e.scene).map(e=>e.scene),i=this.m_morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource.morph),n=this.rendererEnvironment.generateTextureMemoryReport(t,i);let r=0;this.viewDataManager.imageDataMap.forEach((e,t)=>{r+=e.size.x*e.size.y*4});const a=(n?n.totalTargetExpected:0)+r+this.viewDataManager.memoryStats.cameoTextures+this.viewDataManager.memoryStats.gifTextures+this.viewDataManager.memoryStats.transitionTextures+this.viewDataManager.memoryStats.transitionsMemoryReport.buffers.count+this.viewDataManager.memoryStats.transitionsMemoryReport.textures.count+this.viewDataManager.memoryStats.videoTextures,s=this.rendererEnvironment.webGLRenderer?this.rendererEnvironment.webGLRenderer.fixedMemoryLeakAmounts:void 0;let o=0;for(const[e,t]of this.checkForLeaksByScenario())o+=t;return{gpuMemorySB:n,timeSpentCollecting:performance.now()-e,memoryStats:this.viewDataManager.memoryStats,images:r,total:a,leaksPrevented:s,leaks:o}}updateAccessibilityTag(){if(!this.m_currentRenderedSlideId||!this.m_slideSceneView)return void g.a.sendTraceTag(507004046,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::updateAccessibilityTag sceneView or slideId is null - slideId:"+this.m_currentRenderedSlideId);const e=this.m_currentRenderedSlideId,t=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!t)return void g.a.sendTraceTag(507004045,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::updateAccessibilityTag scene view is null - slideId:"+e.sid);const i=this.viewDataManager.slideIdOrder.findIndex(t=>t.sid===e.sid&&t.cid===e.cid);t.slideViewElement.updateAccessibilityTag(i,e,this.m_slideLevelHtmlElementsParentContainer)}updateAccessibilityContainersLanguage(e){""===e?(this.m_accessibilityLiveRegionContainer.removeAttribute("lang"),this.m_slideLevelHtmlElementsParentContainer.removeAttribute("lang")):this.m_slideLevelHtmlElementsParentContainer.lang=e}updateAccessibilityLanguage(e){e!==Mn.accessibilityLanguage&&(Mn.accessibilityLanguage=e,this.cleanUpAccessibilityContainer(),this.updateAccessibilityContainersLanguage(e),this.m_captionsRenderer&&(this.m_captionsRenderer.setDefaultLang=e))}preRenderSlideById(e,t){g.a.sendTraceTag(507004044,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::preRenderSlideById - slideId:"+e.sid);const i=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!i||!this.rendererEnvironment.isGLContextValid)return;if(i.scene)return void(i.slideViewElement.fImageTextureLoading=!1);for(;this.m_currentSceneCount>=this.m_forwardSceneCount+this.m_backwardSceneCount+1&&this.deleteOldestScene(););const n=()=>{H(this.rendererEnvironment.clientSize,i.slideViewElement.slideSizePixels,this.slideSizeEmus,this.stringifyError)};i.scene=this.createNewScene(),i.slideViewElement.fImageTextureLoading=!1,i.slideViewElement.addToScene(i.scene);const r=this.rendererEnvironment.glContext;if(F.a.readBooleanOrDefault("hackSkipPrerender",!1))return;let a,s;s=this.viewDataManager.getSlideIndex(e);const o=this.m_renderStateSnapshot.slideRendMap,l=o[s]||(o[s]={});l.sTime=Date.now(),l.state=Sn.Start,l.idx=s,this.tryPrepareUntilDoneAsync(()=>{if(!i.scene)return!0;n(),s=this.viewDataManager.getSlideIndex(e);const t=this.m_renderStateSnapshot.slideRendMap,r=t[s]||(t[s]={});return a=i.slideViewElement.tryPrepare(),r.eTime=Date.now(),r.state=a?Sn.Completed:Sn.Failed,a},F.a.readNumberOrDefault("maxRetriesPreparingSlide",1e4)).then(async()=>{if(!t||!this.settings.morphEnabled||!r||r.isContextLost())return;const i=this.m_slideSceneView.find(e=>e.slideId.sid===t.sid),a=this.slideIdsToMorphKey(t,e);if(!i||!i.scene||!a)return;const s=await this.m_morphCache.load(a,{meta_prevSlideId:t,meta_nextSlideId:e});if(g.a.sendTraceTag(507004043,_.a.msoulscat_Wac_PptSession,S.a.Info,JSON.stringify({morphExists:!(!s||!s.resource),morphResourceId:a})),s&&s.resource){const t=s.resource;this.tryPrepareUntilDoneAsync(()=>(n(),t.tryPrepareMorph(5)),F.a.readNumberOrDefault("maxRetriesPreparingSlide",1e4)).then(()=>{g.a.sendTraceTag(507004042,_.a.msoulscat_Wac_PptSession,S.a.Info,"Done preparing morph - slideId:"+e.sid)})}})}sendFrameToCameo(e,t){this.m_cameoTextureManager.processFrameForCameo(e,t)}clearCameo(){this.m_cameoTextureManager.releaseTexture()}setCameoVideoElement(e){this.m_cameoTextureManager.setVideoElement(e)}updateCameoTextureFromVideoElement(){this.m_cameoTextureManager.updateTextureFromVideoElement()}cleanUpAccessibilityContainer(){for(;this.m_slideLevelHtmlElementsParentContainer&&this.m_slideLevelHtmlElementsParentContainer.firstChild;)this.m_slideLevelHtmlElementsParentContainer.removeChild(this.m_slideLevelHtmlElementsParentContainer.firstChild);Ii.s_lastAccessibilityTagHash=""}async tryPrepareUntilDoneAsync(e,t){let i=t;for(;;){if(!this.rendererEnvironment.isGLContextValid||i<=0)return;if(this.isAnimating||this.isTransitioning||!this.rendererEnvironment.isSBValid)await Object(hn.d)(10);else{if(e())return;i-=1,await Object(hn.d)(10)}}}setMaxSceneCount(e,t){this.m_forwardSceneCount!==e&&(this.m_forwardSceneCount=e),this.m_backwardSceneCount!==t&&(this.m_backwardSceneCount=t)}deleteOldestScene(e){let t=-1,i=Number.POSITIVE_INFINITY,n=-1,r=Number.POSITIVE_INFINITY;const a=[];for(let s=0;s<this.m_slideSceneView.length;s+=1)this.m_currentRenderedSlideId&&this.m_currentRenderedSlideId.sid===this.m_slideSceneView[s].slideId.sid||!this.m_slideSceneView[s].scene||e&&e.find(e=>e.sid===this.m_slideSceneView[s].slideId.sid)||(a.push({index:s,sid:this.m_slideSceneView[s].slideId.sid,lastRenderedTimeMs:this.m_slideSceneView[s].lastRenderedTimeMs}),this.m_slideSceneView[s].lastRenderedTimeMs<i&&(t=s,i=this.m_slideSceneView[s].lastRenderedTimeMs),!this.isAdjacentSlide(this.m_slideSceneView[s].slideId)&&this.m_slideSceneView[s].lastRenderedTimeMs<r&&(n=s,r=this.m_slideSceneView[s].lastRenderedTimeMs));const s=!F.a.readBooleanOrDefault("disallowDeletingOldAdjacentScenes",!1),o=-1===n&&s?t:n;return g.a.sendTraceTag(507004041,_.a.msoulscat_Wac_PptSession,S.a.Info,"deleteOldestScene "+JSON.stringify({allowDeletingOldAdjacentScenes:s,slideToDeleteIndex:o,sceneList:a,scenesToIgnore:e})),-1!==o&&(this.deleteScene(this.m_slideSceneView[o]),!0)}isAdjacentSlide(e){if(!this.m_currentRenderedSlideId)return!1;if(F.a.readBooleanOrDefault("fixIsAdjacentSlide",!1)){const t=this.viewDataManager.getVisibleSlideIndexDifference(this.m_currentRenderedSlideId,e);return void 0!==t&&Math.abs(t)<=(t>0?this.m_forwardSceneCount:this.m_backwardSceneCount)}const t=this.viewDataManager.getVisibleSlideIndex(this.m_currentRenderedSlideId),i=this.viewDataManager.getVisibleSlideIndex(e);return-1!==t&&-1!==i&&t!==i&&Math.abs(t-i)<=(i>t?this.m_forwardSceneCount:this.m_backwardSceneCount)}deleteScene(e){if(!e.scene)return void g.a.sendTraceTag(507004040,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewController::deleteScene - slideSceneView doesn't contain a scene. SlideSID:"+e.slideId.sid);const t=this.viewDataManager.getSlideIndex(e.slideId);this.m_renderStateSnapshot.slideRendMap[t]&&delete this.m_renderStateSnapshot.slideRendMap[t];const i=new Set,n=this.m_slideSceneView.filter(e=>e.scene||e.slideViewElement.fImageTextureLoading).map(e=>e.slideId.sid),r=this.viewDataManager.imageDataMap.size;for(const[t,r]of this.viewDataManager.imageDataMap)if(F.a.readBooleanOrDefault("deleteMultiSlideTextures",!1)){if(!r.loadedSlideIDs.some(e=>n.some(t=>t===e.sid))){this.rendererEnvironment.releaseImageData(r),this.viewDataManager.imageDataMap.delete(t),i.add(t);for(const e of this.m_slideSceneView)r.loadedSlideIDs.some(t=>e.slideId.sid===t.sid)&&(e.slideViewElement.fImageTextureLoaded=!1)}}else 1===r.loadedSlideIDs.length&&r.loadedSlideIDs.find(t=>t.sid===e.slideId.sid)&&(this.rendererEnvironment.releaseImageData(r),this.viewDataManager.imageDataMap.delete(t),i.add(t));for(const e of i)this.viewDataManager.onExternalTextureReleased(e);const a=this.viewDataManager.imageDataMap.size;if(g.a.sendTraceTag(507004039,_.a.msoulscat_Wac_PptSession,S.a.Info,`ViewController::deleteScene - slideSceneViews: ${JSON.stringify(this.m_slideSceneView.map(e=>e.slideId.sid))} SlideSID:${e.slideId.sid} before: ${r} after:${a}`),g.a.sendTraceTag(507004038,_.a.msoulscat_Wac_PptSession,S.a.Info,`ViewController::deleteScene - SlideSID:${e.slideId.sid} keys deleted: [${[...i].join(",")}]`),e.slideViewElement.fImageTextureLoaded=!1,e.slideViewElement.removeFromScene(e.scene),e.scene.releaseGeneratedResources(),this.settings.morphEnabled){const t=this.m_morphCache.getAllLoadResultsInCache();for(const i of t)i.resourceId.indexOf(JSON.stringify(e.slideId))>0&&(i.resource&&(i.resource.dispose(),g.a.sendTraceTag(507004037,_.a.msoulscat_Wac_PptSession,S.a.Warning,`ViewController::deleteScene - cleared morph cache for resourceId:${i.resourceId} SlideSID:${e.slideId.sid}`)),this.m_morphCache.remove(i.resourceId))}e.slideViewElement.cleanUp(),e.slideViewElement.fPrepared=!1,e.scene=void 0,this.m_currentSceneCount-=1}calculateCanvasSize(e){const t=this.getBounds.getBoundingClientRectFromContainer(),i=t.width/(t.height?t.height:t.width);let n,r;return e.x/e.y<i?(r=Math.round(t.height),n=Math.round(r*e.x/e.y)):(n=Math.round(t.width),r=Math.round(n*e.y/e.x)),new m.f(n,r)}resizeViewContainer(e,t,i){this.m_container.style.display="flex",this.m_container.style.justifyContent="center",this.m_container.style.alignItems="center";const n=this.calculateCanvasSize(t),r=i&&i.canvasScale?i.canvasScale:1;this.rendererEnvironment.setCanvasSize(n,r);const a=this.rendererEnvironment.canvas,s=this.rendererEnvironment.clientSize,o=s.x/t.x,l=s.y/t.y,d=Math.min(o,l);this.applyResizeTransform(this.m_slideLevelHtmlElementsParentContainer,d,t,!0,e,!0),F.a.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_slideLevelHtmlElementsParentContainer.style.width=a.style.width,this.m_slideLevelHtmlElementsParentContainer.style.height=a.style.height),this.m_clickTargetsReferenceDiv&&this.applyResizeTransform(this.m_clickTargetsReferenceDiv,d,t,!1,e),this.m_inScreenCoordsContainer.style.width=a.style.width,this.m_inScreenCoordsContainer.style.height=a.style.height}applyResizeTransform(e,t,i,n,r,a){const s=(e,n)=>{if(e.id.indexOf(Mn.SlideLevelHtmlElementsDivId)>-1)for(const e of this.m_slideSceneView)e.slideViewElement.onSlideScaled(t);if(F.a.readBooleanOrDefault("enableOpticalZoom",!1)&&e!==this.m_clickTargetsReferenceDiv){const n=F.a.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,a=this.rendererEnvironment.clientSize.scale(.5),s=new m.f(i.x,i.y),o=new m.f(r.canvasCenterSlidePointPercent.x,r.canvasCenterSlidePointPercent.y),l=a.scale(1-r.zoomLevel),d=this.rendererEnvironment.calculateRenderTransform(s).scale.x*r.zoomLevel,c=s.scale(d),h=Oi(a,o.multiply(c),s,d,n).scale(1/n).subtract(a).add(l),u=t*r.zoomLevel;e.style.top="0",e.style.left="0",e.style.transform=`translateX(${h.x}px) translateY(${h.y}px) scale(${u},${u})`}else e.style.transform=`scale(${t},${t})`,e.style.top=this.rendererEnvironment.canvas.offsetTop+(this.rendererEnvironment.canvas.offsetWidth-this.rendererEnvironment.clientSize.x)/2+"px",e.style.left=this.rendererEnvironment.canvas.offsetLeft+(this.rendererEnvironment.canvas.offsetHeight-this.rendererEnvironment.clientSize.y)/2+"px";e.style.transformOrigin="top left",n||(e.style.width=i.x+"px",e.style.height=i.y+"px")};if(n){const t=e.childNodes;for(let e=0;e<t.length;e+=1){const i=t[e];a&&i.id.search(Mn.ShapeAccessibilityElementId)>=0||s(i,!0)}}else s(e,!1)}static createRenderBackgroundOrForegroundFilter(e){return t=>void 0===B(t).isBackground||B(t).isBackground===e}async createTransition(e,t,i,n){let r=0,a=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(r=Mn.performanceNowTrimmed());const s=await this.viewDataManager.getSlideViewData(i?e:t);G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(a=Mn.performanceNowTrimmed()-r),this.m_transitionController&&this.finishTransition();let o={fSuccess:!1},l=0,d=0;G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(l=Mn.performanceNowTrimmed());const c=s.resource;return c&&c.transData&&F.a.readBooleanOrDefault("hackTransitionsEnabled",!0)?o=await this.rendererEnvironment.createTransition(c.transData,e,t,i,c.slideSizePixels.x/c.slideSizePixels.y,!!this.settings.morphEnabled,n):o.metadata=s.metadata,G.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(d=Mn.performanceNowTrimmed()-l),this.hideUnderlaysAndOverlays(),o.metadata||(o.metadata={}),o.metadata.getSlideViewPerfInTransitionMS=a,o.metadata.rendererEnvironment||(o.metadata.rendererEnvironment={}),o.metadata.rendererEnvironment.TotalMS=d,o}renderBlankSlide(e,t,i){this.hideUnderlaysAndOverlays();const n=this.m_inScreenCoordsContainer,r=Mn.getElementFromCollection(n.children,Mn.BlankSlideDivId);r&&n.removeChild(r);const a=document.createElement("div");if(a.id=Mn.BlankSlideDivId,a.style.background=e,a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.pointerEvents="none",a.style.zIndex="3",t&&i){const e=document.createElement("div");e.style.textAlign="center",e.style.fontSize="120%",e.setAttribute("aria-live","assertive"),e.textContent=t,e.style.color=i,e.style.fontFamily="Segoe UI, sans-serif",a.appendChild(e)}return n.appendChild(a),a}static async preloadShaders(e,t){Mn.ensureRendererEnvironment(t?t.shapeBuilderCanvasContext:void 0),Mn.s_preloadedRendererEnvironment?await Mn.s_preloadedRendererEnvironment.preloadShadersAsync(e):g.a.sendTraceTag(507004036,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::preloadShaders - s_preloadedRendererEnvironment is null")}finishTransition(){this.m_transitionController&&(this.m_transitionController.clock.stop(),this.m_transitionController.onDispose(),this.m_transitionController=null)}getTransitionController(){return this.m_transitionController}getSlideDimensions(){if(this.rendererEnvironment.canvas)return new m.f(parseInt(this.rendererEnvironment.canvas.style.width,10),parseInt(this.rendererEnvironment.canvas.style.height,10))}getSlideViewBounds(){const e=this.rendererEnvironment.canvas;if(!e)return;const t=this.getBounds.getBoundingClientRectFromCanvas(),i={top:t.top,bottom:t.bottom,left:t.left,right:t.right};return i.top+=e.clientTop,i.bottom-=e.clientTop,i.left+=e.clientLeft,i.right-=e.clientLeft,i}hideUnderlaysAndOverlays(){Array.from(this.m_slideLevelHtmlElementsParentContainer.childNodes).forEach(e=>{-1===e.id.search(Mn.CrossSlideShapeId)&&this.m_slideLevelHtmlElementsParentContainer.removeChild(e)})}showHideCrossSlideAudios(e){this.m_slideLevelHtmlElementsParentContainer.childNodes.forEach(e=>{e&&e.id.search(Mn.CrossSlideShapeId)>0&&e.firstChild&&(e.firstChild.style.visibility="hidden")});const t=this.crossSlideMediaMap[e];t&&t.forEach(e=>{const t=document.getElementById(e.mediaElement.id);t&&(t.style.visibility="",e.mediaProps.hideWhenStopped&&(t.style.visibility="hidden"))})}stopCrossSlideAudio(){this.m_slideLevelHtmlElementsParentContainer.childNodes.forEach(e=>{const t=e;t&&t.id.search(Mn.CrossSlideShapeId)>0&&(t.currentTime=0,t.pause?t.pause():g.a.sendTraceTag(507004035,_.a.msoulscat_Wac_PptSession,S.a.Info,"Wrong HTML Audio tag "+t.tagName))})}showUnderlaysAndOverlays(e){Array.from(this.m_slideLevelHtmlElementsParentContainer.childNodes).forEach(t=>{const i=t;if(!(i.id.search(Mn.CrossSlideShapeId)>0))try{let n=i.id.split(Mn.SlideLevelHtmlElementsDivId+"-");const r=n&&n[1]?JSON.parse(n[1]):null;if(r&&r.slideId&&r.slideId.sid!==JSON.parse(e).sid&&this.m_slideLevelHtmlElementsParentContainer.removeChild(t),n=i.id.split(Mn.ShapeAccessibilityElementId+"-"),n&&n[1]){const i=n[1].split("sid:"),r=i&&i[1]?i[1].split("-"):null;r&&r[0]&&parseInt(r[0],10)!==JSON.parse(e).sid&&this.m_slideLevelHtmlElementsParentContainer.removeChild(t)}}catch(e){g.a.sendTraceTag(507004034,_.a.msoulscat_Wac_PptSession,S.a.Error,"Unexpected exception in showUnderlaysAndOverlays: "+e)}})}createNewScene(){const e=new T.d;return this.m_currentSceneCount+=1,e}async createImageTextureMapData(e){return F.a.readBooleanOrDefault("asyncSafeCreateTextures",!0)?await this.m_createImageTextureMapDataThrottler.callAsync(e):await this.createImageTextureMapDataImpl(e)}async createImageTextureMapDataImpl(e){const t={};g.a.sendTraceTag(507004033,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::createImageTextureMapData - beginning"),this.m_wasContextValidDuringCreateImageTextureMap=this.rendererEnvironment.isGLContextValid,t.textureMetadata={loadTexture:0,slidedata:0};let i=0;i=Mn.performanceNowTrimmed();const n=await this.viewDataManager.getSlideViewData(e.slideId);if(t.textureMetadata.slidedata=Mn.performanceNowTrimmed()-i,n.resource&&n.resource.resCat){const i=n.resource;let r=0;for(const e of i.resCat)if(this.viewDataManager.imageDataMap.has(e.id)){const t=this.viewDataManager.imageDataMap.get(e.id);t.loadedSlideIDs.find(e=>e.sid===i.slideId.sid)||t.loadedSlideIDs.push(i.slideId),g.a.sendTraceTag(507004003,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::createImageTextureMapData - already loaded "+e.id)}else{g.a.sendTraceTag(507004032,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::createImageTextureMapData - loading "+e.id),r=Mn.performanceNowTrimmed();const n=await this.loadImageTexture(e,i.slideId,i.slideSizePixels);t.textureMetadata.loadTexture+=Mn.performanceNowTrimmed()-r,n.hasOwnProperty("errorName")&&(t.hasOwnProperty("invalidImageIds")||(t.invalidImageIds=[]),t.invalidImageIds.push(e.id))}g.a.sendTraceTag(507004002,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController::createImageTextureMapData - setting fImageTextureLoaded to true for SlideSID:"+e.slideId.sid),F.a.readBooleanOrDefault("enableFailTextureLoadOnContextLost",!1)?e.slideViewElement.fImageTextureLoaded=this.m_wasContextValidDuringCreateImageTextureMap:e.slideViewElement.fImageTextureLoaded=!0}return t}async loadImageTexture(e,t,i){return e.url&&this.rendererEnvironment.isGLContextValid?new Promise(r=>{const a=new Image;if(a.ID=e.id,a.onload=()=>{try{const n=this.getBounds.getBoundingClientRectFromContainer(),s=this.rendererEnvironment.saveImageData(a,e,t,i,{x:n.width,y:n.height});return r(s),s}catch(e){return g.a.sendTraceTag(507004e3,_.a.msoulscat_Wac_PptSession,S.a.Error,`Exception in image.onload for id: ${a.ID} e: ${e}`),r({errorName:Mi.CannotLoadImageTexture}),{errorName:Mi.CannotLoadImageTexture}}},a.onerror=()=>(g.a.sendTraceTag(507003999,_.a.msoulscat_Wac_PptSession,S.a.Error,"Image Failed to load - "+a.ID),r({errorName:Mi.CannotLoadImageTexture}),{errorName:Mi.CannotLoadImageTexture}),a.name=e.name,e.mimeType.startsWith("image/svg+xml")&&e.urlType===n.Base64){const t=e.url.indexOf(",");if(G.ChangeGate.isChangeGateEnabled("FireFoxSVGFileRenderingFix")){const i=e.url.substring(0,t+1),n=e.url.substring(t+1),r=(new DOMParser).parseFromString(n,"image/svg+xml");this.ensureSVGWidthHeight(r.documentElement),a.src=i+encodeURIComponent(r.documentElement.outerHTML)}else a.src=e.url.substring(0,t+1)+encodeURIComponent(e.url.substring(t+1))}else a.src=e.url;return{}}):(g.a.sendTraceTag(507004001,_.a.msoulscat_Wac_PptSession,S.a.Error,"Image Failed to load - "+JSON.stringify({id:e.id,hasUrl:!!e.url,mimeType:e.mimeType,urlType:e.urlType,byteCount:e.byteCount,isGLContextValid:this.rendererEnvironment.isGLContextValid})),{})}ensureSVGWidthHeight(e){if(!e.getAttribute("width")||!e.getAttribute("height")){const t=e.getAttribute("viewBox");if(t){const i=t.match(/\w+ \w+ (\w+) (\w+)/);null!=i&&(e.setAttribute("width",i[1]),e.setAttribute("height",i[2]))}}}clearNavigationState(){for(const e of this.m_slideSceneView){for(const t of e.slideViewElement.animTimeline.getTimelineStates(!1)||[])e.slideViewElement.animTimeline.resetTimeline(t.timelineId),e.slideViewElement.fNeedsDummyClick&&e.slideViewElement.animTimeline.addTimelineClick(v.e.MainTimelineId);e.slideViewElement.animClock.stop()}}async refreshViewController(){if(this.settings.isMultiSlideshowcoreEnabled&&Mn.s_preloadedRendererEnvironment){document.querySelectorAll("#"+Mn.SlideLevelHtmlElementsParentDivId).forEach(e=>{e.remove()});const e=document.createElement("div");e.id=Mn.SlideLevelHtmlElementsParentDivId,this.m_container.appendChild(e),this.m_slideLevelHtmlElementsParentContainer=e,this.rendererEnvironment=Mn.s_preloadedRendererEnvironment,this.getBounds=this.settings.getBounds?this.settings.getBounds:new un(this.m_container,this.rendererEnvironment),this.rendererEnvironment.viewController=this,this.m_viewControllerInternals&&(this.rendererEnvironment.viewControllerInternals=this.m_viewControllerInternals),this.rendererEnvironment.setupCanvas(this.m_container)}}async updateViewDataManager(e,t,i){let n={};const r=!(!i||!i.fSkipRendering);for(const e of this.m_slideSceneView)!this.m_currentRenderedSlideId||e.slideId.sid!==this.m_currentRenderedSlideId.sid||r?(e.scene&&this.deleteScene(e),e.slideViewElement.shapeViewElements=[],this.m_slideSceneView=this.m_slideSceneView.filter(t=>t!==e)):e.slideViewElement.shapeViewElements=[];if(this.viewDataManager=e,this.m_currentRenderedSlideId&&!r){g.a.sendTraceTag(507003998,_.a.msoulscat_Wac_PptSession,S.a.Info,"Rerender the current slide with new ViewDataManager - sid:"+this.m_currentRenderedSlideId.sid);const e=this.m_slideSceneView.find(e=>e.slideId.sid===this.m_currentRenderedSlideId.sid);if(e){let r=await e.slideViewElement.ensure({loadDataOptions:i});if(r.hasOwnProperty("errorName"))g.a.sendTraceTag(507003997,_.a.msoulscat_Wac_PptSession,S.a.Error,`ViewController::updateViewDataManager: invalid slideViewData. sid:${this.m_currentRenderedSlideId.sid}, ensureResult:${r.errorName}`);else{for(e.scene&&this.deleteScene(e);this.m_slideLevelHtmlElementsParentContainer.firstChild;)this.m_slideLevelHtmlElementsParentContainer.firstChild.remove();const a=await this.createImageTextureMapData(e);r=await e.slideViewElement.ensure({loadDataOptions:i}),this.viewDataManager.slideMetadataMap.set(this.m_currentRenderedSlideId.sid,{slideId:this.m_currentRenderedSlideId,isHidden:e.slideViewElement.isHidden}),this.renderSlideById(this.m_currentRenderedSlideId,t),n={...r,...a}}n={...n,...r}}}return n}static getElementFromCollection(e,t){for(let i=0;i<e.length;i+=1)if(e[i].id===t)return e[i]}static getElementFromCollectionByLocalName(e,t){for(let i=0;i<e.length;i+=1)if(e[i].localName===t)return e[i]}get isGlobalMute(){return this.m_isGlobalMute}updateGlobalMute(e){if(this.m_isGlobalMute!==e){for(const t of this.m_slideSceneView)t.slideViewElement.updateGlobalMute(e);this.m_isGlobalMute=e}}muteAllPlayingMedia(){g.a.sendTraceTag(507003996,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewController: Muting all playing media");for(const e of this.m_slideSceneView)e.slideViewElement.muteAllPlayingMedia()}checkForLeaksByScenario(){const e=this.checkForLeaks(),t=new Map;for(const i of e?e.table:[]){if("DistanceField/glyphPage"===i.scenario||"ScratchBuffer"===i.scenario)continue;i.scenario=i.scenario.split("-")[0];const e=t.get(i.scenario)||0;t.set(i.scenario,e+i.memory)}return t}checkForLeaks(e){const t=this.rendererEnvironment.webGLRenderer;if(!t)return void console.log("only supported for webGL");const i=[];for(const t of this.m_slideSceneView)t.scene&&(i.push(t.scene),e&&t.scene.releaseGeneratedResources());const n=this.m_morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource);for(const t of n){e&&t.dispose(),i.push(t.morph);for(const e of t.createdItems)i.push(e)}for(const e of this.viewDataManager.externalTexturesToRelease)i.push(e.texture);return{textures:t.getAllocatedTextures(i),table:t.getAllocatedTexturesDebugTable("clientData.id",i)}}constructor(e,t,i,n,r,a,s,o){if(this.m_slideSceneView=new Array,this.m_transitionController=null,this.m_isGlobalMute=!1,this.m_fCheckGlyphCacheOnNextRender=!1,this.m_renderStateSnapshot={slideRendMap:{}},this.m_wasContextValidDuringCreateImageTextureMap=!0,this.m_createImageTextureMapDataThrottler=new hn.b(this.createImageTextureMapDataImpl.bind(this),hn.c,e=>JSON.stringify(e.slideId)),this.isAnimating=!1,this.isTransitioning=!1,this.crossSlideMediaMap={},this.mediaCommandScope=vn.None,this.events=new Z.EventEmitter,this.onContextLost=()=>{this.m_wasContextValidDuringCreateImageTextureMap=!1},kn({logger:n,settings:r.settings,disabledChangeGates:r.disabledChangeGates||""}),this.settings=r,this.stringifyError=r.stringifyError,Mn.ensureRendererEnvironment(r.shapeBuilderCanvasContext),!Mn.s_preloadedRendererEnvironment)throw g.a.sendTraceTag(507004105,_.a.msoulscat_Wac_PptSession,S.a.Error,"ViewController::constructor - s_preloadedRendererEnvironment is null");this.rendererEnvironment=Mn.s_preloadedRendererEnvironment,this.getBounds=r.getBounds?r.getBounds:new un(e,this.rendererEnvironment),xn.this=this,xn.getDebugString=this.rendererEnvironment.renderer.getDebugString.bind(this.rendererEnvironment.renderer),xn.getGpuMemory=this.getGpuMemory.bind(this),xn.checkForLeaks=this.checkForLeaks.bind(this),xn.getWebGLState=()=>this.rendererEnvironment.webGLRenderer&&this.rendererEnvironment.webGLRenderer.getWebGLState(),this.slideSizeEmus=t,this.viewDataManager=i,this.settings.morphEnabled=this.settings.morphEnabled&&this.rendererEnvironment.supportsTransitions,this.rendererEnvironment.viewController=this,s&&(Mn.appLanguage=s),o&&(this.addinManager=o);const l=this;this.rendererEnvironment.viewControllerInternals={get slideSceneView(){return l.m_slideSceneView},get forwardSceneCount(){return l.m_forwardSceneCount},get backwardSceneCount(){return l.m_backwardSceneCount},get currentSceneCount(){return l.m_currentSceneCount},get transitionFactory(){return l.m_transitionFactory},get settings(){return l.settings},get currentRenderedSlideId(){return l.m_currentRenderedSlideId},get morphCache(){return l.m_morphCache},set transitionController(e){l.m_transitionController=e},deleteScene:this.deleteScene.bind(this),createImageTextureMapData:this.createImageTextureMapData.bind(this)},this.settings.isMultiSlideshowcoreEnabled&&(this.m_viewControllerInternals=this.rendererEnvironment.viewControllerInternals),this.m_forwardSceneCount=F.a.readNumberOrDefault("forwardSceneCount",2),this.m_backwardSceneCount=F.a.readNumberOrDefault("backwardSceneCount",2),this.m_currentSceneCount=0,this.m_cameoTextureManager=Y.getInstance(this),this.m_morphCache=new Ri.b({load:this.morphLoader.bind(this)}),this.m_container=e,Object(E.H)(!0),this.rendererEnvironment.setupCanvas(this.m_container),this.m_transitionFactory=new Pi.a({customTransitionDataLoader:a,transitionDisabledList:F.a.readStringOrDefault("transitionDisabledList","")}),this.m_accessibilityLiveRegionContainer=document.createElement("div"),this.m_container.tabIndex=0,this.m_accessibilityLiveRegionContainer.id=Mn.AccessibilityLiveRegionContainerDivId,this.m_accessibilityLiveRegionContainer.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),this.m_accessibilityLiveRegionContainer.setAttribute("aria-live","assertive"),this.m_accessibilityLiveRegionContainer.setAttribute("aria-atomic","true"),this.m_accessibilityLiveRegionContainer.setAttribute("role","alert"),this.m_container.appendChild(this.m_accessibilityLiveRegionContainer),this.m_crossSlideAudioContainer=document.createElement("div"),this.m_crossSlideAudioContainer.style.position="absolute",this.m_crossSlideAudioContainer.style.pointerEvents="none",this.m_crossSlideAudioContainer.id=Mn.CrossSlideAudioContainerDivId,this.m_slideLevelHtmlElementsParentContainer=document.createElement("div"),this.m_slideLevelHtmlElementsParentContainer.id=Mn.SlideLevelHtmlElementsParentDivId,F.a.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_slideLevelHtmlElementsParentContainer.style.position="absolute",this.m_slideLevelHtmlElementsParentContainer.style.overflow="hidden",this.m_slideLevelHtmlElementsParentContainer.style.pointerEvents="none",this.m_slideLevelHtmlElementsParentContainer.addEventListener("scroll",()=>{this.m_slideLevelHtmlElementsParentContainer.scrollLeft=0,this.m_slideLevelHtmlElementsParentContainer.scrollTop=0})),this.m_container.appendChild(this.m_slideLevelHtmlElementsParentContainer),this.m_notesPaneParagraphReaderContainer=document.createElement("div"),this.m_notesPaneParagraphReaderContainer.id=Mn.NotesPaneParagraphReaderId,this.m_notesPaneParagraphReaderContainer.setAttribute("aria-live","assertive"),this.m_notesPaneParagraphReaderContainer.setAttribute("aria-atomic","true"),this.m_notesPaneParagraphReaderContainer.setAttribute("role","alert"),this.m_notesPaneParagraphReaderContainer.classList.add("show-accessibility-element"),this.m_notesPaneParagraphReaderContainer.style.display="",this.m_container.appendChild(this.m_notesPaneParagraphReaderContainer),this.m_clickTargetsReferenceDiv=document.createElement("div"),this.m_clickTargetsReferenceDiv.style.position="absolute",this.m_clickTargetsReferenceDiv.style.zIndex="-1",this.m_clickTargetsReferenceDiv.style.pointerEvents="none",this.m_clickTargetsReferenceDiv.id=Mn.ClickTargetsReferenceDivId,this.m_container.appendChild(this.m_clickTargetsReferenceDiv),this.m_inScreenCoordsContainer=document.createElement("div"),this.m_inScreenCoordsContainer.id="in-screen-coords",this.m_inScreenCoordsContainer.style.position="absolute",this.m_inScreenCoordsContainer.style.pointerEvents="none",this.m_container.appendChild(this.m_inScreenCoordsContainer),this.m_preActivedAddinsContainer=document.createElement("div"),this.m_preActivedAddinsContainer.id=Mn.PreactivedAddinsDivId,this.m_preActivedAddinsContainer.style.zIndex="-1",this.m_preActivedAddinsContainer.style.visibility="hidden",this.m_preActivedAddinsContainer.style.display="",this.m_container.appendChild(this.m_preActivedAddinsContainer),G.ChangeGate.isChangeGateEnabled("SVM.CustomTooltipForLink")&&(this.m_liteTooltip=new Pn(this.m_container)),F.a.readBooleanOrDefault("enableFailTextureLoadOnContextLost",!1)&&this.events.on("webglcontextlost",this.onContextLost)}}Mn.accessibilityLanguage="",Mn.s_gpuHardwareDisabled=!1,Mn.s_isBadGpu=!1,Mn.s_glyphCacheFailedCount=0,Mn.ClickTargetsReferenceDivId="click-targets-reference",Mn.BlankSlideDivId="blank-slide",Mn.CrossSlideAudioContainerDivId="cross-slide-audio",Mn.AccessibilityLiveRegionContainerDivId="live-region-accessibility-element",Mn.SlideLevelHtmlElementsParentDivId="slide-level-html-elements-parent",Mn.SlideLevelHtmlElementsDivId="slide-level-html-elements-transform",Mn.ShapeAccessibilityElementId="shape-accessibility-element",Mn.AccessibilitySlideTitleId="accessibility-slide-title",Mn.CrossSlideShapeId="cross-slide-shape",Mn.NotesPaneParagraphReaderId="notes-pane-paragraph-reader",Mn.PreactivedAddinsDivId="cross-slide-preactived-addins";class An{mergeGlyphs(e){if(null!=e)for(const t of e)this.hasGlyph(t.f,t.g)||this.addGlyph(t)}addGlyph(e){let t=this.m_glyphMap.get(e.f);t||(t=[],this.m_glyphMap.set(e.f,t)),t.push(e),this.updateKnownGlyphsString()}hasGlyph(e,t){const i=this.m_glyphMap.get(e);if(!i)return!1;for(const n of i)if(n.f===e&&n.g===t)return!0;return!1}getGlyph(e,t){const i=this.m_glyphMap.get(e);if(!i)return g.a.sendTraceTag(507004163,_.a.msoulscat_Wac_PptSlideshow,S.a.Error,"glyph font info missing"),void J.e.recordVeto("ACE",{errorName:"GlyphMissing",whatsMissing:"FontInfo",qosVeto:"ContentRenderFailed"});for(const n of i)if(n.f===e&&n.g===t)return n;g.a.sendTraceTag(507004162,_.a.msoulscat_Wac_PptSlideshow,S.a.Error,"glyph missing"),J.e.recordVeto("ACE",{errorName:"GlyphMissing",whatsMissing:"Glyph",qosVeto:"ContentRenderFailed"})}get knownGlyphsString(){return this.m_knownGlyphsString}updateKnownGlyphsString(){const e={};this.m_glyphMap.forEach(t=>{for(const i of t){const t=Rn.parseFontInfo(i.f);t.fontName in e||(e[t.fontName]={}),t.key in e[t.fontName]||(e[t.fontName][t.key]=[]),e[t.fontName][t.key].push(i.g)}for(const t in e)for(const i in e[t])e[t][i].sort((e,t)=>1*e-1*t);for(const t in e)for(const i in e[t])for(let n=0;n<e[t][i].length-1;n+=1){let r=0;for(;n+r+1<e[t][i].length&&e[t][i][n+r]+1===e[t][i][n+r+1];)r+=1;if(r>0){const a=""+e[t][i][n+r];a.length<r.toString().length?e[t][i][n]=`${e[t][i][n]}-${a}`:e[t][i][n]=`${e[t][i][n]}+${r}`,e[t][i].splice(n+1,r)}}}),this.m_knownGlyphsString=JSON.stringify(e),F.a.readBooleanOrDefault("logKnownGlyphsString",!1)&&g.a.sendTraceTag(507004161,_.a.msoulscat_Wac_PptSlideshow,S.a.Info,"GetKnownGlyphsString length: "+this.m_knownGlyphsString.length)}constructor(){this.m_glyphMap=new Map,this.m_knownGlyphsString=""}}class Rn{static parseFontInfo(e){const t=Rn.findSixthComma(e);return{fontName:e.substring(1,t),key:e.substring(t+1,e.length-1)}}static findSixthComma(e){let t=e.length;for(let i=0;i<6;i+=1)t=e.lastIndexOf(",",t-1);return t}}class On{onExternalTextureReleased(e){for(let t=this.externalTexturesToRelease.length-1;t>=0;t-=1){const i=this.externalTexturesToRelease[t];i.imageId===e&&((F.a.readBooleanOrDefault("fixExternalTextureTracking",!0)?i.texture.releasePolicy===O.e.ExternallyManaged:i.texture.releasePolicy!==O.e.ExternallyManaged)?(i.texture.release(),g.a.sendTraceTag(507003995,_.a.msoulscat_Wac_PptSession,S.a.Info,"Releasing externally managed texture id:"+e)):g.a.sendTraceTag(507003994,_.a.msoulscat_Wac_PptSession,S.a.Warning,"ViewDataManager::onExternalTextureReleased: tried to release texture that is not ExternallyManaged. id:"+e),this.externalTexturesToRelease.splice(t,1))}}async getSlideViewData(e,t){const i=await this.m_slideViewDataLoader.load(JSON.stringify(e),t);return i.resource&&i.resource.shapeGlyph&&this.glyphStore.mergeGlyphs(i.resource.shapeGlyph),i&&i.resource||g.a.sendTraceTag(507003993,_.a.msoulscat_Wac_PptSession,S.a.Warning,`ViewDataManager::getSlideViewData: missing slideViewData. slideId:${e.sid}, item exists:${!!i}, correlation:${t?t.meta_correlationId:""}, errorName:${i&&i.hasOwnProperty("metadata")&&i.metadata.hasOwnProperty("errorName")?i.metadata.errorName:""}`),i}async getShapeViewData(e,t){const i=await this.m_shapeViewDataLoader.load(`${JSON.stringify(e)}_${JSON.stringify(t)}`);return i&&i.resource}setSlideIdOrder(e){g.a.sendTraceTag(507003992,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewDataManager::setSlideIdOrder slideIdOrder:"+JSON.stringify(e)),this.slideIdOrder=e}setSlideIdOrderWithHidden(e,t){this.setSlideIdOrder(e),g.a.sendTraceTag(507003991,_.a.msoulscat_Wac_PptSession,S.a.Info,"ViewDataManager::setSlideIdOrderWithHidden hiddenSlideIdOrder:"+JSON.stringify(t)),this.m_hiddenSlideIdOrder=t,this.visibleSlideIdOrder=e.filter(e=>!this.m_hiddenSlideIdOrder.some(t=>t.sid===e.sid&&t.cid===e.cid))}async getLocalizedString(e){const t=await this.m_localizedStringLoader.load(e);return t&&t.resource||g.a.sendTraceTag(507003990,_.a.msoulscat_Wac_PptSession,S.a.Error,"Failed to get localized string. id:"+e),t&&t.resource}getVisibleSlideIndex(e){if(this.visibleSlideIdOrder.length>0)return this.visibleSlideIdOrder.findIndex(t=>t.sid===e.sid);let t=-1;for(const i of this.slideIdOrder){const n=this.slideMetadataMap.get(i.sid);if(!n||void 0===n.isHidden)return-1;if(n.isHidden||(t+=1),i.sid===e.sid)return n.isHidden?-1:t}return-1}getVisibleSlideIndexDifference(e,t){const i=this.getSlideIndex(e),n=this.getSlideIndex(t);if(-1===i||-1===n)return;if(i===n)return 0;if(!1!==this.getIsHiddenByIndex(i)||!1!==this.getIsHiddenByIndex(n))return;if(this.visibleSlideIdOrder.length>0)return this.visibleSlideIdOrder.findIndex(e=>e.sid===t.sid)-this.visibleSlideIdOrder.findIndex(t=>t.sid===e.sid);const r=i<n?1:-1;let a=1;for(let e=i+r;e!==n;e+=r){const t=this.getIsHiddenByIndex(e);if(void 0===t)return;t||(a+=1)}return r*a}getIsHiddenByIndex(e){const t=this.slideMetadataMap.get(this.slideIdOrder[e].sid);return t?t.isHidden:void 0}getSlideIndex(e){if(0===this.slideIdOrder.length)return-1;let t=0;for(const i of this.slideIdOrder){if(e.sid===i.sid)return t;t+=1}return-1}constructor(e,t,i){this.memoryStats={gifTextures:0,transitionTextures:0,transitionsMemoryReport:new Pi.b,videoTextures:0,cameoTextures:0,externalTextureLeaks:0},this.externalTexturesToRelease=[],this.slideIdOrder=[],this.visibleSlideIdOrder=[],this.glyphStore=new An,this.sections=[],this.m_hiddenSlideIdOrder=[],this.m_slideViewDataLoader=e,this.m_shapeViewDataLoader=t,this.m_localizedStringLoader=i,this.imageDataMap=new Map,this.slideMetadataMap=new Map}}},function(e,t,i){"use strict";function n(e,t,i){t!=i&&e.notifyChange()}function r(e,t,i){t==i||t&&i&&t.equals(i)||e.notifyChange()}function a(e,t,i){if(t!=i)if(t&&i&&t.length==i.length){for(let n=0;n<t.length;n++)if(t[n]!=i[n])return void e.notifyChange()}else e.notifyChange()}function s(e,t,i){if(t!=i)if(t&&i&&t.length==i.length){for(let n=0;n<t.length;n++)if(!t[n].equals(i[n]))return void e.notifyChange()}else e.notifyChange()}i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"d",(function(){return s}))},function(e,t,i){"use strict";i.d(t,"f",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return c})),i.d(t,"g",(function(){return a})),i.d(t,"j",(function(){return h})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return m})),i.d(t,"i",(function(){return f})),i.d(t,"c",(function(){return p})),i.d(t,"h",(function(){return g}));var n,r,a,s=i(0),o=i(6),l=i(18),d=i(91);!function(e){e[e.gap=0]="gap",e[e.corner=1]="corner",e[e.bezier=2]="bezier"}(n||(n={})),function(e){e[e.none=0]="none",e[e.normal=1]="normal",e[e.lighten=2]="lighten",e[e.lightenLess=3]="lightenLess",e[e.darken=4]="darken",e[e.darkenLess=5]="darkenLess"}(r||(r={}));class c{static CreateFromFigure(e){return new c({figures:[e]})}static CreateFromRect(e){return new c({figures:[u.CreateFromRect(e)]})}get figures(){return this.m_sharedPathStorage.figures}get transform(){return this.m_transform}get fillMode(){return this.m_sharedPathStorage.fillMode}get lineEnabled(){return this.m_sharedPathStorage.lineEnabled}get extrusionEnabled(){return this.m_sharedPathStorage.extrusionEnabled}get glyphCacheId(){return this.m_sharedPathStorage.glyphCacheId}get maxPressure(){return 4096}get renderDataMap(){return this.m_sharedPathStorage.renderDataMap}get hasPressureInfo(){return this.figures.some(e=>!!(e.format&a.pressure))}get isUntransformedRect(){return this.m_sharedPathStorage.isUntransformedRect}get untransformedBounds(){return this.m_sharedPathStorage.untransformedBounds}measureLength(e=s.e.Identity){let t=0;for(const i of this.figures)t+=i.measureLength(e);return t}equals(e){return this.m_sharedPathStorage==e.m_sharedPathStorage&&this.m_transform.equals(e.m_transform)}copyTransformed(e){const t=s.c.FromTransforms(this.transform,e),i=this.figures.map(e=>e.transform(t));return new c({figures:i,fillMode:this.fillMode,lineEnabled:this.lineEnabled,extrusionEnabled:this.extrusionEnabled})}constructor(e,t){if(e instanceof c)this.m_sharedPathStorage=e.m_sharedPathStorage,this.m_transform=t||e.transform;else{const i=[];for(const t of e.figures)i.push(t instanceof m?t.createFigure():t);this.m_sharedPathStorage={figures:i,fillMode:null==e.fillMode?r.normal:e.fillMode,lineEnabled:null==e.lineEnabled||e.lineEnabled,extrusionEnabled:null==e.extrusionEnabled||e.extrusionEnabled,glyphCacheId:e.glyphCacheId?{fontId:e.glyphCacheId.fontId,glyphId:e.glyphCacheId.glyphId}:void 0,isUntransformedRect:_(i),untransformedBounds:g(i),renderDataMap:{}},this.m_transform=t||(e.transform?e.transform:s.e.Identity)}null===d.a||void 0===d.a||d.a.register(this,this.renderDataMap)}}function h(e){let t=(e&a.position?2:0)+(e&a.type?1:0)+(e&a.distance?1:0)+(e&a.pressure?1:0)+(e&a.tilt?2:0);return e&a.alignedVec4&&(t=4*Math.ceil(t/4)),t}!function(e){e[e.none=0]="none",e[e.position=1]="position",e[e.type=2]="type",e[e.distance=4]="distance",e[e.pressure=8]="pressure",e[e.tilt=16]="tilt",e[e.alignedVec4=32]="alignedVec4"}(a||(a={}));class u{static CreateFromRect(e){return new u([e.left,e.top,1,e.right,e.top,1,e.right,e.bottom,1,e.left,e.bottom,1],!0)}static CreateFromRoundedRect(e,t){const i=Math.min(t,Math.min(e.width,e.height)/2),n=new m;return n.moveTo(e.center.x-e.width/2,e.center.y-(e.height/2-i)),n.arcTo(i,i,-Math.PI,Math.PI/2),n.lineTo(e.right-i,e.top),n.arcTo(i,i,-Math.PI/2,Math.PI/2),n.lineTo(e.right,e.bottom-i),n.arcTo(i,i,0,Math.PI/2),n.lineTo(e.left+i,e.bottom),n.arcTo(i,i,Math.PI/2,Math.PI/2),n.lineTo(e.left,e.top+i),n.close(),n.createFigure()}get points(){return this.m_points}get format(){return this.m_format}get pointDataSize(){return this.m_pointDataSize}get isClosed(){return this.m_isClosed}isLastPointDuplicated(){return this.getPoint(0).equalsWithEpsilon(this.getPoint(-1),.1)}getPointCount(){return this.m_points.length/this.m_pointDataSize}getPoint(e){const t=this.getPointCount(),i=e<0?e%t+t:e%t;return new s.f(this.m_points[i*this.m_pointDataSize],this.m_points[i*this.m_pointDataSize+1])}getPointType(e){if(!(this.m_format&a.type))return n.corner;const t=this.getPointCount(),i=e<0?e%t+t:e%t;return this.m_points[i*this.m_pointDataSize+2]}toPolygon(){const e=this.getPointCount(),t=new m([],this.m_isClosed,a.position);for(let i=0;i<e;i++){const e=this.getPoint(i);if(this.getPointType(i)!=n.bezier)t.pushPoint(e.x,e.y);else{const n=this.getPoint(i-1),r=this.getPoint(i+1),a=8;for(let i=1;i<a;i++){const o=s.f.InterpolateQuadratic(n,e,r,i/a);t.pushPoint(o.x,o.y)}}}return t.createFigure()}transform(e){const t=this.points.slice(0),i=this.pointDataSize;for(let n=0;n<this.getPointCount();n++){const r=this.getPoint(n).transformPoint(e);t[n*i]=r.x,t[n*i+1]=r.y}return new u(t,this.isClosed,this.format)}measureLength(e=s.e.Identity){let t=0;return this.forEachSegment((e,i,n)=>(t+=i?s.f.MeasureQuadraticLength(e,i,n):s.f.Distance(e,n),!0),e),t}getPointFromDist(e,t=s.e.Identity,i=!1){let n=0,r=void 0;return this.forEachSegment((t,i,a)=>{const o=i?s.f.MeasureQuadraticLength(t,i,a):s.f.Distance(t,a);if(n+o>e)if(i){const o=s.f.GetQuadraticParameterForDistance(t,i,a,e-n);r=s.f.InterpolateQuadratic(t,i,a,o)}else{const i=(e-n)/o;r=s.f.InterpolateLinear(t,a,i)}return n+=o,n<=e},t,i),r||this.getPoint(i?0:this.getPointCount()-1).transformPoint(t)}getTangentFromDist(e,t=s.e.Identity,i=!1){let n,r=0;if(this.forEachSegment((t,i,a)=>{const o=i?s.f.MeasureQuadraticLength(t,i,a):s.f.Distance(t,a);return r+o>e&&(n={a:t,c:i,b:a,segmentLength:o,localDistance:e-r}),r+=o,r<e},t,i),n){if(n.c){const e=s.f.GetQuadraticParameterForDistance(n.a,n.c,n.b,n.localDistance);return s.f.QuadraticTangent(n.a,n.c,n.b,e)}return n.b.subtract(n.a).scale(1/n.segmentLength)}}forEachSegment(e,t=s.e.Identity,i=!1){const r=this.getPointCount();if(0==r)return;const a=i?0:r-1,o=i?-1:1;for(let s=i?r-1:0;s!=a;s+=o){const i=s+o,a=i+o,l=this.getPointType(i)==n.bezier;if(this.getPointType(s)!=n.bezier&&(this.m_isClosed||i==i%r)&&(!l||this.m_isClosed||a==a%r)&&!e(this.getPoint(s).transformPoint(t),l?this.getPoint(i).transformPoint(t):void 0,this.getPoint(l?a:i).transformPoint(t)))return}}constructor(e,t=!1,i=a.position|a.type){if(this.m_points=e,this.m_isClosed=t,this.m_format=i,this.m_pointDataSize=h(i),this.m_points.length%this.m_pointDataSize!=0)throw o.a.Error(592520776,"list of points invalid")}}class m{createFigure(){return new u(this._points,this.isClosed,this.format)}pushPoint(e,t,i=n.corner,r){switch(this.lastPointX=e,this.lastPointY=t,this.pointDataSize){case 2:return void this._points.push(e,t);case 3:return void this._points.push(e,t,i);case 4:return void this._points.push(e,t,i,r?r[0]:0);case 5:return void this._points.push(e,t,i,r?r[0]:0,r?r[1]:0);case 6:return void this._points.push(e,t,i,r?r[0]:0,r?r[1]:0,r?r[2]:0);case 7:return void this._points.push(e,t,i,r?r[0]:0,r?r[1]:0,r?r[2]:0,r?r[3]:0)}throw o.a.Error(592520778,"Unsupported data size")}moveTo(e,t,i){if(0!=this._points.length)throw o.a.Error(592520779,"Figures should have only one MoveTo");this.pushPoint(e,t,1,i)}moveToPoint(e,t){this.moveTo(e.x,e.y,t)}lineTo(e,t,i){if(this._points.length<this.pointDataSize)throw o.a.Error(592520780,"All figures should start with a MoveTo");(Math.abs(e-this.lastPointX)>.1||Math.abs(t-this.lastPointY)>.1)&&this.pushPoint(e,t,1,i)}lineToPoint(e,t){this.lineTo(e.x,e.y,t)}quadBezierTo(e,t,i,n,r){if(this._points.length<this.pointDataSize)throw o.a.Error(592520781,"All figures should start with a MoveTo");const a=this.lastPointX,s=this.lastPointY;if(Math.abs(i-a)>.1||Math.abs(n-s)>.1){const o=Math.sqrt((e-a)*(e-a)+(t-s)*(t-s)),l=Math.sqrt((i-e)*(i-e)+(n-t)*(n-t)),d=Math.abs(e-a)<.1&&Math.abs(t-s)<.1,c=Math.abs(i-e)<.1&&Math.abs(n-t)<.1;!d&&!c&&Math.abs(o/l)>.1&&Math.abs(l/o)>.1?(this.pushPoint(e,t,2),this.pushPoint(i,n,1,r)):this.pushPoint(i,n,1,r)}}quadBezierToPoint(e,t,i){this.quadBezierTo(e.x,e.y,t.x,t.y,i)}cubicBezierTo(e,t,i,n,r,a){this.cubicBezierToPoint(new s.f(e,t),new s.f(i,n),new s.f(r,a))}cubicBezierToPoint(e,t,i){if(this._points.length<this.pointDataSize)throw o.a.Error(592520782,"All figures should start with a MoveTo");const n=new s.f(this.lastPointX,this.lastPointY),r=Math.abs(e.x-n.x)<.1&&Math.abs(e.y-n.y)<.1,a=Math.abs(t.x-e.x)<.1&&Math.abs(t.y-e.y)<.1,l=Math.abs(i.x-t.x)<.1&&Math.abs(i.y-t.y)<.1;if(a&&(r||l))r!=l&&this.lineToPoint(i);else{const r=4;let a=n,o=n,l=e;for(let d=0;d<r;d++){const c=(d+1)/r,h=s.f.InterpolateQuadratic(n,e,t,c),u=s.f.InterpolateQuadratic(e,t,i,c),m=s.f.InterpolateLinear(h,u,c),f=l.subtract(o).normalized(),p=u.subtract(h).normalized();let g;if(f&&p&&Math.abs(f.dot(p))<Math.sqrt(2)/2)g=s.f.CalculateLineIntersection(o,l,h,u,s.i);else{const o=(d+.5)/r,l=s.f.InterpolateLinear(s.f.InterpolateQuadratic(n,e,t,o),s.f.InterpolateQuadratic(e,t,i,o),o),c=a.add(m).scale(.5);g=c.add(l.subtract(c).scale(2))}g?this.quadBezierTo(g.x,g.y,m.x,m.y):this.lineTo(m.x,m.y),a=m,o=h,l=u}}}arcTo(e,t,i,n){if(this._points.length<this.pointDataSize)throw o.a.Error(592520783,"All figures should start with a MoveTo");const r=2*Math.PI,a=e<s.i||t<s.i,l=a?i:Math.atan2(e*Math.sin(i),t*Math.cos(i)),d=n<0?-1:1;let c=Math.abs(n);if(c>=r)c=r;else{let n=i+c*d;n=a?n:Math.atan2(e*Math.sin(n),t*Math.cos(n)),c=(n-l)*d,c<0&&(c+=r)}const h=this.lastPointX,u=this.lastPointY,m=h-Math.cos(l)*e,f=u-Math.sin(l)*t,p=Math.ceil(8*Math.abs(c)/r);for(let i=0;i<p;i++){const n=d*r/8,a=l+i*n,o=i==p-1?d*c-i*n:n,h=a+o,u=a+o/2,g=1/Math.cos(o/2),_=new s.f(m+Math.cos(u)*g*e,f+Math.sin(u)*g*t),S=new s.f(m+Math.cos(h)*e,f+Math.sin(h)*t);Math.abs(o)>s.i?this.quadBezierTo(_.x,_.y,S.x,S.y):this.lineTo(S.x,S.y)}}close(){if(this._points.length<this.pointDataSize)throw o.a.Error(592520784,"All figures should start with a MoveTo");this.isClosed=!0}isLastPointDuplicated(){return this.getPoint(0).equalsWithEpsilon(this.getPoint(-1),.1)}getPointCount(){return this._points.length/this.pointDataSize}getPoint(e){const t=this.getPointCount(),i=e<0?e%t+t:e%t;return new s.f(this._points[i*this.pointDataSize],this._points[i*this.pointDataSize+1])}get data(){return this._points}constructor(e=[],t=!1,i=a.position|a.type){if(this._points=e,this.isClosed=t,this.format=i,this.pointDataSize=h(i),this.lastPointX=0,this.lastPointY=0,this._points.length%this.pointDataSize!=0)throw o.a.Error(592520777,"list of points invalid")}}function f(e){const t="["+e.replace(/(M|L|Q|C|A|E|;)/g,e=>"M"==e?"0":"L"==e?"1":"Q"==e?"2":"C"==e?"3":"A"==e?"4":"E"==e?"5":",")+"]",i=new Float32Array(JSON.parse(t)),n=[];let r=void 0,a=0;const s=2*Math.PI/216e5;for(;a<i.length;)switch(i[a++]){case 0:if(a+1>=i.length)throw o.a.Error(592520785,"Invalid LineTo");r&&n.push(r),r=new m,r.moveTo(i[a++],i[a++]);break;case 1:if(!r||a+1>=i.length)throw o.a.Error(592520786,"Invalid LineTo");r.lineTo(i[a++],i[a++]);break;case 2:if(!r||a+3>=i.length)throw o.a.Error(592520787,"Invalid MoveTo");r.quadBezierTo(i[a++],i[a++],i[a++],i[a++]);break;case 3:if(!r||a+5>=i.length)throw o.a.Error(592520788,"Invalid CubicBezierTo");r.cubicBezierTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);break;case 4:if(!r||a+3>=i.length)throw o.a.Error(592520789,"Invalid Arc of ellipse");r.arcTo(i[a++],i[a++],i[a++]*s,i[a++]*s);break;case 5:if(!r)throw o.a.Error(592520790,"All paths should start with a MoveTo");r.close(),n.push(r),r=void 0}return r&&n.push(r),n}class p{get currentFigure(){return this.m_figures[this.m_figures.length-1]}get figures(){return this.m_figures}newFigure(){this.currentFigure.getPointCount()>0&&this.m_figures.push(new m([],!1,this.format))}get changeTracker(){return this.m_changeTracker}constructor(e,t){this.m_changeTracker=new l.a,this.bounds=e,this.format=t,this.pointDataSize=h(t),this.m_figures=[new m([],!1,t)]}}function g(e){let t=void 0;for(const i of e){if(!i.cachedBounds){const e=i.points.length/i.pointDataSize;if(e<1)return;let t=i.points[0],n=t,r=i.points[1],o=r;for(let s=0;s<e;s++){const l=s*i.pointDataSize,d=(s-1+e)%e*i.pointDataSize,c=(s+1)%e*i.pointDataSize;let h,u,m;i.format&a.type?(h=i.points[l+2],u=i.points[d+2],m=i.points[c+2]):h=u=m=1;const f=i.points[l],p=i.points[l+1];if(1==h&&1==m)t=f<t?f:t,n=f>n?f:n,r=p<r?p:r,o=p>o?p:o;else if(1==u&&2==h&&1==m){const e=i.points[d],a=i.points[d+1],s=i.points[c],l=i.points[c+1];t=e<t?e:t,n=e>n?e:n,r=a<r?a:r,o=a>o?a:o,t=s<t?s:t,n=s>n?s:n,r=l<r?l:r,o=l>o?l:o;const h=(e-f)/(e+s-2*f);if(0<h&&h<1){const i=h*h,d=e*(i-2*h+1)+s*i+2*f*(h-i),c=a*(i-2*h+1)+l*i+2*p*(h-i);t=d<t?d:t,n=d>n?d:n,r=c<r?c:r,o=c>o?c:o}const u=(a-p)/(a+l-2*p);if(0<u&&u<1){const i=u*u,d=e*(i-2*u+1)+s*i+2*f*(u-i),c=a*(i-2*u+1)+l*i+2*p*(u-i);t=d<t?d:t,n=d>n?d:n,r=c<r?c:r,o=c>o?c:o}}}i.cachedBounds=new s.d(t,r,n,o)}t=s.d.UnionRect(t,i.cachedBounds)}return t}function _(e){if(1!=e.length)return!1;const t=e[0];if((4!=t.getPointCount()||!t.isClosed||t.isLastPointDuplicated())&&(5!=t.getPointCount()||!t.isClosed||!t.isLastPointDuplicated()))return!1;const i=[t.getPoint(0),t.getPoint(1),t.getPoint(2),t.getPoint(3)],n=new s.d(Math.min(i[0].x,i[1].x,i[2].x,i[3].x),Math.min(i[0].y,i[1].y,i[2].y,i[3].y),Math.max(i[0].x,i[1].x,i[2].x,i[3].x),Math.max(i[0].y,i[1].y,i[2].y,i[3].y));for(let e=0;e<4;e++){const t=i[e],r=i[(e+1)%4];if(t.x!=n.left&&t.x!=n.right||t.y!=n.top&&t.y!=n.bottom||t.x!=r.x&&t.y!=r.y)return!1}return!0}},,function(e,t,i){"use strict";var n=i(8);i.d(t,"c",(function(){return n.b})),i.d(t,"g",(function(){return n.c})),i.d(t,"h",(function(){return n.d})),i.d(t,"k",(function(){return n.f})),i.d(t,"n",(function(){return n.h})),i.d(t,"p",(function(){return n.j}));var r=i(89);i.d(t,"m",(function(){return r.a})),i.d(t,"r",(function(){return r.b})),i.d(t,"s",(function(){return r.c}));var a=i(160);i.d(t,"i",(function(){return a.a}));var s=i(161);i.d(t,"l",(function(){return s.a})),i(102);var o=i(156);i.d(t,"e",(function(){return o.a}));var l=i(81);i.d(t,"a",(function(){return l.a})),i(84);var d=i(157);i.d(t,"b",(function(){return d.a}));var c=i(158);i.d(t,"q",(function(){return c.a}));var h=i(143);i.d(t,"d",(function(){return h.a}));var u=i(162);i.d(t,"o",(function(){return u.a}));var m=i(92);i.d(t,"f",(function(){return m.a}));var f=i(163);i.d(t,"j",(function(){return f.a})),i(121),i(169)},function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}));var n=i(6),r=i(20);class a{getHash(){return this.m_elements.map(e=>e.changeTracker.currentUniqueId).join(",")}get changeTracker(){return this.m_changeTracker}get length(){return this.m_elements.length}get elements(){return this.m_elements}set elements(e){this.removeAll();for(let t of e)this.push(t)}getAt(e){if(e<0||e>=this.elements.length)throw n.a.Error(592520775,"Out of range");return this.m_elements[e]}setAt(e,t){this.deferTracking||(s.RemoveListener(this.getAt(e).changeTracker,this.m_changeTracker),s.AddListener(t.changeTracker,this.m_changeTracker)),this.m_elements[e]=t}push(e){this.deferTracking||s.AddListener(e.changeTracker,this.m_changeTracker),this.m_elements.push(e)}insertAt(e,t){this.deferTracking||s.AddListener(t.changeTracker,this.m_changeTracker),this.m_elements.splice(e,0,t)}removeAll(){if(!this.deferTracking)for(let e of this.m_elements)s.RemoveListener(e.changeTracker,this.m_changeTracker);this.m_elements=[]}removeAt(e){this.deferTracking||s.RemoveListener(this.getAt(e).changeTracker,this.m_changeTracker),this.m_elements.splice(e,1)}constructor(e,t=!1){this.m_changeTracker=new s,this.deferTracking=t,this.m_changeTracker=new s(t?this.getHash:void 0),this.m_elements=[],e&&(this.elements=e)}}class s{get version(){return this.m_getDeferedHashFunction&&this.verifyDeferedHash(),this.m_version}get currentUniqueId(){return this.m_getDeferedHashFunction&&this.verifyDeferedHash(),this.m_currentUniqueId}get listenerCount(){var e,t;return(null===(e=this.m_weakListeners)||void 0===e?void 0:e.length)||(null===(t=this.m_listeners)||void 0===t?void 0:t.length)||0}verifyDeferedHash(){if(this.m_getDeferedHashFunction){const e=this.m_getDeferedHashFunction();e!=this.m_deferedHash&&(this.notifyChange(),this.m_deferedHash=e)}}notifyChange(){if(this.m_version++,this.m_currentUniqueId=this.trackerId+"v"+this.m_version,this.m_weakListeners){const t=this.m_weakListeners.length;this.m_weakListeners=this.m_weakListeners.filter(e=>null!=e.deref()),r.k&&t!=this.m_weakListeners.length&&n.a.Message(525337748,`ChangeTracker detaching ${t-this.m_weakListeners.length} zombie dependencies`);for(const t of this.m_weakListeners){var e;null===(e=t.deref())||void 0===e||e.notifyChange()}}else if(this.m_listeners)for(const e of this.m_listeners)e.notifyChange()}replaceListener(e,t){e!=t&&(e&&s.RemoveListener(e.changeTracker,this),t&&s.AddListener(t.changeTracker,this))}static AddListener(e,t){if(e)if(e.m_weakListeners){if(void 0===e.m_weakListeners.find(e=>e.deref()===t)){if("undefined"==typeof WeakRef)throw n.a.Error(525337749,"WeakRef not supported");e.m_weakListeners.push(new WeakRef(t)),t.notifyChange()}}else{if(!e.m_listeners)throw n.a.Error(525337750,"No dependency array");-1==e.m_listeners.indexOf(t)&&(e.m_listeners.push(t),t.notifyChange())}}static RemoveListener(e,t){if(e)if(e.m_weakListeners)e.m_weakListeners=e.m_weakListeners.filter(e=>e.deref()!=t),t.notifyChange();else if(e.m_listeners){const i=e.m_listeners.indexOf(t);-1!=i&&(e.m_listeners.splice(i,1),t.notifyChange())}}constructor(e){this.trackerId=s.s_nextUniqueId++,this.m_version=0,this.m_getDeferedHashFunction=e,this.m_currentUniqueId=this.trackerId+"v0",r.j&&Object(r.i)()?this.m_weakListeners=[]:this.m_listeners=[]}}s.s_nextUniqueId=1},function(e,t,i){"use strict";i.d(t,"l",(function(){return o})),i.d(t,"d",(function(){return k})),i.d(t,"e",(function(){return w})),i.d(t,"c",(function(){return u})),i.d(t,"f",(function(){return f})),i.d(t,"h",(function(){return p})),i.d(t,"a",(function(){return g})),i.d(t,"k",(function(){return b})),i.d(t,"b",(function(){return z})),i.d(t,"i",(function(){return Z})),i.d(t,"g",(function(){return ee})),i.d(t,"j",(function(){return ie}));var n=i(9),r=i(4),a=i(1);const s={};function o(e){e.logger&&n.a.setLogger(e.logger),e.settings&&a.a.load(e.settings?e.settings.slideshowcore:{}),e.disabledChangeGates&&r.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.anim=s)}var l,d,c,h,u,m,f,p,g,_,S,v,y,T,b;!function(e){e[e.Unset=0]="Unset",e[e.Double=1]="Double",e[e.String=2]="String",e[e.Color=3]="Color",e[e.Image=4]="Image",e[e.Array=5]="Array",e[e.Point=6]="Point",e[e.Filter=7]="Filter"}(l||(l={})),function(e){e[e.FIRST=0]="FIRST",e[e.UNKNOWN=1]="UNKNOWN",e[e.FACTOR_FIRST=2]="FACTOR_FIRST",e[e.NUMBER=3]="NUMBER",e[e.SYMBOL=4]="SYMBOL",e[e.QUOTE=5]="QUOTE",e[e.PROGRESS=6]="PROGRESS",e[e.EDITVAL=7]="EDITVAL",e[e.PARAM_FIRST=8]="PARAM_FIRST",e[e.SIN=9]="SIN",e[e.COS=10]="COS",e[e.TAN=11]="TAN",e[e.ASIN=12]="ASIN",e[e.ACOS=13]="ACOS",e[e.ATAN=14]="ATAN",e[e.SQRT=15]="SQRT",e[e.EXP=16]="EXP",e[e.LN=17]="LN",e[e.ABS=18]="ABS",e[e.SINH=19]="SINH",e[e.COSH=20]="COSH",e[e.TANH=21]="TANH",e[e.CEIL=22]="CEIL",e[e.FLOOR=23]="FLOOR",e[e.RAND=24]="RAND",e[e.RAD=25]="RAD",e[e.DEG=26]="DEG",e[e.TWO_PARAMS_FIRST=27]="TWO_PARAMS_FIRST",e[e.MIN=28]="MIN",e[e.MAX=29]="MAX",e[e.PARAM_LAST=30]="PARAM_LAST",e[e.FACTOR_LAST=31]="FACTOR_LAST",e[e.ADD=32]="ADD",e[e.SUB=33]="SUB",e[e.MUL=34]="MUL",e[e.DIV=35]="DIV",e[e.POW=36]="POW",e[e.MOD=37]="MOD",e[e.COND_FIRST=38]="COND_FIRST",e[e.NOT=39]="NOT",e[e.GT=40]="GT",e[e.GTE=41]="GTE",e[e.LT=42]="LT",e[e.LTE=43]="LTE",e[e.EQ=44]="EQ",e[e.NEQ=45]="NEQ",e[e.AND=46]="AND",e[e.OR=47]="OR",e[e.COND=48]="COND",e[e.ALT=49]="ALT",e[e.COND_LAST=50]="COND_LAST",e[e.COMMA=51]="COMMA",e[e.LPAR=52]="LPAR",e[e.RPAR=53]="RPAR",e[e.LBRACE=54]="LBRACE",e[e.RBRACE=55]="RBRACE",e[e.LCURL=56]="LCURL",e[e.RCURL=57]="RCURL",e[e.LAST=58]="LAST"}(d||(d={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.COND=1]="COND",e[e.OR=2]="OR",e[e.AND=3]="AND",e[e.EQNEQ=4]="EQNEQ",e[e.GTLT=5]="GTLT",e[e.ADDSUB=6]="ADDSUB",e[e.MULDIV=7]="MULDIV",e[e.POWER=8]="POWER",e[e.UNARY=9]="UNARY",e[e.FACTOR=10]="FACTOR"}(c||(c={}));class w{}w.Undefined=-1,w.RepeatForever=-1,w.MainTimelineId="0_anim",w.RepeatUntilClick=-2,w.RepeatUntilEnd=-1,w.Zoom_InFromCenterFactor=.5,w.Zoom_InSlightlyScaleInit=2/3,w.Zoom_OutScaleInit=3,w.Zoom_OutFromBottomScaleFactor=5,w.Zoom_OutSlightlyScaleInit=5/4,w.Boomerang_XOffs=500,w.Boomerang_YOffs1=-200,w.Boomerang_YOffs2=100,w.BoomerangRot=-Math.PI/2,w.Float_XOffs1=350,w.Float_XOffs2=-40,w.Float_YOffs1=-250,w.Float_YOffs2=60,w.FloatRot=-Math.PI/2,w.GrownAndTurn_ScaleInit=.25,w.GrowAndTurn_Rotations=Math.PI/2,w.Ascend_Offs=60,w.Descend_Offs=-60,w.PinWheel_Rotations=3*Math.PI,w.RiseUp_YOffs1=600,w.RiseUp_YOffs2=-20,w.RiseUp_Seg1Fraction=.9,w.Swish_DropFraction=.6,w.Swish_BounceOffs=-40,w.Swish_Theta=-Math.PI/6,w.ThinLine_XOffs=-400,w.ThinLine_HInit=.05,w.ThinLine_WInit=1.4,w.Spinner_Rotations=1*Math.PI,w.Spinner_ScaleInit=.25,w.Whip_MidScale=1.1,w.Whip_XOffs=300,w.Unfold_XOffs=-200,w.Sling_Rot=Math.PI/2,w.Sling_XMid_Offs=-100,w.ExpandWidthFactor=.5,w.CompressWidthFactor=1.75,w.Zip_YOffs_Ratio=.85,w.Zip_Midscale=2.5,w.Glide_XOffs=-40,w.Flip_Rotations=4*Math.PI,w.BezierLengthEstimateDivisions=10,w.Blink_Alpha=0,w.Shimmer_Theta=Math.PI/8,w.Wave_Theta=-Math.PI/8,w.Wave_YOffs=-100,w.FlashBulb_ScaleOffs=1.1,w.FlashBulb_Alpha=.2,w.GrowShrink_DefaultDuration=200,function(e){e[e.None=0]="None",e[e.Constant=1]="Constant",e[e.Linear=2]="Linear",e[e.Bezier=3]="Bezier",e[e.VisTrack=4]="VisTrack",e[e.SmoothHelper=5]="SmoothHelper",e[e.ConstantObject=6]="ConstantObject"}(h||(h={})),function(e){e[e.None=0]="None",e[e.Src=1]="Src",e[e.Html=2]="Html",e[e.NativeW=3]="NativeW",e[e.NativeH=4]="NativeH",e[e.ScaleW=5]="ScaleW",e[e.ScaleH=6]="ScaleH",e[e.CropL=7]="CropL",e[e.CropT=8]="CropT",e[e.CropR=9]="CropR",e[e.CropB=10]="CropB",e[e.PosX=11]="PosX",e[e.PosY=12]="PosY",e[e.Alpha=13]="Alpha",e[e.Rotate=14]="Rotate",e[e.Visible=15]="Visible",e[e.RenderAs=16]="RenderAs",e[e.MediaProperties=17]="MediaProperties",e[e.ImageId=43]="ImageId",e[e.ShapeId=44]="ShapeId",e[e.ChildShapeId=45]="ChildShapeId",e[e.ObjectRotationX=46]="ObjectRotationX",e[e.ObjectRotationY=47]="ObjectRotationY",e[e.ObjectRotationZ=48]="ObjectRotationZ",e[e.ObjectScaleX=49]="ObjectScaleX",e[e.ObjectScaleY=50]="ObjectScaleY",e[e.ObjectScaleZ=51]="ObjectScaleZ",e[e.ObjectTranslateX=52]="ObjectTranslateX",e[e.ObjectTranslateY=53]="ObjectTranslateY",e[e.ObjectTranslateZ=54]="ObjectTranslateZ",e[e.ViewRotationX=55]="ViewRotationX",e[e.ViewRotationY=56]="ViewRotationY",e[e.ViewRotationZ=57]="ViewRotationZ",e[e.ViewScaleX=58]="ViewScaleX",e[e.ViewScaleY=59]="ViewScaleY",e[e.ViewScaleZ=60]="ViewScaleZ",e[e.ViewTranslateX=61]="ViewTranslateX",e[e.ViewTranslateY=62]="ViewTranslateY",e[e.ViewTranslateZ=63]="ViewTranslateZ",e[e.LocalRenderingProperties=64]="LocalRenderingProperties",e[e.CropOffsetX=65]="CropOffsetX",e[e.CropOffsetY=66]="CropOffsetY",e[e.Is3DRunning=67]="Is3DRunning",e[e.FadeMaskInfo=68]="FadeMaskInfo",e[e.FadeMaskProgress=69]="FadeMaskProgress",e[e.MediaPlaybackCmd=70]="MediaPlaybackCmd",e[e.EmbeddedAnimId=71]="EmbeddedAnimId",e[e.EmbeddedAnimProgress=72]="EmbeddedAnimProgress",e[e.InkProgress=73]="InkProgress"}(u||(u={})),function(e){e[e.Add=0]="Add",e[e.Mult=1]="Mult",e[e.BaselineOnly=2]="BaselineOnly",e[e.First=3]="First",e[e.Last=4]="Last"}(m||(m={})),function(e){e[e.Entrance=0]="Entrance",e[e.Exit=1]="Exit",e[e.MotionPath=2]="MotionPath",e[e.Emphasis=3]="Emphasis",e[e.Media=4]="Media"}(f||(f={})),function(e){e[e.OnClick=0]="OnClick",e[e.WithPrevious=1]="WithPrevious",e[e.AfterPrevious=2]="AfterPrevious"}(p||(p={})),function(e){e[e.None=0]="None",e[e.HideOnNextClick=1]="HideOnNextClick",e[e.HideImmediatelyAfter=2]="HideImmediatelyAfter"}(g||(g={})),function(e){e[e.None=0]="None",e[e.ChangeFillColor=1]="ChangeFillColor",e[e.ChangeFont=2]="ChangeFont",e[e.ChangeFontColor=3]="ChangeFontColor",e[e.ChangeFontSize=4]="ChangeFontSize",e[e.ChangeFontStyle=5]="ChangeFontStyle",e[e.GrowShrink=6]="GrowShrink",e[e.ChangeLineColor=7]="ChangeLineColor",e[e.Spin=8]="Spin",e[e.Transparency=9]="Transparency",e[e.BoldFlash=10]="BoldFlash",e[e.Blast=14]="Blast",e[e.BoldReveal=15]="BoldReveal",e[e.BrushOnColor=16]="BrushOnColor",e[e.BrushOnUnderline=18]="BrushOnUnderline",e[e.ColorBlend=19]="ColorBlend",e[e.ColorWave=20]="ColorWave",e[e.ComplementaryColor=21]="ComplementaryColor",e[e.ComplementaryColor2=22]="ComplementaryColor2",e[e.ContrastingColor=23]="ContrastingColor",e[e.Darken=24]="Darken",e[e.Desaturate=25]="Desaturate",e[e.FlashBulb=26]="FlashBulb",e[e.Flicker=27]="Flicker",e[e.GrowWithColor=28]="GrowWithColor",e[e.Lighten=30]="Lighten",e[e.StyleEmphasis=31]="StyleEmphasis",e[e.Teeter=32]="Teeter",e[e.VerticalHighlight=33]="VerticalHighlight",e[e.Wave=34]="Wave",e[e.Blink=35]="Blink",e[e.Shimmer=36]="Shimmer",e[e.Turntable3D=37]="Turntable3D",e[e.Swing3D=38]="Swing3D",e[e.JumpAndTurn3D=39]="JumpAndTurn3D",e[e.Embedded1=100]="Embedded1",e[e.Embedded2=101]="Embedded2",e[e.Embedded3=102]="Embedded3",e[e.Embedded4=103]="Embedded4",e[e.Embedded5=104]="Embedded5",e[e.Embedded6=105]="Embedded6",e[e.Embedded7=106]="Embedded7",e[e.Embedded8=107]="Embedded8",e[e.Embedded9=108]="Embedded9",e[e.Embedded10=109]="Embedded10",e[e.Embedded11=110]="Embedded11",e[e.Embedded12=111]="Embedded12",e[e.Embedded13=112]="Embedded13",e[e.Embedded14=113]="Embedded14",e[e.Embedded15=114]="Embedded15",e[e.Embedded16=115]="Embedded16",e[e.Embedded17=116]="Embedded17",e[e.Embedded18=117]="Embedded18"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Appear=1]="Appear",e[e.Fly=2]="Fly",e[e.Blinds=3]="Blinds",e[e.Box=4]="Box",e[e.Checkerboard=5]="Checkerboard",e[e.Circle=6]="Circle",e[e.Crawl=7]="Crawl",e[e.Diamond=8]="Diamond",e[e.Dissolve=9]="Dissolve",e[e.Fade=10]="Fade",e[e.FlashOnce=11]="FlashOnce",e[e.Peek=12]="Peek",e[e.Plus=13]="Plus",e[e.RandomBars=14]="RandomBars",e[e.Spiral=15]="Spiral",e[e.Split=16]="Split",e[e.Stretch=17]="Stretch",e[e.Strips=18]="Strips",e[e.Swivel=19]="Swivel",e[e.Wedge=20]="Wedge",e[e.Wheel=21]="Wheel",e[e.Wipe=22]="Wipe",e[e.Zoom=23]="Zoom",e[e.RandomEffects=24]="RandomEffects",e[e.Boomerang=25]="Boomerang",e[e.Bounce=26]="Bounce",e[e.ColorReveal=27]="ColorReveal",e[e.Credits=28]="Credits",e[e.EaseIn=29]="EaseIn",e[e.Float=30]="Float",e[e.GrowAndTurn=31]="GrowAndTurn",e[e.Lightspeed=34]="Lightspeed",e[e.Pinwheel=35]="Pinwheel",e[e.RiseUp=37]="RiseUp",e[e.Swish=38]="Swish",e[e.ThinLine=39]="ThinLine",e[e.Unfold=40]="Unfold",e[e.Whip=41]="Whip",e[e.Ascend=42]="Ascend",e[e.CenterRevolve=43]="CenterRevolve",e[e.FadedSwivel=45]="FadedSwivel",e[e.Descend=47]="Descend",e[e.Sling=48]="Sling",e[e.Spinner=49]="Spinner",e[e.Compress=50]="Compress",e[e.Zip=51]="Zip",e[e.Arcup=52]="Arcup",e[e.FadedZoom=53]="FadedZoom",e[e.Glide=54]="Glide",e[e.Expand=55]="Expand",e[e.Flip=56]="Flip",e[e.Fold=58]="Fold",e[e.Arrive3D=60]="Arrive3D",e[e.FlyIn3D=61]="FlyIn3D",e[e.Draw=63]="Draw",e[e.Ink=73]="Ink"}(S||(S={})),function(e){e[e.None=0]="None",e[e.Play=1]="Play",e[e.Pause=2]="Pause",e[e.Stop=3]="Stop",e[e.PlayFromBookmark=4]="PlayFromBookmark"}(v||(v={})),function(e){e[e.uniform=0]="uniform",e[e.blinds=1]="blinds",e[e.box=2]="box",e[e.checkerBoard=3]="checkerBoard",e[e.circle=4]="circle",e[e.diamond=5]="diamond",e[e.dissolve=6]="dissolve",e[e.plus=7]="plus",e[e.randomBars=8]="randomBars",e[e.split=9]="split",e[e.strips=10]="strips",e[e.wedge=11]="wedge",e[e.wheel=12]="wheel",e[e.draw=13]="draw"}(y||(y={})),function(e){e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.Bottom=4]="Bottom",e[e.Left=8]="Left",e[e.TopRight=3]="TopRight",e[e.TopLeft=9]="TopLeft",e[e.BottomRight=6]="BottomRight",e[e.BottomLeft=12]="BottomLeft",e[e.In_=16]="In_",e[e.Out=32]="Out",e[e.Ppt_ZoomIn=16]="Ppt_ZoomIn",e[e.Ppt_ZoomOut=32]="Ppt_ZoomOut",e[e.Ppt_ZoomSlightly=256]="Ppt_ZoomSlightly",e[e.Ppt_ZoomCenter=512]="Ppt_ZoomCenter",e[e.Stretch_FromTop=1]="Stretch_FromTop",e[e.Stretch_FromRight=2]="Stretch_FromRight",e[e.Stretch_FromBottom=4]="Stretch_FromBottom",e[e.Stretch_FromLeft=8]="Stretch_FromLeft",e[e.Stretch_Across=10]="Stretch_Across",e[e.Swivel_Vertical=5]="Swivel_Vertical",e[e.Swivel_Horizontal=10]="Swivel_Horizontal",e[e.ComplexClip_BlindsHoriz=10]="ComplexClip_BlindsHoriz",e[e.ComplexClip_BlindsVert=5]="ComplexClip_BlindsVert",e[e.ComplexClip_PlusIn=16]="ComplexClip_PlusIn",e[e.ComplexClip_PlusOut=32]="ComplexClip_PlusOut",e[e.ComplexClip_StripsLeftDown=12]="ComplexClip_StripsLeftDown",e[e.ComplexClip_StripsLeftUp=9]="ComplexClip_StripsLeftUp",e[e.ComplexClip_StripsRightDown=6]="ComplexClip_StripsRightDown",e[e.ComplexClip_StripsRightUp=3]="ComplexClip_StripsRightUp",e[e.ComplexClip_BoxIn=16]="ComplexClip_BoxIn",e[e.ComplexClip_BoxOut=32]="ComplexClip_BoxOut",e[e.ComplexClip_CheckerboardAcross=10]="ComplexClip_CheckerboardAcross",e[e.ComplexClip_CheckerboardDown=5]="ComplexClip_CheckerboardDown",e[e.ComplexClip_RandomBarsHoriz=10]="ComplexClip_RandomBarsHoriz",e[e.ComplexClip_RandomBarsVert=5]="ComplexClip_RandomBarsVert",e[e.ComplexClip_SplitHorizIn=26]="ComplexClip_SplitHorizIn",e[e.ComplexClip_SplitHorizOut=42]="ComplexClip_SplitHorizOut",e[e.ComplexClip_SplitVertIn=21]="ComplexClip_SplitVertIn",e[e.ComplexClip_SplitVertOut=37]="ComplexClip_SplitVertOut",e[e.ComplexClip_WipeUp=1]="ComplexClip_WipeUp",e[e.ComplexClip_WipeDown=4]="ComplexClip_WipeDown",e[e.ComplexClip_WipeLeft=8]="ComplexClip_WipeLeft",e[e.ComplexClip_WipeRight=2]="ComplexClip_WipeRight",e[e.ComplexClip_Wheel1=1]="ComplexClip_Wheel1",e[e.ComplexClip_Wheel2=2]="ComplexClip_Wheel2",e[e.ComplexClip_Wheel3=3]="ComplexClip_Wheel3",e[e.ComplexClip_Wheel4=4]="ComplexClip_Wheel4",e[e.ComplexClip_Wheel8=8]="ComplexClip_Wheel8",e[e.ComplexClip_CircleIn=16]="ComplexClip_CircleIn",e[e.ComplexClip_CircleOut=32]="ComplexClip_CircleOut",e[e.ComplexClip_DiamondIn=16]="ComplexClip_DiamondIn",e[e.ComplexClip_DiamondOut=32]="ComplexClip_DiamondOut",e[e.Zoom_In=0]="Zoom_In",e[e.Zoom_InFromCenter=1]="Zoom_InFromCenter",e[e.Zoom_InSlightly=2]="Zoom_InSlightly",e[e.Zoom_Out=3]="Zoom_Out",e[e.Zoom_OutFromBottom=4]="Zoom_OutFromBottom",e[e.Zoom_OutSlightly=5]="Zoom_OutSlightly",e[e.ObjRotLeft=2]="ObjRotLeft",e[e.ObjRotRight=4]="ObjRotRight",e[e.ObjRotBack=8]="ObjRotBack",e[e.ObjRotFront=16]="ObjRotFront",e[e.ObjRotCounterclockwise=32]="ObjRotCounterclockwise",e[e.ObjRotClockwise=64]="ObjRotClockwise",e[e.ViewRotRight=128]="ViewRotRight",e[e.ViewRotLeft=256]="ViewRotLeft",e[e.ViewRotUp=512]="ViewRotUp",e[e.ViewRotDown=1024]="ViewRotDown",e[e.ViewRotClockwise=2048]="ViewRotClockwise",e[e.ViewRotCounterclockwise=4096]="ViewRotCounterclockwise",e[e.ObjTransLeft=8192]="ObjTransLeft",e[e.ObjTransRight=16384]="ObjTransRight",e[e.ObjTransUp=32768]="ObjTransUp",e[e.ObjTransDown=65536]="ObjTransDown",e[e.ObjTransBack=131072]="ObjTransBack",e[e.ObjTransFront=262144]="ObjTransFront",e[e.ViewTransRight=524288]="ViewTransRight",e[e.ViewTransLeft=1048576]="ViewTransLeft",e[e.ViewTransUp=2097152]="ViewTransUp",e[e.ViewTransDown=4194304]="ViewTransDown",e[e.ViewTransBack=8388608]="ViewTransBack",e[e.ViewTransFront=16777216]="ViewTransFront",e[e.DrawProgress=0]="DrawProgress",e[e.DrawProgressAllAtOnce=1]="DrawProgressAllAtOnce"}(T||(T={}));class C{}C.Transpose=1,C.Invert=2,C.FlipHorz=4,C.FlipVert=8,C.IsDistributedByLength=16,C.EffectMap=[{FxId:S.Split,Dir:T.ComplexClip_SplitVertIn,Preset:y.split,Param:0,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Split,Dir:T.ComplexClip_SplitVertOut,Preset:y.split,Param:0,EntFlags:C.Invert,ExitFlags:0},{FxId:S.Split,Dir:T.ComplexClip_SplitHorizIn,Preset:y.split,Param:0,EntFlags:C.Transpose,ExitFlags:C.Transpose|C.Invert},{FxId:S.Split,Dir:T.ComplexClip_SplitHorizOut,Preset:y.split,Param:0,EntFlags:C.Transpose|C.Invert,ExitFlags:C.Transpose},{FxId:S.Blinds,Dir:T.ComplexClip_BlindsHoriz,Preset:y.blinds,Param:6,EntFlags:C.Transpose,ExitFlags:C.Transpose},{FxId:S.Blinds,Dir:T.ComplexClip_BlindsVert,Preset:y.blinds,Param:6,EntFlags:0,ExitFlags:0},{FxId:S.Checkerboard,Dir:T.ComplexClip_CheckerboardAcross,Preset:y.checkerBoard,Param:6,EntFlags:0,ExitFlags:0},{FxId:S.Checkerboard,Dir:T.ComplexClip_CheckerboardDown,Preset:y.checkerBoard,Param:6,EntFlags:C.Transpose,ExitFlags:C.Transpose},{FxId:S.Circle,Dir:T.ComplexClip_CircleIn,Preset:y.circle,Param:0,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Circle,Dir:T.ComplexClip_CircleOut,Preset:y.circle,Param:0,EntFlags:C.Invert,ExitFlags:0},{FxId:S.Diamond,Dir:T.ComplexClip_DiamondIn,Preset:y.diamond,Param:0,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Diamond,Dir:T.ComplexClip_DiamondOut,Preset:y.diamond,Param:0,EntFlags:C.Invert,ExitFlags:0},{FxId:S.Plus,Dir:T.ComplexClip_PlusIn,Preset:y.plus,Param:0,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Plus,Dir:T.ComplexClip_PlusOut,Preset:y.plus,Param:0,EntFlags:C.Invert,ExitFlags:0},{FxId:S.Dissolve,Dir:0,Preset:y.dissolve,Param:0,EntFlags:0,ExitFlags:0},{FxId:S.Fade,Dir:0,Preset:y.uniform,Param:0,EntFlags:0,ExitFlags:0},{FxId:S.RandomBars,Dir:T.ComplexClip_RandomBarsHoriz,Preset:y.randomBars,Param:0,EntFlags:C.Transpose,ExitFlags:C.Transpose},{FxId:S.RandomBars,Dir:T.ComplexClip_RandomBarsVert,Preset:y.randomBars,Param:0,EntFlags:0,ExitFlags:0},{FxId:S.Box,Dir:T.ComplexClip_BoxIn,Preset:y.box,Param:0,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Box,Dir:T.ComplexClip_BoxOut,Preset:y.box,Param:0,EntFlags:C.Invert,ExitFlags:0},{FxId:S.Strips,Dir:T.ComplexClip_StripsLeftUp,Preset:y.strips,Param:16,EntFlags:C.Invert,ExitFlags:C.Invert},{FxId:S.Strips,Dir:T.ComplexClip_StripsLeftDown,Preset:y.strips,Param:16,EntFlags:C.FlipHorz,ExitFlags:C.FlipHorz},{FxId:S.Strips,Dir:T.ComplexClip_StripsRightUp,Preset:y.strips,Param:16,EntFlags:C.FlipVert,ExitFlags:C.FlipVert},{FxId:S.Strips,Dir:T.ComplexClip_StripsRightDown,Preset:y.strips,Param:16,EntFlags:0,ExitFlags:0},{FxId:S.Wedge,Dir:0,Preset:y.wedge,Param:2,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Wheel,Dir:T.ComplexClip_Wheel1,Preset:y.wheel,Param:1,EntFlags:0,ExitFlags:C.FlipHorz},{FxId:S.Wheel,Dir:T.ComplexClip_Wheel2,Preset:y.wheel,Param:2,EntFlags:0,ExitFlags:C.FlipHorz},{FxId:S.Wheel,Dir:T.ComplexClip_Wheel3,Preset:y.wheel,Param:3,EntFlags:0,ExitFlags:C.FlipHorz},{FxId:S.Wheel,Dir:T.ComplexClip_Wheel4,Preset:y.wheel,Param:4,EntFlags:0,ExitFlags:C.FlipHorz},{FxId:S.Wheel,Dir:T.ComplexClip_Wheel8,Preset:y.wheel,Param:8,EntFlags:0,ExitFlags:C.FlipHorz},{FxId:S.Wipe,Dir:T.ComplexClip_WipeUp,Preset:y.blinds,Param:1,EntFlags:C.Transpose,ExitFlags:C.Transpose|C.Invert},{FxId:S.Wipe,Dir:T.ComplexClip_WipeDown,Preset:y.blinds,Param:1,EntFlags:C.Transpose|C.Invert,ExitFlags:C.Transpose},{FxId:S.Wipe,Dir:T.ComplexClip_WipeLeft,Preset:y.blinds,Param:1,EntFlags:0,ExitFlags:C.Invert},{FxId:S.Wipe,Dir:T.ComplexClip_WipeRight,Preset:y.blinds,Param:1,EntFlags:C.Invert,ExitFlags:0},{FxId:S.Draw,Dir:T.DrawProgress,Preset:y.draw,Param:0,EntFlags:C.IsDistributedByLength,ExitFlags:C.IsDistributedByLength},{FxId:S.Draw,Dir:T.DrawProgressAllAtOnce,Preset:y.draw,Param:0,EntFlags:0,ExitFlags:0}],function(e){e[e.MoveTo=0]="MoveTo",e[e.LineTo=1]="LineTo",e[e.CurveTo=2]="CurveTo"}(b||(b={}));class I{registerAnimEvaluator(e){this.m_evaluators.push(e)}mergeWith(e){if(this!==e){if(this.m_aggregateRule===m.BaselineOnly)this.m_aggregateRule=e.AggregateRule;else if(this.m_aggregateRule!==e.AggregateRule)return;for(const t of e.Evaluators)this.registerAnimEvaluator(t)}}get AttrId(){return this.m_id}get Evaluators(){return this.m_evaluators}get AggregateRule(){return this.m_aggregateRule}clearCachedValue(){this.m_fHasCachedValue=!1}constructor(e,t){this.m_id=e,this.m_evaluators=[],this.m_aggregateRule=t,this.m_fHasCachedValue=!1}}class P extends I{fUpdateAggregateValue(e){let t=this.m_baseLineValue;switch(this.m_aggregateRule){case m.Add:for(const i of this.m_evaluators)t+=i.evaluate(e,0);break;case m.Mult:for(const i of this.m_evaluators)t*=i.evaluate(e,this.m_baseLineValue);break;case m.First:for(const i of this.m_evaluators)if(t=i.evaluate(e,this.m_baseLineValue),t!==this.m_baseLineValue)break;break;case m.Last:for(let i=this.m_evaluators.length-1;i>=0&&(t=this.m_evaluators[i].evaluate(e,this.m_baseLineValue),t===this.m_baseLineValue);i-=1);break;case m.BaselineOnly:}const i=this.m_cachedValue!==t||!this.m_fHasCachedValue;return i&&(this.m_cachedValue=t,this.m_fHasCachedValue=!0),i}get Value(){return this.m_fHasCachedValue?this.m_cachedValue:this.m_baseLineValue}constructor(e,t,i){super(e,i),this.m_baseLineValue=t}}class E extends I{fUpdateAggregateValue(e){let t=this.m_baselineValue;switch(this.m_aggregateRule){case m.First:for(const i of this.m_evaluators)if(i.EvalId===h.ConstantObject&&(t=i.evaluateObject(e,this.m_baselineValue),t!==this.m_baselineValue))break;break;case m.Last:for(let i=this.m_evaluators.length-1;i>=0;i-=1){const n=this.m_evaluators[i];if(n.EvalId===h.ConstantObject&&(t=n.evaluateObject(e,this.m_baselineValue),t!==this.m_baselineValue))break}break;case m.Add:case m.Mult:case m.BaselineOnly:}const i=this.m_cachedValue!==t||!this.m_fHasCachedValue;return i&&(this.m_cachedValue=t,this.m_fHasCachedValue=!0),i}get Value(){return this.m_fHasCachedValue?this.m_cachedValue:this.m_baselineValue}constructor(e,t,i){super(e,i),this.m_baselineValue=t,this.m_cachedValue=null}}var x=i(34);class k{start(e){this.stop(),this.m_requestId=window.requestAnimationFrame(this.loop.bind(this)),this.m_startTimeMs=Date.now()-(e||0),this.events.emit("tick",this.currentTimeMs)}stop(){window.cancelAnimationFrame(this.m_requestId),this.m_pausedTimeMs=0,this.events.emit("notRunning",null)}pause(){this.stop(),this.m_pausedTimeMs=Date.now()}resume(){const e=this.m_pausedTimeMs?this.m_pausedTimeMs-this.m_startTimeMs:0;this.start(e)}get currentTimeMs(){return Date.now()-this.m_startTimeMs}loop(){this.m_requestId=window.requestAnimationFrame(this.loop.bind(this)),this.events.emit("tick",this.currentTimeMs)}constructor(){this.m_startTimeMs=0,this.m_pausedTimeMs=0,this.m_requestId=-1,this.events=new x.EventEmitter}}class M{constructor(e){this.TimeSmoother=null,this.m_clickTimeProvider=e}}class A extends M{checkAndUpdateTimeBounds(e){let t,i=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.Start.ClickNum).ClickTime;if(i===w.Undefined)return!1;if(i+=this.m_evalTimeSpan.Start.Offs,e<i){const e=this.m_numRepeats===w.RepeatForever,t=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.Start.ClickNum+1).ClickTime!==w.Undefined;if(e||!t)return!1}if(this.m_evalTimeSpan.End.Offs===w.Undefined)t=w.Undefined;else{if(this.m_evalTimeSpan.End.ClickNum===w.Undefined?t=i+this.m_evalTimeSpan.End.Offs:(t=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.End.ClickNum).ClickTime,t!==w.Undefined&&(t+=this.m_evalTimeSpan.End.Offs)),t!==w.Undefined&&e>=t){const n=t-i+this.m_repeatGap;if(this.m_numRepeats!==w.RepeatForever&&e>=t+n*this.m_numRepeats)return!1;if((e-t)%n<this.m_repeatGap)return!1}const n=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.SkipClickNum).ClickTime;if(n!==w.Undefined&&e>=n)return!1}return this.m_adjustedStartTime=i,this.m_adjustedEndTime=t,!0}getEquivalentTimeFromRepeatTime(e){if(e<this.m_adjustedEndTime)return e;if(this.m_adjustedEndTime===w.Undefined)return e;const t=this.m_adjustedEndTime-this.m_adjustedStartTime+this.m_repeatGap;return 0===t?e:this.m_adjustedStartTime+(e-this.m_adjustedEndTime)%t-this.m_repeatGap}get TimelineId(){return this.m_timelineId}get TimeSpan(){return this.m_evalTimeSpan}constructor(e,t,i,n,r){super(r),this.m_adjustedStartTime=0,this.m_adjustedEndTime=0,this.m_timelineId=e,this.m_evalTimeSpan=t,this.m_numRepeats=i,this.m_repeatGap=n}}class R extends A{evaluate(e,t){return t}evaluateObject(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkAndUpdateTimeBounds(e)?this.m_value:t}get EvalId(){return h.ConstantObject}constructor(e,t,i,n,r,a){super(e,t,i,n,r),this.m_value=a}}class O extends A{evaluate(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkAndUpdateTimeBounds(e)?this.m_modValue:t}get EvalId(){return h.ConstantObject}constructor(e,t,i,n,r,a){super(e,t,i,n,r),this.m_modValue=a}}class F extends A{evaluate(e,t){if(this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===w.Undefined)return this.m_valRangePair.Val1;const i=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);return this.m_valRangePair.Val1+i*(this.m_valRangePair.Val2-this.m_valRangePair.Val1)}get EvalId(){return h.Linear}constructor(e,t,i,n,r,a){super(e,t,i,n,r),this.m_valRangePair=a}}class D extends A{evaluate(e,t){if(this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===w.Undefined)return this.m_values[0];let i=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);this.m_isReverse&&(i=1-i);let n=0;for(n=0;n<this.m_times.length-1&&!(i<=this.m_times[n+1]);n+=1);if(n===this.m_times.length-1)return this.m_values[n];const r=this.m_values[n],a=this.m_values[n+1];return i=(i-this.m_times[n])/(this.m_times[n+1]-this.m_times[n]),r+i*(a-r)}get EvalId(){return h.Linear}constructor(e,t,i,n,r,a,s,o){super(e,t,i,n,r),this.m_times=a,this.m_values=s,this.m_isReverse=o}}class L extends A{evaluate(e,t){if(null!=this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===w.Undefined)return this.m_controlValList[0];const i=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);return q.calculateBezierCoordinate(this.m_controlValList[0],this.m_controlValList[1],this.m_controlValList[2],this.m_controlValList[3],i)}get EvalId(){return h.Bezier}constructor(e,t,i,n,r,a){super(e,t,i,n,r),this.m_controlValList=a}}class B extends A{evaluate(e,t){return t}fInRange(e){return this.checkAndUpdateTimeBounds(e)}getEquivalentTime(e){return this.getEquivalentTimeFromRepeatTime(e)}get EvalId(){return h.SmoothHelper}get AdjustedStartTime(){return this.m_adjustedStartTime}get AdjustedEndTime(){return this.m_adjustedEndTime}constructor(e,t,i,n,r){super(e,t,i,n,r)}}class N extends M{evaluate(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkVisTrackMap(e)?t:this.m_modValue}checkVisTrackMap(e){if(null==this.m_resolvedVisTrack){this.m_resolvedVisTrack=[];for(let e=0;e<this.m_visTrack.Length;e+=1){const t=this.m_visTrack.getMarker(e);if(!t)continue;const i=this.m_clickTimeProvider.getClickTime(t.TimelineId,t.ClickNum).ClickTime;let n,r=0;this.m_clickTimeProvider.getClickTime(t.TimelineId,t.ClickNum+1).ClickTime===w.Undefined&&(r=t.Offs),n=i!==w.Undefined?Math.max(0,i)+r:w.Undefined,this.m_resolvedVisTrack.push(new G(n,t.FVisible,e))}this.sortResolvedVisTrack()}for(let t=this.m_resolvedVisTrack.length-1;t>=0;t-=1){const i=this.m_resolvedVisTrack[t];if(i.ResolvedTime!==w.Undefined&&i.ResolvedTime<=e)return i.FVisible}return!(this.m_resolvedVisTrack.length>0)||!this.m_resolvedVisTrack[0].FVisible}sortResolvedVisTrack(){this.m_resolvedVisTrack&&this.m_resolvedVisTrack.sort(G.sortFunction)}onClickListsChanged(){this.m_resolvedVisTrack=void 0}get EvalId(){return h.VisTrack}get VisTrack(){return this.m_visTrack}get ModValue(){return this.m_modValue}constructor(e,t,i){super(i),this.m_visTrack=e,this.m_modValue=t,this.m_resolvedVisTrack=void 0}}class V{get HasOccurred(){return this.ClickTime!==w.Undefined}constructor(e){this.ClickTime=e}}class W{get FStartPath(){return this.m_startPath}get TimeLineId(){return this.m_timelineId}get Click(){return this.m_click}get Offs(){return this.m_offs}get XTarget(){return this.m_xTarget}get YTarget(){return this.m_yTarget}constructor(e,t,i,n,r,a){this.m_startPath=e,this.m_timelineId=t,this.m_click=i,this.m_offs=n,this.m_xTarget=r,this.m_yTarget=a}}class U{get Attributes(){return this.m_attributes}registerAnimAttribute(e,t){for(const t of this.m_attributes)if(t.AttrId===e.AttrId)return void t.mergeWith(e);if(t&&this.m_visAttributeIndex!==w.Undefined)return this.m_attributes.splice(this.m_visAttributeIndex,0,e),void(this.m_visAttributeIndex+=1);this.m_attributes.push(e),e.AttrId===u.Visible&&(this.m_visAttributeIndex=this.m_attributes.length-1)}getRegisteredAttribute(e){for(const t of this.m_attributes){const i=t;if(i.AttrId===e)return i}}aggregateAllAttributesForTime(e){let t=!1;for(const i of this.m_attributes)i.fUpdateAggregateValue(e)&&(t=!0);return t}clearCachedAttributeValues(){for(const e of this.m_attributes)e.clearCachedValue()}getAnimEndTime(){const e=new Map;for(const t of this.m_attributes)for(const i of t.Evaluators)if(i.EvalId===h.VisTrack){const t=i;let n;for(let i=0;i<t.VisTrack.Length;i+=1){const r=t.VisTrack.getMarker(i);r&&(n=e.get(r.TimelineId),null==n&&(n={ClickNum:r.ClickNum,Offs:r.Offs},e.set(r.TimelineId,n)),r.ClickNum>=n.ClickNum&&(n.ClickNum=r.ClickNum,r.Offs>=n.Offs&&(n.Offs=r.Offs)))}}else{const t=i;if(null==t.TimeSpan)continue;let n=e.get(t.TimelineId);if(null==n&&(n={ClickNum:t.TimeSpan.Start.ClickNum,Offs:t.TimeSpan.Start.Offs+t.TimeSpan.End.Offs},e.set(t.TimelineId,n)),t.TimeSpan.Start.ClickNum>=n.ClickNum){n.ClickNum=t.TimeSpan.Start.ClickNum;const e=t.TimeSpan.Start.Offs+t.TimeSpan.End.Offs;e>=n.Offs&&(n.Offs=e)}}return e}constructor(e,t){this.Id=e,this.Shape=t,this.m_attributes=[],this.m_visAttributeIndex=w.Undefined}}class z{static getAnimAttributeValue(e,t,i){for(const i of e)if(i.AttrId===t){if(i instanceof P)return i.Value;if(i instanceof E)return i.Value}return i}}class H{constructor(e,t,i,n){this.FVisible=e,this.TimelineId=t,this.ClickNum=i,this.Offs=n}}class G{static sortFunction(e,t){return e.ResolvedTime!==t.ResolvedTime?e.ResolvedTime===w.Undefined&&t.ResolvedTime!==w.Undefined?1:t.ResolvedTime===w.Undefined&&e.ResolvedTime!==w.Undefined||e.ResolvedTime<t.ResolvedTime?-1:1:e.MarkerIndex<t.MarkerIndex?-1:t.MarkerIndex<e.MarkerIndex?1:0}constructor(e,t,i){this.ResolvedTime=e,this.FVisible=t,this.MarkerIndex=i}}class j{get Length(){return this.m_track.length}getMarker(e){return e<this.m_track.length?this.m_track[e]:null}becomesVisibleAt(e,t,i){this.m_track.push(new H(!0,e,t,i))}becomesInvisibleAt(e,t,i){this.m_track.push(new H(!1,e,t,i))}constructor(){this.m_track=[]}}class ${smooth(e){if(!this.m_helperEvaluator.fInRange(e))return e;if(this.m_helperEvaluator.AdjustedEndTime===w.Undefined)return e;const t=this.m_helperEvaluator.AdjustedEndTime-this.m_helperEvaluator.AdjustedStartTime;if(t<=0)return e;const i=(this.m_helperEvaluator.getEquivalentTime(e)-this.m_helperEvaluator.AdjustedStartTime)/t;let n;if(i<this.m_smoothStartFactor)n=this.m_vTarget/2*(i-this.m_tAOverPi*Math.sin(i/this.m_tAOverPi));else if(i>1-this.m_smoothEndFactor){const e=1-i;n=1-this.m_vTarget/2*(e-this.m_tBOverPi*Math.sin(e/this.m_tBOverPi))}else n=i*this.m_vTarget+this.m_linearOffset;return n*t+this.m_helperEvaluator.AdjustedStartTime}constructor(e,t,i,n,r,a,s){this.m_helperEvaluator=new B(e,t,i,n,r),this.m_smoothStartFactor=Math.max(0,Math.min(a,1)),this.m_smoothEndFactor=Math.max(0,Math.min(s,1-this.m_smoothStartFactor)),this.m_vTarget=1/(1-this.m_smoothStartFactor/2-this.m_smoothEndFactor/2),this.m_tAOverPi=this.m_smoothStartFactor/Math.PI,this.m_tBOverPi=this.m_smoothEndFactor/Math.PI,this.m_linearOffset=-this.m_vTarget*this.m_smoothStartFactor/2}}class q{static calculateBezierCoordinate(e,t,i,n,r){const a=e+r*(t-e),s=t+r*(i-t),o=a+r*(s-a);return o+r*(s+r*(i+r*(n-i)-s)-o)}}class Z{getEndTime(e){return this.m_endTimeMap[e]}onClickTimeListsChanged(e){if(this.m_callbackVisEvaluatorList)for(const e of this.m_callbackVisEvaluatorList)e.onClickListsChanged();e&&e()}clearAllClickTimeLists(){this.m_clickTimeListMap=new Map;for(const e of this.m_timelineIdList)this.m_clickTimeListMap[e]=[]}createVisEvaluatorCallbackList(e){const t=[];for(const i of e)for(const e of i.Attributes)if(e.AttrId===u.Visible)for(const i of e.Evaluators)i.EvalId===h.VisTrack&&t.push(i);return t}adjustClickTimeListOnPop(e){for(const t of e)t.HasOccurred&&(t.ClickTime-=Z.c_removeClickTimeAdjustInMs)}setTimeAndCalculate(e){this.m_currentRelativeTime=e;let t=!1;for(const i of this.m_animObjectList)i.aggregateAllAttributesForTime(e)&&(t=!0);return t}forceSlideRedraw(){if(this.m_animObjectList)for(const e of this.m_animObjectList)e.clearCachedAttributeValues()}resetTimeline(e,t){this.m_clickTimeListMap[e]=[],this.onClickTimeListsChanged(t)}hasTimelineFinished(e){const t=this.m_endTimeMap[e];if(null==t)return!1;const i=this.m_clickTimeListMap[e];if(null==i)return!1;if(i.length<t.ClickNum)return!1;if(i.length>t.ClickNum)return!0;if(0===i.length)return 0===t.ClickNum&&this.m_currentRelativeTime>=t.Offs;const n=this.m_currentRelativeTime-i[i.length-1].ClickTime;return t.Offs<n}addTimelineClickInternal(e,t,i){null!=this.m_clickTimeListMap[e]&&(this.m_clickTimeListMap[e].push(new V(t)),this.onClickTimeListsChanged(i))}addTimelineClicks(e,t,i){for(let i=0;i<t;i+=1)this.addTimelineClick(e,void 0);t>0&&this.onClickTimeListsChanged(i)}addTimelineClick(e,t){if(null==this.m_clickTimeListMap)return;const i=this.m_currentRelativeTime;this.addTimelineClickInternal(e,i,t)}removeTimelineClicks(e,t,i){for(let i=0;i<t;i+=1)this.removeTimelineClick(e,void 0);t>0&&this.onClickTimeListsChanged(i)}removeTimelineClick(e,t){if(null==this.m_clickTimeListMap)return;const i=this.m_clickTimeListMap[e];null!=i&&i.length>0&&(i.pop(),this.adjustClickTimeListOnPop(i),this.onClickTimeListsChanged(t))}getTimelineStates(e){if(!this.m_timelineIdList)return null;const t=[];for(const i of this.m_timelineIdList){const n=this.getNumTimelineClicks(i),r=this.getClickTime(i,n).ClickTime;e?t.push({timelineId:i,step:n,lastClickTime:r}):t.push({timelineId:i,step:n})}return t}setTimelineStates(e){for(const t of e){const e=this.m_clickTimeListMap[t.timelineId];if(!e||!this.m_endTimeMap[t.timelineId])continue;const i=e.length,n=this.m_endTimeMap[t.timelineId].ClickNum,r=Math.min(Math.max(t.step,0),n+1);r>i?this.addTimelineClicks(t.timelineId,r-i):r<i&&this.removeTimelineClicks(t.timelineId,i-r),null!=t.lastClickTime&&e.length>0&&(e[e.length-1].ClickTime=t.lastClickTime)}}getNumTimelineClicks(e){if(null==this.m_clickTimeListMap)return 0;const t=this.m_clickTimeListMap[e];return null==t?0:t.length}getClickTime(e,t){if(null==this.m_clickTimeListMap)return new V(w.Undefined);const i=this.m_clickTimeListMap[e];return null==i||t===w.Undefined?new V(w.Undefined):0===t?new V(0):i.length<t?new V(w.Undefined):i[t-1]}initTimeline(e,t,i,n,r){if(null!=t&&0!==t.length){this.m_timelineIdList=t,this.m_animObjectList=e,this.m_callbackVisEvaluatorList=this.createVisEvaluatorCallbackList(e),this.clearAllClickTimeLists();for(const[e,t]of i.entries())if(t)for(let i=0;i<t.ClickNum;i+=1){const n=i===t.ClickNum-1?t.Offs:0;this.addTimelineClickInternal(e,n,void 0)}this.onClickTimeListsChanged(r),this.setTimeAndCalculate(n),this.calculateEndTimes()}}calculateEndTimes(){this.m_endTimeMap=new Map;for(const e of this.m_animObjectList)for(const[t,i]of e.getAnimEndTime()){const e=this.m_endTimeMap[t];(null==e||i.ClickNum>e.ClickNum||i.ClickNum===e.ClickNum&&i.Offs>e.Offs)&&(this.m_endTimeMap[t]=i)}null==this.m_endTimeMap[w.MainTimelineId]&&(this.m_endTimeMap[w.MainTimelineId]={ClickNum:0,Offs:0})}constructor(){this.m_currentRelativeTime=0,this.m_animObjectList=[],this.m_clickTimeListMap=new Map,this.m_timelineIdList=[],this.m_endTimeMap=new Map}}Z.c_removeClickTimeAdjustInMs=36e5;var J=i(3),X=i(7);class Y{addEvaluatorConstantAfter(e,t,i,n,r){const a={Start:{ClickNum:i,Offs:n},End:{ClickNum:w.Undefined,Offs:w.Undefined},SkipClickNum:w.Undefined},s=new O(e,a,0,0,this.m_clickTimeProvider,r);t.registerAnimEvaluator(s)}addEvaluatorConstantObjectAfter(e,t,i,n,r){const a={Start:{ClickNum:i,Offs:n},End:{ClickNum:w.Undefined,Offs:w.Undefined},SkipClickNum:w.Undefined},s=new R(e,a,0,0,this.m_clickTimeProvider,r);t.registerAnimEvaluator(s)}addEvaluatorConstantObject(e,t,i,n,r,a,s,o){const l=Y.getRepeatsSkipClick(i+1,s),d=Y.getEvalNumRepeats(s),c={Start:{ClickNum:i,Offs:n},End:{ClickNum:w.Undefined,Offs:r},SkipClickNum:l},h=new R(e,c,d,o,this.m_clickTimeProvider,a);return t.registerAnimEvaluator(h),h}addEvaluatorConstantDuration(e,t,i,n,r,a,s,o){this.addEvaluatorConstantSpan(e,t,i,n,w.Undefined,r,a,s,o)}addEvaluatorConstantSpan(e,t,i,n,r,a,s,o,l){const d=Y.getRepeatsSkipClick(r===w.Undefined?w.Undefined:r+1,o),c=Y.getEvalNumRepeats(o),h=new O(e,{Start:{ClickNum:i,Offs:n},End:{ClickNum:r,Offs:a},SkipClickNum:d},c,l,this.m_clickTimeProvider,s);t.registerAnimEvaluator(h)}addEvaluatorConstantObjectSpan(e,t,i,n,r,a,s,o,l){const d=Y.getRepeatsSkipClick(r===w.Undefined?w.Undefined:r+1,o),c=Y.getEvalNumRepeats(o),h=new R(e,{Start:{ClickNum:i,Offs:n},End:{ClickNum:r,Offs:a},SkipClickNum:d},c,l,this.m_clickTimeProvider,s);t.registerAnimEvaluator(h)}addEvaluatorLinear(e,t,i,n,r,a,s,o,l){const d=Y.getRepeatsSkipClick(i+1,o),c=Y.getEvalNumRepeats(o),h={Start:{ClickNum:i,Offs:n},End:{ClickNum:w.Undefined,Offs:r},SkipClickNum:d},u={Val1:a,Val2:s},m=new F(e,h,c,l,this.m_clickTimeProvider,u);return t.registerAnimEvaluator(m),m}addEvaluatorLinearList(e,t,i,n,r,a,s,o,l,d){const c=Y.getRepeatsSkipClick(i+1,l),h=Y.getEvalNumRepeats(l),u={Start:{ClickNum:i,Offs:n},End:{ClickNum:w.Undefined,Offs:r},SkipClickNum:c},m=new D(e,u,h,d,this.m_clickTimeProvider,a,s,o);return t.registerAnimEvaluator(m),m}addEvaluatorConstantObjectBidir(e,t,i,n,r,a,s,o,l,d){if(this.m_visTrackTable[e])return o?(this.m_visTrackTable[e].becomesVisibleAt(t,n,r),this.addEvaluatorConstantObject(t,i,n,r,a,s,l,d)):(l!==w.RepeatUntilEnd&&this.m_visTrackTable[e].becomesInvisibleAt(t,ie.getRepeatsClick(n,l),ie.getRepeatsOffs(r,a+d,l)),this.addEvaluatorConstantObject(t,i,n,r+d,a,s,l,d))}addEvaluatorVisLinearBidir(e,t,i,n,r,a,s,o,l,d,c){if(!this.m_visTrackTable[e])return;let h;return l?(this.m_visTrackTable[e].becomesVisibleAt(t,n,r),h=this.addEvaluatorLinear(t,i,n,r,a,o,s,d,c)):(h=this.addEvaluatorLinear(t,i,n,r+c,a,s,o,d,c),d!==w.RepeatUntilEnd&&this.m_visTrackTable[e].becomesInvisibleAt(t,ie.getRepeatsClick(n,d),ie.getRepeatsOffs(r,a+c,d))),h}addTimeSmoother(e,t,i,n,r,a,s,o,l){if(t>0||i>0){const d={Start:{ClickNum:r,Offs:a},End:{ClickNum:w.Undefined,Offs:s},SkipClickNum:Y.getRepeatsSkipClick(r+1,o)},c=new $(n,d,Y.getEvalNumRepeats(o),l,this.m_clickTimeProvider,t,i);e.TimeSmoother=c}}addEvaluatorVisTrack(e,t){return new N(e,t,this.m_clickTimeProvider)}addEvaluatorsForSegmentList(e,t,i,r,a,s,o){if(null===o||0===o.length)return void n.a.sendTraceTag(508822157,J.a.msoulscat_Wac_PptAnimation,X.a.Error,"Bad segList input to AddEvaluatorsForSegmentList.");const l=this.m_visTrackTable[e];if(null==l)return void n.a.sendTraceTag(508822156,J.a.msoulscat_Wac_PptAnimation,X.a.Error,`Bad visTrack for aoId ${e} at AddEvaluatorsForSegmentList.`);let d;if(a){d=o[0],l.becomesVisibleAt(t,r,d.Offs);for(const e of o)this.addEvaluatorLinear(t,i,r,e.Offs,e.Dur,e.OffsVal,e.BaseVal,s,e.SegOffs)}else{const e=o[0];d=o[o.length-1];const n=d.Offs+d.Dur;for(let a=o.length-1;a>=0;a-=1){d=o[a];const l=n-(d.Offs-e.Offs)-d.Dur;this.addEvaluatorLinear(t,i,r,l,d.Dur,d.BaseVal,d.OffsVal,s,d.SegOffs)}if(s!==w.RepeatUntilEnd){const i=e.Offs,a=n-i;l.becomesInvisibleAt(t,ie.getRepeatsClick(r,s),ie.getRepeatsOffs(i,a,s))}}}addEvaluatorBezier(e,t,i,n,r,a,s,o){const l=Y.getRepeatsSkipClick(i+1,s),d=Y.getEvalNumRepeats(s),c={Start:{ClickNum:i,Offs:n},End:{ClickNum:w.Undefined,Offs:r},SkipClickNum:l},h=new L(e,c,d,o,this.m_clickTimeProvider,a);return t.registerAnimEvaluator(h),h}static getEvalNumRepeats(e){return e===w.RepeatUntilClick||e===w.RepeatUntilEnd?w.RepeatForever:e}static getRepeatsSkipClick(e,t){return t===w.RepeatUntilEnd?w.Undefined:e}constructor(e,t){this.m_clickTimeProvider=e,this.m_visTrackTable=t}}var K,Q=i(10);function ee(e){n.a.setLogger(e)}!function(e){e[e.Timed=0]="Timed",e[e.UntilClick=1]="UntilClick",e[e.UntilSlide=2]="UntilSlide"}(K||(K={}));class te{static fromDuration(e){const t=new te;return t.m_duration=e,t}static fromString(e){const t=new te;return t.m_duration=1,"def"===e?(t.m_durationType=K.Timed,t.m_duration=2e3):"sld"===e?t.m_durationType=K.UntilSlide:"clk"===e?t.m_durationType=K.UntilClick:(t.m_durationType=K.Timed,t.m_duration=parseInt(e,10)),t}get FTimed(){return this.m_durationType===K.Timed}get FUntilClick(){return this.m_durationType===K.UntilClick}get FUntilSlide(){return this.m_durationType===K.UntilSlide}get Duration(){return this.FTimed||n.a.sendTraceTag(508822175,J.a.msoulscat_Wac_PptAnimation,X.a.Error,"AnimDuration: !FTimed, bad property access."),this.m_duration}constructor(){this.m_durationType=K.Timed,this.m_duration=2e3}}class ie{calcChildRewindDelay(e,t,i){return e*(i-t-1)}createAnimObjectListForSlide(e,t,i){const n=new Map,r=[];for(const e of t)for(const[t,i]of e.parts.entries()){const a=1===e.parts.length?e.id:`${e.id}c${t}`,s=new U(a,i),o=n.get(e.id)||[];o.push(s),n.set(e.id,o),this.m_visTrackTable[a]=new j,this.m_mpRestEvalHelperTable[a]=[],r.push(s);const l=new P(u.Visible,1,m.Mult),d=this.m_evalCreator.addEvaluatorVisTrack(this.m_visTrackTable[a],0);l.registerAnimEvaluator(d),s.registerAnimAttribute(l,!1)}const a=this.translateAnimations(e,n,i);for(let e=0;e<r.length;e+=1)this.generateRestEvaluators(r[e]);return{animObjectList:r,needsDummyClick:a}}getNumChildAnims(e,t){if(t.childTimeInc<0)return 0;const i=e.get(t.shapeId);return null==i||null==i.length?0:i.length}translateAnimations(e,t,i){let r=!0,a=!1;for(const s of e){if(!s.AnimationList||!s.SequenceId)continue;const e=s.AnimationList,o=s.SequenceId;let l=0,d=0,c=0,h=!1;for(const s of e){if(null==!s)continue;r&&(s.startTrig!==p.OnClick&&(a=!0,s.startTrig=p.OnClick),r=!1);let e=1;!s.autoReverse||s.effectType!==f.Emphasis&&s.effectType!==f.MotionPath||(e*=2),s.numRepeats!==w.RepeatUntilClick&&s.numRepeats!==w.RepeatUntilEnd&&(e*=s.numRepeats+1);let u=0;const m=this.getNumChildAnims(t,s);m>0&&(u+=m*s.childTimeInc);let g=0,_=0;const S=te.fromString(s.animSpeed),v=s.numRepeats===w.RepeatUntilClick||s.numRepeats===w.RepeatUntilEnd||!S.FTimed;let y=0;switch(v||(y=e*S.Duration),s.startTrig){case p.OnClick:g=l+=1,_=s.timeOffs,d=0,c=_+y+u;break;case p.WithPrevious:g=l,_=d+s.timeOffs,c=Math.max(c,_+y+u);break;case p.AfterPrevious:h?(g=l,_+=s.timeOffs,d=c):(g=l,_=c+s.timeOffs,d=c),c=_+y+u;break;default:n.a.sendTraceTag(508822174,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"AnimTranslate::translateAnimations: Unrecognized start trigger, assuming onClick."),g=l+=1,_=s.timeOffs,d=0,c=_+y+u}if(h=v,s.childTimeInc<0){const e=t.get(s.shapeId);if(!e||!e[0]){n.a.sendTraceTag(508822173,J.a.msoulscat_Wac_PptAnimation,X.a.Info,`AnimTranslate::translateAnimations: Invalid shapeId:${s.shapeId}. Anim ignored.`);continue}this.translateOneAnim(s,o,e[0],g,_,S,i)}else{const e=t.get(s.shapeId)||[];let n=s.childTimeInc;const r=S,a=e.length;for(const[t,l]of e.entries())s.rewindChildDelay=this.calcChildRewindDelay(s.childTimeInc,t,a),this.translateOneAnim(s,o,l,g,_+n,r,i),n+=s.childTimeInc}}}return a}translateOneAnim(e,t,i,r,a,s,o){switch(n.a.sendTraceTag(507327195,J.a.msoulscat_Wac_PptAnimation,X.a.Info,`AnimTranslate::translateOneAnim: Animation effectType:${e.effectType}, effectId:${e.effectId}`),e.effectType){case f.Entrance:this.translateEntranceExitEffect(e,t,i,r,a,s,!0,o);break;case f.Exit:this.translateEntranceExitEffect(e,t,i,r,a,s,!1,o);break;case f.MotionPath:this.addInitialVisibilityMarker(i.Id,t),this.translateMotionPathEffect(e,t,i,r,a,s.Duration);break;case f.Emphasis:this.translateEmphasisEffect(e,t,i,r,a,s),this.addInitialVisibilityMarker(i.Id,t);break;case f.Media:this.translateMediaEffect(e,t,i,r,a,s);break;default:n.a.sendTraceTag(508822171,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"AnimTranslate::translateOneAnim: Unknown anim effect category. Ignored.")}if(e.numRepeats!==w.RepeatUntilEnd){const o=this.m_visTrackTable[i.Id];if(!o)return void n.a.sendTraceTag(508822170,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"AnimTranslate::translateOnAnim: Bad visibility track when trying to add After effect.");if(e.after===g.HideImmediatelyAfter){const i=s.FTimed?s.Duration:0;o.becomesInvisibleAt(t,ie.getRepeatsClick(r,e.numRepeats),ie.getRepeatsOffs(a,i,e.numRepeats))}else e.after===g.HideOnNextClick&&o.becomesInvisibleAt(t,r+1,0)}}translateEntranceExitEffect(e,t,i,r,s,o,l,d){const c=e.effectId,h={animObject:i,timelineId:t,click:r,offs:s,dur:o,isEntrance:l,numRepeats:e.numRepeats,direction:e.direction,effectId:c};switch(c){case S.Appear:this.addEffect_Appear(h);break;case S.Fly:case S.Crawl:this.addEffect_Fly(h,d,e.smoothStartFactor,e.smoothEndFactor);break;case S.Lightspeed:h.direction=l?T.Left:T.Right,this.addEffect_Fly(h,d,e.smoothStartFactor,e.smoothEndFactor);break;case S.Dissolve:h.direction=0,this.addEffect_ComplexClip(h);break;case S.Blinds:case S.Box:case S.Checkerboard:case S.Circle:case S.Diamond:case S.RandomBars:case S.Plus:case S.Split:case S.Strips:case S.Wedge:case S.Wheel:this.addEffect_ComplexClip(h);break;case S.Fade:this.addEffect_Fade(h,0,1,0);break;case S.FlashOnce:this.addEffect_FlashOnce(h);break;case S.Peek:this.addEffect_Peek(h);break;case S.Stretch:this.addEffect_Stretch(h);break;case S.Swivel:this.addEffect_Swivel(h,!1);break;case S.FadedSwivel:this.addEffect_Swivel(h,!0);break;case S.Wipe:this.addEffect_Wipe(h);break;case S.Zoom:h.direction=ie.translatePPTZoomFlags(h.direction,h.isEntrance),this.addEffect_Zoom(h,d);break;case S.Boomerang:this.addEffect_Boomerang(h);break;case S.Credits:this.addEffect_Credits(h,d.y);break;case S.EaseIn:this.addEffect_EaseIn(h);break;case S.Float:this.addEffect_Float(h);break;case S.GrowAndTurn:this.addEffect_GrowAndTurn(h);break;case S.Pinwheel:this.addEffect_PinWheel(h);break;case S.RiseUp:this.addEffect_RiseUp(h);break;case S.Swish:this.addEffect_Swish(h,d);break;case S.ThinLine:this.addEffect_Thinline(h);break;case S.Unfold:this.addEffect_Unfold(h);break;case S.Whip:this.addEffect_Whip(h);break;case S.Ascend:case S.Descend:this.addEffect_AscendDescend(h);break;case S.Sling:this.addEffect_Sling(h,d);break;case S.Spinner:this.addEffect_Spinner(h);break;case S.Compress:this.addEffect_ExpandCompress(h,w.CompressWidthFactor);break;case S.Expand:this.addEffect_ExpandCompress(h,w.ExpandWidthFactor);break;case S.Zip:this.addEffect_Zip(h,d);break;case S.Arcup:this.addEffect_ArcUp(h,e);break;case S.FadedZoom:h.direction=ie.translatePPTZoomFlags(h.direction,h.isEntrance),this.addEffect_FadedZoom(h,d);break;case S.Glide:this.addEffect_Glide(h);break;case S.Flip:this.addEffect_Flip(h,d);break;case S.Fold:this.addEffect_Fold(h,d,e.smoothStartFactor,e.smoothEndFactor);break;case S.Draw:this.addEffect_Draw(h,e.animatedPropertyList);break;case S.Ink:this.addEffect_Ink(h);break;case S.Arrive3D:case S.FlyIn3D:if(a.a.readBooleanOrDefault("enableAnimations3D",!1)){this.addEffect_AnimatedPropertyList(h,e.rewind,e.autoReverse,e.smoothStartFactor,e.smoothEndFactor,e.animatedPropertyList);break}default:n.a.sendTraceTag(508822169,J.a.msoulscat_Wac_PptAnimation,X.a.Info,`AnimTranslate::translateEntranceExitEffect: Unrecognized or unimplemented effect ID:  ${e.effectId} . Using Fade instead.`),this.addEffect_Fade(h,0,1,0),Q.e.recordVeto("AnimationFallback",{EffectId:e.effectId,qosVeto:"AnimationFallback",isIntentional:!0})}if(e.rewind&&e.numRepeats!==w.RepeatUntilEnd){if(!this.m_visTrackTable[i.Id])return;let n=ie.getRepeatsOffs(s,o.Duration,e.numRepeats);e.rewindChildDelay>=0&&(n+=e.rewindChildDelay),l?this.m_visTrackTable[i.Id].becomesInvisibleAt(t,ie.getRepeatsClick(r,e.numRepeats),n):this.m_visTrackTable[i.Id].becomesVisibleAt(t,ie.getRepeatsClick(r,e.numRepeats),n)}}addEffect_AnimatedPropertyList(e,t,i,n,r,a){this.addEffect_Fade(e,0,1,0),this.addEmphEffect_AnimatedPropertyList(e.animObject,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,t,i,n,r,a)}addEffect_Appear(e){const t=this.m_visTrackTable[e.animObject.Id];t?e.isEntrance?t.becomesVisibleAt(e.timelineId,e.click,e.offs+e.dur.Duration):t.becomesInvisibleAt(e.timelineId,e.click,e.offs+e.dur.Duration):n.a.sendTraceTag(508822168,J.a.msoulscat_Wac_PptAnimation,X.a.Error,`AnimTranslate::addEffect_Appear: Bad visTrack for aoId ${e.animObject.Id}.`)}addEffect_Fly(e,t,i,n){const r=e.animObject.Shape.position.x,a=e.animObject.Shape.position.y,s=e.animObject.Shape.size;let o=0,l=0;if((e.direction&T.Left)>0&&(o=-(r+s.x)),(e.direction&T.Top)>0&&(l=-(a+s.y)),(e.direction&T.Right)>0&&(o=t.x-r),(e.direction&T.Bottom)>0&&(l=t.y-a),0!==o){const t=new P(u.PosX,r,m.Add),a=this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,o,e.isEntrance,e.numRepeats,0);a&&this.m_evalCreator.addTimeSmoother(a,i,n,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(0!==l){const t=new P(u.PosY,a,m.Add),r=this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,l,e.isEntrance,e.numRepeats,0);r&&this.m_evalCreator.addTimeSmoother(r,i,n,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}}addEffect_Fade(e,t,i,n){const r=new E(u.FadeMaskInfo,null,m.First),a=ie.getFadeMaskInfo(S.Fade,0,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,a,e.isEntrance,e.numRepeats,t),e.animObject.registerAnimAttribute(r,!1);const s=new P(u.FadeMaskProgress,1,m.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,s,e.click,e.offs,e.dur.Duration,i,n,e.isEntrance,e.numRepeats,t),e.animObject.registerAnimAttribute(s,!1)}addEffect_Ink(e){const t=new P(u.InkProgress,0,m.First);this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,t,e.click,e.offs+e.dur.Duration,1),this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}addEffect_ComplexClip(e){const t=new E(u.FadeMaskInfo,null,m.First),i=ie.getFadeMaskInfo(e.effectId,e.direction,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const n=new P(u.FadeMaskProgress,1,m.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}addEffect_FlashOnce(e){const t=new P(u.Visible,1,m.Mult),i=this.m_visTrackTable[e.animObject.Id];null!==i?(e.isEntrance?i.becomesVisibleAt(e.timelineId,e.click,e.offs):this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,t,e.click,e.offs,e.dur.Duration/2,0,e.numRepeats,e.dur.Duration/2),e.numRepeats!==w.RepeatUntilEnd&&i.becomesInvisibleAt(e.timelineId,ie.getRepeatsClick(e.click,e.numRepeats),ie.getRepeatsOffs(e.offs,e.dur.Duration,e.numRepeats)),e.animObject.registerAnimAttribute(t,!1)):n.a.sendTraceTag(508822167,J.a.msoulscat_Wac_PptAnimation,X.a.Error,`AnimTranslate::addEffect_FlashOnce: Bad visTrack for aoId ${e.animObject.Id} at AddEffect_FlashOnce.`)}addEffect_Peek(e){let t,i=0;const n=e.animObject.Shape.size;e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1),e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1);const r=e.isEntrance?ie.flipDirection(e.direction):e.direction;switch(e.direction){case T.Top:t=u.PosY,i=-n.y;break;case T.Right:t=u.PosX,i=n.x;break;case T.Left:t=u.PosX,i=-n.x;break;case T.Bottom:default:t=u.PosY,i=n.y}const a=new E(u.FadeMaskInfo,null,m.First),s=ie.getFadeMaskInfo(S.Wipe,r,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,a,e.click,e.offs,e.dur.Duration,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(a,!1);const o=new P(u.FadeMaskProgress,1,m.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(o,!1);const l=new P(t,-i,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,0,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1)}static flipDirection(e){switch(e){case T.Bottom:return T.Top;case T.Left:return T.Right;case T.Right:return T.Left;case T.Top:default:return T.Bottom}}addEffect_Stretch(e){const t=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,n=e.animObject.Shape.size;let r=0,a=0,s=1,o=1;switch(e.direction){case T.Stretch_FromLeft:s=0,r=-n.x/2;break;case T.Stretch_FromRight:s=0,r=n.x/2;break;case T.Stretch_FromTop:o=0,a=-n.y/2;break;case T.Stretch_FromBottom:o=0,a=n.y/2;break;case T.Stretch_Across:default:s=0}if(1!==s){const t=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(1!==o){const t=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,o,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(0!==r){const i=new P(u.PosX,t,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,r,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}if(0!==a){const t=new P(u.PosY,i,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}}addEffect_Swivel(e,t){let i=1,n=1;switch(e.direction){case T.Swivel_Vertical:n=0;break;case T.Swivel_Horizontal:default:i=0}if(1!==i){const t=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(1!==n){const t=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,n,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}t&&this.addEffect_Fade(e,0,1,0)}addEffect_Wipe(e){const t=new E(u.FadeMaskInfo,null,m.First),i=ie.getFadeMaskInfo(e.effectId,e.direction,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const n=new P(u.FadeMaskProgress,1,m.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}addEffect_Draw(e,t){t&&"drawprogressallatonce"===t[0].name.toLowerCase()?e.direction=1:e.direction=0,this.addEffect_Wipe(e)}addEffect_Zoom(e,t){const i=e.animObject.Shape.position.x,n=e.animObject.Shape.position.y,r=e.animObject.Shape.size;let a=0,s=0,o=0;switch(e.direction){case T.Zoom_InFromCenter:s=w.Zoom_InFromCenterFactor*(t.x-r.x)-i,o=w.Zoom_InFromCenterFactor*(t.y-r.y)-n;break;case T.Zoom_InSlightly:a=w.Zoom_InSlightlyScaleInit;break;case T.Zoom_Out:a=w.Zoom_OutScaleInit;break;case T.Zoom_OutFromBottom:a=w.Zoom_OutFromBottomScaleFactor,o=t.y-n;break;case T.Zoom_OutSlightly:a=w.Zoom_OutSlightlyScaleInit;break;case T.Zoom_In:}if(0!==s){const t=new P(u.PosX,i,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(0!==o){const t=new P(u.PosY,n,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,o,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}const l=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,1,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1);const d=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,d,e.click,e.offs,e.dur.Duration,1,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(d,!1)}static translatePPTZoomFlags(e,t){return t?0!=(e&T.Ppt_ZoomIn)?0!=(e&T.Ppt_ZoomCenter)?T.Zoom_InFromCenter:0!=(e&T.Ppt_ZoomSlightly)?T.Zoom_InSlightly:T.Zoom_In:0!=(e&T.Bottom)?T.Zoom_OutFromBottom:0!=(e&T.Ppt_ZoomSlightly)?T.Zoom_OutSlightly:T.Zoom_Out:0!=(e&T.Ppt_ZoomOut)?0!=(e&T.Ppt_ZoomCenter)?T.Zoom_InFromCenter:0!=(e&T.Ppt_ZoomSlightly)?T.Zoom_InSlightly:T.Zoom_In:0!=(e&T.Bottom)?T.Zoom_OutFromBottom:0!=(e&T.Ppt_ZoomSlightly)?T.Zoom_OutSlightly:T.Zoom_Out}addEffect_Boomerang(e){const t=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,n=new P(u.PosX,t,m.Add),r=[];r.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:w.Boomerang_XOffs,SegOffs:e.dur.Duration/2}),r.push({Offs:e.offs,Dur:e.dur.Duration,BaseVal:0,OffsVal:0,SegOffs:0}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,n,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(n,!1);const a=new P(u.PosY,i,m.Add),s=[];s.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:w.Boomerang_YOffs2,OffsVal:w.Boomerang_YOffs1,SegOffs:e.dur.Duration/2}),s.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:w.Boomerang_YOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1);const o=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration/2,0,w.BoomerangRot,e.isEntrance,e.numRepeats,e.dur.Duration/2),e.animObject.registerAnimAttribute(o,!1);const l=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1),e.dur=te.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_Spinner(e){this.addEffect_Fade(e,0,1,0);const t=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,w.Spinner_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const i=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,1,w.Spinner_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const n=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,0,w.Spinner_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}addEffect_ExpandCompress(e,t){this.addEffect_Fade(e,0,1,0);const i=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,1,t,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_Zip(e,t){const i=e.animObject.Shape.position.x,n=e.animObject.Shape.position.y,r=e.animObject.Shape.size,a=.5*(t.x-r.x)-i,s=(t.y-r.y)*w.Zip_YOffs_Ratio-n,o=w.Zip_Midscale,l=w.Zip_Midscale;e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1);const d=new P(u.PosX,0,m.Add),c=[];c.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:a,OffsVal:a,SegOffs:.5*e.dur.Duration}),c.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:a,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,d,e.click,e.isEntrance,e.numRepeats,c),e.animObject.registerAnimAttribute(d,!1),e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1);const h=new P(u.PosY,0,m.Add),f=[];f.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:s,OffsVal:s,SegOffs:.5*e.dur.Duration}),f.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:s,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,h,e.click,e.isEntrance,e.numRepeats,f),e.animObject.registerAnimAttribute(h,!1);const p=new P(u.ScaleW,1,m.Mult),g=[];g.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:o,OffsVal:1,SegOffs:.5*e.dur.Duration}),g.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:o,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,p,e.click,e.isEntrance,e.numRepeats,g),e.animObject.registerAnimAttribute(p,!1);const _=new P(u.ScaleH,1,m.Mult),S=[];S.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:l,OffsVal:1,SegOffs:.5*e.dur.Duration}),S.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:l,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,_,e.click,e.isEntrance,e.numRepeats,S),e.animObject.registerAnimAttribute(_,!1),e.dur=te.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_ArcUp(e,t){this.addEffect_Fade(e,0,1,0),e.direction=T.Zoom_OutSlightly,this.addEffect_Zoom(e,{x:0,y:0}),this.translateMotionPathEffect(t,e.timelineId,e.animObject,e.click,e.click,e.dur.Duration)}addEffect_FadedZoom(e,t){this.addEffect_Fade(e,0,1,0),this.addEffect_Zoom(e,t)}addEffect_Glide(e){this.addEffect_Fade(e,0,1,0);const t=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1),e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1);const i=new P(u.PosX,0,m.Add),n=e.animObject.Shape.size.x;this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,-n/2+w.Glide_XOffs,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_Flip(e,t){e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1);const i=new P(u.PosY,0,m.Add),n=e.isEntrance?-t.y:t.y;this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,n,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const r=new P(u.ScaleW,1,m.Mult),a=[];a.push({Offs:e.offs,Dur:1/4*e.dur.Duration,BaseVal:0,OffsVal:1,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+1/4*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:1,OffsVal:0,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+.5*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:0,OffsVal:1,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+3/4*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:1,OffsVal:0,SegOffs:3/4*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,r,e.click,e.isEntrance,e.numRepeats,a),e.animObject.registerAnimAttribute(r,!1);const s=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,s,e.click,e.offs,e.dur.Duration,0,w.Flip_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(s,!1)}addEffect_Fold(e,t,i,n){this.addEffect_ExpandCompress(e,w.CompressWidthFactor),e.direction=T.Bottom,e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1),e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1),this.addEffect_Fly(e,t,i,n);const r=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,1,.5,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}addEffect_Credits(e,t){const i=e.animObject.Shape.position.y,r=new P(u.PosY,i,m.Add),a=this.m_visTrackTable[e.animObject.Id];null!=a?(e.isEntrance?(a.becomesVisibleAt(e.timelineId,e.click,e.offs),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,e.dur.Duration,t,-t,e.numRepeats,0)):(a.becomesVisibleAt(e.timelineId,e.click,e.offs),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,e.dur.Duration,-t,t,e.numRepeats,0)),e.numRepeats!==w.RepeatUntilEnd&&a.becomesInvisibleAt(e.timelineId,ie.getRepeatsClick(e.click,e.numRepeats),ie.getRepeatsOffs(e.offs,e.dur.Duration,e.numRepeats)),e.animObject.registerAnimAttribute(r,!1)):n.a.sendTraceTag(508822166,J.a.msoulscat_Wac_PptAnimation,X.a.Error,"AnimTranslate::addEffect_Credits: o visibility track for AO.")}addEffect_EaseIn(e){const t=e.animObject.Shape.size.x;if(e.isEntrance)return e.direction=T.Left,void this.addEffect_Peek(e);e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1),this.addEffect_Fade(e,0,1,0);const i=new P(u.PosX,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,-t/2,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_AscendDescend(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1);const t=e.effectId===S.Ascend?w.Ascend_Offs:w.Descend_Offs,i=new P(u.PosY,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,t,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_Float(e){const t=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,n=new P(u.PosX,t,m.Add),r=[];r.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:w.Float_XOffs2,OffsVal:w.Float_XOffs1,SegOffs:e.dur.Duration/2}),r.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:w.Float_XOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,n,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(n,!1);const a=new P(u.PosY,i,m.Add),s=[];s.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:w.Float_YOffs2,OffsVal:w.Float_YOffs1,SegOffs:e.dur.Duration/2}),s.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:w.Float_YOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1);const o=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration/2,0,w.FloatRot,e.isEntrance,e.numRepeats,e.dur.Duration/2),e.animObject.registerAnimAttribute(o,!1),e.dur=te.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_GrowAndTurn(e){this.addEffect_Fade(e,0,1,0);const t=new P(u.ScaleW,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,w.GrownAndTurn_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const i=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,1,w.GrownAndTurn_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const n=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,0,w.GrowAndTurn_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}addEffect_PinWheel(e){this.addEffect_Fade(e,0,1,0),e.direction=T.Zoom_In,this.addEffect_Zoom(e,{x:0,y:0});const t=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,w.PinWheel_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}addEffect_RiseUp(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1);const t=new P(u.PosY,0,m.Add),i=[];i.push({Offs:e.offs,Dur:w.RiseUp_Seg1Fraction*e.dur.Duration,BaseVal:w.RiseUp_YOffs2,OffsVal:w.RiseUp_YOffs1,SegOffs:(1-w.RiseUp_Seg1Fraction)*e.dur.Duration}),i.push({Offs:e.offs+w.RiseUp_Seg1Fraction*e.dur.Duration,Dur:e.dur.Duration*(1-w.RiseUp_Seg1Fraction),BaseVal:0,OffsVal:w.RiseUp_YOffs2,SegOffs:w.RiseUp_Seg1Fraction*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,i),e.animObject.registerAnimAttribute(t,!1)}addEffect_Swish(e,t){if(e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1),e.isEntrance){const i=w.Swish_DropFraction,n=(1-w.Swish_DropFraction)/2,r=n,a=new P(u.PosY,0,m.Add),s=[];s.push({Offs:e.offs,Dur:i*e.dur.Duration,BaseVal:0,OffsVal:-t.y,SegOffs:(1-i)*e.dur.Duration}),s.push({Offs:e.offs+i*e.dur.Duration,Dur:e.dur.Duration*n,BaseVal:w.Swish_BounceOffs,OffsVal:0,SegOffs:(1-n)*e.dur.Duration}),s.push({Offs:e.offs+(i+n)*e.dur.Duration,Dur:e.dur.Duration*r,BaseVal:0,OffsVal:w.Swish_BounceOffs,SegOffs:(1-r)*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1);const o=new P(u.Rotate,0,m.Add),l=[];l.push({Offs:e.offs,Dur:i*e.dur.Duration,BaseVal:w.Swish_Theta,OffsVal:w.Swish_Theta,SegOffs:(1-i)*e.dur.Duration}),l.push({Offs:e.offs+i*e.dur.Duration,Dur:e.dur.Duration*n,BaseVal:-w.Swish_Theta,OffsVal:w.Swish_Theta,SegOffs:(1-n)*e.dur.Duration}),l.push({Offs:e.offs+(i+n)*e.dur.Duration,Dur:e.dur.Duration*r,BaseVal:0,OffsVal:-w.Swish_Theta,SegOffs:(1-r)*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,o,e.click,e.isEntrance,e.numRepeats,l),e.animObject.registerAnimAttribute(o,!1)}else{const i=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,-w.Swish_Theta,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const n=new P(u.PosY,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,0,t.y,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}}addEffect_Thinline(e){e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1);const t=new P(u.PosX,0,m.Add),i=[];i.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:w.ThinLine_XOffs,SegOffs:.5*e.dur.Duration}),i.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:0,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,i),e.animObject.registerAnimAttribute(t,!1);const n=new P(u.ScaleW,1,m.Mult),r=[];r.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:w.ThinLine_WInit,OffsVal:w.ThinLine_WInit,SegOffs:.5*e.dur.Duration}),r.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:w.ThinLine_WInit,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,n,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(n,!1);const a=new P(u.ScaleH,1,m.Mult),s=[];s.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:w.ThinLine_HInit,OffsVal:w.ThinLine_HInit,SegOffs:.5*e.dur.Duration}),s.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:w.ThinLine_HInit,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1)}addEffect_Unfold(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1);const t=new P(u.PosX,0,m.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,w.Unfold_XOffs,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}addEffect_Whip(e){e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1);const t=new P(u.PosX,0,m.Add),i=[];i.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:w.Whip_XOffs,OffsVal:w.Whip_XOffs,SegOffs:.5*e.dur.Duration}),i.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:w.Whip_XOffs,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,i),e.animObject.registerAnimAttribute(t,!1);const n=new P(u.ScaleW,1,m.Mult),r=[];r.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:w.Whip_MidScale,OffsVal:0,SegOffs:.5*e.dur.Duration}),r.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:w.Whip_MidScale,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,n,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(n,!1);const a=new P(u.ScaleH,1,m.Mult),s=[];s.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:w.Whip_MidScale,OffsVal:0,SegOffs:.5*e.dur.Duration}),s.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:w.Whip_MidScale,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1),e.dur=te.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_Sling(e,t){const i=e.animObject.Shape.position.x,n=-t.x-i,r=-i+t.x-w.Sling_XMid_Offs,a=r/2;e.animObject.registerAnimAttribute(new P(u.PosX,e.animObject.Shape.position.x,m.BaselineOnly),!1);const s=new P(u.PosX,0,m.Add),o=[];o.push({Offs:e.offs,Dur:1/3*e.dur.Duration,BaseVal:r,OffsVal:n,SegOffs:2/3*e.dur.Duration}),o.push({Offs:e.offs+1/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:a,OffsVal:r,SegOffs:2/3*e.dur.Duration}),o.push({Offs:e.offs+2/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:0,OffsVal:a,SegOffs:2/3*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,s,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(s,!1);const l=new P(u.Rotate,0,m.Add),d=[];d.push({Offs:e.offs,Dur:2/3*e.dur.Duration,BaseVal:w.Sling_Rot,OffsVal:w.Sling_Rot,SegOffs:1/3*e.dur.Duration}),d.push({Offs:e.offs+2/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:0,OffsVal:w.Sling_Rot,SegOffs:2/3*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,l,e.click,e.isEntrance,e.numRepeats,d),e.animObject.registerAnimAttribute(l,!1),this.addEffect_Fade(e,0,1,0)}translateEmphasisEffect(e,t,i,r,s,o){const l={animObject:i,timelineId:t,click:r,offs:s,dur:o,numRepeats:e.numRepeats,rewind:e.rewind,autoReverse:e.autoReverse,effectId:e.effectId};switch(e.effectId){case _.GrowShrink:this.addEmphEffect_GrowShrink(l,e.rewindChildDelay,e.scaleByXPercent,e.scaleByYPercent,e.direction);break;case _.Spin:this.addEffect_Spin(l,e.rewindChildDelay,e.rotAngDegrees);break;case _.Transparency:this.addEmphEffect_Transparency(l,e.transparencyAmountPercent);break;case _.Shimmer:this.addEmphEffect_Shimmer(l);break;case _.Blink:this.addEmphEffect_Blink(l);break;case _.FlashBulb:this.addEmphEffect_FlashBulb(l);break;case _.Wave:this.addEmphEffect_Wave(l);break;case _.Turntable3D:if(a.a.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_Turntable3D(i,t,r,s,o,e.numRepeats,e.rewind,e.rewindChildDelay,e.autoReverse,e.smoothStartFactor,e.smoothEndFactor,e.rotAngDegrees,e.direction);break}case _.Swing3D:case _.JumpAndTurn3D:if(a.a.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_AnimatedPropertyList(i,t,r,s,o.Duration,e.numRepeats,e.rewind,e.autoReverse,e.smoothStartFactor,e.smoothEndFactor,e.animatedPropertyList);break}case _.Embedded1:case _.Embedded2:case _.Embedded3:case _.Embedded4:case _.Embedded5:case _.Embedded6:case _.Embedded7:case _.Embedded8:case _.Embedded9:case _.Embedded10:case _.Embedded11:case _.Embedded12:case _.Embedded13:case _.Embedded14:case _.Embedded15:case _.Embedded16:case _.Embedded17:case _.Embedded18:if(a.a.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_EmbeddedAnimation(l);break}default:n.a.sendTraceTag(508822165,J.a.msoulscat_Wac_PptAnimation,X.a.Info,`AnimTranslate::translateEmphasisEffect: Unknown or NYI emphasis effect ID:${e.effectId}. ignored.`),Q.e.recordVeto("AnimationFallback",{EffectId:e.effectId,qosVeto:"AnimationFallback",isIntentional:!0})}}addEmphEffect_AnimatedPropertyList(e,t,i,n,r,a,s,o,l,d,c){const h=o?r:0;if(c)for(const u of c){const c=this.getAnimAttributeIdFromPropertyName(u.name),f=this.getAdditiveTypeForProperty(c),p=new P(c,f===m.Mult?1:0,f);let g=this.m_evalCreator.addEvaluatorLinearList(t,p,i,n,r,u.times,u.values,!1,a,h);this.m_evalCreator.addTimeSmoother(g,l,d,t,i,n,r,a,h),o?(g=this.m_evalCreator.addEvaluatorLinearList(t,p,i,n+r,r,u.times,u.values,!0,a,h),this.m_evalCreator.addTimeSmoother(g,d,l,t,i,n+r,r,a,h)):s||this.m_evalCreator.addEvaluatorConstantAfter(t,p,i,n+r,u.values[u.values.length-1]),e.registerAnimAttribute(p,!1)}const f=new P(u.Is3DRunning,0,m.Add);this.m_evalCreator.addEvaluatorLinear(t,f,i,n,r+h,1,1,a,0),e.registerAnimAttribute(f,!1)}getAnimAttributeIdFromPropertyName(e){switch(e){case"3d.object.rotation.x":return u.ObjectRotationX;case"3d.object.rotation.y":return u.ObjectRotationY;case"3d.object.rotation.z":return u.ObjectRotationZ;case"3d.object.scale.x":return u.ObjectScaleX;case"3d.object.scale.y":return u.ObjectScaleY;case"3d.object.scale.z":return u.ObjectScaleZ;case"3d.object.translation.x":return u.ObjectTranslateX;case"3d.object.translation.y":return u.ObjectTranslateY;case"3d.object.translation.z":return u.ObjectTranslateZ;case"3d.view.rotation.x":return u.ViewRotationX;case"3d.view.rotation.y":return u.ViewRotationY;case"3d.view.rotation.z":return u.ViewRotationZ;case"3d.view.scale.x":return u.ViewScaleX;case"3d.view.scale.y":return u.ViewScaleY;case"3d.view.scale.z":return u.ViewScaleZ;case"3d.view.translation.x":return u.ViewTranslateX;case"3d.view.translation.y":return u.ViewTranslateY;case"3d.view.translation.z":return u.ViewTranslateZ;default:return n.a.sendTraceTag(508822164,J.a.msoulscat_Wac_PptAnimation,X.a.Info,`AnimTranslate::getAnimAttributeIdFromPropertyName: Ignoring unknown property name '${e}' passed to GetAnimAttributeIdFromPropertyName..`),u.None}}getAdditiveTypeForProperty(e){switch(e){case u.ObjectScaleX:case u.ObjectScaleY:case u.ObjectScaleZ:case u.ViewScaleX:case u.ViewScaleY:case u.ViewScaleZ:return m.Mult;default:return m.Add}}addEmphEffect_Turntable3D(e,t,i,n,r,a,s,o,l,d,c,h,f){const p=l?r.Duration:0,g=new P(this.getAnimAttributeIdFromDirection(f),0,m.Add),_=h;let S=this.m_evalCreator.addEvaluatorLinear(t,g,i,n,r.Duration,0,_,a,p);this.m_evalCreator.addTimeSmoother(S,d,c,t,i,n,r.Duration,a,p),l?(S=this.m_evalCreator.addEvaluatorLinear(t,g,i,n+r.Duration,r.Duration,_,0,a,p),this.m_evalCreator.addTimeSmoother(S,c,d,t,i,n+r.Duration,r.Duration,a,p)):s?o>0&&this.m_evalCreator.addEvaluatorConstantDuration(t,g,i,n+r.Duration,o,_,a,0):this.m_evalCreator.addEvaluatorConstantAfter(t,g,i,n+r.Duration,_),e.registerAnimAttribute(g,!1);const v=new P(u.Is3DRunning,0,m.Add);this.m_evalCreator.addEvaluatorLinear(t,v,i,n,r.Duration+p,1,1,a,0),e.registerAnimAttribute(v,!1)}getAnimAttributeIdFromDirection(e){switch(e){case T.ObjRotLeft:case T.ObjRotRight:return u.ObjectRotationY;case T.ObjRotBack:case T.ObjRotFront:return u.ObjectRotationX;case T.ObjRotCounterclockwise:case T.ObjRotClockwise:return u.ObjectRotationZ;case T.ViewRotRight:case T.ViewRotLeft:return u.ViewRotationY;case T.ViewRotUp:case T.ViewRotDown:return u.ViewRotationX;case T.ViewRotClockwise:case T.ViewRotCounterclockwise:return u.ViewRotationZ;default:return u.None}}addEmphEffect_EmbeddedAnimation(e){const t=e.autoReverse?e.dur.Duration:0,i=e.dur.Duration,n=e.effectId-_.Embedded1,r=new P(u.EmbeddedAnimId,n,m.First);this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,r,e.click,e.offs,i,n,e.numRepeats,t),e.rewind||this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,r,e.click,e.offs+i,n),e.animObject.registerAnimAttribute(r,!1);const a=new P(u.EmbeddedAnimProgress,0,m.First);this.m_evalCreator.addEvaluatorLinear(e.timelineId,a,e.click,e.offs,i,0,1,e.numRepeats,t),e.autoReverse?this.m_evalCreator.addEvaluatorLinear(e.timelineId,a,e.click,e.offs+i,i,1,0,e.numRepeats,t):e.rewind||this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,a,e.click,e.offs+i,1),e.animObject.registerAnimAttribute(a,!1);const s=new P(u.Is3DRunning,0,m.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,s,e.click,e.offs,i+t,1,1,e.numRepeats,0),e.animObject.registerAnimAttribute(s,!1)}addEmphEffect_GrowShrink(e,t,i,n,r){const a=i/100,s=n/100,o=new P(u.ScaleW,1,m.Mult),l=new P(u.ScaleH,1,m.Mult);let d;if(d=e.dur.FUntilSlide||e.dur.FUntilClick?w.GrowShrink_DefaultDuration:e.dur.Duration,1===r&&(d=1),e.dur.FUntilSlide)this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,d,1,a,e.numRepeats,0),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,d,1,s,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,o,e.click,e.offs+d,a),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,l,e.click,e.offs+d,s);else if(e.dur.FUntilClick)this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,d,1,a,e.numRepeats,0),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,d,1,s,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,o,e.click,e.offs+d,e.click+1,0,a,0,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,l,e.click,e.offs+d,e.click+1,0,s,0,0);else{const i=e.autoReverse?d:0;this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,d,1,a,e.numRepeats,i),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,d,1,s,e.numRepeats,i),e.autoReverse?(this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs+d,d,a,1,e.numRepeats,i),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs+d,d,s,1,e.numRepeats,i)):e.rewind?t>0&&(this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,o,e.click,e.offs+d,t,a,e.numRepeats,i),this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,l,e.click,e.offs+d,t,s,e.numRepeats,i)):(this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,o,e.click,e.offs+d,a),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,l,e.click,e.offs+d,s))}e.animObject.registerAnimAttribute(o,!1),e.animObject.registerAnimAttribute(l,!1)}addEffect_Spin(e,t,i){const n=new P(u.Rotate,0,m.Add),r=i*Math.PI/180,a=e.autoReverse?e.dur.Duration:0;this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,e.dur.Duration,0,r,e.numRepeats,a),e.autoReverse?this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs+e.dur.Duration,e.dur.Duration,r,0,e.numRepeats,a):e.rewind?t>0&&this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,n,e.click,e.offs+e.dur.Duration,t,r,e.numRepeats,0):this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,n,e.click,e.offs+e.dur.Duration,r),e.animObject.registerAnimAttribute(n,!1)}addEmphEffect_Transparency(e,t){const i=new E(u.FadeMaskInfo,null,m.First),n=ie.getFadeMaskInfo(S.Fade,0,!0),r=new P(u.FadeMaskProgress,1,m.First),a=(100-t)/100;e.dur.FUntilSlide?(this.m_evalCreator.addEvaluatorConstantObjectAfter(e.timelineId,i,e.click,e.offs,n),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,r,e.click,e.offs,a)):e.dur.FUntilClick?(this.m_evalCreator.addEvaluatorConstantObjectSpan(e.timelineId,i,e.click,e.offs,e.click+1,0,n,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,r,e.click,e.offs,e.click+1,0,a,e.numRepeats,0)):(this.m_evalCreator.addEvaluatorConstantObjectSpan(e.timelineId,i,e.click,e.offs,e.click,e.offs+e.dur.Duration,n,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,r,e.click,e.offs,e.click,e.offs+e.dur.Duration,a,e.numRepeats,0)),e.animObject.registerAnimAttribute(i,!1),e.animObject.registerAnimAttribute(r,!1)}addEmphEffect_Shimmer(e){const t=e.dur.Duration/2,i=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,0,w.Shimmer_Theta,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,w.Shimmer_Theta,0,e.numRepeats,t),e.animObject.registerAnimAttribute(i,!1)}addEmphEffect_Blink(e){const t={animObject:e.animObject,timelineId:e.timelineId,click:e.click,offs:e.offs,dur:te.fromDuration(e.dur.Duration/2),isEntrance:!0,numRepeats:e.numRepeats,direction:T.Top,effectId:e.effectId};this.addEffect_Fade(t,e.dur.Duration/2,w.Blink_Alpha,w.Blink_Alpha)}addEmphEffect_FlashBulb(e){const t=e.dur.Duration/2,i=new P(u.ScaleW,1,m.Mult),n=new P(u.ScaleH,1,m.Mult);this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,1,w.FlashBulb_ScaleOffs,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,t,1,w.FlashBulb_ScaleOffs,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,w.FlashBulb_ScaleOffs,1,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs+t,t,w.FlashBulb_ScaleOffs,1,e.numRepeats,t),e.animObject.registerAnimAttribute(i,!1),e.animObject.registerAnimAttribute(n,!1);const r=new P(u.Alpha,1,m.Mult);this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,e.dur.Duration,w.FlashBulb_Alpha,w.FlashBulb_Alpha,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}addEmphEffect_Wave(e){const t=e.dur.Duration/3,i=new P(u.Rotate,0,m.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,0,w.Wave_Theta,e.numRepeats,e.dur.Duration-t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,w.Wave_Theta,-w.Wave_Theta,e.numRepeats,e.dur.Duration-t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+2*t,t,-w.Wave_Theta,0,e.numRepeats,e.dur.Duration-t),e.animObject.registerAnimAttribute(i,!1);const n=e.dur.Duration/2;e.animObject.registerAnimAttribute(new P(u.PosY,e.animObject.Shape.position.y,m.BaselineOnly),!1);const r=new P(u.PosY,0,m.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,n,0,w.Wave_YOffs,e.numRepeats,e.dur.Duration-n),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+n,n,w.Wave_YOffs,0,e.numRepeats,e.dur.Duration-n),e.animObject.registerAnimAttribute(r,!1)}static getFadeMaskInfo(e,t,i){for(const n of C.EffectMap)if(n.FxId===e&&n.Dir===t)return{preset:n.Preset,param:n.Param,flags:i?n.EntFlags:n.ExitFlags};return{preset:y.dissolve}}addInitialVisibilityMarker(e,t){const i=this.m_visTrackTable[e];null!=i?0===i.Length&&i.becomesVisibleAt(t,0,0):n.a.sendTraceTag(508822163,J.a.msoulscat_Wac_PptAnimation,X.a.Error,`AnimTranslate::addInitialVisibilityMarker: Bad visTrack for aoId ${e} at AddInitialVisibilityMarker.`)}static getRepeatsClick(e,t){return t===w.RepeatUntilEnd?w.Undefined:t===w.RepeatUntilClick?e+1:e}static getRepeatsOffs(e,t,i){return i===w.RepeatUntilEnd?w.RepeatForever:i===w.RepeatUntilClick?0:e+(i+1)*t}translateMotionPathEffect(e,t,i,r,a,s){if(!e.motionPath)return;i.registerAnimAttribute(new P(u.PosX,i.Shape.position.x,m.BaselineOnly),!1),i.registerAnimAttribute(new P(u.PosY,i.Shape.position.y,m.BaselineOnly),!1);let o=e.motionPath.commandList;e.motionPath.fReversed&&(o=ie.generateReversedMotionPath(o));const l=new Array(o.length);let d=0;for(let e=0;e<o.length;e+=1){const t=ie.calcMPSegmentLength(o,e);l[e]=t,d+=t}if(0===d)return void n.a.sendTraceTag(508822162,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"Motion path had zero length, ignored.");const c=this.m_mpRestEvalHelperTable[i.Id];if(null!==c)if(c.push(ie.createRestEvalHelperStartEntry(t,r,a)),this.translateMPList(e,i,t,o,l,d,!1,0,r,a,s,e.autoReverse,e.numRepeats,a),e.autoReverse){const n=ie.generateReversedMotionPath(o);this.translateMPList(e,i,t,n,l,d,!0,s,r,a,s,e.autoReverse,e.numRepeats,a+s);const h=ie.getRepeatsOffs(a,2*s,e.numRepeats),u=ie.createRestEvalHelperEndEntry(n,t,ie.getRepeatsClick(r,e.numRepeats),h);c.push(u)}else{const i=ie.getRepeatsOffs(a,s,e.numRepeats);if(e.rewind){if(e.rewindChildDelay>0){const n=ie.createRestEvalHelperEndEntry(o,t,ie.getRepeatsClick(r,e.numRepeats),i);c.push(n);const a=ie.createRestEvalHelperStartEntry(t,ie.getRepeatsClick(r,e.numRepeats),i+e.rewindChildDelay);c.push(a)}}else{const n=ie.createRestEvalHelperEndEntry(o,t,ie.getRepeatsClick(r,e.numRepeats),i);c.push(n)}}else n.a.sendTraceTag(508822161,J.a.msoulscat_Wac_PptAnimation,X.a.Error,"No rest eval list exists for this anim object.")}static generateReversedMotionPath(e){const t=[];if(null==e||0===e.length)return t;let i=e[e.length-1].end,r={type:b.MoveTo,end:i};t.push(r);for(let a=e.length-1;a>0;a-=1){switch(i=e[a-1].end,e[a].type){case b.MoveTo:r={type:b.MoveTo,end:i};break;case b.LineTo:r={type:b.LineTo,end:i};break;case b.CurveTo:const t=e[a];r={type:b.CurveTo,control1:t.control2,control2:t.control1,end:i};break;default:n.a.sendTraceTag(508822160,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"Unknown motion path command while reversing.")}t.push(r)}return t}static calcMPSegmentLength(e,t){if(0===t)return 0;const i=e[t-1],r=e[t];switch(r.type){case b.MoveTo:return 0;case b.LineTo:return ie.calcLineSegmentLength(i.end.x,i.end.y,r.end.x,r.end.y);case b.CurveTo:const e=r;return ie.calcBezierSegmentLength(i.end.x,i.end.y,e.control1.x,e.control1.y,e.control2.x,e.control2.y,e.end.x,e.end.y);default:return n.a.sendTraceTag(508822159,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"Unknown motion path command type, ignoring."),0}}static calcLineSegmentLength(e,t,i,n){const r=i-e,a=n-t;return Math.sqrt(r*r+a*a)}static calcBezierSegmentLength(e,t,i,n,r,a,s,o){let l,d,c=0,h=e,u=t;const m=1/w.BezierLengthEstimateDivisions;for(let f=0;f<=1;f+=m)l=q.calculateBezierCoordinate(e,i,r,s,f),d=q.calculateBezierCoordinate(t,n,a,o,f),c+=ie.calcLineSegmentLength(h,u,l,d),h=l,u=d;return c}generateRestEvaluators(e){const t=this.m_mpRestEvalHelperTable[e.Id];if(null==t||0===t.length)return;const i=e.Shape.position.x,n=e.Shape.position.y,r=new P(u.PosX,i,m.Add),a=new P(u.PosY,n,m.Add);for(let e=0;e<t.length;e+=1){const i=t[e];if(!i.FStartPath)if(e===t.length-1)this.m_evalCreator.addEvaluatorConstantAfter(i.TimeLineId,r,i.Click,i.Offs-1,i.XTarget),this.m_evalCreator.addEvaluatorConstantAfter(i.TimeLineId,a,i.Click,i.Offs-1,i.YTarget);else{const n=t[e+1];this.m_evalCreator.addEvaluatorConstantSpan(i.TimeLineId,r,i.Click,i.Offs-1,n.Click,n.Offs,i.XTarget,0,0),this.m_evalCreator.addEvaluatorConstantSpan(i.TimeLineId,a,i.Click,i.Offs-1,n.Click,n.Offs,i.YTarget,0,0)}}e.registerAnimAttribute(r,!1),e.registerAnimAttribute(a,!1)}static createRestEvalHelperStartEntry(e,t,i){return new W(!0,e,t,i,0,0)}static createRestEvalHelperEndEntry(e,t,i,n){const r=e[e.length-1];return new W(!1,t,i,n,r.end.x,r.end.y)}translateMPList(e,t,i,n,r,a,s,o,l,d,c,h,u,m){const f=e.autoReverse?c:0;let p=o;for(let o=1;o<n.length;o+=1){const g=c*r[s?n.length-o:o]/a,_=c-g+(h?c:0);g>0&&this.addMPSegment(e,t,i,n,o,l,d+p,g,u,_,m,f,c),p+=g}}addMPSegment(e,t,i,r,a,s,o,l,d,c,h,f,p){if(0===a)return;const g=t.Shape.position.x,_=t.Shape.position.y;let S,v;const y=r[a-1],T=r[a];switch(T.type){case b.MoveTo:break;case b.LineTo:S=new P(u.PosX,g,m.Add);const r=this.m_evalCreator.addEvaluatorLinear(i,S,s,o,l,y.end.x,T.end.x,d,c);this.m_evalCreator.addTimeSmoother(r,e.smoothStartFactor,e.smoothEndFactor,i,s,h,p,d,f),t.registerAnimAttribute(S,!1),v=new P(u.PosY,_,m.Add);const a=this.m_evalCreator.addEvaluatorLinear(i,v,s,o,l,y.end.y,T.end.y,d,c);this.m_evalCreator.addTimeSmoother(a,e.smoothStartFactor,e.smoothEndFactor,i,s,h,p,d,f),t.registerAnimAttribute(v,!1);break;case b.CurveTo:const w=T,C=[y.end.x,w.control1.x,w.control2.x,w.end.x];S=new P(u.PosX,g,m.Add);const I=this.m_evalCreator.addEvaluatorBezier(i,S,s,o,l,C,d,c);this.m_evalCreator.addTimeSmoother(I,e.smoothStartFactor,e.smoothEndFactor,i,s,h,p,d,f),t.registerAnimAttribute(S,!1);const E=[y.end.y,w.control1.y,w.control2.y,w.end.y];v=new P(u.PosY,_,m.Add);const x=this.m_evalCreator.addEvaluatorBezier(i,v,s,o,l,E,d,c);this.m_evalCreator.addTimeSmoother(x,e.smoothStartFactor,e.smoothEndFactor,i,s,h,p,d,f),t.registerAnimAttribute(v,!1);break;default:n.a.sendTraceTag(508822158,J.a.msoulscat_Wac_PptAnimation,X.a.Info,"Unknown motion path command type, ignoring.")}}addMediaEffect_Play(e){const t=new E(u.MediaPlaybackCmd,null,m.Last),i=e.dur.Duration>0?100:e.dur.Duration;this.m_evalCreator.addEvaluatorConstantObject(e.timelineId,t,e.click,e.offs,i,e,0,0),e.animObject.registerAnimAttribute(t,!1)}translateMediaEffect(e,t,i,n,r,a){const s={animObject:i,timelineId:t,click:n,offs:r,dur:a,effectId:e.effectId,mediaCmd:e.mediaCmd};this.addMediaEffect_Play(s)}constructor(e){this.m_visTrackTable=new Map,this.m_mpRestEvalHelperTable=new Map,this.m_evalCreator=new Y(e,this.m_visTrackTable)}}},function(e,t,i){"use strict";i.d(t,"v",(function(){return a})),i.d(t,"H",(function(){return s})),i.d(t,"w",(function(){return o})),i.d(t,"x",(function(){return l})),i.d(t,"u",(function(){return d})),i.d(t,"t",(function(){return c})),i.d(t,"J",(function(){return h})),i.d(t,"G",(function(){return u})),i.d(t,"F",(function(){return m})),i.d(t,"z",(function(){return f})),i.d(t,"A",(function(){return p})),i.d(t,"L",(function(){return g})),i.d(t,"M",(function(){return _})),i.d(t,"b",(function(){return S})),i.d(t,"c",(function(){return v})),i.d(t,"f",(function(){return y})),i.d(t,"d",(function(){return T})),i.d(t,"e",(function(){return b})),i.d(t,"g",(function(){return w})),i.d(t,"a",(function(){return C})),i.d(t,"B",(function(){return I})),i.d(t,"l",(function(){return P})),i.d(t,"y",(function(){return E})),i.d(t,"h",(function(){return x})),i.d(t,"I",(function(){return k})),i.d(t,"K",(function(){return M})),i.d(t,"p",(function(){return A})),i.d(t,"o",(function(){return R})),i.d(t,"q",(function(){})),i.d(t,"j",(function(){return O})),i.d(t,"k",(function(){return F})),i.d(t,"i",(function(){return D})),i.d(t,"m",(function(){return L})),i.d(t,"s",(function(){return B})),i.d(t,"E",(function(){return N})),i.d(t,"r",(function(){return V})),i.d(t,"D",(function(){return W})),i.d(t,"n",(function(){return U})),i.d(t,"C",(function(){return z}));var n=i(6),r=i(37);let a=!0;function s(e){a=e}let o=1,l=8,d=16,c=0;function h(e,t){o=e,l=t}function u(e){d=e}function m(e){c=e}let f=!0,p=!0;function g(e){f=e}function _(e){p=e}const S=0,v=1,y=2,T=3,b=5,w=7;let C=S;function I(e){C=e}let P=3,E=!1;function x(e){E=e}function k(e){n.a.setLogger(e)}function M(e){r.a.load(e)}let A=!1,R=!1,O=!1,F=!1;function D(){return"undefined"!=typeof WeakRef}let L=!1,B=1040;function N(e){B=e}let V=0;function W(e){V=e}let U=!1;function z(e){U=e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return m}));var n,r,a=i(9),s=i(3),o=i(7),l=i(11),d=i(8),c=i(10),h=i(4),u=i(1);!function(e){e.Init="init",e.Goto="goto",e.Prefetch="prefetch",e.Prerender="prerender",e.CheckHidden="CheckHidden",e.UpdateResourceProviders="UpdateResourceProviders",e.ChangeRenderingModeToSVG="ChangeRenderingModeToSVG"}(n||(n={})),function(e){e.EnsureSlideView="ensureSlideView",e.ResizeViewContainer="resizeViewContainer",e.RenderTransition="renderTransition",e.RenderSlide="renderSlide",e.ReloadTexture="reloadTexture"}(r||(r={}));class m{static init(e){this.m_settings=e}static recordInitData(e){if(!e.hasOwnProperty(n.Init))return;const t={sessionId:this.m_settings.appSettings.userSessionId,InitInfo:e,initDurFromEndUser:e[n.Init].end-this.m_settings.appSettings.initTime,initDur:e[n.Init].end-e[n.Init].start,Config:l.a.getSessionConfig()};0===Object.keys(this.m_initInfo).length&&(this.m_initInfo=t.InitInfo);const i={initDur:t.initDur,initDurFromEndUser:t.initDurFromEndUser};this.m_settings.appSettings.useSnapDownloadUrl&&(t[m.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl,i[m.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),l.a.recordSessionStats(i),a.a.sendTraceTag(592483858,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("SSCoreInit",t))}static recordNavData(e,t,i,r){if(!i||0===Object.keys(i).length||!i.hasOwnProperty("sid"))return;let f=!1,p=!1,g=!1;const _=i.sid.toString();if(r&&r.bootMetrics){if(0===this.m_startFromTime&&(f=!0,this.m_navigationData.hasOwnProperty(_))){const e=this.m_navigationData[_];e.hasOwnProperty(n.Prerender)&&(p=!0),e.hasOwnProperty(n.Prefetch)&&(g=!0)}this.m_startFromTime=r.startFromTime?r.startFromTime:0,this.m_maxGotoSlideMs=0,this.m_navigationData={},r.startFromTime||a.a.sendTraceTag(506856674,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"NavigationLogger::recordNavData Boot metrics object was present, but there was no startFromTime.")}if(this.m_navigationData.hasOwnProperty(_)||(this.m_navigationData[_]={}),i.hasOwnProperty(m.TextureMetadata)&&(i[m.TextureMetadata]=void 0),i.hasOwnProperty("createTransition")&&i.createTransition.hasOwnProperty("rendererEnvironment")&&(i.createTransition.rendererEnvironment.hasOwnProperty(m.RenderTransitionTextures)&&(i.createTransition.rendererEnvironment[m.RenderTransitionTextures]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(m.GenerateMorphResource)&&(i.createTransition.rendererEnvironment[m.GenerateMorphResource]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(m.RenderToTexture)&&(i.createTransition.rendererEnvironment[m.RenderToTexture]=void 0)),i.hasOwnProperty("missingTextureIds")){const e={id:i&&i.id,sr:i&&i.sr,missingTextureIds:i.missingTextureIds};a.a.sendTraceTag(507598877,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,m.getLogString("addOnTrimmedData",e)),i.missingTextureIds=void 0,i.hasMissingTextureIds=!0}const S=this.m_navigationData[_];if(i.hasOwnProperty(this.Metadata)){S.hasOwnProperty(this.Metadata)||(S[this.Metadata]=[]),S[this.Metadata]=S[this.Metadata].concat(i[this.Metadata].filter(e=>!S[this.Metadata].includes(e)));let e=!1;for(const t in i[this.Metadata])if(i[this.Metadata][t].hasOwnProperty(this.MediaInfo)){e=!0;break}e&&!l.a.getSessionStats("hasMedia")&&l.a.recordSessionStats({hasMedia:!0}),e&&c.a.addOrUpdatePartCDimensions(new Map([["NavigatedToSlideWithMedia","true"]]))}if(i.hasOwnProperty(this.Metadata)){const e={id:i&&i.id,sr:i&&i.sr,metadata:i[this.Metadata]};a.a.sendTraceTag(507597592,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,m.getLogString("addOnTrimmedDataMetadata",e)),i[this.Metadata]=void 0,i.hasMetadata=!0}let v,y=0;if(r&&r.navMetrics&&r.navMetrics.checkHiddenSlideResult&&(y=this.getDuration(r.navMetrics.checkHiddenSlideResult)),!(t===n.Goto&&S.hasOwnProperty(n.Goto)&&i.hasOwnProperty(n.Goto)&&this.getDuration(S[n.Goto])+this.getDuration(S[n.CheckHidden])>=this.getDuration(i[n.Goto])+y||t===n.Prefetch&&S.hasOwnProperty(n.Prefetch))){for(const t in i)if(t===n.Goto)if(S[n.CheckHidden]=y,r&&r.bootMetrics){const n={sessionId:this.m_settings.appSettings.userSessionId,startFromTime:r?r.startFromTime:void 0,bootMetrics:r?r.bootMetrics:void 0,Config:l.a.getSessionConfig(),EUPL:r.startFromTime&&0!==r.startFromTime?i[t].end-r.startFromTime:void 0,firstStartMetrics:{firstStart:f}};if(r&&r.id&&(n.id=r.id),i.hasOwnProperty("pptSpinnerStartTime")&&n.bootMetrics&&(n.bootMetrics.pptSpinnerStartTime=i.pptSpinnerStartTime),i.hasOwnProperty("errorName")&&(n.errors=i.errorName),this.m_settings.appSettings.useSnapDownloadUrl&&(n[m.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),i.hasOwnProperty(m.Metadata)){const e=this.getMetadataSummary(i[m.Metadata]);e.length>0&&(n[m.Metadata]=e),n.NavigationInfo=Object.keys(i).reduce((e,t)=>(t!==m.Metadata&&(e[t]=i[t]),e),{})}else n.NavigationInfo=i;n.slideIndex=e.getVisibleSlideIndex({sid:i.sid,cid:0}),h.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&(this.m_slideIndexFromBoot=n.slideIndex),f&&(n.firstStartMetrics.prefetched=g,n.firstStartMetrics.prerendered=p),0!==Object.keys(this.m_initInfo).length&&(n.initMetrics=this.m_initInfo),n.EUPL>u.a.readNumberOrDefault("vetoBootDurationMs",2e3)&&c.e.recordVeto("VetoedSlideShowBootTimeMs",{qosVeto:"PerceivedOpenSlow",...n}),i.hasOwnProperty(m.GetItemsResult)&&void 0!==i[m.GetItemsResult]&&(n[m.GetItemsResult]=i[m.GetItemsResult]),this.m_bootLaunchId=r&&r.id,a.a.sendTraceTag(594650330,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("boot",n))}else r&&!r.bootMetrics&&(i.hasOwnProperty("errorName")||(S[t]=i[t],i.hasOwnProperty("SBCurrentFrameSummary")&&i.SBCurrentFrameSummary.hasOwnProperty("totalCostMs")&&(S[this.RenderCost]=i.SBCurrentFrameSummary.totalCostMs),i.hasOwnProperty(this.NavigationStep)&&0!==i[this.NavigationStep]&&1!==i[this.NavigationStep]&&(S[this.NavigationStep]=i[this.NavigationStep]),r&&r.navigationType&&r.navigationType!==d.c.Init&&r.navigationType!==d.c.Next&&r.navigationType!==d.c.Prev&&(S.navigation=r.navigationType),i.hasOwnProperty(m.CachedInServer)&&(S[m.CachedInServer]=i[m.CachedInServer]),i.hasOwnProperty(m.RequestInfo)&&(S[m.RequestInfo]=i[m.RequestInfo]),i.hasOwnProperty(m.PlayTransitionMs)||(this.m_maxGotoSlideMs=Math.max(this.m_maxGotoSlideMs,this.getDuration(S[t])),this.getDuration(i[t])+y>u.a.readNumberOrDefault("vetoNavigationDurationMs",1250)&&0!==this.m_startFromTime&&c.e.recordVeto("VetoedSlideShowNavTimeMs",{qosVeto:"SlideShowNavSlow",...this.m_navigationData[_.toString()]}))));else t===n.Prefetch&&(i.hasOwnProperty("errorName")?S.hasOwnProperty("errorCount")?S.errorCount+=1:S.errorCount=1:S[t]=i[t],i.hasOwnProperty(n.Prerender)&&(S[n.Prerender]=i[n.Prerender]),i.hasOwnProperty(m.CachedInServer)&&(S[m.CachedInServer]=i[m.CachedInServer]),i.hasOwnProperty(m.RequestInfo)&&(S[m.RequestInfo]=i[m.RequestInfo]));if(i.sessionId=this.m_settings.appSettings.userSessionId,i.action=t,i.startFromTime=this.m_startFromTime,a.a.sendTraceTag(594650332,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,m.getLogString("navigation",i)),v=e.getVisibleSlideIndex({sid:i.sid,cid:0}),h.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&t===n.Goto){const e={id:i&&i.id,navType:r&&r.navigationType,sIdx:void 0!==this.m_slideIndexFromBoot?this.m_slideIndexFromBoot:void 0,timestamp:Date.now()};if(e.sr=i.sr,e.playTransitionMs=i.playTransitionMs,e.slideDistanceFromLaunch=void 0!==this.m_slideIndexFromBoot&&void 0!==v?v-this.m_slideIndexFromBoot:void 0,e.loadSlide=i.LoadSlide,e.fPrepared=i.fPrepared,e.bootLaunchId=this.m_bootLaunchId,r&&r.navigationType===d.c.Init)this.m_userActionTimestamp=l.a.performanceNowTrimmed();else if(r&&(r.navigationType===d.c.Next||r.navigationType===d.c.Prev||r.navigationType===d.c.GoTo)){const t=l.a.performanceNowTrimmed();e.timeSpentOnPrevSlide=t-this.m_userActionTimestamp,this.m_userActionTimestamp=t,e.navType=r.navigationType}a.a.sendTraceTag(507787460,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,m.getLogString("addOnnavigation",e))}}}static logPerfData(){if(0===Object.keys(this.m_navigationData).length)return;const e=[],t=Object.keys(this.m_navigationData).map(t=>{const i=this.m_navigationData[t],r={};return r.id=t,Object.keys(i).forEach(t=>{if(t===n.Goto||t===n.Prefetch||t===n.Prerender)r[t]=this.getDuration(i[t]);else if(t===this.Metadata){for(const t of i[this.Metadata])t.hasOwnProperty(this.MediaInfo)&&e.push(t[this.MediaInfo]);const t=this.getMetadataSummary(i[this.Metadata]);t.length>0&&(r[this.Metadata]=t)}else r[t]=i[t]}),r}),i={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,maxNav:this.m_maxGotoSlideMs,navList:t,Config:l.a.getSessionConfig()};l.a.recordSessionStats({maxNav:this.m_maxGotoSlideMs}),a.a.sendTraceTag(594650331,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("navSummary",i));const r={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,mediaInfoObjects:e,Config:l.a.getSessionConfig()};Object.keys(e).length>0&&a.a.sendTraceTag(591165197,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("mediaSummary",r))}static getMetadataSummary(e){const t=[];for(const i in e)if(e[i].hasOwnProperty(this.MediaInfo)){const n=e[i][this.MediaInfo];t.includes(n.type)||t.push(n.type)}else t.includes(e[i])||t.push(e[i]);return t}static getDuration(e){return e.end-e.start}static getLogString(e,t){if(!t)return"";const i=JSON.stringify(t),n=i.length;return n>3e3&&a.a.sendTraceTag(506856673,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`log size is too long! size:${n}, source:${e}`),i}}m.m_navigationData={},m.m_maxGotoSlideMs=0,m.m_startFromTime=0,m.m_userActionTimestamp=0,m.m_initInfo={},m.RenderCost="render",m.Metadata="metadata",m.NavigationStep="step",m.CachedInServer="cached",m.PlayTransitionMs="playTransitionMs",m.GetItemsResult="getItemsResult",m.UseSnapDownloadUrlString="useSnap",m.MediaInfo="mediaInfo",m.RequestInfo="requestInfo",m.TextureMetadata="textureMetadata",m.RenderTransitionTextures="renderTransitionTextures",m.GenerateMorphResource="generateMorphResource",m.RenderToTexture="renderToTexture"},function(e,t,i){"use strict";i.r(t),i.d(t,"__extends",(function(){return r})),i.d(t,"__assign",(function(){return a})),i.d(t,"__rest",(function(){return s})),i.d(t,"__decorate",(function(){return o})),i.d(t,"__param",(function(){return l})),i.d(t,"__esDecorate",(function(){return d})),i.d(t,"__runInitializers",(function(){return c})),i.d(t,"__propKey",(function(){return h})),i.d(t,"__setFunctionName",(function(){return u})),i.d(t,"__metadata",(function(){return m})),i.d(t,"__awaiter",(function(){return f})),i.d(t,"__generator",(function(){return p})),i.d(t,"__createBinding",(function(){return g})),i.d(t,"__exportStar",(function(){return _})),i.d(t,"__values",(function(){return S})),i.d(t,"__read",(function(){return v})),i.d(t,"__spread",(function(){return y})),i.d(t,"__spreadArrays",(function(){return T})),i.d(t,"__spreadArray",(function(){return b})),i.d(t,"__await",(function(){return w})),i.d(t,"__asyncGenerator",(function(){return C})),i.d(t,"__asyncDelegator",(function(){return I})),i.d(t,"__asyncValues",(function(){return P})),i.d(t,"__makeTemplateObject",(function(){return E})),i.d(t,"__importStar",(function(){return k})),i.d(t,"__importDefault",(function(){return M})),i.d(t,"__classPrivateFieldGet",(function(){return A})),i.d(t,"__classPrivateFieldSet",(function(){return R})),i.d(t,"__classPrivateFieldIn",(function(){return O})),i.d(t,"__addDisposableResource",(function(){return F})),i.d(t,"__disposeResources",(function(){return L}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var a=function(){return(a=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}function o(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s}function l(e,t){return function(i,n){t(i,n,e)}}function d(e,t,i,n,r,a){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=n.kind,d="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?n.static?e:e.prototype:null,h=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),u=!1,m=i.length-1;m>=0;m--){var f={};for(var p in n)f[p]="access"===p?{}:n[p];for(var p in n.access)f.access[p]=n.access[p];f.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");a.push(s(e||null))};var g=(0,i[m])("accessor"===l?{get:h.get,set:h.set}:h[d],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(o=s(g.get))&&(h.get=o),(o=s(g.set))&&(h.set=o),(o=s(g.init))&&r.unshift(o)}else(o=s(g))&&("field"===l?r.unshift(o):h[d]=o)}c&&Object.defineProperty(c,n.name,h),u=!0}function c(e,t,i){for(var n=arguments.length>2,r=0;r<t.length;r++)i=n?t[r].call(e,i):t[r].call(e);return n?i:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,i){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,i,n){return new(i||(i=Promise))((function(r,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))}function p(e,t){var i,n,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var g=Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]};function _(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||g(t,e,i)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,a=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return s}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function T(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,r++)n[r]=a[s];return n}function b(e,t,i){if(i||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function C(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(e,t||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){r[e]&&(n[e]=function(t){return new Promise((function(i,n){a.push([e,t,i,n])>1||o(e,t)}))})}function o(e,t){try{(i=r[e](t)).value instanceof w?Promise.resolve(i.value.v).then(l,d):c(a[0][2],i)}catch(e){c(a[0][3],e)}var i}function l(e){o("next",e)}function d(e){o("throw",e)}function c(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function I(e){var t,i;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,r){t[n]=e[n]?function(t){return(i=!i)?{value:w(e[n](t)),done:!1}:r?r(t):t}:r}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=S(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){!function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}(n,r,(t=e[i](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&g(t,e,i);return x(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function A(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)}function R(e,t,i,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,i):r?r.value=i:t.set(e,i),i}function O(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function F(e,t,i){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:i})}else i&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,i){var n=new Error(i);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function L(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function i(){for(;e.stack.length;){var n=e.stack.pop();try{var r=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(r).then(i,(function(e){return t(e),i()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}t.default={__extends:r,__assign:a,__rest:s,__decorate:o,__param:l,__metadata:m,__awaiter:f,__generator:p,__createBinding:g,__exportStar:_,__values:S,__read:v,__spread:y,__spreadArrays:T,__spreadArray:b,__await:w,__asyncGenerator:C,__asyncDelegator:I,__asyncValues:P,__makeTemplateObject:E,__importStar:k,__importDefault:M,__classPrivateFieldGet:A,__classPrivateFieldSet:R,__classPrivateFieldIn:O,__addDisposableResource:F,__disposeResources:L}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a}));class n{}var r,a;n.skewEmitter="Skew_Emitter",n.skewReceiver="Skew_Receiver",n.teamsNotified="Teams_Notified",n.teamsLocal="Teams_Local",n.elapsedTime="Total_Elapsed_MS",n.mediaEventEmitted="PPT_ModernSS_Emit_Media",n.mediaEventCompleted="PPT_ModernSS_Complete_Media",n.mediaEventOutOfOrder="Media_Event_Out_Of_Order",n.mediaEventDuplicate="Media_Event_Duplicate",n.stateNotified="State_Notified",n.stateLocal="State_Local",n.annotationEventEmitted="PPT_ModernSS_Emit_Annotation",n.annotationEventCompleted="PPT_ModernSS_Complete_Annotation",n.bootstrapperNotified="Bootstrapper_Notified",n.bootstrapperLocal="Bootstrapper_Local",n.ic3Notified="Teams_Notified_IC3",n.ic3Local="Teams_Local_IC3",n.mediaEventType="mediaEventType",n.mediaSyncTimeLine="mediaSyncTimeLine",n.senderId="senderId",n.senderIdSystem="system",n.syncEventEmitTime="PPT_ModernSS_Emit_Time_Ms",n.syncEventCompleteTime="PPT_ModernSS_Complete_Time_Ms",function(e){e.Unknown="srcUNKNOWN",e.Teams="srcTEAMS",e.State="srcSTATE"}(r||(r={})),function(e){e.Media="Media",e.SyncStateManager="SyncStateManager"}(a||(a={}))},function(e,t,i){"use strict";var n,r,a;i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a})),function(e){e.SlideShowUIRootContainer="SlideShowUIRootContainer",e.ThumbnailStrip="ThumbnailStrip",e.NotesPane="NotesPane",e.SlideShowToolbar="SlideShowToolbar",e.GridView="GridView",e.ResumeSlideShow="ResumeSlideShow",e.SlideShowTop="SlideShowTop",e.OpticalZoomPopover="OpticalZoomPopover",e.SlideShowAndToolbarContainer="SlideShowAndToolbarContainer"}(n||(n={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(r||(r={})),function(e){e.SlideShowAndToolbar="SlideShowAndToolbar",e.ThumbnailStrip="ThumbnailStrip",e.NotesPane="NotesPane"}(a||(a={}))},function(e,t,i){"use strict";i.d(t,"j",(function(){return c})),i.d(t,"o",(function(){return n})),i.d(t,"b",(function(){return h})),i.d(t,"n",(function(){return m})),i.d(t,"l",(function(){return f})),i.d(t,"a",(function(){return g})),i.d(t,"p",(function(){return S})),i.d(t,"f",(function(){return v})),i.d(t,"d",(function(){return y})),i.d(t,"c",(function(){return w})),i.d(t,"e",(function(){return C})),i.d(t,"h",(function(){return I})),i.d(t,"i",(function(){return P})),i.d(t,"m",(function(){return E})),i.d(t,"k",(function(){return x})),i.d(t,"g",(function(){return k}));var n,r=i(0),a=i(6),s=i(68),o=(i(2),i(15)),l=i(18),d=i(14);class c{get last(){return this.start+this.length-1}equals(e){return this.start==e.start&&this.length==e.length}includes(e){return e>=this.start&&e<=this.last}intersects(e){return this.start<=e.last&&this.last>=e.start}contains(e){return this.start<=e.start&&e.last<=this.last}getIntersection(e){const t=c.FromFirstLast(Math.max(this.start,e.start),Math.min(this.last,e.last));return t.length>=0?t:void 0}move(e){return new c(this.start+e,this.length)}static FromFirstLast(e,t){return new c(e,t+1-e)}constructor(e,t){this.start=e,this.length=t}}!function(e){e[e.highlighter=0]="highlighter",e[e.single=1]="single",e[e.double=2]="double",e[e.heavy=3]="heavy",e[e.dotted=4]="dotted",e[e.dottedHeavy=5]="dottedHeavy",e[e.dash=6]="dash",e[e.dashHeavy=7]="dashHeavy",e[e.dashLong=8]="dashLong",e[e.dashLongHeavy=9]="dashLongHeavy",e[e.dotDash=10]="dotDash",e[e.dotDashHeavy=11]="dotDashHeavy",e[e.dotDotDash=12]="dotDotDash",e[e.dotDotDashHeavy=13]="dotDotDashHeavy",e[e.wavy=14]="wavy",e[e.wavyHeavy=15]="wavyHeavy",e[e.wavyDouble=16]="wavyDouble"}(n||(n={}));class h{onDataChange(){}onRangeChange(){}onDataRemoved(e){}onDataAdded(e){}get defaultData(){return this.m_defaultData}get ranges(){const e=[];for(let t of this.m_dataPerRange||[])e.push(t.range);return e}get allData(){const e=[this.m_defaultData];for(let t of this.m_dataPerRange||[])e.push(t.data);return e}get dataPerRange(){return this.m_dataPerRange||[]}set defaultData(e){this.m_defaultData=e}set(e,t){if(this.onDataChange(),t){for(let i of this.m_dataPerRange||[])if(i.range.start==t.start&&i.range.last==t.last)return this.onDataRemoved(i.data),i.data=e,void this.onDataAdded(i.data);for(let e of this.m_dataPerRange||[])this.onDataRemoved(e.data);this.onRangeChange();const i=[];let n=!1;for(let r of this.m_dataPerRange||[])r.range.start<t.start&&i.push({range:c.FromFirstLast(r.range.start,Math.min(r.range.last,t.start-1)),data:r.data}),t.last<r.range.last&&(n||(i.push({range:t,data:e}),n=!0),i.push({range:c.FromFirstLast(Math.max(r.range.start,t.last+1),r.range.last),data:r.data}));n||i.push({range:t,data:e}),this.m_dataPerRange=i;for(let e of this.m_dataPerRange||[])this.onDataAdded(e.data)}else{for(let e of this.m_dataPerRange||[])this.onDataRemoved(e.data);this.m_defaultData=e,this.m_dataPerRange=void 0}}getAt(e){for(let t of this.m_dataPerRange||[])if(t.range.start<=e&&e<=t.range.last)return t.data;return this.m_defaultData}shiftIndices(e,t){if(this.m_dataPerRange){const i=[],n=t-e.length;for(let r of this.m_dataPerRange)if(e.contains(r.range)&&e.start!=r.range.start)this.onDataRemoved(r.data);else if(r.range.includes(e.start)){const n=Math.min(e.length,r.range.last+1-e.start);i.push({range:new c(r.range.start,r.range.length+t-n),data:r.data})}else r.range.start<=e.last&&e.last<=r.range.last?i.push({range:c.FromFirstLast(e.start+t,r.range.last+n),data:r.data}):e.last<r.range.start?i.push({range:r.range.move(n),data:r.data}):i.push(r);this.m_dataPerRange=i}}constructor(e){this.m_defaultData=e}}class u extends h{get changeTracker(){return this.m_changeTracker}get rangeChangeTracker(){return this.m_rangeChangeTracker}onDataChange(){this.m_changeTracker.notifyChange()}onRangeChange(){this.rangeChangeTracker.notifyChange()}onDataRemoved(e){l.a.RemoveListener(e.changeTracker,this.m_changeTracker)}onDataAdded(e){l.a.AddListener(e.changeTracker,this.m_changeTracker)}constructor(e){super(e),this.m_changeTracker=new l.a,this.m_rangeChangeTracker=new l.a,this.m_changeTracker.replaceListener(void 0,e)}}class m{clone(){return new m(this.m_type,this.m_verticalCenter,this.m_thickness,this.m_style?this.m_style.clone():void 0)}get type(){return this.m_type}get verticalCenter(){return this.m_verticalCenter}get thickness(){return this.m_thickness}get style(){return this.m_style}get changeTracker(){return this.m_changeTracker}set type(e){Object(d.a)(this.changeTracker,this.m_type,e),this.m_type=e}set verticalCenter(e){Object(d.a)(this.changeTracker,this.m_verticalCenter,e),this.m_verticalCenter=e}set thickness(e){Object(d.a)(this.changeTracker,this.m_thickness,e),this.m_thickness=e}set style(e){this.changeTracker.replaceListener(this.m_style,e),this.m_style=e}constructor(e,t,i,n){this.m_changeTracker=new l.a,this.m_type=e,this.m_verticalCenter=t,this.m_thickness=i,this.style=n}}class f{clone(){return new f(this.m_fade?this.m_fade.clone():void 0,this.m_animationTransform)}equals(e){return(this.m_fade==e.m_fade||null!=this.m_fade&&null!=e.m_fade&&this.m_fade.equals(e.m_fade))&&(this.m_animationTransform==e.m_animationTransform||null!=this.m_animationTransform&&null!=e.m_animationTransform&&this.m_animationTransform.equals(e.m_animationTransform))&&this.m_isHidden==e.m_isHidden}get fade(){return this.m_fade}get animationTransform(){return this.m_animationTransform}get isHidden(){return!!this.m_isHidden}get changeTracker(){return this.m_changeTracker}set fade(e){this.m_changeTracker.replaceListener(this.m_fade,e),this.m_fade=e}set animationTransform(e){Object(d.c)(this.m_changeTracker,this.m_animationTransform,e),this.m_animationTransform=e}set isHidden(e){e!=this.isHidden&&(this.m_changeTracker.notifyChange(),this.m_isHidden=e)}constructor(e,t,i=!1){this.m_changeTracker=new l.a,this.m_animationTransform=t,this.m_isHidden=i,this.fade=e}}const p=new r.c(0,-1,0,1,0,0,0,0,1);class g{equals(e){return this.lineRect.equals(e.lineRect)&&this.path==e.path&&this.alignment==e.alignment&&this.scale==e.scale&&this.pivot==e.pivot&&this.isVerticalLayout==e.isVerticalLayout}getPathPosition(e){const t=this.isVerticalLayout?e.transformedBounds(p):e,i=this.isVerticalLayout?this.lineRect.transformedBounds(p):this.lineRect;if(!t||!i)return;const n=i.width;let r=0;if(n*this.scale<this.pathLength){const e=this.pathLength-n*this.scale;r=this.alignment*(e/this.pathLength)}const a=(t.left-i.left)*this.scale/this.pathLength+r;return(a+(a+t.width/this.pathLength*this.scale))/2}getTransform(e){const t=this.getPathPosition(e),i=this.isVerticalLayout?e.transformedBounds(p):e;if(!t||!i)return;const n=Object(r.h)(t,0,1)*this.pathLength,a=this.path.getPointFromDist(n),s=this.path.getTangentFromDist(n);if(!s)return;const o=(i.left+i.right)/2,l=i.top+i.height*this.pivot;let d=r.c.Translation2D(new r.f(-o,-l));d=d.multiply(r.c.Scale2D(new r.f(this.scale,this.scale)));const c=s.x,h=s.y;return d=d.multiply(new r.c(c,h,0,-h,c,0,0,0,1)),d=d.multiply(r.c.Translation2D(a)),this.isVerticalLayout&&(d=p.multiply(d)),d}calculateEquivalentWarpingEnvelope(){const e=new o.b,t=new o.b,i=this.isVerticalLayout?0:this.lineRect.height/2,n=this.isVerticalLayout?this.lineRect.top:this.lineRect.left,a=this.isVerticalLayout?this.lineRect.bottom:this.lineRect.right;let s=this.lineRect;for(let o=0;o<=1;o+=1/256){const l=n+(a-n)*o,d=this.isVerticalLayout?new r.d(this.lineRect.right,l-i,this.lineRect.left,l+i):new r.d(l-i,this.lineRect.top,l+i,this.lineRect.bottom),c=this.getPathPosition(d);if(null!=c&&c>=0&&c<=1){const n=l+(2*o-1)*i,a=this.getTransform(d);if(a){const i=a.transformPoint(this.isVerticalLayout?new r.f(d.left,n):new r.f(n,d.top)),o=a.transformPoint(this.isVerticalLayout?new r.f(d.right,n):new r.f(n,d.bottom));0==e.getPointCount()?(e.moveToPoint(i),t.moveToPoint(o),s=new r.d(this.isVerticalLayout?s.left:n,this.isVerticalLayout?n:s.top,s.right,s.bottom)):(e.lineToPoint(i),t.lineToPoint(o),s=new r.d(s.left,s.top,this.isVerticalLayout?s.right:n,this.isVerticalLayout?n:s.bottom))}}}return new S(s,e.createFigure(),t.createFigure(),this.isVerticalLayout)}constructor(e,t,i,n,r,a){this.lineRect=e,this.path=t,this.alignment=i,this.scale=n,this.pivot=r,this.isVerticalLayout=a,this.pathLength=t.measureLength(),this.equivalentWarpingEnvelope=this.calculateEquivalentWarpingEnvelope()}}class _{moveTo(e){const t=Math.floor(256*e),i=Math.min(t+1,256),n=256*e-t;this.currentX=this.m_samplesX[t]*(1-n)+this.m_samplesX[i]*n,this.currentY=this.m_samplesY[t]*(1-n)+this.m_samplesY[i]*n}equals(e){for(let t=0;t<=256;t++)if(this.m_samplesX[t]!=e.m_samplesX[t]||this.m_samplesY[t]!=e.m_samplesY[t])return!1;return!0}constructor(e){this.currentX=0,this.currentY=0,this.m_samplesX=new Float32Array(257),this.m_samplesY=new Float32Array(257);const t=e.measureLength();for(let i=0;i<=256;i++){const n=e.getPointFromDist(t*i/256);this.m_samplesX[i]=n.x,this.m_samplesY[i]=n.y}}}class S{equals(e){return this.sourceRect.equals(e.sourceRect)&&this.topCurve.equals(e.topCurve)&&this.bottomCurve.equals(e.bottomCurve)&&this.isVerticalLayout==e.isVerticalLayout}warpPoint(e){const t=Object(r.h)(this.isVerticalLayout?(e.y-this.sourceRect.top)/this.sourceRect.height:(e.x-this.sourceRect.left)/this.sourceRect.width,0,1),i=Object(r.h)(this.isVerticalLayout?1-(e.x-this.sourceRect.left)/this.sourceRect.width:(e.y-this.sourceRect.top)/this.sourceRect.height,0,1);return this.topCurve.moveTo(t),this.bottomCurve.moveTo(t),new r.f(Object(r.p)(this.topCurve.currentX,this.bottomCurve.currentX,i),Object(r.p)(this.topCurve.currentY,this.bottomCurve.currentY,i))}warpPath(e){const t=[],i=Math.max(this.sourceRect.width)/4,n=r.c.FromTransforms(e.transform);for(let a of e.figures)if(a.getPointCount()>0){const e=new o.b;e.moveToPoint(this.warpPoint(a.getPoint(0).transformPoint(n))),a.forEachSegment((t,a,s)=>{const o=a||r.f.InterpolateLinear(t,s,.5),l=i>0?Math.max(1,Math.ceil(Math.abs(s.x-t.x)/i)):1;for(let i=0;i<l;i++){const a=this.warpPoint(r.f.InterpolateQuadratic(t,o,s,i/l).transformPoint(n)),d=this.warpPoint(r.f.InterpolateQuadratic(t,o,s,(i+.5)/l).transformPoint(n)),c=this.warpPoint(r.f.InterpolateQuadratic(t,o,s,(i+1)/l).transformPoint(n)),h=d.add(d.subtract(r.f.InterpolateLinear(a,c,.5)));e.quadBezierToPoint(h,c)}return!0}),a.isClosed&&e.close(),t.push(e.createFigure())}return new o.d({figures:t,fillMode:e.fillMode,lineEnabled:e.lineEnabled,extrusionEnabled:e.extrusionEnabled,transform:void 0})}unwarpPoint(e,t){let i,n=0,a=1;for(let t=0;t<16;t++){const t=(n+a)/2,r=this.getClosestWarpSample(n,e),s=this.getClosestWarpSample(a,e);r.p.subtract(e).lengthSquared()<s.p.subtract(e).lengthSquared()?(i=r,a=t):(i=s,n=t)}if(!(i&&t&&(i.u<=0||i.u>=1||i.v<=0||i.v>=1)))return i?this.sourceRect.relativeToAbsolute(new r.f(i.u,i.v)):void 0}getClosestWarpSample(e,t){this.topCurve.moveTo(e),this.bottomCurve.moveTo(e);const i=new r.f(this.topCurve.currentX,this.topCurve.currentY),n=new r.f(this.bottomCurve.currentX,this.bottomCurve.currentY),a=n.subtract(i),s=t.subtract(i).dot(a)/a.lengthSquared();return{u:e,v:s,p:r.f.InterpolateLinear(i,n,Math.max(0,Math.min(1,s)))}}constructor(e,t,i,n=!1){this.sourceRect=e,this.topPath=t,this.bottomPath=i,this.isVerticalLayout=n,this.topCurve=new _(t),this.bottomCurve=new _(i)}}class v{equals(e){return this.image==e.image&&this.rect==e.rect}constructor(e,t,i,n){this.image=e,this.rect=t,this.transform=i,this.useLocalCordinates=!!n}}class y{equals(e){return!(!this.layoutBounds.equals(e.layoutBounds)||this.forceWarping!=e.forceWarping||this.isWhiteSpace!=e.isWhiteSpace||this.isRTL!=e.isRTL||this.textImage!=e.textImage||!T(this.paths,e.paths)||!T(this.outlinePath,e.outlinePath)||this.paths||e.paths)}getTranslatedCopy(e){let t=b(this.paths,e),i=b(this.outlinePath,e);return new y(this.layoutBounds.translate(e),t,this.forceWarping,this.isWhiteSpace,this.textImage,i,this.isRTL)}constructor(e,t,i,n,r,a,s){this.layoutBounds=e,this.paths=t instanceof Array?t.slice(0):t,this.outlinePath=a instanceof Array?a.slice(0):a,this.forceWarping=i,this.isWhiteSpace=n,this.textImage=r,this.isRTL=s}}function T(e,t){if(!e&&!t)return!0;if(e instanceof o.d&&t instanceof o.d)return e.equals(t);if(e instanceof Array&&t instanceof Array){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].equals(t[i]))return!1;return!0}return!e&&!t}function b(e,t){let i=void 0;if(e instanceof o.d)i=new o.d(e,e.transform.applyTranslationAfter(t));else if(e){i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=new o.d(e[n],e[n].transform.applyTranslationAfter(t))}return i}class w{clone(){const e=new w(this.m_character,this.m_style?this.m_style.clone():void 0,this.m_effects?this.m_effects.clone():void 0);if(this.m_strokes){e.m_strokes=new l.b;for(let t of this.m_strokes.elements)e.m_strokes.push(t.clone())}return e}get character(){return this.m_character}get style(){return this.m_style}get effects(){return this.m_effects}get strokes(){return this.m_strokes}get changeTracker(){return this.m_changeTracker}set character(e){this.m_character.equals(e)||(this.m_changeTracker.notifyChange(),this.m_character=e)}set style(e){this.m_changeTracker.replaceListener(this.m_style,e),this.m_style=e}set effects(e){this.m_changeTracker.replaceListener(this.m_effects,e),this.m_effects=e}set strokes(e){this.m_changeTracker.replaceListener(this.m_strokes,e),this.m_strokes=e}equals(e){return!!this.m_character.equals(e.m_character)&&this.m_style==e.m_style&&this.m_effects==e.effects&&this.m_strokes==e.m_strokes}constructor(e,t,i,n){this.m_changeTracker=new l.a,this.m_character=e,this.style=t,this.effects=i,this.strokes=n}}class C{equals(e){return this.ascent==e.ascent&&this.descent==e.descent&&this.fontHeightInPoints==e.fontHeightInPoints}constructor(e,t,i){this.ascent=e,this.descent=t,this.fontHeightInPoints=i}}class I{clone(){const e=new I(this.m_localRange,this.m_layoutBounds);for(let t of this.m_characters)e.addCharacter(t);return e.m_offset=this.m_offset,e.m_fillBounds=this.m_fillBounds,e.m_textEffectMetrics=this.m_textEffectMetrics,e.bender=this.m_bender,e}get characters(){return this.m_characters}get localRange(){return this.m_localRange}get offset(){return this.m_offset}get layoutBounds(){return this.m_layoutBounds}get fillBounds(){return this.m_fillBounds}get textEffectMetrics(){return this.m_textEffectMetrics}get bender(){return this.m_bender}get changeTracker(){return this.m_changeTracker}set localRange(e){Object(d.c)(this.m_changeTracker,this.m_localRange,e),this.m_localRange=e}set offset(e){Object(d.c)(this.m_changeTracker,this.m_offset,e),this.m_offset=e}set layoutBounds(e){Object(d.c)(this.m_changeTracker,this.m_layoutBounds,e),this.m_layoutBounds=e}set fillBounds(e){Object(d.c)(this.m_changeTracker,this.m_fillBounds,e),this.m_fillBounds=e}set textEffectMetrics(e){Object(d.c)(this.m_changeTracker,this.m_textEffectMetrics,e),this.m_textEffectMetrics=e}set bender(e){this.bender==e||this.bender instanceof g&&e instanceof g&&this.bender.equals(e)||this.bender instanceof S&&e instanceof S&&this.bender.equals(e)||(this.m_changeTracker.notifyChange(),this.m_bender=e)}set characters(e){Object(d.d)(this.m_changeTracker,this.m_characters,e),this.m_characters=e.slice(0)}removeAllCharacters(){this.characters=[]}addCharacter(e){this.m_changeTracker.notifyChange(),this.m_characters.push(e)}constructor(e,t){this.m_changeTracker=new l.a,this.m_characters=[],this.m_localRange=e,this.m_layoutBounds=t,this.m_fillBounds=t,this.m_offset=r.f.Zero}}class P{clone(){const e=new P(this.m_globalRange,this.m_stylePerLocalRange.defaultData);for(let t of this.m_lines)e.addLine(t.clone());e.m_offset=this.m_offset,e.bullet=this.m_bullet?this.m_bullet.clone():void 0;for(let t of this.m_stylePerLocalRange.ranges)e.m_stylePerLocalRange.set(this.m_stylePerLocalRange.getAt(t.start).clone(),t);e.m_effectsPerLocalRange.defaultData=this.m_effectsPerLocalRange.defaultData;for(let t of this.m_effectsPerLocalRange.ranges)e.m_effectsPerLocalRange.set(this.m_effectsPerLocalRange.getAt(t.start).clone(),t);e.m_strokesPerLocalRange.defaultData=this.m_strokesPerLocalRange.defaultData;for(let t of this.m_strokesPerLocalRange.ranges){const i=this.m_strokesPerLocalRange.getAt(t.start),n=new l.b;for(let e of i.elements)n.push(e.clone());e.m_strokesPerLocalRange.set(n,t)}return e.m_localWordRanges=this.m_localWordRanges.slice(0),e}get lines(){return this.m_lines}get stylePerLocalRange(){return this.m_stylePerLocalRange}get effectsPerLocalRange(){return this.m_effectsPerLocalRange}get strokesPerLocalRange(){return this.m_strokesPerLocalRange}get globalRange(){return this.m_globalRange}get offset(){return this.m_offset}get bullet(){return this.m_bullet}get localWordRanges(){return this.m_localWordRanges}get changeTracker(){return this.m_changeTracker}set stylePerLocalRange(e){this.m_changeTracker.replaceListener(this.m_stylePerLocalRange,e),this.m_stylePerLocalRange=e}set effectsPerLocalRange(e){this.m_changeTracker.replaceListener(this.m_effectsPerLocalRange,e),this.m_effectsPerLocalRange=e}set strokesPerLocalRange(e){this.m_changeTracker.replaceListener(this.m_strokesPerLocalRange,e),this.m_strokesPerLocalRange=e}set globalRange(e){this.m_globalRange.equals(e)||(this.m_changeTracker.notifyChange(),this.m_globalRange=e)}set offset(e){Object(d.c)(this.m_changeTracker,this.m_offset,e),this.m_offset=e}set bullet(e){this.m_changeTracker.replaceListener(this.m_bullet,e),this.m_bullet=e}set localWordRanges(e){Object(d.d)(this.m_changeTracker,this.m_localWordRanges,e),this.m_localWordRanges=e.slice(0)}removeAllLocalWordRanges(){this.localWordRanges=[]}addLocalWordRange(e){this.m_changeTracker.notifyChange(),this.m_localWordRanges.push(e)}set lines(e){this.removeAllLines();for(let t of e)this.addLine(t)}removeAllLines(){for(let e of this.m_lines)l.a.RemoveListener(e.changeTracker,this.m_changeTracker);this.m_lines=[]}addLine(e){l.a.AddListener(e.changeTracker,this.m_changeTracker),this.m_lines.push(e)}constructor(e,t){this.m_lines=[],this.m_localWordRanges=[],this.m_changeTracker=new l.a,this.m_globalRange=e,this.m_stylePerLocalRange=new u(t),this.m_effectsPerLocalRange=new u(new s.a),this.m_strokesPerLocalRange=new u(new l.b),this.m_changeTracker.replaceListener(void 0,this.m_stylePerLocalRange),this.m_offset=r.f.Zero}}var E,x;!function(e){e[e.AllAtOnce=0]="AllAtOnce",e[e.ByWord=1]="ByWord",e[e.ByLetter=2]="ByLetter"}(E||(E={})),function(e){e[e.TextInFrontOfShape=0]="TextInFrontOfShape",e[e.ShapeStyleOnText=1]="ShapeStyleOnText",e[e.ShapeCutout=2]="ShapeCutout",e[e.LinesCutout=3]="LinesCutout"}(x||(x={}));class k{clone(){const e=new k;for(let t of this.m_paragraphs)e.addParagraph(t.clone());if(e.m_layoutToFrame=this.m_layoutToFrame,e.m_frameToShape=this.m_frameToShape,this.m_animationProps){e.m_animationProps=new u(new f),e.m_animationProps.defaultData=this.m_animationProps.defaultData;for(let t of this.m_animationProps.ranges)e.m_animationProps.set(this.m_animationProps.getAt(t.start).clone(),t)}if(this.m_selectionHighlights){e.m_selectionHighlights=[];for(let t of this.m_selectionHighlights)e.m_selectionHighlights.push(t.clone())}return e}createAnimationProps(){this.animationProps=new u(new f)}hasAnimationProps(){return!!this.animationProps}get paragraphs(){return this.m_paragraphs}get layoutToFrame(){return this.m_layoutToFrame}get frameToShape(){return this.m_frameToShape}get animationProps(){return this.m_animationProps}get selectionHighlights(){return this.m_selectionHighlights}get clipBounds(){return this.m_clipBounds}get applyEffectsPerCharacter(){return!!this.m_applyEffectsPerCharacter}get changeTracker(){return this.m_changeTracker}get animationChangeTracker(){return this.m_animationChangeTracker}get textVersion(){return this.m_changeTracker.version}get selectionVersion(){return this.m_selectionChangeTracker.version}get renderMode(){return this.m_renderMode}get linesCutoutMargin(){return this.m_linesCutoutMargin||r.f.Zero}get spreadFill(){return!!this.m_spreadFill}set layoutToFrame(e){Object(d.c)(this.m_changeTracker,this.m_layoutToFrame,e),this.m_layoutToFrame=e}set frameToShape(e){Object(d.c)(this.m_changeTracker,this.m_frameToShape,e),this.m_frameToShape=e}set selectionHighlights(e){Object(d.b)(this.m_selectionChangeTracker,this.m_selectionHighlights,e),this.m_selectionHighlights=e?e.slice(0):void 0}set clipBounds(e){Object(d.c)(this.m_changeTracker,this.m_clipBounds,e),this.m_clipBounds=e}set applyEffectsPerCharacter(e){Object(d.a)(this.m_changeTracker,!!this.m_applyEffectsPerCharacter,e),this.m_applyEffectsPerCharacter=e}set animationProps(e){this.m_animationProps!=e&&(this.m_animationProps&&(l.a.RemoveListener(this.m_animationProps.changeTracker,this.m_animationChangeTracker),l.a.RemoveListener(this.m_animationProps.rangeChangeTracker,this.m_changeTracker)),e&&(l.a.AddListener(e.changeTracker,this.m_animationChangeTracker),l.a.AddListener(e.rangeChangeTracker,this.m_changeTracker)),this.m_animationProps=e)}set paragraphs(e){if(this.m_paragraphs!=e){this.removeAllParagraphs();for(let t of e)this.addParagraph(t)}}set renderMode(e){Object(d.a)(this.m_changeTracker,this.m_renderMode,e),this.m_renderMode=e}set linesCutoutMargin(e){Object(d.c)(this.m_changeTracker,this.m_linesCutoutMargin,e),this.m_linesCutoutMargin=e}set spreadFill(e){Object(d.a)(this.m_changeTracker,!!this.m_spreadFill,e),this.m_spreadFill=e}forceSplit(e){(!this.m_explicitTextSplit||e>this.m_explicitTextSplit)&&(this.m_changeTracker.notifyChange(),this.m_explicitTextSplit=e)}removeAllParagraphs(){for(let e of this.m_paragraphs)l.a.RemoveListener(e.changeTracker,this.m_changeTracker);this.m_paragraphs=[]}addParagraph(e){l.a.AddListener(e.changeTracker,this.m_changeTracker),this.m_paragraphs.push(e)}removeParagraph(e){l.a.RemoveListener(this.m_paragraphs[e].changeTracker,this.m_changeTracker),this.m_paragraphs.splice(e)}getFullRange(){return this.paragraphs.length<1?void 0:c.FromFirstLast(this.paragraphs[0].globalRange.start,this.paragraphs[this.paragraphs.length-1].globalRange.last)}getRunRanges(){const e=this.getFullRange();if(e){let t=[];for(const e of this.paragraphs)if(this.m_explicitTextSplit==E.ByLetter||this.applyEffectsPerCharacter)for(let i=e.globalRange.start;i<=e.globalRange.last;i++)M(t,i);else{const i=e.globalRange.start;for(let n of e.lines)M(t,i+n.localRange.start),M(t,i+n.localRange.last+1);for(let n of e.stylePerLocalRange.ranges)M(t,i+n.start),M(t,i+n.last+1);for(let n of e.effectsPerLocalRange.ranges)M(t,i+n.start),M(t,i+n.last+1);for(let n of e.strokesPerLocalRange.ranges)M(t,i+n.start),M(t,i+n.last+1);if(this.m_explicitTextSplit==E.ByWord)for(let n of e.localWordRanges)M(t,i+n.start),M(t,i+n.last+1)}if(this.animationProps)for(let e of this.animationProps.ranges)t.some(t=>t==e.start)||t.push(e.start),t.some(t=>t==e.last+1)||t.push(e.last+1);return A(t,e)}return[]}getAnimatablePartRanges(e,t,i){let n=t||this.getFullRange();if(!n||0==n.length)return;if(t&&i){if(t.start<0||t.start>=this.paragraphs.length||t.last<0||t.last>=this.paragraphs.length)return void a.a.Error(592525336,"bad paragraph range");n=c.FromFirstLast(this.paragraphs[t.start].globalRange.start,this.paragraphs[t.last].globalRange.last)}if(e==E.AllAtOnce)return n?[n]:void 0;let r=[];for(let t of this.paragraphs){const i=t.globalRange.start;for(let n of t.lines)if(M(r,i+n.localRange.start),M(r,i+n.localRange.last+1),e==E.ByLetter){const e=i+n.localRange.start;let t=!1;for(let i=0;i<n.characters.length;i++)t||M(r,e+i),t=1==n.characters[i].isWhiteSpace}if(e==E.ByWord)for(let e of t.localWordRanges)M(r,i+e.start)}return A(r,n)}getTextPathsForCharacter(e,t,i,n){const s=[],l=n&&e.outlinePath?e.outlinePath:e.paths,d=l instanceof o.d?[l]:null!=l?l:[];for(let n of d)if(n.figures.length>0){const l=r.c.Translation2D(t).multiply(this.layoutToFrame.toMatrix3());let d=n.transform.toMatrix3().multiply(l).tryGetTransform(n.transform.preTranslation);if(!d)throw a.a.Error(592525337,"unexpected transform");{let t=new o.d(n,d),r=i instanceof S?i:void 0;if(i instanceof g){const a=e.layoutBounds.isEmpty()?void 0:e.layoutBounds.transformedBounds(l);if(e.forceWarping||!a)r=i.equivalentWarpingEnvelope;else{const e=i.getTransform(a);e&&(d=d.toMatrix3().multiply(e.toMatrix3()).tryGetTransform(n.transform.preTranslation),t=d?new o.d(n,d):void 0)}}r&&t&&(t=r.warpPath(t)),t&&s.push(t)}}return s}getTextPathsForRange(e,t){const i=[];for(let n of this.paragraphs)if(n.globalRange.intersects(e))for(let r of n.lines){const a=new c(0,r.characters.length).getIntersection(e.move(-n.globalRange.start-r.localRange.start));if(a)for(let e=a.start;e<=a.last;e++){const a=this.getTextPathsForCharacter(r.characters[e],r.offset.add(n.offset),r.bender,t);i.push(...a)}}return i}getLineAndParagraphAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e)){const i=e-t.globalRange.start;for(let e of t.lines)if(e.localRange.includes(i))return{line:e,paragraph:t}}}getStyleAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e))return t.stylePerLocalRange.getAt(e-t.globalRange.start)}getEffetcsAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e))return t.effectsPerLocalRange.getAt(e-t.globalRange.start)}getStrokesAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e))return t.strokesPerLocalRange.getAt(e-t.globalRange.start)}getPathFromLayoutRect(e,t,i){const n=r.c.Translation2D(i).multiply(this.layoutToFrame.toMatrix3()).tryGetTransform(r.f.Zero);if(n){let i=new o.d({figures:[o.a.CreateFromRect(e)],transform:n});const r=t.bender instanceof g?t.bender.equivalentWarpingEnvelope:t.bender;return r&&(i=r.warpPath(i)),i}}getSelectionRectPaths(e){let t=void 0;for(let i of this.paragraphs){const n=e?e.move(-i.globalRange.start):void 0;for(let e of i.lines){let a=void 0;if(!n||e.characters&&n.intersects(e.localRange))for(let t=0;t<e.characters.length;t++){const i=e.localRange.start+t;(!n||n.start<=i&&i<=n.last)&&(a=r.d.UnionRect(a,e.characters[t].layoutBounds))}if(a){const n=this.getPathFromLayoutRect(a,e,e.offset.add(i.offset));n&&(t||(t=[]),t.push(n))}}}return t}getCutoutLinePath(e,t){let i=void 0;const n=[];for(let i of this.paragraphs){const s=e?e.move(-i.globalRange.start):void 0;for(let e of i.lines){let o=void 0;if(!s||e.characters&&s.intersects(e.localRange))for(let t=0;t<e.characters.length;t++){const i=e.localRange.start+t;(!s||s.start<=i&&i<=s.last)&&(o=r.d.UnionRect(o,e.characters[t].layoutBounds))}if(o){const t=e.offset.add(i.offset),n=r.c.Translation2D(t).multiply(this.layoutToFrame.toMatrix3());o=o.transformedBounds(n)}e.bender&&a.a.Error(528320162,"LinesCutout currently not supported with Benders."),o&&n.push(new r.d(o.left-t.x,o.top-t.y,o.right+t.x,o.bottom+t.y))}}if(n.length>0){const e=new o.b;e.moveTo(n[0].left,n[0].top),e.lineTo(n[0].right,n[0].top);for(let t=0;t<n.length-1;t++){const i=n[t].right,r=n[t+1].right,a=i>r?n[t].bottom:n[t+1].top;e.lineTo(i,a),e.lineTo(r,a)}e.lineTo(n[n.length-1].right,n[n.length-1].bottom),e.lineTo(n[n.length-1].left,n[n.length-1].bottom);for(let t=n.length-1;t>0;t--){const i=n[t].left,r=n[t-1].left,a=i<r?n[t].top:n[t-1].bottom;e.lineTo(i,a),e.lineTo(r,a)}e.close(),i=[o.d.CreateFromFigure(e.createFigure())]}return i}getBoundsOfRange(e,t,i=!1){if(!i||!this.animationProps)return this.getBoundsOfRangeStatic(e,t);let n=this.getFullRange();if(!n)return;let a=[];for(let e of this.animationProps.ranges)M(a,e.start),M(a,e.last+1);const s=A(a,n);let o;for(let e of s){const i=this.animationProps.getAt(e.start).animationTransform,n=t&&i?t.toMatrix3().multiply(i):t||i;o=r.d.UnionRect(o,this.getBoundsOfRangeStatic(e,n))}return o}getBoundsOfRangeStatic(e,t){let i;const n=t?this.frameToShape.toMatrix3().multiply(t.toMatrix3()):this.frameToShape;let a=this.getSelectionRectPaths(e);for(let t of this.paragraphs)if(t.bullet&&t.lines.length>0&&(!e||e.includes(t.globalRange.start))){const e=this.getPathFromLayoutRect(t.bullet.character.layoutBounds,t.lines[0],t.offset);e&&(a=a?a.concat(e):[e])}for(let e of a||[])e.untransformedBounds&&(i=r.d.UnionRect(i,e.untransformedBounds.transformedBounds(e.transform.toMatrix3().multiply(n.toMatrix3()))));return i}getSelectionLayoutCaretPath(e,t,i){for(let n of this.paragraphs){const s=e-n.globalRange.start;for(let e of n.lines){e.localRange.length!=e.characters.length&&a.a.Error(592525338,"character count mismatch");const o=s-e.localRange.start;let l;if(0<=o&&o<e.characters.length){const i=e.characters[o].layoutBounds,n=e.characters[o].isRTL?i.right:i.left;l=new r.d(n-.5*t,i.top,n+.5*t,i.bottom)}else if(0==o&&0==e.characters.length){const i=e.layoutBounds.left;l=new r.d(i-.5*t,e.layoutBounds.top,i+.5*t,e.layoutBounds.bottom)}else if(i&&s==e.localRange.last+1){const i=e.characters[e.characters.length-1].layoutBounds,n=e.characters[e.characters.length-1].isRTL?i.left:i.right;l=new r.d(n-.5*t,i.top,n+.5*t,i.bottom)}if(l)return this.getPathFromLayoutRect(l,e,e.offset.add(n.offset))}}}getLineAndParagraphFromLayoutPosition(e){let t=void 0,i=void 0;for(let n of this.paragraphs)for(let r of n.lines){if(e.subtract(n.offset).subtract(r.offset).y<r.layoutBounds.bottom)return{paragraph:n,line:r};t=r,i=n}return{paragraph:i,line:t}}getSelectionFromLayoutPosition(e){const t=this.getLineAndParagraphFromLayoutPosition(e),i=t.paragraph,n=t.line;if(!i||!n||!n.characters)return;const r=e.subtract(i.offset).subtract(n.offset);let a,s,o,l=!1;for(let e=0;e<n.characters.length;e++){const t=n.characters[e].layoutBounds,i=n.characters[e].isRTL?t.right:t.left,l=Math.abs(i-r.x),d=Math.abs(t.center.x-r.x);(void 0===s||void 0===o||l<s||l==s&&d<o)&&(a=e,s=l,o=d)}if(a==n.characters.length-1){const e=n.characters[a].layoutBounds.center.x;(r.x-e)*(n.characters[a].isRTL?-1:1)>0&&(a++,l=!0)}return void 0!==a?{characterIndex:i.globalRange.start+n.localRange.start+a,isAnchoredToPrevious:l}:void 0}hitTest(e){for(let t of this.paragraphs)for(let i of t.lines||[]){let n=e;if(i.bender){const t=e.transformPoint(this.layoutToFrame.toMatrix3()),r=(i.bender instanceof g?i.bender.equivalentWarpingEnvelope:i.bender).unwarpPoint(t,!0);if(!r)return!1;n=r.transformPoint(this.layoutToFrame.toInverseMatrix3())}const r=n.subtract(t.offset).subtract(i.offset);if(i.layoutBounds.isPointInRect(r))return!0}return!1}getBrushImages(){const e=[];for(let t of this.paragraphs){t.bullet&&t.bullet.style&&e.push(...t.bullet.style.getBrushImages()),t.stylePerLocalRange.allData.forEach(t=>{e.push(...t.getBrushImages())}),t.strokesPerLocalRange.allData.forEach(t=>{for(let i of t.elements)i.style&&e.push(...i.style.getBrushImages())});for(let i of t.lines)for(let t of i.characters)t.textImage&&e.push(t.textImage.image)}return e}constructor(){this.m_paragraphs=[],this.m_changeTracker=new l.a,this.m_animationChangeTracker=new l.a,this.m_selectionChangeTracker=new l.a,this.m_layoutToFrame=r.e.Identity,this.m_frameToShape=r.e.Identity,this.m_renderMode=x.TextInFrontOfShape}}function M(e,t){e.some(e=>e==t)||e.push(t)}function A(e,t){M(e,t.start),M(e,t.last+1),e.sort((e,t)=>e-t);const i=[];for(let n=0;n<e.length-1;n++){const r=c.FromFirstLast(e[n],e[n+1]-1).getIntersection(t);r&&r.length>0&&i.push(r)}return i}},function(e,t,i){"use strict";function n(e,t,i=1401298e-51){return Math.abs(e-t)<=i}function r(e,t){return e===t?e:Math.random()*(t-e)+e}function a(e,t,i){return e+(t-e)*i}function s(e,t=0,i=1){return Math.min(i,Math.max(t,e))}function o(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}function l(e){const t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()}i.d(t,"f",(function(){return n})),i.d(t,"d",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"e",(function(){return l}))},function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return r})),function(e){e[e.PDF=0]="PDF"}(n||(n={})),function(e){e[e.SemiDryStrokeAdded=0]="SemiDryStrokeAdded",e[e.SemiDryStrokeErased=1]="SemiDryStrokeErased",e[e.SemiDryEraseAll=2]="SemiDryEraseAll",e[e.WetStrokeStart=3]="WetStrokeStart",e[e.WetStrokeAppend=4]="WetStrokeAppend",e[e.WetStrokeEnd=5]="WetStrokeEnd",e[e.LaserStart=6]="LaserStart",e[e.LaserMove=7]="LaserMove",e[e.LaserEnd=8]="LaserEnd",e[e.LaserRemove=9]="LaserRemove",e[e.InitAnnotation=10]="InitAnnotation",e[e.SetInitialInkSnapshot=11]="SetInitialInkSnapshot",e[e.CursorMove=12]="CursorMove",e[e.CursorHide=13]="CursorHide",e[e.ReplaceLastPoint=14]="ReplaceLastPoint",e[e.MakeWetStrokeStraight=15]="MakeWetStrokeStraight",e[e.CanvasZoom=16]="CanvasZoom"}(r||(r={})),i(13)},function(e,t,i){"use strict";var n;i.d(t,"d",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return o})),function(e){e[e.RGB=4]="RGB",e[e.RGBA=5]="RGBA",e[e.LUMINANCE=1]="LUMINANCE",e[e.LUMINANCE_ALPHA=2]="LUMINANCE_ALPHA",e[e.BGR=-1]="BGR",e[e.BGRA=-2]="BGRA",e[e.NV12=-3]="NV12"}(n||(n={}));const r=[0,1,2,0,3,4];class a{add(e){this.totalCostMs+=e.totalCostMs,this.shapeRenderCostMs+=e.shapeRenderCostMs,this.distanceFieldForTextCostMs+=e.distanceFieldForTextCostMs,this.distanceFieldForGlyphTableCostMs+=e.distanceFieldForGlyphTableCostMs,this.distanceFieldForShapeCostMs+=e.distanceFieldForShapeCostMs,this.patternTextureCostMs+=e.patternTextureCostMs,this.pathGradientTextureCostMs+=e.pathGradientTextureCostMs,this.gradientTextureCostMs+=e.gradientTextureCostMs,this.fadeTextureCostMs+=e.fadeTextureCostMs,this.effectsCostMs+=e.effectsCostMs,this.cacheToSpriteCostMs+=e.cacheToSpriteCostMs,this.drawTapeCostMs+=e.drawTapeCostMs,this.glResetCostMs+=e.glResetCostMs,this.glRestoreCostMs+=e.glRestoreCostMs,this.pathCount+=e.pathCount,this.glyphCount+=e.glyphCount,this.glyphCountAddedToCache+=e.glyphCountAddedToCache,this.glyphCountReadFromCache+=e.glyphCountReadFromCache,this.glyphCountRenderedAsPath+=e.glyphCountRenderedAsPath,this.glyphCountLargeText+=e.glyphCountLargeText,this.glyphCountTextOutline+=e.glyphCountTextOutline,this.pixelCountDistanceField+=e.pixelCountDistanceField,this.pixelCountShapeRender+=e.pixelCountShapeRender,this.shapeLayerCount+=e.shapeLayerCount,this.shapeLayerCountText+=e.shapeLayerCountText,this.dynamicTextureAlloc+=e.dynamicTextureAlloc,this.beginTime=0,this.endTime=0}constructor(){this.totalCostMs=0,this.shapeRenderCostMs=0,this.distanceFieldForTextCostMs=0,this.distanceFieldForGlyphTableCostMs=0,this.distanceFieldForShapeCostMs=0,this.patternTextureCostMs=0,this.pathGradientTextureCostMs=0,this.gradientTextureCostMs=0,this.fadeTextureCostMs=0,this.effectsCostMs=0,this.cacheToSpriteCostMs=0,this.drawTapeCostMs=0,this.glResetCostMs=0,this.glRestoreCostMs=0,this.pathCount=0,this.glyphCount=0,this.glyphCountAddedToCache=0,this.glyphCountReadFromCache=0,this.glyphCountRenderedAsPath=0,this.glyphCountLargeText=0,this.glyphCountTextOutline=0,this.pixelCountDistanceField=0,this.pixelCountShapeRender=0,this.shapeLayerCount=0,this.shapeLayerCountText=0,this.dynamicTextureAlloc=0,this.beginTime=0,this.endTime=0}}class s{constructor(){this.frameCount=0}}class o{constructor(){this.recreatingSprites=0,this.pictureCropBWTextures=0}}},function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return o}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var a=function(){return(a=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e,t,i,n){return new(i||(i=Promise))((function(r,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))}function o(e,t,i){if(i||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}Object.create,Object.create},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return s})),i.d(t,"b",(function(){return o})),i(128),i(6),function(e){e[e.distanceField=0]="distanceField",e[e.shapeRender=1]="shapeRender",e[e.gradient=2]="gradient",e[e.blur=3]="blur",e[e.fade=4]="fade",e[e.copyTexture=5]="copyTexture",e[e.copyTexturePictureEffects=6]="copyTexturePictureEffects",e[e.draw3D=7]="draw3D",e[e.copyTextureDrawMask=8]="copyTextureDrawMask",e[e.sharpnessFilter=9]="sharpnessFilter",e[e.magic=10]="magic",e[e.median=11]="median",e[e.count=12]="count",e[e.countMinimalSet=2]="countMinimalSet"}(n||(n={}));const r={};function a(e){return r[e]}function s(e,t){r[e]=t}function o(e){return"sb-"+e}},function(e,t,i){"use strict";var n,r,a,s,o,l;i.d(t,"j",(function(){return T})),i.d(t,"f",(function(){return b})),i.d(t,"h",(function(){return n})),i.d(t,"g",(function(){return d})),i.d(t,"a",(function(){return a})),i.d(t,"i",(function(){return s})),i.d(t,"d",(function(){return c})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"e",(function(){return h})),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(n||(n={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(r||(r={}));class d{}d.unknown="unknown",d.ErrorCode="ErrorCode",d.ErrorCategory="ErrorCategory",d.errorCategory="errorCategory",d.errorCode="errorCode",d.IsIntentional="IsIntentional",d.isIntentional="isIntentional",d.XCorrelationId="X-CorrelationId",d.ContentType="Content-Type",d.ContentLength="Content-Length",d.ContenEncoding="Content-Encoding",d.TransferEncoding="Transfer-Encoding",d.XusedOutputCache="X-usedOutputCache",d.Xnewsnapurl="x-newsnapurl",d.ContentDisposition="Content-Disposition",d.CallerCorrelationId="CallerCorrelationId",d.action="action",d.parser="parser",d.server="server",d.callId="callId",d.dateHeader="x-ms-date",d.clientTimeoutHeader="x-ms-client-timeout",d.clientRequestIdHeader="x-ms-client-request-id",d.newSnapUrlHeader="x-newsnapurl",d.correlationId="correlationId",d.firstResponseCheck="firstResponseCheck",d.fetchBoundary="fetchBoundary",d.downloadResponse="downloadResponse",d.parserCallback="parserCallback",d.createResponse="createResponse",d.contentLength="contentLength",d.usedOutputCache="usedOutputCache",d.itemUsedOutputCacheMap="itemUsedOutputCacheMap",d.podsProxyCallSuceeded="podsProxyCallSuceeded",d.PriorityHint="PriorityHint",d.RequestInfo="RequestInfo",d.ResponseHeaders="ResponseHeaders",d.IsBootRequest="IsBootRequest",d.XErrorCode="X-ErrorCode",function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(a||(a={})),function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(s||(s={}));class c{}c.PresInfoMetaData="presinfo/metadata",c.PresinfoslimSlideOrder="presinfo/slimSlideOrder",c.slideInfoIndex="pres/sldIdx",c.slideInfoSid="pres/sldSid",c.slideNotesIndex="pres/NotesSldIdx",c.slideNotesSid="pres/NotesSldSid",c.slideCommentsIndex="pres/CommentsSldIdx",c.slideCommentsSid="pres/CommentsSldSid",c.slideMetadataIndex="pres/SlideMetadatasldIdx",c.slideMetadataSid="pres/SlideMetadataSldSid",c.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",c.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid",function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.ErrorRESERVEDItemFailed="ErrorRESERVEDItemFailed",e.ErrorDownloadResponseStreamTimeout="ErrorDownloadResponseStreamTimeout",e.ErrorRequestFailed="ErrorRequestFailed",e.ErrorRequestFailedServiceUnavailable="ErrorRequestFailedServiceUnavailable",e.ErrorRequestFailedBadGateway="ErrorRequestFailedBadGateway",e.ErrorRequestFailedGatewayTimeout="ErrorRequestFailedGatewayTimeout",e.ErrorRequestFailedServerNotFound="ErrorRequestFailedServerNotFound",e.ErrorContentDispositionHeaderNotValid="ErrorContentDispositionHeaderNotValid",e.ErrorItemNameNotValid="ErrorItemNameNotValid",e.ErrorResponseNotValid="ErrorResponseNotValid",e.ErrorCannotParseResponse="ErrorCannotParseResponse",e.ErrorRequestTimeout="ErrorRequestTimeout",e.ErrorFailedToFetch="ErrorFailedToFetch",e.ErrorRequestCanceled="ErrorRequestCanceled",e.ErrorRequestAbort="ErrorRequestAbort",e.ErrorConnectionLost="ErrorConnectionLost",e.ErrorSoftwareConnectionAbort="ErrorSoftwareConnectionAbort",e.ErrorFailedToDownloadFile="ErrorFailedToDownloadFile",e.ErrorFileDownloadNetworkError="ErrorFileDownloadNetworkError",e.ErrorFileDownloadResourceInconsistent="ErrorFileDownloadResourceInconsistent",e.ErrorResourceInconsistentResnaptimeout="ErrorResourceInconsistentResnaptimeout",e.ErrorResourceInconsistentResnapNotStarted="ErrorResourceInconsistentResnapNotStarted",e.ErrorResourceInconsistentResnapUrlMissing="ErrorResourceInconsistentResnapUrlMissing",e.ServerErrorFileDownloadResourceInconsistent="ServerErrorFileDownloadResourceInconsistent",e.ServerErrorResourceInconsistentResnaptimeout="ServerErrorResourceInconsistentResnaptimeout",e.ServerErrorResourceInconsistentResnapNotStarted="ServerErrorResourceInconsistentResnapNotStarted",e.ServerErrorResourceInconsistentResnapUrlMissing="ServerErrorResourceInconsistentResnapUrlMissing"}(o||(o={})),function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.BadRequest="BadRequest",e.Fatal="Fatal",e.NotSupported="NotSupported",e.Transient="Transient"}(l||(l={}));class h{}h.JsonType="application/json",h.ImagePng="image/png",h.ImageJpg="image/jpg",h.PlainTextType="text/plain";var u=i(167),m=i(4),f=i(9),p=i(3),g=i(7),_=i(34);class S{parsePart(e){if(e&&e.Headers){this.m_perfDictionary[d.parserCallback]?(this.m_perfDictionary[d.parserCallback].callCounter=this.m_perfDictionary[d.parserCallback].callCounter+1,this.m_perfDictionary[d.parserCallback].lastCallStart=b.performanceNowTrimmed()):this.m_perfDictionary[d.parserCallback]={lastCallStart:b.performanceNowTrimmed(),lastCallEnd:b.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};const t=e.Headers.get(d.ContentDisposition),i=e.Headers.get(d.ContentType);this.m_parsedBasedResponse.usedOutputCache=e.Headers.get(d.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=e.Headers.get(d.Xnewsnapurl);const n=e.Headers.get(d.ErrorCode)||o.ErrorRESERVEDSuccess,r=e.Headers.get(d.ErrorCategory)||l.ErrorRESERVEDSuccess,a=e.Headers.get(d.XusedOutputCache);if(t){let s;const l=t.indexOf("pres%2fSlideMetadatasldIdx")>0;try{s=decodeURIComponent(t.substring(t.indexOf("name=")+5).trim())}catch(e){f.a.sendTraceTag(595641600,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::parseMultipartResponse - partResponse Error:"+e)}if(s){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(s,n),this.m_parsedBasedResponse.itemErrorCategoryMap.set(s,r),a&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(s,a),n&&n.trim().toLowerCase()===o.ErrorRESERVEDSuccess.toLowerCase())if(t.indexOf("presinfo%2fslimSlideOrder")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body));for(const e of t)this.parsedResponse.slideOrder.push({sid:e,cid:0})}else if(t.indexOf("presinfo%2fmetadata")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body)),i=[];for(const e of t.SidSlideOrder)i.push({sid:e,cid:0});const n=t.SidHiddenSlides?t.SidHiddenSlides.map(e=>({sid:e,cid:0})):void 0;let r={Item:null};t.SlideShowProperties.Item||(r={Item:null}),t.SlideShowProperties.Item.s?r={Item:{sid:t.SlideShowProperties.Item.s}}:t.SlideShowProperties.Item.st&&(r={Item:{start:t.SlideShowProperties.Item.st,end:t.SlideShowProperties.Item.end}});const a={SlideOrder:i,HiddenSlideOrder:n,SlideEmuWidth:t.SlideEmuWidth,SlideEmuHeight:t.SlideEmuHeight,ViewScalingFactor:t.ViewScalingFactor,SlideShowProperties:r,Sections:t.Sections};this.parsedResponse.slideAllInfo.push(a)}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&i&&S.getSupportedImageType(i)){const n=S.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx");let r="";for(let t=0;t<e.Body.length;t+=1)r+=String.fromCharCode(e.Body[t]);const a=`data:${S.getSupportedImageType(i)};base64, ${btoa(r)}`;this.m_perfDictionary[d.parserCallback].slidesHaveImages.push(n),this.m_responses[n]||(this.m_responses[n]={ID:{sid:n,cid:0}}),this.m_responses[n].SlideImageData=a}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&i&&-1!==i.indexOf("application/json")){const i=S.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),n=JSON.parse(new TextDecoder("utf-8").decode(e.Body));n.mediaUrls?(this.m_responses[i]||(this.m_responses[i]={ID:{sid:n.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[i].SlideShowInfo=n.slideShowInfo,this.m_responses[i].MediaUrls=n.mediaUrls):(this.m_responses[i]||(this.m_responses[i]={ID:{sid:n.sld[0].id,cid:0}}),this.m_responses[i].SlideShowInfo=n)}else if(t.indexOf("pres%2fNotesSldSid")>0||t.indexOf("pres%2fNotesSldIdx")>0){const i=S.getSlideKeyFromHeader(t,t.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),n=new TextDecoder("utf-8").decode(e.Body);this.m_responses[i]||(this.m_responses[i]={ID:{sid:i,cid:0}}),this.m_responses[i].NoteHtml=n}else if(t.indexOf("pres%2fCommentsSldSid")>0||t.indexOf("pres%2fCommentsSldIdx")>0){const i=S.getSlideKeyFromHeader(t,t.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),n=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[i]||(this.m_responses[i]={ID:{sid:i,cid:0}}),this.m_responses[i].Comments=n}else if(t.indexOf("pres%2fSlideMetadataSldSid")>0||l){const i=S.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),n=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[i]||(this.m_responses[i]={ID:n.ID}),this.m_responses[i].Title=n.Title,this.m_responses[i].HasAnimation=n.HasAnimation,this.m_responses[i].Hidden=n.Hidden,this.m_responses[i].HasTransition=n.HasTransition}else if(t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||t.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){const i=S.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),n=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[i]||(this.m_responses[i]={ID:n.ID}),this.m_responses[i].AccessibilityModel=n.AccessibilityModel}else if(t.indexOf("Res%2fSldSid")>0&&i&&S.getSupportedImageType(i)){const n=S.extractStringInBetweenStrings(t,"Res%2fSldSid","%2f"),r=S.extractStringInBetweenStrings(t,"filename=","\r");if(n&&r){const t={sid:+n,cid:0},a=S.getSupportedImageType(i);let s,o;if(e.Body)if(this.m_settings.allowImagesAsBinary)s={Id:r,Base64:"",Binary:e.Body,MimeType:a,ByteCount:e.Body.length};else{let t="";for(let i=0;i<e.Body.length;i+=1)t+=String.fromCharCode(e.Body[i]);const i=`data:${a};base64,${btoa(t)}`;s={Id:r,Base64:i,MimeType:a,ByteCount:i.length}}else f.a.sendTraceTag(508420494,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::parseMultipartResponse - Body is undefined. slideId:${n}, resourceId:${r}`),s={Id:r,Base64:"",MimeType:a,ByteCount:0};this.m_perfDictionary[d.parserCallback].slidesHaveImageResources.push(t.sid);for(const[,e]of Object.entries(this.m_responses))e.ID&&e.ID.sid===t.sid&&(o=e);o?o.ResourceData?o.ResourceData.push(s):o.ResourceData=[s]:this.m_responses[t.sid]={ID:t,ResourceData:[s]}}else f.a.sendTraceTag(595628568,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:${n}, resourceId:${r}`),this.m_parsedBasedResponse.responseErrorCode=o.ErrorResponseNotValid}}else this.m_parsedBasedResponse.responseErrorCode=o.ErrorItemNameNotValid}else e.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(e.Headers.get("x-ms-content-id"),n),this.m_parsedBasedResponse.itemErrorCategoryMap.set(e.Headers.get("x-ms-content-id"),r)),this.m_parsedBasedResponse.responseErrorCode=o.ErrorContentDispositionHeaderNotValid;this.m_perfDictionary[d.parserCallback].lastCallEnd=b.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode=o.ErrorResponseNotValid;e.Err&&(this.m_parsedBasedResponse.responseErrorCode=o.ErrorResponseNotValid,f.a.sendTraceTag(595687003,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy::parseMultipartResponse - partResponse Error:"+e.Err))}static getSupportedImageType(e){return b.s_supportedImageType.find(t=>-1!==e.indexOf(t))||""}static getSlideKeyFromHeader(e,t){const i=new RegExp(`.*${t}(.*)`);if(!e)return f.a.sendTraceTag(508420493,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;const n=i.exec(e);return null!=n&&n.length>=2?+n[1]:(f.a.sendTraceTag(508420492,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::getSlideLocationFromHeader - regex result is null header:${e}, itemId: ${t}`),-1)}static extractStringInBetweenStrings(e,t,i){const n=e.indexOf(t)+t.length,r=i?e.indexOf(i,n):-1;return-1===r?e.substring(n):e.substring(n,r)}constructor(e,t,i,n){this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=e,this.m_responses=t,this.m_perfDictionary=i,this.m_parsedBasedResponse=n}}var v=i(1);const y={};function T(e){e.logger&&f.a.setLogger(e.logger),e.settings&&v.a.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&m.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=y)}class b{async getSlideOrderAsync(){const e=await this.getPresInfoAsync("getSlideOrderAsync"),t=await e.json();return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:t.SlideOrder}}async getSlideInfosAsync(e){e.RenderOptions&&(this.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map(e=>e.slideId),RenderOptions:e.RenderOptions}]),this.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_getPresInfoRequest.ClientWidth,this.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_getPresInfoRequest.ClientHeight,this.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:this.m_getPresInfoRequest.DevicePixelRatio,this.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_getPresInfoRequest.IsHighContrast,this.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_getPresInfoRequest.ClientColorSettings,this.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_getPresInfoRequest.MinClientWidth,this.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_getPresInfoRequest.MinClientHeight,this.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_getPresInfoRequest.MaxClientWidth,this.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_getPresInfoRequest.MaxClientHeight;const t=await this.getPresInfoAsync("getSlideInfosAsync"),i=await t.json();return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:i.Slides}}async getItemsSlideOrderAsync(){this.m_itemsList=new Array,this.m_itemsList.push({Id:c.PresinfoslimSlideOrder,AcceptTypes:[h.JsonType]}),this.m_getItemsRequest.Items=this.m_itemsList;const e=await this.getItemsAsync("getItemsSlideOrderAsync");return await this.createSlideIdResponse(this.parseMultipartResponseAsync(e,{}))}async getItemsPresInfoAsync(e){this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:c.PresInfoMetaData,AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||"");const t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(d.RequestInfo,JSON.stringify(t));const i=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(d.clientRequestIdHeader,i),this.m_requestHeaders.set(d.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const n={action:"getItemsPresInfoAsync",correlationId:e.CorrelationId,server:{start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()}};b.logPerf(n);const r=await this.getItemsAsync("getItemsPresInfoAsync");n[d.server].end=b.performanceNowTrimmed(),r&&r.response&&r.response.headers&&(n[d.contentLength]=r.response.headers.get(d.ContentLength)),b.logPerf(n),n[d.parser]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()};const a=this.setTimeoutForParsingResponse(n),s=await this.createPresInfoResponse(this.parseMultipartResponseAsync(r,n));return clearTimeout(a),n[d.parser].end=b.performanceNowTrimmed(),n[d.usedOutputCache]=!!s.usedOutputCache&&"true"===s.usedOutputCache.trim().toLowerCase(),n[d.itemUsedOutputCacheMap]=!!s.itemUsedOutputCacheMap&&Array.from(s.itemUsedOutputCacheMap.entries()),b.logPerf(n),s.metadata=this.generateReportPerfDictionary(n),s}async getItemsPresInfoAndSlideInfosAsync(e,t,i){const a={action:"getItemsPresInfoAndSlideInfoAsync"};let s=null;try{this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:c.PresInfoMetaData,AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_imageOptions.InputProperties.ClientWidth=t.ClientWidth?t.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=t.ClientHeight?t.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=t.IsHighContrast?t.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=t.MinClientWidth?t.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=t.MinClientHeight?t.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=t.TranslateLanguage?t.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage;for(let e=0;e<t.SlideLocations.length;e+=1)t.GetSlideImage?this.m_itemsList.push({Id:t.SlideLocations[e].slideId?c.slideInfoSid+t.SlideLocations[e].slideId.sid.toString():c.slideInfoIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:b.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):t.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:t.ClientWidth?t.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:t.ClientHeight?t.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:t.IsHighContrast?t.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:t.ColorMode?t.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:t.ClientColorSettings?t.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=b.ensureISlideInfoFilters(t.Filters),this.m_itemsList.push({Id:t.SlideLocations[e].slideId?c.slideInfoSid+t.SlideLocations[e].slideId.sid.toString():c.slideInfoIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==t.GetSlideAccessibilityModelData&&t.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?c.slideAccessibilityModelSid+t.SlideLocations[e].slideId.sid.toString():c.slideAccessibilityModelIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),t.GetSlideNotes&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?c.slideNotesSid+t.SlideLocations[e].slideId.sid.toString():c.slideCommentsIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[h.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),t.GetSlideComments&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?c.slideCommentsSid+t.SlideLocations[e].slideId.sid.toString():c.slideCommentsIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[h.JsonType],Options:t.CommentOptions});this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||"");const u={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(d.RequestInfo,JSON.stringify(u));const m=this.objectDictionaryToRequestIdString(u);this.m_requestHeaders.set(d.clientRequestIdHeader,m),this.m_requestHeaders.set(d.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():""),a.correlationId=e.CorrelationId,a[d.server]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},b.logPerf(a),this.events.emit("requestStageChanged",{requestType:n.getItemsPresInfoAndSlideInfoAsync,stageInfo:r.GetItemsCall});const f=await this.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:i&&i.overrideGetItemsTimeoutMs});if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&f.errorCode===o.ServerErrorFileDownloadResourceInconsistent)return{presInfo:void 0,slideInfo:[],responseErrorCode:o.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:f.errorCategory,responseIsIntentional:f.isIntentional,itemErrorCodeMap:void 0};if(a[d.server].end=b.performanceNowTrimmed(),f&&f.response&&f.response.headers){a[d.contentLength]=f.response.headers.get(d.ContentLength),a[d.ContenEncoding]=f.response.headers.get(d.ContenEncoding),a[d.TransferEncoding]=f.response.headers.get(d.TransferEncoding);const e=f.response.headers.keys();if(e){const t=[];for(const i of e)t.push(i);a[d.ResponseHeaders]=t}}b.logPerf(a),a[d.parser]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},s=this.setTimeoutForParsingResponse(a);const p=await this.parseMultipartResponseAsync(f,a,{shouldTimeoutResponseStreamDownload:i&&i.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:i&&i.overrideDownloadTimeoutMs,requestType:n.getItemsPresInfoAndSlideInfoAsync});if(p&&p.responseErrorCode===o.ErrorDownloadResponseStreamTimeout)return{presInfo:void 0,slideInfo:[],responseErrorCode:o.ErrorDownloadResponseStreamTimeout,responseErrorCategory:l.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0};const g=this.createPresInfoAndSlideInfoResponse(p,a);return null!==s&&(clearTimeout(s),s=null),a[d.parser].end=b.performanceNowTrimmed(),a[d.usedOutputCache]=!!g.usedOutputCache&&"true"===g.usedOutputCache.trim().toLowerCase(),a[d.itemUsedOutputCacheMap]=!!g.itemUsedOutputCacheMap&&Array.from(g.itemUsedOutputCacheMap.entries()),a[d.podsProxyCallSuceeded]=!0,b.logPerf(a),g.metadata=this.generateReportPerfDictionary(a),g}catch(e){return f.a.sendTraceTag(508420486,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: "+e),a[d.podsProxyCallSuceeded]=!1,b.logPerf(a),null!==s&&(clearTimeout(s),s=null),{presInfo:void 0,slideInfo:[],responseErrorCode:o.ErrorRESERVEDItemFailed,responseErrorCategory:l.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}}}async getItemsSlideInfosAsync(e){const t={action:"getItemsSlideInfosAsync"};try{this.m_imageOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=null!=e.IsHighContrast?e.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ColorMode=null!=e.ColorMode?e.ColorMode:this.m_imageInputProperties.ColorMode,this.m_imageOptions.InputProperties.ClientColorSettings=null!=e.ClientColorSettings?e.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=e.TranslateLanguage?e.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage,this.m_itemsList=new Array;for(let t=0;t<e.SlideLocations.length;t+=1)e.GetSlideImage?this.m_itemsList.push({Id:e.SlideLocations[t].slideId?c.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():c.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:b.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):e.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=e.LocaleName?e.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=b.ensureISlideInfoFilters(e.Filters),e.SkipGetSlideInfo||this.m_itemsList.push({Id:e.SlideLocations[t].slideId?c.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():c.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:e.LocaleName?e.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==e.GetSlideAccessibilityModelData&&e.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?c.slideAccessibilityModelSid+e.SlideLocations[t].slideId.sid.toString():c.slideAccessibilityModelIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),e.GetSlideNotes&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?c.slideNotesSid+e.SlideLocations[t].slideId.sid.toString():c.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[h.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),e.GetSlideComments&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?c.slideCommentsSid+e.SlideLocations[t].slideId.sid.toString():c.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[h.JsonType],Options:e.CommentOptions});if(0===this.m_itemsList.length)return f.a.sendTraceTag(508420485,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRequestFailed,responseErrorCategory:l.BadRequest,responseIsIntentional:!1,slideInfo:[]};this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||"");const t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(d.RequestInfo,JSON.stringify(t));const i=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(d.clientRequestIdHeader,i),this.m_requestHeaders.set(d.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const n={action:"getItemsSlideInfosAsync",correlationId:e.CorrelationId,server:{start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()}};let r;if(n.correlationId=e.CorrelationId,n[d.server]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},b.logPerf(n),this.m_settings.shouldFixSlideDataOrder){let t;e.GetSlideComments&&(t={isGetSlideCommentsRequest:!0}),r=await this.getItemsAsync("getItemsSlideInfosAsync",t)}else r=await this.getItemsAsync("getItemsSlideInfosAsync");if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&r.errorCode===o.ServerErrorFileDownloadResourceInconsistent)return{slideInfo:[],responseErrorCode:o.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:r.errorCategory,responseIsIntentional:!!r.headers.get(d.IsIntentional)&&r.headers.get(d.IsIntentional),itemErrorCodeMap:void 0};n[d.server].end=b.performanceNowTrimmed(),r&&r.response&&r.response.headers&&(n[d.contentLength]=r.response.headers.get(d.ContentLength)),n[d.parser]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},b.logPerf(n);const a=this.setTimeoutForParsingResponse(n),s=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(r,n),n);return clearTimeout(a),n[d.parser].end=b.performanceNowTrimmed(),n[d.usedOutputCache]=!!s.usedOutputCache&&"true"===s.usedOutputCache.trim().toLowerCase(),n[d.itemUsedOutputCacheMap]=!!s.itemUsedOutputCacheMap&&Array.from(s.itemUsedOutputCacheMap.entries()),n[d.podsProxyCallSuceeded]=!0,b.logPerf(n),s.metadata=this.generateReportPerfDictionary(n),s}catch(e){return f.a.sendTraceTag(508420484,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: "+e),t[d.podsProxyCallSuceeded]=!1,b.logPerf(t),{slideInfo:[],responseErrorCode:o.ErrorRESERVEDItemFailed,responseErrorCategory:l.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}}}async getItemsResourceAsync(e){this.m_slideResourceOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideResourceInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideResourceInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideResourceInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideResourceInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=e.LocaleName?e.LocaleName:this.m_slideResourceInputProperties.LocaleName},this.m_slideResourceOptions.Filters.EnableClustering=void 0!==e.EnableClustering&&e.EnableClustering,this.m_itemsList=new Array;for(const t of e.ResourceParams){this.m_slideResourceOptions.InputProperties.ResourceId=t.Id;let e="";switch(String(t.Name.match("[^.]+$"))){case"jpg":e=h.ImageJpg;break;case"png":e=h.ImagePng}this.m_itemsList.push({Id:t.Name,AcceptTypes:e?[e]:b.s_supportedImageType,Options:JSON.stringify(this.m_slideResourceOptions)})}this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const t={action:"getItemsResourceAsync",correlationId:e.CorrelationId,server:{start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()}};b.logPerf(t);const i=await this.getItemsAsync("getItemsResourceAsync");t[d.server].end=b.performanceNowTrimmed(),i&&i.response&&i.response.headers&&(t[d.contentLength]=i.response.headers.get(d.ContentLength)),t[d.parser]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},b.logPerf(t);const n=this.setTimeoutForParsingResponse(t),r=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(i,t),t);return clearTimeout(n),t[d.parser].end=b.performanceNowTrimmed(),t[d.usedOutputCache]=!!r.usedOutputCache&&"true"===r.usedOutputCache.trim().toLowerCase(),t[d.itemUsedOutputCacheMap]=!!r.itemUsedOutputCacheMap&&Array.from(r.itemUsedOutputCacheMap.entries()),b.logPerf(t),r.metadata=this.generateReportPerfDictionary(t),r}async getItemsSlideOrderAndSlidesInfoIndexAsync(e,t,i){this.m_getItemsRequest.Items.push({Id:c.PresinfoslimSlideOrder,AcceptTypes:[h.JsonType],Options:JSON.stringify(i)});const n=JSON.stringify(t);e&&e.forEach(e=>{this.m_getItemsRequest.Items.push({Id:`${c.slideInfoIndex}${e}`,AcceptTypes:[h.ImagePng,h.ImageJpg],Options:n})});const r={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()}};b.logPerf(r);const a=await this.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync");r[d.server].end=b.performanceNowTrimmed(),r[d.parser]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},a&&a.response&&a.response.headers&&(r[d.contentLength]=a.response.headers.get(d.ContentLength)),b.logPerf(r);const s=this.setTimeoutForParsingResponse(r),o=await this.createSlideOrderAndSlidesInfoIndexResponse(this.parseMultipartResponseAsync(a,r));return clearTimeout(s),r[d.parser].end=b.performanceNowTrimmed(),r[d.usedOutputCache]=!!o.usedOutputCache&&"true"===o.usedOutputCache.trim().toLowerCase(),r[d.itemUsedOutputCacheMap]=!!o.itemUsedOutputCacheMap&&Array.from(o.itemUsedOutputCacheMap.entries()),b.logPerf(r),o.metadata=this.generateReportPerfDictionary(r),o}async getItemsPresInfoAndSlideInfoIndexAsync(e,t,i){this.m_presInfoOptions.InputProperties.ClientHeight=i.ClientHeight?i.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=i.ClientWidth?i.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=i.IsHighContrast?i.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=i.ClientColorSettings?i.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==i.FilterHiddenSlideInfo?i.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==i.IncludeSections?i.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_getItemsRequest.Items.push({Id:c.PresInfoMetaData,AcceptTypes:[h.JsonType],Options:JSON.stringify(this.m_presInfoOptions)});const n=JSON.stringify(t);e&&e.forEach(e=>{this.m_getItemsRequest.Items.push({Id:`${c.slideInfoIndex}${e}`,AcceptTypes:[h.ImagePng,h.ImageJpg],Options:n})});const r={action:"getItemsPresInfoAndSlideInfoIndexAsync",server:{start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()}},a=await this.getItemsAsync("getItemsPresInfoAndSlideInfoIndexAsync");r[d.server].end=b.performanceNowTrimmed(),r[d.parser]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},a&&a.response&&a.response.headers&&(r[d.contentLength]=a.response.headers.get(d.ContentLength));const s=this.setTimeoutForParsingResponse(r),o=await this.createPresInfoAndSlideInfoIndexResponse(this.parseMultipartResponseAsync(a,r));return clearTimeout(s),r[d.parser].end=b.performanceNowTrimmed(),r[d.usedOutputCache]=!!o.usedOutputCache&&"true"===o.usedOutputCache.trim().toLowerCase(),r[d.itemUsedOutputCacheMap]=!!o.itemUsedOutputCacheMap&&Array.from(o.itemUsedOutputCacheMap.entries()),b.logPerf(r),o.metadata=this.generateReportPerfDictionary(r),o}async getPresInfoAsync(e){f.a.sendTraceTag(508420483,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy::getPresInfoAsync - Function:${e}, requestCorrelation:${this.m_requestHeaders.get(d.CallerCorrelationId)}`);const t=new AbortController,i=setTimeout(()=>t.abort(),3e4),n=await fetch(this.m_podsUrl+"/presinfo.ashx",{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getPresInfoRequest),signal:t.signal}).catch(async t=>{throw f.a.sendTraceTag(508420482,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy:getPresInfo - Function: ${e}, Error: ${t}`),t});return clearTimeout(i),f.a.sendTraceTag(508420481,p.a.msoulscat_Wac_PptSession,n.ok?g.a.Info:g.a.Error,`PodsProxy::getPresInfo - Function: ${e}, Status:${n.status}, StatusText: ${n.statusText}, CorrelationId: ${n.headers.get(d.XCorrelationId)}`),n}static getFieldFromReponseHeader(e,t){return e.headers?e.headers.get(t):d.unknown}async logGetItemFailureServerHeaders(e,t,i,n){const r={functionName:e,requestCorrelation:t,usePresentFrontDoor:i};r.headerCorrelationId=n&&n.headers?n.headers.get(d.XCorrelationId):d.unknown,r.headerErrorCode=n&&n.headers?n.headers.get(d.ErrorCode):d.unknown,r.xHeaderErrorCode=n&&n.headers?n.headers.get(d.XErrorCode):d.unknown,r.headerErrorCategory=n&&n.headers?n.headers.get(d.ErrorCategory):d.unknown,r.headerErrorIntentional=!(!n||!n.headers)&&n.headers.get(d.IsIntentional),r.status=n&&n.status?n.status:d.unknown,f.a.sendTraceTag(506852878,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:logGetItemFailureServerHeaders - "+JSON.stringify(r))}async getItemsAsync(e,t){const i=this.m_requestHeaders.get(d.CallerCorrelationId);f.a.sendTraceTag(508420480,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy::getItemsAsync - Function:${e}, requestCorrelation:${i}`);const n={errorCode:o.ErrorRESERVEDSuccess};let r=n,a="getItemsPresInfoAndSlideInfoAsync"===e&&this.m_settings.shouldUseBootRequestTimeout&&this.m_settings.bootRequestTimeout?this.m_settings.bootRequestTimeout:this.m_settings.timeout;t&&t.overrideGetItemsTimeoutMs&&(a=t.overrideGetItemsTimeoutMs),this.m_requestHeaders.set(d.dateHeader,(new Date).toISOString()),this.m_requestHeaders.set(d.clientTimeoutHeader,a.toString()),this.m_requestHeaders.set(d.callId,this.m_settings.callId||"empty");let s=!1,c=this.m_podsUrl+"/getitems.ashx";const h=t&&t.isGetSlideCommentsRequest;this.m_settings.shouldFixSlideDataOrder&&(h&&this.m_wacFallbackDownloadUrl?this.m_getItemsRequest.Source.DownloadUrl=this.m_wacFallbackDownloadUrl:this.m_getItemsRequest.Source.DownloadUrl=this.m_downloadUrl),h||!this.m_settings.pptoPresentFrontDoorEnabled&&!v.a.readBooleanOrDefault("enableUsePresentFrontdoor",!1)||(this.m_presentUrl?(c=this.m_presentUrl+"/items",s=!0):f.a.sendTraceTag(508420451,p.a.msoulscat_Wac_PptSession,g.a.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }"));const u=this.m_getItemsRequest.Items.map(e=>e.Id);b.s_events.emit("networkCall",{url:c,itemIds:u});const m=new AbortController,_=setTimeout(()=>m.abort(),a);r=await fetch(c,{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getItemsRequest),signal:m.signal}).catch(async t=>{const r=t.response&&t.response.headers?t.response.headers.get(d.XCorrelationId):d.unknown,a=t.response&&t.response.headers?t.response.headers.get(d.ErrorCode):d.unknown,c=t.response&&t.response.headers?t.response.headers.get(d.XErrorCode):d.unknown,h=t.response&&t.response.headers?t.response.headers.get(d.ErrorCategory):d.unknown,u=!(!t.response||!t.response.headers)&&t.response.headers.get(d.IsIntentional),m=t.response&&t.response.status?t.response.status:d.unknown;let _=t.toString();_.length>0&&("."===_.slice(-1)||"。"===_.slice(-1))&&(_=_.slice(0,-1));const S=this.getMappedError(_);return S?n.errorCode=S:"HTTPError"===t.name&&m!==d.unknown&&500!==m&&this.m_errorMap.has(m)?n.errorCode=this.m_errorMap.get(m):"TimeoutError"===t.name?n.errorCode=o.ErrorRequestTimeout:n.errorCode=b.convertServerError(a,this.m_settings.enableServerSpecificErrorCode),this.m_settings.shouldUpdateNewFileUrlFromSnap&&n.errorCode===o.ServerErrorFileDownloadResourceInconsistent&&(n.newSnapUrl=b.getFieldFromReponseHeader(t.response,d.newSnapUrlHeader)),n.errorCategory=h&&""!==h.trim()&&h!==d.unknown?h:l.Transient,n.isIntentional=u!==d.unknown&&u,f.a.sendTraceTag(595687001,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy:getItems - Function:${e}, Error:${t}, ErrorName:${t.name}, Status:${t.status}, HeaderCorrelationId:${r}, HeaderErrorCode:${a}, HeaderErrorCategory:${h}, result.isIntentional:${n.isIntentional}, result.errorCode:${n.errorCode}, requestCorrelation:${i}, status:${m}, xErrorCode:${c}, usePresentFrontDoor:${s}`),n}),f.a.sendTraceTag(506852877,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:getItemsAsync - fixErrorLoggingGetItemsPodsProxy: "+v.a.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)),v.a.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)&&r&&!1===r.ok&&await this.logGetItemFailureServerHeaders(e,i,s,r),clearTimeout(_),n.response=r;try{if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&(n.errorCode===o.ServerErrorFileDownloadResourceInconsistent||n.newSnapUrl)){if(f.a.sendTraceTag(508420449,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),n.newSnapUrl)return n.errorCode===o.ErrorRESERVEDSuccess&&f.a.sendTraceTag(508420448,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:got new snap url without errorcode"),f.a.sendTraceTag(508420447,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",n.newSnapUrl),n;f.a.sendTraceTag(508420446,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){f.a.sendTraceTag(508420445,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}200!==r.status&&n.errorCode===o.ErrorRESERVEDSuccess&&(r.headers&&r.headers.get(d.ErrorCode)?(n[d.errorCode]=b.convertServerError(r.headers.get(d.ErrorCode),this.m_settings.enableServerSpecificErrorCode),n[d.errorCategory]=r.headers.get(d.ErrorCategory)?r.headers.get(d.ErrorCategory):l.BadRequest,n[d.IsIntentional]=!!r.headers.get(d.IsIntentional)&&r.headers.get(d.IsIntentional)):(r.status!==d.unknown&&this.m_errorMap.has(r.status)?n[d.errorCode]=this.m_errorMap.get(r.status):n[d.errorCode]=o.ErrorRequestFailed,n[d.errorCategory]=l.Transient,n[d.IsIntentional]=!1));const S={functionName:e,status:r.status,statusText:r.statusText,headerCorrelation:r.headers?r.headers.get(d.XCorrelationId):"",headerErrorCode:r.headers?r.headers.get(d.ErrorCode):"",headerErrorCategory:r.headers?r.headers.get(d.ErrorCategory):"",headerErrorIntentional:!!r.headers&&r.headers.get(d.IsIntentional),requestCorrelation:i,resultErrorCode:n.errorCode,resultErrorCategory:n.errorCategory,resultIsIntentional:n.IsIntentional};return f.a.sendTraceTag(595687002,p.a.msoulscat_Wac_PptSession,r.ok?g.a.Info:g.a.Error,JSON.stringify(S)),n}async getSessionUtcAsync(){let e=-1;const t=new AbortController,i=setTimeout(()=>t.abort(),2500),n=await fetch(this.m_podsUrl+"/podhandler.ashx?action=GetSessionUTC&format=jsms",{headers:new Headers,method:"GET",signal:t.signal}).catch(async e=>{f.a.sendTraceTag(508420444,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getSessionUtcAsync - Error: "+e)});clearTimeout(i);try{n?(e=parseInt(await n.text(),10),f.a.sendTraceTag(508420443,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy::getSessionUtcAsync: "+e)):f.a.sendTraceTag(508420442,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getSessionUtcAsync - Null response.")}catch(e){f.a.sendTraceTag(508420441,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::getSessionUtcAsync - error parsing response. "+e)}return e}updateDocSource(e){f.a.sendTraceTag(508420440,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:f.a.sendTraceTag(508420439,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:f.a.sendTraceTag(508420438,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}async generateSnapDownloadUrlAsync(e,t){try{f.a.sendTraceTag(508420437,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ${e.ID}.`);const i=new Headers;i.append(d.ContentType,"application/json; charset=utf-8"),i.append(d.CallerCorrelationId,e.ID),t&&t.forEach((e,t)=>{i.append(t,e)});const n=this.m_podsUrl+"/SnapUrlHandler.ashx",r=new AbortController,a=setTimeout(()=>r.abort(),this.m_settings.timeout),s=await fetch(n,{headers:i,method:"POST",body:JSON.stringify(e),signal:r.signal}).catch(async e=>{f.a.sendTraceTag(508420436,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : "+e)});clearTimeout(a);let o="";if(s){const e=await s.json();f.a.sendTraceTag(508420435,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:${e.FSuccess}, ErrorCode:${e.ErrorCode}`),e.FSuccess?o=e.SnapUrl:f.a.sendTraceTag(508420434,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : "+e.ErrorCode)}return o}catch(e){return f.a.sendTraceTag(508420433,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: "+e),""}}setErrorMap(){const e=["cancelled","cancelado","キャンセルしました","Abgebrochen","취소됨","已取消","annulé","مُلغى","avbruten","отменено","annullato","zrušeno","poništeno","geannuleerd","ถูกยกเลิก","avbrutt","annulleret","скасовано","בוטל","đã huỷ","Kumottu","dibatalkan","vazgeçildi","anulat","anulowane","ακυρώθηκε","visszavonva"];for(let t=0;t<e.length;t+=1)this.m_errorMap.set(e[t],o.ErrorRequestCanceled);const t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexión de red se perdió","ネットワーク接続が切れました","La connexion réseau a été perdue","Сетевое соединение потеряно","網路連線中斷","การเชื่อมต่อกับเครือข่ายหายไป","Зʼєднання з мережею втрачено","网络连接已中断","Nätverksanslutningen förlorades","A conexão de rede foi perdida","Ağ bağlantısı kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione è stata persa","A ligação à rede foi interrompida","Mistet nettverksforbindelsen","La conexión de red se ha perdido","網絡連線中斷","Đã mất kết nối mạng","Kehilangan jaringan koneksi","تم فقدان اتصال الشبكة","無法連接伺服器","네트워크 연결이 유실되었습니다","Verkkoyhteys katkesi","Netværksforbindelsen gik tabt","Bylo ztraceno připojení k síti","Połączenie sieciowe zostało utracone","A conexão à internet parece estar desativada","The Internet connection appears to be offline","La conexión a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de rețea a fost pierdută","ネットワーク接続が切れました","החיבור לרשת אבד","NetworkError when attempting to fetch resource","无法连接服务器","No se ha podido establecer conexión con el servidor","Tidak dapat terhubung ke server","ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้","No se pudo establecer conexión con el servidor","A hálózati kapcsolat megszakadt"];for(let e=0;e<t.length;e+=1)this.m_errorMap.set(t[e],o.ErrorConnectionLost);const i=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operación. El software causó la anulación de la conexión","Không thể hoàn tất tác vụ. Phần mềm đã khiến kết nối bị hủy bỏ","تعذر إكمال العملية. ‏نتج عن البرنامج إيقاف الاتصال قبل اكتماله","Не удалось завершить операцию. Программа вызвала разрыв подключения","The operation couldn’t be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","L’opération n’a pas pu s’achever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operación. El software causó la anulación de la conexión","A operação não pôde ser concluída. O software provocou o cancelamento da conexão","No se ha podido completar la operación. El software ha causado la anulación de la conexión","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","未能完成该操作。软件导致连接中止","無法完成作業。軟體導致連線失敗","無法完成操作。軟件導致連線失敗","ไม่สามารถดำเนินการให้เสร็จสิ้นได้ ซอฟต์แวร์เป็นสาเหตุให้ยกเลิกการเชื่อมต่อ","操作を完了できませんでした。ソフトウェアにより接続が中止されました","Postupak se nije mogao dovršiti. Softver je uzrokovao prekid veze","Åtgärden kunde inte slutföras. Program orsakade avbrott i anslutningen","İşlem tamamlanamadı. Yazılım bağlantının kesilmesine neden oldu","Не вдалося завершити операцію. Програма обірвала звʼязок"];for(let e=0;e<i.length;e+=1)this.m_errorMap.set(i[e],o.ErrorSoftwareConnectionAbort);const n=["The request timed out","要求がタイムアウトになりました","La requête a expiré","要求がタイムアウトになりました","Se agotó el tiempo de espera","Esgotou-se o tempo limite da solicitação","请求超时"];for(let e=0;e<n.length;e+=1)this.m_errorMap.set(n[e],o.ErrorRequestTimeout);const r=["cannot parse response","impossible d’analyser la réponse","无法解析响应"];for(let e=0;e<r.length;e+=1)this.m_errorMap.set(r[e],o.ErrorCannotParseResponse);this.m_errorMap.set("The operation was aborted",o.ErrorRequestAbort),this.m_errorMap.set("Failed to fetch",o.ErrorFailedToFetch),this.m_errorMap.set(404,o.ErrorRequestFailedServerNotFound),this.m_errorMap.set(502,o.ErrorRequestFailedBadGateway),this.m_errorMap.set(503,o.ErrorRequestFailedServiceUnavailable),this.m_errorMap.set(504,o.ErrorRequestFailedGatewayTimeout)}getMappedError(e){let t=e;return t=b.trimErrorName(t,["TypeError:","Loading failed:"]),t.indexOf("Bylo ztraceno")>=0?o.ErrorConnectionLost:t.indexOf("AbortError:")>=0?o.ErrorRequestAbort:this.m_errorMap.get(t)}static trimErrorName(e,t){let i=e;for(let e=0;e<t.length;e+=1)i.lastIndexOf(t[e])>=0&&(i=i.substring(i.lastIndexOf(t[e])+t[e].length));return i?i.trim():""}static convertServerError(e,t){return t&&e&&""!==e.trim()&&e!==d.unknown?"Server"+e:o.ErrorRequestFailed}async parseMultipartResponseAsync(e,t,i){const a={},s={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,data:void 0};let c={slideOrder:[],slideAllInfo:[]};if(t[d.firstResponseCheck]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},e.response&&e.response.body&&e.response.headers&&e.response.headers.get(d.ContentType)){const h=e.response;let u="";try{t[d.fetchBoundary]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},u=this.m_multipartParser.fetchBoundary(h.headers.get(d.ContentType)),t[d.fetchBoundary].end=b.performanceNowTrimmed()}catch(t){const i=h.headers.get(d.ErrorCode),n=h.headers.get(d.ErrorCategory),r=!!e[d.IsIntentional]&&e[d.IsIntentional],a=h.headers.get(d.XCorrelationId);return f.a.sendTraceTag(508420432,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ${h.headers.get(d.ContentType)}, ErrorCode:${i}, ErrorCategory:${n}, IsIntentional:${r} , Correlation:${a}, Exception:${t}`),s.responseErrorCode=i||o.ErrorRequestFailed,s.responseErrorCategory=n||l.BadRequest,s}const m=b.performanceNowTrimmed();t[d.downloadResponse]={start:m,end:m},f.a.sendTraceTag(508420431,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy::parseMultipartResponse - download response stream start: "+m),i&&i.requestType===n.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:r.DownloadResponseStream});let _,y=!1,T=void 0,w=null;const C=h.headers?h.headers.get(d.ContentLength):-1;let I=-1;if(f.a.sendTraceTag(508420430,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: "+this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength),this.m_settings.parsingWhileDownloadingEnabled){let e=!1,_=!1;const T=a=>{e=!0,_=a;const s={receivedDataLength:I,responseContentLength:C,duration:b.performanceNowTrimmed()-m,downloadFailed:_};f.a.sendTraceTag(508420429,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy - return from response stream reading. "+JSON.stringify(s));const o=b.performanceNowTrimmed();f.a.sendTraceTag(508420428,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${o}, duration: ${o-m}`),t[d.downloadResponse].end=o,t[d.downloadResponse].length=I,!y&&i&&i.requestType===n.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:r.ParseMultipartResponse})};I=0;const w=h.body,[P,E]=w.tee(),x=new Promise(async e=>{try{const t=v.a.readNumberOrDefault("hackMaxBytes",-1),i=P.getReader();for(;;){const{done:n,value:r}=await i.read();if(n){T(!1),e();break}if(r&&(I+=r.length,t>0&&I>t))throw"hackMaxBytes hit"}}catch(t){f.a.sendTraceTag(508420427,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::measuringDownloadPromise - exception ${t}.`),T(!0),e()}});let k;if(i&&i.shouldTimeoutResponseStreamDownload){const t=i&&i.overrideDownloadTimeoutMs?i.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4;k=window.setTimeout(()=>{e||(y=!0,f.a.sendTraceTag(508420426,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),f.a.sendTraceTag(508420425,p.a.msoulscat_Wac_PptSession,g.a.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),P.cancel(),E.cancel())},t)}const M=new S(this.m_settings,a,t,s),A=this.m_multipartParser.processMultipartBinaryResponse(E.getReader(),u,e=>{M.parsePart(e)});if(await Promise.all([x,A]),_)return s.responseErrorCode=o.ErrorRequestFailed,s.responseErrorCategory=l.Transient,s.data=void 0,s;if(i&&i.shouldTimeoutResponseStreamDownload&&(clearTimeout(k),f.a.sendTraceTag(508420424,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy - response download check. "+JSON.stringify({hasTimeout:y,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:I,responseContentLength:C}))),y){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&C>0&&I>0&&C===I))return s.responseErrorCode=o.ErrorDownloadResponseStreamTimeout,s;f.a.sendTraceTag(508420423,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}c=M.parsedResponse}else{if(i&&i.shouldTimeoutResponseStreamDownload){const e=i&&i.overrideDownloadTimeoutMs?i.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4,t="downloadResponseStreamTimeout";let n;const r=new Promise(i=>{T=setTimeout(()=>{f.a.sendTraceTag(508420422,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),n&&(f.a.sendTraceTag(508420421,p.a.msoulscat_Wac_PptSession,g.a.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),n.cancel()),i(t)},e)});n=h.body.getReader(),w=this.readResponseStream(n,C),w.then(e=>{I=e&&e.length||-1;const t={receivedDataLength:I,responseContentLength:C,duration:b.performanceNowTrimmed()-m};f.a.sendTraceTag(508420420,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy - return from response stream reading. "+JSON.stringify(t))}),_=await Promise.race([w,r]),_===t?y=!0:void 0!==T&&clearTimeout(T)}else{_=new Uint8Array(await h.arrayBuffer());const e=v.a.readNumberOrDefault("hackMaxBytes",-1);e>0&&_.length>e&&(_=_.slice(0,e))}if(i&&i.shouldTimeoutResponseStreamDownload&&f.a.sendTraceTag(508420419,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy - response download check. "+JSON.stringify({hasTimeout:y,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:I,responseContentLength:C})),y){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&w&&C>0&&I>0&&C===I))return s.responseErrorCode=o.ErrorDownloadResponseStreamTimeout,s;f.a.sendTraceTag(508420418,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),_=await w}const e=b.performanceNowTrimmed();f.a.sendTraceTag(508420417,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${e}, duration: ${e-m}`);const l=_;t[d.downloadResponse].end=e,l&&l.length&&(t[d.downloadResponse].length=l.length),i&&i.requestType===n.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:r.ParseMultipartResponse});const P=new S(this.m_settings,a,t,s);await this.m_multipartParser.processMultipartBinaryResponse(l,u,e=>{P.parsePart(e)}),c=P.parsedResponse}}else{const t=e.hasOwnProperty(d.errorCode)&&e[d.errorCode]!==o.ErrorRESERVEDSuccess?e[d.errorCode]:o.ErrorRequestFailed,i=e[d.errorCategory]?e[d.errorCategory]:l.BadRequest,n=!!e[d.IsIntentional]&&e[d.IsIntentional];s.responseErrorCode=t,s.responseErrorCategory=i,f.a.sendTraceTag(508420416,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::parseMultipartResponse - responseErrorCode:${t}, responseErrorCategory:${i}, IsIntentional:${n}`)}t[d.firstResponseCheck].end=b.performanceNowTrimmed(),s.responseErrorCode!==o.ErrorRESERVEDSuccess&&s.responseErrorCategory===l.ErrorRESERVEDSuccess&&(s.responseErrorCategory=l.BadRequest,f.a.sendTraceTag(508420387,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:"+s.responseErrorCode));for(const e in a)c.slideAllInfo.push({ID:a[e].ID,SlideImageData:a[e].SlideImageData,SlideShowInfo:a[e].SlideShowInfo,Title:a[e].Title,NoteHtml:a[e].NoteHtml,Comments:a[e].Comments,HasAnimation:a[e].HasAnimation,Hidden:a[e].Hidden,HasTransition:a[e].HasTransition,ResourceData:a[e].ResourceData,AccessibilityModel:a[e].AccessibilityModel,MediaUrls:a[e].MediaUrls});try{if(v.a.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&(s.itemErrorCodeMap&&Object.values(s.itemErrorCodeMap).includes(o.ServerErrorFileDownloadResourceInconsistent)||s.newSnapUrl)){if(s.newSnapUrl)return 0===s.itemErrorCodeMap.size&&f.a.sendTraceTag(508420386,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:got new snap url without errorcode"),f.a.sendTraceTag(508420385,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",s.newSnapUrl),s;f.a.sendTraceTag(508420384,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){f.a.sendTraceTag(508420383,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return s.data=c,s}async readResponseStream(e,t){let i=new Uint8Array(0);try{let n=await e.read();for(;!n.done;){i=new Uint8Array([...i,...n.value]);const r=v.a.readNumberOrDefault("hackMaxBytes",-1);if(r>0&&i.length>r)throw i=i.slice(0,r),"hackMaxBytes hit";if(t>0&&i.length===t&&(f.a.sendTraceTag(508420382,p.a.msoulscat_Wac_PptSession,g.a.Info,"PodsProxy::readResponseStream - received length reached content length: "+t),this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength))break;n=await e.read()}}catch(e){return f.a.sendTraceTag(508420381,p.a.msoulscat_Wac_PptSession,g.a.Error,`PodsProxy::readResponseStream - exception ${e}.`),new Uint8Array(0)}return i}generateReportPerfDictionary(e){const t={};return e[d.action]&&(t[d.action]=e[d.action]),e[d.correlationId]&&(t[d.correlationId]=e[d.correlationId]),e[d.server]&&(t[d.server]=e[d.server]),e[d.parser]&&(t[d.parser]=e[d.parser]),e[d.downloadResponse]&&(t[d.downloadResponse]=e[d.downloadResponse]),e[d.usedOutputCache]&&(t[d.usedOutputCache]=e[d.usedOutputCache]),e[d.contentLength]&&(t[d.contentLength]=e[d.contentLength]),t}createPresInfoAndSlideInfoResponse(e,t){let i={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0,slideInfo:[]};return t[d.createResponse]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},i={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap},t[d.createResponse].end=b.performanceNowTrimmed(),i}async createSlideInfoResponse(e,t){let i={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[]};return t[d.createResponse]={start:b.performanceNowTrimmed(),end:b.performanceNowTrimmed()},await e.then(e=>{this.m_settings.shouldFixSlideDataOrder&&this.fixSlideImageDataOrder(e),i={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t[d.createResponse].end=b.performanceNowTrimmed(),i}fixSlideImageDataOrder(e){e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.forEach(e=>{if(e&&e.ResourceData&&e.SlideShowInfo&&e.SlideShowInfo.sld){const t=new Map(e.ResourceData.map(e=>[e.Id,e.Base64]));e.SlideShowInfo.sld.forEach(e=>{e.resCat.forEach(e=>{t.has(e.id)&&""===e.base64&&(e.base64=t.get(e.id))})})}})}async createSlideIdResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t}async createPresInfoResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:o.ErrorRESERVEDSuccess,responseErrorCategory:l.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0};return await e.then(e=>{this.m_settings.shouldFixSlideDataOrder&&this.fixHiddenSlideOrder(e),t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t}fixHiddenSlideOrder(e){e.data.slideAllInfo[0].HiddenSlideOrder=e.data.slideAllInfo[0].HiddenSlideOrder?e.data.slideAllInfo[0].HiddenSlideOrder:[]}static logPerf(e){}static ensureISlideInfoFilters(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}static performanceNowTrimmed(){return Math.round(performance.now())}async createSlideOrderAndSlidesInfoIndexResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:l.ErrorRESERVEDSuccess,responseErrorCode:o.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}),t}async createPresInfoAndSlideInfoIndexResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:l.ErrorRESERVEDSuccess,responseErrorCode:o.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0].SlideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}),t}static logPerformanceEntries(e,t){const i=e.getEntriesByType("resource"),n={};for(const e of i){const i=e;if("fetch"!==i.initiatorType)continue;let r=!1;for(const e of t)if(i.name.indexOf(e)>0||i.name.startsWith(e)){r=!0;break}if(r){if(n.name=i.name,n.dateTime=performance.now(),m.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){const e=new URL(i.name);n.hostname=e.hostname,n.pathname=e.pathname}n.start=i.startTime,n.redirectStart=i.redirectStart,n.redirectEnd=i.redirectEnd,n.domainLookupStart=i.domainLookupStart,n.domainLookupEnd=i.domainLookupEnd,n.tcpHandshakeStart=i.connectStart,n.tcpHandshakeEnd=i.connectEnd,n.secureConnectionStart=i.secureConnectionStart,n.responseStart=i.responseStart,n.responseEnd=i.responseEnd,n.fetchStart=i.fetchStart,n.requestStart=i.requestStart,"decodedBodySize"in i&&(n.decodedBodySize=i.decodedBodySize),"encodedBodySize"in i&&(n.encodedBodySize=i.encodedBodySize),"transferSize"in i&&(n.transferSize=i.transferSize),Object.keys(n).length>0&&f.a.sendTraceTag(572379986,p.a.msoulscat_Wac_PptSession,g.a.Info,""+JSON.stringify(n))}}}setTimeoutForParsingResponse(e){return window.setTimeout(()=>{f.a.sendTraceTag(508420380,p.a.msoulscat_Wac_PptSession,g.a.Warning,"Parsing didn't finish in the time. "+JSON.stringify(e))},this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}objectDictionaryToRequestIdString(e){let t="";for(const i in e)e[i]&&(t=`${t}${i}=${e[i]};`);return t}constructor(e,t,i,n,r,a,s){if(this.events=new _.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new u.a,f.a.setLogger(n),f.a.sendTraceTag(508420489,p.a.msoulscat_Wac_PptSession,e&&t&&t.DownloadUrl&&i&&t.DocID?g.a.Info:g.a.Warning,`PodsProxy::constructor - podsUrl:${e}, fileExtension:${i}, docId:${t.DocID}}`),f.a.sendTraceTag(508420488,p.a.msoulscat_Wac_PptSession,g.a.Info,`PodsProxy::constructor - presentUrl:${r}}`),this.m_podsUrl=e,this.m_presentUrl=r,this.m_downloadUrl=t.DownloadUrl,this.m_settings=s||{timeout:3e4,throwHttpErrors:!0},m.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),this.m_wacFallbackDownloadUrl=s?s.wacFallbackDownloadUrl:void 0,a&&a.forEach((e,t)=>{this.m_requestHeaders.append(t,e)}),this.m_getPresInfoRequest={Source:t,FileExtension:i||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:i||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),s&&s.perfTimingMonitorEnabled)try{const e=new Set;this.m_presentUrl&&(e.add(this.m_presentUrl+"/items"),e.add(this.m_presentUrl+"/ping")),e.add("getitems.ashx"),e.add("getmedia.ashx"),e.add("remoteuls.ashx"),e.add("podhandler.ashx"),e.add("remotetelemetry.ashx"),new PerformanceObserver(t=>b.logPerformanceEntries(t,e)).observe({entryTypes:["resource"]})}catch(e){f.a.sendTraceTag(508420487,p.a.msoulscat_Wac_PptSession,g.a.Error,"PodsProxy:PerformanceObserver failed with exception "+e)}}}b.s_events=new _.EventEmitter,b.s_supportedImageType=[h.ImagePng,h.ImageJpg]},function(e,t,i){"use strict";i.d(t,"s",(function(){return n})),i.d(t,"D",(function(){return r})),i.d(t,"m",(function(){return a})),i.d(t,"q",(function(){return s})),i.d(t,"H",(function(){return o})),i.d(t,"w",(function(){return l})),i.d(t,"e",(function(){return d})),i.d(t,"t",(function(){return c})),i.d(t,"z",(function(){return h})),i.d(t,"x",(function(){return u})),i.d(t,"U",(function(){return m})),i.d(t,"G",(function(){return f})),i.d(t,"o",(function(){return p})),i.d(t,"a",(function(){return g})),i.d(t,"I",(function(){return _})),i.d(t,"Q",(function(){return S})),i.d(t,"F",(function(){return v})),i.d(t,"n",(function(){return y})),i.d(t,"j",(function(){return T})),i.d(t,"db",(function(){return b})),i.d(t,"O",(function(){return w})),i.d(t,"T",(function(){return C})),i.d(t,"C",(function(){return I})),i.d(t,"B",(function(){return P})),i.d(t,"u",(function(){return E})),i.d(t,"cb",(function(){return x})),i.d(t,"Z",(function(){return k})),i.d(t,"l",(function(){return M})),i.d(t,"h",(function(){return A})),i.d(t,"M",(function(){return R})),i.d(t,"g",(function(){return O})),i.d(t,"f",(function(){return F})),i.d(t,"r",(function(){return D})),i.d(t,"S",(function(){return L})),i.d(t,"ab",(function(){return B})),i.d(t,"P",(function(){return N})),i.d(t,"L",(function(){return V})),i.d(t,"R",(function(){return W})),i.d(t,"E",(function(){return U})),i.d(t,"b",(function(){return z})),i.d(t,"J",(function(){return H})),i.d(t,"i",(function(){return G})),i.d(t,"A",(function(){return j})),i.d(t,"V",(function(){return $})),i.d(t,"c",(function(){return q})),i.d(t,"Y",(function(){return Z})),i.d(t,"p",(function(){return J})),i.d(t,"y",(function(){return X})),i.d(t,"v",(function(){return Y})),i.d(t,"k",(function(){return K})),i.d(t,"K",(function(){return Q})),i.d(t,"d",(function(){return ee})),i.d(t,"X",(function(){return te})),i.d(t,"N",(function(){return ie})),i.d(t,"W",(function(){return ne})),i.d(t,"bb",(function(){return re}));var n="initialize",r="name",a="getNotifyMgr",s="identifier",o="push",l="isInitialized",d="config",c="instrumentationKey",h="logger",u="length",m="time",f="processNext",p="getProcessTelContext",g="addNotificationListener",_="removeNotificationListener",S="stopPollingInternalLogs",v="onComplete",y="getPlugin",T="flush",b="_extensions",w="splice",C="teardown",I="messageId",P="message",E="isAsync",x="_doTeardown",k="update",M="getNext",A="diagLog",R="setNextPlugin",O="createNew",F="cookieCfg",D="indexOf",L="substring",B="userAgent",N="split",V="setEnabled",W="substr",U="nodeType",z="apply",H="replace",G="enableDebugExceptions",j="logInternalMessage",$="toLowerCase",q="call",Z="type",J="handler",X="listeners",Y="isChildEvt",K="getCtx",Q="setCtx",ee="complete",te="traceId",ie="spanId",ne="traceFlags",re="version"},function(e,t,i){"use strict";i.d(t,"j",(function(){return c})),i.d(t,"e",(function(){return m})),i.d(t,"i",(function(){return p})),i.d(t,"h",(function(){return g})),i.d(t,"d",(function(){return v})),i.d(t,"b",(function(){return y})),i.d(t,"c",(function(){return T})),i.d(t,"a",(function(){return b})),i.d(t,"g",(function(){return I})),i.d(t,"f",(function(){return P}));var n=i(0),r=i(5),a=i(2),s=i(63),o=i(20),l=i(30),d=i(6);let c=!1;const h=[{attributeName:"a_0",attributeSize:2,offset:0,divisor:0}],u=[{attributeName:"a_1",attributeSize:2,offset:0,divisor:0}];function m(e,t,i,s,o,l){const c=e.getGraphicsProcessor();if(!c)return void d.a.Error(592525249,"No GraphicsProcessor");const h=e.ensureScratchBuffers(),u=h[0],m=h[1],p=s==r.b.glow?.12*i:s==r.b.softEdges?.47*i:s==r.b.border?.5*i:i,g=s==r.b.glow?.3*i:s==r.b.softEdges?i:s==r.b.border?.5*i:i,_=s==r.b.glow||s==r.b.border?3:s==r.b.softEdges?2:o?1:0,S=s==r.b.border?3:o?1:0,v=s!=r.b.glow&&s!=r.b.softEdges;f(c,m.size.divide(t.size),t,m,o?a.d.Black:void 0,p,_,new n.f(1,0),v,s==r.b.border,l),f(c,n.f.One,m,u,o?a.d.Black:void 0,p,_,new n.f(0,1),v,s==r.b.border,void 0),f(c,n.f.One,u,m,o?a.d.Black:void 0,g,S,new n.f(1,0),!0,s==r.b.border,void 0),f(c,t.size.divide(u.size),m,t,o,g,S,new n.f(0,1),!0,s==r.b.border,void 0)}function f(e,t,i,n,r,s,o,c,h,u,m){const f=i.tryUseBabylonTexture(e,m,"blurSrc");if(!f)return void d.a.Error(592525250,"Invalid Texture");const p=n.tryGetBabylonTextureForRenderToTexture(e);if(!p)return void d.a.Error(572867298,"Invalid Texture");const g=e.activateShaderProgram(l.a.blur);g.begin(p,a.d.Transparent,!1);const _=g.getBabylonEffect();_.setFloat("u_0",s),_.setVector2("u_1",t),_.setVector2("u_2",c),_.setVector2("u_3",i.size),_.setInt("u_4",h?1:2),g.setTexture("tex_0",f),_.setDirectColor4("ufrag_0",r||a.d.Transparent),_.setFloat("ufrag_2",u?0:Math.log(s/4)/Math.log(2)),_.setInt("ufrag_3",o),_.setInt("ufrag_4",h?1:2),g.drawQuads(1),g.end()}function p(e,t,i,r){const s=e.activateShaderProgram(l.a.median);s.begin(i.tryUseBabylonTargetTexture(e,void 0,"medianResize/destination"),a.d.Red,!1);const o=s.getBabylonEffect(),d=n.f.One.divide(t.size);s.setTexture("t_0",t.tryUseBabylonTexture(e,void 0,"medianResize/source")),o.setVector2("ufrag_0",d),o.setDirectColor4("ufrag_1",r),s.drawQuads(1),s.end()}function g(e,t){const i=w(t,e.contentLocation.logicalSize);let r=n.c.Scale2D(i.multiply(n.f.Flip(e.contentLocation.flipX,e.contentLocation.flipY)));return r=r.multiply(n.c.RotationZ(e.contentLocation.rotation)),r=r.multiply(n.c.Translation2D(e.contentLocation.logicalCenter)),r=r.multiply(n.c.Scale2D(e.size.inverse())),r=r.multiply(n.c.Translation2D(new n.f(-.5,-.5))),r}function _(e){return e?e.size.x+"x"+e.size.y:"undefined"}class S{getDebugStringInfo(){return["Layer"]}constructor(e,t){this.contentRotation=0,this.depth=0,this.depthFar=0,this.depthNear=0,this.blendingMode=a.a.normal,this.overallOpacity=1,this.contentCenter=e?e.center:n.f.Zero,this.contentSize=e?e.size:n.f.One,this.contentFlip=e?n.f.Flip(e.flipX,e.flipY):n.f.One,this.contentRotation=e?e.rotation:0,this.customMesh=t}}class v extends S{getDebugStringInfo(){return["Texture: "+_(this.texture)+", Mask: "+_(this.mask),(this.fadeInfo?" +Fade ":"")+(this.reflectionGradient?" + Reflection ":"")+(this.customMesh?" + CustomMesh ":"")]}constructor(e,t,i,n){super(t,i),this.texture=e,this.mask=n}}class y extends S{getDebugStringInfo(){return["Textures: "+_(this.textureA)+" ➡️ "+_(this.textureB),(this.fadeInfo?" +Fade ":"")+(this.customMesh?" + CustomMesh ":"")+(this.morphingGrid?" + MorphingGrid ":"")]}constructor(e,t,i,r,a,s){super({center:n.f.Zero,size:n.f.One,rotation:0,flipX:!1,flipY:!1},a),this.progress=0,this.textureA=e,this.textureB=t,this.panVector=s,i&&r&&(this.morphingGrid=[i,r])}}class T extends y{getDebugStringInfo(){return["Textures: "+_(this.textureA)+" ➡️ "+_(this.textureB),"TexturesW: "+_(this.textureDeltaWhiteA)+" ➡️ "+_(this.textureDeltaWhiteB),"TextureP: "+_(this.texturePictureA)+" ➡️ "+_(this.texturePictureB),(this.fadeInfo?" +Fade ":"")+(this.customMesh?" + CustomMesh ":"")+(this.morphingGrid?" + MorphingGrid ":"")]}constructor(e,t,i,n,r,a,s,o,l,d){super(e,t,s,o,l,d),this.textureDeltaWhiteA=i,this.textureDeltaWhiteB=n,this.texturePictureA=r,this.texturePictureB=a}}class b extends v{getDebugStringInfo(){return["Texture: "+_(this.texture),(this.fadeInfo?" +Fade ":"")+(this.reflectionGradient?" + Reflection ":"")+(this.customMesh?" + CustomMesh ":"")]}constructor(e,t,i,n){super(e,t,n),this.fillBrightness=0,this.distanceFieldMode=2,this.style=i}}function w(e,t){return 0!=e.x&&0!=e.y?t.divide(e):0!=e.x?n.f.One.scale(t.x/e.x):0!=e.y?n.f.One.scale(t.y/e.y):n.f.Zero}function C(e,t,i){const r=w(t,e.logicalSize),a=n.d.FromSizeAndCenter(e.physicalSize,e.physicalCenter.subtract(e.logicalCenter)),s=n.c.RotationZ(-e.rotation),o=n.c.ScaleTranslation2D(n.f.Flip(e.flipX,e.flipY).divide(r),i);return a.transformedBounds(s.multiply(o))}function I(e,t,i,a){const s=Object(r.o)(t.alignment,e),o=t.isStretched?e:e.transformedBounds(new n.e(s.negate(),i.originalSize.divide(e.size),0,s));if(o){const r=t.isStretched?t.offset.multiply(o.size):t.offset;let l=t.scale;if(t.isStretched&&t.fillToPreserveAspectRatio){const t=i.originalSize.x/i.originalSize.y,r=e.size.x/e.size.y;l=l.multiply(new n.f(t>r?t/r:1,t<r?r/t:1))}const d=t.rotation?n.c.RotationAroundPoint(t.rotation,o.relativeToAbsolute(t.rotationCenter)):n.e.Identity,c=new n.e(s.negate(),l,0,s.add(r)),h=o.transformedBounds(n.c.FromTransforms(d,c));return h&&a?h.transformedBounds(a):h}}function P(e,t,i,l,c,m,f){var p,_,S,w,P;const M=t instanceof v?t:void 0,A=t instanceof y?t:void 0,R=t instanceof T?t:void 0,O=A?A.textureA:M?M.texture:void 0,F=A?A.textureB:M?M.mask:void 0,D=A&&A.panVector&&(!O||!F);let L=0;A&&(L=D?O?0:1:A.progress);const B=M?M.reflectionGradient:void 0,N=t instanceof b&&!O;if(!N&&!(O&&O.isValidForGraphicsProcessor(e)||F&&F.isValidForGraphicsProcessor(e)))return void d.a.Error(592525252,"No Texture");const V=t.contentCenter;let W=n.c.Identity,U=n.c.Identity;const z=i.getBabylonEffect(),H=i.getBabylonEngine();if(A&&A.morphingGrid&&2==A.morphingGrid.length)z.setInt("u_16",1),z.setFloat("u_17",A.progress),H.bindInstancesBuffer(A.morphingGrid[0],h),H.bindInstancesBuffer(A.morphingGrid[1],u),W=n.c.Scale2D(t.contentSize),U=n.c.Scale2D(t.contentSize);else{z.setInt("u_16",0),z.setFloat("u_17",0),i.setDummyPointerAttribute("a_0"),i.setDummyPointerAttribute("a_1");const e=O?C(O.contentLocation,t.contentSize,t.contentCenter):N?n.d.FromSizeAndCenter(t.contentSize,t.contentCenter):void 0,r=F?C(F.contentLocation,t.contentSize,t.contentCenter):void 0;let a=e&&r?n.d.UnionRect(e,r):e||r;if(t instanceof b&&t.style.pictureOverflow>0&&t.style.pictureBrush&&t.pictureTexture){const e=I(t.fillBoundsOverride?t.fillBoundsOverride:n.d.FromSizeAndCenter(t.contentSize,t.contentCenter),t.style.pictureBrush,t.pictureTexture);e&&(a=n.d.UnionRect(a,e))}if(!a)return void d.a.Error(592525253,"Undefined physical bounds");if(a=a.translate(t.contentCenter.negate()),a=t.effectTransform?a.transformedBounds(t.effectTransform):a,a=a&&t.localClipRect?n.d.IntersectRect(a,t.localClipRect):a,!a)return;a=a.translate(t.contentCenter),W=n.c.ScaleTranslation2D(a.size,a.center.subtract(V));const s=t.effectTransform?t.effectTransform.inverse():void 0;U=s?W.multiply(s):W}const G=O?U.multiply(g(O,t.contentSize)):n.c.Identity,j=F?U.multiply(g(F,t.contentSize)):n.c.Identity;let $=n.c.Identity;if(t instanceof b&&t.textCutoutTexture&&O){const e=t.textCutoutTransform||n.c.Identity;$=U.multiply(e).multiply(g(t.textCutoutTexture,t.contentSize))}let q=V;D&&A&&A.panVector&&(q=V.add(A.panVector.scale(A.progress-(F?1:0))));let Z=n.c.RotationZ(t.contentRotation).multiply(n.c.Translation2D(q));c&&(Z=Z.multiply(c)),t.textureFlip&&(W=W.multiply(n.c.Scale2D(t.textureFlip))),z.setMatrix3x3("u_0",W.m),z.setVector2("u_15",t.contentFlip),z.setMatrix3x3("u_1",Z.m),z.setVector2("u_2",l),z.setMatrix3x3("u_3",G.m),z.setMatrix3x3("u_11",$.m),z.setMatrix3x3("u_4",j.m),z.setFloat2("ufrag_12",B?B.opacity0:1,B?B.opacity1:1),z.setVector2("u_20",B?B.pos0:n.f.Zero),z.setVector2("u_21",B?B.pos1:n.f.Zero),z.setDirectColor4("ufrag_13",m||a.d.Transparent),z.setFloat("ufrag_36",L);const J=t.fadeInfo?t.fadeInfo.fadeTexture:void 0;i.setTexture("t_3",J?J.tryUseBabylonTexture(e,t.clientObject,"fadeTexture"):void 0);let X=0;if(t.fadeInfo&&t.fadeInfo.fade){X=t.fadeInfo.fadeMode;const i=t.fadeInfo.fade,r=i.reverse?1-i.progress:i.progress;z.setVector2("ufrag_17",function(e,t,i){let r=10;if(e.preset==s.d.uniform)r=1;else if(e.preset==s.d.draw){var a;const t=null!==(a=e.drawFadeOptions)&&void 0!==a?a:s.b.Default;r=i&&t.mode==s.a.simple?1:Math.max(10,30)}return e.reverse?new n.f(r-1,1-t*r):new n.f(1-r,t*r)}(i,r,t instanceof b&&void 0!==t.pictureTexture)),i.preset!=s.d.uniform&&(t.fadeInfo.fadeTexture&&t.fadeInfo.fadeTexture.isValidForGraphicsProcessor(e)?z.setMatrix3x3("u_10",i.preset==s.d.draw?U.multiply(g(t.fadeInfo.fadeTexture,t.contentSize)).m:G.multiply(i.getFadeTransform()).m):d.a.Error(592525254,"fade texture missing"))}if(z.setInt("ufrag_16",X),z.setFloat("u_18",t.depthFar),z.setFloat("u_19",t.depthNear),z.setFloat("ufrag_41",t.overallOpacity),z.setMatrix3x3("ufrag_42",null!==(p=null===(_=t.colorMatrix)||void 0===_?void 0:_.m)&&void 0!==p?p:n.c.Identity.m),z.setVector3("ufrag_43",null!==(S=t.colorOffset)&&void 0!==S?S:n.g.Zero),z.setDirectColor4("ufrag_44",null!==(w=t.colorize)&&void 0!==w?w:a.d.Transparent),z.setInt("ufrag_45",null!==(P=t.pictureFillMode)&&void 0!==P?P:0),t instanceof b){let s;!function(e,t,i,s,l,c){const h=i.texture,u=i.style;t.setFloat("ufrag_0",i.distRangeSize?.5/i.distRangeSize:1),t.setInt("ufrag_34",h?0:1);const m=7==c&&u.hitTransparentFill,f=u.fillBrush;let p=m?a.c.solid:f?f.getType():a.c.none;const _=p==a.c.image?i.fillTexture:void 0;p!=a.c.image||_||(p=a.c.none);const S=f instanceof a.v?!f.color.equals(a.d.Transparent):p!=a.c.none;if(t.setInt("ufrag_10",i.hideFill?a.c.none:p),p==a.c.rectangularGradient)t.setFloatArray4("ufrag_3",x(f));else{const e=m?a.d.White:p==a.c.solid?f.color:p==a.c.pattern?f.foregroundColor:a.d.Transparent;t.setDirectColor4("ufrag_3",e)}t.setInt("ufrag_18",p==a.c.image&&_&&_.wrapMode==a.y.clamp?1:0),t.setFloat("ufrag_20",p==a.c.image?f.opacity:1),t.setInt("u_13",p==a.c.pattern?1:0),t.setMatrix3x3("u_4",i.fillTransformUV?p==a.c.pattern?i.fillTransformUV.m:s.multiply(i.fillTransformUV).m:s.m),t.setDirectColor4("ufrag_22",p==a.c.pattern?f.backgroundColor:a.d.Transparent),t.setFloat("ufrag_28",i.fillBrightness);const v=i.pictureTexture;if(t.setInt("ufrag_30",i.hideFill||!v?0:1),v){const e=u.pictureBrush;t.setInt("ufrag_31",v&&v.wrapMode==a.y.clamp?1:0),t.setFloat("ufrag_32",e.opacity),t.setMatrix3x3("u_5",i.pictureTransformUV?s.multiply(i.pictureTransformUV).m:n.c.Identity.m)}let y=0;if(o.a==o.g)y=o.l;else if(7==c&&u.hasLine&&!S&&!v){var T;y=null!==(T=u.hitTestSlop)&&void 0!==T?T:o.u}let b=i.hideLine||2==c||!u.lineBrush?a.c.none:u.lineBrush.getType();const w=b==a.c.image?i.lineTexture:void 0;b!=a.c.image||w||(b=a.c.none),y&&(b=a.c.solid);const C=o.a==o.g?y:Math.max(y,u.hasLine?u.pen.adjustedLineWidth:0);if(t.setFloat("ufrag_1",C),t.setInt("ufrag_11",b),b==a.c.rectangularGradient)t.setFloatArray4("ufrag_4",x(u.lineBrush));else{let e=a.d.Transparent;y?e=o.a==o.g?a.d.Red:a.d.White:b==a.c.solid?e=u.lineBrush.color:b==a.c.pattern&&(e=u.lineBrush.foregroundColor),t.setDirectColor4("ufrag_4",e)}t.setInt("ufrag_19",b==a.c.image&&w&&w.wrapMode==a.y.clamp?1:0),t.setFloat("ufrag_21",b==a.c.image?u.lineBrush.opacity:1),t.setInt("u_14",b==a.c.pattern?1:0),t.setMatrix3x3("u_6",i.lineTransformUV?b==a.c.pattern?i.lineTransformUV.m:s.multiply(i.lineTransformUV).m:s.m),t.setDirectColor4("ufrag_23",b==a.c.pattern?u.lineBrush.backgroundColor:a.d.Transparent),t.setFloat("ufrag_29",i.mergeMode==r.h.union?1:0),t.setFloat("ufrag_6",u.pen&&u.pen.dashType!=a.o.solid&&u.pen.useRoundDash?1:0);const I=y?k[a.n.simple]:!(P=u.pen).compoundType||P.tipType?k[a.n.simple]:P.compoundType>=0&&P.compoundType<k.length?k[P.compoundType]:(d.a.Error(587220940,"unsupported compoundType"),k[a.n.simple]);var P;t.setFloatArray3("ufrag_8",I.centers),t.setFloatArray3("ufrag_9",I.slopes);const E=Math.sqrt(2)/2,M=new n.f(E,E),A=l?l.transformVector(M).length():1;if(t.setFloat("ufrag_2",1/A),t.setFloat("ufrag_27",Object(n.h)(Object(r.s)(u.pen),-1,1)*C/2),t.setInt("ufrag_37",h&&2==i.distanceFieldMode?1:0),t.setInt("ufrag_38",u.pen.dashType==a.o.solid&&u.pen.compoundType==a.n.simple||7==c?1:0),i.softEdges&&i.softEdges.radius>0&&i.softEdgesTexture&&i.softEdgesTexture.isValidForGraphicsProcessor(e)?(t.setInt("ufrag_24",1),t.setMatrix3x3("u_7",s.multiply(g(i.softEdgesTexture,i.contentSize)).m)):(t.setInt("ufrag_24",0),i.softEdges&&i.softEdges.radius>0&&d.a.Error(588006213,"soft edges texture not ready")),i.innerShadow&&i.innerShadow.color.a>0&&i.innerShadowTexture&&i.innerShadowTexture.isValidForGraphicsProcessor(e)){const e=new n.f(i.innerShadow.distance,0).rotate(i.innerShadow.angle),r=s.multiply(n.c.Translation2D(e)).multiply(g(i.innerShadowTexture,i.contentSize));t.setInt("ufrag_25",1),t.setMatrix3x3("u_8",r.m),t.setDirectColor4("ufrag_26",i.innerShadow.color)}else t.setInt("ufrag_25",0),i.innerShadow&&i.innerShadow.color.a>0&&d.a.Error(588006214,"inner shadow  exture not ready");t.setInt("ufrag_39",i.textRenderMode||0),t.setFloat("ufrag_40",u.pictureOverflow),t.setInt("ufrag_15",7==c||5==c?1:o.a==o.e?10:o.a!=o.b&&7!=o.a?o.a+10:0),o.a==o.g&&(t.setInt("ufrag_10",0),t.setInt("ufrag_11",1)),0==c&&i.blendingMode==a.a.cutout&&t.setDirectColor4("ufrag_13",a.d.White)}(e,z,t,U,c,f),i.setTexture("t_0",O?O.tryUseBabylonTexture(e,t.clientObject,"distanceField"):void 0),i.setTexture("t_1",t.fillTexture?t.fillTexture.tryUseBabylonTexture(e,t.clientObject,"fillTexture"):void 0),i.setTexture("t_2",t.lineTexture?t.lineTexture.tryUseBabylonTexture(e,t.clientObject,"lineTexture"):void 0),i.setTexture("t_4",t.softEdgesTexture?t.softEdgesTexture.tryUseBabylonTexture(e,t.clientObject,"softEdgesTexture"):void 0),i.setTexture("t_5",t.innerShadowTexture?t.innerShadowTexture.tryUseBabylonTexture(e,t.clientObject,"innerShadowTexture"):void 0),t.pictureTexture&&7==f&&t.style.hitTransparentFill?s=e.whiteTexture:t.pictureTexture&&(s=t.pictureTexture.tryUseBabylonTexture(e,t.clientObject,"pictureTexture")),i.setTexture("t_6",s),i.setTexture("t_7",t.textCutoutTexture?t.textCutoutTexture.tryUseBabylonTexture(e,t.clientObject,"textCutoutTexture"):void 0)}else!function(e){e.setFloat("ufrag_0",0),e.setFloat("ufrag_1",0),e.setFloat("ufrag_2",0),e.setDirectColor4("ufrag_3",a.d.Transparent),e.setDirectColor4("ufrag_4",a.d.Transparent),e.setFloat("ufrag_6",0),e.setFloatArray3("ufrag_8",new Float32Array([0,0,0])),e.setFloatArray3("ufrag_9",new Float32Array([0,0,0])),e.setInt("ufrag_10",0),e.setInt("ufrag_11",0),e.setInt("ufrag_18",0),e.setInt("ufrag_19",0),e.setFloat("ufrag_20",1),e.setFloat("ufrag_21",1),e.setDirectColor4("ufrag_22",a.d.Transparent),e.setDirectColor4("ufrag_23",a.d.Transparent),e.setInt("ufrag_24",0),e.setInt("ufrag_25",0),e.setDirectColor4("ufrag_26",a.d.Transparent),e.setFloat("ufrag_27",0),e.setFloat("ufrag_28",0),e.setFloat("ufrag_29",0),e.setInt("ufrag_30",0),e.setInt("ufrag_31",0),e.setFloat("ufrag_32",0),e.setInt("ufrag_34",0),e.setInt("u_13",0),e.setInt("u_14",0),e.setInt("ufrag_39",0),e.setFloat("ufrag_40",0)}(z),z.setInt("ufrag_15",R?3:null!=M&&M.mask?4:2),i.setTexture("t_0",O?O.tryUseBabylonTexture(e,t.clientObject,t instanceof y?"morphA":"sprite"):void 0),i.setTexture("t_1",F?F.tryUseBabylonTexture(e,t.clientObject,t instanceof y?"morphB":"spriteMask"):void 0),i.setTexture("t_2",R?R.textureDeltaWhiteA.tryUseBabylonTexture(e,t.clientObject,"morphAW"):void 0),i.setTexture("t_4",R?R.textureDeltaWhiteB.tryUseBabylonTexture(e,t.clientObject,"morphBW"):void 0),i.setTexture("t_5",R?R.texturePictureA.tryUseBabylonTexture(e,t.clientObject,"morphAP"):void 0),i.setTexture("t_6",R?R.texturePictureB.tryUseBabylonTexture(e,t.clientObject,"morphBP"):void 0),i.setTexture("t_7",void 0),R&&z.setMatrix3x3("u_5",R.pictureTransformUV?U.multiply(R.pictureTransformUV).m:n.c.Identity.m);const Y=0==f,K=t.blendingMode==a.a.darken||t.blendingMode==a.a.multiply;Y&&t.blendingMode==a.a.simulateOverlay?(z.setInt("ufrag_35",2),i.setBlendingMode(a.a.multiply),E(i,t),z.setInt("ufrag_35",3),i.setBlendingMode(a.a.add),E(i,t)):(z.setInt("ufrag_35",Y&&K?1:0),i.setBlendingMode(Y?t.blendingMode:a.a.normal),E(i,t))}function E(e,t){t.customMesh?e.drawMesh(t.customMesh):e.drawQuads(1)}function x(e){const t=e.fillToRect?e.fillToRect:new n.d(.5,.5,.5,.5),i=e.fillFromRect?e.fillFromRect:new n.d(0,0,1,1),r=t.translate(i.leftTop.negate()).multiply(i.size.inverse());return new Float32Array([1/r.left,1/r.top,1/(1-r.right),1/(1-r.bottom)])}const k=[{centers:new Float32Array([0,0,0]),slopes:new Float32Array([1,1,1])},{centers:new Float32Array([-2/3,2/3,2/3]),slopes:new Float32Array([3,3,3])},{centers:new Float32Array([-.4,.8,.8]),slopes:new Float32Array([5/3,5,5])},{centers:new Float32Array([-.8,.4,.4]),slopes:new Float32Array([5,5/3,5/3])},{centers:new Float32Array([-5/6,0,5/6]),slopes:new Float32Array([6,3,6])}]},function(e,t,i){"use strict";var n,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,a),n(i)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}_(e,t,a,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&_(e,"error",t,{once:!0})}(e,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function h(e,t,i,n){var r,a,s,o;if(d(i),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),a=e._events),s=a[t]),void 0===s)s=a[t]=i,++e._eventsCount;else if("function"==typeof s?s=a[t]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,o=l,console&&console.warn&&console.warn(o)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=u.bind(n);return r.listener=i,n.wrapFn=r,r}function f(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):g(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function _(e,t,i,n){if("function"==typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(a){n.once&&e.removeEventListener(t,r),i(a)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var d=l.length,c=g(l,d);for(i=0;i<d;++i)a(c[i],this,t)}return!0},o.prototype.addListener=function(e,t){return h(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return h(this,e,t,!0)},o.prototype.once=function(e,t){return d(t),this.on(e,m(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,m(this,e,t)),this},o.prototype.removeListener=function(e,t){var i,n,r,a,s;if(d(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,a=i.length-1;a>=0;a--)if(i[a]===t||i[a].listener===t){s=i[a].listener,r=a;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,a=Object.keys(i);for(n=0;n<a.length;++n)"removeListener"!==(r=a[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,i){"use strict";e.exports=i(220)},function(e,t,i){var n=i(205),r=i(206),a=r;a.v1=n,a.v4=r,e.exports=a},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static load(e){n.m_settings=e}static readBooleanOrDefault(e,t){const i=void 0===n.m_settings?"":typeof n.m_settings[e];return"string"===i?"true"===n.m_settings[e].toLowerCase():"boolean"===i?n.m_settings[e]:t}static readNumberOrDefault(e,t){const i=void 0===n.m_settings?"":typeof n.m_settings[e];return"string"===i||"number"===i?Number(n.m_settings[e]):t}static readStringOrDefault(e,t){return void 0===n.m_settings||"string"!=typeof n.m_settings[e]?t:n.m_settings[e]}}},function(e,t,i){"use strict";i.d(t,"h",(function(){return n})),i.d(t,"j",(function(){return r})),i.d(t,"l",(function(){return a})),i.d(t,"k",(function(){return s})),i.d(t,"i",(function(){return o})),i.d(t,"g",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"f",(function(){return c})),i.d(t,"a",(function(){return h})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return m})),i.d(t,"e",(function(){return f}));var n="function",r="object",a="undefined",s="prototype",o="hasOwnProperty",l="default",d=Object,c=d[s],h=d.assign,u=d.create,m=d.defineProperty,f=c[o]},function(e,t,i){"use strict";i.d(t,"b",(function(){return f})),i.d(t,"a",(function(){return p}));var n,r,a=i(9),s=i(3),o=i(7),l=i(10),d=i(1),c=i(17);class h{}h.skewEmitter="Skew_Emitter",h.skewReceiver="Skew_Receiver",h.teamsNotified="Teams_Notified",h.teamsLocal="Teams_Local",h.elapsedTime="Total_Elapsed_MS",h.mediaEventEmitted="PPT_ModernSS_Emit_Media",h.mediaEventCompleted="PPT_ModernSS_Complete_Media",h.mediaEventOutOfOrder="Media_Event_Out_Of_Order",h.mediaEventDuplicate="Media_Event_Duplicate",h.stateNotified="State_Notified",h.stateLocal="State_Local",h.annotationEventEmitted="PPT_ModernSS_Emit_Annotation",h.annotationEventCompleted="PPT_ModernSS_Complete_Annotation",h.bootstrapperNotified="Bootstrapper_Notified",h.bootstrapperLocal="Bootstrapper_Local",h.ic3Notified="Teams_Notified_IC3",h.ic3Local="Teams_Local_IC3",h.mediaEventType="mediaEventType",h.mediaSyncTimeLine="mediaSyncTimeLine",h.senderId="senderId",h.senderIdSystem="system",h.syncEventEmitTime="PPT_ModernSS_Emit_Time_Ms",h.syncEventCompleteTime="PPT_ModernSS_Complete_Time_Ms",function(e){e.Unknown="srcUNKNOWN",e.Teams="srcTEAMS",e.State="srcSTATE"}(n||(n={})),function(e){e.Media="Media",e.SyncStateManager="SyncStateManager"}(r||(r={}));var u=i(13),m=i(105);class f{static isIC3Message(e){return Object.keys(e).some(e=>e.includes(h.ic3Local))}static isStateMessage(e){return Object.keys(e).some(e=>e.includes(h.stateLocal))}static isDuplicateEmitTime(e){let t=void 0;if(this.isStateMessage(e))t=this.m_previousStateComparisonReceivedMessageEmitTime;else{if(!this.isIC3Message(e))return a.a.sendTraceTag(506856672,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"StateServiceComparison:IsDuplicateEmitTime unknown source: "+JSON.stringify(e)),!1;t=this.m_previousTeamsComparisonReceivedMessageEmitTime}let i=0;for(const n in e)if(n.includes("SS_Emit"))return i=e[n],i===t;return!1}static logStateServiceComparisonTelemetry(e,t,i,r){try{const l={...e};if(l){l.attendee_ring=r||"";const e=l.skew_emitter||0,d=t;let c=0,u=n.Unknown;for(const t in l)(t.includes(h.teamsNotified)||t.includes(h.stateNotified)||t.includes(h.bootstrapperNotified))&&0!==e?l[t]+=e:(t.includes(h.teamsLocal)||t.includes(h.stateLocal)||t.includes(h.bootstrapperLocal))&&0!==i?(l[t]+=i,u=t.includes(h.stateLocal)?n.State:n.Teams,l.source=u):t.includes("SS_Emit")&&(c=l[t]);if(l[h.skewReceiver]=i,l.PPT_ModernSS_Complete_Nav=d,c>0){const e=d-c;l.totalElapsedMS=e;const t=`${l.slideIndex||-1}_${c}`;let i=Number.MIN_SAFE_INTEGER;u===n.State&&(this.m_stateReceivedNavs[t]=e,i=this.m_previousStateComparisonReceivedMessageEmitTime,this.m_previousStateComparisonReceivedMessageEmitTime=c),u===n.Teams&&(this.m_teamsReceivedNavs[t]=e,i=this.m_previousTeamsComparisonReceivedMessageEmitTime,this.m_previousTeamsComparisonReceivedMessageEmitTime=c);const r=c===i,h=c<i;!r&&e>2500&&(l.endToEndNavSlow=!0,e>3e4&&(l.endToEndNavSlow30=!0)),h?(a.a.sendTraceTag(506856671,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`StateServiceComparison:Out Of Order nav messages received: source: ${u}; current: ${c}; previous: ${i};`),l.EarlierOrder="true"):r&&(l.SameOrder="true",a.a.sendTraceTag(506856670,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`StateServiceComparison:Duplicate emit time nav messages received: source: ${u}; current: ${c}; previous: ${i};`)),f.logStateServiceCorrespondingComparisonTelemetry(u,t),a.a.sendTraceTag(506856669,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"StateServiceComparison: "+JSON.stringify(l))}}}catch(e){a.a.sendTraceTag(506856668,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"StateServiceComparison error: "+e)}}static logStateServiceCorrespondingComparisonTelemetry(e,t){const i=e===n.State?this.m_teamsReceivedNavs[t]:this.m_stateReceivedNavs[t],r=Object.keys(this.m_stateReceivedNavs).length,l=Object.keys(this.m_teamsReceivedNavs).length,c=r-l,h=d.a.readNumberOrDefault("syncPipelineDiscrepancyCount",10);let u="";if(c>h?u=n.Teams:c<-1*h&&(u=n.State),""!==u){const e={stateKeysCount:r,teamsKeysCount:l,keyCountDifferenceToLogVeto:h};a.a.sendTraceTag(506856667,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`SyncPipelineDiscrepancy_${u}: ${JSON.stringify(e)}`)}if(void 0===i)return;const m=this.m_stateReceivedNavs[t],f=this.m_teamsReceivedNavs[t],p={key:t,stateElapsed:m,teamsElapsed:f,stateFaster:m<f,difference:m-f,stateKeysCount:r,teamsKeysCount:l};a.a.sendTraceTag(506856666,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"logStateServiceComparison "+JSON.stringify(p))}}f.m_stateReceivedNavs={},f.m_teamsReceivedNavs={},f.m_previousStateComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER,f.m_previousTeamsComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER;class p{static trackLastUserInputNavigation(e,t){this.m_lastUserInputTime=t,a.a.sendTraceTag(506856665,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`trackTeamsPVMetrics::trackLastUserInputNavigation: navType: ${e.navType}; action: ${e.source}, time: ${t}`)}static initialize(e){e.teamsSharingEndToEndNavSlowMS&&(this.m_teamsSharingEndToEndNavSlowMS=e.teamsSharingEndToEndNavSlowMS),this.m_maxSlowPipelineMessagesCount=d.a.readNumberOrDefault("maxSlowPipelineMessagesCount",0),this.m_stateServicePipelineMessageSlowMS=d.a.readNumberOrDefault("stateServicePipelineMessageSlowMS",Number.MAX_SAFE_INTEGER)}static setSlowMediaSyncThreshold(e){this.m_slowMediaSyncQoSThresholdMs=e}static hadPreviousUserInput(e){return this.m_timeFromLastUserInputNav=-1,this.m_lastUserInputTime?(this.m_timeFromLastUserInputNav=e-this.m_lastUserInputTime,!0):(a.a.sendTraceTag(506856664,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"trackTeamsPVMetrics: Entering private viewing without prior user input."),!1)}static trackTeamsPVMetrics(e,t){try{a.a.sendTraceTag(506856663,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`trackTeamsPVMetrics: action: ${JSON.stringify(e)}; time: ${t}, inPV: ${null!=this.m_currentTeamsPrivateViewingData}`);const i=e.action;switch(i){case"enterPrivateViewing":{const i=e.source||"";this.m_currentTeamsPrivateViewingData?a.a.sendTraceTag(506856662,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`trackTeamsPVMetrics: EnterPrivateViewing on existing PV session. source: ${i}; data: ${JSON.stringify(e)}; existingPV:${JSON.stringify(this.m_currentTeamsPrivateViewingData)}`):(this.m_currentTeamsPrivateViewingData={enterPrivateViewing:t,returnToPresenter:0,sessionSlideUpdate:0,privateSlideUpdatePrev:0,privateSlideUpdateNext:0,leavePrivateViewing:-1,enterPrivateViewingSource:i,timeFromLastUserNav:this.m_timeFromLastUserInputNav,completed:!1},this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions+=1,i&&i!==r.SyncStateManager||this.hadPreviousUserInput(t)||l.e.recordVeto("Slide_VetoedTeamsPrivateViewingUnintentional",{qosVeto:"SharingWrongSlideStateDisplayed",...this.m_currentTeamsPrivateViewingData}));break}case"leavePrivateViewing":this.m_currentTeamsPrivateViewingData&&(this.m_currentTeamsPrivateViewingData.leavePrivateViewing=t,this.m_currentTeamsPrivateViewingData.privateViewingDuration=t-this.m_currentTeamsPrivateViewingData.enterPrivateViewing,this.m_currentTeamsPrivateViewingData.completed=!0,this.logCurrentPrivateViewingTelemetry(),this.m_currentTeamsPrivateViewingData=void 0,this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions-=1,this.m_sessionTeamsPrivateViewingData.completePrivateViewingSessions+=1);break;case"returnToPresenter":case"sessionSlideUpdate":case"privateSlideUpdatePrev":case"privateSlideUpdateNext":this.m_currentTeamsPrivateViewingData?this.m_currentTeamsPrivateViewingData[i]+=1:"privateSlideUpdateNext"===i?this.trackLastUserInputNavigation({navType:c.g.Next,source:c.p.API},t):"privateSlideUpdatePrev"===i&&this.trackLastUserInputNavigation({navType:c.g.Prev,source:c.p.API},t);break;default:a.a.sendTraceTag(506856661,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`trackTeamsPVMetrics: unexpected action ${JSON.stringify(e)};`)}}catch(e){a.a.sendTraceTag(506856660,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`trackTeamsPVMetrics: caught error: ${e};`)}}static areSkewValuesValid(e,t){return 0!==e&&0!==t&&Math.abs(e)<1e8&&Math.abs(t)<1e8}static logCurrentPrivateViewingTelemetry(){this.m_currentTeamsPrivateViewingData&&a.a.sendTraceTag(506856659,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"trackTeamsPVMetrics: privateViewingSession. Data:"+JSON.stringify(this.m_currentTeamsPrivateViewingData))}static logSessionEndPrivateViewingTelemetry(){const e=this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions>0;e&&this.logCurrentPrivateViewingTelemetry(),a.a.sendTraceTag(506856658,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`trackTeamsPVMetrics: sessionTeamsPrivateViewingData: ${JSON.stringify(this.m_sessionTeamsPrivateViewingData)}, hasIncompletePV: ${e}`)}static logNavigationPromiseCompletedMetadata(e,t,i,r){try{if(e){e.attendee_ring=r||"";const l=e.skew_emitter||0,d=e.isForceRetry||!1,u=t;let m=0,f=n.Unknown;for(const t in e)(t.includes(h.teamsNotified)||t.includes(h.stateNotified)||t.includes(h.bootstrapperNotified))&&0!==l?e[t]+=l:(t.includes(h.teamsLocal)||t.includes(h.stateLocal)||t.includes(h.bootstrapperLocal))&&0!==i?(e[t]+=i,t.includes(h.stateLocal)?f=n.State:t.includes(h.teamsLocal)&&(f=n.Teams),e.source=f):t.includes("SS_Emit")&&(m=e[t]);if(e[h.skewReceiver]=i,e.PPT_ModernSS_Complete_Nav=u,m>0){const t=u-m;e.totalElapsedMS=t;const i=m===this.m_previousTeamsReceivedNavMessageEmitTime,n=m<this.m_previousTeamsReceivedNavMessageEmitTime,r=e.navResultStatus;n?this.m_previousTeamsReceivedEmitterSkew!==l||d||(a.a.sendTraceTag(506856657,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`LogTeamsNavigation:Out Of Order nav messages received: current: ${m}; previous: ${this.m_previousTeamsReceivedNavMessageEmitTime}; source: ${f}`),e.EarlierOrder="true"):i?(e.SameOrder="true",a.a.sendTraceTag(506856656,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`LogTeamsNavigation:Duplicate emit time nav messages received: current: ${m}; previous: ${this.m_previousTeamsReceivedNavMessageEmitTime};`)):"Success"===r?(this.m_previousTeamsReceivedNavMessageEmitTime=m,this.m_previousTeamsReceivedEmitterSkew=l,this.m_consecutiveSkippedRequests>0&&(a.a.sendTraceTag(506856655,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`LogTeamsNavigation:ConsecutiveSkippedRequests: ${this.m_consecutiveSkippedRequests}; endToEndElapsedTime: ${t}; source: ${f}`),this.m_consecutiveSkippedRequests=0),t>0&&!d&&this.logEndToEndSyncNavigationVetoIfSlow(e,f)):r===c.k.SkippedBusy||r===c.k.SkippedNewTarget?this.m_consecutiveSkippedRequests+=1:r===c.k.Failed&&a.a.sendTraceTag(506856654,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LogTeamsNavigation:Navigation Failed; endToEndElapsedTime: "+t)}a.a.sendTraceTag(506856653,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"NavigationComplete: "+JSON.stringify(e))}}catch(e){a.a.sendTraceTag(506856652,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"logNavigationPromiseCompleted error: "+e)}}static logStateServicePipelineLatency(e,t,i,n){if(!i)return;let r=i[h.stateNotified]||0,c=i[h.stateLocal]||0;const u=i.skew_emitter||i[h.skewEmitter],m=i[h.senderId]||"",f=`logStateServicePipelineLatency type:${e}; subtype:${t}; senderId:${m}`;if(!m||m===h.senderIdSystem)return void a.a.sendTraceTag(506856651,s.a.msoulscat_Wac_PptSlideshow,o.a.Verbose,f+" not measuring message from excluded sender");if(0===r||0===c||!this.areSkewValuesValid(u,n))return void a.a.sendTraceTag(506856650,s.a.msoulscat_Wac_PptSlideshow,o.a.Verbose,f+" not measuring message with invalid numbers");r+=u,c+=n;const p=c-r;p>this.m_stateServicePipelineMessageSlowMS&&(this.m_currentSlowPipelineMessagesCount+=1,this.m_currentSlowPipelineMessagesCount>=this.m_maxSlowPipelineMessagesCount?this.m_currentSlowPipelineMessagesCount%5==0&&(a.a.sendTraceTag(506856649,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`${f} slow ${p}; currentSlowPipelineMessagesCount: ${this.m_currentSlowPipelineMessagesCount} > maxSlowPipelineMessagesCount: ${this.m_maxSlowPipelineMessagesCount}`),d.a.readBooleanOrDefault("logCorrectVetoForStateServiceLatency",!0)?l.e.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SyncPipelineSlow_StateService",errorName:e+"_SharingEndToEndSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:p}):l.e.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SharingEndToEndNavSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:p})):a.a.sendTraceTag(506856648,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`${f} slow ${p}; currentSlowPipelineMessagesCount: ${this.m_currentSlowPipelineMessagesCount}`))}static logEndToEndSyncNavigationVetoIfSlow(e,t){try{const i=e[h.stateNotified]||0,n=e[h.bootstrapperNotified]||0,r=e[h.stateLocal]||0,l=e[h.bootstrapperLocal]||0,d=Math.max(i,n),c=Math.max(r,l),u=e.skew_emitter,m=e[h.skewReceiver];if(d>0&&c>0&&c-d>this.m_teamsSharingEndToEndNavSlowMS&&this.areSkewValuesValid(u,m)){const e={vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:c-d,source:t,skew_emitter:u,skew_receiver:m};a.a.sendTraceTag(506856647,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`TeamsSharingEndToEndNavSlowMS_${t}: ${JSON.stringify(e)}`)}}catch(e){a.a.sendTraceTag(506856646,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"logEndToEndSyncNavigationVetoIfSlow error: "+e)}}static logAnnotationCompletedMetadata(e,t,i,n){try{const r=e[h.skewEmitter]||0,l=t;let d=0;for(const t in e)t.includes(h.stateNotified)&&0!==r?e[t]+=r:t.includes(h.stateLocal)&&0!==i?e[t]+=i:t.includes(h.annotationEventEmitted)&&(d=e[t]);if(e[h.skewReceiver]=i,e[h.annotationEventCompleted]=l,e.attendee_ring=n||"",d>0){const t=l-d;e.totalElapsedMS=t}a.a.sendTraceTag(506856645,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"AnnotationComplete: "+JSON.stringify(e))}catch(e){a.a.sendTraceTag(506856644,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"logAnnotationCompletedMetadata error: "+e)}}static logStateServicePipelineMetrics(e,t,i,n){if(void 0===i[h.stateNotified]||void 0===i[h.stateLocal]||void 0===i[h.skewEmitter]||!this.areSkewValuesValid(i[h.skewEmitter],n))return void a.a.sendTraceTag(506856643,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"LogStateServicePipelineMetrics: invalid syncMetricsDictionary: "+JSON.stringify(i));if(this.logStateServicePipelineLatency(e,t,i,n),void 0===i[h.syncEventEmitTime])return void a.a.sendTraceTag(506856642,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"LogStateServicePipelineMetrics: Invalid syncMetricsDictionary: "+JSON.stringify(i));const r=i[h.syncEventEmitTime];r===this.m_previousStateServiceMessageEmitTime?a.a.sendTraceTag(506856641,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`LogStateServicePipelineMetrics: Duplicate message received: current: ${r}; previous: ${this.m_previousStateServiceMessageEmitTime}; `):r<=this.m_previousStateServiceMessageEmitTime?a.a.sendTraceTag(506856640,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`LogStateServicePipelineMetrics: Out of Order message received: current: ${r}; previous: ${this.m_previousStateServiceMessageEmitTime}`):this.m_previousStateServiceMessageEmitTime=r}static logMediaSyncCompletedMetadata(e,t,i){try{if(e){const r=e[h.skewEmitter]||0,d=t;let c=0,u=n.Unknown;for(const t in e)t.includes(h.teamsNotified)&&0!==r?e[t]+=r:t.includes(h.teamsLocal)&&0!==i?e[t]+=i:t.includes(h.mediaEventEmitted)?c=e[t]:(t.includes(h.teamsLocal)||t.includes(h.stateLocal))&&(u=t.includes(h.stateLocal)?n.State:n.Teams,e.source=u);if(e[h.skewReceiver]=i,e[h.mediaEventCompleted]=d,c>0){const t=d-c;e[h.elapsedTime]=t;const n=c===this.m_previousTeamsReceivedMediaMessageEmitTime,m=c<this.m_previousTeamsReceivedMediaMessageEmitTime;t>this.m_slowMediaSyncQoSThresholdMs&&!e.isFromStateServiceCache&&this.areSkewValuesValid(r,i)&&(a.a.sendTraceTag(506856611,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"LogTeamsMediaSync: End-to-end media sync time larger than slow sync threshold: "+JSON.stringify(e)),this.logSlowEndToEndMediaSyncVeto(e,u)),m&&this.shouldLogOutOfOrderEvent(e,u)?(a.a.sendTraceTag(506856610,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`LogTeamsMediaSync: Out of order play/pause sync messages received: current: ${c}; previous: ${this.m_previousTeamsReceivedMediaMessageEmitTime};`),l.e.recordVeto("MediaSyncOutOfOrderEvents",{qosVeto:"MediaSyncOutOfOrderEvents"}),e[h.mediaEventOutOfOrder]="true"):n?(a.a.sendTraceTag(506856609,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`LogTeamsMediaSync: Duplicate emit time media sync messages received: current: ${c};`),e[h.mediaEventDuplicate]="true"):this.m_previousTeamsReceivedMediaMessageEmitTime=c}a.a.sendTraceTag(506856608,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LogTeamsMediaSync: "+JSON.stringify(e))}}catch(e){a.a.sendTraceTag(506856607,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LogTeamsMediaSync: error: "+e)}}static isDuplicateMediaSyncMessage(e,t){return e?(t?this.m_upstreamMediaSyncEvents.has(e):this.m_downstreamMediaSyncEvents.has(e))?(a.a.sendTraceTag(506856605,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`isDuplicateMediaSyncMessage: Media Sync message (correlationId: ${e}) has already been ${t?"sent":"received"}`),!0):(t?this.m_upstreamMediaSyncEvents.add(e):this.m_downstreamMediaSyncEvents.add(e),this.m_upstreamMediaSyncEvents.size>3e3&&this.m_upstreamMediaSyncEvents.clear(),this.m_downstreamMediaSyncEvents.size>3e3&&this.m_downstreamMediaSyncEvents.clear(),!1):(a.a.sendTraceTag(506856606,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"isDuplicateMediaSyncMessage: Undefined correlationId"),!1)}static shouldLogOutOfOrderEvent(e,t){if(t!==n.State)return!1;let i=!1,r=u.d.MediaEnded,a="";const s=e[h.mediaSyncTimeLine];if(s&&s.length>0){r=e[h.mediaEventType];const t=s[0].MediaHostName;a=s[0].MediaPlayerName||"",i=t===m.a.Video&&""!==a&&a===this.m_previousPlayerName&&(r===u.d.MediaPlayed&&this.m_previousEventType===u.d.MediaPaused||r===u.d.MediaPaused&&this.m_previousEventType===u.d.MediaPlayed)}return this.m_previousPlayerName=a,this.m_previousEventType=r,i}static logSlowEndToEndMediaSyncVeto(e,t){const i=e[h.skewEmitter]||0,n=e[h.skewReceiver]||0,r=e[h.elapsedTime];l.e.recordVeto("MediaSyncEndToEndSlow_"+t,{qosVeto:"MediaSyncEndToEndSlow",vetoLimit:this.m_slowMediaSyncQoSThresholdMs,totalElapsedMS:r,source:t,emitterSkew:i,receiverSkew:n})}}p.m_sessionTeamsPrivateViewingData={incompletePrivateViewingSessions:0,completePrivateViewingSessions:0},p.m_teamsSharingEndToEndNavSlowMS=Number.MAX_SAFE_INTEGER,p.m_previousTeamsReceivedNavMessageEmitTime=Number.MIN_SAFE_INTEGER,p.m_previousStateServiceMessageEmitTime=Number.MIN_SAFE_INTEGER,p.m_previousTeamsReceivedEmitterSkew=Number.MIN_SAFE_INTEGER,p.m_consecutiveSkippedRequests=0,p.m_maxSlowPipelineMessagesCount=0,p.m_stateServicePipelineMessageSlowMS=Number.MAX_SAFE_INTEGER,p.m_currentSlowPipelineMessagesCount=0,p.m_previousTeamsReceivedMediaMessageEmitTime=Number.MIN_SAFE_INTEGER,p.m_slowMediaSyncQoSThresholdMs=Number.MAX_SAFE_INTEGER,p.m_previousEventType=u.d.MediaEnded,p.m_previousPlayerName="",p.m_upstreamMediaSyncEvents=new Set,p.m_downstreamMediaSyncEvents=new Set},function(e,t,i){"use strict";i.d(t,"j",(function(){return o})),i.d(t,"i",(function(){return l})),i.d(t,"g",(function(){return d})),i.d(t,"h",(function(){return c})),i.d(t,"f",(function(){return h})),i.d(t,"a",(function(){return u})),i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return f})),i.d(t,"e",(function(){return _})),i.d(t,"b",(function(){return S}));class n{get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(e){e&&this.program&&e(this.program)}setEngine(e){this.engine=e}_fillEffectInformation(e,t,i,n,r,a,s,o){const l=this.engine;if(l.supportsUniformBuffers)for(const i in t)e.bindUniformBlock(i,t[i]);let d;for(this.engine.getUniforms(this,i).forEach((e,t)=>{n[i[t]]=e}),this._uniforms=n,d=0;d<r.length;d++)null==e.getUniform(r[d])&&(r.splice(d,1),d--);r.forEach((e,t)=>{a[e]=t});for(const e of l.getAttributes(this,s))o.push(e)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(e,t){const i=this._valueCache[e],n=t.updateFlag;return(void 0===i||i!==n)&&(this._valueCache[e]=n,!0)}_cacheFloat2(e,t,i){let n=this._valueCache[e];if(!n||2!==n.length)return n=[t,i],this._valueCache[e]=n,!0;let r=!1;return n[0]!==t&&(n[0]=t,r=!0),n[1]!==i&&(n[1]=i,r=!0),r}_cacheFloat3(e,t,i,n){let r=this._valueCache[e];if(!r||3!==r.length)return r=[t,i,n],this._valueCache[e]=r,!0;let a=!1;return r[0]!==t&&(r[0]=t,a=!0),r[1]!==i&&(r[1]=i,a=!0),r[2]!==n&&(r[2]=n,a=!0),a}_cacheFloat4(e,t,i,n,r){let a=this._valueCache[e];if(!a||4!==a.length)return a=[t,i,n,r],this._valueCache[e]=a,!0;let s=!1;return a[0]!==t&&(a[0]=t,s=!0),a[1]!==i&&(a[1]=i,s=!0),a[2]!==n&&(a[2]=n,s=!0),a[3]!==r&&(a[3]=r,s=!0),s}setInt(e,t){const i=this._valueCache[e];void 0!==i&&i===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}setInt2(e,t,i){this._cacheFloat2(e,t,i)&&(this.engine.setInt2(this._uniforms[e],t,i)||(this._valueCache[e]=null))}setInt3(e,t,i,n){this._cacheFloat3(e,t,i,n)&&(this.engine.setInt3(this._uniforms[e],t,i,n)||(this._valueCache[e]=null))}setInt4(e,t,i,n,r){this._cacheFloat4(e,t,i,n,r)&&(this.engine.setInt4(this._uniforms[e],t,i,n,r)||(this._valueCache[e]=null))}setIntArray(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)}setIntArray2(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)}setIntArray3(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)}setIntArray4(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)}setUInt(e,t){const i=this._valueCache[e];void 0!==i&&i===t||this.engine.setUInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}setUInt2(e,t,i){this._cacheFloat2(e,t,i)&&(this.engine.setUInt2(this._uniforms[e],t,i)||(this._valueCache[e]=null))}setUInt3(e,t,i,n){this._cacheFloat3(e,t,i,n)&&(this.engine.setUInt3(this._uniforms[e],t,i,n)||(this._valueCache[e]=null))}setUInt4(e,t,i,n,r){this._cacheFloat4(e,t,i,n,r)&&(this.engine.setUInt4(this._uniforms[e],t,i,n,r)||(this._valueCache[e]=null))}setUIntArray(e,t){this._valueCache[e]=null,this.engine.setUIntArray(this._uniforms[e],t)}setUIntArray2(e,t){this._valueCache[e]=null,this.engine.setUIntArray2(this._uniforms[e],t)}setUIntArray3(e,t){this._valueCache[e]=null,this.engine.setUIntArray3(this._uniforms[e],t)}setUIntArray4(e,t){this._valueCache[e]=null,this.engine.setUIntArray4(this._uniforms[e],t)}setArray(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)}setArray2(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)}setArray3(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)}setArray4(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)}setMatrices(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))}setMatrix(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.asArray())||(this._valueCache[e]=null))}setMatrix3x3(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)}setMatrix2x2(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)}setFloat(e,t){const i=this._valueCache[e];void 0!==i&&i===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)}setVector2(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))}setFloat2(e,t,i){this._cacheFloat2(e,t,i)&&(this.engine.setFloat2(this._uniforms[e],t,i)||(this._valueCache[e]=null))}setVector3(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))}setFloat3(e,t,i,n){this._cacheFloat3(e,t,i,n)&&(this.engine.setFloat3(this._uniforms[e],t,i,n)||(this._valueCache[e]=null))}setVector4(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))}setQuaternion(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))}setFloat4(e,t,i,n,r){this._cacheFloat4(e,t,i,n,r)&&(this.engine.setFloat4(this._uniforms[e],t,i,n,r)||(this._valueCache[e]=null))}setColor3(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))}setColor4(e,t,i){this._cacheFloat4(e,t.r,t.g,t.b,i)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,i)||(this._valueCache[e]=null))}setDirectColor4(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}}var r=i(67);const a=new WeakMap,s={_webGLVersion:2,cachedPipelines:{}};function o(e){let t=a.get(e);if(!t){if(!e)return s;t={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,cachedPipelines:{}},a.set(e,t)}return t}function l(e){a.delete(e)}function d(e,t,i,n,r,a){const s=o(n);var l;return a||(a=null!==(l=s._createShaderProgramInjection)&&void 0!==l?l:u),a(e,g(t,"vertex",n,s._contextWasLost),g(i,"fragment",n,s._contextWasLost),n,r,s.validateShaderPrograms)}function c(e,t,i,n,r,a=null,s){const l=o(r);var d;s||(s=null!==(d=l._createShaderProgramInjection)&&void 0!==d?d:u);const c=l._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return s(e,p(t,"vertex",n,c,r,l._contextWasLost),p(i,"fragment",n,c,r,l._contextWasLost),r,a,l.validateShaderPrograms)}function h(e,t){const i=new n,r=o(e);return r.parallelShaderCompile&&(i.isParallelCompiled=!0),i.context=r._context,i}function u(e,t,i,n,r=null,a){const s=n.createProgram();if(e.program=s,!s)throw new Error("Unable to create program");return n.attachShader(s,t),n.attachShader(s,i),n.linkProgram(s),e.context=n,e.vertexShader=t,e.fragmentShader=i,e.isParallelCompiled||m(e,n,a),s}function m(e,t,i){const n=e.context,r=e.vertexShader,a=e.fragmentShader,s=e.program;if(!n.getProgramParameter(s,n.LINK_STATUS)){if(!t.getShaderParameter(r,t.COMPILE_STATUS)){const i=t.getShaderInfoLog(r);if(i)throw e.vertexCompilationError=i,new Error("VERTEX SHADER "+i)}if(!t.getShaderParameter(a,t.COMPILE_STATUS)){const i=t.getShaderInfoLog(a);if(i)throw e.fragmentCompilationError=i,new Error("FRAGMENT SHADER "+i)}const i=n.getProgramInfoLog(s);if(i)throw e.programLinkError=i,new Error(i)}if(i&&(n.validateProgram(s),!n.getProgramParameter(s,n.VALIDATE_STATUS))){const t=n.getProgramInfoLog(s);if(t)throw e.programValidationError=t,new Error(t)}n.deleteShader(r),n.deleteShader(a),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function f(e,t,i,n,r,a,s,l,h,u="",m,f,p){const g=o(e.context);var _,S;f||(f=null!==(_=g.createRawShaderProgramInjection)&&void 0!==_?_:d),p||(p=null!==(S=g.createShaderProgramInjection)&&void 0!==S?S:c);const v=e;v.program=n?f(v,t,i,v.context,h):p(v,t,i,l,v.context,h),v.program.__SPECTOR_rebuildProgram=s,m()}function p(e,t,i,n,a,s){return g(Object(r.b)(e,i,n),t,a,s)}function g(e,t,i,n){const r=i.createShader("vertex"===t?i.VERTEX_SHADER:i.FRAGMENT_SHADER);if(!r){let e=i.NO_ERROR,r=i.NO_ERROR;for(;(r=i.getError())!==i.NO_ERROR;)e=r;throw new Error(`Something went wrong while creating a gl ${t} shader object. gl error=${e}, gl isContextLost=${i.isContextLost()}, _contextWasLost=${n}`)}return i.shaderSource(r,e),i.compileShader(r),r}function _(e,t){t.useProgram(e)}function S(e,t){const i=e;if(!i.isParallelCompiled)return void t(e);const n=i.onCompiled;i.onCompiled=()=>{null==n||n(),t(e)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static _CheckLimit(e,t){let i=n._LogLimitOutputs[e];return i?i.current++:(i={limit:t,current:1},n._LogLimitOutputs[e]=i),i.current<=i.limit}static _GenerateLimitMessage(e,t=1){const i=n._LogLimitOutputs[e];if(!i||!n.MessageLimitReached)return;const r=this._Levels[t];var a;i.current===i.limit&&n[r.name](n.MessageLimitReached.replace(/%LIMIT%/g,""+i.limit).replace(/%TYPE%/g,null!==(a=r.name)&&void 0!==a?a:""))}static _AddLogEntry(e){n._LogCache=e+n._LogCache,n.OnNewCacheEntry&&n.OnNewCacheEntry(e)}static _FormatMessage(e){const t=e=>e<10?"0"+e:""+e,i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+e}static _LogDisabled(e,t){}static _LogEnabled(e=1,t,i){const r=Array.isArray(t)?t[0]:t;if(void 0!==i&&!n._CheckLimit(r,i))return;const a=n._FormatMessage(r),s=this._Levels[e],o=Array.isArray(t)?t.slice(1):[];s.logFunc&&s.logFunc("BJS - "+a,...o);const l=`<div style='color:${s.color}'>${a}</div><br>`;n._AddLogEntry(l),n._GenerateLimitMessage(r,e)}static get LogCache(){return n._LogCache}static ClearLogCache(){n._LogCache="",n._LogLimitOutputs={},n.errorsCount=0}static set LogLevels(e){n.Log=n._LogDisabled,n.Warn=n._LogDisabled,n.Error=n._LogDisabled,[n.MessageLogLevel,n.WarningLogLevel,n.ErrorLogLevel].forEach(t=>{if((e&t)===t){const e=this._Levels[t];n[e.name]=n._LogEnabled.bind(n,t)}})}}n.NoneLogLevel=0,n.MessageLogLevel=1,n.WarningLogLevel=2,n.ErrorLogLevel=4,n.AllLogLevel=7,n.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",n._LogCache="",n._LogLimitOutputs={},n._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],n.errorsCount=0,n.Log=n._LogEnabled.bind(n,n.MessageLogLevel),n.Warn=n._LogEnabled.bind(n,n.WarningLogLevel),n.Error=n._LogEnabled.bind(n,n.ErrorLogLevel)},function(e,t,i){"use strict";var n,r,a;i.d(t,"f",(function(){return r})),i.d(t,"b",(function(){return Z})),i.d(t,"d",(function(){return g})),i.d(t,"e",(function(){return C})),i.d(t,"c",(function(){return v})),i.d(t,"a",(function(){return K})),function(e){e[e.Undefined=-1]="Undefined",e[e.InContent=0]="InContent",e[e.TaskPane=1]="TaskPane",e[e.Contextual=2]="Contextual"}(n||(n={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(r||(r={})),function(e){e[e.UnifiedApp=0]="UnifiedApp",e[e.MSTeams=1]="MSTeams",e[e.TeamsiOS=2]="TeamsiOS",e[e.TeamsAndroid=3]="TeamsAndroid",e[e.Unknown=4]="Unknown"}(a||(a={}));var s,o=i(22),l=i(9),d=i(3),c=i(7),h=function(){function e(){}return e.s_AppForOfficeContainerClassName="AppForOfficeContainer",e.s_AppForOfficeContainerHiddenClassName="AppForOfficeContainer AppForOfficeHidden",e}(),u=function(){function e(e,t,i,n){this.m_activatedAppForOfficeViewElements=[],this.m_preactivatedAppForOfficeViewElements=[],this.m_isRightToLeft=!1,this.m_appForOfficeManager=e,this.m_parentElement=t,this.m_viewId=i,this.m_isRightToLeft=n,this.m_activatedAppForOfficeViewElements=[],this.m_preactivatedAppForOfficeViewElements=[]}return e.prototype.dispose=function(){this.removeAppsForOffice()},e.prototype.removeAppsForOffice=function(){if(void 0!==this.m_activatedAppForOfficeViewElements){for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].dispose();this.m_activatedAppForOfficeViewElements=[]}if(void 0!==this.m_preactivatedAppForOfficeViewElements){for(var i=0,n=this.m_preactivatedAppForOfficeViewElements;i<n.length;i++)n[i].dispose();this.m_preactivatedAppForOfficeViewElements=[]}},e.prototype.getContainedAppsForOffice=function(){var e=[];if(void 0!==this.m_activatedAppForOfficeViewElements)for(var t=0,i=this.m_activatedAppForOfficeViewElements;t<i.length;t++){var n=i[t];e.push(n.AppForOffice)}if(void 0!==this.m_preactivatedAppForOfficeViewElements)for(var r=0,a=this.m_preactivatedAppForOfficeViewElements;r<a.length;r++)n=a[r],e.push(n.AppForOffice);return e},e.prototype.findPreactivatedAppForOfficeViewElement=function(e){if(void 0!==this.m_preactivatedAppForOfficeViewElements)for(var t=0,i=this.m_preactivatedAppForOfficeViewElements;t<i.length;t++){var n=i[t];if(e.InstanceId===n.AppForOffice.InstanceId)return n}},e.prototype.findActivatedAppForOfficeViewElement=function(e){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var t=0,i=this.m_activatedAppForOfficeViewElements;t<i.length;t++){var n=i[t];if(e.InstanceId===n.AppForOffice.InstanceId)return n}},e.prototype.findActivatedViewElementSiblingByInstanceId=function(e,t){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var i=0;i<this.m_activatedAppForOfficeViewElements.length;i+=1)if(e===this.m_activatedAppForOfficeViewElements[i].AppForOffice.InstanceId){if(t&&i+1<this.m_activatedAppForOfficeViewElements.length)return this.m_activatedAppForOfficeViewElements[i+1];if(!t&&i-1>=0)return this.m_activatedAppForOfficeViewElements[i-1]}},e.prototype.activateAppsForOffice=function(e,t,i){if(void 0!==e&&0!==e.length&&void 0!==t){void 0===this.m_activatedAppForOfficeViewElements&&(this.m_activatedAppForOfficeViewElements=[]);for(var n=0,r=e;n<r.length;n++){var a=r[n],s=this.findActivatedAppForOfficeViewElement(a);void 0===s?(void 0!==(s=this.findPreactivatedAppForOfficeViewElement(a))&&(s.AppForOffice=a),void 0===(s=this.findPreactivatedAppForOfficeViewElement(a))?(s=new m(a,this.m_parentElement,this.m_appForOfficeManager,this.m_isRightToLeft)).activateAppForOffice(t,i):(s.showAppForOffice(),"function"==typeof t.setActivationCompletedStatus&&t.setActivationCompletedStatus(s.AppForOffice.InstanceId,!0),this.m_appForOfficeManager.raiseEventToAppForOffice(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),s.AppForOffice.InstanceId)),this.m_activatedAppForOfficeViewElements.push(s)):s.AppForOffice=a}}},e.prototype.preactivateAppsForOffice=function(e,t,i){if(void 0===this.m_preactivatedAppForOfficeViewElements&&(this.m_preactivatedAppForOfficeViewElements=[]),void 0===this.findPreactivatedAppForOfficeViewElement(e)&&void 0===this.findActivatedAppForOfficeViewElement(e)){var n=new m(e,this.m_parentElement,this.m_appForOfficeManager,this.m_isRightToLeft);n.preactivateAppForOffice(e,t,i),this.m_preactivatedAppForOfficeViewElements.push(n)}else void 0!==i&&i()},e.prototype.hasAppForOfficeBeenPrepared=function(e){return void 0!==this.findPreactivatedAppForOfficeViewElement(e)},e.prototype.showAppsForOffice=function(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].showAppForOffice()},e.prototype.hideAppsForOffice=function(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].hideAppForOffice()},e.prototype.insertAppForOffice=function(e){throw new Error("not implement yet")},e.prototype.updateLayout=function(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].updatePositionAndSize()},Object.defineProperty(e.prototype,"Id",{get:function(){return this.m_viewId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ParentElement",{get:function(){return this.m_parentElement},set:function(e){this.m_parentElement=e},enumerable:!1,configurable:!0}),e}(),m=function(){function e(e,t,i,n){if(void 0===i)throw new Error("manager");this.m_appForOffice=e,this.m_appForOfficeManager=i,this.m_isRightToLeft=n,this.m_appForOfficeHtmlElement=document.createElement("div"),this.m_appForOfficeHtmlElement.className=h.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden",this.m_appForOfficeHtmlElement.id="AppForOffice_".concat(e.InstanceId),this.m_appForOfficeHtmlElement.style.position="absolute",this.m_appForOfficeHtmlElement.style.pointerEvents="auto",t.appendChild(this.m_appForOfficeHtmlElement)}return e.prototype.dispose=function(){this.removeAppForOfficeHtml()},e.prototype.removeAppForOfficeHtml=function(){void 0!==this.m_appForOfficeHtmlElement&&null!=this.m_appForOfficeHtmlElement.parentNode&&this.m_appForOfficeHtmlElement.parentNode.removeChild(this.m_appForOfficeHtmlElement)},e.prototype.clearElementHtml=function(e){e.textContent=""},e.prototype.activateAppForOffice=function(e,t){if(this.clearElementHtml(this.m_appForOfficeHtmlElement),void 0!==this.m_appForOffice&&void 0!==e){t?(this.m_appForOfficeHtmlElement.className=h.s_AppForOfficeContainerClassName,this.m_appForOfficeHtmlElement.style.visibility="visible"):(this.m_appForOfficeHtmlElement.className=h.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden");var i=new Object;i.div=this.m_appForOfficeHtmlElement,i.id=this.m_appForOffice.InstanceId,i.solutionId=this.m_appForOffice.AppForOfficeRef.Id,i.version=this.m_appForOffice.AppForOfficeRef.Version,i.storeId=this.m_appForOffice.AppForOfficeRef.Store,i.storeType=this.m_appForOffice.AppForOfficeRef.StoreType,i.settings=this.m_appForOffice.Settings,i.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,i.osfControlType=OSF.OsfControlTarget.InContent,this.m_appForOfficeManager.AreThirdPartyAddInsAllowed||OSF.OsfControl.isFirstPartyStoreString(i.storeType)||(l.a.sendTraceTag(508688333,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Content web add-in disabled by doc IRM"),i.hostInfoFlags|=OSF.HostInfoFlags.ProtectedDocDisable),e.insertOsfControl(i),"function"==typeof e.setActivationCompletedStatus&&e.setActivationCompletedStatus(this.AppForOffice.InstanceId,!0)}},e.prototype.preactivateAppForOffice=function(e,t,i){if(this.clearElementHtml(this.m_appForOfficeHtmlElement),void 0!==this.m_appForOffice&&void 0!==t&&null!=e){this.m_appForOfficeHtmlElement.className=h.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden";var n=new Object;n.div=this.m_appForOfficeHtmlElement,n.id=this.m_appForOffice.InstanceId,n.solutionId=this.m_appForOffice.AppForOfficeRef.Id,n.version=this.m_appForOffice.AppForOfficeRef.Version,n.storeId=this.m_appForOffice.AppForOfficeRef.Store,n.storeType=this.m_appForOffice.AppForOfficeRef.StoreType,n.settings=this.m_appForOffice.Settings,n.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,n.osfControlType=OSF.OsfControlTarget.InContent,n.snapshotUrl="",n.preactivationCallback=i,this.m_appForOfficeManager.AreThirdPartyAddInsAllowed||OSF.OsfControl.isFirstPartyStoreString(n.storeType)||(l.a.sendTraceTag(508688332,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Content web add-in blocked for preactivate by doc IRM"),n.hostInfoFlags|=OSF.HostInfoFlags.ProtectedDocDisable),t.insertOsfControl(n),"function"==typeof t.setActivationCompletedStatus&&t.setActivationCompletedStatus(this.AppForOffice.InstanceId,!0)}},e.prototype.updatePositionAndSize=function(){var e=this.m_appForOffice.Shape.Left,t=this.m_appForOffice.Shape.Top,i=this.m_appForOffice.Shape.Width,n=this.m_appForOffice.Shape.Height;this.m_appForOfficeHtmlElement.style.left="".concat(e-(this.m_isRightToLeft?i:0),"px"),this.m_appForOfficeHtmlElement.style.top="".concat(t,"px"),this.m_appForOfficeHtmlElement.style.width="".concat(i,"px"),this.m_appForOfficeHtmlElement.style.height="".concat(n,"px")},e.prototype.showAppForOffice=function(){this.m_appForOfficeHtmlElement.className=h.s_AppForOfficeContainerClassName,this.m_appForOfficeHtmlElement.style.visibility="visible"},e.prototype.hideAppForOffice=function(){this.m_appForOfficeHtmlElement.className=h.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden"},Object.defineProperty(e.prototype,"AppForOffice",{get:function(){return this.m_appForOffice},set:function(e){this.m_appForOffice=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Element",{get:function(){return this.m_appForOfficeHtmlElement},enumerable:!1,configurable:!0}),e}();!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.NotImplemented=1]="NotImplemented",e[e.NotReady=2]="NotReady",e[e.Exempted=3]="Exempted",e[e.NotTrusted=4]="NotTrusted",e[e.Trusted=5]="Trusted"}(s||(s={}));var f,p,g,_=function(){function e(e,t){this.m_methodFactory=e,this.m_eventStore=t,this.m_eventStore}return e.prototype.InvokeDdaMethod=function(e,t,i){var n=e.DdaMethod.DispatchId,r=this.m_methodFactory.getApiMethod(n);null!=r?(r.Parameters=e,r.Callback=t,r.AdditionalParameters=i,r.AppId=e.DdaMethod.ControlId,r.go()):(l.a.sendTraceTag(508688329,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"API Call for method ID ".concat(n," does not exist.")),this.callbackWithInternalFailure(t))},e.prototype.RegisterDdaEventAsync=function(e,t,i,n,r){var a=this.m_eventStore.getApiEvent(e);null!=a?a.addHandler(t,n,r,i):(l.a.sendTraceTag(508688328,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"Event for dispatch ID ".concat(e," does not exist.")),this.callbackWithInternalFailure(r))},e.prototype.UnregisterDdaEventAsync=function(e,t,i,n,r){var a=this.m_eventStore.getApiEvent(e);null!=a?a.removeHandler(t,n,r,i):(l.a.sendTraceTag(508688327,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"Event for dispatch ID ".concat(e,"  does not exist:")),this.callbackWithInternalFailure(r))},e.prototype.callbackWithInternalFailure=function(e){if(null!=e){var t={};t[S.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,e(t)}},e}(),S=function(){function e(){}return e.c_Error="Error",e}(),v=function(e,t,i){this.fIsEmpty=!0,this.colorScheme=e,this.fontScheme=t,this.backgroundColor=i,this.fIsEmpty=!e&&!t&&!i},y=function(){},T=function(){},b=function(){function e(e){this.red=0,this.green=0,this.blue=0,this.intColor=0,this.fValid=!1,this.INVALID=-1,null!=e&&3===e.length&&(this.red=e[2],this.green=e[1],this.blue=e[0],this.fValid=this.isColorValid(),this.intColor=this.convertToInteger())}return e.prototype.convertToInteger=function(){return this.fValid?(this.intColor=this.blue,this.intColor+=this.green<<8,this.intColor+=this.red<<16):this.intColor=this.INVALID,this.intColor},e.prototype.isColorValid=function(){return!w.isNullOrUndefined(this.red)&&this.red>=0&&!w.isNullOrUndefined(this.green)&&this.green>=0&&!w.isNullOrUndefined(this.blue)&&this.blue>=0},e}(),w=function(){function e(){}return e.isNullOrUndefined=function(e){return null==e||void 0===e},e.validateArgument=function(t){if(e.isNullOrUndefined(t))throw Error("");return t},e}();!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.ConvertAndEdit=2]="ConvertAndEdit",e[e.CopyAndEdit=3]="CopyAndEdit",e[e.ContinueEditing=4]="ContinueEditing"}(g||(g={}));var C=((f={}).errorCodes=((p={}).ooeSuccess=0,p.ooeCoercionTypeNotSupported=1e3,p.ooeInternalError=5001,p.ooeDocumentReadOnly=5002,p.ooeInvalidApiCallInContext=5004,p.ooeUnsupportedEnumeration=5007,p.ooeCannotNavTo=7001,p.ooeSpecifiedIdNotExist=7002,p.ooeNavOutOfBound=7004,p),f),I=function(){function e(e,t,i){this._errorCode=0,this._result={},this._apiFacade=null,this._parameters=e,this._callback=t,this._additionalParameters=i}return Object.defineProperty(e.prototype,"Parameters",{get:function(){return this._parameters},set:function(e){this._parameters=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AdditionalParameters",{get:function(){return this._additionalParameters},set:function(e){this._additionalParameters=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Callback",{get:function(){return this._callback},set:function(e){this._callback=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AppId",{get:function(){return this._appId},set:function(e){this._appId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AppForOfficeManager",{get:function(){return this._appForOfficeManager},set:function(e){this._appForOfficeManager=e,null!=this._appForOfficeManager?this._apiFacade=this._appForOfficeManager.ApiFacade:this._apiFacade=null},enumerable:!1,configurable:!0}),e.prototype.go=function(){var e=this;this._result,this.executeAsync().then((function(){e.sendResponse()}))},e.prototype.sendResponse=function(){this._result[S.c_Error]=this._errorCode,this.Callback(this._result)},e.prototype.getAppById=function(){return this.AppId&&this._appForOfficeManager?this._appForOfficeManager.getAppByInstanceId(this.AppId):null},e}(),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,i;return Object(o.__generator)(this,(function(n){return null!=(e=this.getAppById())?((t={}).Settings=this.formatSetting(e.Settings),this._result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=t,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(i="AppForOffice instance could not be found for ID ".concat(this.AppId),l.a.sendTraceTag(508688344,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,i),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Loads/Refreshes Settings object for an app"},enumerable:!1,configurable:!0}),t.prototype.formatSetting=function(e){var t={},i=0;for(var n in e){var r=n,a=e[n];t[i.toString()]={key:r,value:a},i+=1}return t},t}(I),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDocumentReadOnly,[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"(Not implemented) Saves settings to document."},enumerable:!1,configurable:!0}),t}(I),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){if(e=null,null!=this._apiFacade)switch(this._apiFacade.getEditMode()){case g.ContinueEditing:e=Microsoft.Office.WebExtension.ActiveView.Edit;break;default:e=Microsoft.Office.WebExtension.ActiveView.Read}return null!=e?(this._result[Microsoft.Office.WebExtension.Parameters.Data]=e,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns the ActiveView value for current mode."},enumerable:!1,configurable:!0}),t}(I),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,i,n,r;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade)return[2];a.label=1;case 1:return a.trys.push([1,7,,8]),e=this.Parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],t=e[OSF.DDA.Marshaling.NavigationKeys.GoToType],i=e[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),t!==OSF.DDA.Marshaling.GoToType.Index?[3,3]:(n=this,[4,this._apiFacade.goToByIndex(i)]);case 2:return n._errorCode=a.sent(),[3,6];case 3:return t!==OSF.DDA.Marshaling.GoToType.Slide?[3,5]:(r=this,[4,this._apiFacade.goToBySlide(i)]);case 4:return r._errorCode=a.sent(),[3,6];case 5:this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration,a.label=6;case 6:return[3,8];case 7:return a.sent(),[2];case 8:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Go to the slide specified by user."},enumerable:!1,configurable:!0}),t}(I),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t,i,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade)return[2];r.label=1;case 1:return r.trys.push([1,6,,7]),this.Parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString()!==Microsoft.Office.WebExtension.CoercionType.SlideRange?[3,4]:(e=void 0,(t=this._apiFacade)?(n=(i=w).isNullOrUndefined,[4,this._apiFacade.getSelectedSlides()]):[3,3]);case 2:t=!n.apply(i,[e=r.sent()]),r.label=3;case 3:return t&&(this._result[OSF.DDA.WAC.UniqueArguments.Data]=e,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),[3,5];case 4:this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported,r.label=5;case 5:return[3,7];case 6:return r.sent(),[2];case 7:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Get selected data from slide."},enumerable:!1,configurable:!0}),t}(I),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(i){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,e=void 0,null==this._apiFacade||w.isNullOrUndefined(e=this._apiFacade.getDocumentUrl())||((t={})["".concat(OSF.DDA.Marshaling.FilePropertiesKeys.Url)]=e,this._result["".concat(OSF.DDA.Marshaling.FilePropertiesKeys.Properties)]=t,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns the file properties. Now it only returns the URL."},enumerable:!1,configurable:!0}),t}(I),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,i,n;return Object(o.__generator)(this,(function(r){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._appForOfficeManager||null==this._apiFacade||null==(e=this._appForOfficeManager.getSlideIdByInstanceId(this.AppId))?[2]:null==(i=this._appForOfficeManager.getAppForOfficeThemeBySlide(e))||i.fIsEmpty?(l.a.sendTraceTag(508688343,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"Error while fetching theming for Slide: slide theme returned as null."),[2]):(n=t.updateObjectWithDocumentThemeMapping({},i),this._result["".concat(OSF.DDA.Marshaling.ThemingKeys.DocumentTheme)]=n,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,[2])}))}))},t.updateObjectWithDocumentThemeMapping=function(e,i){if(null==e||null==i||i.fIsEmpty)return e;var n=e,r=i.colorScheme;null!=r&&(n[OSF.DDA.Marshaling.ThemingKeys.Accent1]=t.extractColorValue(r.Accent1),n[OSF.DDA.Marshaling.ThemingKeys.Accent2]=t.extractColorValue(r.Accent2),n[OSF.DDA.Marshaling.ThemingKeys.Accent3]=t.extractColorValue(r.Accent3),n[OSF.DDA.Marshaling.ThemingKeys.Accent4]=t.extractColorValue(r.Accent4),n[OSF.DDA.Marshaling.ThemingKeys.Accent5]=t.extractColorValue(r.Accent5),n[OSF.DDA.Marshaling.ThemingKeys.Accent6]=t.extractColorValue(r.Accent6),n[OSF.DDA.Marshaling.ThemingKeys.Background1]=t.extractColorValue(r.Background1),n[OSF.DDA.Marshaling.ThemingKeys.Background2]=t.extractColorValue(r.Background2),n[OSF.DDA.Marshaling.ThemingKeys.Text1]=t.extractColorValue(r.Text1),n[OSF.DDA.Marshaling.ThemingKeys.Text2]=t.extractColorValue(r.Text2),n[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=t.extractColorValue(r.Hyperlink),n[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=t.extractColorValue(r.FollowedHyperlink));var a=i.fontScheme;return null!=a&&(n[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=a.HeaderEastAsian,n[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=a.HeaderLatin,n[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=a.HeaderLocalized,n[OSF.DDA.Marshaling.ThemingKeys.HdScript]=a.HeaderScript,n[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=a.BodyEastAsian,n[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=a.BodyLatin,n[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=a.BodyLocalized,n[OSF.DDA.Marshaling.ThemingKeys.BdScript]=a.BodyScript),n[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=t.extractColorValue(i.backgroundColor),n},t.extractColorValue=function(e){if(e&&!(e.intColor<0))return e.intColor},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."},enumerable:!1,configurable:!0}),t}(I),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"(Not implemented) Returns OfficeTheme properties."},enumerable:!1,configurable:!0}),t}(I),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this.AppForOfficeManager?[2]:[4,this.AppForOfficeManager.getAccessTokenAsync(this.AppId,this.Parameters)];case 1:return(e=t.sent())?(this._errorCode=e.errorCode,0===e.errorCode&&(this._result["".concat(OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken)]=e.accessToken),[2]):[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns an access token for the add-in."},enumerable:!1,configurable:!0}),t}(I),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade||void 0===this.AppId)return[2];i.label=1;case 1:return i.trys.push([1,4,,5]),(e=JSON.stringify(this.Parameters[OSF.DDA.WAC.UniqueArguments.Data]))?(t=this,[4,this._apiFacade.setAddinSyncState({instanceId:this.AppId,liveShareState:e})]):[3,3];case 2:t._errorCode=i.sent(),i.label=3;case 3:return[3,5];case 4:return i.sent(),[2];case 5:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Set addin sync state."},enumerable:!1,configurable:!0}),t}(I),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeAsync=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade||void 0===this.AppId)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._apiFacade.getAddinSyncState(this.AppId)];case 2:return(e=t.sent())&&(this._result[OSF.DDA.WAC.UniqueArguments.Data]=JSON.parse(e),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),[3,4];case 3:return t.sent(),[2];case 4:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Get addin sync state."},enumerable:!1,configurable:!0}),t}(I),B=function(e){function t(t){return e.call(this,t)||this}return Object(o.__extends)(t,e),t.prototype.populateMethodList=function(){this.m_methodList={},this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,(function(){return new P})),this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,(function(){return new E})),this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,(function(){return new x})),this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,(function(){return new k})),this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,(function(){return new M})),this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,(function(){return new A})),this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,(function(){return new R})),this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,(function(){return new O})),this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,(function(){return new F})),this.set(OSF.DDA.MethodDispId.dispidSetLiveShareStateMethod,(function(){return new D})),this.set(OSF.DDA.MethodDispId.dispidGetLiveShareStateMethod,(function(){return new L}))},t}(function(){function e(e){this.m_methodList=null,this.m_appForOfficeManager=e}return e.prototype.getApiMethod=function(e){if(null==this.m_methodList&&this.populateMethodList(),null==e||null==this.m_methodList[e])return null;var t=this.m_methodList[e]();return null!=t&&(t.AppForOfficeManager=this.m_appForOfficeManager),t},e.prototype.set=function(e,t){this.m_methodList[e]=t},e}()),N=function(){function e(){this.m_handlers={}}return e.prototype.apiEvent=function(){this.m_handlers},Object.defineProperty(e.prototype,"AppForOfficeManager",{get:function(){return this.m_appForOfficeManager},set:function(e){this.m_appForOfficeManager=e},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){var i=this.getProcessedEventArgs(e),n=void 0;if(t&&(n=this.m_handlers[t]))n(i);else for(var r in this.m_handlers)(n=this.m_handlers[r])&&n(i)},e.prototype.addHandler=function(e,t,i,n){this.m_handlers[e]=t,i&&this.callbackWithSuccess(i)},e.prototype.removeHandler=function(e,t,i,n){delete this.m_handlers[e],i&&this.callbackWithSuccess(i)},e.prototype.callbackWithSuccess=function(e){this.callbackWithErrorCode(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},e.prototype.callbackWithErrorCode=function(e,t){if(null!=e){var i={};i[S.c_Error]=t,e(i)}},e}(),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return e},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(N),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return"view"},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(N),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return e},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(N),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return null},t.prototype.addHandler=function(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},t.prototype.removeHandler=function(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(N),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return null},t.prototype.addHandler=function(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},t.prototype.removeHandler=function(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(N),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){var t={};try{var i=e;i&&(t[OSF.DDA.WAC.UniqueArguments.Data]=JSON.parse(i.liveShareState),t[S.c_Error]=OSF.DDA.ErrorCodeManager.ooeSuccess)}catch(e){t[S.c_Error]=OSF.DDA.ErrorCodeManager.ooeInternalError}return t},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(N),j=function(e){function t(t){return e.call(this,t)||this}return Object(o.__extends)(t,e),t.prototype.populateEventList=function(){this.m_eventList={},this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,V.Instance),this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,W.Instance),this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,U.Instance),this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,z.Instance),this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,H.Instance),this.set(OSF.DDA.EventDispId.dispidLiveShareStateChangedEvent,G.Instance)},t}(function(){function e(e){this.m_eventList=null,this.m_appForOfficeManager=e}return e.prototype.getApiEvent=function(e){if(null==this.m_eventList&&this.populateEventList(),null==e||null==this.m_eventList||null==this.m_eventList[e])return null;var t=this.m_eventList[e];return t.AppForOfficeManager=this.m_appForOfficeManager,t},e.prototype.clearHandlersForApp=function(e){for(var t in this.m_eventList)this.m_eventList[t].removeHandler(e)},e.prototype.set=function(e,t){null!=this.m_eventList&&(this.m_eventList[e]=t)},e}()),$=i(1),q=i(34),Z=function(){function e(){this.events=new q.EventEmitter,this.m_appForOfficeViewQueue=[],this.m_slideIdToAppForOfficeViewMap=new Map,this.m_slideIdToAppForOfficeThemeMap=new Map,this.m_appForOfficeToAppForOfficeViewMap=new Map,this.m_panelParentElement=null,this.m_instanceIdToAppMapping=new Map,this.m_instanceIdToSlideIdMapping=new Map,this.m_fInitialized=!1,this.m_frameTrustState=s.NotInitialized,this.m_osfruntimeloaded=!1,this.c_NumberOfMostRecentlyUsedAppForOfficeView=1,this.c_OsfRuntimeScriptId="OsfRuntimeScriptId",this.c_OsfRuntimeJSFileName="osfruntimepptwac.js",this.c_OsfRunTimeFunctionName="OfficeExt",this.c_UiHostUnifiedAppName="unified app",this.c_TimerInterval=20,this.m_fInitialized=!1,this.m_managerSettings={AppsForOfficePrivateCatalogEnabled:!0,AppForOfficeAllowExternalMarketplace:!0,AppForOfficeOmexBaseUrl:"https://store.office.com",AppForOfficeTrustUXIsEnabledForPowerPoint:!0,AppLcid:"1033",AppUILocale:"en-US",AreThirdPartyAddInsAllowed:!0,IsRtl:!1,ServerUrl:"",UploadFileDevCatalogIsDisabled:!1,SdxCdnUrl:"",Sdx1CdnUrl:"",ForceUseSdx1Cdn:!1,SdxDmsUrl:"",SovereignFederationDMSToken:"Production",SovereignFederationDMSTokenSuffix:"",DefaultManifestTokens:{__proto__:null},sdxExceptionFrom1CDNList:""}}return e.prototype.initialize=function(e,t){this.m_managerSettings=t,this.updateManagerSettings(),this.m_panelParentElement=e,this.m_appForOfficeViewQueue=[],this.m_methodFactory=new B(this),this.m_eventStore=new j(this),this.m_fInitialized=!0},e.prototype.updateManagerSettings=function(){var e=this.m_managerSettings.JsScriptsBasePath;e&&(this.m_managerSettings.JsScriptsBasePath=e.replace("/ssapp/",""))},e.prototype.fInitialized=function(){return this.m_fInitialized},e.prototype.fOsfruntimeLoaded=function(){return this.m_osfruntimeloaded},e.prototype.prepareAppsForOfficeList=function(e,t,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(o.__generator)(this,(function(s){if(!this.fInitialized())return[2];if(null==t||0===t.length)return[2];for(n=0,r=t;n<r.length;n++)a=r[n],this.prepareAppForOffice(e,a,(function(){}));return i&&this.m_slideIdToAppForOfficeThemeMap.set(e,i),[2]}))}))},e.prototype.showAppsForOfficeForSlide=function(e,t,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(o.__generator)(this,(function(a){return this.fInitialized()?(this.m_currentSlideId=e,null==t||0===t.length?(this.hideAppForOfficeViewsExcludeCurrentSlide(),[2]):(this.setInstanceIdToAppMapForSlide(t),this.setInstanceIdToSlideIdMapForSlide(e,t),i&&this.m_slideIdToAppForOfficeThemeMap.set(e,i),null==(n=this.getAppForOfficeViewBySlide(this.m_currentSlideId))?(null==(n=this.m_slideIdToAppForOfficeViewMap.get(this.m_currentSlideId))?n=new u(this,this.m_panelParentElement,this.m_currentSlideId,this.m_managerSettings.IsRtl):this.m_slideIdToAppForOfficeViewMap.delete(this.m_currentSlideId),this.m_appForOfficeViewQueue.push(n),this.m_appForOfficeViewQueue.length>this.c_NumberOfMostRecentlyUsedAppForOfficeView&&(r=this.m_appForOfficeViewQueue[0],this.m_appForOfficeViewQueue.splice(0,1),this.disposeAppForOfficeView(r)),n.activateAppsForOffice(t,this.contextActivationManager(),!0),n.updateLayout(),l.a.sendTraceTag(508688342,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Apps For Office on the slide ".concat(this.m_currentSlideId," are activated."))):(n.activateAppsForOffice(t,this.contextActivationManager(),!0),n.showAppsForOffice(),n.updateLayout(),l.a.sendTraceTag(508688341,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Apps For Office on the slide ".concat(this.m_currentSlideId," are showing."))),this.hideAppForOfficeViewsExcludeCurrentSlide(),[2])):[2]}))}))},e.prototype.loadOsfRuntime=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return t={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},this.m_managerSettings.UiHost&&this.m_managerSettings.UiHost.toLocaleLowerCase()===this.c_UiHostUnifiedAppName?(this.m_osfruntimeloaded=void 0!==window[this.c_OsfRunTimeFunctionName]&&void 0!==OfficeExt.CatalogFactory&&void 0!==OfficeExt.CatalogFactory.resolve(OSF.StoreType.OMEX),this.m_osfruntimeloaded?[3,2]:[4,this.ensureOsfRuntimeLoaded()]):[3,3];case 1:t=i.sent(),i.label=2;case 2:return[3,5];case 3:return this.m_osfruntimeloaded?[3,5]:[4,this.createScriptElement()];case 4:t=i.sent(),i.label=5;case 5:return[2,t]}}))}))},e.prototype.setFrameTrustStatus=function(t){this.m_frameTrustState=t?s.Trusted:s.NotTrusted,e.m_appForOfficeContextActivivationManager&&e.m_appForOfficeContextActivivationManager.hostCheckReadyHandler(this,this.m_frameTrustState)},e.prototype.ensureOsfRuntimeLoaded=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(o.__generator)(this,(function(i){return[2,new Promise((function(i,n){try{if(t.fInitialized()&&!t.m_osfruntimeloaded)var r={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a=$.a.readNumberOrDefault("ensureOsfRuntimeTimeout",1e4),s=setInterval((function(){(a-=t.c_TimerInterval)<1&&(clearInterval(s),n({status:!1,message:"AppForOfficeManager::ensureOsfRuntimeLoaded:Failed to ensure OsfRuntime."})),void 0!==window[t.c_OsfRunTimeFunctionName]&&void 0!==OfficeExt.CatalogFactory&&void 0!==OfficeExt.CatalogFactory.resolve(OSF.StoreType.OMEX)&&(clearInterval(s),t.m_osfruntimeloaded=!0,r.end=e.performanceNowTrimmed(),i(r))}),t.c_TimerInterval)}catch(e){n({status:!1,message:"AppForOfficeManager::ensureOsfRuntimeLoaded:Failed to ensure OsfRuntime ".concat(e)})}}))]}))}))},e.prototype.createScriptElement=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(o.__generator)(this,(function(i){return[2,new Promise((function(i,n){try{if(t.fInitialized()&&!t.m_osfruntimeloaded&&!document.getElementById(t.c_OsfRuntimeScriptId)){var r={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a=document.createElement("script");a.id=t.c_OsfRuntimeScriptId,$.a.readBooleanOrDefault("UseCrossOriginStaticScripts",!0)&&a.setAttribute("crossdomain","anonymous"),a.type="text/javascript",a.async=!0;var s=t.m_managerSettings.JsScriptsBasePath;s&&s.length>0?a.src="".concat(s,"/").concat(t.c_OsfRuntimeJSFileName):a.src=$.a.readStringOrDefault("osfRunTimeJSFileName",t.c_OsfRuntimeJSFileName),a.onload=function(){t.m_osfruntimeloaded=!0,r.end=e.performanceNowTrimmed(),i(r)},a.onerror=function(){n({status:!1,message:"AppForOfficeManager::createScriptElement:Failed to load the script ".concat(a.src)})},document.body.appendChild(a)}}catch(e){n({status:!1,message:"AppForOfficeManager::createScriptElement:Failed to load the script ".concat(e)})}}))]}))}))},e.prototype.showAppForOffice=function(t,i,n,r){var a={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()};if(!n||!t||!i)return l.a.sendTraceTag(508688340,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"AppForOfficeManager::showAppForOffice invalid input paramters."),a;if(!this.fInitialized()||!this.m_osfruntimeloaded)return a;var s=this.m_appForOfficeToAppForOfficeViewMap.get(n);return s&&(this.disposeAppForOfficeView(s),this.m_appForOfficeToAppForOfficeViewMap.delete(n)),this.setInstanceIdToAppMap(n.InstanceId,n),this.setInstanceIdToSlideIdMap(n.InstanceId,i),r&&this.m_slideIdToAppForOfficeThemeMap.set(i,r),s=new u(this,t,i,this.m_managerSettings.IsRtl),this.m_appForOfficeToAppForOfficeViewMap.set(n,s),s.activateAppsForOffice([n],this.contextActivationManager(),!1),a.end=e.performanceNowTrimmed(),l.a.sendTraceTag(508688339,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Apps For Office on the slide ".concat(this.m_currentSlideId," are activated.")),a},e.prototype.getAppForOfficeViewByAppForOffice=function(e){if(e&&this.m_appForOfficeToAppForOfficeViewMap.has(e))return this.m_appForOfficeToAppForOfficeViewMap.get(e)},e.prototype.getAppByInstanceId=function(e){return w.validateArgument(e),this.m_instanceIdToAppMapping.get(e)},e.prototype.setInstanceIdToAppMap=function(e,t){null!=t&&null!=e&&this.m_instanceIdToAppMapping.set(e,t)},e.prototype.setInstanceIdToAppMapForSlide=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this.setInstanceIdToAppMap(n.InstanceId,n)}},e.prototype.getAppForOfficeViewBySlide=function(e){for(var t=0,i=this.m_appForOfficeViewQueue;t<i.length;t++){var n=i[t];if(n.Id===e)return n}return null},e.prototype.getAppForOfficeThemeBySlide=function(e){return this.m_slideIdToAppForOfficeThemeMap.get(e)},e.prototype.hideAppForOfficeViewsExcludeCurrentSlide=function(){if(null!=this.m_currentSlideId)for(var e=0,t=this.m_appForOfficeViewQueue;e<t.length;e++){var i=t[e];i.Id!==this.m_currentSlideId&&i.hideAppsForOffice()}},e.prototype.hideAppForOfficeOnSlide=function(e){if(this.fInitialized()&&(null==e||this.m_currentSlideId===e)&&null!=this.m_currentSlideId)for(var t=0,i=this.m_appForOfficeViewQueue;t<i.length;t++){var n=i[t];n.Id===this.m_currentSlideId&&n.hideAppsForOffice()}},e.prototype.updateAddinSyncState=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this.raiseEventToAppForOffice(OSF.DDA.EventDispId.dispidLiveShareStateChangedEvent.toString(),e.instanceId,e.liveShareState),[2]}))}))},e.prototype.notifyHostCallback=function(t,i){if(l.a.sendTraceTag(508688338,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"AppForOfficeManager::notifyHostCallback contextId:".concat(t," actionId:").concat(i)),i===OSF.AgaveHostAction.TabExit||i===OSF.AgaveHostAction.TabExitShift)try{var n=i===OSF.AgaveHostAction.TabExit?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift,r=void 0;if(null!=this.m_currentSlideId){var a=this.getAppForOfficeViewBySlide(this.m_currentSlideId);if(a){var s=i===OSF.AgaveHostAction.TabExit;r=a.findActivatedViewElementSiblingByInstanceId(t,s)}}if(null!=r)l.a.sendTraceTag(508688337,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"AppForOfficeManager::NotifyHostCallback Switching focus to another Agave for TabExit/TabExitShift. ContextID of newly focused Agave: ".concat(r.AppForOffice.InstanceId)),e.m_appForOfficeContextActivivationManager.notifyAgave(r.AppForOffice.InstanceId,n);else{l.a.sendTraceTag(508688336,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"AppForOfficeManager::NotifyHostCallback Switching focus to slide pane for TabExit/TabExitShift.");var o=this.getAppByInstanceId(t);if(o){var h=this.getAppForOfficeViewByAppForOffice(o);h&&h.ParentElement&&h.ParentElement.focus()}}}catch(e){l.a.sendTraceTag(508688335,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"AppForOfficeManager::NotifyHostCallback Switching focus threw an exception: ".concat(e))}},e.prototype.contextActivationManager=function(){if(null==e.m_appForOfficeContextActivivationManager){var t=void 0;if(this.m_managerSettings.AppForOfficeContextActivationParameters)null!=(t=this.m_managerSettings.AppForOfficeContextActivationParameters).isHostFrameTrusted&&(this.m_frameTrustState=t.isHostFrameTrusted);else{(t=new Object).appVersion="16",t.appUILocale=this.m_managerSettings.AppUILocale,t.dataLocale=this.m_managerSettings.AppUILocale,t.osfOmexBaseUrl=this.m_managerSettings.AppForOfficeOmexBaseUrl,t.docUrl="",t.pageBaseUrl=this.m_managerSettings.ServerUrl,t.lcid=this.m_managerSettings.AppLcid,t.allowExternalMarketplace=this.m_managerSettings.AppForOfficeAllowExternalMarketplace;var i="".concat(this.m_managerSettings.ServerUrl,"/pptscripts/"),n="".concat(this.m_managerSettings.ServerUrl,"/pptresources/");this.m_managerSettings.JsScriptsBasePath&&(i=this.m_managerSettings.JsScriptsBasePath,n=this.m_managerSettings.JsScriptsBasePath.replace("_pptscripts","_pptresources")),t.localizedScriptsUrl="".concat(i,"/").concat(this.m_managerSettings.AppLcid,"/"),t.localizedImagesUrl="".concat(n,"/").concat(this.m_managerSettings.AppLcid,"/"),t.localizedStylesUrl="".concat(n,"/").concat(this.m_managerSettings.AppLcid,"/"),t.trustAgaves=this.m_managerSettings.AppForOfficeTrustUXIsEnabledForPowerPoint,t.enablePrivateCatalog=this.m_managerSettings.AppsForOfficePrivateCatalogEnabled,t.enableUploadFileDevCatalog=!this.m_managerSettings.UploadFileDevCatalogIsDisabled,t.appSettings={},t.hostFeatureGateFlag=0,t.isHostFrameTrustCheckEnabledForAddIns=!0,t.hostAllowedSdxEmbedding=!0,t.sdxCdnUrl=this.m_managerSettings.SdxCdnUrl,t.sdx1CdnUrl=this.m_managerSettings.Sdx1CdnUrl,t.forceUseSdx1Cdn=this.m_managerSettings.ForceUseSdx1Cdn,t.sdxDmsUrl=this.m_managerSettings.SdxDmsUrl,t.sovereignFederationDMSToken=this.m_managerSettings.SovereignFederationDMSToken,t.sovereignFederationDMSTokenSuffix=this.m_managerSettings.SovereignFederationDMSTokenSuffix,t.defaultManifestTokens=this.m_managerSettings.DefaultManifestTokens,t.sdxExceptionFrom1CDNList=this.m_managerSettings.sdxExceptionFrom1CDNList,this.m_frameTrustState===s.NotInitialized&&window.self===window.top&&(this.m_frameTrustState=s.Trusted),t.isHostFrameTrusted=this.m_frameTrustState}t.appName=OSF.AppName.PowerpointWebApp,t.clientMode=OSF.ClientMode.ReadOnly,t.formFactor=OSF.FormFactor.Default,t.notifyHost=this.notifyHostCallback.bind(this),t.hostControl=new _(this.m_methodFactory,this.m_eventStore),t.externalLogger=this.m_managerSettings.ExtLogger,t.appSettings&&(t.appSettings.PowerPointModernSlideShowEnabled=!0,t.appSettings.PowerPointModernSlideShowUiHost=this.m_managerSettings.UiHost||a.Unknown,t.appSettings.PowerPointModernSlideShowCurrentRole=this.m_managerSettings.SlideShowRole||r.Presenter,t.appSettings.PowerPointModernSlideShowTeamsCallId=this.m_managerSettings.TeamsCallId||"");var o=new OSF.ContextActivationManager(t);o.setWSA(this.m_managerSettings.TheWsaClient),e.m_appForOfficeContextActivivationManager=o,this.m_frameTrustState!==s.NotInitialized&&this.m_frameTrustState!==s.NotReady||this.events.emit("frameTrustCheck")}return e.m_appForOfficeContextActivivationManager},e.prototype.updateAppForOfficeLayout=function(e,t){if(this.fInitialized()&&e&&t){var i=this.getAppForOfficeViewByAppForOffice(t);if(i){i.hideAppsForOffice(),i.ParentElement=e;var n=i.findActivatedAppForOfficeViewElement(t);n&&i.ParentElement.appendChild(n.Element),i.updateLayout(),i.showAppsForOffice()}}},e.prototype.updateLayout=function(e){if(this.fInitialized()&&(null==e||this.m_currentSlideId===e)){var t=this.getAppForOfficeViewBySlide(this.m_currentSlideId);null!=t&&t.updateLayout()}},e.prototype.hasAppForOfficeBeenPrepared=function(e,t){return e===this.m_currentSlideId||!(null==this.m_slideIdToAppForOfficeViewMap||!this.m_slideIdToAppForOfficeViewMap.has(e))&&this.m_slideIdToAppForOfficeViewMap.get(e).hasAppForOfficeBeenPrepared(t)},e.prototype.prepareAppForOffice=function(e,t,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){return n=this.m_slideIdToAppForOfficeViewMap?this.m_slideIdToAppForOfficeViewMap.get(e):null,this.setInstanceIdToSlideIdMap(t.InstanceId,e),null==n&&(n=new u(this,this.m_panelParentElement,e,this.m_managerSettings.IsRtl),this.m_slideIdToAppForOfficeViewMap.set(e,n)),n.preactivateAppsForOffice(t,this.contextActivationManager(),i),l.a.sendTraceTag(508688334,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Apps For Office on the slide ".concat(e," are showing.")),[2]}))}))},e.prototype.raiseEventToAppForOffice=function(e,t,i){if(void 0===i&&(i=!0),this.m_eventStore){var n=this.m_eventStore.getApiEvent(e);n&&n.raiseEvent(i,t)}},e.prototype.disposeAppForOfficeView=function(t){var i=this;t.getContainedAppsForOffice().forEach((function(t){i.m_eventStore&&i.m_eventStore.clearHandlersForApp(t.InstanceId),e.m_appForOfficeContextActivivationManager.purgeOsfControl(t.InstanceId,!1)})),t.dispose(),t&&e.m_appForOfficeContextActivivationManager},e.prototype.setInstanceIdToSlideIdMap=function(e,t){null!=e&&null!=t&&this.m_instanceIdToSlideIdMapping.set(e,t)},e.prototype.setInstanceIdToSlideIdMapForSlide=function(e,t){for(var i=0,n=t;i<n.length;i++){var r=n[i];this.setInstanceIdToSlideIdMap(r.InstanceId,e)}},e.prototype.getSlideIdByInstanceId=function(e){return null==e?null:this.m_instanceIdToSlideIdMapping.get(e)},e.prototype.getAccessTokenAsync=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),null==this.m_appsForOfficeAuthProvider){if(null==this.m_managerSettings.AppsForOfficeAuthFactory)return[2];this.m_appsForOfficeAuthProvider=this.m_managerSettings.AppsForOfficeAuthFactory.createAuthProviderAsync(this.contextActivationManager())}return[4,this.m_appsForOfficeAuthProvider];case 1:return[4,i.sent().getAccessTokenAsync(e,t)];case 2:return[2,i.sent()];case 3:return i.sent(),[2];case 4:return[2]}}))}))},Object.defineProperty(e.prototype,"ApiFacade",{get:function(){return this.m_apiHelper},set:function(e){this.m_apiHelper=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AreThirdPartyAddInsAllowed",{get:function(){return this.m_managerSettings.AreThirdPartyAddInsAllowed},enumerable:!1,configurable:!0}),e.performanceNowTrimmed=function(){return Math.round(performance.now())},e}(),J=(function(){function e(){}e.ensureAppForOfficeManager=function(e,t){return this.s_appForOfficeManager||(this.s_appForOfficeManager=new Z,this.s_appForOfficeManager.ApiFacade=t),this.s_appForOfficeManager&&!this.s_appForOfficeManager.fInitialized()&&this.s_appForOfficeManager.initialize(null,e),this.s_appForOfficeManager},e.getAppForOfficeManager=function(){return this.s_appForOfficeManager}}(),function(){function e(e,t,i,n){this.m_id=e,this.m_version=t,this.m_store=i,this.m_storeType=n}return Object.defineProperty(e.prototype,"Id",{get:function(){return this.m_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Version",{get:function(){return this.m_version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Store",{get:function(){return this.m_store},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"StoreType",{get:function(){return this.m_storeType},enumerable:!1,configurable:!0}),e}()),X=function(){function e(e,t,i,n,r,a){this.m_osfControlType=e,this.m_id=t,this.m_top=i,this.m_left=n,this.m_width=r,this.m_height=a}return Object.defineProperty(e.prototype,"OsfControlType",{get:function(){return this.m_osfControlType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this.m_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Top",{get:function(){return this.m_top},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Left",{get:function(){return this.m_left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Width",{get:function(){return this.m_width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Height",{get:function(){return this.m_height},enumerable:!1,configurable:!0}),e}(),Y=function(){function e(e,t,i,n){this.m_appForOfficeRef=e,this.m_instanceId=t,this.m_shape=i,this.m_settings=n}return Object.defineProperty(e.prototype,"AppForOfficeRef",{get:function(){return this.m_appForOfficeRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"InstanceId",{get:function(){return this.m_instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Shape",{get:function(){return this.m_shape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this.m_settings},enumerable:!1,configurable:!0}),e}(),K=function(){function e(){}return e.onCompleted=function(){this.s_fIsJsDownloadInitiated=!1,this.s_fIsDownloadCompleted=!0,l.a.sendTraceTag(508688331,d.a.msoulscat_Wac_PptSlideshow,c.a.Info,"AppForOfficeLoader: ".concat(this.s_osfRunTimeJSFileName," downloaded."))},e.onFailure=function(e){this.s_fIsJsDownloadInitiated=!1,this.s_fIsDownloadCompleted=!1,this.s_scriptElement&&document.body.removeChild(this.s_scriptElement),l.a.sendTraceTag(508688330,d.a.msoulscat_Wac_PptSlideshow,c.a.Error,"Failed to delay load ".concat(this.s_osfRunTimeJSFileName," error:").concat(e.message))},e.createScriptElement=function(e){var t=this;return new Promise((function(i,n){t.s_scriptElement=document.createElement("script"),t.s_scriptElement.addEventListener("error",n),t.s_scriptElement.addEventListener("load",i),null!=e&&-1===e.indexOf("null")?t.s_scriptElement.src=e:t.s_scriptElement.src=$.a.readStringOrDefault("osfRunTimeJSFileName",t.s_osfRunTimeJSFileName),$.a.readBooleanOrDefault("UseCrossOriginStaticScripts",!0)&&t.s_scriptElement.setAttribute("crossdomain","anonymous"),document.body.appendChild(t.s_scriptElement)}))},e.load=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:if(void 0!==window[this.s_OsfRunTimeFunctionName]||this.s_fIsDownloadCompleted)return this.onCompleted(),[2];if(this.s_fIsJsDownloadInitiated)return[2];this.s_fIsJsDownloadInitiated=!0,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.createScriptElement(e)];case 2:return i.sent(),this.onCompleted(),[3,4];case 3:return t=i.sent(),this.onFailure(t),[3,4];case 4:return[2]}}))}))},Object.defineProperty(e,"FIsDownloadInitiated",{get:function(){return this.s_fIsJsDownloadInitiated},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FIsDownloadCompleted",{get:function(){return this.s_fIsDownloadCompleted},enumerable:!1,configurable:!0}),e.createAppForOfficeByOsfExtensibleDataObject=function(e){if(null===e)return null;var t;switch(e.appReference.storeType){case 0:t="SPCatalog";break;case 2:t="OMEX";break;case 1:t="Filesystem";break;case 3:t="SPApp";break;case 4:t="Registry";break;case 6:t="UploadFileDevCatalog";break;case 7:t="excatalog";break;case 10:t="mosextra";break;default:return null}var i=new J(e.appReference.id,e.appReference.version,e.appReference.store,t),r=new X(n.InContent,e.appInstance.appShape.id,e.appInstance.appShape.pos.y,e.appInstance.appShape.pos.x,e.appInstance.appShape.extent.w,e.appInstance.appShape.extent.h);return new Y(i,e.appInstance.id,r,this.readAppForOfficeSettings(e.appInstance.appSettings))},e.readAppForOfficeSettings=function(e){var t={};return void 0!==e&&e.forEach((function(e){t[e.name]=e.value})),t},e.readAppForOfficeTheme=function(t){return null===t?new v:new v(e.readThemeColorScheme(t.clrSchm),e.readThemeFontScheme(t.ftSchm),e.readBackgroundColor(t.bgClr))},e.readThemeColorScheme=function(e){if(void 0!==e){var t=new y;return t.Accent1=new b(e.accent1),t.Accent2=new b(e.accent2),t.Accent3=new b(e.accent3),t.Accent4=new b(e.accent4),t.Accent5=new b(e.accent5),t.Accent6=new b(e.accent6),t.Background1=new b(e.dk1),t.Background2=new b(e.dk2),t.Text1=new b(e.lt1),t.Text2=new b(e.lt2),t.Hyperlink=new b(e.hlink),t.FollowedHyperlink=new b(e.folHlink),t}},e.readThemeFontScheme=function(e){if(void 0!==e){var t=new T;return t.HeaderEastAsian=e.hdEAFt,t.HeaderLatin=e.hdLtnFt,t.HeaderScript=e.hdSptFt,t.HeaderLocalized=e.hdLclFt,t.BodyEastAsian=e.bdEAFt,t.BodyLatin=e.bdLtnFt,t.BodyScript=e.bdSptFt,t.BodyLocalized=e.bdLclFt,t}},e.readBackgroundColor=function(e){if(void 0!==e)return new b(e.Item)},e.s_fIsJsDownloadInitiated=!1,e.s_fIsDownloadCompleted=!1,e.s_osfRunTimeJSFileName="osfruntimePPTWAC.js",e.s_OsfRunTimeFunctionName="OfficeExt",e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"f",(function(){return s})),i.d(t,"h",(function(){return o})),i.d(t,"g",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"b",(function(){return c})),i.d(t,"e",(function(){return h})),i.d(t,"i",(function(){return u})),i.d(t,"d",(function(){return m}));const n={TextureSizeMax:2048},r={},a={};async function s(e){return r[e]||(r[e]=async function(e){const t=await fetch(e),i=await t.blob(),n=URL.createObjectURL(i);return a[n]=e,n}(e)),r[e]}function o(e){let t="",i="";for(const n in a)n===e?(i=a[n],t=e):a[n]===e&&(t=n,i=e);t&&i?(URL.revokeObjectURL(a[t]),delete a[t],delete r[i]):async function(e){if(!r[e])throw new Error(`Resource ${e} not found`);await r[e],o(e)}(e).catch(e=>{console.error(e)})}function l(e,t){let i=decodeURIComponent(t)||"./testFiles/";return"/"===i.slice(-1)&&(i=i.slice(0,-1)),i="http://localhost:8081",`${i}/${e}`}function d(e){let t=1;for(;t<e;)t<<=1;return t}function c(e,t,i=window.devicePixelRatio||1){const n=1*i,r=1*i;return Math.max(e*n,t*r)}function h(e){return e?e/65536:0}function u(e){return 65536*e}function m(e){return e?e*Math.PI/180:0}},function(e,t,i){"use strict";function n(e,t,i){return o(e,1,t,i)}function r(e,t,i){return o(e,2,t,i)}function a(e,t,i){return o(e,3,t,i)}function s(e,t,i){return o(e,0,t,i)}function o(e,t,i,n){return{name:e,dataType:t,value:i,classification:n||4}}i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"d",(function(){return s}))},function(e,t,i){"use strict";i.d(t,"e",(function(){return q})),i.d(t,"a",(function(){return lt})),i.d(t,"g",(function(){return n})),i.d(t,"h",(function(){return r})),i.d(t,"c",(function(){return ie})),i.d(t,"d",(function(){return dt})),i.d(t,"b",(function(){return Ie})),i.d(t,"f",(function(){return g}));const n={Left:0,Top:1,Right:2,Bottom:3,TopLeft:4,TopRight:5,BottomLeft:6,BottomRight:7,HorizontalOut:0,HorizontalIn:1,VerticalOut:2,VerticalIn:3,Horizontal:0,Vertical:1,ZoomOut:0,ZoomIn:1,Anywhere:0,BlackFromLeft:1,BlackFromRight:3,GoIn:0,GoOut:1,InBounce:4,OutBounce:5},r={PPT_TRANSITION_CUT:0,PPT_TRANSITION_RANDOM:1,PPT_TRANSITION_FADE:23,PPT_TRANSITION_FADE_THROUGH_BLACK:6,PPT_TRANSITION_PUSH:20,PPT_TRANSITION_FLIP:43,PPT_TRANSITION_PRISM:44,PPT_TRANSITION_MORPH:60,PPT_TRANSITION_WIPE:10,PPT_TRANSITION_STRIPS:9,PPT_TRANSITION_SPLIT:13,PPT_TRANSITION_ZOOM:11,PPT_TRANSITION_DIAMOND:17,PPT_TRANSITION_PLUS:18,PPT_TRANSITION_CIRCLE:27,PPT_TRANSITION_RANDOMBAR:8,PPT_TRANSITION_COMB:21,PPT_TRANSITION_DISSOLVE:5,PPT_TRANSITION_COVER:4,PPT_TRANSITION_UNCOVER:7,PPT_TRANSITION_WHEEL:26,PPT_TRANSITION_WHEELREVERSE:47,PPT_TRANSITION_WEDGE:19,PPT_TRANSITION_RIPPLE:29,PPT_TRANSITION_BLINDS:2,PPT_TRANSITION_CHECKER:3,PPT_TRANSITION_VORTEX:28,PPT_TRANSITION_SWITCH:42,PPT_TRANSITION_FALLOVER:48,PPT_TRANSITION_DRAPE:49,PPT_TRANSITION_CURTAINS:50,PPT_TRANSITION_WIND:51,PPT_TRANSITION_PRESTIGE:52,PPT_TRANSITION_FRACTURE:53,PPT_TRANSITION_CRUSH:54,PPT_TRANSITION_PEELOFF:55,PPT_TRANSITION_PAGECURLSINGLE:56,PPT_TRANSITION_PAGECURLDOUBLE:57,PPT_TRANSITION_AIRPLANE:58,PPT_TRANSITION_ORIGAMI:59,PPT_TRANSITION_GLITTER:30,PPT_TRANSITION_GALLERY:38,PPT_TRANSITION_PAN:36,PPT_TRANSITION_CONVEYOR:37,PPT_TRANSITION_CROSSZOOM:39,PPT_TRANSITION_FLYTHROUGH:31,PPT_TRANSITION_FLYTHROUGH_CONTENT:32,PPT_TRANSITION_ZOOM_WITH_SPIN:22,PPT_TRANSITION_DOORS:33,PPT_TRANSITION_DOORS_CONTENT:34};var a,s,o;!function(e){e[e.ReflectionNone=0]="ReflectionNone",e[e.ReflectionSimple=1]="ReflectionSimple",e[e.ReflectionAngled=2]="ReflectionAngled",e[e.ReflectionShrink=3]="ReflectionShrink"}(a||(a={})),function(e){e[e.DrawPreviousSlide=0]="DrawPreviousSlide",e[e.DrawNextSlide=1]="DrawNextSlide",e[e.DrawNextSlideReflection=2]="DrawNextSlideReflection"}(s||(s={})),function(e){e[e.DoorNone=0]="DoorNone",e[e.DoorHorizontal=1]="DoorHorizontal",e[e.DoorVertical=2]="DoorVertical",e[e.DoorSlidingHorizontal=3]="DoorSlidingHorizontal",e[e.DoorSlidingVertical=4]="DoorSlidingVertical"}(o||(o={}));var l,d,c,h,u=i(9),m=i(3),f=i(7);function p(e){const t=(new Error).stack||"";u.a.sendTraceTag(592999624,m.a.msoulscat_Wac_PptSession,f.a.Error,`${e} ${t}`)}function g(e,t){switch(e){case r.PPT_TRANSITION_PRISM:return 4==(4&t);case r.PPT_TRANSITION_PAN:case r.PPT_TRANSITION_CONVEYOR:case r.PPT_TRANSITION_CROSSZOOM:case r.PPT_TRANSITION_FLYTHROUGH_CONTENT:case r.PPT_TRANSITION_DOORS_CONTENT:return!0}return!1}function _(e,t){return!!e&&e.toLowerCase().split(",").includes(t.toLowerCase())}function S(e,t,i){if(t===r.PPT_TRANSITION_FADE)return!1;switch(t){case r.PPT_TRANSITION_CUT:return _(e,"Cut");case r.PPT_TRANSITION_BLINDS:return _(e,"Blinds");case r.PPT_TRANSITION_FADE_THROUGH_BLACK:return _(e,"FadeThroughBlack");case r.PPT_TRANSITION_PUSH:return _(e,"Push");case r.PPT_TRANSITION_PRISM:switch(!0){case i<4:return _(e,"Cube");case i<8:return _(e,"Rotate");case i<12:return _(e,"Box");case i<16:return _(e,"Orbit")}break;case r.PPT_TRANSITION_WIPE:case r.PPT_TRANSITION_STRIPS:return _(e,"Wipe");case r.PPT_TRANSITION_SPLIT:return _(e,"Split");case r.PPT_TRANSITION_ZOOM:case r.PPT_TRANSITION_DIAMOND:case r.PPT_TRANSITION_PLUS:case r.PPT_TRANSITION_CIRCLE:return _(e,"Shape");case r.PPT_TRANSITION_RANDOMBAR:return _(e,"RandomBars");case r.PPT_TRANSITION_COMB:return _(e,"Comb");case r.PPT_TRANSITION_DISSOLVE:return _(e,"Dissolve");case r.PPT_TRANSITION_RANDOM:return _(e,"Random");case r.PPT_TRANSITION_COVER:return _(e,"Cover");case r.PPT_TRANSITION_UNCOVER:return _(e,"Uncover");case r.PPT_TRANSITION_WHEEL:case r.PPT_TRANSITION_WHEELREVERSE:case r.PPT_TRANSITION_WEDGE:return _(e,"Wheel");case r.PPT_TRANSITION_RIPPLE:return _(e,"Ripple");case r.PPT_TRANSITION_DRAPE:return _(e,"Drape");case r.PPT_TRANSITION_CURTAINS:return _(e,"Curtains");case r.PPT_TRANSITION_WIND:return _(e,"Wind");case r.PPT_TRANSITION_PRESTIGE:return _(e,"Prestige");case r.PPT_TRANSITION_FRACTURE:return _(e,"Fracture");case r.PPT_TRANSITION_CRUSH:return _(e,"Crush");case r.PPT_TRANSITION_PEELOFF:return _(e,"PeelOff");case r.PPT_TRANSITION_PAGECURLSINGLE:case r.PPT_TRANSITION_PAGECURLDOUBLE:return _(e,"PageCurl");case r.PPT_TRANSITION_AIRPLANE:return _(e,"Airplane");case r.PPT_TRANSITION_ORIGAMI:return _(e,"Origami");case r.PPT_TRANSITION_CHECKER:return _(e,"Checker");case r.PPT_TRANSITION_VORTEX:return _(e,"Vortex");case r.PPT_TRANSITION_SWITCH:return _(e,"Switch");case r.PPT_TRANSITION_FALLOVER:return _(e,"FallOver");case r.PPT_TRANSITION_FLIP:return _(e,"Flip");case r.PPT_TRANSITION_GLITTER:return _(e,"Glitter");case r.PPT_TRANSITION_CROSSZOOM:return _(e,"RevealModern");case r.PPT_TRANSITION_PAN:return _(e,"Pan");case r.PPT_TRANSITION_GALLERY:return _(e,"GalleryIcon");case r.PPT_TRANSITION_CONVEYOR:return _(e,"Conveyor");case r.PPT_TRANSITION_FLYTHROUGH_CONTENT:return _(e,"Flythrough");case r.PPT_TRANSITION_FLYTHROUGH:case r.PPT_TRANSITION_ZOOM_WITH_SPIN:return _(e,"Zoom");case r.PPT_TRANSITION_DOORS:return _(e,"Doors");case r.PPT_TRANSITION_DOORS_CONTENT:return _(e,"Window")}return!0}!function(e){e[e.Smooth=0]="Smooth",e[e.Square=1]="Square",e[e.Diamond=2]="Diamond",e[e.Hexagon=3]="Hexagon",e[e.Radial=4]="Radial",e[e.LinearExplosion=5]="LinearExplosion"}(l||(l={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e[e.SplitHorizontal=8]="SplitHorizontal",e[e.SplitVertical=9]="SplitVertical",e[e.CombHorizontal=10]="CombHorizontal",e[e.CombVertical=11]="CombVertical",e[e.Radial=12]="Radial",e[e.Random=13]="Random",e[e.MAX=14]="MAX"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Top=2]="Top",e[e.TopLeft=3]="TopLeft",e[e.TopRight=4]="TopRight",e[e.SplitHorizontal=5]="SplitHorizontal",e[e.SplitVertical=6]="SplitVertical",e[e.Diamond=7]="Diamond",e[e.Box=8]="Box",e[e.Circle=9]="Circle",e[e.Plus=10]="Plus",e[e.Clock1=11]="Clock1",e[e.Clock2=12]="Clock2",e[e.Clock3=13]="Clock3",e[e.Clock4=14]="Clock4",e[e.Clock8=15]="Clock8",e[e.CounterClock1=16]="CounterClock1",e[e.CounterClock4=17]="CounterClock4",e[e.Wedge=18]="Wedge",e[e.Random=19]="Random",e[e.FromCenter=20]="FromCenter"}(c||(c={})),function(e){e[e.RippleBottomRight=4]="RippleBottomRight",e[e.RippleBottomLeft=5]="RippleBottomLeft",e[e.RippleTopRight=6]="RippleTopRight",e[e.RippleTopLeft=7]="RippleTopLeft",e[e.RippleCenter=29]="RippleCenter"}(h||(h={}));class v{constructor(e,t){this.x=e,this.y=t}}class y{constructor(e,t,i){this.x=e,this.y=t,this.z=i}}class T{constructor(e,t=!1){this.meshType=e.meshType,this.hres=e.hres,this.vres=e.vres,this.delayFormula=e.delayFormula,this.directionFormula=e.directionFormula,this.aspectRatio=e.aspectRatio,this.invertDelay=e.invertDelay,this.forward=e.forward,this.isCenterBufferReq=!!e.isCenterBufferReq||t,this.rippleType=e.m_rippleType,this.randomCenters=e.randomCenters,this.jitter=e.jitter}}class b{static createPositionBufferList(e,t){const i=new Float32Array((e+1)*(t+1)*3);for(let n=0;n<t+1;n+=1)for(let r=0;r<e+1;r+=1){const a=3*(r+n*(e+1));i[a]=r/e,i[a+1]=n/t,i[a+2]=0}return i}static calculateSmoothRippleDistance(e,t,i){const n=e.length/2,r=new Float32Array(n);for(let a=0;a<n;a+=1){const n=2*a;r[a]=this.calculateSmoothRippleDistanceUtil(t,e[n],e[n+1],i)}return r}static calculateSmoothRippleDistanceUtil(e,t,i,n){let r,a=t,s=i;switch(e){case h.RippleTopLeft:s=1-s,r=new v(1,1);break;case h.RippleTopRight:a=1-a,s=1-s,r=new v(1,1);break;case h.RippleBottomLeft:r=new v(1,1);break;case h.RippleBottomRight:a=1-a,r=new v(1,1);break;case h.RippleCenter:default:a-=.5,s-=.5,r=new v(.5,.5)}return a*=n,.70710678/I(r.x,r.y)*I(a,s)*Math.PI}addPolygon(e,t,i,n,r,a,s,o,l,d,c,h){const u=this.meshInfo;if(!u)return void p("MeshInfo undefined");let m,f,g;for(let a=0;a<e.length;a+=1){const p=3*(o*e.length+a),_=(l+e[a].x)*s/c,S=(d+e[a].y)*s/h;t[p]=_,t[p+1]=S,t[p+2]=0;const v=2*(o*e.length+a);i[v]=_,i[v+1]=S,this.delayFormulaFunc&&(m||(m=x(l/c,d/h,u.aspectRatio,u.invertDelay,u.jitter,this.delayFormulaFunc)),n[p/3]=m),u.isCenterBufferReq&&(u.randomCenters?(f&&g||(f=this.calculateCenter(l/c,d/h,u.randomCenters).x,g=this.calculateCenter(l/c,d/h,u.randomCenters).y),r&&(r[p/3*2]=f,r[p/3*2+1]=g)):r&&(r[p/3*2]=this.calculateCenter(l/c,d/h,u.randomCenters).x,r[p/3*2+1]=this.calculateCenter(l/c,d/h,u.randomCenters).y))}for(let t=0;t<e.length-2;t+=1){const i=3*(o*(e.length-2)+t),n=o*e.length;a[i]=n,a[i+1]=n+t+1,a[i+2]=n+t+2}}createSquare(e){const t=e.hres,i=e.vres,n=[{x:-.5,y:.5},{x:.5,y:.5},{x:.5,y:-.5},{x:-.5,y:-.5}],r=new Float32Array(t*i*3*n.length),a=new Float32Array(t*i*2*n.length),s=new Uint16Array(t*i*3*(n.length-2)),o=new Float32Array(r.length/3),l=e.isCenterBufferReq?new Array(2*r.length/3):void 0;let d=0;for(let e=0;e<i;e+=1)for(let c=0;c<t;c+=1)this.addPolygon(n,r,a,o,l,s,1,d,c+.5,e+.5,t,i),d+=1;this.vertexPositions=r,this.vertexIndices=s,this.textureCoords=a,this.vertexDelays=o,this.center=l}createRadial(e){const t=4*(e.hres+1),i=new Array(t),n=new Float32Array(2*t*3),r=new Float32Array(2*t*2),a=new Uint16Array(3*t),s=new Float32Array(2*t);let o=0;for(let e=0;e<t/4;e+=1)i[o]=new v(e/(t/4),0),o+=1;for(let e=0;e<t/4;e+=1)i[o]=new v(1,e/(t/4)),o+=1;for(let e=t/4;e>0;e-=1)i[o]=new v(e/(t/4),1),o+=1;for(let e=t/4;e>0;e-=1)i[o]=new v(0,e/(t/4)),o+=1;let l=0,d=0,c=0;o=0;for(const t of i)c=x(t.x,t.y,e.aspectRatio,e.invertDelay,e.jitter,this.delayFormulaFunc),s[2*o]=c,s[2*o+1]=c,n[l]=t.x,n[l+1]=t.y,n[l+2]=0,n[l+3]=.5,n[l+4]=.5,n[l+5]=0,l+=6,r[d]=t.x,r[d+1]=t.y,r[d+2]=.5,r[d+3]=.5,d+=4,o+=1;for(l=0,o=0;o<t-1;o+=1)a[l]=2*o,a[l+1]=2*o+1,a[l+2]=2*o+2,l+=3;a[l]=2*o,a[l+1]=0,a[l+2]=1,l+=3,this.vertexPositions=n,this.textureCoords=r,this.vertexIndices=a,this.vertexDelays=s}createSmooth(e){this.vertexPositions=b.createPositionBufferList(e.hres,e.vres),this.vertexIndices=b.createIndexBuffer(e.hres,e.vres),this.textureCoords=b.createTextureCoordBuffer(e.hres,e.vres),this.vertexDelays=b.calculateDelays(this.textureCoords,e.aspectRatio,e.invertDelay,e.jitter,this.delayFormulaFunc),e.rippleType&&(this.rippleDistanceData=b.calculateSmoothRippleDistance(this.textureCoords,e.rippleType,e.aspectRatio))}createDiamond(e){const t=[{x:-.5,y:0},{x:0,y:.5},{x:.5,y:0},{x:0,y:-.5}],i=e.hres,n=e.vres,r=(i+1)*(n+1)*2,a=new Float32Array(3*r*t.length),s=new Float32Array(2*r*t.length),o=new Uint16Array(3*r*(t.length-2)),l=new Float32Array(a.length/3),d=e.isCenterBufferReq?new Array(2*a.length/3):void 0;let c=0;for(let e=0;e<n+1;e+=1)for(let r=0;r<i+1;r+=1)this.addPolygon(t,a,s,l,d,o,1,c,r,e,i,n),c+=1,this.addPolygon(t,a,s,l,d,o,1,c,r+.5,e+.5,i,n),c+=1;this.vertexPositions=a,this.vertexIndices=o,this.textureCoords=s,this.vertexDelays=l,this.center=d}createHexagon(e){const t=[{x:-.5,y:.5/3},{x:0,y:1/3},{x:.5,y:.5/3},{x:.5,y:-.5/3},{x:0,y:-1/3},{x:-.5,y:-.5/3}],i=e.hres,n=e.vres,r=i*n*2+i+n+1,a=new Float32Array(3*r*t.length),s=new Float32Array(2*r*t.length),o=new Uint16Array(3*r*(t.length-2)),l=new Float32Array(a.length/3),d=e.isCenterBufferReq?new Array(2*a.length/3):void 0;let c=0;for(let e=0;e<n;e+=1)for(let r=0;r<i;r+=1)this.addPolygon(t,a,s,l,d,o,1,c,r,e,i,n),c+=1,this.addPolygon(t,a,s,l,d,o,1,c,r+.5,e+.5,i,n),c+=1;for(let e=0;e<n;e+=1)this.addPolygon(t,a,s,l,d,o,1,c,i,e,i,n),c+=1;for(let e=0;e<i+1;e+=1)this.addPolygon(t,a,s,l,d,o,1,c,e,n,i,n),c+=1;this.vertexPositions=a,this.vertexIndices=o,this.textureCoords=s,this.vertexDelays=l,this.center=d}initialize(e){switch(this.meshInfo=e,this.delayFormulaFunc=(i=e.delayFormula)in C?C[i]:C[c.None],this.directionFormulaFunc=(t=e.directionFormula)in k?k[t]:k[d.Random],e.meshType){case l.Smooth:this.createSmooth(e);break;case l.Square:this.createSquare(e);break;case l.Diamond:this.createDiamond(e);break;case l.Hexagon:this.createHexagon(e);break;case l.Radial:this.createRadial(e);break;case l.LinearExplosion:throw new Error("MeshType.LinearExplosion is not implemented yet.");default:throw new Error("Could not get meshType.")}var t,i}getRippleDistance(){return this.rippleDistanceData}getVertexPositions(){return this.vertexPositions}getVertexIndices(){return this.vertexIndices}getTextureCoords(){return this.textureCoords}getDelays(){return this.vertexDelays}getCenter(){return this.center}calculateCenter(e,t,i){let n=e,r=t;if(i){const e=1.5,t=-.5;n=Math.random()*(e-t)+t,r=Math.random()*(e-t)+t}return new v(n,r)}getDirections(e){const t=e.hres,i=e.vres,n=this.getTextureCoords().length,r=new Float32Array(n);let a=0;for(let e=0;e<i;e+=1)for(let n=0;n<t;n+=1){const c=(s=(n+.5)/t,o=(e+.5)/i,l=Math.floor(n+.5),d=Math.floor(e+.5),(0,this.directionFormulaFunc)(s,o,l,d));for(let e=0;e<4;e+=1)r[a]=c.x,r[a+1]=c.y,a+=2}var s,o,l,d;return r}constructor(){this.vertexPositions=new Float32Array,this.vertexIndices=new Uint16Array,this.textureCoords=new Float32Array,this.vertexDelays=new Float32Array,this.rippleDistanceData=new Float32Array,this.center=new Float32Array,this.directionFormulaFunc=k[d.Random],this.delayFormulaFunc=C[c.None]}}b.createTextureCoordBuffer=function(e,t){const i=new Float32Array((e+1)*(t+1)*2);for(let n=0;n<t+1;n+=1)for(let r=0;r<e+1;r+=1){const a=2*(r+n*(e+1));i[a]=r/e,i[a+1]=n/t}return i},b.calculateDelays=function(e,t,i,n,r){const a=e.length/2,s=new Float32Array(a);for(let o=0;o<a;o+=1){const a=2*o;s[o]=x(e[a],e[a+1],t,i,n,r)}return s},b.createIndexBuffer=function(e,t){const i=new Uint16Array(e*t*6);for(let n=0;n<t;n+=1)for(let t=0;t<e;t+=1){const r=6*(t+n*e),a=t+n*(e+1);i[r]=a,i[r+1]=a+1,i[r+2]=a+1+(e+1),i[r+3]=a,i[r+4]=a+1+(e+1),i[r+5]=a+(e+1)}return i},b.CreateSquareTextureCoordBuffer=function(e,t){const i=new Float32Array(e*t*2);for(let n=0;n<t;n+=1)for(let r=0;r<e;r+=1){const a=r+n*e*2;i[a]=r/e,i[a+1]=n/t}return i};const w={},C={[c.None]:(e,t,i)=>0,[c.Left]:(e,t,i)=>e,[c.Top]:(e,t,i)=>1-t,[c.TopLeft]:(e,t,i)=>2*Math.abs(e-.5),[c.TopRight]:(e,t,i)=>(1-e+1-t)/2,[c.SplitHorizontal]:(e,t,i)=>2*Math.abs(e-.5),[c.SplitVertical]:(e,t,i)=>2*Math.abs(t-.5),[c.Diamond]:(e,t,i)=>Math.abs(e-.5)+Math.abs(t-.5),[c.Box]:(e,t,i)=>e>t?t<1-e?1-t:e:t<1-e?1-e:t,[c.Circle]:(e,t,i)=>{const n=(e-.5)*i,r=t-.5;return w.Distance(n,r)*(1/Math.sqrt(.25+i*i/4))},[c.Plus]:(e,t,i)=>{const n=Math.abs(e-.5),r=Math.abs(t-.5);return 2*(n<r?n:r)},[c.Clock1]:(e,t,i)=>E(e,t)%1,[c.Clock2]:(e,t,i)=>2*E(e,t)%1,[c.Clock3]:(e,t,i)=>3*E(e,t)%1,[c.Clock4]:(e,t,i)=>4*E(e,t)%1,[c.Clock8]:(e,t,i)=>8*E(e,t)%1,[c.CounterClock1]:(e,t,i)=>P(e,t),[c.CounterClock4]:(e,t,i)=>4*P(e,t)%1,[c.Wedge]:(e,t,i)=>{return n=e,r=t,(Math.atan2(-1*Math.abs(n-.5),.5-r)+Math.PI)/Math.PI;var n,r},[c.Random]:(e,t,i)=>Math.random(),[c.FromCenter]:(e,t,i)=>1.41421*w.Distance(e-.5,t-.5)};function I(e,t){return Math.sqrt(e*e+t*t)}function P(e,t){return(Math.atan2(e-.4999,.5-t)+Math.PI)/(2*Math.PI)}function E(e,t){return(Math.atan2(.5-e,.5-t)+Math.PI)/(2*Math.PI)}function x(e,t,i,n,r,a){let s=a(e,t,i);return n&&(s=1-s),s+=Math.random()*r/100,s}w.Distance=function(e,t){return I(e,t)};const k={[d.CombHorizontal]:(e,t,i,n)=>new v(1&n?-1:1,0),[d.CombVertical]:(e,t,i,n)=>new v(0,1&i?-1:1),[d.Random]:(e,t,i,n)=>{const r=M(-1,1),a=M(-1,1);return new v(r,a)}};function M(e,t){return Math.random()*(e-t)+t}var A=i(80);i(128),i(40);var R;!function(e){e[e.alpha=0]="alpha",e[e.weave=1]="weave",e[e.model=2]="model",e[e.prism=3]="prism",e[e.ripple=4]="ripple",e[e.vortex=5]="vortex",e[e.custom=6]="custom",e[e.flyThrough=7]="flyThrough",e[e.zoomWithSpin=8]="zoomWithSpin",e[e.gallery=9]="gallery",e[e.count=10]="count"}(R||(R={}));const O=[{code:{v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute float aDelay;varying vec4 c;varying vec2 d;void main(void){float PI=3.14159265358979323846264;float f=clamp(uFactor*(uProgress-aDelay),0.0,1.0);f=1.0-0.5*(1.0+cos(f*PI));gl_Position=uModelViewProj*vec4(aPosition,0.0,1.0);d=aTexcoord;c=vec4(f);}",f:"precision mediump float;uniform float uStyle;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;uniform sampler2D uSampler2;float e(float x,float y){return 1.0-abs(sign(x-y));}void main(void){gl_FragColor=e(uStyle,1.0)*mix(texture2D(uSampler1,d),texture2D(uSampler2,d),c.a)+e(uStyle,2.0)*(texture2D(uSampler1,d)*c.a);}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aDelay"],u:["uModelViewProj","uProgress","uFactor","uStyle"],s:["uSampler1","uSampler2"]},{code:{v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;uniform float uOpacity;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute vec2 aDirection;attribute float aDelay;varying vec4 c;varying vec2 d;void main(void){vec4 e;float f=uProgress-aDelay;if(f < 0.0){f=0.0;}else{f*=uFactor;f*=f/2.0;}e.xy=aPosition.xy+f*aDirection;e.z=0.0;e.w=1.0;gl_Position=uModelViewProj*e;d=aTexcoord;c=vec4(uOpacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aDelay","aDirection"],u:["uModelViewProj","uProgress","uFactor","uOpacity"],s:["uSampler1"]},{code:{v:"uniform mat4 uModelViewProj;attribute vec2 aPosition;attribute vec2 aTexcoord;varying vec2 c;void main(void){gl_Position=uModelViewProj*vec4(aPosition,0.0,1.0);c=aTexcoord;}",f:"precision mediump float;varying vec2 c;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,c);}",a:[],u:[],s:[]},a:["aPosition","aTexcoord"],u:["uModelViewProj"],s:["uSampler1"]},{code:{v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;uniform float uZmovement;uniform float uDirection;uniform float uAnglePlus;uniform float uMaxAngle;uniform float uZCenter;uniform float uXAxis;attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;varying vec4 e;varying vec4 c;varying vec2 d;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}void main(){float PI=3.14159265358979323846264;float l=clamp(uFactor*(uProgress-aDelay),0.0,uMaxAngle);l=(1.0-cos(l*PI/uMaxAngle))/2.0*uMaxAngle;float m=(sin((PI-uMaxAngle)/2.0+l)-sin((PI-uMaxAngle)/2.0))*uZmovement;l+=uAnglePlus;float n=sin(l*uDirection);float o=cos(l*uDirection);vec3 p=vec3(aCenter.x,aCenter.y,uZCenter);vec4 q;q.xyz=aPosition.xyz-p;q.xyz=(uXAxis > 0.0)? f(n,o,q.xyz): k(n,o,q.xyz);q.xyz+=vec3(0,0,m)+p;q.w=1.0;gl_Position=uModelViewProj*q;d=aTexcoord;float s=max(0.0,o);c.rgb=vec3(clamp(s+0.3,0.0,1.0));c.a=1.0;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aDelay","aCenter"],u:["uModelViewProj","uProgress","uFactor","uZmovement","uDirection","uAnglePlus","uMaxAngle","uZCenter","uXAxis"],s:["uSampler1"]},{code:{v:"uniform mat4 uModelViewProj;uniform vec2 uProgress;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute float aDistance;varying vec4 c;varying vec2 d;void main(void){float PI=3.14159265358979323846264;float e=6.0;float f=0.025;float h=0.3;float i=0.7;float j=(1.0-uProgress.y);float k=(aDistance-uProgress.x)*e+PI/2.0;vec4 l=vec4(aPosition,0.0,1.0);l.z=j*sin(k)*f;if(aDistance > uProgress.x){l.z=0.0;}l=uModelViewProj*l;float m=j*cos(k)*h;if(aDistance > uProgress.x)m=0.0;float n=max(0.0,m);gl_Position=l;d=aTexcoord;float o=clamp((uProgress.x-aDistance)/i,0.0,1.0);float rgb=1.0-n;c=vec4(rgb,rgb,rgb,o);}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=mix(texture2D(uSampler1,d),texture2D(uSampler2,d),c.a);gl_FragColor.rgb*=c.rgb;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aDistance"],u:["uModelViewProj","uProgress"],s:["uSampler1","uSampler2"]},{code:{v:"uniform mat4 uModelViewProj;uniform float uFactor;uniform float uZmovement;uniform float uDirection;uniform float uAngle;uniform float uXAxis;uniform float uBack;attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;varying vec4 e;varying vec4 c;varying vec2 d;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}void main(){float PI=3.14159265358979323846264;float l=clamp(uFactor*(uAngle-aDelay),0.0,PI);l+=uBack;float m=sin(l*uDirection);float n=cos(l*uDirection);vec4 o;o.xy=aPosition.xy-aCenter;o.z=0.0;o.xyz=(uXAxis > 0.0)? f(m,n,o.xyz): k(m,n,o.xyz);o.xyz+=vec3(0,0,m*uZmovement)+vec3(aCenter.x,aCenter.y,0.0);o.w=1.0;gl_Position=uModelViewProj*o;d=aTexcoord;float p=max(0.0,n);c.rgb=vec3(clamp(p+0.3,0.0,1.0));c.a=1.0;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aDelay","aCenter"],u:["uModelViewProj","uFactor","uZmovement","uDirection","uAngle","uXAxis","uBack"],s:["uSampler1"]},{code:{v:"attribute vec3 aPosition;attribute vec3 aNormal;attribute vec2 aTexCoord;uniform mat4 uModelToView;uniform mat4 uModelToWorld;uniform mat4 uModelToWorldIT;uniform vec3 uLightPosition;uniform vec3 uEyePosition;uniform vec3 uAmbientColor;uniform vec4 uDiffuseColor;uniform bool uIsNormalDirectionChangeReq;varying vec4 c;varying vec2 d;void main(void){gl_Position=uModelToView*vec4(aPosition,1.0);d=aTexCoord;vec3 e=(uModelToWorld*vec4(aPosition,1.0)).xyz;vec3 f=normalize(uLightPosition-e);vec3 h=(uIsNormalDirectionChangeReq && aNormal.z < 0.0)? aNormal*vec3(-1,-1,-1): aNormal;vec3 i=normalize(uModelToWorldIT*vec4(h,0.0)).xyz;float j=max(0.0,dot(i,f));c.rgb=j*uDiffuseColor.rgb+uAmbientColor;c.a=uDiffuseColor.a;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler;void main(void){gl_FragColor=texture2D(uSampler,vec2(1.0,1.0)-d)*c;}",a:[],u:[],s:[]},a:["aPosition","aNormal","aTexCoord"],u:["uModelToView","uModelToWorld","uModelToWorldIT","uLightPosition","uAmbientColor","uDiffuseColor","uIsNormalDirectionChangeReq"],s:["uSampler"]},{code:{v:"attribute vec2 aPosition;attribute vec3 aCenter;attribute vec2 aTexcoord;uniform mat4 uModelViewProj;uniform mat4 offsetMatrix;uniform float uProgress;uniform float opacity;uniform float style;uniform bool isX;varying vec4 c;varying vec2 d;varying vec2 e;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}vec3 f(float h,float i,vec2 j){return vec3(j.x,i*j.y,h*j.y);}vec3 k(float h,float i,vec2 j){return vec3(i*j.x,j.y,-h*j.x);}void main(void){highp vec4 l=vec4(aPosition,0.0,1.0);if(style==1.0){mediump float m=uProgress;mediump float n,o;l.xyz=l.xyz-aCenter;l.w=1.0;if(! isX){if(aCenter.x < 0.5)m=-m;n=sin(m);o=cos(m);l.xyz=k(n,o,l.xy)+aCenter;l.z=l.z-uProgress/6.0;l.x=l.x+m/2.0;}else{if(aCenter.y > 0.5)m=-m;n=sin(m);o=cos(m);l.xyz=f(n,o,l.xy)+aCenter;l.z=l.z-uProgress/4.0;l.y=l.y-m/1.5;}}else if(style==2.0){mediump float p=uProgress;if(aCenter.z < 0.0)p=-p;l.z+=p;}l=l*offsetMatrix;gl_Position=uModelViewProj*l;d=aTexcoord;e=vec2(aTexcoord.y);c=vec4(opacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;varying vec2 e;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=texture2D(uSampler1,d)*c*texture2D(uSampler2,e).a;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aCenter"],u:["uModelViewProj","offsetMatrix","uProgress","opacity","style","isX"],s:["uSampler1","uSampler2"]},{code:{v:"attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;uniform mat4 uModelViewProj;uniform float uTime;uniform float uSpinFactor;uniform float uFactor;uniform float uReverseAngle;uniform float uGrowFactor;uniform float uOpacitySpeed;varying vec4 c;varying vec2 d;vec3 e(float f,float h,vec3 i){return vec3(h*i.x-f*i.y*9.0/16.0,f*i.x*16.0/9.0+h*i.y,i.z);}void main(){float j=clamp(uTime-aDelay,0.0,1.0);mediump float k=uSpinFactor*j*uFactor*uReverseAngle;float l,m;l=sin(k);m=cos(k);highp vec4 n;n.xy=aPosition.xy-aCenter;n.xy*=1.0+j*uGrowFactor;n.z=0.0;n.y=n.y;n.xyz=e(l,m,n.xyz)+vec3(aCenter,0.0);n.w=1.0;gl_Position=uModelViewProj*n;d=aTexcoord;if(uOpacitySpeed==0.0)c=vec4(1.0);else c=vec4(1.0-pow(j,uOpacitySpeed));}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler;void main(void){gl_FragColor=texture2D(uSampler,d)*c;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord","aCenter","aDelay"],u:["uModelViewProj","uTime","uSpinFactor","uFactor","uReverseAngle","uGrowFactor","uOpacitySpeed"],s:["uSampler"]},{code:{v:"attribute vec2 aPosition;attribute vec2 aTexcoord;uniform mat4 uModelViewProj;uniform mat4 offsetMatrix;uniform mat4 dirMatrix;uniform float opacity;uniform bool isInvX;varying vec4 c;varying vec2 d;varying vec2 e;void main(void){highp vec4 f=vec4(aPosition,0.0,1.0);f=f*dirMatrix;f.y=f.y-0.5;f=f*offsetMatrix;gl_Position=uModelViewProj*f;d=vec2(isInvX ? 1.0-aTexcoord.x : aTexcoord.x,aTexcoord.y);e=vec2(aTexcoord.y);c=vec4(opacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;varying vec2 e;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=texture2D(uSampler1,d)*c*texture2D(uSampler2,e).a;}",a:[],u:[],s:[]},a:["aPosition","aTexcoord"],u:["uModelViewProj","offsetMatrix","dirMatrix","opacity","isInvX"],s:["uSampler1","uSampler2"]}];let F=0;const D=[];function L(e){return void 0===e.transitionId&&(F+=1,e.transitionId=F),D[F]}function B(e,t){const i=L(e);if(!i)return void p("Can not activate shader, ShaderProgram has not been initialiazed (please await initialization).");const n=i[t];if(n){if(n.isReady())return e.enableEffect(n),n;p("Can not activate shader, program is not ready yet (please await initialization).")}else p("Can not activate shader, program has not been found.")}i(196);var N=i(48),V=i(55),W=i(182),U=i(103);const z=new W.a(0,0,1,1),H={r:0,g:0,b:0,a:1},G={InternalTexture:void 0,VertexBuffer:void 0};class j{createIndexBuffer(e){const t=this.engine.createIndexBuffer(e);return this.indexBuffers.push(t),this.memoryReport.buffers.count+=1,t}createVertexBuffers(e){const t={};if(!G.VertexBuffer)throw new Error("VertexBuffer is not defined");for(const i of e){const e=new G.VertexBuffer(this.engine,i.data,i.name,!0,!1,i.itemSize);t[i.name]=e,this.vertexBuffers.push(e),this.memoryReport.buffers.count+=1}return t}recordVertexArrayObject(e,t,i){const n=this.engine.recordVertexArrayObject(e,t,i);return this.vaos.push(n),this.memoryReport.vaos.count+=1,n}createMonochromeTexture(e,t,i,n){const r=new Uint8Array([e,t,i,n]);return this.createTexture(r,1,1)}createTexture(e,t,i){if(!G.InternalTexture)throw new Error("InternalTexture is not defined");const n=new G.InternalTexture(this.engine,V.b.Unknown);return n.baseWidth=t,n.baseHeight=i,n.width=t,n.height=i,n.format=5,n.generateMipMaps=!1,n.samplingMode=2,n.invertY=!0,n.type=0,this.engine._bindTextureDirectly(3553,n,!0),this.engine._uploadDataToTextureDirectly(n,e,0,0,void 0,!0),this.engine.updateTextureSamplingMode(n.samplingMode,n,!1),this.engine.updateTextureWrappingMode(n,33071,33071),n.isReady=!0,this.textures.push(n),this.memoryReport.textures.count+=1,n}dispose(){for(const e of this.indexBuffers)this.engine._releaseBuffer(e),this.memoryReport.buffers.count-=1;for(const e of this.vertexBuffers)e.dispose(),this.memoryReport.buffers.count-=1;for(const e of this.vaos)this.engine.releaseVertexArrayObject(e),this.memoryReport.vaos.count-=1;for(const e of this.textures)e.dispose(),this.memoryReport.textures.count-=1;this.indexBuffers.length=0,this.vertexBuffers.length=0,this.vaos.length=0}constructor(e,t){this.engine=e,this.memoryReport=t,this.indexBuffers=[],this.vertexBuffers=[],this.textures=[],this.vaos=[]}}var $=i(171);async function q(e){if(G.VertexBuffer=$.b,G.InternalTexture=V.a,void 0===N.a.prototype.clearToBlack&&(N.a.prototype.isContextLost=function(){return this._gl.isContextLost()},N.a.prototype.clearToBlack=function(){this.clear(H,!0,!0)},N.a.prototype.resetViewport=function(){const e=this._gl.canvas.width,t=this._gl.canvas.height;this.setSize(e,t),this.setViewport(z)},N.a.prototype.wrapExternalTexture=function(e){const t=new V.a(this,0,!0);return t._hardwareTexture=new U.a(e,this._gl),t.type=0,t},N.a.prototype.setTranstionBlend=function(e){e?(this.alphaState.alphaBlend=!0,this.alphaState.setAlphaBlendFunctionParameters(1,771,1,771),this.alphaState.setAlphaEquationParameters(32774,32774)):this.alphaState.alphaBlend=!1}),!e)throw p("Engine should be defined.");L(e)||await async function(e){const t=[];L(e)||(D[e.transitionId]=new Array(R.count));for(let i=0;i<R.count;i++)t.push(Z(e,i));return Promise.all(t)}(e)}async function Z(e,t){const i=L(e);if(!i)throw p("Shader Programs should be defined.");return i[t]||(i[t]=function(e,t){const i=O[t];return new A.a({vertexSource:i.code.v,fragmentSource:i.code.f},i.a,i.u,i.s,e,void 0,void 0,void 0,(e,i)=>{!function(e,t,i){if(!i)return;const n=`Program ${e} `,r=t.getPipelineContext();r.vertexCompilationError&&p(`${n} V compile failed: ${r.vertexCompilationError}`),r.fragmentCompilationError&&p(`${n} F compile failed: ${r.fragmentCompilationError}`),r.programLinkError&&p(`${n} link failed: ${r.programLinkError}`),r.programValidationError&&p(`${n} validation failed: ${r.programValidationError}`),p(`${n} preparation failed: ${i}`)}(t,e,i)},void 0,function(e){return"transitions-"+e}(t))}(e,t)),new Promise((e,n)=>{var r,a,s;null!==(r=i[t])&&void 0!==r&&r.isReady()?e():(null===(a=i[t])||void 0===a||a.onCompileObservable.add(()=>e()),null===(s=i[t])||void 0===s||s.onErrorObservable.add(n))})}var J,X=i(10);function Y(e,t,i,n,r,a,s,o,l,d,c,h,u,m,f,p){const g=new Float32Array(16);return g[0]=e,g[1]=t,g[2]=i,g[3]=n,g[4]=r,g[5]=a,g[6]=s,g[7]=o,g[8]=l,g[9]=d,g[10]=c,g[11]=h,g[12]=u,g[13]=m,g[14]=f,g[15]=p,g}function K(){return Y(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}function Q(e,t){const i=K();for(let n=0;n<4;n+=1)i[4*n+0]=e[4*n+0]*t[0]+e[4*n+1]*t[4]+e[4*n+2]*t[8]+e[4*n+3]*t[12],i[4*n+1]=e[4*n+0]*t[1]+e[4*n+1]*t[5]+e[4*n+2]*t[9]+e[4*n+3]*t[13],i[4*n+2]=e[4*n+0]*t[2]+e[4*n+1]*t[6]+e[4*n+2]*t[10]+e[4*n+3]*t[14],i[4*n+3]=e[4*n+0]*t[3]+e[4*n+1]*t[7]+e[4*n+2]*t[11]+e[4*n+3]*t[15];return i}!function(e){e[e.MotionQuadratic=0]="MotionQuadratic",e[e.MotionLinear=1]="MotionLinear",e[e.MotionQuadraticHard=2]="MotionQuadraticHard",e[e.MotionQuadraticBounce=3]="MotionQuadraticBounce",e[e.MotionCubicHard=4]="MotionCubicHard"}(J||(J={}));class ee{static getScaledProgress(e,t,i=0,n=0){switch(e){case J.MotionLinear:return t;case J.MotionQuadratic:{const e=4;return ee.getPositionFromTime(t,e,0,.5,1,!0)}case J.MotionQuadraticHard:return t*t;case J.MotionQuadraticBounce:{const e=2;if(t>1-i){const r=(t-(1-i))/i;return 1+ee.getBounce(r,e,i,n)}const r=t/(1-i);return ee.getLocation(e,0,0,r)}case J.MotionCubicHard:return t*t*t;default:return 0}}static getLocation(e,t,i,n){return.5*e*n*n+t*n+i}static getPositionFromTime(e,t,i,n,r,a){let s=0;if(e>i){const o=a?-t:0,l=n-i;s=e<=n?this.getLocation(t,0,0,e-i):e<r?this.getLocation(o,t*l,this.getLocation(t,0,0,l),e-n):this.getLocation(o,t*l,this.getLocation(t,0,0,l),r-n)}return s}static getVelocityFromTime(e,t,i,n,r,a){let s=0;const o=a?-t:0,l=n-i;return s=e<=n?t*(e-i):e<r?o*(e-n)+t*l:o*(r-n)+t*l,s}static getBounce(e,t,i,n){const r=2*e*Math.PI;return 1/n*(1-e)*i*Math.sin(r)*t}static doSwivel(e,t,i){let n=e,r=t;const a=i.m_swivelTime/100,s=i.m_waitTime/100,o=-i.m_swivelAngle*Math.PI/180;let l,d;return n<a+s?(n>a&&(n=a),l=1-(a-n)/a,d=0):n<1-a?(l=1,d=(n-a)/(1-2*a)):(l=(1-n)/a,d=1),r=Q(r,function(e,t,i){const n=K();return n[12]=0,n[13]=0,n[14]=i,n}(0,0,l*(i.m_swivelZoom/100))),r=Q(r,function(e){const t=Math.cos(e),i=Math.sin(e);return Y(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1)}(l*o)),{scaledProgress:d,offset:r,swivelPercent:l}}}class te{async getTransitionProperty(e,t,i){let a,s=null;switch(e){case r.PPT_TRANSITION_COMB:s=this.createCombProperty(i);break;case r.PPT_TRANSITION_PUSH:s=this.createPushProperty(i);break;case r.PPT_TRANSITION_PAN:s=this.createPanProperty(i);break;case r.PPT_TRANSITION_STRIPS:case r.PPT_TRANSITION_WIPE:s=this.createWipeProperty(i);break;case r.PPT_TRANSITION_SPLIT:s=this.createSplitProperty(i);break;case r.PPT_TRANSITION_ZOOM:s=this.createZoomProperty(i);break;case r.PPT_TRANSITION_DIAMOND:case r.PPT_TRANSITION_PLUS:case r.PPT_TRANSITION_CIRCLE:s=this.createShapeProperty(i,e);break;case r.PPT_TRANSITION_RANDOMBAR:s=this.createRandombarProperty(i);break;case r.PPT_TRANSITION_FADE:case r.PPT_TRANSITION_FADE_THROUGH_BLACK:s=this.createFadeSmoothlyProperty(i);break;case r.PPT_TRANSITION_CUT:t===n.Top&&(s=this.createCutThroughBlackProperty(i));break;case r.PPT_TRANSITION_DISSOLVE:s=new he(i);break;case r.PPT_TRANSITION_COVER:s=this.createCoverProperty(i);break;case r.PPT_TRANSITION_UNCOVER:s=this.createUncoverProperty(i);break;case r.PPT_TRANSITION_WHEEL:case r.PPT_TRANSITION_WHEELREVERSE:s=this.createWheelTransitionProperty(i,e===r.PPT_TRANSITION_WHEEL);break;case r.PPT_TRANSITION_WEDGE:s=this.createWedgeTransitionProperty(i);break;case r.PPT_TRANSITION_PRISM:s=this.createPrismProperty(i);break;case r.PPT_TRANSITION_BLINDS:s=new me(i);break;case r.PPT_TRANSITION_RIPPLE:s=new pe(i);break;case r.PPT_TRANSITION_VORTEX:s=new ye(i);break;case r.PPT_TRANSITION_CHECKER:s=new Se(i);break;case r.PPT_TRANSITION_FLIP:case r.PPT_TRANSITION_SWITCH:case r.PPT_TRANSITION_FALLOVER:case r.PPT_TRANSITION_DRAPE:case r.PPT_TRANSITION_CURTAINS:case r.PPT_TRANSITION_WIND:case r.PPT_TRANSITION_PRESTIGE:case r.PPT_TRANSITION_FRACTURE:case r.PPT_TRANSITION_CRUSH:case r.PPT_TRANSITION_PEELOFF:case r.PPT_TRANSITION_PAGECURLSINGLE:case r.PPT_TRANSITION_PAGECURLDOUBLE:case r.PPT_TRANSITION_AIRPLANE:case r.PPT_TRANSITION_ORIGAMI:a=await this.m_customTransitionDataLoader.load(e),s=this.createCustomProperty(e,i,a);break;case r.PPT_TRANSITION_GLITTER:s=new ve(i);break;case r.PPT_TRANSITION_GALLERY:s=new ge(i);break;case r.PPT_TRANSITION_CONVEYOR:s=new _e(i);break;case r.PPT_TRANSITION_CROSSZOOM:s=new be(i);break;case r.PPT_TRANSITION_FLYTHROUGH:s=new ae(i);break;case r.PPT_TRANSITION_FLYTHROUGH_CONTENT:s=new re(i);break;case r.PPT_TRANSITION_ZOOM_WITH_SPIN:s=new fe(i);break;case r.PPT_TRANSITION_DOORS_CONTENT:s=new se(i,!0);break;case r.PPT_TRANSITION_DOORS:s=new se(i,!1);break;default:s=this.createFadeSmoothlyProperty(i)}return s}isInvalidCustomProperty(e,t){if(!(t&&t.IndexBuffer&&t.PositionBufferList&&t.TextureCoordBuffer))return!0;switch(e){case r.PPT_TRANSITION_FLIP:case r.PPT_TRANSITION_SWITCH:case r.PPT_TRANSITION_PAGECURLDOUBLE:if(!t.IndexBufferBack||!t.PositionBufferListBack||!t.TextureCoordBufferBack)return!0}return!1}createCustomProperty(e,t,i){let n=null;if(this.isInvalidCustomProperty(e,i))return null;switch(e){case r.PPT_TRANSITION_FALLOVER:n=new we(t,i,e),n.ambient=.5;break;case r.PPT_TRANSITION_DRAPE:n=new we(t,i,e),n.ambient=.4;break;case r.PPT_TRANSITION_CURTAINS:n=new we(t,i,e),n.ambient=.8;break;case r.PPT_TRANSITION_WIND:n=new we(t,i,e),n.ambient=.9;break;case r.PPT_TRANSITION_PRESTIGE:n=new we(t,i,e),n.ambient=.8;break;case r.PPT_TRANSITION_FRACTURE:n=new we(t,i,e),n.ambient=.7;break;case r.PPT_TRANSITION_CRUSH:n=new we(t,i,e),n.ambient=.9;break;case r.PPT_TRANSITION_PEELOFF:n=new we(t,i,e),n.ambient=.65;break;case r.PPT_TRANSITION_PAGECURLSINGLE:n=new we(t,i,e),n.ambient=.8;break;case r.PPT_TRANSITION_AIRPLANE:n=new we(t,i,e),n.ambient=.6;break;case r.PPT_TRANSITION_ORIGAMI:n=new we(t,i,e),n.ambient=.8;break;case r.PPT_TRANSITION_PAGECURLDOUBLE:n=new Ce(t,i,e),n.ambient=.9;break;case r.PPT_TRANSITION_FLIP:case r.PPT_TRANSITION_SWITCH:n=new Ce(t,i,e),n.ambient=.8}return n}createPushProperty(e){const t=new de(e);return!t.forward&&t.direction>=n.Left&&t.direction<=n.Bottom&&(t.direction=(t.direction+2)%4),t.hres=1,t.vres=1,t}createPanProperty(e){const t=this.createPushProperty(e);return t.useContent=!0,t}createCombProperty(e){const t=new ce(e);switch(t.factor=1,t.invertDelay=!0,t.meshType=l.Square,e.direction){case n.Horizontal:t.hres=1,t.vres=7,t.directionFormula=d.CombHorizontal;break;case n.Vertical:t.hres=7,t.vres=1,t.directionFormula=d.CombVertical}return t}createWipeProperty(e){const t=new ne(e);switch(t.hres=50,t.vres=50,e.direction){case n.Top:case n.Bottom:t.delayFormula=c.Top,t.hres=1,t.invertDelay=e.direction===n.Top;break;case n.Left:case n.Right:t.delayFormula=c.Left,t.vres=1,t.invertDelay=e.direction===n.Left;break;case n.TopLeft:case n.BottomRight:t.delayFormula=c.TopLeft,t.invertDelay=e.direction===n.TopLeft;break;case n.TopRight:case n.BottomLeft:t.delayFormula=c.TopRight,t.invertDelay=e.direction===n.TopRight}return t}createSplitProperty(e){const t=new ne(e);switch(t.hres=50,t.vres=50,e.direction){case n.HorizontalOut:case n.HorizontalIn:t.delayFormula=c.SplitVertical,t.hres=1,t.invertDelay=e.direction===n.HorizontalIn;break;case n.VerticalOut:case n.VerticalIn:t.delayFormula=c.SplitHorizontal,t.vres=1,t.invertDelay=e.direction===n.VerticalIn}return t}createZoomProperty(e){const t=new ne(e);return t.hres=100,t.vres=100,t.factor=30,t.delayFormula=c.Box,t.invertDelay=e.direction===n.ZoomIn,t}createShapeProperty(e,t){const i=new ne(e);switch(i.hres=100,i.vres=100,i.factor=3,i.invertDelay=e.direction!==n.Anywhere,t){case r.PPT_TRANSITION_DIAMOND:i.delayFormula=c.Diamond;break;case r.PPT_TRANSITION_PLUS:i.delayFormula=c.Plus;break;case r.PPT_TRANSITION_CIRCLE:i.delayFormula=c.Circle}return i}createRandombarProperty(e){const t=new ne(e);return e.direction===n.Vertical?(t.hres=100,t.vres=1):(t.hres=1,t.vres=100),t.delayFormula=c.Random,t}createFadeSmoothlyProperty(e){const t=new ne(e);return t.hres=1,t.vres=1,t.factor=1,t.jitter=0,t.delayFormula=c.None,t}createCutThroughBlackProperty(e){const t=new oe(e);return t.hres=1,t.vres=1,t.m_fThroughBlack=!0,t}createCoverProperty(e){const t=new le(e);return t.hres=1,t.vres=1,t.isCover=!0,t}createUncoverProperty(e){const t=this.createCoverProperty(e);return t.isCover=!1,t}createWheelTransitionProperty(e,t){const i=new ue(e);if(t)switch(e.direction){case 0:case 1:i.delayFormula=c.Clock1;break;case 2:i.delayFormula=c.Clock2;break;case 3:i.delayFormula=c.Clock3;break;case 4:case 5:case 6:case 7:i.delayFormula=c.Clock4;break;case 8:default:i.delayFormula=c.Clock8}else switch(e.direction){case 4:i.delayFormula=c.CounterClock4;break;default:i.delayFormula=c.CounterClock1}return i}createWedgeTransitionProperty(e){const t=new ue(e);return t.factor=3,t.delayFormula=c.Wedge,t}createPrismProperty(e){return new Te(e)}constructor(e){this.m_customTransitionDataLoader=e}}class ie{constructor(e){this.gl=e.gl,this.engine=e.engine,this.forward=e.forward,this.direction=e.direction,this.aspectRatio=e.aspectRatio,this.incomingSlideBackground=e.incomingSlideBackground,this.outgoingSlideBackground=e.outgoingSlideBackground,this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground}}class ne{constructor(e){this.invertDelay=!1,this.delayFormula=c.None,this.meshType=l.Smooth,this.hres=50,this.vres=50,this.factor=2,this.jitter=10,this.gl=e.gl,this.engine=e.engine,this.forward=e.forward,this.direction=e.direction,this.aspectRatio=e.aspectRatio,this.incomingSlideBackground=e.incomingSlideBackground,this.outgoingSlideBackground=e.outgoingSlideBackground}}class re extends ne{constructor(e){switch(super(e),this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground,this.jitter=0,this.m_length=18,this.m_endType=J.MotionQuadratic,this.m_doorType=o.DoorNone,this.m_fFade=!0,this.m_reflectionType=a.ReflectionNone,this.m_motionBlurFrames=2,this.m_motionBlurWidth=18,this.m_fOut=e.direction===n.GoOut||e.direction===n.OutBounce,this.hres=4,this.vres=4,this.meshType=l.Square,this.factor=1,this.delayFormula=c.Random,this.m_fUseContent=!0,this.m_bounceTime=15,this.m_bounceDampening=13,e.direction){case n.GoIn:case n.GoOut:this.m_endType=J.MotionQuadratic;break;case n.InBounce:case n.OutBounce:this.m_endType=J.MotionQuadraticBounce}this.m_slidingDoorSpeed=20}}class ae extends ne{constructor(e){super(e),this.isCenterBufferReq=!0,this.jitter=0,this.m_length=15,this.m_endType=J.MotionQuadratic,this.m_doorType=o.DoorNone,this.m_fFade=!0,this.m_reflectionType=a.ReflectionNone,this.m_motionBlurFrames=2,this.m_motionBlurWidth=18,this.m_fOut=e.direction===n.GoOut,this.m_fUseContent=!1,this.m_bounceTime=7,this.m_bounceDampening=13,this.m_slidingDoorSpeed=20,this.hres=4,this.vres=4,this.meshType=l.Square,this.factor=1,this.delayFormula=c.Random}}class se extends ne{constructor(e,t){switch(super(e),this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground,this.isCenterBufferReq=!0,this.jitter=0,this.m_length=18,this.m_endType=J.MotionQuadraticHard,e.direction){case n.Horizontal:this.m_doorType=o.DoorHorizontal,this.m_isX=!0;break;case n.Vertical:this.m_doorType=o.DoorVertical,this.m_isX=!1;break;default:throw new Error("direction should not be greater than 1")}this.m_fFade=!1,this.m_motionBlurFrames=2,this.m_motionBlurWidth=18,this.m_fUseContent=t,this.m_slidingDoorSpeed=20,t||(this.m_length=15,this.m_reflectionType=a.ReflectionSimple,this.m_slidingDoorSpeed=12),this.m_fOut=!0,this.m_bounceTime=7,this.m_bounceDampening=13,this.m_reflectionType=a.ReflectionNone,this.hres=2,this.vres=2,this.meshType=l.Square,this.factor=1,this.delayFormula=c.Random}}class oe extends ne{constructor(e){super(e),this.m_fThroughBlack=!1}}class le extends ne{constructor(e){super(e),this.isCover=!1}}class de extends ne{constructor(e){super(e),this.jitter=0,this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground,this.useContent=!1}}class ce extends ne{constructor(e){super(e),this.direction=e.direction,this.directionFormula=d.CombHorizontal,this.delayFormula=c.Top}}class he extends ne{constructor(e){super(e),this.jitter=0,this.hres=54,this.vres=42,this.factor=7,this.meshType=l.Square,this.delayFormula=c.Random}}class ue extends ne{constructor(e){super(e),this.jitter=0,this.hres=127,this.vres=8,this.factor=9,this.invertDelay=!1,this.meshType=l.Radial,this.delayFormula=c.Clock1}}class me extends ne{constructor(e){super(e),this.randomCenters=!1,this.zMovement=10,this.extraDistance=0,this.factor=2,this.jitter=0,this.delayFormula=c.FromCenter,this.sides=3,this.inverse=!1,this.useContent=!1,this.invertDirection=!1,this.meshType=l.Square,this.invertDelay=!this.forward,e.direction!==n.Vertical?(this.hres=18,this.vres=1,this.xAxis=!1):(this.hres=1,this.vres=14,this.xAxis=!0)}}class fe extends ne{constructor(e){super(e),this.factor=2,this.jitter=0,this.delayFormula=c.FromCenter,this.meshType=l.Square,this.hres=1,this.vres=1}}class pe extends ne{constructor(e){super(e),this.m_rippleType=e.direction,this.invertDelay=!1,this.jitter=0,this.hres=80,this.vres=80,this.factor=1}}class ge extends ne{constructor(e){super(e),this.bounceTime=0,this.bounceDampen=0,this.invertDelay=!1,this.jitter=0,this.hres=1,this.vres=1,this.factor=1,this.m_isInvX=!e.direction,this.motionType=J.MotionQuadratic,this.m_fUseContent=!1,this.m_fSwivel=!0,this.m_swivelTime=22,this.m_waitTime=0,this.m_swivelZoom=100,this.m_distance=0,this.m_fReflection=!0,this.m_fFadeReflection=!1,this.m_reflectionDistance=1,this.m_swivelAngle=-10,this.meshType=l.Square}}class _e extends ge{constructor(e){super(e),this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground,this.m_fReflection=!1,this.m_fUseContent=!0}}class Se extends me{constructor(e){super(e),this.hres=7,this.vres=5,this.factor=4,this.jitter=52,this.zMovement=0,this.xAxis=!1,this.invertDelay=!1,e.direction===n.Horizontal?(this.delayFormula=c.Left,this.xAxis=!1):(this.delayFormula=c.Top,this.xAxis=!0)}}class ve extends me{constructor(e){super(e),this.factor=4,this.jitter=45,this.zMovement=0,this.xAxis=!1,this.invertDelay=!1;const t=Math.floor(e.direction/4);switch(e.direction%4){case n.Right:this.delayFormula=c.Left,this.invertDelay=!0;break;case n.Bottom:this.delayFormula=c.Top,this.invertDelay=!0;break;case n.Left:this.delayFormula=c.Left;break;case n.Top:this.delayFormula=c.Top}switch(t){case 0:this.meshType=l.Diamond,this.hres=30,this.vres=15;break;case 1:this.meshType=l.Hexagon,this.hres=35,this.vres=16}}}class ye extends me{constructor(e){switch(super(e),this.hres=128,this.vres=100,this.factor=1,this.jitter=25,this.zMovement=5,this.xAxis=!1,this.invertDelay=!1,e.direction){case n.Right:this.delayFormula=c.Left;break;case n.Bottom:this.delayFormula=c.Top,this.xAxis=!0;break;case n.Left:this.delayFormula=c.Left,this.invertDelay=!0;break;case n.Top:this.delayFormula=c.Top,this.invertDelay=!0,this.xAxis=!0}this.randomCenters=!0}}class Te extends me{constructor(e){let t=e.direction%4;const i=4==(4&e.direction),r=8==(8&e.direction);!e.forward&&e.direction<8&&(t=(t+2)%4),super(e),this.hres=1,this.vres=1,this.factor=1,this.sides=10,this.zMovement=10,this.invertDelay=!1,this.inverse=r,this.useContent=i,this.delayFormula=c.None,this.xAxis=t===n.Top||t===n.Bottom;const a=t===n.Bottom||t===n.Right;this.invertDirection=r||!r&&!this.forward?!a:a,r&&(this.zMovement=t===n.Left||t===n.Right?-30:-22,this.extraDistance=7),this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground}}class be extends ne{constructor(e){switch(super(e),this.jitter=0,this.hres=101,this.vres=101,this.factor=1,this.m_dx=3,this.m_dy=0,this.m_dz=6,this.m_deadTime=9,this.m_fInvertXZoomOut=!0,this.m_fTransitionWhite=!0,this.invertDelay=!1,this.useContent=!0,this.meshType=l.Smooth,this.delayFormula=c.Left,this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground,e.direction){case n.Left:this.m_fTransitionWhite=!0;break;case n.BlackFromLeft:this.invertDelay=!0,this.m_fTransitionWhite=!1;break;case n.Right:this.m_fTransitionWhite=!0;break;case n.BlackFromRight:this.invertDelay=!1,this.m_fTransitionWhite=!1}}}class we extends ne{constructor(e,t,i){super(e),this.isInvX=!e.direction,this.indexBuffer=t.IndexBuffer,this.positionBufferList=t.PositionBufferList,this.textureCoordBuffer=t.TextureCoordBuffer,this.effectID=i,this.ambient=0}}class Ce extends we{constructor(e,t,i){super(e,t,i),this.indexBufferBack=t.IndexBufferBack,this.positionBufferListBack=t.PositionBufferListBack,this.textureCoordBufferBack=t.TextureCoordBufferBack}}class Ie{constructor(){this.textures={count:0},this.buffers={count:0},this.vaos={count:0}}}class Pe{init(e,t=new Ie){try{this.transition.init(e,t)}catch(e){p("Exception at Transition init : "+e)}}draw(e){try{return this.transition.draw(e)}catch(e){p("Exception at Transition draw : "+e)}return!1}dispose(){try{this.transition.dispose()}catch(e){p("Exception at Transition dispose : "+e)}}constructor(e){this.transition=e}}class Ee{asArray(){return Array.from(this._data)}toArray(){return this._data}setValues(e,t,i,n,r,a,s,o,l,d,c,h,u,m,f,p){const g=this._data;return g[0]=e,g[1]=t,g[2]=i,g[3]=n,g[4]=r,g[5]=a,g[6]=s,g[7]=o,g[8]=l,g[9]=d,g[10]=c,g[11]=h,g[12]=u,g[13]=m,g[14]=f,g[15]=p,Ee._updateFlagSeed+=1,this.updateFlag=Ee._updateFlagSeed,this}getValueAt(e){return this._data[e]}setValueAt(e,t){return this._data[e]=t,Ee._updateFlagSeed+=1,this.updateFlag=Ee._updateFlagSeed,this}identity(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}translationColumn(e,t,i){return this.setValues(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}translation(e,t,i){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,e,t,i,1),this}scaling(e,t,i){return this.setValues(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}translationScaling(e,t,i,n,r,a){return this.setValues(n,0,0,0,0,r,0,0,0,0,a,0,e*n,t*r,i*a,1),this}rotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.setValues(1,0,0,0,0,t,i,0,0,-i,t,0,0,0,0,1),this}rotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.setValues(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1),this}rotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.setValues(t,i,0,0,-i,t,0,0,0,0,1,0,0,0,0,1),this}perspective(e=1.5){return this.setValues(1,0,0,0,0,1,0,0,e,e,1,2*e,0,0,0,1),this}multiply(e){return this.multiplyToRef(e,this)}multiplyToRef(e,t){const i=this._data,n=e._data,r=i[0],a=i[1],s=i[2],o=i[3],l=i[4],d=i[5],c=i[6],h=i[7],u=i[8],m=i[9],f=i[10],p=i[11],g=i[12],_=i[13],S=i[14],v=i[15],y=n[0],T=n[1],b=n[2],w=n[3],C=n[4],I=n[5],P=n[6],E=n[7],x=n[8],k=n[9],M=n[10],A=n[11],R=n[12],O=n[13],F=n[14],D=n[15],L=r*y+a*C+s*x+o*R,B=r*T+a*I+s*k+o*O,N=r*b+a*P+s*M+o*F,V=r*w+a*E+s*A+o*D,W=l*y+d*C+c*x+h*R,U=l*T+d*I+c*k+h*O,z=l*b+d*P+c*M+h*F,H=l*w+d*E+c*A+h*D,G=u*y+m*C+f*x+p*R,j=u*T+m*I+f*k+p*O,$=u*b+m*P+f*M+p*F,q=u*w+m*E+f*A+p*D,Z=g*y+_*C+S*x+v*R,J=g*T+_*I+S*k+v*O,X=g*b+_*P+S*M+v*F,Y=g*w+_*E+S*A+v*D;return t.setValues(L,B,N,V,W,U,z,H,G,j,$,q,Z,J,X,Y),t}constructor(){this.updateFlag=-1,this._data=new Float32Array(16)}}function xe(){const e=new Ee;return e.identity(),e}function ke(e,t,i,n,r,a){const s=new Ee;return s.translationScaling(e,t,i,n,r,a),s}function Me(){return ke(-.5,-.5,0,2,2,1)}function Ae(){const e=Re(),t=Me();return e.multiply(t)}function Re(){const e=new Ee;return e.perspective(),e}Ee._updateFlagSeed=0;const Oe=e=>({name:"aPosition",data:e.getVertexPositions(),itemSize:3}),Fe=e=>({name:"aTexcoord",data:e.getTextureCoords(),itemSize:2}),De=e=>({name:"aDelay",data:e.getDelays(),itemSize:1}),Le=e=>({name:"aCenter",data:e.getCenter(),itemSize:2}),Be=e=>({name:"aDistance",data:e.getRippleDistance(),itemSize:1}),Ne=(e,t)=>({name:"aDirection",data:e.getDirections(t),itemSize:2});function Ve(e){return e.engine.enableEffect(e.shaderProgram),e.vertexArrayObject?e.engine.bindVertexArrayObject(e.vertexArrayObject,e.vertexIndexBuffer):e.engine.bindBuffers(e.vertexBuffers,e.vertexIndexBuffer,e.shaderProgram),e.shaderProgram}function We(e){e.engine.draw(!0,0,e.vertexIndexLength)}function Ue(e,t=!1,i=!1,n=0){e.depthCullingState.depthTest=t,e.setTranstionBlend(i),0===n?e.depthCullingState.cull=!1:(e.depthCullingState.cull=!0,e.depthCullingState.cullFace=n)}class ze{init(e,t){e?e.engine?(this.drawInfo&&this.dispose(),this.props=e,this.engine=e.engine,this.resourcesManager=new j(this.engine,t),this.drawInfo=this.internalInit(e,this.resourcesManager,t),this.drawInfo||(this.dispose(),p("Can not init shaders, or draw info, initialization failed."))):p("No engine has been provided for the transition"):p("No Props have been provided for the transition")}draw(e){const t=this.drawInfo;return t&&this.props?t.engine.isContextLost()?(p("Context has been lost"),!1):(t.autoClear&&(t.engine.resetViewport(),t.engine.clearToBlack()),this.internalDraw(e,this.props,t)):(p("Transition has not been initialized"),!1)}getDrawInfo(e,t,i=!1){if(!this.engine||!this.resourcesManager||!this.props)return void p("Transition has not been initialized");const n=new T(this.props,i),r=new b;r.initialize(n);const a=new Array(t.length);for(let e=0;e<t.length;e+=1)a[e]=t[e](r,n);return function(e,t,i,n,r,a,s){const o=B(e,r);if(!o)return void p("Can not init shaders, initialization failed.");const l=t.createVertexBuffers(s),d=t.createIndexBuffer(a),c=a.length,h=e.wrapExternalTexture(i),u=e.wrapExternalTexture(n);let m;return e.getCaps().vertexArrayObject&&(m=t.recordVertexArrayObject(l,d,o)),{engine:e,shaderProgram:o,vertexBuffers:l,vertexIndexBuffer:d,vertexIndexLength:c,incomingSlideTexture:h,outgoingSlideTexture:u,vertexArrayObject:m,autoClear:!0}}(this.engine,this.resourcesManager,this.props.incomingSlideBackground,this.props.outgoingSlideBackground,e,r.getVertexIndices(),a)}dispose(){this.resourcesManager&&this.resourcesManager.dispose()}}const He=Me();class Ge extends ze{internalInit(e){const t=this.getDrawInfo(R.alpha,[Oe,Fe,De]);if(t)return this.delayDuration=e.delayFormula==c.None?0:1,this.textureInfo={incomingSlideTexture:t.incomingSlideTexture,outgoingSlideTexture:t.outgoingSlideTexture},{...t,autoClear:this.autoClear}}internalDraw(e,t,i){this.autoClear&&Ue(i.engine);const n=e*(this.delayDuration+1/t.factor+t.jitter/100),r=Ve(i);r.setFloat("uStyle",this.style),r.setMatrix("uModelViewProj",He),r.setFloat("uProgress",n),r.setFloat("uFactor",t.factor);const a=i.incomingSlideTexture,s=i.outgoingSlideTexture;return r._bindTexture("uSampler1",t.forward?s:a),r._bindTexture("uSampler2",t.forward?a:s),We(i),!0}getTextureInfo(){return this.textureInfo}constructor(e=!0){super(),this.delayDuration=0,this.style=1,this.autoClear=e}}class je extends ze{initModel(e){e.hres=1,e.vres=1,e.meshType=l.Smooth;const t=this.getDrawInfo(R.model,[Oe,Fe]);if(!t)return;const i=Ae();return t.shaderProgram.setMatrix("uModelViewProj",i),this.modelDrawInfo=t,t}drawTexture(e){const t=this.modelDrawInfo;return t?(Ve(t),t.shaderProgram._bindTexture("uSampler1",e),We(t),!0):(p("Can not draw the smooth model, shader program and model is undefined."),!1)}internalDraw(e,t,i){return this.drawTexture(t.forward?i.incomingSlideTexture:i.outgoingSlideTexture)}}class $e extends je{internalInit(e){this.zMovement=null!=e.zMovement?e.zMovement:10,this.vres=e.vres,this.hres=e.hres;const t=this.getDrawInfo(R.vortex,[Oe,Fe,De,Le],!0);if(!t)return;const i=Ae();return t.shaderProgram.setMatrix("uModelViewProj",i),t.shaderProgram.setFloat("uFactor",e.factor),t.shaderProgram.setFloat("uXAxis",e.xAxis?1:0),t}internalDraw(e,t,i){Ue(i.engine,!0,!0,1028);const n=Math.PI,r=t.delayFormula===c.None?0:1;let a=this.zMovement/10;a/=t.xAxis?this.vres:this.hres;let s=e*(r+n/t.factor+t.jitter/100),o=0,l=-1;const d=Ve(i);return d.setFloat("uZmovement",a),d.setFloat("uDirection",l),d.setFloat("uAngle",s),d.setFloat("uBack",o),d._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),We(i),t.randomCenters?(s=(1-e)*(1+n/t.factor+t.jitter/100),o=0,l=1):(o=n,l=-1),d.setFloat("uDirection",l),d.setFloat("uAngle",s),d.setFloat("uBack",o),d._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),We(i),!0}constructor(){super(...arguments),this.zMovement=0,this.vres=0,this.hres=0}}class qe extends je{internalInit(e){const t={x:0,y:0};switch(e.direction){case n.Top:t.y=1;break;case n.Bottom:t.y=-1;break;case n.Left:t.x=-1;break;case n.TopLeft:t.y=1,t.x=-1;break;case n.BottomLeft:t.y=-1,t.x=-1;break;case n.TopRight:t.y=1,t.x=1;break;case n.BottomRight:t.y=-1,t.x=1;break;case n.Right:default:t.x=1}e.isCover||(t.x*=-1,t.y*=-1);const i=this.getDrawInfo(R.alpha,[Oe,Fe,De]);if(i)return{...i,direction:t}}internalDraw(e,t,i){let n=e;t.isCover||(n=1-n);const r=Ve(i);r.setFloat("uFactor",1),r.setFloat("uStyle",1),t.isCover?(r._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),r._bindTexture("uSampler2",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture)):(r._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),r._bindTexture("uSampler2",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture));const a=ee.getScaledProgress(J.MotionQuadratic,n);return this.positionSlide0.x=this.center.x,this.positionSlide0.y=this.center.y,this.positionSlide1.x=this.center.x+(1-a)*-i.direction.x,this.positionSlide1.y=this.center.y+(1-a)*-i.direction.y,this.modelViewProjectionMatrix.translationScaling(this.positionSlide0.x,this.positionSlide0.y,0,2,2,1),r.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),r.setFloat("uProgress",0),We(i),this.modelViewProjectionMatrix.translationScaling(this.positionSlide1.x,this.positionSlide1.y,0,2,2,1),r.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),r.setFloat("uProgress",1),We(i),!0}constructor(){super(...arguments),this.modelViewProjectionMatrix=new Ee,this.center={x:-.5,y:-.5},this.positionSlide0={x:0,y:0},this.positionSlide1={x:0,y:0}}}class Ze extends je{internalInit(e,t,i){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void p("Either incomingSlideTextureForeGround or outgoingSlideTextureForeGround is undefined");const n=this.getDrawInfo(R.alpha,[Oe,Fe,De]);if(!n)return;let r;r=e.m_fTransitionWhite?t.createMonochromeTexture(255,255,255,255):t.createMonochromeTexture(0,0,0,255),e.delayFormula=c.None,this.alphaTransition.init(e,i);const a=Me(),s=Re();s.multiply(a);const o=n.engine.wrapExternalTexture(e.incomingSlideForeground),l=n.engine.wrapExternalTexture(e.outgoingSlideForeground);return{...n,solidTexture:r,modelViewMatrix:a,modelViewProjectionMatrix:s,incomingSlideTextureForeGround:o,outgoingSlideTextureForeGround:l}}internalDraw(e,t,i){Ue(i.engine,!1,t.m_fTransitionWhite);let n=e;if(t.m_fTransitionWhite)this.alphaTransition.draw(n);else if(t.m_deadTime>0){const e=t.m_deadTime/100;n<.5?n*=1-e:n=(1-e)*(n-.5)+.5+e/2}const r=t.forward?i.incomingSlideTexture:i.outgoingSlideTexture,a=t.forward?i.outgoingSlideTexture:i.incomingSlideTexture,s=t.forward?i.incomingSlideTextureForeGround:i.outgoingSlideTextureForeGround,o=t.forward?i.outgoingSlideTextureForeGround:i.incomingSlideTextureForeGround;let l=n;l*=2;const d=l<1;d||(l=2-l);const c=t.factor/4,h=1+1/c+t.jitter/100,u=Ve(i);return t.m_fTransitionWhite?(u.setFloat("uFactor",c),u.setFloat("uProgress",(1-l)*h)):(u.setFloat("uProgress",h),u.setFloat("uFactor",1),u.setMatrix("uModelViewProj",i.modelViewProjectionMatrix),u.setFloat("uStyle",2),u._bindTexture("uSampler1",d?a:r),We(i)),this.calculateEyePosition(n,t,i.modelViewMatrix),u.setMatrix("uModelViewProj",this.crossZoomMatrix),u.setFloat("uStyle",2),u._bindTexture("uSampler1",d?o:s),We(i),t.m_fTransitionWhite||(u.setMatrix("uModelViewProj",i.modelViewProjectionMatrix),u.setFloat("uFactor",c),u.setFloat("uProgress",l*h),u.setFloat("uStyle",2),u._bindTexture("uSampler1",i.solidTexture),We(i)),!0}calculateEyePosition(e,t,i){let n=t.m_dx/100;const r=t.m_dy/100,a=t.m_dz/100;let s=2*e;s>1&&(s=2-s,t.m_fInvertXZoomOut&&(n*=-1));const o=n*s,l=r*s,d=-1.5/(a*s-1.5);this.crossZoomMatrix.scaling(d,d,1),this.eyePositionMatrix.translation(-o,-l,0),this.crossZoomMatrix.multiply(this.eyePositionMatrix),i.multiplyToRef(this.crossZoomMatrix,this.crossZoomMatrix)}dispose(){this.alphaTransition.dispose(),super.dispose()}constructor(){super(...arguments),this.crossZoomMatrix=new Ee,this.eyePositionMatrix=new Ee,this.alphaTransition=new Ge(!1)}}class Je extends ze{internalInit(e,t){this.aspectRatio=16/9,this.diffuse=1-e.ambient;let i=!1;e.effectID===r.PPT_TRANSITION_DRAPE?(this.backgroundProgress=1,i=!i):this.backgroundProgress=0,e.forward||(i=!i);const n=e.engine;if(!n)return;const a=n.wrapExternalTexture(i?e.outgoingSlideBackground:e.incomingSlideBackground),s=n.wrapExternalTexture(i?e.incomingSlideBackground:e.outgoingSlideBackground),o=B(n,R.custom);if(!o)return void p("Can not init shaders, shader program is undefined.");const l=e.indexBuffer,d=t.createIndexBuffer(e.indexBuffer),c=e.indexBuffer.length,h=new Float32Array(e.textureCoordBuffer);if(e.isInvX)for(let e=0;e<h.length/2;e+=1)h[2*e]=1-h[2*e];const u=h.length/2*3,m=new Float32Array(u),f=new Float32Array(u),g=t.createVertexBuffers([{name:"aTexCoord",data:h,itemSize:2},{name:"aPosition",data:m,itemSize:3},{name:"aNormal",data:f,itemSize:3}]);let _;n.getCaps().vertexArrayObject&&(_=t.recordVertexArrayObject(g,d,o));const S=new Ee,v=new Ee,y=new Ee,T=new Ee,b=new Ee,w=new Ee;S.scaling(1.031,1.031/this.aspectRatio,.5),v.rotationY(Math.PI),y.translation(0,0,2.8),v.multiplyToRef(S,T),y.multiplyToRef(T,T),this.perspectiveMat(45,this.aspectRatio,.01,100,w),T.multiplyToRef(w,w),this.perspectiveMat(45,this.aspectRatio,.1,100,b),T.multiplyToRef(b,b),o.setMatrix("uModelToWorld",T),o.setMatrix("uModelToWorldIT",T),o.setFloat3("uLightPosition",0,0,-10),e.effectID===r.PPT_TRANSITION_FALLOVER?o.setFloat("uIsNormalDirectionChangeReq",0):o.setFloat("uIsNormalDirectionChangeReq",1);const C={engine:n,shaderProgram:o,incomingSlideTexture:a,outgoingSlideTexture:s,perspectiveMatrix:b,perspectiveBackgroundMatrix:w,vertexBuffers:g,vertexIndexBuffer:d,vertexIndexLength:c,tempVertexDataArray:m,tempVertexNormalDataArray:f,vertexIndexData:l,positionBufferList:e.positionBufferList,vertexArrayObject:_,autoClear:!0};if(e.textureCoordBufferBack&&e.indexBufferBack&&e.positionBufferListBack){const i=e.indexBufferBack,r=t.createIndexBuffer(e.indexBufferBack),a=e.indexBufferBack.length,s=new Float32Array(e.textureCoordBufferBack);if(e.isInvX)for(let e=0;e<s.length/2;e+=1)s[2*e]=1-s[2*e];const l=h.length/2*3,d=new Float32Array(l),c=new Float32Array(l),u=t.createVertexBuffers([{name:"aTexCoord",data:s,itemSize:2},{name:"aPosition",data:d,itemSize:3},{name:"aNormal",data:c,itemSize:3}]);let m;n.getCaps().vertexArrayObject&&(m=t.recordVertexArrayObject(u,r,o)),C.back={vertexBuffers:u,vertexIndexBuffer:r,vertexIndexLength:a,vertexIndexData:i,tempVertexDataArray:d,tempVertexNormalDataArray:c,positionBufferList:e.positionBufferListBack,vertexArrayObject:m}}return C}internalDraw(e,t,i){const n=i.engine;this.setTransitionProperties(n,t.effectID,t.isInvX);const a=i.shaderProgram;if(n.enableEffect(a),t.effectID===r.PPT_TRANSITION_FLIP||t.effectID===r.PPT_TRANSITION_SWITCH){const e=this.isStaticBackground;this.isStaticBackground=!0,this.drawUtil(i,0,i,!0,0,0,t.isInvX,t.effectID),this.isStaticBackground=e}return i.back&&t.positionBufferListBack?this.drawUtil(i,e,i.back,!0,t.ambient,this.diffuse,t.isInvX,t.effectID):this.drawUtil(i,this.backgroundProgress,i,!0,t.ambient,this.diffuse,t.isInvX,t.effectID),this.drawUtil(i,e,i,!1,t.ambient,this.diffuse,t.isInvX,t.effectID),!0}setUniforms(e,t,i,n){let r;r=t&&this.isStaticBackground?e.perspectiveBackgroundMatrix:e.perspectiveMatrix,e.shaderProgram.setMatrix("uModelToView",r),e.shaderProgram.setFloat3("uAmbientColor",i,i,i),e.shaderProgram.setFloat4("uDiffuseColor",n,n,n,1)}setTransitionProperties(e,t,i){switch(e.setTranstionBlend(!1),e.depthCullingState.depthTest=!0,t){case r.PPT_TRANSITION_FLIP:case r.PPT_TRANSITION_SWITCH:case r.PPT_TRANSITION_PAGECURLDOUBLE:this.isStaticBackground=!1,e.depthCullingState.cull=!0,e.depthCullingState.cullFace=i?1029:1028;break;case r.PPT_TRANSITION_AIRPLANE:case r.PPT_TRANSITION_CRUSH:case r.PPT_TRANSITION_CURTAINS:case r.PPT_TRANSITION_FRACTURE:case r.PPT_TRANSITION_ORIGAMI:case r.PPT_TRANSITION_PEELOFF:case r.PPT_TRANSITION_PRESTIGE:case r.PPT_TRANSITION_WIND:case r.PPT_TRANSITION_FALLOVER:case r.PPT_TRANSITION_DRAPE:case r.PPT_TRANSITION_PAGECURLSINGLE:e.depthCullingState.cull=!1,this.isStaticBackground=!0}}drawUtil(e,t,i,n,r,a,s,o){const l=i.vertexIndexData,d=i.tempVertexDataArray,c=i.tempVertexNormalDataArray,h=i.vertexBuffers,u=i.vertexIndexBuffer,m=i.vertexIndexLength,f=i.positionBufferList,p=i.vertexArrayObject,g=t*(f.length-1),_=Math.floor(g),S=_+1,v=g-_,y=f[_],T=f[S];if(null==T)for(let e=0;e<y.length;e+=1)d[e]=y[e];else for(let e=0;e<y.length;e+=1)d[e]=y[e]*(1-v)+T[e]*v;if(s)for(let e=0;e<y.length/3;e+=1)d[3*e]=-d[3*e];h.aPosition.update(d),this.getNormalBufferInPlace(d,c,l,m,s,o),h.aNormal.update(c),p?e.engine.bindVertexArrayObject(p,u):e.engine.bindBuffers(h,u,e.shaderProgram),this.setUniforms(e,n,r,a),e.shaderProgram._bindTexture("uSampler",n?e.incomingSlideTexture:e.outgoingSlideTexture),We(e)}getNormalBufferInPlace(e,t,i,n,a,s){for(let i=0;i<e.length;i+=1)t[i]=0;for(let o=0;o<n/3;o+=1){const n=i[3*o],l=i[3*o+1],d=i[3*o+2],c=e[3*n],h=e[3*n+1],u=e[3*n+2],m=e[3*l]-c,f=e[3*l+1]-h,p=e[3*l+2]-u,g=e[3*d]-c,_=e[3*d+1]-h,S=e[3*d+2]-u;let v=_*p-f*S,y=S*m-p*g,T=g*f-m*_;s!==r.PPT_TRANSITION_FALLOVER||a||(v=-v,y=-y,T=-T),t[3*n]+=v,t[3*n+1]+=y,t[3*n+2]+=T,t[3*l]+=v,t[3*l+1]+=y,t[3*l+2]+=T,t[3*d]+=v,t[3*d+1]+=y,t[3*d+2]+=T}}perspectiveMat(e,t,i,n,r){const a=i*Math.tan(e*Math.PI/360),s=a*t;this.frustum(-s,s,-a,a,i,n,r)}frustum(e,t,i,n,r,a,s){const o=t-e,l=n-i,d=a-r;s.setValues(2*r/o,0,0,0,0,2*r/l,0,0,(t+e)/o,(n+i)/l,-(a+r)/d,-1,0,0,-a*r*2/d,0)}constructor(){super(...arguments),this.aspectRatio=0,this.diffuse=0,this.backgroundProgress=0,this.isStaticBackground=!0}}class Xe extends je{internalInit(e){const t=this.initModel(e);if(t)return t}internalDraw(e,t,i){return Ue(i.engine),1===e?this.drawTexture(t.forward?i.incomingSlideTexture:i.outgoingSlideTexture):t.m_fThroughBlack&&e>.5?i.engine.clearToBlack():this.drawTexture(t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),!0}}class Ye extends je{internalInit(e,t,i){if(e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void p("Outgoing textures have not been defined");e.delayFormula=c.None,this.alphaTransition=new Ge(!1),this.alphaTransition.init(e,i),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}const n=this.getDrawInfo(R.flyThrough,[Oe,Fe,Le],!0);if(!n)return;if(!e.forward){const e=n.incomingSlideTexture,t=n.outgoingSlideTexture;n.incomingSlideTexture=t,n.outgoingSlideTexture=e}const r=Ae(),a=xe();return n.shaderProgram.setMatrix("uModelViewProj",r),n.shaderProgram.setMatrix("offsetMatrix",a),n}internalDraw(e,t,i){Ue(i.engine,!1,!0),this.alphaTransition&&this.alphaTransition.draw(e);const n=Ve(i),r=this.alphaTransitionTextures;return r&&n._bindTexture("uSampler2",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),this.drawSlide(t,i,e,!0),this.drawSlide(t,i,e,!1),!0}drawSlide(e,t,i,n){const r=t.shaderProgram;let a=i;n&&(a=1-a),r._bindTexture("uSampler1",n?t.incomingSlideTexture:t.outgoingSlideTexture),this.alphaTransitionTextures||r._bindTexture("uSampler2",n?t.outgoingSlideTexture:t.incomingSlideTexture),n?r.setFloat("style",2):r.setFloat("style",1);const s=!e.m_fUseContent&&n?1:1-a;let o=a;n&&(o=a/4),r.setFloat("uProgress",o),r.setFloat("opacity",s),r.setFloat("isX",e.m_isX?1:0),We(t)}dispose(){this.alphaTransition&&this.alphaTransition.dispose(),super.dispose()}}class Ke extends je{internalInit(e,t){const i=this.getDrawInfo(R.alpha,[Oe,Fe,De]);if(!i)return;this.delayDuration=e.delayFormula==c.None?0:1;const n=Ae();i.shaderProgram.setMatrix("uModelViewProj",n);const r=t.createMonochromeTexture(0,0,0,255);return{...i,blackTexture:r}}internalDraw(e,t,i){let n;Ue(i.engine),n=e<=.5?2*e*(this.delayDuration+1/t.factor+t.jitter/100):2*(e-.5)*(this.delayDuration+1/t.factor+t.jitter/100);const r=Ve(i);r.setFloat("uProgress",n),r.setFloat("uFactor",t.factor),r.setFloat("uStyle",this.style);const a=i.incomingSlideTexture,s=i.outgoingSlideTexture;return e<=.5?(r._bindTexture("uSampler1",t.forward?s:a),r._bindTexture("uSampler2",i.blackTexture)):(r._bindTexture("uSampler1",i.blackTexture),r._bindTexture("uSampler2",t.forward?a:s)),We(i),!0}constructor(){super(...arguments),this.delayDuration=0,this.style=1}}function Qe(e,t){const i=new Uint8Array(4*e);for(let n=0;n<e;n+=1){const r=n/e;i[4*n+0]=0,i[4*n+1]=0,i[4*n+2]=0,i[4*n+3]=230*Math.pow(r,t)}return i}class et extends je{internalInit(e,t,i){if(this.m_zMoveMin=0,this.m_zMoveMax=1,this.m_zMoveDecel=.5,e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void p("Outgoing textures have not been defined");e.delayFormula=c.None,this.alphaTransition=new Ge(!1),this.alphaTransition.init(e,i),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}const n=this.getDrawInfo(R.flyThrough,[Oe,Fe,Le],!0);if(!n)return;const r=Qe(512,12),a=t.createTexture(r,1,512),s=t.createMonochromeTexture(0,0,0,255),o=n.incomingSlideTexture,l=n.outgoingSlideTexture;return{...n,incomingSlideTexture:e.forward?o:l,outgoingSlideTexture:e.forward?l:o,reflectionMask:a,blackTexture:s}}internalDraw(e,t,i){Ue(i.engine,!1,!0);const n=t.m_length/10;if(this.m_zEyeDest=n+this.m_defaultEye.z,this.alphaTransition){this.alphaTransition.draw(e);const n=Ve(i);if(this.alphaTransitionTextures){const{incomingSlideTexture:e,outgoingSlideTexture:i}=this.alphaTransitionTextures;n._bindTexture("uSampler1",t.forward?i:e),n._bindTexture("uSampler2",t.forward?e:i)}}else this.drawSlide(t,i,e,s.DrawNextSlideReflection),Ve(i);return this.drawSlide(t,i,e,s.DrawNextSlide),this.drawSlide(t,i,e,s.DrawPreviousSlide),!0}drawSlide(e,t,i,n){let r=i;e.m_fOut&&(r=1-r),this.computeEyePosition(e,r);const a=this.eyePosition,l=a.z;n===s.DrawNextSlide&&(a.z-=e.m_length/10),e.m_fOut&&(a.z=this.m_defaultEye.z-(a.z-this.m_defaultEye.z)),this.modelViewMatrix.translationScaling(-.5-a.x,-.5-a.y,0,2,2,1),this.projectionMatrix.multiplyToRef(this.modelViewMatrix,this.modelViewProjectionMatrix);const d=t.shaderProgram;if(d.setMatrix("offsetMatrix",this.defaultOffsetMatrix),e.m_fUseContent||d._bindTexture("uSampler2",e.forward?t.incomingSlideTexture:t.outgoingSlideTexture),d.setFloat("style",2),n!==s.DrawNextSlideReflection){if(n===s.DrawPreviousSlide){if(l>0)return;r=e.m_doorType===o.DoorSlidingHorizontal||e.m_doorType===o.DoorSlidingVertical?Math.abs(l-this.m_defaultEye.z)*e.m_slidingDoorSpeed/25:Math.abs(l-this.m_defaultEye.z);const i=e.m_fFade?Math.abs(l/this.m_defaultEye.z):1,n=e.m_fOut?this.getScaledReverseProgress(e,r):r;d.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),d.setFloat("uProgress",n),d.setFloat("opacity",i),d._bindTexture("uSampler1",e.m_fOut?t.incomingSlideTexture:t.outgoingSlideTexture)}else{const i=e.m_fOut||e.m_fUseContent?r:1;let n=r;e.m_fUseContent&&(n=e.m_fOut?r:Math.abs(l-this.m_defaultEye.z)/1.8),this.modelViewProjectionMatrix.multiply(this.scale4Matrix),d.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),d.setFloat("uProgress",n),d.setFloat("opacity",i),d._bindTexture("uSampler1",e.m_fOut?t.outgoingSlideTexture:t.incomingSlideTexture)}We(t)}else this.drawReflection(e,t,r,Math.abs(this.m_zEyeDest-a.z))}getScaledReverseProgress(e,t){switch(e.m_endType){case J.MotionQuadratic:return t;case J.MotionQuadraticBounce:const i=e.m_bounceTime/100,n=t/1.5;if(n<i){const e=i/2;return n<e?n:e-(n-e)}return(n-i)/(1-i);default:return-1e4}}computeEyePosition(e,t){let i;switch(e.m_endType){case J.MotionQuadratic:i=this.m_defaultEye.z+ee.getPositionFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case J.MotionLinear:i=this.m_defaultEye.z+t*e.m_length/10;break;case J.MotionQuadraticHard:i=this.m_defaultEye.z+ee.getPositionFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1),i>this.m_zEyeDest&&(i=this.m_zEyeDest);break;case J.MotionQuadraticBounce:const n=e.m_bounceTime/100,r=e.m_length/10*2/this.sqr(1-n),a=this.m_zMoveMax-n;if(t>a){const n=this.getVelocity(e,t),r=this.getBounce(e,t,n);i=this.m_defaultEye.z+e.m_length/10+r}else i=this.m_defaultEye.z+ee.getPositionFromTime(t,r,this.m_zMoveMin,a,a,!1);break;default:i=-100}this.eyePosition.z=i}sqr(e){return e*e}getVelocity(e,t){let i;switch(e.m_endType){case J.MotionQuadratic:i=ee.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case J.MotionLinear:i=e.m_length/10;break;case J.MotionQuadraticHard:i=ee.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1);break;case J.MotionQuadraticBounce:const n=this.m_zMoveMax-e.m_bounceTime/100;i=ee.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,n,n,!1);break;default:i=-1e4}return i}getBounce(e,t,i){const n=e.m_bounceTime/100,r=(t-(this.m_zMoveMax-n))/n,a=2*r*Math.PI;return 1/e.m_bounceDampening*(1-r)*n*Math.sin(a)*i}drawReflection(e,t,i,n){const r=t.shaderProgram,s=e.m_reflectionType;if(s!==a.ReflectionNone){this.newWorldMatrix.translation(0,.5,0),s===a.ReflectionShrink&&(this.newWorldMatrixTransform.scaling(1,2*n/3,1),this.newWorldMatrix.multiply(this.newWorldMatrixTransform));const e=s===a.ReflectionSimple?-Math.PI:-Math.PI/2;this.newWorldMatrixTransform.rotationX(e),this.newWorldMatrix.multiply(this.newWorldMatrixTransform),this.newWorldMatrixTransform.translation(0,-.5,0),this.newWorldMatrix.multiply(this.newWorldMatrixTransform),this.setReflectionMask(t,r,!0),r.setMatrix("offsetMatrix",this.newWorldMatrix);const o=s===a.ReflectionShrink?1.5/n:1;r.setFloat("opacity",o*(1-i)),r._bindTexture("uSampler1",t.incomingSlideTexture),We(t),this.setReflectionMask(t,r,!1)}}setReflectionMask(e,t,i){i?t._bindTexture("uSampler2",e.reflectionMask):t._bindTexture("uSampler2",e.blackTexture)}dispose(){this.alphaTransition&&this.alphaTransition.dispose(),super.dispose()}constructor(){super(...arguments),this.m_zEyeDest=0,this.m_zMoveMin=0,this.m_zMoveMax=0,this.m_zMoveDecel=0,this.m_defaultEye=new y(0,0,-1.5),this.projectionMatrix=Re(),this.modelViewMatrix=new Ee,this.modelViewProjectionMatrix=new Ee,this.defaultOffsetMatrix=xe(),this.scale4Matrix=function(e,t,i){const n=new Ee;return n.scaling(4,4,1),n}(),this.newWorldMatrix=new Ee,this.newWorldMatrixTransform=new Ee,this.eyePosition={x:0,y:0,z:0}}}const tt=new Ee;class it extends je{internalInit(e,t,i){if(e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void p("Outgoing textures have not been defined");this.alphaTransition=new Ge(!1),this.alphaTransition.init(e,i),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}const n=this.getDrawInfo(R.gallery,[Oe,Fe]);if(!n)return;if(!this.initModel(e))return;this.reflectionPreTranslationMatrix.translationColumn(0,e.m_reflectionDistance/100,0),this.reflectionPostTranslationMatrix.translationColumn(0,1,0);const r=Qe(512,12),a=t.createTexture(r,1,512),s=t.createMonochromeTexture(0,0,0,255);return{...n,reflectionMask:a,blackTexture:s}}internalDraw(e,t,i){Ue(i.engine,!1,!0),this.alphaTransition&&this.alphaTransition.draw(e);const n=Ve(i),r=this.alphaTransitionTextures;r&&n._bindTexture("uSampler2",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),this.offsetMatrix.identity();let a=0;t.m_fSwivel&&(this.doSwivel(t,e),a=this.swivel.swivelPercent/10),this.calculateDirection(t,!1,e),this.worldViewMatrix.translationScaling(-.5,0,0,t.m_isInvX?-2:2,2,1),this.worldViewMatrix.setValueAt(15,a+1);const s=this.worldViewMatrix.getValueAt(12)+(t.m_isInvX?a:-a);return this.worldViewMatrix.setValueAt(12,s),n.setFloat("isInvX",t.m_isInvX?1:0),n.setFloat("opacity",1),n.setMatrix("offsetMatrix",this.offsetMatrix),n.setMatrix("dirMatrix",this.dirMatrix),n.setMatrix("uModelViewProj",this.worldViewMatrix),n._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),We(i),this.drawReflection(i,t,!t.forward,e),this.calculateDirection(t,!0,e),n.setFloat("opacity",1),n.setMatrix("offsetMatrix",this.offsetMatrix),n.setMatrix("dirMatrix",this.dirMatrix),n.setMatrix("uModelViewProj",this.worldViewMatrix),n._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),We(i),this.drawReflection(i,t,t.forward,e),!0}drawReflection(e,t,i,n){if(!t.m_fReflection)return;const r=e.shaderProgram;this.reflectionWorldViewMatrix.rotationX(-Math.PI),this.reflectionWorldViewMatrix.multiply(this.reflectionPreTranslationMatrix),this.reflectionWorldViewMatrix.multiply(this.offsetMatrix),this.reflectionWorldViewMatrix.multiply(this.reflectionPostTranslationMatrix),r.setFloat("opacity",1-(t.m_fFadeReflection?n:0)),r.setMatrix("offsetMatrix",this.reflectionWorldViewMatrix),r._bindTexture("uSampler1",i?e.outgoingSlideTexture:e.incomingSlideTexture),r._bindTexture("uSampler2",e.reflectionMask),We(e),r._bindTexture("uSampler2",e.blackTexture)}calculateDirection(e,t,i){let n=i,r=0;e.m_fSwivel&&(n=this.swivel.scaledProgress,r=this.swivel.swivelPercent),n=ee.getScaledProgress(e.motionType,n);let a=16*(e.m_distance/100+.65)/9;a*=t?n:-(1-n),1!==r&&0!==r&&(a+=Math.abs(.5-Math.abs(r-.5))/70),this.dirMatrix.translationColumn(a,0,0)}doSwivel(e,t){let i=t;const n=e.m_swivelTime/100,r=e.m_waitTime/100,a=-e.m_swivelAngle*Math.PI/180,s=e.m_swivelZoom/100;let o,l;i<n+r?(i>n&&(i=n),o=1-(n-i)/n,l=0):i<1-n?(o=1,l=(i-n)/(1-2*n)):(o=(1-i)/n,l=1),this.offsetMatrix.multiply(tt.translation(0,0,o*s)),this.offsetMatrix.multiply(tt.rotationY(o*a)),this.swivel.scaledProgress=l,this.swivel.swivelPercent=o}dispose(){this.alphaTransition&&this.alphaTransition.dispose(),super.dispose()}constructor(){super(...arguments),this.worldViewMatrix=new Ee,this.reflectionWorldViewMatrix=new Ee,this.dirMatrix=new Ee,this.offsetMatrix=new Ee,this.reflectionPreTranslationMatrix=new Ee,this.reflectionPostTranslationMatrix=new Ee,this.swivel={scaledProgress:0,swivelPercent:0}}}class nt extends je{internalInit(e,t,i){if(e.useContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void p("Outgoing textures have not been defined");this.alphaTransition=new Ge(!1),this.alphaTransition.init(e,i),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}this.vRes=e.vres,this.hRes=e.hres,this.zMovement=null!=e.zMovement?e.zMovement:10,this.extraDistance=null!=e.extraDistance?e.extraDistance:0;const n=this.getDrawInfo(R.prism,[Oe,Fe,De,Le],!0);if(!n)return;const r=Re(),a=ke(-.5,-.5,-.5,2,2,1);return r.multiply(a),n.shaderProgram.setMatrix("uModelViewProj",r),n}internalDraw(e,t,i){if(Ue(i.engine,!0,t.useContent,1028),t.useContent){if(!this.alphaTransition)return p("AlphaTransition has not been initialized."),!1;this.alphaTransition.draw(e)}const n=Ve(i),r=3.141592653589793,a=2*r/t.sides,s=t.xAxis?1/this.vRes:1/this.hRes,o=e*((t.delayFormula===c.None?0:1)+a/t.factor+t.jitter/100);let l=s/2*Math.tan((r-a)/2);l*=1+this.extraDistance/100,t.inverse&&(l=-l);const d=this.zMovement/10*l/Math.sin((r-a)/2);return n.setFloat("uFactor",t.factor),n.setFloat("uProgress",o),n.setFloat("uDirection",t.invertDirection?-1:1),n.setFloat("uAnglePlus",0),n.setFloat("uMaxAngle",a),n.setFloat("uZCenter",l),n.setFloat("uZmovement",d),n.setFloat("uXAxis",t.xAxis?1:0),n._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),We(i),n.setFloat("uAnglePlus",-a),n._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),We(i),!0}dispose(){this.alphaTransition&&this.alphaTransition.dispose(),super.dispose()}constructor(){super(...arguments),this.zMovement=0,this.extraDistance=0,this.vRes=0,this.hRes=0}}class rt extends ze{internalInit(e,t,i){e.useContent&&e.incomingSlideForeground&&e.outgoingSlideForeground&&(this.alphaTransition=new Ge(!1),this.alphaTransition.init(e,i),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground);const r=this.getDrawInfo(R.alpha,[Oe,Fe,De]);if(!r)return;const a=r.engine.wrapExternalTexture(e.incomingSlideBackground),s=r.engine.wrapExternalTexture(e.outgoingSlideBackground);switch(this.direction={x:0,y:0},e.direction){case n.Top:this.direction.y=1;break;case n.Bottom:this.direction.y=-1;break;case n.Right:this.direction.x=1;break;case n.Left:default:this.direction.x=-1}return e.forward||(this.direction.x*=-1,this.direction.y*=-1),{...r,incomingSlideTexture:a,outgoingSlideTexture:s}}internalDraw(e,t,i){Ue(i.engine,!1,t.useContent),this.alphaTransition&&this.alphaTransition.draw(e);const n=Ve(i);n.setFloat("uFactor",1),n.setFloat("uStyle",1);const r=i.incomingSlideTexture,a=i.outgoingSlideTexture;n._bindTexture("uSampler1",t.forward?a:r),n._bindTexture("uSampler2",t.forward?r:a);const s=ee.getScaledProgress(J.MotionQuadratic,e);if(!this.direction)return p("Direction undefined"),!1;const o=s*this.direction.x-.5,l=s*this.direction.y-.5,d=(1-s)*-this.direction.x-.5,c=(1-s)*-this.direction.y-.5;return this.modelViewMatrix.translationScaling(o,l,0,2,2,1),n.setMatrix("uModelViewProj",this.modelViewMatrix),n.setFloat("uProgress",0),We(i),this.modelViewMatrix.translationScaling(d,c,0,2,2,1),n.setMatrix("uModelViewProj",this.modelViewMatrix),n.setFloat("uProgress",1),We(i),!0}dispose(){this.alphaTransition&&this.alphaTransition.dispose(),super.dispose()}constructor(){super(...arguments),this.direction={x:0,y:0},this.modelViewMatrix=new Ee}}class at extends je{internalInit(e){e.m_rippleType=e.m_rippleType||h.RippleCenter;const t=this.getDrawInfo(R.ripple,[Oe,Fe,Be],!0);if(!t)return;const i=Ae();return t.shaderProgram.setMatrix("uModelViewProj",i),t}internalDraw(e,t,i){Ue(i.engine);const n=Ve(i);return n.setFloat2("uProgress",3.14159265359*e,e),n._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),n._bindTexture("uSampler2",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),We(i),!0}}class st extends je{internalInit(e){const t=this.getDrawInfo(R.weave,[Oe,Fe,De,Ne]);if(!t)return;const i=Ae();return t.shaderProgram.setMatrix("uModelViewProj",i),this.initModel(e)?t:void 0}internalDraw(e,t,i){Ue(i.engine),super.internalDraw(e,t,i);const n=Ve(i);return n.setFloat("uFactor",t.factor),n.setFloat("uProgress",3*e),n.setFloat("uOpacity",1),n._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),We(i),!0}dispose(){super.dispose()}}class ot extends je{internalInit(){const e=this.getDrawInfo(R.zoomWithSpin,[Oe,Fe,De,Le],!0);if(!e)return;const t=Ae();return e.shaderProgram.setMatrix("uModelViewProj",t),e}internalDraw(e,t,i){Ue(i.engine,!1,!0);const n=Ve(i);return n.setFloat("uFactor",1),n.setFloat("uReverseAngle",-1),n.setFloat("uGrowFactor",0),n.setFloat("uOpacitySpeed",0),n.setFloat("uSpinFactor",0),n.setFloat("uTime",1),n._bindTexture("uSampler",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),We(i),n.setFloat("uOpacitySpeed",3),n.setFloat("uTime",1-e),n.setFloat("uSpinFactor",7),n.setFloat("uGrowFactor",-1),n._bindTexture("uSampler",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),We(i),!0}}class lt extends class{isTransitionDisabled(e,t){return S(this.transitionDisabledList,e,t)}async getTransition(e,t,i,a=new Ie){try{if(S(this.transitionDisabledList,e,t))return X.e.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),{transition:(await this.getTransition(r.PPT_TRANSITION_FADE,t,i,a)).transition,isSupported:!1};let s,o=!0;switch(e){case r.PPT_TRANSITION_WIPE:case r.PPT_TRANSITION_STRIPS:case r.PPT_TRANSITION_SPLIT:case r.PPT_TRANSITION_ZOOM:case r.PPT_TRANSITION_DIAMOND:case r.PPT_TRANSITION_PLUS:case r.PPT_TRANSITION_CIRCLE:case r.PPT_TRANSITION_RANDOMBAR:case r.PPT_TRANSITION_FADE:case r.PPT_TRANSITION_DISSOLVE:case r.PPT_TRANSITION_WHEEL:case r.PPT_TRANSITION_WHEELREVERSE:case r.PPT_TRANSITION_WEDGE:s=this.transactionConstructors.AlphaTransition();break;case r.PPT_TRANSITION_FADE_THROUGH_BLACK:s=this.transactionConstructors.FadeThroughBlackTransition();break;case r.PPT_TRANSITION_PUSH:case r.PPT_TRANSITION_PAN:s=this.transactionConstructors.PushTransition();break;case r.PPT_TRANSITION_COMB:s=this.transactionConstructors.WeaveTransition();break;case r.PPT_TRANSITION_CUT:s=this.transactionConstructors.CutTransition(),t!==n.Top&&(X.e.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),o=!1);break;case r.PPT_TRANSITION_RANDOM:return await this.createRandomTransition(i);case r.PPT_TRANSITION_COVER:case r.PPT_TRANSITION_UNCOVER:s=this.transactionConstructors.CoverTransition();break;case r.PPT_TRANSITION_BLINDS:case r.PPT_TRANSITION_PRISM:s=this.transactionConstructors.PrismTransition();break;case r.PPT_TRANSITION_RIPPLE:s=this.transactionConstructors.RippleTransition();break;case r.PPT_TRANSITION_VORTEX:case r.PPT_TRANSITION_CHECKER:case r.PPT_TRANSITION_GLITTER:s=this.transactionConstructors.BlindsTransition();break;case r.PPT_TRANSITION_ZOOM_WITH_SPIN:s=this.transactionConstructors.ZoomWithSpinTransition();break;case r.PPT_TRANSITION_FLIP:case r.PPT_TRANSITION_SWITCH:case r.PPT_TRANSITION_FALLOVER:case r.PPT_TRANSITION_DRAPE:case r.PPT_TRANSITION_CURTAINS:case r.PPT_TRANSITION_WIND:case r.PPT_TRANSITION_PRESTIGE:case r.PPT_TRANSITION_FRACTURE:case r.PPT_TRANSITION_CRUSH:case r.PPT_TRANSITION_PEELOFF:case r.PPT_TRANSITION_PAGECURLSINGLE:case r.PPT_TRANSITION_PAGECURLDOUBLE:case r.PPT_TRANSITION_AIRPLANE:case r.PPT_TRANSITION_ORIGAMI:s=this.transactionConstructors.CustomTransition();break;case r.PPT_TRANSITION_GALLERY:case r.PPT_TRANSITION_CONVEYOR:s=this.transactionConstructors.GalleryTransition();break;case r.PPT_TRANSITION_CROSSZOOM:s=this.transactionConstructors.CrossZoomTransition();break;case r.PPT_TRANSITION_FLYTHROUGH_CONTENT:case r.PPT_TRANSITION_FLYTHROUGH:s=this.transactionConstructors.FlyThroughTransition();break;case r.PPT_TRANSITION_DOORS_CONTENT:case r.PPT_TRANSITION_DOORS:s=this.transactionConstructors.DoorsTransition();break;default:o=!1,s=this.transactionConstructors.AlphaTransition(),X.e.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0})}const l=await this.transPropertyFactory.getTransitionProperty(e,t,i);return null==l?(X.e.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),{transition:(await this.getTransition(r.PPT_TRANSITION_FADE,t,i)).transition,isSupported:!1}):(s.init(l,a),u.a.sendTraceTag(507331295,m.a.msoulscat_Wac_PptSession,f.a.Info,`TransitionFactory::getTransition: Transition effectId:${e}, isSupported:${o}`),{transition:new Pe(s),isSupported:o})}catch(t){p("Exception at getTransition : "+t),X.e.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!1})}return{transition:void 0,isSupported:!1}}async createRandomTransition(e,t){const i=this.getRandomEffectData();return await this.getTransition(i.effectId,i.direction,e,t)}getRandomEffectData(){const e=[{effectId:r.PPT_TRANSITION_ZOOM,direction:2},{effectId:r.PPT_TRANSITION_WIPE,direction:4},{effectId:r.PPT_TRANSITION_STRIPS,direction:4},{effectId:r.PPT_TRANSITION_RANDOMBAR,direction:2},{effectId:r.PPT_TRANSITION_SPLIT,direction:4},{effectId:r.PPT_TRANSITION_FADE,direction:1},{effectId:r.PPT_TRANSITION_CUT,direction:3},{effectId:r.PPT_TRANSITION_DISSOLVE,direction:1},{effectId:r.PPT_TRANSITION_COVER,direction:8},{effectId:r.PPT_TRANSITION_WHEEL,direction:4},{effectId:r.PPT_TRANSITION_CHECKER,direction:2}];let t=0;for(const i of e)t+=i.direction;let i,n=Math.floor(Math.random()*t);for(i=0;n>=e[i].direction;i+=1)n-=e[i].direction;return{effectId:e[i].effectId,direction:n}}constructor(e){this.transPropertyFactory=new te(e.customTransitionDataLoader),this.transitionDisabledList=e.transitionDisabledList||""}}{constructor(){super(...arguments),this.transactionConstructors={AlphaTransition:()=>new Ge,FadeThroughBlackTransition:()=>new Ke,PushTransition:()=>new rt,WeaveTransition:()=>new st,CutTransition:()=>new Xe,CoverTransition:()=>new qe,PrismTransition:()=>new nt,RippleTransition:()=>new at,ZoomWithSpinTransition:()=>new ot,BlindsTransition:()=>new $e,CustomTransition:()=>new Je,GalleryTransition:()=>new it,CrossZoomTransition:()=>new Ze,FlyThroughTransition:()=>new et,DoorsTransition:()=>new Ye}}}class dt{async load(e){return this.wacCDNPath?this.prefetchTransitionResource(e):null}enableResourceCache(e){this.isCacheEnabled=e,e||(this.m_resourceCache={})}async prefetchTransitionResource(e){try{if(this.isCacheEnabled&&this.m_resourceCache[e])return this.m_resourceCache[e];const t=function(e){let t;switch(e){case r.PPT_TRANSITION_AIRPLANE:t="airplanedata.json";break;case r.PPT_TRANSITION_FLIP:t="flipdata.json";break;case r.PPT_TRANSITION_SWITCH:t="switchdata.json";break;case r.PPT_TRANSITION_FALLOVER:t="falloverdata.json";break;case r.PPT_TRANSITION_DRAPE:t="drapedata.json";break;case r.PPT_TRANSITION_CURTAINS:t="curtainsdata.json";break;case r.PPT_TRANSITION_WIND:t="winddata.json";break;case r.PPT_TRANSITION_PRESTIGE:t="prestigedata.json";break;case r.PPT_TRANSITION_FRACTURE:t="fracturedata.json";break;case r.PPT_TRANSITION_CRUSH:t="crushdata.json";break;case r.PPT_TRANSITION_PEELOFF:t="peeloffdata.json";break;case r.PPT_TRANSITION_PAGECURLSINGLE:t="pagecurlsingledata.json";break;case r.PPT_TRANSITION_PAGECURLDOUBLE:t="pagecurldoubledata.json";break;case r.PPT_TRANSITION_ORIGAMI:t="origamidata.json";break;default:return null}return t}(e);if(!t)return null;const i=performance.now(),n=this.wacCDNPath+t,a=await fetch(n),s=await a.json();this.isCacheEnabled&&(this.m_resourceCache[e]=s);const o=performance.now();return u.a.sendTraceTag(506987909,m.a.msoulscat_Wac_PptSession,f.a.Info,`TransitionResourceLoader::prefetchTransitionResource transitionID:${e}, resourceLoadTime:${o-i}`),s}catch(t){p(`Exception at prefetchTransitionResource : ${t} for transitionID:${e}`)}}constructor(e,t){this.m_resourceCache={},this.isCacheEnabled=t||!1,this.wacCDNPath=e}}},,function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return s}));const n="Office.System.PrivacyConcern",r="cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521";function a(){return"undefined"==typeof performance||void 0===performance.now?0:performance.now()}function s(e){if(null!==e)return e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i(40),r=i(41),a=i(51),s=i(144),o=i(145),l=i(152),d=i(98),c=i(97),h=i(103),u=i(55),m=i(80),f=i(67),p=i(82);class g{}class _ extends c.a{get name(){return this._name}set name(e){this._name=e}get version(){return this._webGLVersion}static get ShadersRepository(){return m.a.ShadersRepository}static set ShadersRepository(e){m.a.ShadersRepository=e}get supportsUniformBuffers(){return this.webGLVersion>1&&!this.disableUniformBuffers}get needPOTTextures(){return this._webGLVersion<2||this.forcePOTTextures}get _supportsHardwareTextureRescaling(){return!1}set framebufferDimensionsObject(e){this._framebufferDimensionsObject=e}snapshotRenderingReset(){this.snapshotRendering=!1}_clearEmptyResources(){this._dummyFramebuffer=null,super._clearEmptyResources()}_getShaderProcessingContext(e){return null}areAllEffectsReady(){for(const e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0}_initGLContext(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),supportFloatTexturesResolve:!1,rg11b10ufColorRenderable:!1,colorBufferHalfFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_half_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),texelFetch:1!==this._webGLVersion,blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS):128,disableMorphTargetTexture:!1},this._caps.supportFloatTexturesResolve=this._caps.colorBufferFloat,this._caps.rg11b10ufColorRenderable=this._caps.colorBufferFloat,this._glVersion=this._gl.getParameter(this._gl.VERSION);const e=this._gl.getExtension("WEBGL_debug_renderer_info");var t;if(null!=e&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=(null!==(t=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT))&&void 0!==t?t:0)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=null!==this._maxMSAASamplesOverride?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else{const e=this._gl.getExtension("WEBGL_draw_buffers");if(null!==e){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=e.drawBuffersWEBGL.bind(e),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(let t=0;t<16;t++)this._gl["COLOR_ATTACHMENT"+t+"_WEBGL"]=e["COLOR_ATTACHMENT"+t+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{const e=this._gl.getExtension("WEBGL_depth_texture");null!=e&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=e.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{const e=this._gl.getExtension("OES_vertex_array_object");null!=e&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=e.createVertexArrayOES.bind(e),this._gl.bindVertexArray=e.bindVertexArrayOES.bind(e),this._gl.deleteVertexArray=e.deleteVertexArrayOES.bind(e))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{const e=this._gl.getExtension("ANGLE_instanced_arrays");null!=e?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=e.drawArraysInstancedANGLE.bind(e),this._gl.drawElementsInstanced=e.drawElementsInstancedANGLE.bind(e),this._gl.vertexAttribDivisor=e.vertexAttribDivisorANGLE.bind(e)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){const e=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),t=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);e&&t&&(this._caps.highPrecisionShaderSupported=0!==e.precision&&0!==t.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{const e=this._gl.getExtension("EXT_blend_minmax");null!=e&&(this._caps.blendMinMax=!0,this._gl.MAX=e.MAX_EXT,this._gl.MIN=e.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:WebGL2RenderingContext.SRGB,SRGB8:WebGL2RenderingContext.SRGB8,SRGB8_ALPHA8:WebGL2RenderingContext.SRGB8_ALPHA8};else{const e=this._gl.getExtension("EXT_sRGB");null!=e&&(this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:e.SRGB_EXT,SRGB8:e.SRGB_ALPHA_EXT,SRGB8_ALPHA8:e.SRGB_ALPHA_EXT})}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(let e=0;e<this._maxSimultaneousTextures;e++)this._nextFreeTextureSlots.push(e);"Mali-G72"===this._glRenderer&&(this._caps.disableMorphTargetTexture=!0)}_initFeatures(){this._features={forceBitmapOverHTMLImageElement:"undefined"==typeof HTMLImageElement,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,forceVertexBufferStrideAndOffsetMultiple4Bytes:!1,_checkNonFloatVertexBuffersDontRecreatePipelineContext:!1,_collectUbosUpdatedInFrame:!1}}get webGLVersion(){return this._webGLVersion}getClassName(){return"ThinEngine"}_prepareWorkingCanvas(){if(this._workingCanvas)return;this._workingCanvas=this.createCanvas(1,1);const e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}getInfo(){return this.getGlInfo()}getGlInfo(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}}extractDriverInfo(){const e=this.getGlInfo();return e&&e.renderer?e.renderer:""}getRenderWidth(e=!1){return!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth}getRenderHeight(e=!1){return!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight}clear(e,t,i,n=!1){const r=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=r;let a=0;if(t&&e){let t=!0;if(this._currentRenderTarget){var s;const i=null===(s=this._currentRenderTarget.texture)||void 0===s?void 0:s.format;if(8===i||9===i||10===i||11===i){var o;const i=null===(o=this._currentRenderTarget.texture)||void 0===o?void 0:o.type;7===i||5===i?(_._TempClearColorUint32[0]=255*e.r,_._TempClearColorUint32[1]=255*e.g,_._TempClearColorUint32[2]=255*e.b,_._TempClearColorUint32[3]=255*e.a,this._gl.clearBufferuiv(this._gl.COLOR,0,_._TempClearColorUint32),t=!1):(_._TempClearColorInt32[0]=255*e.r,_._TempClearColorInt32[1]=255*e.g,_._TempClearColorInt32[2]=255*e.b,_._TempClearColorInt32[3]=255*e.a,this._gl.clearBufferiv(this._gl.COLOR,0,_._TempClearColorInt32),t=!1)}}t&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),a|=this._gl.COLOR_BUFFER_BIT)}i&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),a|=this._gl.DEPTH_BUFFER_BIT),n&&(this._gl.clearStencil(0),a|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(a)}_viewport(e,t,i,n){e===this._viewportCached.x&&t===this._viewportCached.y&&i===this._viewportCached.z&&n===this._viewportCached.w||(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=i,this._viewportCached.w=n,this._gl.viewport(e,t,i,n))}endFrame(){super.endFrame(),this._badOS&&this.flushFramebuffer()}get performanceMonitor(){throw new Error("Not Supported by ThinEngine")}bindFramebuffer(e,t=0,i,n,a,s=0,o=0){const l=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(l._MSAAFramebuffer?l._MSAAFramebuffer:l._framebuffer);const d=this._gl;var c;if(!e.isMulti)if(e.is2DArray||e.is3D)d.framebufferTextureLayer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,null===(c=e.texture._hardwareTexture)||void 0===c?void 0:c.underlyingResource,s,o);else if(e.isCube){var h;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(h=e.texture._hardwareTexture)||void 0===h?void 0:h.underlyingResource,s)}else if(l._currentLOD!==s){var u;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null===(u=e.texture._hardwareTexture)||void 0===u?void 0:u.underlyingResource,s),l._currentLOD=s}const m=e._depthStencilTexture;if(m){e.is3D&&(e.texture.width===m.width&&e.texture.height===m.height&&e.texture.depth===m.depth||r.a.Warn("Depth/Stencil attachment for 3D target must have same dimensions as color attachment"));const i=e._depthStencilTextureWithStencil?d.DEPTH_STENCIL_ATTACHMENT:d.DEPTH_ATTACHMENT;var f;if(e.is2DArray||e.is3D)d.framebufferTextureLayer(d.FRAMEBUFFER,i,null===(f=m._hardwareTexture)||void 0===f?void 0:f.underlyingResource,s,o);else if(e.isCube){var p;d.framebufferTexture2D(d.FRAMEBUFFER,i,d.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(p=m._hardwareTexture)||void 0===p?void 0:p.underlyingResource,s)}else{var g;d.framebufferTexture2D(d.FRAMEBUFFER,i,d.TEXTURE_2D,null===(g=m._hardwareTexture)||void 0===g?void 0:g.underlyingResource,s)}}this._cachedViewport&&!a?this.setViewport(this._cachedViewport,i,n):(i||(i=e.width,s&&(i/=Math.pow(2,s))),n||(n=e.height,s&&(n/=Math.pow(2,s))),this._viewport(0,0,i,n)),this.wipeCaches()}setState(e,t=0,i,n=!1,r,a,s=0){var o,l;(this._depthCullingState.cull!==e||i)&&(this._depthCullingState.cull=e);const d=null===(o=null!==(l=this.cullBackFaces)&&void 0!==l?l:r)||void 0===o||o?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==d||i)&&(this._depthCullingState.cullFace=d),this.setZOffset(t),this.setZOffsetUnits(s);const c=n?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==c||i)&&(this._depthCullingState.frontFace=c),this._stencilStateComposer.stencilMaterial=a}_bindUnboundFramebuffer(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)}_currentFrameBufferIsDefaultFrameBuffer(){return null===this._currentFramebuffer}generateMipmaps(e){const t=this._getTextureTarget(e);this._bindTextureDirectly(t,e,!0),this._gl.generateMipmap(t),this._bindTextureDirectly(t,null)}unBindFramebuffer(e,t=!1,i){var n;const r=e;this._currentRenderTarget=null;const a=this._gl;if(r._MSAAFramebuffer){if(e.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(e,t,i);a.bindFramebuffer(a.READ_FRAMEBUFFER,r._MSAAFramebuffer),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,r._framebuffer),a.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,a.COLOR_BUFFER_BIT,a.NEAREST)}null===(n=e.texture)||void 0===n||!n.generateMipMaps||t||e.isCube||this.generateMipmaps(e.texture),i&&(r._MSAAFramebuffer&&this._bindUnboundFramebuffer(r._framebuffer),i()),this._bindUnboundFramebuffer(null)}flushFramebuffer(){this._gl.flush()}restoreDefaultFramebuffer(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()}_resetVertexBufferBinding(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null}createVertexBuffer(e,t,i){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)}_createVertexBuffer(e,t){const i=this._gl.createBuffer();if(!i)throw new Error("Unable to create vertex buffer");const n=new l.a(i);return this.bindArrayBuffer(n),"number"!=typeof e?e instanceof Array?(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t),n.capacity=4*e.length):(this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),n.capacity=e.byteLength):(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Uint8Array(e),t),n.capacity=e),this._resetVertexBufferBinding(),n.references=1,n}createDynamicVertexBuffer(e,t){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)}_resetIndexBufferBinding(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null}createIndexBuffer(e,t,i){const n=this._gl.createBuffer(),r=new l.a(n);if(!n)throw new Error("Unable to create index buffer");this.bindIndexBuffer(r);const a=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),r.references=1,r.is32Bits=4===a.BYTES_PER_ELEMENT,r}_normalizeIndexData(e){if(2===e.BYTES_PER_ELEMENT)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(let t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)}bindArrayBuffer(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)}bindUniformBlock(e,t,i){const n=e.program,r=this._gl.getUniformBlockIndex(n,t);this._gl.uniformBlockBinding(n,r,i)}bindIndexBuffer(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)}_bindBuffer(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)}updateArrayBuffer(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)}_vertexAttribPointer(e,t,i,n,r,a,s){const o=this._currentBufferPointers[t];if(!o)return;let l=!1;o.active?(o.buffer!==e&&(o.buffer=e,l=!0),o.size!==i&&(o.size=i,l=!0),o.type!==n&&(o.type=n,l=!0),o.normalized!==r&&(o.normalized=r,l=!0),o.stride!==a&&(o.stride=a,l=!0),o.offset!==s&&(o.offset=s,l=!0)):(l=!0,o.active=!0,o.index=t,o.size=i,o.type=n,o.normalized=r,o.stride=a,o.offset=s,o.buffer=e),(l||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),n===this._gl.UNSIGNED_INT||n===this._gl.INT?this._gl.vertexAttribIPointer(t,i,n,a,s):this._gl.vertexAttribPointer(t,i,n,r,a,s))}_bindIndexBufferWithCache(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)}_bindVertexBuffersAttributes(e,t,i){const n=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(let r=0;r<n.length;r++){const a=t.getAttributeLocation(r);if(a>=0){const t=n[r];let s=null;if(i&&(s=i[t]),s||(s=e[t]),!s)continue;this._gl.enableVertexAttribArray(a),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[a]=!0);const o=s.getBuffer();o&&(this._vertexAttribPointer(o,a,s.getSize(),s.type,s.normalized,s.byteStride,s.byteOffset),s.getIsInstanced()&&(this._gl.vertexAttribDivisor(a,s.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(a),this._currentInstanceBuffers.push(o))))}}}recordVertexArrayObject(e,t,i,n){const r=this._gl.createVertexArray();if(!r)throw new Error("Unable to create VAO");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(r),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,i,n),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),r}bindVertexArrayObject(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)}bindBuffersDirectly(e,t,i,n,r){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==r){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=r;const t=r.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();let a=0;for(let s=0;s<t;s++)if(s<i.length){const t=r.getAttributeLocation(s);t>=0&&(this._gl.enableVertexAttribArray(t),this._vertexAttribArraysEnabled[t]=!0,this._vertexAttribPointer(e,t,i[s],this._gl.FLOAT,!1,n,a)),a+=4*i[s]}}this._bindIndexBufferWithCache(t)}_unbindVertexArrayObject(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))}bindBuffers(e,t,i,n){this._cachedVertexBuffers===e&&this._cachedEffectForVertexBuffers===i||(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i,this._bindVertexBuffersAttributes(e,i,n)),this._bindIndexBufferWithCache(t)}unbindInstanceAttributes(){let e;for(let t=0,i=this._currentInstanceLocations.length;t<i;t++){const i=this._currentInstanceBuffers[t];e!=i&&i.references&&(e=i,this.bindArrayBuffer(i));const n=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(n,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0}releaseVertexArrayObject(e){this._gl.deleteVertexArray(e)}_releaseBuffer(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)}_deleteBuffer(e){this._gl.deleteBuffer(e.underlyingResource)}updateAndBindInstancesBuffer(e,t,i){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==i[0].index)this.bindInstancesBuffer(e,i,!0);else for(let t=0;t<4;t++){const n=i[t];this._vertexAttribArraysEnabled[n]||(this._gl.enableVertexAttribArray(n),this._vertexAttribArraysEnabled[n]=!0),this._vertexAttribPointer(e,n,4,this._gl.FLOAT,!1,64,16*t),this._gl.vertexAttribDivisor(n,1),this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(e)}}bindInstancesBuffer(e,t,i=!0){this.bindArrayBuffer(e);let n=0;if(i)for(let e=0;e<t.length;e++)n+=4*t[e].attributeSize;for(let i=0;i<t.length;i++){const r=t[i];void 0===r.index&&(r.index=this._currentEffect.getAttributeLocationByName(r.attributeName)),r.index<0||(this._vertexAttribArraysEnabled[r.index]||(this._gl.enableVertexAttribArray(r.index),this._vertexAttribArraysEnabled[r.index]=!0),this._vertexAttribPointer(e,r.index,r.attributeSize,r.attributeType||this._gl.FLOAT,r.normalized||!1,n,r.offset),this._gl.vertexAttribDivisor(r.index,void 0===r.divisor?1:r.divisor),this._currentInstanceLocations.push(r.index),this._currentInstanceBuffers.push(e))}}disableInstanceAttributeByName(e){if(!this._currentEffect)return;const t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}disableInstanceAttribute(e){let t,i=!1;for(;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),i=!0,t=this._currentInstanceLocations.indexOf(e);i&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))}disableAttributeByIndex(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1}draw(e,t,i,n){this.drawElementsType(e?0:1,t,i,n)}drawPointClouds(e,t,i){this.drawArraysType(2,e,t,i)}drawUnIndexed(e,t,i,n){this.drawArraysType(e?0:1,t,i,n)}drawElementsType(e,t,i,n){this.applyStates(),this._reportDrawCall();const r=this._drawMode(e),a=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,s=this._uintIndicesCurrentlySet?4:2;n?this._gl.drawElementsInstanced(r,i,a,t*s,n):this._gl.drawElements(r,i,a,t*s)}drawArraysType(e,t,i,n){this.applyStates(),this._reportDrawCall();const r=this._drawMode(e);n?this._gl.drawArraysInstanced(r,t,i,n):this._gl.drawArrays(r,t,i)}_drawMode(e){switch(e){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}}_releaseEffect(e){this._compiledEffects[e._key]&&delete this._compiledEffects[e._key];const t=e.getPipelineContext();t&&this._deletePipelineContext(t)}_deletePipelineContext(e){const t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,Object(p.d)(t),this._gl.deleteProgram(t.program))}_getGlobalDefines(e){return Object(f.c)(e,this.isNDCHalfZRange,this.useReverseDepthBuffer,this.useExactSrgbConversions)}createEffect(e,t,i,r,a,s,o,l,d,c=0){var h,u;const f="string"==typeof e?e:e.vertexToken||e.vertexSource||e.vertexElement||e.vertex,p="string"==typeof e?e:e.fragmentToken||e.fragmentSource||e.fragmentElement||e.fragment,g=this._getGlobalDefines();let _=null!==(h=null!=a?a:t.defines)&&void 0!==h?h:"";g&&(_+=g);const S=f+"+"+p+"@"+_;if(this._compiledEffects[S]){const e=this._compiledEffects[S];return o&&e.isReady()&&o(e),e}this._gl&&Object(n.j)(this._gl);const v=new m.a(e,t,i,r,this,a,s,o,l,d,S,null!==(u=t.shaderLanguage)&&void 0!==u?u:c);return this._compiledEffects[S]=v,v}_getShaderSource(e){return this._gl.getShaderSource(e)}createRawShaderProgram(e,t,i,r,a=null){const s=Object(n.j)(this._gl);return s._contextWasLost=this._contextWasLost,s.validateShaderPrograms=this.validateShaderPrograms,Object(n.g)(e,t,i,r||this._gl,a)}createShaderProgram(e,t,i,r,a,s=null){const o=Object(n.j)(this._gl);return o._contextWasLost=this._contextWasLost,o.validateShaderPrograms=this.validateShaderPrograms,Object(n.h)(e,t,i,r,a||this._gl,s)}inlineShaderCode(e){return e}createPipelineContext(e){this._gl&&(Object(n.j)(this._gl).parallelShaderCompile=this._caps.parallelShaderCompile);const t=Object(n.f)(this._gl,e);return t.engine=this,t}createMaterialContext(){}createDrawContext(){}_finalizePipelineContext(e){return Object(n.c)(e,this._gl,this.validateShaderPrograms)}_preparePipelineContext(e,t,i,r,a,s,o,l,d,c,h){const u=Object(n.j)(this._gl);return u._contextWasLost=this._contextWasLost,u.validateShaderPrograms=this.validateShaderPrograms,u._createShaderProgramInjection=this._createShaderProgram.bind(this),u.createRawShaderProgramInjection=this.createRawShaderProgram.bind(this),u.createShaderProgramInjection=this.createShaderProgram.bind(this),u.loadFileInjection=this._loadFile.bind(this),Object(n.d)(e,t,i,r,a,s,o,l,d,c,h)}_createShaderProgram(e,t,i,r,a=null){return Object(n.a)(e,t,i,r,a)}_isRenderingStateCompiled(e){const t=e;return!(this._isDisposed||t._isDisposed||!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)||(this._finalizePipelineContext(t),0))}_executeWhenRenderingStateIsCompiled(e,t){Object(n.b)(e,t)}getUniforms(e,t){const i=new Array,n=e;for(let e=0;e<t.length;e++)i.push(this._gl.getUniformLocation(n.program,t[e]));return i}getAttributes(e,t){const i=[],n=e;for(let e=0;e<t.length;e++)try{i.push(this._gl.getAttribLocation(n.program,t[e]))}catch(e){i.push(-1)}return i}enableEffect(e){(e=null!==e&&function(e){return void 0===e.getPipelineContext}(e)?e.effect:e)&&e!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,e=e,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))}setInt(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)}setInt2(e,t,i){return!!e&&(this._gl.uniform2i(e,t,i),!0)}setInt3(e,t,i,n){return!!e&&(this._gl.uniform3i(e,t,i,n),!0)}setInt4(e,t,i,n,r){return!!e&&(this._gl.uniform4i(e,t,i,n,r),!0)}setIntArray(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)}setIntArray2(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2iv(e,t),0))}setIntArray3(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3iv(e,t),0))}setIntArray4(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4iv(e,t),0))}setUInt(e,t){return!!e&&(this._gl.uniform1ui(e,t),!0)}setUInt2(e,t,i){return!!e&&(this._gl.uniform2ui(e,t,i),!0)}setUInt3(e,t,i,n){return!!e&&(this._gl.uniform3ui(e,t,i,n),!0)}setUInt4(e,t,i,n,r){return!!e&&(this._gl.uniform4ui(e,t,i,n,r),!0)}setUIntArray(e,t){return!!e&&(this._gl.uniform1uiv(e,t),!0)}setUIntArray2(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2uiv(e,t),0))}setUIntArray3(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3uiv(e,t),0))}setUIntArray4(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4uiv(e,t),0))}setArray(e,t){return!(!e||t.length<1||(this._gl.uniform1fv(e,t),0))}setArray2(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2fv(e,t),0))}setArray3(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3fv(e,t),0))}setArray4(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4fv(e,t),0))}setMatrices(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)}setMatrix3x3(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)}setMatrix2x2(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)}setFloat(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)}setFloat2(e,t,i){return!!e&&(this._gl.uniform2f(e,t,i),!0)}setFloat3(e,t,i,n){return!!e&&(this._gl.uniform3f(e,t,i,n),!0)}setFloat4(e,t,i,n,r){return!!e&&(this._gl.uniform4f(e,t,i,n,r),!0)}applyStates(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;const e=this._colorWrite;this._gl.colorMask(e,e,e,e)}}wipeCaches(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))}_getSamplingParameters(e,t){const i=this._gl;let n=i.NEAREST,r=i.NEAREST;switch(e){case 11:n=i.LINEAR,r=t?i.LINEAR_MIPMAP_NEAREST:i.LINEAR;break;case 3:n=i.LINEAR,r=t?i.LINEAR_MIPMAP_LINEAR:i.LINEAR;break;case 8:n=i.NEAREST,r=t?i.NEAREST_MIPMAP_LINEAR:i.NEAREST;break;case 4:n=i.NEAREST,r=t?i.NEAREST_MIPMAP_NEAREST:i.NEAREST;break;case 5:n=i.NEAREST,r=t?i.LINEAR_MIPMAP_NEAREST:i.LINEAR;break;case 6:n=i.NEAREST,r=t?i.LINEAR_MIPMAP_LINEAR:i.LINEAR;break;case 7:n=i.NEAREST,r=i.LINEAR;break;case 1:n=i.NEAREST,r=i.NEAREST;break;case 9:n=i.LINEAR,r=t?i.NEAREST_MIPMAP_NEAREST:i.NEAREST;break;case 10:n=i.LINEAR,r=t?i.NEAREST_MIPMAP_LINEAR:i.NEAREST;break;case 2:n=i.LINEAR,r=i.LINEAR;break;case 12:n=i.LINEAR,r=i.NEAREST}return{min:r,mag:n}}_createTexture(){const e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e}_createHardwareTexture(){return new h.a(this._createTexture(),this._gl)}_createInternalTexture(e,t,i=!0,n=0){let a,s=!1,o=0,l=3,d=5,c=!1,h=1;var m;void 0!==t&&"object"==typeof t?(s=!!t.generateMipMaps,o=void 0===t.type?0:t.type,l=void 0===t.samplingMode?3:t.samplingMode,d=void 0===t.format?5:t.format,c=void 0!==t.useSRGBBuffer&&t.useSRGBBuffer,h=null!==(m=t.samples)&&void 0!==m?m:1,a=t.label):s=!!t,c&&(c=this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU)),(1!==o||this._caps.textureFloatLinearFiltering)&&(2!==o||this._caps.textureHalfFloatLinearFiltering)||(l=1),1!==o||this._caps.textureFloat||(o=0,r.a.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));const f=this._gl,p=new u.a(this,n),g=e.width||e,_=e.height||e,S=e.depth||0,v=e.layers||0,y=this._getSamplingParameters(l,s),T=0!==v?f.TEXTURE_2D_ARRAY:0!==S?f.TEXTURE_3D:f.TEXTURE_2D,b=this._getRGBABufferInternalSizedFormat(o,d,c),w=this._getInternalFormat(d),C=this._getWebGLTextureType(o);return this._bindTextureDirectly(T,p),0!==v?(p.is2DArray=!0,f.texImage3D(T,0,b,g,_,v,0,w,C,null)):0!==S?(p.is3D=!0,f.texImage3D(T,0,b,g,_,S,0,w,C,null)):f.texImage2D(T,0,b,g,_,0,w,C,null),f.texParameteri(T,f.TEXTURE_MAG_FILTER,y.mag),f.texParameteri(T,f.TEXTURE_MIN_FILTER,y.min),f.texParameteri(T,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(T,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),s&&this._gl.generateMipmap(T),this._bindTextureDirectly(T,null),p._useSRGBBuffer=c,p.baseWidth=g,p.baseHeight=_,p.width=g,p.height=_,p.depth=v,p.isReady=!0,p.samples=h,p.generateMipMaps=s,p.samplingMode=l,p.type=o,p.format=d,p.label=a,this._internalTexturesCache.push(p),p}_getUseSRGBBuffer(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||t)}createTexture(e,t,i,n,r=3,a=null,s=null,o=null,l=null,d=null,c=null,h,m,f,p){return this._createTextureBase(e,t,i,n,r,a,s,(...e)=>this._prepareWebGLTexture(...e,d),(e,t,i,r,a,s)=>{const o=this._gl,l=i.width===e&&i.height===t;a._creationFlags=null!=f?f:0;const d=this._getTexImageParametersForCreateTexture(a.format,a._useSRGBBuffer);if(l)return o.texImage2D(o.TEXTURE_2D,0,d.internalFormat,d.format,d.type,i),!1;const c=this._caps.maxTextureSize;if(i.width>c||i.height>c||!this._supportsHardwareTextureRescaling)return this._prepareWorkingCanvas(),!(!this._workingCanvas||!this._workingContext||(this._workingCanvas.width=e,this._workingCanvas.height=t,this._workingContext.drawImage(i,0,0,i.width,i.height,0,0,e,t),o.texImage2D(o.TEXTURE_2D,0,d.internalFormat,d.format,d.type,this._workingCanvas),a.width=e,a.height=t,1));{const e=new u.a(this,2);this._bindTextureDirectly(o.TEXTURE_2D,e,!0),o.texImage2D(o.TEXTURE_2D,0,d.internalFormat,d.format,d.type,i),this._rescaleTexture(e,a,n,d.format,()=>{this._releaseTexture(e),this._bindTextureDirectly(o.TEXTURE_2D,a,!0),s()})}return!0},o,l,d,c,h,m,p)}_getTexImageParametersForCreateTexture(e,t){let i,n;return 1===this.webGLVersion?(i=this._getInternalFormat(e,t),n=i):(i=this._getInternalFormat(e,!1),n=this._getRGBABufferInternalSizedFormat(0,e,t)),{internalFormat:n,format:i,type:this._gl.UNSIGNED_BYTE}}_rescaleTexture(e,t,i,n,r){}_unpackFlipY(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))}_getUnpackAlignement(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)}_getTextureTarget(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D}updateTextureSamplingMode(e,t,i=!1){const n=this._getTextureTarget(t),r=this._getSamplingParameters(e,t.useMipMaps||i);this._setTextureParameterInteger(n,this._gl.TEXTURE_MAG_FILTER,r.mag,t),this._setTextureParameterInteger(n,this._gl.TEXTURE_MIN_FILTER,r.min),i&&(t.generateMipMaps=!0,this._gl.generateMipmap(n)),this._bindTextureDirectly(n,null),t.samplingMode=e}updateTextureDimensions(e,t,i,n=1){}updateTextureWrappingMode(e,t,i=null,n=null){const r=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(r,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==i&&(this._setTextureParameterInteger(r,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(i),e),e._cachedWrapV=i),(e.is2DArray||e.is3D)&&null!==n&&(this._setTextureParameterInteger(r,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(n),e),e._cachedWrapR=n),this._bindTextureDirectly(r,null)}_uploadCompressedDataToTextureDirectly(e,t,i,n,r,a=0,s=0){const o=this._gl;let l=o.TEXTURE_2D;if(e.isCube&&(l=o.TEXTURE_CUBE_MAP_POSITIVE_X+a),e._useSRGBBuffer)switch(t){case 37492:case 36196:this._caps.etc2?t=o.COMPRESSED_SRGB8_ETC2:e._useSRGBBuffer=!1;break;case 37496:this._caps.etc2?t=o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:e._useSRGBBuffer=!1;break;case 36492:t=o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:t=o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?t=o.COMPRESSED_SRGB_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33777:this._caps.s3tc_srgb?t=o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?t=o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(l,s,t,i,n,0,r)}_uploadDataToTextureDirectly(e,t,i=0,n=0,r,a=!1){const s=this._gl,o=this._getWebGLTextureType(e.type),l=this._getInternalFormat(e.format),d=void 0===r?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(r,e._useSRGBBuffer);this._unpackFlipY(e.invertY);let c=s.TEXTURE_2D;e.isCube&&(c=s.TEXTURE_CUBE_MAP_POSITIVE_X+i);const h=Math.round(Math.log(e.width)*Math.LOG2E),u=Math.round(Math.log(e.height)*Math.LOG2E),m=a?e.width:Math.pow(2,Math.max(h-n,0)),f=a?e.height:Math.pow(2,Math.max(u-n,0));s.texImage2D(c,n,d,m,f,0,l,o,t)}updateTextureData(e,t,i,n,r,a,s=0,o=0,l=!1){const d=this._gl,c=this._getWebGLTextureType(e.type),h=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);let u=d.TEXTURE_2D,m=d.TEXTURE_2D;e.isCube&&(m=d.TEXTURE_CUBE_MAP_POSITIVE_X+s,u=d.TEXTURE_CUBE_MAP),this._bindTextureDirectly(u,e,!0),d.texSubImage2D(m,o,i,n,r,a,h,c,t),l&&this._gl.generateMipmap(m),this._bindTextureDirectly(u,null)}_uploadArrayBufferViewToTexture(e,t,i=0,n=0){const r=this._gl,a=e.isCube?r.TEXTURE_CUBE_MAP:r.TEXTURE_2D;this._bindTextureDirectly(a,e,!0),this._uploadDataToTextureDirectly(e,t,i,n),this._bindTextureDirectly(a,null,!0)}_prepareWebGLTextureContinuation(e,t,i,n,r){const a=this._gl;if(!a)return;const s=this._getSamplingParameters(r,!i);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,s.mag),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,s.min),i||n||a.generateMipmap(a.TEXTURE_2D),this._bindTextureDirectly(a.TEXTURE_2D,null),t&&t.removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}_prepareWebGLTexture(e,t,i,n,r,a,s,o,l,c){const h=this.getCaps().maxTextureSize,u=Math.min(h,this.needPOTTextures?Object(d.c)(n.width,h):n.width),m=Math.min(h,this.needPOTTextures?Object(d.c)(n.height,h):n.height),f=this._gl;f&&(e._hardwareTexture?(this._bindTextureDirectly(f.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===r||!!r),e.baseWidth=n.width,e.baseHeight=n.height,e.width=u,e.height=m,e.isReady=!0,e.type=-1!==e.type?e.type:0,e.format=-1!==e.format?e.format:null!=c?c:".jpg"!==t||e._useSRGBBuffer?5:4,o(u,m,n,t,e,()=>{this._prepareWebGLTextureContinuation(e,i,a,s,l)})||this._prepareWebGLTextureContinuation(e,i,a,s,l)):i&&i.removePendingData(e))}_setupFramebufferDepthAttachments(e,t,i,n,r=1){const a=this._gl;if(e&&t)return this._createRenderBuffer(i,n,r,a.DEPTH_STENCIL,a.DEPTH24_STENCIL8,a.DEPTH_STENCIL_ATTACHMENT);if(t){let e=a.DEPTH_COMPONENT16;return this._webGLVersion>1&&(e=a.DEPTH_COMPONENT32F),this._createRenderBuffer(i,n,r,e,e,a.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(i,n,r,a.STENCIL_INDEX8,a.STENCIL_INDEX8,a.STENCIL_ATTACHMENT):null}_createRenderBuffer(e,t,i,n,r,a,s=!0){const o=this._gl.createRenderbuffer();return this._updateRenderBuffer(o,e,t,i,n,r,a,s)}_updateRenderBuffer(e,t,i,n,r,a,s,o=!0){const l=this._gl;return l.bindRenderbuffer(l.RENDERBUFFER,e),n>1&&l.renderbufferStorageMultisample?l.renderbufferStorageMultisample(l.RENDERBUFFER,n,a,t,i):l.renderbufferStorage(l.RENDERBUFFER,r,t,i),l.framebufferRenderbuffer(l.FRAMEBUFFER,s,l.RENDERBUFFER,e),o&&l.bindRenderbuffer(l.RENDERBUFFER,null),e}_releaseTexture(e){this._deleteTexture(e._hardwareTexture),this.unbindAllTextures();const t=this._internalTexturesCache.indexOf(e);-1!==t&&this._internalTexturesCache.splice(t,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()}_deleteTexture(e){null==e||e.release()}_setProgram(e){this._currentProgram!==e&&(Object(n.e)(e,this._gl),this._currentProgram=e)}bindSamplers(e){const t=e.getPipelineContext();this._setProgram(t.program);const i=e.getSamplers();for(let t=0;t<i.length;t++){const n=e.getUniform(i[t]);n&&(this._boundUniforms[t]=n)}this._currentEffect=null}_activateCurrentTexture(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)}_bindTextureDirectly(e,t,i=!1,n=!1){let a=!1;const s=t&&t._associatedChannel>-1;if(i&&s&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||n){if(this._activateCurrentTexture(),t&&t.isMultiview)throw r.a.Error(["_bindTextureDirectly called with a multiview texture!",e,t]),"_bindTextureDirectly called with a multiview texture!";var o,l;this._gl.bindTexture(e,null!==(o=null==t||null===(l=t._hardwareTexture)||void 0===l?void 0:l.underlyingResource)&&void 0!==o?o:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else i&&(a=!0,this._activateCurrentTexture());return s&&!i&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),a}_bindTexture(e,t,i){if(void 0===e)return;t&&(t._associatedChannel=e),this._activeChannel=e;const n=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(n,t)}unbindAllTextures(){for(let e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))}setTexture(e,t,i,n){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,i))}_bindSamplerUniformToChannel(e,t){const i=this._boundUniforms[e];i&&i._currentState!==t&&(this._gl.uniform1i(i,t),i._currentState=t)}_getTextureWrapMode(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT}_setTexture(e,t,i=!1,n=!1,r=""){if(!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video){this._activeChannel=e;const i=t.getInternalTexture();i&&(i._associatedChannel=e),t.update()}else if(4===t.delayLoadState)return t.delayLoad(),!1;let a;a=n?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!i&&a&&(a._associatedChannel=e);let s=!0;this._boundTexturesCache[e]===a&&(i||this._bindSamplerUniformToChannel(a._associatedChannel,e),s=!1),this._activeChannel=e;const o=this._getTextureTarget(a);if(s&&this._bindTextureDirectly(o,a,i),a&&!a.isMultiview){if(a.isCube&&a._cachedCoordinatesMode!==t.coordinatesMode){a._cachedCoordinatesMode=t.coordinatesMode;const e=3!==t.coordinatesMode&&5!==t.coordinatesMode?1:0;t.wrapU=e,t.wrapV=e}a._cachedWrapU!==t.wrapU&&(a._cachedWrapU=t.wrapU,this._setTextureParameterInteger(o,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),a)),a._cachedWrapV!==t.wrapV&&(a._cachedWrapV=t.wrapV,this._setTextureParameterInteger(o,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),a)),a.is3D&&a._cachedWrapR!==t.wrapR&&(a._cachedWrapR=t.wrapR,this._setTextureParameterInteger(o,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),a)),this._setAnisotropicLevel(o,a,t.anisotropicFilteringLevel)}return!0}setTextureArray(e,t,i,n){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===i.length||(this._textureUnits=new Int32Array(i.length));for(let t=0;t<i.length;t++){const n=i[t].getInternalTexture();n?(this._textureUnits[t]=e+t,n._associatedChannel=e+t):this._textureUnits[t]=-1}this._gl.uniform1iv(t,this._textureUnits);for(let e=0;e<i.length;e++)this._setTexture(this._textureUnits[e],i[e],!0)}}_setAnisotropicLevel(e,t,i){const n=this._caps.textureAnisotropicFilterExtension;11!==t.samplingMode&&3!==t.samplingMode&&2!==t.samplingMode&&(i=1),n&&t._cachedAnisotropicFilteringLevel!==i&&(this._setTextureParameterFloat(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=i)}_setTextureParameterFloat(e,t,i,n){this._bindTextureDirectly(e,n,!0,!0),this._gl.texParameterf(e,t,i)}_setTextureParameterInteger(e,t,i,n){n&&this._bindTextureDirectly(e,n,!0,!0),this._gl.texParameteri(e,t,i)}unbindAllAttributes(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(let e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else for(let e=0,t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}releaseEffects(){const e=Object.keys(this._compiledEffects);for(const t of e)this._compiledEffects[t].dispose();this._compiledEffects={}}dispose(){var e;Object(a.d)()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored))),super.dispose(),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.unbindAllAttributes(),this._boundUniforms={},this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers.length=0,this._currentProgram=null,this._creationOptions.loseContextOnDispose&&(null===(e=this._gl.getExtension("WEBGL_lose_context"))||void 0===e||e.loseContext()),Object(n.i)(this._gl)}attachContextLostEvent(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)}attachContextRestoredEvent(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)}getError(){return this._gl.getError()}_canRenderToFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)}_canRenderToHalfFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)}_canRenderToFramebuffer(e){const t=this._gl;for(;t.getError()!==t.NO_ERROR;);let i=!0;const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER);if(i=i&&a===t.FRAMEBUFFER_COMPLETE,i=i&&t.getError()===t.NO_ERROR,i&&(t.clear(t.COLOR_BUFFER_BIT),i=i&&t.getError()===t.NO_ERROR),i){t.bindFramebuffer(t.FRAMEBUFFER,null);const e=t.RGBA,n=t.UNSIGNED_BYTE,r=new Uint8Array(4);t.readPixels(0,0,1,1,e,n,r),i=i&&t.getError()===t.NO_ERROR}for(t.deleteTexture(n),t.deleteFramebuffer(r),t.bindFramebuffer(t.FRAMEBUFFER,null);!i&&t.getError()!==t.NO_ERROR;);return i}_getWebGLTextureType(e){if(1===this._webGLVersion){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE}_getInternalFormat(e,t=!1){let i=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case 0:i=this._gl.ALPHA;break;case 1:i=this._gl.LUMINANCE;break;case 2:i=this._gl.LUMINANCE_ALPHA;break;case 6:i=this._gl.RED;break;case 7:i=this._gl.RG;break;case 4:i=t?this._glSRGBExtensionValues.SRGB:this._gl.RGB;break;case 5:i=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case 8:i=this._gl.RED_INTEGER;break;case 9:i=this._gl.RG_INTEGER;break;case 10:i=this._gl.RGB_INTEGER;break;case 11:i=this._gl.RGBA_INTEGER}return i}_getRGBABufferInternalSizedFormat(e,t,i=!1){if(1===this._webGLVersion){if(void 0!==t)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return i?this._glSRGBExtensionValues.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return i?this._glSRGBExtensionValues.SRGB8:this._gl.RGB8;case 5:return i?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(t){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return i?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8}readPixels(e,t,i,n,r=!0,a=!0){const s=r?4:3,o=r?this._gl.RGBA:this._gl.RGB,l=new Uint8Array(n*i*s);return a&&this.flushFramebuffer(),this._gl.readPixels(e,t,i,n,o,this._gl.UNSIGNED_BYTE,l),Promise.resolve(l)}static get IsSupportedAsync(){return Promise.resolve(this.isSupported())}static get IsSupported(){return this.isSupported()}static isSupported(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{const e=c.a._CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported}static get HasMajorPerformanceCaveat(){if(null===this._HasMajorPerformanceCaveat)try{const e=c.a._CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat}constructor(e,t,i,a){if(i=i||{},super(null!=t?t:i.antialias,i,a),this._name="WebGL",this.forcePOTTextures=!1,this.validateShaderPrograms=!1,this.disableUniformBuffers=!1,this._webGLVersion=1,this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._maxMSAASamplesOverride=null,this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={},!e)return;let l=null;if(e.getContext){if(l=e,this._renderingCanvas=l,void 0===i.preserveDrawingBuffer&&(i.preserveDrawingBuffer=!1),void 0===i.xrCompatible&&(i.xrCompatible=!1),navigator&&navigator.userAgent){this._setupMobileChecks();const e=navigator.userAgent;for(const t of _.ExceptionList){const n=t.key,r=t.targets;if(new RegExp(n).test(e)){if(t.capture&&t.captureConstraint){const i=t.capture,n=t.captureConstraint,r=new RegExp(i).exec(e);if(r&&r.length>0&&parseInt(r[r.length-1])>=n)continue}for(const e of r)switch(e){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0;break;case"antialias":i.antialias=!1;break;case"maxMSAASamples":this._maxMSAASamplesOverride=1}}}}if(this._doNotHandleContextLost||(this._onContextLost=e=>{e.preventDefault(),this._contextWasLost=!0,r.a.Warn("WebGL context lost."),this.onContextLostObservable.notifyObservers(this)},this._onContextRestored=()=>{this._restoreEngineAfterContextLost(()=>this._initGLContext())},l.addEventListener("webglcontextlost",this._onContextLost,!1),l.addEventListener("webglcontextrestored",this._onContextRestored,!1),i.powerPreference=i.powerPreference||"high-performance"),this._badDesktopOS&&(i.xrCompatible=!1),!i.disableWebGL2Support)try{this._gl=l.getContext("webgl2",i)||l.getContext("experimental-webgl2",i),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch(e){}if(!this._gl){if(!l)throw new Error("The provided canvas is null or undefined.");try{this._gl=l.getContext("webgl",i)||l.getContext("experimental-webgl",i)}catch(e){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=e,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";const t=this._gl.getContextAttributes();t&&(i.stencil=t.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==i.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=i.useHighPrecisionFloats),this.resize(),this._initGLContext(),this._initFeatures();for(let e=0;e<this._caps.maxVertexAttribs;e++)this._currentBufferPointers[e]=new g;this._shaderProcessor=this.webGLVersion>1?new o.WebGL2ShaderProcessor:new s.WebGLShaderProcessor;const d="Babylon.js v"+_.Version;r.a.Log(d+" - "+this.description),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",d);const c=Object(n.j)(this._gl);c.validateShaderPrograms=this.validateShaderPrograms,c.parallelShaderCompile=this._caps.parallelShaderCompile}}_._TempClearColorUint32=new Uint32Array(4),_._TempClearColorInt32=new Int32Array(4),_.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/12\\d\\..+?Mobile",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}],_.CollisionsEpsilon=.001,_._ConcatenateShader=f.b,_._IsSupported=null,_._HasMajorPerformanceCaveat=null,_.CeilingPOT=d.a,_.FloorPOT=d.b,_.NearestPOT=d.f,_.GetExponentOfTwo=d.c,_.QueueNewFrame=c.b},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));class n{initialize(e,t=!1,i,n){return this.mask=e,this.skipNextObservers=t,this.target=i,this.currentTarget=n,this}constructor(e,t=!1,i,n){this.initialize(e,t,i,n)}}class r{remove(){this._remove&&this._remove()}constructor(e,t,i=null){this.callback=e,this.mask=t,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}}class a{static FromPromise(e,t){const i=new a;return e.then(e=>{i.notifyObservers(e)}).catch(e=>{if(!t)throw e;t.notifyObservers(e)}),i}get observers(){return this._observers}add(e,t=-1,i=!1,n=null,a=!1){if(!e)return null;const s=new r(e,t,n);return s.unregisterOnNextCall=a,i?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(s,this._lastNotifiedValue),s._remove=()=>{this.remove(s)},s}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){return!!e&&(e._remove=null,-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))}removeCallback(e,t){for(let i=0;i<this._observers.length;i++){const n=this._observers[i];if(!(n._willBeUnregistered||n.callback!==e||t&&t!==n.scope))return this._deferUnregister(n),!0}return!1}_deferUnregister(e){e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0))}_remove(e,t=!0){if(!e)return!1;const i=this._observers.indexOf(e);return-1!==i&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(i,1),!0)}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e,t=-1,i,n,r){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;const a=this._eventState;a.mask=t,a.target=i,a.currentTarget=n,a.skipNextObservers=!1,a.lastReturnValue=e,a.userInfo=r;for(const i of this._observers)if(!i._willBeUnregistered&&(i.mask&t&&(i.unregisterOnNextCall&&this._deferUnregister(i),i.scope?a.lastReturnValue=i.callback.apply(i.scope,[e,a]):a.lastReturnValue=i.callback(e,a)),a.skipNextObservers))return!1;return!0}notifyObserver(e,t,i=-1){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),e._willBeUnregistered)return;const n=this._eventState;n.mask=i,n.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,n)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const e=new a;return e._observers=this._observers.slice(0),e}hasSpecificMask(e=-1){for(const t of this._observers)if(t.mask&e||t.mask===e)return!0;return!1}constructor(e,t=!1){this.notifyIfTriggered=t,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new n(0),e&&(this._onObserverAdded=e)}}},,function(e,t,i){"use strict";function n(){return"undefined"!=typeof window}function r(){return"undefined"!=typeof navigator}function a(){return"undefined"!=typeof document}function s(e){let t="",i=e.firstChild;for(;i;)3===i.nodeType&&(t+=i.textContent),i=i.nextSibling;return t}i.d(t,"d",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}))},function(e,t,i){"use strict";i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"c",(function(){return l}));var n=i(34),r=i(9),a=i(3),s=i(7);let o=void 0;function l(e){e.logger&&r.a.setLogger(e.logger),e.stringifyError&&(o=e.stringifyError)}class d{async load(e,t){const i=this.getLoadResultInCache(e,t);if(i)return i;const n={resourceId:e,metadata:{errorName:"ErrorResourceNotFound"}};if(this.policy&&!this.policy.shouldLoad(this,t))return n.metadata.errorName="ErrorResourceNotAllowed",n;if(!this.loader)return n.metadata.errorName="ErrorResourceLoaderNotAvailable",n;const l=`${e}_${JSON.stringify(d.removeMetadata(t))}`;let c,h=this.ongoingLoads.get(l);h||(h=this.loader.load(e,t),this.ongoingLoads.set(l,h));try{c=await h}catch(e){r.a.sendTraceTag(508842323,a.a.msoulscat_Wac_PptLive,s.a.Warning,"unexpected error on load: "+(e instanceof Error&&o?o(e):e))}return this.ongoingLoads.delete(l),c?c.resource?(c.options=t,this.add(c)):c:(r.a.sendTraceTag(508842322,a.a.msoulscat_Wac_PptLive,s.a.Error,"PowerPointResourceProvider::load - failed to load resource. "+JSON.stringify({requestedLoadKey:l,resourceIdsInCache:JSON.stringify(this.getAllLoadResultsInCache().map(e=>e.resourceId))})),n)}add(e){const t=this.getLoadResultInCache(e.resourceId,e.options);if(t)return t;const i=d.removeMetadata(e.options);return e.options=i,e.metadata.created=e.metadata.created?e.metadata.created:new Date,e.metadata.lastAccessed=new Date,e.metadata.resourceUsers=[],e.metadata.optionsKey=JSON.stringify(i),this.loadResults.push(e),d.updateMetadata(e,e.options),e}remove(e,t){const i=this.getLoadResultInCache(e,t);if(!i)return!1;const n=this.loadResults.splice(this.loadResults.indexOf(i),1);return this.events.emit("removed",n),!0}getAllLoadResultsInCache(){return this.loadResults}getLoadResultsInCache(e){return this.loadResults.filter(t=>t.resourceId===e)}getLoadResultInCache(e,t){const i=JSON.stringify(d.removeMetadata(t)),n=this.loadResults.filter(t=>t.resourceId===e&&t.metadata.optionsKey===i)[0];if(n)return d.updateMetadata(n,t),n}static removeMetadata(e){if(void 0===e)return;const t=Object.keys(e).filter(e=>!e.startsWith("meta_"));if(0===t.length)return;const i={};return t.map(t=>{i[t]=e[t]}),i}static updateMetadata(e,t){t&&(e.metadata.lastAccessed=new Date,t.meta_user&&!e.metadata.resourceUsers.includes(t.meta_user)&&e.metadata.resourceUsers.push(t.meta_user))}constructor(e,t){this.loadResults=[],this.events=new n.EventEmitter,this.ongoingLoads=new Map,this.loader=e,this.policy=t}}class c extends d{async batchLoad(e){try{if(!e||e.length<=0)return r.a.sendTraceTag(508842325,a.a.msoulscat_Wac_PptLive,s.a.Error,"BatchResourceProvider::batchLoad - Invalid loadRequestList"),[];const t=[],i=[];for(let n=0;n<e.length;n+=1){const r=e[n],a=this.getLoadResultInCache(r.resourceId,r.options);if(a)i.push(a);else{const e=`${r.resourceId}_${JSON.stringify(d.removeMetadata(r.options))}`;this.ongoingBatchLoads.get(e)||t.push(r)}}let n;t.length>0&&(n=this.m_batchLoader.batchLoad(t),t.forEach(e=>{if(n){const t=`${e.resourceId}_${JSON.stringify(d.removeMetadata(e.options))}`;this.ongoingBatchLoads.set(t,n)}}));let o=[];return n&&(o=await n,t.forEach(e=>{const t=`${e.resourceId}_${JSON.stringify(d.removeMetadata(e.options))}`;this.ongoingBatchLoads.delete(t)})),o.forEach(e=>{this.add(e)}),i.concat(o)}catch(e){return r.a.sendTraceTag(508842324,a.a.msoulscat_Wac_PptLive,s.a.Error,"BatchResourceProvider::batchLoad - exception occured: "+e),[]}}constructor(e,t,i){super(t,i),this.ongoingBatchLoads=new Map,this.m_batchLoader=e}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return h}));var n=i(22),r=i(9),a=i(3),s=i(7),o=function(){function e(e,t){this.m_loopRunning=!1,this.m_requests=[],this.m_functionToThrottle=e,this.m_queueHandler=t}return e.prototype.callAsync=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new Promise((function(i,n){e.m_requests.push({resolve:i,reject:n,args:t}),e.m_loopRunning||(e.m_loopRunning=!0,e.loopAsync())}))},e.prototype.loopAsync=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,t,i,o,l,d,c,h,u,m,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:e=!1,n.label=1;case 1:if(!(this.m_requests.length>0))return[3,6];t=this.m_queueHandler(Array.from(this.m_requests),e),i=t.nextArg,o=t.handledRequests,l=t.remainingRequests,this.m_requests=l,e=!0,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.m_functionToThrottle.apply(this,i)];case 3:for(d=n.sent(),c=0,h=o;c<h.length;c++)h[c].resolve(d);return[3,5];case 4:for(u=n.sent(),r.a.sendTraceTag(506520610,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,"Critical Async Throttler exception: ".concat(u)),m=0,f=o;m<f.length;m++)f[m].reject(u);return[3,5];case 5:return[3,1];case 6:return this.m_loopRunning=!1,[2]}}))}))},e}(),l=function(){function e(e,t,i){this.m_throttlers=new Map,this.m_functionToThrottle=e,this.m_queueHandler=t,this.m_parallelSplitter=i}return e.prototype.callAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=this.m_parallelSplitter.apply(this,e),(i=this.m_throttlers.get(t))||(i=new o(this.m_functionToThrottle,this.m_queueHandler),this.m_throttlers.set(t,i)),[4,i.callAsync.apply(i,e)];case 1:return[2,n.sent()]}}))}))},e}();function d(e){return{nextArg:e[0].args,handledRequests:[e[0]],remainingRequests:e.splice(1)}}function c(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return[2,new Promise((function(t){window.setTimeout(t,e)}))]}))}))}function h(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i=this;return Object(n.__generator)(this,(function(r){return[2,new Promise((function(r){return Object(n.__awaiter)(i,void 0,void 0,(function(){var i,a,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:i=t&&t.checkIntervalMs?t.checkIntervalMs:50,a=t&&t.timeoutMs?t.timeoutMs:0,s=performance.now(),n.label=1;case 1:return e()?(r(!0),[2]):a&&performance.now()-s>a?(r(!1),[2]):[4,c(i)];case 2:return n.sent(),[3,1];case 3:return[2]}}))}))}))]}))}))}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return u}));var n,r,a=i(9),s=i(3),o=i(7),l=i(72),d=i(27),c=i(8),h=i(1);!function(e){e[e.Pen=0]="Pen",e[e.Highlighter=1]="Highlighter",e[e.Eraser=2]="Eraser",e[e.LaserPointer=3]="LaserPointer",e[e.Select=4]="Select",e[e.None=5]="None"}(n||(n={})),function(e){e.Pressed="Pressed",e.Unpressed="Unpressed",e.Enabled="Enabled",e.Disabled="Disabled"}(r||(r={}));class u{init(e){void 0!==this.m_inkShare&&void 0!==this.m_inkShareEvents||([this.m_inkShare,this.m_inkShareEvents]=slideshowink.inkShareFactoryGlobal.createInkShare(e),this.registerAnnotationEventListeners()),this.m_slideshowAppEvents.on("isUserPrivatelyZooming",e=>{this.m_isUserPrivatelyZooming=e,this.m_isUserPrivatelyZooming||this.syncAnnotationZoom()})}initAnnotation(){const e={eventType:d.a.InitAnnotation};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",e)}setRole(e){this.m_slideshowInkAddon.roleChanged(),this.m_role=e}setOpticalZoomState(e){this.m_presenterOpticalZoomedState=e}getInkShareEvents(){return this.m_inkShareEvents}syncAnnotationZoom(){this.m_inkShare&&this.m_presenterZoomedState&&void 0!==this.m_role&&this.m_role===c.i.Attendee&&this.m_inkShare.remoteZoomChange(this.m_presenterZoomedState.slideId,this.m_presenterZoomedState.scale,this.m_presenterZoomedState.offSetX,this.m_presenterZoomedState.offSetY,this.m_presenterZoomedState.defaultZoomX,this.m_presenterZoomedState.defaultZoomY)}handleAnnotationEvent(e){this.m_slideshowInkAddon.ensureInkCanvas(l.a.Annotation,()=>{if(this.m_inkShare)switch(e.eventType){case d.a.InitAnnotation:break;case d.a.SemiDryEraseAll:e.slideID?this.m_inkShare.eraseAllInSlide(e.slideID):a.a.sendTraceTag(506856967,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for SemiDryEraseAll is missing required slideID");break;case d.a.SemiDryStrokeAdded:e.strokeID&&e.eventJson&&e.slideID?(this.m_inkShare.insertRemoteStroke(e.slideID,e.strokeID,e.eventJson),a.a.sendTraceTag(506856966,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowAnnotationProxy: annotation event received for SemiDryStrokeAdded, stroke id "+e.strokeID)):a.a.sendTraceTag(506856965,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for SemiDryStrokeAdded is missing required strokeID or pointsJson or slideID");break;case d.a.SemiDryStrokeErased:e.strokeID&&e.slideID?this.m_inkShare.remoteEraseStroke(e.slideID,e.strokeID):a.a.sendTraceTag(506856964,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for SemiDryStrokeErased is missing required strokeID or slideID");break;case d.a.LaserStart:e.slideID&&e.strokeID&&e.eventJson?this.m_inkShare.remoteLaserStart(e.slideID,e.strokeID,e.eventJson):a.a.sendTraceTag(506856963,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for LaserStart is missing required slideID or strokeID or eventJson");break;case d.a.LaserRemove:e.slideID&&e.strokeID?this.m_inkShare.remoteLaserRemove(e.slideID,e.strokeID):a.a.sendTraceTag(506856962,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for LaserRemove is missing required strokeID or slideID");break;case d.a.LaserEnd:e.slideID&&e.strokeID&&e.eventJson?this.m_inkShare.remoteLaserEnd(e.slideID,e.strokeID,e.eventJson):a.a.sendTraceTag(506856961,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for LaserEnd is missing required slideID or strokeID or eventJson");break;case d.a.LaserMove:e.slideID&&e.strokeID&&e.eventJson?this.m_inkShare.remoteLaserMove(e.slideID,e.strokeID,e.eventJson):a.a.sendTraceTag(506856960,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for LaserMove is missing required slideID or strokeID or eventJson");break;case d.a.WetStrokeStart:e.slideID&&e.strokeID&&e.eventJson?(this.m_inkShare.remoteWetStrokeStart(e.slideID,e.strokeID,e.eventJson),a.a.sendTraceTag(506856931,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowAnnotationProxy: annotation event received for WetStrokeStart, stroke id "+e.strokeID)):a.a.sendTraceTag(506856930,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for WetStrokeStart is missing required slideID or strokeID or eventJson");break;case d.a.WetStrokeAppend:e.slideID&&e.strokeID&&e.eventJson?this.m_inkShare.remoteWetStrokeAppend(e.slideID,e.strokeID,e.eventJson):a.a.sendTraceTag(506856929,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for WetStrokeAppend is missing required slideID or strokeID or eventJson");break;case d.a.WetStrokeEnd:e.slideID&&e.strokeID&&e.eventJson?(this.m_inkShare.remoteWetStrokeEnd(e.slideID,e.strokeID,e.eventJson),a.a.sendTraceTag(506856928,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowAnnotationProxy: annotation event received for WetStrokeEnd, stroke id "+e.strokeID)):a.a.sendTraceTag(506856927,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for WetStrokeEnd is missing required slideID or strokeID or eventJson");break;case d.a.ReplaceLastPoint:e.slideID&&e.strokeID&&e.eventJson?this.m_inkShare.remoteReplaceLastPoint(e.slideID,e.strokeID,e.eventJson):a.a.sendTraceTag(506856926,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for ReplaceLastPoint is missing required slideID or strokeID or eventJson");break;case d.a.MakeWetStrokeStraight:e.slideID&&e.strokeID?this.m_inkShare.remoteMakeWetStrokeStraight(e.slideID,e.strokeID):a.a.sendTraceTag(506856925,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for MakeWetStrokeStraight is missing required slideID or strokeID");break;case d.a.SetInitialInkSnapshot:if(e.inkSnapshot){const t=new Map;e.inkSnapshot.forEach(e=>{const i=new Map;e.strokes.forEach(e=>{i.set(e.strokeID,e.strokeJson)}),t.set(e.slideID,i)}),this.m_inkShare.setInitialDryInkSnapshot(t)}e.startPointJson&&e.appendPointsArray&&e.slideID&&e.strokeID?this.m_inkShare.setInitialWetInkSnapshot(e.slideID,e.strokeID,e.startPointJson,e.appendPointsArray):void 0===e.inkSnapshot&&a.a.sendTraceTag(506856924,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for SetInitialWetInkSnapshot/SetInitialDryInkSnapshot is missing required startPointJson or appendPointsArray or slideID or inkSnapshot"),h.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&this.m_presenterOpticalZoomedState&&this.m_slideshowCoreEvents.emit("updateCanvasOpticalZoom",this.m_presenterOpticalZoomedState);break;case d.a.CursorMove:if(e.eventJson){const t=JSON.parse(e.eventJson);this.m_inkShare.remoteSelectToolMove(t.slideId,t.x,t.y)}else a.a.sendTraceTag(506856923,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for CursorMove is missing required eventJson");break;case d.a.CursorHide:e.slideID?this.m_inkShare.remoteSelectToolHide(e.slideID):a.a.sendTraceTag(506856922,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for CursorHide is missing required slideID");break;case d.a.CanvasZoom:if(void 0!==this.m_role&&(this.m_role===c.i.Attendee||this.m_role===c.i.PrivateViewing))if(e.eventJson){const t=JSON.parse(e.eventJson);this.m_presenterZoomedState=t,h.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)||this.m_role!==c.i.Attendee||this.m_isUserPrivatelyZooming||this.m_inkShare.remoteZoomChange(t.slideId,t.scale,t.offSetX,t.offSetY,t.defaultZoomX,t.defaultZoomY)}else a.a.sendTraceTag(506856921,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received for CanvasZoom is missing required eventJson");break;default:a.a.sendTraceTag(506856920,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowAnnotationProxy: annotation event received with unknown type")}else a.a.sendTraceTag(506856919,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowAnnotationProxy: annotation event received before init()")})}registerAnnotationEventListeners(){this.m_inkShareEvents&&(this.m_inkShareEvents.on("semiDryStrokeAdded",this.onSemiDryStrokeAdded.bind(this)),this.m_inkShareEvents.on("semiDryStrokeErased",this.onSemiDryStrokeErased.bind(this)),this.m_inkShareEvents.on("semiDryEraseAll",this.onSemiDryEraseAll.bind(this)),this.m_inkShareEvents.on("wetStrokeStart",this.onWetStrokeStart.bind(this)),this.m_inkShareEvents.on("wetStrokeAppend",this.onWetStrokeAppend.bind(this)),this.m_inkShareEvents.on("wetStrokeEnd",this.onWetStrokeEnd.bind(this)),this.m_inkShareEvents.on("replaceLastPoint",this.onReplaceLastPoint.bind(this)),this.m_inkShareEvents.on("makeWetStrokeStraight",this.onMakeWetStrokeStraight.bind(this)),this.m_inkShareEvents.on("laserStart",this.onLaserStart.bind(this)),this.m_inkShareEvents.on("laserMove",this.onLaserMove.bind(this)),this.m_inkShareEvents.on("laserEnd",this.onLaserEnd.bind(this)),this.m_inkShareEvents.on("laserRemove",this.onLaserRemove.bind(this)),this.m_inkShareEvents.on("eraserStart",this.onEraserStart.bind(this)),this.m_inkShareEvents.on("selectToolMove",this.onCursorMove.bind(this)),this.m_inkShareEvents.on("selectToolHide",this.onCursorHide.bind(this)),this.m_inkShareEvents.on("canvasZoom",this.onCanvasZoom.bind(this)))}onSemiDryStrokeAdded(e,t,i){const n={eventType:d.a.SemiDryStrokeAdded,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onSemiDryStrokeErased(e,t,i){const n={eventType:d.a.SemiDryStrokeErased,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onSemiDryEraseAll(e){const t={eventType:d.a.SemiDryEraseAll,slideID:e};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",t)}onWetStrokeStart(e,t,i){const n={eventType:d.a.WetStrokeStart,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onWetStrokeAppend(e,t,i){const n={eventType:d.a.WetStrokeAppend,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onWetStrokeEnd(e,t,i){const n={eventType:d.a.WetStrokeEnd,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onReplaceLastPoint(e,t,i){const n={eventType:d.a.ReplaceLastPoint,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onMakeWetStrokeStraight(e,t){const i={eventType:d.a.MakeWetStrokeStraight,slideID:e,strokeID:t};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",i)}onLaserMove(e,t,i){const n={eventType:d.a.LaserMove,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onLaserStart(e,t,i){const n={eventType:d.a.LaserStart,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onLaserRemove(e,t){const i={eventType:d.a.LaserRemove,slideID:e,strokeID:t};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",i)}onLaserEnd(e,t,i){const n={eventType:d.a.LaserEnd,slideID:e,strokeID:t,eventJson:i};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",n)}onEraserStart(){this.m_slideshowCoreEvents.emit("annotationStartCloseMenus")}onCursorMove(e,t,i){const n={slideId:e,x:t,y:i},r={eventType:d.a.CursorMove,eventJson:JSON.stringify(n)};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",r)}onCursorHide(e){const t={eventType:d.a.CursorHide,slideID:e};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",t)}onCanvasZoom(e,t,i,n,r,a){if(void 0!==this.m_role&&this.m_role===c.i.Presenter){const s={slideId:e,scale:t,offSetX:i,offSetY:n,defaultZoomX:r,defaultZoomY:a},o={eventType:d.a.CanvasZoom,eventJson:JSON.stringify(s)};this.m_slideshowCoreEvents.emit("slideShowAnnotationEvent",o)}}resetInkCanvasAndInkShareEvents(){this.m_inkShare=void 0,this.unregisterAnnotationEventListeners(),this.m_inkShareEvents=void 0}unregisterAnnotationEventListeners(){this.m_inkShareEvents&&(this.m_inkShareEvents.off("semiDryStrokeAdded"),this.m_inkShareEvents.off("semiDryStrokeErased"),this.m_inkShareEvents.off("semiDryEraseAll"),this.m_inkShareEvents.off("wetStrokeStart"),this.m_inkShareEvents.off("wetStrokeAppend"),this.m_inkShareEvents.off("wetStrokeEnd"),this.m_inkShareEvents.off("replaceLastPoint"),this.m_inkShareEvents.off("makeWetStrokeStraight"),this.m_inkShareEvents.off("laserStart"),this.m_inkShareEvents.off("laserMove"),this.m_inkShareEvents.off("laserEnd"),this.m_inkShareEvents.off("laserRemove"),this.m_inkShareEvents.off("eraserStart"),this.m_inkShareEvents.off("selectToolMove"),this.m_inkShareEvents.off("selectToolHide"),this.m_inkShareEvents.off("canvasZoom"))}constructor(e,t,i){this.m_isUserPrivatelyZooming=!1,this.m_slideshowCoreEvents=e,this.m_slideshowInkAddon=t,this.m_slideshowAppEvents=i}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a}));var n,r=i(49);!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(n||(n={}));class a extends class{get wrapU(){return this._cachedWrapU}set wrapU(e){this._cachedWrapU=e}get wrapV(){return this._cachedWrapV}set wrapV(e){this._cachedWrapV=e}get wrapR(){return this._cachedWrapR}set wrapR(e){this._cachedWrapR=e}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(e){this._cachedAnisotropicFilteringLevel=e}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(e){this._comparisonFunction=e}get useMipMaps(){return this._useMipMaps}set useMipMaps(e){this._useMipMaps=e}setParameters(e=1,t=1,i=1,n=1,r=2,a=0){return this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=i,this._cachedAnisotropicFilteringLevel=n,this.samplingMode=r,this._comparisonFunction=a,this}compareSampler(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}}{get useMipMaps(){return this.generateMipMaps}set useMipMaps(e){this.generateMipMaps=e}get uniqueId(){return this._uniqueId}_setUniqueId(e){this._uniqueId=e}getEngine(){return this._engine}get source(){return this._source}incrementReferences(){this._references++}updateSize(e,t,i=1){this._engine.updateTextureDimensions(this,e,t,i),this.width=e,this.height=t,this.depth=i,this.baseWidth=e,this.baseHeight=t,this.baseDepth=i,this._size=e*t*i}_rebuild(){var e,t;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const e=this.onRebuildCallback(this),t=t=>{t._swapAndDie(this,!1),this.isReady=e.isReady};return void(e.isAsync?e.proxy.then(t):t(e.proxy))}let i;switch(this.source){case 2:break;case 1:return void(i=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,e=>{e._swapAndDie(this,!1),this.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case 3:i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer),i._swapAndDie(this,!1),this.isReady=!0;break;case 10:i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),i._swapAndDie(this,!1),this.isReady=!0;break;case 11:i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),i._swapAndDie(this,!1),this.isReady=!0;break;case 4:i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),i._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:return void(i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,()=>{i._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case 8:i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,null!==(t=this._originalFormat)&&void 0!==t?t:this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),i._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:return i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,e=>{e&&e._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension),void(i._sphericalPolynomial=this._sphericalPolynomial)}}_swapAndDie(e,t=!0){var i;null===(i=this._hardwareTexture)||void 0===i||i.setUsage(e._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);const n=this._engine.getLoadedTexturesCache();let r=n.indexOf(this);-1!==r&&n.splice(r,1),r=n.indexOf(e),-1===r&&n.push(e)}dispose(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}constructor(e,t,i=!1){super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new r.a,this.onErrorObservable=new r.a,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=0,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._engine=e,this._source=t,this._uniqueId=a._Counter++,i||(this._hardwareTexture=e._createHardwareTexture())}}a._Counter=0},function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return m}));var n=i(9),r=i(3),a=i(7),s=i(10),o=i(1),l=i(17),d=i(23),c=i(13),h=i(105);class u{static isIC3Message(e){return Object.keys(e).some(e=>e.includes(d.a.ic3Local))}static isStateMessage(e){return Object.keys(e).some(e=>e.includes(d.a.stateLocal))}static isDuplicateEmitTime(e){let t=void 0;if(this.isStateMessage(e))t=this.m_previousStateComparisonReceivedMessageEmitTime;else{if(!this.isIC3Message(e))return n.a.sendTraceTag(506855942,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"StateServiceComparison:IsDuplicateEmitTime unknown source: "+JSON.stringify(e)),!1;t=this.m_previousTeamsComparisonReceivedMessageEmitTime}let i=0;for(const n in e)if(n.includes("SS_Emit"))return i=e[n],i===t;return!1}static logStateServiceComparisonTelemetry(e,t,i,s){try{const o={...e};if(o){o.attendee_ring=s||"";const e=o.skew_emitter||0,l=t;let c=0,h=d.c.Unknown;for(const t in o)(t.includes(d.a.teamsNotified)||t.includes(d.a.stateNotified)||t.includes(d.a.bootstrapperNotified))&&0!==e?o[t]+=e:(t.includes(d.a.teamsLocal)||t.includes(d.a.stateLocal)||t.includes(d.a.bootstrapperLocal))&&0!==i?(o[t]+=i,h=t.includes(d.a.stateLocal)?d.c.State:d.c.Teams,o.source=h):t.includes("SS_Emit")&&(c=o[t]);if(o[d.a.skewReceiver]=i,o.PPT_ModernSS_Complete_Nav=l,c>0){const e=l-c;o.totalElapsedMS=e;const t=`${o.slideIndex||-1}_${c}`;let i=Number.MIN_SAFE_INTEGER;h===d.c.State&&(this.m_stateReceivedNavs[t]=e,i=this.m_previousStateComparisonReceivedMessageEmitTime,this.m_previousStateComparisonReceivedMessageEmitTime=c),h===d.c.Teams&&(this.m_teamsReceivedNavs[t]=e,i=this.m_previousTeamsComparisonReceivedMessageEmitTime,this.m_previousTeamsComparisonReceivedMessageEmitTime=c);const s=c===i,m=c<i;!s&&e>2500&&(o.endToEndNavSlow=!0,e>3e4&&(o.endToEndNavSlow30=!0)),m?(n.a.sendTraceTag(506855941,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`StateServiceComparison:Out Of Order nav messages received: source: ${h}; current: ${c}; previous: ${i};`),o.EarlierOrder="true"):s&&(o.SameOrder="true",n.a.sendTraceTag(506855940,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`StateServiceComparison:Duplicate emit time nav messages received: source: ${h}; current: ${c}; previous: ${i};`)),u.logStateServiceCorrespondingComparisonTelemetry(h,t),n.a.sendTraceTag(556675080,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"StateServiceComparison: "+JSON.stringify(o))}}}catch(e){n.a.sendTraceTag(506855939,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"StateServiceComparison error: "+e)}}static logStateServiceCorrespondingComparisonTelemetry(e,t){const i=e===d.c.State?this.m_teamsReceivedNavs[t]:this.m_stateReceivedNavs[t],s=Object.keys(this.m_stateReceivedNavs).length,l=Object.keys(this.m_teamsReceivedNavs).length,c=s-l,h=o.a.readNumberOrDefault("syncPipelineDiscrepancyCount",10);let u="";if(c>h?u=d.c.Teams:c<-1*h&&(u=d.c.State),""!==u){const e={stateKeysCount:s,teamsKeysCount:l,keyCountDifferenceToLogVeto:h};n.a.sendTraceTag(506855938,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`SyncPipelineDiscrepancy_${u}: ${JSON.stringify(e)}`)}if(void 0===i)return;const m=this.m_stateReceivedNavs[t],f=this.m_teamsReceivedNavs[t],p={key:t,stateElapsed:m,teamsElapsed:f,stateFaster:m<f,difference:m-f,stateKeysCount:s,teamsKeysCount:l};n.a.sendTraceTag(506855937,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"logStateServiceComparison "+JSON.stringify(p))}}u.m_stateReceivedNavs={},u.m_teamsReceivedNavs={},u.m_previousStateComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER,u.m_previousTeamsComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER;class m{static trackLastUserInputNavigation(e,t){this.m_lastUserInputTime=t,n.a.sendTraceTag(506855936,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`trackTeamsPVMetrics::trackLastUserInputNavigation: navType: ${e.navType}; action: ${e.source}, time: ${t}`)}static initialize(e){e.teamsSharingEndToEndNavSlowMS&&(this.m_teamsSharingEndToEndNavSlowMS=e.teamsSharingEndToEndNavSlowMS),this.m_maxSlowPipelineMessagesCount=o.a.readNumberOrDefault("maxSlowPipelineMessagesCount",0),this.m_stateServicePipelineMessageSlowMS=o.a.readNumberOrDefault("stateServicePipelineMessageSlowMS",Number.MAX_SAFE_INTEGER)}static setSlowMediaSyncThreshold(e){this.m_slowMediaSyncQoSThresholdMs=e}static hadPreviousUserInput(e){return this.m_timeFromLastUserInputNav=-1,this.m_lastUserInputTime?(this.m_timeFromLastUserInputNav=e-this.m_lastUserInputTime,!0):(n.a.sendTraceTag(506855907,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"trackTeamsPVMetrics: Entering private viewing without prior user input."),!1)}static trackTeamsPVMetrics(e,t){try{n.a.sendTraceTag(506855906,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`trackTeamsPVMetrics: action: ${JSON.stringify(e)}; time: ${t}, inPV: ${null!=this.m_currentTeamsPrivateViewingData}`);const i=e.action;switch(i){case"enterPrivateViewing":{const i=e.source||"";this.m_currentTeamsPrivateViewingData?n.a.sendTraceTag(506855905,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`trackTeamsPVMetrics: EnterPrivateViewing on existing PV session. source: ${i}; data: ${JSON.stringify(e)}; existingPV:${JSON.stringify(this.m_currentTeamsPrivateViewingData)}`):(this.m_currentTeamsPrivateViewingData={enterPrivateViewing:t,returnToPresenter:0,sessionSlideUpdate:0,privateSlideUpdatePrev:0,privateSlideUpdateNext:0,leavePrivateViewing:-1,enterPrivateViewingSource:i,timeFromLastUserNav:this.m_timeFromLastUserInputNav,completed:!1},this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions+=1,i&&i!==d.b.SyncStateManager||this.hadPreviousUserInput(t)||s.e.recordVeto("Slide_VetoedTeamsPrivateViewingUnintentional",{qosVeto:"SharingWrongSlideStateDisplayed",...this.m_currentTeamsPrivateViewingData}));break}case"leavePrivateViewing":this.m_currentTeamsPrivateViewingData&&(this.m_currentTeamsPrivateViewingData.leavePrivateViewing=t,this.m_currentTeamsPrivateViewingData.privateViewingDuration=t-this.m_currentTeamsPrivateViewingData.enterPrivateViewing,this.m_currentTeamsPrivateViewingData.completed=!0,this.logCurrentPrivateViewingTelemetry(),this.m_currentTeamsPrivateViewingData=void 0,this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions-=1,this.m_sessionTeamsPrivateViewingData.completePrivateViewingSessions+=1);break;case"returnToPresenter":case"sessionSlideUpdate":case"privateSlideUpdatePrev":case"privateSlideUpdateNext":this.m_currentTeamsPrivateViewingData?this.m_currentTeamsPrivateViewingData[i]+=1:"privateSlideUpdateNext"===i?this.trackLastUserInputNavigation({navType:l.g.Next,source:l.p.API},t):"privateSlideUpdatePrev"===i&&this.trackLastUserInputNavigation({navType:l.g.Prev,source:l.p.API},t);break;default:n.a.sendTraceTag(506855904,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`trackTeamsPVMetrics: unexpected action ${JSON.stringify(e)};`)}}catch(e){n.a.sendTraceTag(506855903,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`trackTeamsPVMetrics: caught error: ${e};`)}}static areSkewValuesValid(e,t){return 0!==e&&0!==t&&Math.abs(e)<1e8&&Math.abs(t)<1e8}static logCurrentPrivateViewingTelemetry(){this.m_currentTeamsPrivateViewingData&&n.a.sendTraceTag(579111065,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"trackTeamsPVMetrics: privateViewingSession. Data:"+JSON.stringify(this.m_currentTeamsPrivateViewingData))}static logSessionEndPrivateViewingTelemetry(){const e=this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions>0;e&&this.logCurrentPrivateViewingTelemetry(),n.a.sendTraceTag(579111066,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`trackTeamsPVMetrics: sessionTeamsPrivateViewingData: ${JSON.stringify(this.m_sessionTeamsPrivateViewingData)}, hasIncompletePV: ${e}`)}static logNavigationPromiseCompletedMetadata(e,t,i,s){try{if(e){e.attendee_ring=s||"";const o=e.skew_emitter||0,c=e.isForceRetry||!1,h=t;let u=0,m=d.c.Unknown;for(const t in e)(t.includes(d.a.teamsNotified)||t.includes(d.a.stateNotified)||t.includes(d.a.bootstrapperNotified))&&0!==o?e[t]+=o:(t.includes(d.a.teamsLocal)||t.includes(d.a.stateLocal)||t.includes(d.a.bootstrapperLocal))&&0!==i?(e[t]+=i,t.includes(d.a.stateLocal)?m=d.c.State:t.includes(d.a.teamsLocal)&&(m=d.c.Teams),e.source=m):t.includes("SS_Emit")&&(u=e[t]);if(e[d.a.skewReceiver]=i,e.PPT_ModernSS_Complete_Nav=h,u>0){const t=h-u;e.totalElapsedMS=t;const i=u===this.m_previousTeamsReceivedNavMessageEmitTime,s=u<this.m_previousTeamsReceivedNavMessageEmitTime,d=e.navResultStatus;s?this.m_previousTeamsReceivedEmitterSkew!==o||c||(n.a.sendTraceTag(506855902,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`LogTeamsNavigation:Out Of Order nav messages received: current: ${u}; previous: ${this.m_previousTeamsReceivedNavMessageEmitTime}; source: ${m}`),e.EarlierOrder="true"):i?(e.SameOrder="true",n.a.sendTraceTag(506855901,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsNavigation:Duplicate emit time nav messages received: current: ${u}; previous: ${this.m_previousTeamsReceivedNavMessageEmitTime};`)):"Success"===d?(this.m_previousTeamsReceivedNavMessageEmitTime=u,this.m_previousTeamsReceivedEmitterSkew=o,this.m_consecutiveSkippedRequests>0&&(n.a.sendTraceTag(506855900,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsNavigation:ConsecutiveSkippedRequests: ${this.m_consecutiveSkippedRequests}; endToEndElapsedTime: ${t}; source: ${m}`),this.m_consecutiveSkippedRequests=0),t>0&&!c&&this.logEndToEndSyncNavigationVetoIfSlow(e,m)):d===l.k.SkippedBusy||d===l.k.SkippedNewTarget?this.m_consecutiveSkippedRequests+=1:d===l.k.Failed&&n.a.sendTraceTag(506855899,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"LogTeamsNavigation:Navigation Failed; endToEndElapsedTime: "+t)}n.a.sendTraceTag(588084945,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"NavigationComplete: "+JSON.stringify(e))}}catch(e){n.a.sendTraceTag(506855898,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"logNavigationPromiseCompleted error: "+e)}}static logStateServicePipelineLatency(e,t,i,l){if(!i)return;let c=i[d.a.stateNotified]||0,h=i[d.a.stateLocal]||0;const u=i.skew_emitter||i[d.a.skewEmitter],m=i[d.a.senderId]||"",f=`logStateServicePipelineLatency type:${e}; subtype:${t}; senderId:${m}`;if(!m||m===d.a.senderIdSystem)return void n.a.sendTraceTag(506855897,r.a.msoulscat_Wac_PptSlideshow,a.a.Verbose,f+" not measuring message from excluded sender");if(0===c||0===h||!this.areSkewValuesValid(u,l))return void n.a.sendTraceTag(506855896,r.a.msoulscat_Wac_PptSlideshow,a.a.Verbose,f+" not measuring message with invalid numbers");c+=u,h+=l;const p=h-c;p>this.m_stateServicePipelineMessageSlowMS&&(this.m_currentSlowPipelineMessagesCount+=1,this.m_currentSlowPipelineMessagesCount>=this.m_maxSlowPipelineMessagesCount?this.m_currentSlowPipelineMessagesCount%5==0&&(n.a.sendTraceTag(506855895,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`${f} slow ${p}; currentSlowPipelineMessagesCount: ${this.m_currentSlowPipelineMessagesCount} > maxSlowPipelineMessagesCount: ${this.m_maxSlowPipelineMessagesCount}`),o.a.readBooleanOrDefault("logCorrectVetoForStateServiceLatency",!0)?s.e.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SyncPipelineSlow_StateService",errorName:e+"_SharingEndToEndSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:p}):s.e.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SharingEndToEndNavSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:p})):n.a.sendTraceTag(506855894,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`${f} slow ${p}; currentSlowPipelineMessagesCount: ${this.m_currentSlowPipelineMessagesCount}`))}static logEndToEndSyncNavigationVetoIfSlow(e,t){try{const i=e[d.a.stateNotified]||0,s=e[d.a.bootstrapperNotified]||0,o=e[d.a.stateLocal]||0,l=e[d.a.bootstrapperLocal]||0,c=Math.max(i,s),h=Math.max(o,l),u=e.skew_emitter,m=e[d.a.skewReceiver];if(c>0&&h>0&&h-c>this.m_teamsSharingEndToEndNavSlowMS&&this.areSkewValuesValid(u,m)){const e={vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:h-c,source:t,skew_emitter:u,skew_receiver:m};n.a.sendTraceTag(506855893,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`TeamsSharingEndToEndNavSlowMS_${t}: ${JSON.stringify(e)}`)}}catch(e){n.a.sendTraceTag(506855892,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"logEndToEndSyncNavigationVetoIfSlow error: "+e)}}static logAnnotationCompletedMetadata(e,t,i,s){try{const o=e[d.a.skewEmitter]||0,l=t;let c=0;for(const t in e)t.includes(d.a.stateNotified)&&0!==o?e[t]+=o:t.includes(d.a.stateLocal)&&0!==i?e[t]+=i:t.includes(d.a.annotationEventEmitted)&&(c=e[t]);if(e[d.a.skewReceiver]=i,e[d.a.annotationEventCompleted]=l,e.attendee_ring=s||"",c>0){const t=l-c;e.totalElapsedMS=t}n.a.sendTraceTag(557670919,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"AnnotationComplete: "+JSON.stringify(e))}catch(e){n.a.sendTraceTag(506855891,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"logAnnotationCompletedMetadata error: "+e)}}static logStateServicePipelineMetrics(e,t,i,s){if(void 0===i[d.a.stateNotified]||void 0===i[d.a.stateLocal]||void 0===i[d.a.skewEmitter]||!this.areSkewValuesValid(i[d.a.skewEmitter],s))return void n.a.sendTraceTag(506855890,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"LogStateServicePipelineMetrics: invalid syncMetricsDictionary: "+JSON.stringify(i));if(this.logStateServicePipelineLatency(e,t,i,s),void 0===i[d.a.syncEventEmitTime])return void n.a.sendTraceTag(506855889,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"LogStateServicePipelineMetrics: Invalid syncMetricsDictionary: "+JSON.stringify(i));const o=i[d.a.syncEventEmitTime];o===this.m_previousStateServiceMessageEmitTime?n.a.sendTraceTag(506855888,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`LogStateServicePipelineMetrics: Duplicate message received: current: ${o}; previous: ${this.m_previousStateServiceMessageEmitTime}; `):o<=this.m_previousStateServiceMessageEmitTime?n.a.sendTraceTag(506855887,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`LogStateServicePipelineMetrics: Out of Order message received: current: ${o}; previous: ${this.m_previousStateServiceMessageEmitTime}`):this.m_previousStateServiceMessageEmitTime=o}static logMediaSyncCompletedMetadata(e,t,i){try{if(e){const o=e[d.a.skewEmitter]||0,l=t;let c=0,h=d.c.Unknown;for(const t in e)t.includes(d.a.teamsNotified)&&0!==o?e[t]+=o:t.includes(d.a.teamsLocal)&&0!==i?e[t]+=i:t.includes(d.a.mediaEventEmitted)?c=e[t]:(t.includes(d.a.teamsLocal)||t.includes(d.a.stateLocal))&&(h=t.includes(d.a.stateLocal)?d.c.State:d.c.Teams,e.source=h);if(e[d.a.skewReceiver]=i,e[d.a.mediaEventCompleted]=l,c>0){const t=l-c;e[d.a.elapsedTime]=t;const u=c===this.m_previousTeamsReceivedMediaMessageEmitTime,m=c<this.m_previousTeamsReceivedMediaMessageEmitTime;t>this.m_slowMediaSyncQoSThresholdMs&&!e.isFromStateServiceCache&&this.areSkewValuesValid(o,i)&&(n.a.sendTraceTag(506855886,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"LogTeamsMediaSync: End-to-end media sync time larger than slow sync threshold: "+JSON.stringify(e)),this.logSlowEndToEndMediaSyncVeto(e,h)),m&&this.shouldLogOutOfOrderEvent(e,h)?(n.a.sendTraceTag(506855885,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsMediaSync: Out of order play/pause sync messages received: current: ${c}; previous: ${this.m_previousTeamsReceivedMediaMessageEmitTime};`),s.e.recordVeto("MediaSyncOutOfOrderEvents",{qosVeto:"MediaSyncOutOfOrderEvents"}),e[d.a.mediaEventOutOfOrder]="true"):u?(n.a.sendTraceTag(506855884,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsMediaSync: Duplicate emit time media sync messages received: current: ${c};`),e[d.a.mediaEventDuplicate]="true"):this.m_previousTeamsReceivedMediaMessageEmitTime=c}n.a.sendTraceTag(506855883,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"LogTeamsMediaSync: "+JSON.stringify(e))}}catch(e){n.a.sendTraceTag(506855882,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"LogTeamsMediaSync: error: "+e)}}static isDuplicateMediaSyncMessage(e,t){return e?(t?this.m_upstreamMediaSyncEvents.has(e):this.m_downstreamMediaSyncEvents.has(e))?(n.a.sendTraceTag(506855880,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`isDuplicateMediaSyncMessage: Media Sync message (correlationId: ${e}) has already been ${t?"sent":"received"}`),!0):(t?this.m_upstreamMediaSyncEvents.add(e):this.m_downstreamMediaSyncEvents.add(e),this.m_upstreamMediaSyncEvents.size>3e3&&this.m_upstreamMediaSyncEvents.clear(),this.m_downstreamMediaSyncEvents.size>3e3&&this.m_downstreamMediaSyncEvents.clear(),!1):(n.a.sendTraceTag(506855881,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"isDuplicateMediaSyncMessage: Undefined correlationId"),!1)}static shouldLogOutOfOrderEvent(e,t){if(t!==d.c.State)return!1;let i=!1,n=c.d.MediaEnded,r="";const a=e[d.a.mediaSyncTimeLine];if(a&&a.length>0){n=e[d.a.mediaEventType];const t=a[0].MediaHostName;r=a[0].MediaPlayerName||"",i=t===h.a.Video&&""!==r&&r===this.m_previousPlayerName&&(n===c.d.MediaPlayed&&this.m_previousEventType===c.d.MediaPaused||n===c.d.MediaPaused&&this.m_previousEventType===c.d.MediaPlayed)}return this.m_previousPlayerName=r,this.m_previousEventType=n,i}static logSlowEndToEndMediaSyncVeto(e,t){const i=e[d.a.skewEmitter]||0,n=e[d.a.skewReceiver]||0,r=e[d.a.elapsedTime];s.e.recordVeto("MediaSyncEndToEndSlow_"+t,{qosVeto:"MediaSyncEndToEndSlow",vetoLimit:this.m_slowMediaSyncQoSThresholdMs,totalElapsedMS:r,source:t,emitterSkew:i,receiverSkew:n})}}m.m_sessionTeamsPrivateViewingData={incompletePrivateViewingSessions:0,completePrivateViewingSessions:0},m.m_teamsSharingEndToEndNavSlowMS=Number.MAX_SAFE_INTEGER,m.m_previousTeamsReceivedNavMessageEmitTime=Number.MIN_SAFE_INTEGER,m.m_previousStateServiceMessageEmitTime=Number.MIN_SAFE_INTEGER,m.m_previousTeamsReceivedEmitterSkew=Number.MIN_SAFE_INTEGER,m.m_consecutiveSkippedRequests=0,m.m_maxSlowPipelineMessagesCount=0,m.m_stateServicePipelineMessageSlowMS=Number.MAX_SAFE_INTEGER,m.m_currentSlowPipelineMessagesCount=0,m.m_previousTeamsReceivedMediaMessageEmitTime=Number.MIN_SAFE_INTEGER,m.m_slowMediaSyncQoSThresholdMs=Number.MAX_SAFE_INTEGER,m.m_previousEventType=c.d.MediaEnded,m.m_previousPlayerName="",m.m_upstreamMediaSyncEvents=new Set,m.m_downstreamMediaSyncEvents=new Set},function(e,t,i){"use strict";i.d(t,"f",(function(){return l})),i.d(t,"d",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"e",(function(){return h})),i.d(t,"p",(function(){return u})),i.d(t,"i",(function(){return m})),i.d(t,"k",(function(){return f})),i.d(t,"j",(function(){return p})),i.d(t,"o",(function(){return g})),i.d(t,"m",(function(){return _})),i.d(t,"n",(function(){return S})),i.d(t,"q",(function(){return v})),i.d(t,"b",(function(){return y})),i.d(t,"r",(function(){return T})),i.d(t,"c",(function(){return b})),i.d(t,"s",(function(){return w})),i.d(t,"h",(function(){return C})),i.d(t,"t",(function(){return I})),i.d(t,"g",(function(){return P})),i.d(t,"l",(function(){return x}));let n,r,a=!1,s=[],o=0;function l(e,t,i,n,r,a,s){v({name:null,actionName:e,commandSurface:r,parentName:i,triggerMethod:n,durationMs:a,succeeded:t,dataFields:s})}function d(e,t=!0,i=0,n=[]){m({name:e,succeeded:t,durationMs:i,dataFields:n})}var c;function h(e,t,i=c.Count,n=!0,r=0,a=[],s=!1){if(null==e||""===e)return;let o=t;if(null==t){if(i!==c.Count)return;o=1}a.push({name:"WAC_Experiment",string:i.toString()}),a.push({name:"WAC_Experiment_Value",double:o}),a.push({name:"WAC_Experiment_EventName",string:"WAC_Exp_"+e+"_"+i.toString()}),a.push({name:"WAC_Experiment_AggregateOnlySucceeded",bool:s}),m({name:e,succeeded:n,durationMs:r,dataFields:a})}function u(e){E({kind:"event",event:e,timestamp:(new Date).getTime()})}function m(e){E({kind:"activity",event:e,timestamp:(new Date).getTime()})}function f(e){E({kind:"dnm",event:e,timestamp:(new Date).getTime()})}function p(e){E({kind:"cc",event:e,timestamp:(new Date).getTime()})}function g(e){E({kind:"otel",event:e})}function _(e){E({kind:"otelcc",event:e})}function S(e){E({kind:"oteldnm",event:e})}function v(e){E({kind:"action",event:e,timestamp:(new Date).getTime()})}function y(e,t){E({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})}function T(e,t){E({kind:"setDNMToken",namespace:e,ariaTenantToken:t})}function b(){E({kind:"flush"})}function w(e){a=e,a||(s=[])}function C(e){r=e}function I(){return r&&r(),E({kind:"shutdown"}),s.length+o}function P(e){n=e,s.forEach(e=>E(e)),s=[]}function E(e){a&&(n?n(e):s.length<=2e4?s.push(e):o+=1)}function x(e){n&&n(e)}!function(e){e.Count="Count",e.Avg="Avg",e.Sum="Sum"}(c||(c={}))},function(e,t,i){"use strict";i.d(t,"e",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"g",(function(){return l})),i.d(t,"f",(function(){return c}));var n,r,a,s,o,l,d=i(185);!function(e){e[e.Unspecified=0]="Unspecified",e[e.Sampled=1]="Sampled",e[e.Complete=2]="Complete"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess"}(r||(r={})),function(e){e[e.Hourly=1]="Hourly",e[e.Daily=2]="Daily"}(a||(a={})),function(e){e[e.ReleaseAudienceGroup=1]="ReleaseAudienceGroup",e[e.WacRing=2]="WacRing",e[e.AppName=3]="AppName",e[e.AppPlatform=4]="AppPlatform",e[e.AppVersion=5]="AppVersion"}(s||(s={})),function(e){e[e.None=0]="None",e[e.MocaAddin=1]="MocaAddin"}(o||(o={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Boolean=1]="Boolean",e[e.String=2]="String",e[e.Int64=3]="Int64",e[e.Double=4]="Double",e[e.Date=5]="Date",e[e.Contract=6]="Contract"}(l||(l={}));const c=new d.a},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return S})),i.d(t,"f",(function(){return v})),i.d(t,"d",(function(){return T})),i.d(t,"g",(function(){return b})),i.d(t,"b",(function(){return P})),i.d(t,"e",(function(){return W})),i.d(t,"h",(function(){return U})),i.d(t,"c",(function(){return z}));var n=i(0),r=i(20),a=i(73),s=i(86),o=i(90),l=i(5),d=i(2),c=i(15),h=i(25),u=i(12),m=i(28),f=i(75),p=i(6),g=i(37),_=i(30);class S{get size(){return this.texture?this.texture.size:n.f.Zero}refresh(e,t,i){const r=e,a=r.getGraphicsProcessor();if(!a)throw p.a.Error(591524387,"Graphics processor not initialized");const s=g.a.readBooleanOrDefault("forceRefreshDistanceField",!1);if(!i&&!s&&this.geometryUniqueId==t.geometryTracker.currentUniqueId&&this.texture&&this.texture.isValidForGraphicsProcessor(a))return!0;const o=this.getContentBounds(t);if(!o)return p.a.Error(570959637,"Shape has no bounds"),this.texture&&this.texture.release(),!1;const l=this.getQualityToUse(t),d=this.getPixelPaddingInShapeUnits(t),c=o.size.scale(l).add(new n.f(2*d*l,2*d*l)),h=this.enableMipMap?new n.f(Object(n.k)(c.x),Object(n.k)(c.y)):c.ceil(),f=h.scale(Math.min(1,u.h/h.x,u.h/h.y)).ceil(),_=new n.f(Object(n.h)(f.x,16,u.h),Object(n.h)(f.y,16,u.h)),S=this.texture;if(this.texture=u.b.RecycleOrReplace(this.scenario,S,e,_,this.releasePolicy,{format:m.d.RGBA,needsRenderBuffer:!0,useFloat:this.isDisplacementMap,isMipMapped:this.enableMipMap}),!this.texture||!this.texture.graphicsProcessor)return!1;if(i&&S!=this.texture)return p.a.Error(591524416,"Cannot update incrementally: texture had to be recreated"),!1;const v=l*Math.min(_.x/c.x,_.y/c.y),y=n.d.FromSizeAndCenter(_.scale(1/v),o.center),T=d*v/l;return this.rasterize(t,i,y,v,T,r.getCurrentFramePerformanceSummary()),!0}getQualityToUse(e){return this.qualityOverride?this.qualityOverride:e.hasSmallDetails()?2*u.i:u.i}getContentBounds(e){if(this.contentBoundsOverride)return this.contentBoundsOverride;const t=e.incrementalPath?e.incrementalPath.bounds:Object(l.q)(e,1!=this.distanceFieldMode);if(!t)return;const i=t.size;if(!i.isFinite())return void p.a.Error(562151697,`Invalid shape bounds for SDF: ${i.x} x ${i.y}, scenario: ${this.scenario}`);const n=e.transform.scale;if(n.isFinite())return t.multiply(n.abs());p.a.Error(562151698,`Invalid shape scale for SDF: ${n.x} x ${n.y}, scenario: ${this.scenario}`)}getFillBrightness(){return this.fillMode==c.e.lighten?.4:this.fillMode==c.e.lightenLess?.2:this.fillMode==c.e.darken?-.4:this.fillMode==c.e.darkenLess?-.2:0}getPixelPaddingInShapeUnits(e){if(null!=this.paddingOverride)return this.paddingOverride;const t=g.a.readNumberOrDefault("maxReasonableZoomOut",10);let i=t;if(e.style.hasLine){var n;const a=null!==(n=e.style.hitTestSlop)&&void 0!==n?n:r.u;i=Math.ceil(Math.max(a/2,t))}return void 0===this.minimalPadding?i:Math.max(i,this.minimalPadding)}rasterize(e,t,i,a,s,o){var m;if(!this.texture||!this.texture.graphicsProcessor)return p.a.Error(591524418,"No gl texture or context"),!1;const f=e.transform.scale.abs();let g=Object(l.q)(e,!1,n.c.Scale2D(f).multiply(new n.e(i.center.negate(),e.transform.scale.sign(),0,i.center).toMatrix3()));if(!g)return p.a.Error(591524420,"Nothing to render"),!1;const S=new n.f(a,a),v=i.size,y=this.size.scale(.5),T=new n.e(i.center.negate(),S,0,y),w=i.transformedBounds(T),C=g.transformedBounds(T);if(!w||!C)return p.a.Error(588006216,"Nothing to render"),!1;if(this.contentQuality=a,this.localBounds=i?i.multiply(f.inverse()):void 0,this.renderScale=S.divide(this.size),this.uvScale=v.multiply(this.renderScale).multiply(e.transform.scale.sign()),this.texture.contentLocation={logicalCenter:C.center,logicalSize:C.size,physicalCenter:w.center,physicalSize:w.size,rotation:0,flipX:e.transform.scale.x<0,flipY:e.transform.scale.y<0},!this.localBounds||!this.renderScale)return p.a.Error(591524421,"no bounds or renderScale"),!1;o.pixelCountDistanceField+=Math.floor(this.size.x*this.size.y);const I=r.a==r.e||this.isDisplacementMap&&(null===(m=e.effects.textureEffect)||void 0===m||null===(m=m.getOptions())||void 0===m?void 0:m.useDistanceField);let P=.5*(e.style.pen?e.style.pen.adjustedLineWidth*(1+Math.min(Math.abs(Object(l.s)(e.style.pen)),1)):0);if(this.isDisplacementMap&&e.shape3D){let t=.5*Math.max(e.shape3D.topBevel?e.shape3D.topBevel.size.x:0,e.shape3D.bottomBevel?e.shape3D.bottomBevel.size.x:0,e.shape3D?.5*e.shape3D.adjustedContourWidth:0);P=Math.max(P,2*t-P)}return this.distRangeSize=I?Math.max(v.x/2,v.y/2):Math.max(P,s),function(e,t,i,a,s,o,m,f,g,S,v,y,T){const w=performance.now(),C=i.texture;if(!C)return p.a.Error(572842049,"DistanceFieldTexture not initialized"),!1;let I,P=v?void 0:d.d.Transparent;if(a.paths&&!a.incrementalPath)I=D(e,t,a.paths,a.style.hasLine?a.style.pen:void 0,!1,1!=g,2==g,a.transform.scale,s,y,T,!!i.isGlyphCache,!!i.isGlyphCacheDisabled);else if(a.incrementalPath){const n=C.tag,r=n&&n.incrementalPathTrackerId==a.incrementalPath.changeTracker.trackerId;(!r||n&&(0==n.figureCount||1==n.figureCount&&0==n.lastFigurePointCount))&&(P=d.d.Transparent);const o=r&&n.figureCount>0?n.figureCount-1:0,l=[];for(let e=o;e<a.incrementalPath.figures.length;e++){const t=a.incrementalPath.figures[e],i=r&&e==o&&n.lastFigurePointCount>0?n.lastFigurePointCount-1:0,s=t.getPointCount();l.push(new c.a(t.data.slice(i*a.incrementalPath.pointDataSize,s*a.incrementalPath.pointDataSize),!1,a.incrementalPath.format))}C.tag={incrementalPathTrackerId:a.incrementalPath.changeTracker.trackerId,figureCount:a.incrementalPath.figures.length,lastFigurePointCount:a.incrementalPath.figures.length>0?a.incrementalPath.figures[a.incrementalPath.figures.length-1].getPointCount():0};I=D(e,t,[new c.d({figures:l,fillMode:c.e.none})],a.style.hasLine?a.style.pen:void 0,!1,1!=g,2==g,a.transform.scale,s,y,T,!!i.isGlyphCache,!!i.isGlyphCacheDisabled)}if(!I)return p.a.Error(592525084,"Nothing to render"),!1;const E=e.activateShaderProgram(_.a.distanceField);E.begin(C.tryGetBabylonTextureForRenderToTexture(e),P,!1);const x=E.getBabylonEffect();x.setVector2("u_0",o.center.multiply(a.transform.scale)),x.setVector2("u_1",a.transform.scale),x.setVector2("u_2",m),x.setFloat("u_3",S),x.setFloat("ufrag_10",a.style&&a.style.pen?2*S/(a.style.pen.adjustedLineWidthForArrowHead+1):0),x.setFloat("ufrag_11",a.transform.scale.x*a.transform.scale.y),x.setInt("ufrag_7",r.a),x.setInt("u_13",r.a),x.setInt("u_15",a.style.pen.compoundType==d.n.simple?0:1),x.setVector2("u_17",a.style.pen.tipScale?a.style.pen.tipScale:n.f.One),x.setInt("u_18",a.style.pen.tipType?a.style.pen.tipType:0);const k=(a.style.pen.adjustedLineWidth/2+1/i.contentQuality)/(2*S);x.setFloat("ufrag_15",a.style.pen.alignment==d.m.center?k:2*k);for(const e of I.transformedPaths){const i=O(f);if(i)for(let n=i.start;n<=i.last;n++)F(n,!0,e,f,y)&&(B(E,n,!0,a),2==n?E.drawQuads(1):N(E,n,!0,a,[e],f,g,y,t.getCurrentFramePerformanceSummary(),S,null!=a.shape3D))}const M=function(e){return e==l.h.union?h.j.FromFirstLast(0,0):h.j.FromFirstLast(0,r.a==r.c||r.a==r.f?0:2)}(f);if(M)for(let e=M.start;e<=M.last;e++)B(E,e,!1,a),2==e?E.drawQuads(1):N(E,e,!1,a,I.transformedPaths,f,g,y,t.getCurrentFramePerformanceSummary(),S,null!=a.shape3D);if(E.end(),u.n&&b&&I.cachedGlyphsPages.length>0){const t=e.activateShaderProgram(_.a.copyTexture);if(t.begin(C.tryGetBabylonTextureForRenderToTexture(e),void 0,!1),L(t,0,l.i.alternate),i.localBounds&&i.uvScale)for(const n of I.cachedGlyphsPages)if(n.cachedGlyphInstances.length>0){const r=new Array(n.cachedGlyphInstances.length),a=new Array(n.cachedGlyphInstances.length);for(let e=0;e<n.cachedGlyphInstances.length;e++){const t=n.cachedGlyphInstances[e];r[e]=t.srcRect,a[e]=t.dstRect.translate(i.localBounds.center.negate()).multiply(C.size.multiply(i.uvScale).multiply(i.localBounds.size.inverse())).translate(C.size.scale(.5))}const s=b[n.page].texture;s?Object(u.j)(e,t,s,r,a,C.size,u.a.noFilter,b[n.page].distRangeSize/i.distRangeSize*(n.cachedGlyphInstances[0].dstRect.size.y/n.cachedGlyphInstances[0].srcRect.size.y)):p.a.Error(572867297,"glyphPageTexture missing")}t.end()}return C.renderCost=performance.now()-w,!0}(this.texture.graphicsProcessor,this.m_renderer,this,e,this.pathIndexRange,this.localBounds,this.renderScale,this.mergeMode,this.distanceFieldMode,this.distRangeSize,t,1==this.generateDrawFadeMask,this.isDisplacementMap)&&(this.geometryUniqueId=e.geometryTracker.currentUniqueId,this.lastKnownQualitySetting=u.i,this.lastKnownLineWidth=e.style.pen.adjustedLineWidth,this.lastKnownLineWidthForArrowHead=e.style.pen.adjustedLineWidthForArrowHead,this.lastKnownHitTestSlop=r.u),!1}constructor(e,t,i,n,r,a,s,o){this.m_renderer=t,this.pathIndexRange=i,this.fillMode=n,this.distRangeSize=0,this.contentQuality=0,this.enableMipMap=!1,this.mergeMode=l.h.fragment,this.distanceFieldMode=a,this.scenario=e,this.releasePolicy=s,this.isDisplacementMap=o}}let v=!1;function y(e){return e?e.fontId+":"+e.glyphId:void 0}function T(e){const t=y(e);if(t){const e=w[t];if(e)return e.page}}let b,w={},C=[],I=0;function P(){for(let e of b||[])e.texture&&e.texture.release();b=void 0,w={},C=[]}function E(){return I-16}function x(){return E()/16}function k(){return 7*x()/8}function M(){return x()/16}const A=[{attributeName:"a_p0",attributeSize:4,offset:0},{attributeName:"a_p1",attributeSize:4,offset:16},{attributeName:"a_p2",attributeSize:4,offset:32},{attributeName:"a_p3",attributeSize:4,offset:48},{attributeName:"a_p4",attributeSize:4,offset:64}],R=[{attributeName:"a_d1",attributeSize:1,offset:4},{attributeName:"a_d2",attributeSize:1,offset:8}];function O(e){if(e==l.h.union)return h.j.FromFirstLast(0,3)}function F(e,t,i,n,r){return!(r&&0!=e||n!=l.h.union&&t||0!=e&&i.fillMode==c.e.none)}function D(e,t,i,r,o,l,h,m,g,_,S,v,T){const C=Object(f.b)(),I=[],P=[];if(0==i.length)return{transformedPaths:I,cachedGlyphsPages:P};g&&(g.start<0||g.last>=i.length)&&p.a.Error(592525078,"pathIndexRange out of range");const x=g?Math.max(g.start,0):0,M=g?Math.min(g.last,i.length-1):i.length-1,A=r&&(Object(a.c)(r.headEnd,r.adjustedLineWidthForArrowHead)>0||Object(a.c)(r.tailEnd,r.adjustedLineWidthForArrowHead)>0),R=_||!!r&&r.dashType!=d.o.solid||A,O=u.n&&!r;for(let u=x;u<=M;u++){const f=i[u];if(S&&!f.extrusionEnabled)continue;const g=f.transform.scale.x>=k()/4096;f.glyphCacheId?v?t.getCurrentFramePerformanceSummary().glyphCountAddedToCache++:(t.getCurrentFramePerformanceSummary().glyphCount++,g&&t.getCurrentFramePerformanceSummary().glyphCountLargeText++,null!=r&&t.getCurrentFramePerformanceSummary().glyphCountTextOutline++):t.getCurrentFramePerformanceSummary().pathCount++;let _=!1;const x=y(f.glyphCacheId);if(!T&&x&&O&&b&&0==f.transform.rotation&&Math.abs(f.transform.scale.x-f.transform.scale.y)<n.i&&!g&&w[x]){const e=w[x];if(e.page<0||e.page>=b.length)p.a.Error(592525079,"Invalid glyph page");else{const i=b[e.page];if(i.texture){const r=i.localBounds?i.localBounds.center:void 0,a=i.localBounds&&r&&i.uvScale?i.localBounds.translate(r.negate()).multiply(i.uvScale.inverse()).translate(r):void 0,s=i.localBounds&&a&&i.uvScale?e.bounds.multiply(i.uvScale).translate(a.leftTop.negate()):void 0,o=e.bounds.translate(e.offset.negate()).multiply(new n.f(1/e.scale,1/e.scale)).transformedBounds(f.transform);if(s)if(o)if(s.right<0||s.bottom<0||s.left>=E()||s.top>=E())p.a.Error(592525082,"Cached glyph src rect out of bounds");else{const i={srcRect:s,dstRect:o,distanceScale:1};let n;for(let t=0;t<P.length&&!n;t++)P[t].page==e.page&&(n=P[t]);n||(n={page:e.page,cachedGlyphInstances:[]},P.push(n)),n.cachedGlyphInstances.push(i),_=!0,t.getCurrentFramePerformanceSummary().glyphCountReadFromCache++}else p.a.Error(592525081,"Cached glyph dst rect undefined");else p.a.Error(592525080,"Cached glyph src rect undefined")}else p.a.Error(572867295,"Glyph page texure missing")}}if(!_){f.glyphCacheId&&!v&&t.getCurrentFramePerformanceSummary().glyphCountRenderedAsPath++;const i=t.ensurePathRenderData(f);i.refreshCachedHwTapeBuffers(f,e);let u,p=i.tapeBuffers,g=0;if(!p||R||o)if(R||o){const e=Object(s.a)(f,C,o,R,R?n.c.FromTransforms(f.transform,n.c.Scale2D(m)):void 0);p=e.buffers,u=e.distanceBuffers,g=e.endDistance}else p=i.refreshCachedTapeBuffers(f);const _=e.getBabylonEngine();let y,T=i.hwTapeBuffers;T||(T=p.map(e=>_.createVertexBuffer(e))),u&&(y=u.map(e=>_.createVertexBuffer(e)));const b=f.transform.toMatrix3(),w={tapeBuffers:p,hwTapeBuffers:T,hwDistanceBuffers:y,fillMode:S?c.e.normal:h?c.e.none:f.fillMode,lineEnabled:l&&f.lineEnabled,isArrowHead:!1,transform:b,startDistance:0,endDistance:g};if(I.push(w),h&&r&&(r.headEnd.end!=d.q.none||r.tailEnd.end!=d.q.none)){const e=r.adjustedLineWidthForArrowHead,t=b.multiply(n.c.Scale2D(m)),i=n.c.Scale2D(m.inverse());for(const n of f.figures){const o=n.isClosed||n.isLastPointDuplicated();if(r.headEnd&&r.headEnd.end!=d.q.none&&!o){const o=Object(a.a)(r.headEnd,e);if(o){const l=Object(a.b)(n,!1,r.headEnd,e,t),h=Object(s.a)(c.d.CreateFromFigure(o),C).buffers;I.push({tapeBuffers:h,hwTapeBuffers:h.map(e=>_.createVertexBuffer(e)),hwDistanceBuffers:void 0,fillMode:r.headEnd.end==d.q.arrow?c.e.none:c.e.normal,lineEnabled:!0,isArrowHead:!0,transform:l?l.multiply(i):void 0,startDistance:0,endDistance:0})}}if(r.tailEnd&&r.tailEnd.end!=d.q.none&&!o){const o=Object(a.a)(r.tailEnd,e);if(o){const l=Object(a.b)(n,!0,r.tailEnd,e,t),h=Object(s.a)(c.d.CreateFromFigure(o),C).buffers;I.push({tapeBuffers:h,hwTapeBuffers:h.map(e=>_.createVertexBuffer(e)),hwDistanceBuffers:void 0,fillMode:r.tailEnd.end==d.q.arrow?c.e.none:c.e.normal,lineEnabled:!0,isArrowHead:!0,transform:l?l.multiply(i):void 0,startDistance:0,endDistance:0})}}}}}}return{transformedPaths:I,cachedGlyphsPages:P}}function L(e,t,i){const n=e.getBabylonEngine();0==t?(n.setColorWrite(!0),n.depthCullingState.depthMask=!0,n.stencilState.stencilTest=!1,n.stencilState.stencilMask=255,n.stencilState.stencilFunc=519,n.stencilState.stencilFuncRef=0,n.stencilState.stencilFuncMask=3,n.alphaState.alphaBlend=!0,n.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),n.alphaState.setAlphaEquationParameters(32776,32776),n.clear(null,!1,!1,!0)):1==t?(n.setColorWrite(!1),n.depthCullingState.depthMask=!1,n.stencilState.stencilTest=!0,n.stencilState.stencilMask=255,n.stencilState.stencilFunc=519,n.stencilState.stencilFuncRef=1,n.stencilState.stencilFuncMask=255):(n.setColorWrite(!0),n.depthCullingState.depthMask=!0,n.stencilState.stencilMask=0,2==t?(n.stencilState.stencilTest=!0,n.stencilState.stencilFunc=517,n.stencilState.stencilFuncRef=0,n.stencilState.stencilFuncMask=i==l.i.winding?255:3,n.alphaState.alphaBlend=!0,n.alphaState.setAlphaBlendFunctionParameters(775,769,773,771),n.alphaState.setAlphaEquationParameters(32774,32774)):3==t&&(n.stencilState.stencilTest=!1,n.alphaState.alphaBlend=!0,n.alphaState.setAlphaBlendFunctionParameters(772,1,0,0),n.alphaState.setAlphaEquationParameters(32774,32774)))}function B(e,t,i,n){let r=i&&!(3==t);L(e,t,n.overlapMode);const a=e.getBabylonEffect();a.setInt("u_7",t),a.setInt("ufrag_0",t),a.setFloat("ufrag_8",r?1:0);let s=0;const o=H(n.style.pen);if(o&&o.length>0)for(let e=0;e<o.length;e++)s+=o[e];0==s&&(s=1);const l=n.style.pen.headEnd.cap==d.p.round?1:0;a.setFloat("ufrag_5",o&&o.length>0?.5-(o[0]-l)/(2*s):0),a.setFloat("ufrag_4",o&&o.length>0?1/(s*n.style.pen.adjustedLineWidth):0)}function N(e,t,i,s,o,h,u,m,f,p,g){if(0==t&&r.a==r.d)return;let _=-performance.now();const S=e.getBabylonEffect(),v=e.getBabylonEngine();S.setFloat("u_12",s.style.pen.adjustedLineWidth),S.setFloat("u_5",s.style.pen.miterLimit);let y=0;const T=H(s.style.pen),b=T?T.length:0;if(s.style.pen&&T){for(let e=0;e<b;e++)y+=T[e];y=y>0?y:1,S.setFloat("ufrag_12",y/2),S.setFloat4("ufrag_13",b>=2?T[0]/2:y,b>=3?T[0]/2+T[1]:y,b>=4?T[0]/2+T[1]+T[2]:y,b>=5?T[0]/2+T[1]+T[2]+T[3]:y)}else S.setFloat("ufrag_12",.5),S.setFloat4("ufrag_13",1,1,1,1);S.setFloat("u_14",o.length>0&&o[0].isArrowHead||s.style.pen.headEnd.cap==d.p.round?1:0);for(const r of o){if(!F(t,i,r,h,m))continue;const f=(r.fillMode!=c.e.none||2==u)&&2==u==r.isArrowHead&&(h==l.h.fragment||h==l.h.union&&i),_=r.lineEnabled&&!r.isArrowHead,y=r.isArrowHead&&r.fillMode==c.e.none,T=y?_:f,b=y?f:_;S.setMatrix3x3("u_8",r.transform?r.transform.m:n.c.Identity.m),S.setInt("ufrag_17",m?1:0),m&&S.setFloat("ufrag_12",1/r.endDistance),S.setFloat("ufrag_19",r.isArrowHead&&r.fillMode==c.e.none&&p?s.style.pen.adjustedLineWidth/4/p:0);const w=o.length>0&&r.isArrowHead||g?d.i.miter:s.style.pen?s.style.pen.lineJoin:0;S.setInt("u_4",w),S.setInt("ufrag_1",w);for(let i=0;i<r.tapeBuffers.length;i++){const n=r.tapeBuffers[i],o=r.hwTapeBuffers[i],l=r.hwDistanceBuffers?r.hwDistanceBuffers[i]:void 0,d=n.length/4-4;if(v.bindInstancesBuffer(o,A,!1),l?(S.setInt("u_19",0),v.bindInstancesBuffer(l,R,!1)):(S.setInt("u_19",1),e.setDummyPointerAttribute("a_d1"),e.setDummyPointerAttribute("a_d2")),0==n[2]&&r.startDistance!=r.endDistance){const e=Object(a.c)(s.style.pen.headEnd,s.style.pen.adjustedLineWidthForArrowHead),t=Object(a.c)(s.style.pen.tailEnd,s.style.pen.adjustedLineWidthForArrowHead);S.setFloat2("ufrag_16",r.startDistance+e,r.endDistance-t)}else S.setFloat2("ufrag_16",0,0);S.setFloat("ufrag_2",T?1:0),S.setFloat("ufrag_3",b?1:0),S.setFloat("ufrag_18",y?1:0),1==t?(S.setFloat("ufrag_6",1),e.setDistanceFieldStencilSumIncrement(!0),e.drawQuadInstances(d),S.setFloat("ufrag_6",-1),e.setDistanceFieldStencilSumIncrement(!1),e.drawQuadInstances(d)):e.drawQuadInstances(d)}}e.disableInstanceAttribute("a_p0"),e.disableInstanceAttribute("a_p1"),e.disableInstanceAttribute("a_p2"),e.disableInstanceAttribute("a_p3"),e.disableInstanceAttribute("a_p4"),e.disableInstanceAttribute("a_d1"),e.disableInstanceAttribute("a_d2"),_+=performance.now(),f.drawTapeCostMs+=_}function V(e,t,i,n){const r=C[t],a=[];for(const e of r)n&&e.ready||(a.push(e.path),e.ready=!0);if(a.length>0){const t=new l.j(a);return t.style.pen.lineWidth=M(),t.overlapMode=l.i.winding,i.refresh(e,t,n)}return!0}function W(e,t){if(!u.n)return;if(!e.getGraphicsProcessor())return;const i=performance.now();I!=r.s&&(P(),I=r.s);let a=b;b=void 0,a||(a=[]),Object(l.m)(t,e=>(function(e){const t=y(e.glyphCacheId);if(!t||null!=w[t])return;const i=new c.d(e,n.e.Identity),a=Object(o.c)([i]);if(!a)return;if(r.r&&Math.max(a.width,a.height)>4096*r.r)return;0!=C.length&&256!=C[C.length-1].length||C.push([]);const s=C.length-1,l=C[s],d=a.size,h=k()/Math.max(4096,Math.max(d.x,d.y)),u=new n.f(h,h),m=l.length,f=.5+m%16,p=.5+(m-f)/16,g=a.center.scale(-h).add(new n.f(f*x(),p*x())),_=n.e.fromScaleAndTranslation(u,g),S={page:s,scale:h,offset:g,bounds:a.multiply(u).translate(g).inflate(M()),path:new c.d(i,_),ready:!1};l.push(S),w[t]=S}(e),!0));for(let t=0;t<C.length;t++){let i=!0,r=t<a.length?a[t]:void 0;if(r)r.texture&&r.texture.isValid(e)||(p.a.Error(592525085,"invalid glyph table texture. recreating."),i=!1);else{for(;a.length<t+1;)a.push(new S("DistanceField/glyphPage",e,void 0,c.e.normal,l.h.fragment,0,u.e.DisposableCache,!1));r=a[t],r.contentBoundsOverride=new n.d(0,0,E(),E()),r.paddingOverride=8,r.qualityOverride=1,r.isGlyphCache=!0,i=!1}let s=!1;i&&(s=V(e,t,r,!0)),s||V(e,t,r,!1)}b=a,e.getCurrentFramePerformanceSummary().distanceFieldForGlyphTableCostMs+=performance.now()-i}function U(){let e=0,t=0,i=0,n=0,r=0,a=0;for(let s=0;s<C.length;s++){let o=0,l=0;const d=b&&s<b.length?b[s].texture:void 0,h=d?d.tryConvertToBufferRGBA():void 0;for(let r=0;r<C[s].length;r++){const u=C[s][r];if(u.ready){if(!d||!h)return p.a.Error(555782370,"Glyph ready but texture missing"),!0;{let r=0;for(let e=Math.ceil(u.bounds.top);e<u.bounds.bottom;e++){const t=d.size.y-1-e;for(let e=Math.ceil(u.bounds.left);e<u.bounds.right;e++)r+=h[4*(e+t*d.size.x)]}if(void 0===u.checksum){if(0==r&&u.path.figures.length>0){const t=Object(c.h)(u.path.figures);t&&t.isValid()&&!t.isEmpty()&&e++}}else o+=r,l+=u.checksum,r>u.checksum&&t++,r<u.checksum&&(0==r?i++:(p.a.Error(555782402,`Glyph was ready but got partially erased (-${100*(u.checksum-r)/u.checksum}%)`),n++));u.checksum=r}a++}}0==o&&l>0&&r++}return e>0&&p.a.Error(555782371,`Glyph(s) with figures look empty: glyphCount=${e}, totalGlyphCount=${a}`),t>0&&p.a.Error(555782400,`Glyph(s) ready but additional pixels rendered on top: glyphCount=${t}, totalGlyphCount=${a}`),(i>0||n>0)&&p.a.Error(555782401,`Glyph(s) ready but erased from cache: glyphCountErased=${i}, glyphCountPartiallyErased=${n}, totalGlyphCount=${a}, pageCountErased=${r}, totalPageCount=${C.length}`),e>0||i>0||n>0}function z(e,t){const i=e.activateShaderProgram(_.a.copyTexture);if(i.begin(void 0,void 0,!1),b&&b.length>0){const r=b[0].texture;r&&Object(u.j)(e,i,r,[new n.d(0,0,E(),E())],[new n.d(0,0,.25*E(),.25*E())],t,u.a.noFilter)}i.end()}function H(e){if(e.tipType!=d.t.square)return e.dashType>=0&&e.dashType<G.length?G[e.dashType]:void p.a.Error(591192836,"unsupported dashType")}const G=[null,new Float32Array([3,1]),new Float32Array([1,1]),new Float32Array([3,1,1,1]),new Float32Array([3,1,1,1,1,1]),new Float32Array([1,3]),new Float32Array([4,3]),new Float32Array([8,3]),new Float32Array([4,3,1,3]),new Float32Array([8,3,1,3]),new Float32Array([8,3,1,3,1,3])]},function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return m}));var n=i(9),r=i(3),a=i(7),s=i(4),o=i(10),l=i(189);function d(){window.addEventListener("error",e=>{e.message.includes("ResizeObserver loop")||f(e.error||{message:e.message,name:""},e.filename,e.lineno,e.colno)}),window.addEventListener("unhandledrejection",e=>{n.a.sendTraceTag(506857184,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"unhandledrejection: Reason:"+e.reason),e.reason instanceof Error&&f(e.reason)})}function c(e){try{if(!e||!s.ChangeGate.isChangeGateEnabled("SSC.AllowLoggingStackFileNames"))return;const t=document.createElement("a");return t.href=e,t.pathname.substring(t.pathname.lastIndexOf("/")+1)}catch(e){return void n.a.sendTraceTag(506857183,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"sanitizeUrl exception")}}function h(e,t,i,s){let o="",d=[];try{e.stack&&(d=Object(l.parse)(e))}catch(e){n.a.sendTraceTag(506857182,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"errorStackParser.parse exception")}for(const e of d)e.fileName&&(e.fileName=c(e.fileName)),o&&(o+="\n"),o+=e.toString();return{msg:e.message,name:e.name,filename:c(t),lineno:i,colno:s,stack:o}}function u(e,t,i,n){return JSON.stringify(h(e,t,i,n))}function m(e){return e instanceof Error?u(e):""+e}function f(e,t,i,s){const l=h(e,t,i,s);n.a.sendTraceTag(506857181,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,JSON.stringify(l)),o.e.recordVeto("Crash",l)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));var n,r=i(5),a=i(37);!function(e){e[e.uninitialized=0]="uninitialized",e[e.assigned=1]="assigned",e[e.deleted=2]="deleted"}(n||(n={}));class s{dumpLastScene(){console.log(this.lastRenderer&&this.lastScene?this.lastRenderer.getDebugString(this.lastScene):void 0)}static OnRender(e,t){if(!a.a.readBooleanOrDefault("debugTool",!1))return;const i=window;i.shapeBuilderDebugTool||(i.shapeBuilderDebugTool=new s);const n=i.shapeBuilderDebugTool;if(n.lastRenderer=e,n.lastScene=1==t.length?t[0].item:void 0,t.length>1){const e=new r.d;for(let i of t)e.items.push(i.item);n.lastScene=e}n.renderers.includes(e)||n.renderers.push(e)}constructor(){this.renderers=[]}}},function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return c}));var n,r,a,s=i(18),o=i(0),l=i(14);!function(e){e[e.uniform=0]="uniform",e[e.blinds=1]="blinds",e[e.box=2]="box",e[e.checkerBoard=3]="checkerBoard",e[e.circle=4]="circle",e[e.diamond=5]="diamond",e[e.dissolve=6]="dissolve",e[e.plus=7]="plus",e[e.randomBars=8]="randomBars",e[e.split=9]="split",e[e.strips=10]="strips",e[e.wedge=11]="wedge",e[e.wheel=12]="wheel",e[e.draw=13]="draw"}(n||(n={})),function(e){e[e.simple=0]="simple",e[e.zigzag=1]="zigzag",e[e.corner=2]="corner",e[e.center=3]="center",e[e.lines=4]="lines",e[e.randomLines=5]="randomLines",e[e.spiral=6]="spiral"}(r||(r={})),function(e){e[e.together=0]="together",e[e.darkFirst=1]="darkFirst",e[e.brightFirst=2]="brightFirst"}(a||(a={}));class d{clone(){return new d(this.mode,this.order)}equals(e){return this.mode==e.mode&&this.order==e.order}constructor(e,t){this.mode=e,this.order=t}}d.Default=new d(r.zigzag,a.darkFirst);class c{clone(){const e=new c(this.m_preset,this.m_param,this.m_flipX,this.m_flipY,this.m_transposeXY,this.m_reverse,this.m_isDistributedByLength);return e.m_drawFadeOptions=this.m_drawFadeOptions,e.m_progress=this.m_progress,e}equals(e){return this.m_progress==e.m_progress&&this.m_preset==e.m_preset&&this.m_param==e.m_param&&this.m_flipX==e.m_flipX&&this.m_flipY==e.m_flipY&&this.m_transposeXY==e.m_transposeXY&&this.m_reverse==e.m_reverse&&this.m_isDistributedByLength==e.m_isDistributedByLength&&this.m_drawFadeOptions==e.m_drawFadeOptions}get changeTracker(){return this.m_changeTracker}get presetChangeTracker(){return this.m_presetChangeTracker}get progress(){return this.m_progress}get preset(){return this.m_preset}get param(){return this.m_param}get flipX(){return this.m_flipX}get flipY(){return this.m_flipY}get transposeXY(){return this.m_transposeXY}get reverse(){return this.m_reverse}get isDistributedByLength(){return this.m_isDistributedByLength}get drawFadeOptions(){return this.m_drawFadeOptions}set progress(e){Object(l.a)(this.m_changeTracker,this.m_progress,e),this.m_progress=e}set preset(e){Object(l.a)(this.m_changeTracker,this.m_preset,e),Object(l.a)(this.m_presetChangeTracker,this.m_preset,e),this.m_preset=e}set param(e){Object(l.a)(this.m_changeTracker,this.m_param,e),this.m_param=e}set flipX(e){Object(l.a)(this.m_changeTracker,this.m_flipX,e),this.m_flipX=e}set flipY(e){Object(l.a)(this.m_changeTracker,this.m_flipY,e),this.m_flipY=e}set transposeXY(e){Object(l.a)(this.m_changeTracker,this.m_transposeXY,e),this.m_transposeXY=e}set reverse(e){Object(l.a)(this.m_changeTracker,this.m_reverse,e),this.m_reverse=e}set isDistributedByLength(e){Object(l.a)(this.m_changeTracker,this.m_isDistributedByLength,e),this.m_isDistributedByLength=e}set drawFadeOptions(e){Object(l.c)(this.m_changeTracker,this.m_drawFadeOptions,e),this.m_drawFadeOptions=e}getFadeTransform(){const e=o.f.Flip(this.flipX,this.flipY);return new o.c(this.transposeXY?0:e.x,this.transposeXY?e.x:0,0,this.transposeXY?e.y:0,this.transposeXY?0:e.y,0,0,0,1)}constructor(e=n.uniform,t=0,i=!1,r=!1,a=!1,o=!1,l=!1){this.m_changeTracker=new s.a,this.m_presetChangeTracker=new s.a,this.m_preset=e,this.m_param=t,this.m_flipX=i,this.m_flipY=r,this.m_transposeXY=a,this.m_reverse=o,this.m_isDistributedByLength=l,this.m_progress=0}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(4),r=i(9),a=i(3),s=i(7),o=i(61);const l=i(116);class d{static areSyncStatesEqual(e,t,i){if(void 0===e&&void 0===t)return!0;if(void 0===e||void 0===t)return!1;if(i){const i=d.syncStateToSlideLocation(e),n=d.syncStateToSlideLocation(t);return l(i.slideId,n.slideId)||i.slideIndex===n.slideIndex}const n=d.syncStateToSlideLocation(e),r=d.syncStateToSlideLocation(t),a=d.syncStateToAnimationState(e),s=d.syncStateToAnimationState(t);return!(!l(n.slideId,r.slideId)&&n.slideIndex!==r.slideIndex)&&l(a,s)}static syncStateToSlideLocation(e){return{slideId:null!=e.slideId?e.slideId:void 0,slideIndex:null!=e.slideIndex?e.slideIndex:void 0}}static syncStateToAnimationState(e){return{timelineStates:e.timelineStates}}static toSyncState(e,t){const i={},l=[];return r.a.sendTraceTag(506856035,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`SyncUtil:: toSyncState slideLocation: ${JSON.stringify(e)} and animationState: ${JSON.stringify(t)}`),t&&(n.ChangeGate.isChangeGateEnabled("SSA.nullCheckTimelineStates")&&!t.timelineStates?r.a.sendTraceTag(506856034,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SyncUtil:: Error "+Object(o.b)(new Error("Invalid timelineStates"))):(t.timelineStates.forEach(e=>{l.push({timelineId:e.timelineId,step:e.step})}),i.timelineStates=t?l:void 0)),i.slideId=null!=e.slideId?e.slideId:void 0,i.slideIndex=null!=e.slideIndex?e.slideIndex:void 0,i}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static GetShadersRepository(e=0){return 0===e?n.ShadersRepository:n.ShadersRepositoryWGSL}static GetShadersStore(e=0){return 0===e?n.ShadersStore:n.ShadersStoreWGSL}static GetIncludesShadersStore(e=0){return 0===e?n.IncludesShadersStore:n.IncludesShadersStoreWGSL}}n.ShadersRepository="src/Shaders/",n.ShadersStore={},n.IncludesShadersStore={},n.ShadersRepositoryWGSL="src/ShadersWGSL/",n.ShadersStoreWGSL={},n.IncludesShadersStoreWGSL={}},,function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"d",(function(){return s})),i.d(t,"c",(function(){return o}));var n=i(78);i(51);const r={};function a(e,t,i=""){return i+(t?t+"\n":"")+e}function s(e,t,i,a,s,o,l){const d=l||r.loadFile;if(d)return d(e,t,i,a,s,o);throw Object(n.a)("FileTools")}function o(e,t,i,n){if(e)return t?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,i?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(n?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);{let e="";return t&&(e+="#define IS_NDC_HALF_ZRANGE"),i&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),n&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"e",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return h})),i.d(t,"f",(function(){return u})),i.d(t,"a",(function(){return m}));var n,r=i(2),a=i(0),s=i(18),o=i(14);i(15);class l{get changeTracker(){return this.m_changeTracker}get animationChangeTracker(){return this.m_animationChangeTracker}get color(){return this.m_color}get radius(){return this.m_radius}get blendingMode(){return this.m_blendingMode}get image(){return this.m_image}set color(e){Object(o.c)(this.m_changeTracker,this.m_color,e),this.m_color=e}set radius(e){Object(o.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set blendingMode(e){Object(o.a)(this.m_changeTracker,this.m_blendingMode,e),this.m_blendingMode=e}set image(e){this.m_image!=e&&(this.m_animationChangeTracker.replaceListener(this.m_image,e),this.m_image=e)}clone(){return new l(this.m_color,this.m_radius,this.m_blendingMode,this.m_image)}constructor(e=r.d.Transparent,t=0,i=r.a.normal,n){this.m_changeTracker=new s.a,this.m_animationChangeTracker=new s.a,this.m_color=e,this.m_radius=t,this.m_blendingMode=i,this.m_image=n}}!function(e){e[e.singleShadow=0]="singleShadow",e[e.doubleShadow=1]="doubleShadow",e[e.embossShadow=2]="embossShadow",e[e.textEmbossShadow=3]="textEmbossShadow"}(n||(n={}));class d{get changeTracker(){return this.m_changeTracker}get color(){return this.m_color}get radius(){return this.m_radius}get angle(){return this.m_angle}get distance(){return this.m_distance}get scale(){return this.m_scale}get skew(){return this.m_skew}get alignment(){return this.m_alignment}get rotateWithShape(){return this.m_rotateWithShape}get shadowType(){return this.m_shadowType}set color(e){Object(o.c)(this.m_changeTracker,this.m_color,e),this.m_color=e}set radius(e){Object(o.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set angle(e){Object(o.a)(this.m_changeTracker,this.m_angle,e),this.m_angle=e}set distance(e){Object(o.a)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}set scale(e){Object(o.c)(this.m_changeTracker,this.m_scale,e),this.m_scale=e}set skew(e){Object(o.c)(this.m_changeTracker,this.m_skew,e),this.m_skew=e}set alignment(e){Object(o.a)(this.m_changeTracker,this.m_alignment,e),this.m_alignment=e}set rotateWithShape(e){Object(o.a)(this.m_changeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}set shadowType(e){Object(o.a)(this.m_changeTracker,this.m_shadowType,e),this.m_shadowType=e}clone(){return new d(this.m_color,this.m_radius,this.m_angle,this.m_distance,this.m_scale,this.m_skew,this.m_alignment,this.m_rotateWithShape,this.m_shadowType)}constructor(e=r.d.Transparent,t=0,i=0,o=0,l=a.f.One,d=a.f.Zero,c=a.a.center,h=!1,u=n.singleShadow){this.m_changeTracker=new s.a,this.m_color=e,this.m_radius=t,this.m_angle=i,this.m_distance=o,this.m_scale=l,this.m_skew=d,this.m_alignment=c,this.m_rotateWithShape=h,this.m_shadowType=u}}class c{get changeTracker(){return this.m_changeTracker}get color(){return this.m_color}get radius(){return this.m_radius}get angle(){return this.m_angle}get distance(){return this.m_distance}set color(e){Object(o.c)(this.m_changeTracker,this.m_color,e),this.m_color=e}set radius(e){Object(o.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set angle(e){Object(o.a)(this.m_changeTracker,this.m_angle,e),this.m_angle=e}set distance(e){Object(o.a)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}clone(){return new c(this.m_color,this.m_radius,this.m_angle,this.m_distance)}constructor(e=r.d.Transparent,t=0,i=0,n=0){this.m_changeTracker=new s.a,this.m_color=e,this.m_radius=t,this.m_angle=i,this.m_distance=n}}class h{get changeTracker(){return this.m_changeTracker}get radius(){return this.m_radius}get startAlpha(){return this.m_startAlpha}get startPosition(){return this.m_startPosition}get endAlpha(){return this.m_endAlpha}get endPosition(){return this.m_endPosition}get distance(){return this.m_distance}set radius(e){Object(o.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set startAlpha(e){Object(o.a)(this.m_changeTracker,this.m_startAlpha,e),this.m_startAlpha=e}set startPosition(e){Object(o.a)(this.m_changeTracker,this.m_startPosition,e),this.m_startPosition=e}set endAlpha(e){Object(o.a)(this.m_changeTracker,this.m_endAlpha,e),this.m_endAlpha=e}set endPosition(e){Object(o.a)(this.m_changeTracker,this.m_endPosition,e),this.m_endPosition=e}set distance(e){Object(o.a)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}clone(){return new h(this.m_radius,this.m_startAlpha,this.m_startPosition,this.m_endAlpha,this.m_endPosition,this.m_distance)}constructor(e=0,t=1,i=0,n=0,r=1,a=0){this.m_changeTracker=new s.a,this.m_radius=e,this.m_startAlpha=t,this.m_startPosition=i,this.m_endAlpha=n,this.m_endPosition=r,this.m_distance=a}}class u{get changeTracker(){return this.m_changeTracker}notifyChange(){this.m_changeTracker.notifyChange()}get radius(){return this.m_radius}set radius(e){this.m_radius!=e&&(this.notifyChange(),this.m_radius=e)}clone(){return new u(this.m_radius)}constructor(e=0){this.m_changeTracker=new s.a,this.m_radius=e}}class m{get changeTracker(){return this.m_changeTracker}notifyChange(){this.m_changeTracker.notifyChange()}get animationChangeTracker(){return this.m_animationChangeTracker}get glow(){return this.m_glow}get shadow(){return this.m_shadow}get innerShadow(){return this.m_innerShadow}get reflection(){return this.m_reflection}get softEdges(){return this.m_softEdges}get replicate(){return this.m_replicate}get direction(){return this.m_direction||0}get border(){return this.m_border}get textureEffect(){return this.m_textureEffect}get hasEffects(){return!!(this.m_glow||this.m_shadow||this.m_innerShadow||this.m_reflection||this.m_softEdges||this.m_border||this.m_replicate||this.m_textureEffect)}set glow(e){this.m_glow!=e&&(this.m_changeTracker.replaceListener(this.m_glow,e),this.m_glow&&s.a.RemoveListener(this.m_glow.animationChangeTracker,this.m_animationChangeTracker),e&&s.a.AddListener(e.animationChangeTracker,this.m_animationChangeTracker),this.m_glow=e)}set shadow(e){this.m_changeTracker.replaceListener(this.m_shadow,e),this.m_shadow=e}set innerShadow(e){this.m_changeTracker.replaceListener(this.m_innerShadow,e),this.m_innerShadow=e}set reflection(e){this.m_changeTracker.replaceListener(this.m_reflection,e),this.m_reflection=e}set softEdges(e){this.m_changeTracker.replaceListener(this.m_softEdges,e),this.m_softEdges=e}set border(e){this.m_changeTracker.replaceListener(this.m_border,e),this.m_border=e}set replicate(e){this.m_changeTracker.replaceListener(this.m_replicate,e),this.m_replicate=e}set textureEffect(e){this.m_changeTracker.replaceListener(this.m_textureEffect,e),this.m_textureEffect=e}set direction(e){Object(o.a)(this.m_changeTracker,this.m_direction,e),this.m_direction=e}clone(){var e;const t=new m(this.m_glow?this.m_glow.clone():void 0,this.m_shadow?this.m_shadow.clone():void 0,this.m_innerShadow?this.m_innerShadow.clone():void 0,this.m_reflection?this.m_reflection.clone():void 0,this.m_softEdges?this.m_softEdges.clone():void 0,this.m_border?this.m_border.clone():void 0,this.m_replicate?this.m_replicate.clone():void 0);return t.textureEffect=null===(e=this.textureEffect)||void 0===e?void 0:e.clone(),t.direction=this.direction,t}constructor(e,t,i,n,r,a,o){this.m_changeTracker=new s.a,this.m_animationChangeTracker=new s.a,this.glow=e,this.shadow=t,this.innerShadow=i,this.reflection=n,this.softEdges=r,this.border=a,this.replicate=o,s.a.AddListener(null==e?void 0:e.animationChangeTracker,this.m_animationChangeTracker)}}},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidStartInput="ErrorInvalidStartInput",e.ErrorStreamStartFailure="ErrorStreamStartFailure",e.ErrorNoVideoTracks="ErrorNoVideoTracks",e.ErrorWebView2NotAvailable="ErrorWebView2NotAvailable",e.ErrorVideoPlaybackFailed="ErrorVideoPlaybackFailed",e.ErrorUnknown="ErrorUnknown"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return a}));const n=1/2.2,r=2.2,a=(Math.sqrt(5),.001)},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(49);class r{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}r.Instances=[],r.OnEnginesDisposedObservable=new n.a,r._LastCreatedScene=null,r.UseFallbackTexture=!0,r.FallbackTexture=""},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return c}));var n,r=i(8),a=i(9),s=i(3),o=i(7);!function(e){e.Pen="pen",e.Menu="menu",e.Reset="reset",e.Annotation="Annotation",e.None="none"}(n||(n={}));class l{boot(e){this.m_bootSource=e,this.m_bootStartTimestamp=Date.now()}timeDiff(){return Date.now()-this.m_bootStartTimestamp}getSource(){return this.m_bootSource}countLostStroke(){this.m_lostStrokeCount+=1}getLostStrokeCount(){return this.m_lostStrokeCount}constructor(){this.m_bootStartTimestamp=-1,this.m_bootSource=n.None,this.m_lostStrokeCount=0}}class d{info(e){a.a.sendTraceTag(506855813,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,e)}error(e){a.a.sendTraceTag(506855812,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,e)}}class c{get slideshowCore(){return this.m_slideshowCore}get loadInkJsCallback(){return this.m_loadInkJsCallback}get parent(){return this.m_parent}get inkContainer(){return this.m_inkContainer}get isInkJsDownloading(){return this.f_isInkJsDownloading}get isShowingBlankSlide(){return this.f_isShowingBlankSlide}get metricHelper(){return this.m_metricHelper}set isInkJsDownloading(e){this.f_isInkJsDownloading=e}onPointerDown(e){"pen"===e.pointerType&&this.m_metricHelper.countLostStroke()}selectEraser(){this.m_inkCanvas&&(this.m_inkCanvas.enableTouchMouse(),this.m_inkCanvas.selectEraser(),a.a.sendTraceTag(506855811,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowInkAddon: selectEraser called"))}selectNone(){this.m_inkCanvas&&this.m_inkCanvas.disableTouchMouse()}eraseAll(){this.m_inkCanvas&&(this.m_inkCanvas.eraseAll(),a.a.sendTraceTag(506855810,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowInkAddon: eraseAll called"))}onDownloadCompleted(){this.f_isInkJsDownloading=!1,a.a.sendTraceTag(506855809,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowInkAddon: slideshowink.js downloaded"),this.updateDimensions(),this.m_initInk()}onDownloadFailed(e){this.f_isInkJsDownloading=!1,a.a.sendTraceTag(506855808,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowInkAddon: slideshowink.js download error: "+e.message)}updateDimensions(){const e=this.m_slideshowCore.getCurrentSlideDimensions();e&&(this.m_inkContainer.style.width=e.x+"px",this.m_inkContainer.style.height=e.y+"px",this.updateInkCanvasDimensions())}updateInkCanvasDimensions(){if(!this.m_inkCanvas)return;const e=this.slideshowCore.getCurrentSlideDimensions();e&&"function"==typeof this.m_inkCanvas.updateCanvasDimensions&&this.m_inkCanvas.updateCanvasDimensions(e.x,e.y)}resetInkCanvas(){if(this.m_inkCanvas){for(this.m_metricHelper.boot(n.Reset),this.m_inkCanvas.stop(),this.unregisterAppEventListeners(),this.m_inkCanvas=void 0;this.m_inkContainer.firstChild;)this.m_inkContainer.removeChild(this.m_inkContainer.firstChild);this.m_initInk(),a.a.sendTraceTag(506855779,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowInkAddon: Ink initialization triggered by reset.")}}registerAppEventListeners(){this.m_slideshowCore.events.on("slideLocationChanged",this.onPositionChanged),this.m_slideshowCore.events.on("blankSlideStateChanged",this.onBlankSlideStateChanged),this.m_slideshowCore.events.on("slideLocationChanging",this.onSlideLocationChanging),this.m_slideshowCore.events.on("slideDimensionsChanged",this.updateDimensions)}unregisterAppEventListeners(){this.m_slideshowCore.events.off("slideLocationChanged",this.onPositionChanged),this.m_slideshowCore.events.off("blankSlideStateChanged",this.onBlankSlideStateChanged),this.m_slideshowCore.events.off("slideLocationChanging",this.onSlideLocationChanging),this.m_slideshowCore.events.off("slideDimensionsChanged",this.updateDimensions)}onPositionChanged(){const e=this.m_slideshowCore.getSlideLocation();if(!e)return void a.a.sendTraceTag(506855778,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowInkAddon: undefined slide location in onPositionChanged.");const t=e.slideIndex;this.m_slideIndex!==t&&(this.m_slideIndex=t,this.m_slideChanged(e))}onBlankSlideStateChanged(e){if(e===r.a.Hidden){this.f_isShowingBlankSlide=!1;const e=this.m_slideshowCore.getSlideLocation();e&&this.m_slideChanged(e),this.m_inkContainer.style.visibility="inherit",this.m_inkCanvas&&this.m_allowInkStart()&&this.m_inkCanvas.start()}else this.f_isShowingBlankSlide=!0,this.m_inkCanvas&&this.m_inkCanvas.stop(),this.m_inkContainer.style.visibility="hidden",this.m_slideChanged(this.c_endOfShowLocation)}onSlideLocationChanging(e){!this.f_isTransitioning&&e.isTransitioning?(this.f_isTransitioning=e.isTransitioning,this.m_inkCanvas&&this.m_inkCanvas.stop(),this.m_inkContainer.style.visibility="hidden"):this.f_isTransitioning&&!e.isTransitioning&&(this.f_isTransitioning=e.isTransitioning,this.m_inkContainer.style.visibility="inherit",this.m_inkCanvas&&this.m_allowInkStart()&&this.m_inkCanvas.start())}constructor(e,t,i,n,r,s,o){this.m_slideIndex=-1,this.f_isInkJsDownloading=!1,this.f_isShowingBlankSlide=!1,this.f_isTransitioning=!1,this.m_metricHelper=new l,this.c_endOfShowLocation={slideIndex:-2,slideId:{sid:-2,cid:-2}},a.a.setLogger(t),this.m_slideshowCore=e,this.m_loadInkJsCallback=n,this.m_parent=i,this.m_inkContainer=function(){const e=document.createElement("div");return e.className="SlideShowCoreInkCanvasContainer",e.style.position="absolute",e.style.pointerEvents="none",e.style.zIndex="10",e.style.overflow="hidden",e}(),this.updateDimensions(),this.m_parent.appendChild(this.m_inkContainer),this.onDownloadCompleted=this.onDownloadCompleted.bind(this),this.onDownloadFailed=this.onDownloadFailed.bind(this),this.onPositionChanged=this.onPositionChanged.bind(this),this.onBlankSlideStateChanged=this.onBlankSlideStateChanged.bind(this),this.onSlideLocationChanging=this.onSlideLocationChanging.bind(this),this.updateDimensions=this.updateDimensions.bind(this),this.m_initInk=r,this.m_slideChanged=s,this.m_allowInkStart=o,this.onPointerDown=this.onPointerDown.bind(this),window.addEventListener("pointerdown",this.onPointerDown)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return h}));var n=i(0),r=i(6),a=i(2),s=i(15);function o(e,t){const i=new n.f(t*l(e.width,e.end),t*d(e.length,e.end));let o;if(e.end==a.q.triangle||e.end==a.q.arrow)o=new s.a([-.5*i.x,-1*i.y,1,0,0,1,.5*i.x,-1*i.y,1],e.end==a.q.triangle);else if(e.end==a.q.stealth)o=new s.a([-.5*i.x,-1*i.y,1,0,0,1,.5*i.x,-1*i.y,1,0,-.5*i.y,1],!0);else if(e.end==a.q.diamond)o=new s.a([0,.5*i.y,1,.5*i.x,0,1,0,-.5*i.y,1,-.5*i.x,0,1],!0);else if(e.end==a.q.oval){const e=new s.b;e.moveTo(.5*i.x,0),e.arcTo(.5*i.x,.5*i.y,0,2*Math.PI),e.close(),o=e.createFigure()}return o||r.a.Error(572867280,"bad arrow head"),o}function l(e,t){return e==a.s.narrow?t==a.q.arrow?2.5:2:e==a.s.medium?t==a.q.arrow?3.5:3:e==a.s.wide?(a.q.arrow,5):(r.a.Error(572867281,"bad arrow head"),0)}function d(e,t){return e==a.r.short?(a.q.arrow,2):e==a.r.medium?(a.q.arrow,3):e==a.r.long?t==a.q.arrow?4.5:5:(r.a.Error(572867282,"bad arrow head"),0)}function c(e,t,i,r,s){const o=(i.end==a.q.diamond||i.end==a.q.oval?.5:1)*d(i.length,i.end)*r,l=(t?e.getPoint(e.getPointCount()-1):e.getPoint(0)).transformPoint(s),c=e.getPointFromDist(o,s,t),h=l.subtract(c).normalized();if(!h)return;const u=new n.f(-h.y,h.x);return new n.c(u.x,u.y,0,h.x,h.y,0,0,0,1).multiply(n.c.Translation2D(l))}function h(e,t){return e?e.end==a.q.none||e.end==a.q.oval||e.end==a.q.diamond?0:e.end==a.q.arrow||e.end==a.q.stealth?t*d(e.length,e.end)/l(e.width,e.end):2*t:0}},function(e,t,i){"use strict";i.d(t,"e",(function(){return f})),i.d(t,"b",(function(){return p})),i.d(t,"d",(function(){return g})),i.d(t,"f",(function(){return _})),i.d(t,"c",(function(){return S})),i.d(t,"a",(function(){return v})),i.d(t,"g",(function(){return y}));var n=i(8),r=i(9),a=i(3),s=i(7),o=i(54),l=i(72),d=i(4),c=i(1);class h{isChangeGateEnabled(e){return d.ChangeGate.isChangeGateEnabled(e)}getFeatureGateValue(e){if(this.slideshowSettings&&this.slideshowSettings.hasOwnProperty(e))return Reflect.get(this.slideshowSettings,e)}getInkJsBasePath(){if(this.slideshowSettings&&void 0!==this.slideshowSettings.jsScriptsBasePath)return this.slideshowSettings.jsScriptsBasePath.replace("/ssapp/","")}constructor(e){this.slideshowSettings=e,this.slideshowSettings&&(this.slideshowSettings.isZoomSyncEnabled=c.a.readBooleanOrDefault("isZoomSyncEnabled",!1),this.slideshowSettings.isInkingInZoomedStateEnabled=c.a.readBooleanOrDefault("isInkingInZoomedStateEnabled",!1),this.slideshowSettings.minimumZoom=c.a.readNumberOrDefault("minimumZoom",1),this.slideshowSettings.maximumZoom=c.a.readNumberOrDefault("maximumZoom",2),this.slideshowSettings.remoteLaserPointerEventsTimeInterval=c.a.readNumberOrDefault("remoteLaserPointerEventsTimeInterval",40),this.slideshowSettings.enableInkOpticalZoomSyncWithSlideOpticalZoomState=c.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1))}}var u=i(106),m=i(134);const f="#E3182D",p="#FFFC00",g="#E3182D",_=4,S=16,v="NONE";class y{onUpdateCanvasZoom(e){if(this.inkOperator&&this.inkAddonCore.m_inkCanvas)try{const t={name:"updateCanvasZoom",value:JSON.stringify(e)};this.inkOperator.act(t)}catch(e){r.a.sendTraceTag(506857295,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon::onUpdateCanvasZoom - "+e)}}onOpticalZoomStateChanged(e){this.m_annotationProxy&&e&&e.metadata&&e.metadata.source===n.d.Sync&&this.m_annotationProxy.setOpticalZoomState(e.currentState),this.onUpdateCanvasOpticalZoom(e.currentState)}onUpdateCanvasOpticalZoom(e){if(this.inkOperator&&this.inkAddonCore.m_inkCanvas&&e)try{const t={name:"updateCanvasOpticalZoom",value:JSON.stringify(e)};this.inkOperator.act(t)}catch(e){r.a.sendTraceTag(506857294,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon::onUpdateCanvasOpticalZoom - "+e)}}onUpdateCanvasPan(e){if(this.inkOperator&&this.inkAddonCore.m_inkCanvas)try{const t={name:"updateCanvasPan",value:JSON.stringify(e)};this.inkOperator.act(t)}catch(e){r.a.sendTraceTag(506857293,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon::onUpdateCanvasPan - "+e)}}roleChanged(){if(this.inkOperator&&this.inkAddonCore.m_inkCanvas)try{const e={name:"updateRoleChange"};this.inkOperator.act(e)}catch(e){r.a.sendTraceTag(506857292,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon::roleChanged - "+e)}}ensureInkCanvas(e,t){this.inkAddonCore.m_inkCanvas?t&&t():(d.ChangeGate.isChangeGateEnabled("SSA.SupportMultiCallbacks")&&t&&this.m_downloadCallbacks.push(t),this.inkAddonCore.metricHelper.boot(e),this.startDownloadingInkJs(()=>{if(this.inkAddonCore.onDownloadCompleted(),d.ChangeGate.isChangeGateEnabled("SSA.SupportMultiCallbacks")){for(const e of this.m_downloadCallbacks)e();this.m_downloadCallbacks=[]}else t&&t()}),r.a.sendTraceTag(506857291,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`SlideShowInkShareAddon: Ink initialization triggered by presenter ${e}.`))}startCursorAtInit(){this.ensureInkCanvas(l.a.Annotation,()=>{this.f_isInkingAllowed&&(this.updateInkToolState(o.b.Select,o.a.Pressed),this.selectNone())}),r.a.sendTraceTag(506857290,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: start inking with cursor as default tool")}setDefaultToCursor(){this.f_isDefaultToCursor=!0,r.a.sendTraceTag(506857289,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: ink tool is default to cursor")}onInkManagerActivity(e){switch(e.item){case"Init":this.ensureInkCanvas(l.a.Menu,null);break;case"Pen":this.selectPen(e.color);break;case"Highlighter":this.selectHighlighter(e.color);break;case"Eraser":this.selectEraser();break;case"None":this.selectNone();break;case"EraseAll":this.inkAddonCore.eraseAll();break;case"SetInkEffect":this.setInkEffect(e.color);break;case"SetColor":this.setColor(e.color);break;case"SetLaserColor":this.setLaserColor(e.color);break;case"Laser":this.selectLaser(e.color);break;case"Select":this.selectSelectTool()}}ensureInkManagerActivity(e){let t=()=>{};switch(u.a.logInkActivity(e.item),e.item){case"Pen":t=()=>{e.value&&this.selectPen(e.value.colorHex,e.value.thickness,e.value.effectPattern)};break;case"Highlighter":t=()=>{e.value&&this.selectHighlighter(e.value.colorHex,e.value.thickness)};break;case"Eraser":t=()=>{this.selectEraser()};break;case"Laser":t=()=>{e.value&&this.selectLaser(e.value.colorHex)};break;case"Select":t=()=>{this.selectSelectTool()};break;case"None":t=()=>{this.selectNone()};break;default:throw"Unknown activity "+e.item}this.ensureInkCanvas(l.a.Menu,t)}perform(e){this.inkOperator&&this.inkOperator.act(e)}enableLocalInking(e){this.f_isInkingAllowed!==e&&(this.f_isInkingAllowed=e,this.f_isDefaultToCursor&&e&&void 0===this.inkAddonCore.m_inkCanvas?this.startCursorAtInit():this.inkAddonCore.m_inkCanvas&&(d.ChangeGate.isChangeGateEnabled("SSA.ClearLaserStrokeInRoleSwitch")&&this.perform({name:"clearLaserStroke"}),e?(this.inkAddonCore.m_inkCanvas.start(),this.setDefaultToolState(),this.inkOperator&&d.ChangeGate.isChangeGateEnabled("SSA.hideSelectTool")&&this.inkOperator.act({name:"hideSelectTool"})):(d.ChangeGate.isChangeGateEnabled("SSA.SelectSelectToolOnSwitchRole")?this.selectSelectTool(!1):this.inkAddonCore.m_inkCanvas.stop(),this.inkOperator&&this.m_slideshowSettings.isCursorMoveEventEnabled&&(this.inkOperator.act({name:"disableLocalInking"}),this.inkOperator.act({name:"updateCursorIcon",value:JSON.stringify(this.f_isHighContrastSlide)})))),u.a.logInkActivity(e?"ToPresenter":"ToAttendee"),r.a.sendTraceTag(506857288,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: enableLocalInking called with value: "+e))}updateSlideShowInkJsName(e){this.m_slideShowInkJsName=e}onSlideHighContrastChanged(e){this.f_isHighContrastSlide=e,this.inkOperator&&(this.m_slideshowSettings.isCursorMoveEventEnabled&&this.inkOperator.act({name:"updateCursorIcon",value:JSON.stringify(e)}),this.m_slideshowSettings.isCustomCursorEnabled&&this.inkOperator.act({name:"setHighContrastMode",value:JSON.stringify(e)}))}setColor(e){this.inkAddonCore.m_inkCanvas?this.isValidHexColor(e)&&(this.inkAddonCore.m_inkCanvas.setColor(e),r.a.sendTraceTag(506857287,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: setColor called with color: "+e)):r.a.sendTraceTag(506857286,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon: setColor called with wrong color format: "+e)}setInkEffect(e){this.inkAddonCore.m_inkCanvas&&e.effectPattern&&e.colorHex&&(this.inkAddonCore.m_inkCanvas.setEffect(e.effectPattern,e.colorHex),r.a.sendTraceTag(506857285,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`SlideShowInkShareAddon: setInkEffect called with pattern: ${e.effectPattern}, fallback color: ${e.colorHex}`))}setLaserColor(e){this.inkAddonCore.m_inkCanvas&&(this.isValidHexColor(e)?(this.inkAddonCore.m_inkCanvas.setLaserColor(e),r.a.sendTraceTag(506857284,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: setLaserColor called with color: "+e)):r.a.sendTraceTag(506857283,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon: setLaserColor called with wrong color format: "+e))}isValidHexColor(e){return e.match(/^#[0-9A-F]{6}$/i)}selectPen(e,t,i){this.inkAddonCore.m_inkCanvas&&(this.exitSelectState(),i&&i!==v?this.inkAddonCore.m_inkCanvas.setEffect(i,e):this.inkAddonCore.m_inkCanvas.setColor(e),t&&this.perform({name:"penSize",value:t.toString()}),this.activeInkingTool=o.b.Pen,this.isInstantInkingEnabled()&&"pen"===this.pickToolInputType?this.inkAddonCore.m_inkCanvas.disableTouchMouse():this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.selectPen(),r.a.sendTraceTag(506857282,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: selectPen called with color: "+e))}selectHighlighter(e,t){this.inkAddonCore.m_inkCanvas&&(this.exitSelectState(),this.inkAddonCore.m_inkCanvas.setColor(e),t&&this.perform({name:"highlightSize",value:t.toString()}),this.activeInkingTool=o.b.Highlighter,this.isInstantInkingEnabled()&&"pen"===this.pickToolInputType?this.inkAddonCore.m_inkCanvas.disableTouchMouse():this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.selectHighlighter(),r.a.sendTraceTag(506857281,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: selectHighlighter called with color: "+e))}selectEraser(){this.inkAddonCore.m_inkCanvas&&(this.exitSelectState(),this.activeInkingTool=o.b.Eraser,this.isInstantInkingEnabled()&&"pen"===this.pickToolInputType?this.inkAddonCore.m_inkCanvas.disableTouchMouse():this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.selectEraser(),r.a.sendTraceTag(506857280,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: selectEraser called"))}selectLaser(e=this.m_defaultLaserColor){this.inkAddonCore.m_inkCanvas&&(this.exitSelectState(),this.inkAddonCore.m_inkCanvas.setLaserColor(e),this.activeInkingTool=o.b.LaserPointer,this.isInstantInkingEnabled()&&"pen"===this.pickToolInputType?this.inkAddonCore.m_inkCanvas.disableTouchMouse():this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.selectLaser(),r.a.sendTraceTag(506857251,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: selectLaser called"))}setDefaultToolState(){this.pickToolInputType=void 0,this.f_isDefaultToCursor?(this.updateInkToolState(o.b.Select,o.a.Pressed),this.selectNone()):(this.selectPen(f,_,v),this.updateInkToolState(o.b.Pen,o.a.Unpressed),this.selectNone())}selectNone(){this.inkAddonCore.m_inkCanvas&&(this.exitSelectState(),this.m_slideshowSettings.isCursorMoveEventEnabled&&this.inkAddonCore.m_inkCanvas.selectNone(),r.a.sendTraceTag(506857250,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: enter none tool state")),this.m_slideshowSettings.isCursorMoveEventEnabled||this.inkAddonCore.selectNone()}selectSelectTool(e=!0){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.disableTouchMouse(),this.isInstantInkingFixEnabled()&&"pen"!==this.pickToolInputType&&e?(this.pickToolInputType=void 0,this.selectNone(),r.a.sendTraceTag(506857249,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: enter partial select tool state")):(this.inkAddonCore.m_inkCanvas.stop(),this.f_isSelectState=!0,this.m_slideshowSettings.isCursorMoveEventEnabled&&this.inkOperator&&e&&this.inkOperator.act({name:"selectSelectTool"}),r.a.sendTraceTag(506857248,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: enter full select tool state")))}exitSelectState(){this.f_isSelectState&&this.inkAddonCore.m_inkCanvas&&(this.f_isInkingAllowed&&(this.inkAddonCore.m_inkCanvas.start(),this.inkAddonCore.m_inkCanvas.enableTouchMouse()),this.m_slideshowSettings.isCursorMoveEventEnabled&&this.inkOperator&&this.inkOperator.act({name:"exitSelectTool"}),r.a.sendTraceTag(506857247,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: exit select tool state"),this.f_isSelectState=!1)}startDownloadingInkJs(e){if(null!=window[this.m_slideShowInkJsName])return r.a.sendTraceTag(506857246,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: slideshowink.js is loaded to the window, no download needed."),this.inkAddonCore.updateDimensions(),void this.initInk();this.inkAddonCore.isInkJsDownloading||(r.a.sendTraceTag(506857245,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: Start downloading slideshowink.js"),this.inkAddonCore.isInkJsDownloading=!0,this.m_annotationProxy&&this.m_annotationProxy.initAnnotation(),this.inkAddonCore.loadInkJsCallback().then(()=>{e()}).catch(e=>{this.inkAddonCore.onDownloadFailed(e)}))}updateRole(e){this.m_annotationProxy&&this.m_annotationProxy.setRole(e)}handleAnnotationEvent(e){this.m_annotationProxy?this.m_annotationProxy.handleAnnotationEvent(e):r.a.sendTraceTag(506857244,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon: receiving annotation events before SlideShowAnnotationProxy is ready")}updateInkToolState(e,t){const i={tool:e,state:t};this.inkAddonCore.slideshowCore.events.emit("inkToolStateChanged",i),r.a.sendTraceTag(506857243,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`SlideShowInkShareAddon: inkToolStateChanged tool: ${e}, state: ${t}`)}updateSelectToolOnInstantToolChange(e){this.isInstantInkingEnabled()&&this.m_slideshowSettings.isCursorMoveEventEnabled&&this.inkOperator&&(e===o.b.Select?this.inkOperator.act({name:"selectSelectTool"}):this.inkOperator.act({name:"exitSelectTool"}))}resetInkCanvas(){const e=this.m_annotationProxy.getInkShareEvents();void 0!==e&&(e.off("pointerUp"),e.off("eraserStart"),e.off("eraserEnd"),e.off("pointerDown")),this.m_annotationProxy.resetInkCanvasAndInkShareEvents(),this.inkOperator=void 0,this.inkAddonCore.resetInkCanvas()}initInk(){if(this.inkAddonCore.m_inkCanvas)return;try{if(slideshowink.inkCanvasFactoryGlobal.setLogger(new l.b),d.ChangeGate.isChangeGateEnabled("SSA.penAndInkingMinutes")&&slideshowink.inkCanvasFactoryGlobal.setActivityLogger(new m.a),this.m_annotationProxy&&slideshowink.inkShareFactoryGlobal){let e;e=c.a.readBooleanOrDefault("enableOpticalZoom",!1)&&c.a.readBooleanOrDefault("enableInkOpticalZoom",!1)?slideshowink.inkShareFactoryGlobal.createInkShareCanvas(this.inkAddonCore.inkContainer,this.inkAddonCore.parent,new h(this.m_slideshowSettings)):slideshowink.inkShareFactoryGlobal.createSlideShowInkShareCanvas(this.inkAddonCore.inkContainer,this.inkAddonCore.parent,new h(this.m_slideshowSettings)),this.m_annotationProxy.init(e);const t=this.m_annotationProxy.getInkShareEvents();void 0!==t&&(t.on("pointerUp",this.switchSelectTool.bind(this)),t.on("eraserStart",this.switchEraserTool.bind(this)),t.on("eraserEnd",this.switchEraserTool.bind(this)),t.on("pointerDown",e=>{e&&""!==e&&(this.pickToolInputType=e)})),this.inkAddonCore.m_inkCanvas=e,this.inkOperator=slideshowink.inkShareFactoryGlobal.createInkOperator(this.inkAddonCore.m_inkCanvas),this.onSlideHighContrastChanged(this.f_isHighContrastSlide),d.ChangeGate.isChangeGateEnabled("SSA.SetPenDefaultInInit")&&(this.perform({name:"penSize",value:_.toString()}),this.setColor(f))}else r.a.sendTraceTag(506857242,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon: init ink canvas - should not be PPTO case}");!this.inkAddonCore.isShowingBlankSlide&&this.f_isInkingAllowed&&!this.f_isSelectState&&this.inkAddonCore.m_inkCanvas&&this.inkAddonCore.m_inkCanvas.start()}catch(e){r.a.sendTraceTag(506857241,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkShareAddon: inkCanvas initialization error: "+JSON.stringify(e))}r.a.sendTraceTag(506857240,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkShareAddon: inkCanvas initialized."),u.a.logInkActivity("InitInk"),this.inkAddonCore.registerAppEventListeners();const e=this.inkAddonCore.slideshowCore.getSlideLocation();e&&this.slideChanged(e),d.ChangeGate.isChangeGateEnabled("SSA.resizeInkCanvasInInit")&&this.inkAddonCore.updateInkCanvasDimensions(),window.removeEventListener("pointerdown",this.inkAddonCore.onPointerDown),r.a.sendTraceTag(506857239,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`SlideShowInkShareAddon: inkCanvas initialization from: ${this.inkAddonCore.metricHelper.getSource().toString()} in time: ${this.inkAddonCore.metricHelper.timeDiff()} with lost stroke count: ${this.inkAddonCore.metricHelper.getLostStrokeCount()}`)}slideChanged(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.currentSlideChanged(e.slideId.sid.toString()),c.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&!c.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&this.m_annotationProxy.syncAnnotationZoom())}allowInkStart(){return this.f_isInkingAllowed&&!this.f_isSelectState}switchSelectTool(){!this.isInstantInkingEnabled()||"pen"!==this.pickToolInputType&&void 0!==this.pickToolInputType||this.updateInkToolState(o.b.Select,o.a.Pressed)}switchEraserTool(){!this.isInstantInkingEnabled()||"pen"!==this.pickToolInputType&&void 0!==this.pickToolInputType||this.updateInkToolState(o.b.Eraser,o.a.Pressed)}isInstantInkingEnabled(){return!0===this.m_slideshowSettings.isInstantInkingBehaviorEnabled}isInstantInkingFixEnabled(){return d.ChangeGate.isChangeGateEnabled("SSA.AllowInstantInkinginSelectMode")&&this.isInstantInkingEnabled()}constructor(e,t,i,n,r,a,s){this.f_isInkingAllowed=!0,this.m_slideShowInkJsName="slideshowinkshare",this.f_isSelectState=!1,this.m_defaultLaserColor="#E3182D",this.f_isDefaultToCursor=!1,this.m_downloadCallbacks=[],this.pickToolInputType=void 0,this.activeInkingTool=o.b.Pen,this.inkAddonCore=new l.c(e,t,i,n,this.initInk.bind(this),this.slideChanged.bind(this),this.allowInkStart.bind(this)),this.inkAddonCore.updateDimensions(),this.f_isHighContrastSlide=a,this.m_slideshowSettings=r,this.m_annotationProxy=new o.c(this.inkAddonCore.slideshowCore.events,this,s);const d=e=>{"pen"===e.pointerType&&(window.removeEventListener("pointerover",d),this.f_isInkingAllowed&&!this.f_isSelectState&&this.ensureInkCanvas(l.a.Pen,null))};this.inkAddonCore.slideshowCore.events.on("updateCanvasZoom",e=>{this.onUpdateCanvasZoom(e)}),this.inkAddonCore.slideshowCore.events.on("updateCanvasPan",e=>{this.onUpdateCanvasPan(e)}),c.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&(this.inkAddonCore.slideshowCore.events.on("opticalZoomStateChanged",e=>{this.onOpticalZoomStateChanged(e)}),this.inkAddonCore.slideshowCore.events.on("updateCanvasOpticalZoom",e=>{this.onUpdateCanvasOpticalZoom(e)})),window.addEventListener("pointerover",d)}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));var n=i(0);function r(){return 4096}class a{isValid(e){return this.m_compatibleGraphicsProcessorId==e.getUniqueGraphicsProcessorId()}discard(){this.m_engine._releaseBuffer(this.vertexBuffer),this.m_engine._releaseBuffer(this.indexBuffer)}static CreateGridXY(e,t,i,r){const s=new Float32Array(t*i*2);for(let e=0;e<i;e++){const a=Object(n.p)(r.top,r.bottom,e/(i-1));for(let i=0;i<t;i++){const o=2*(i+e*t);s[o]=Object(n.p)(r.left,r.right,i/(t-1)),s[o+1]=a}}const o=new Uint16Array((t-1)*(i-1)*2*3);for(let e=0;e<i-1;e++)for(let i=0;i<t-1;i++)o.set([i+e*t,i+1+e*t,i+(e+1)*t,i+1+(e+1)*t,i+(e+1)*t,i+1+e*t],6*(i+e*(t-1)));const l=e.getBabylonEngine();return new a(e,(t-1)*(i-1)*2,l.createVertexBuffer(s),l.createIndexBuffer(o))}constructor(e,t,i,n){this.triangleCount=t,this.vertexBuffer=i,this.indexBuffer=n,this.m_engine=e.getBabylonEngine(),this.m_compatibleGraphicsProcessorId=e.getUniqueGraphicsProcessorId()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return g})),i.d(t,"c",(function(){return _}));var n,r=i(63),a=i(5),s=i(15),o=i(20),l=i(12),d=i(60),c=i(111),h=i(6),u=i(0),m=i(28),f=i(2);!function(e){e[e.fromBegining=0]="fromBegining",e[e.distanceFieldsReady=1]="distanceFieldsReady",e[e.brushTexturesReady=2]="brushTexturesReady",e[e.fadeReady=3]="fadeReady",e[e.effectsReady=4]="effectsReady"}(n||(n={}));class p{get resolvedFillTexture(){var e;return this.fillTexture instanceof l.c?this.fillTexture:null===(e=this.fillTexture)||void 0===e?void 0:e.loader.getTexture(this.fillTexture.wrapMode)}get resolvedLineTexture(){var e;return this.lineTexture instanceof l.c?this.lineTexture:null===(e=this.lineTexture)||void 0===e?void 0:e.loader.getTexture(this.lineTexture.wrapMode)}get resolvedPictureTexture(){var e;return this.pictureTexture instanceof l.c?this.pictureTexture:null===(e=this.pictureTexture)||void 0===e?void 0:e.loader.getTexture(this.pictureTexture.wrapMode)}clearTextures(){this.fillTexture instanceof l.c&&this.fillTexture.releasePolicy==l.e.DisposableCache&&(this.fillTexture.release(),this.fillTexture=void 0),this.lineTexture instanceof l.c&&this.lineTexture.releasePolicy==l.e.DisposableCache&&(this.lineTexture.release(),this.lineTexture=void 0),this.pictureTexture instanceof l.c&&this.pictureTexture.releasePolicy==l.e.DisposableCache&&(this.pictureTexture.release(),this.pictureTexture=void 0)}getBrushTexture(e){switch(e){case a.a.fill:return this.fillTexture;case a.a.line:return this.lineTexture;case a.a.picture:return this.pictureTexture}h.a.Error(591192833,"Invalid brush source")}setBrushTexture(e,t){switch(e){case a.a.fill:this.fillTexture=t;break;case a.a.line:this.lineTexture=t;break;case a.a.picture:this.pictureTexture=t;break;default:h.a.Error(591192834,"Invalid brush source")}}}class g{beforeInitTextures(e,t){if(this.isBlankSlate=!1,this.clientData=e.clientData,this.hasInvalidTexture(t)&&this.clearTextures(),this.checkDistanceFields(e),this.lastKnownShapeVersion==e.version&&e.alphaTracker.version==this.lastKnownAlphaVersion||(this.clearEffectsTextures(this.lastKnownShapeVersion!=e.version,e.alphaTracker.version!=this.lastKnownAlphaVersion),this.drawDistribution=void 0),this.lastKnownShapeVersion=e.version,this.lastKnownAlphaVersion=e.alphaTracker.version,e.getType()==a.g.shape){const t=e;t.geometryTracker.version!=this.lastKnownGeometryVersion&&(this.initTextureStage=n.fromBegining,this.lastKnownGeometryVersion=t.geometryTracker.version)}}getFulltextureList(){const e=[this.innerShadowTexture,this.softEdgesTexture,this.glowTexture,this.borderTexture,this.shadowTexture,this.reflectionTexture,this.replicateBottomTexture,this.replicateTopTexture,this.fadeTexture,this.spriteTexture];e.push(this.styleCache.resolvedFillTexture,this.styleCache.resolvedLineTexture,this.styleCache.resolvedPictureTexture);for(let t of this.distanceFields||[])e.push(t.texture);return this.coutoutLayer&&e.push(this.coutoutLayer.texture),e}getBevelDistanceField(){for(let e of this.distanceFields||[])if(e.isDisplacementMap)return e}hasInvalidTexture(e){const t=this.getFulltextureList();for(let e of this.distanceFields||[])t.push(e.texture);for(let i of t)if(i&&!i.isValidForGraphicsProcessor(e))return!0;return!1}checkDistanceFields(e){if(e.getType()==a.g.shape){const t=e;if(t.geometryTracker.version!=this.lastKnownGeometryVersion)return void this.clearTextures();for(let e of this.distanceFields||[])if(e.geometryUniqueId!=t.geometryTracker.currentUniqueId||e.lastKnownQualitySetting!=l.i||e.lastKnownLineWidth!=t.style.pen.adjustedLineWidth||e.lastKnownLineWidthForArrowHead!=t.style.pen.adjustedLineWidthForArrowHead||e.lastKnownHitTestSlop!=o.u)return void this.clearTextures()}}clearBounds(){this.initTextureStage=n.fromBegining}clearEffectsTextures(e,t){this.initTextureStage=n.fromBegining,e&&(this.reflectionTexture&&this.reflectionTexture.release(),this.fadeTexture&&this.fadeTexture.release(),this.spriteTexture&&this.spriteTexture.release(),this.reflectionTexture=this.fadeTexture=this.spriteTexture=void 0),t&&(this.innerShadowTexture&&this.innerShadowTexture.release(),this.softEdgesTexture&&this.softEdgesTexture.release(),this.glowTexture&&this.glowTexture.release(),this.borderTexture&&this.borderTexture.release(),this.shadowTexture&&this.shadowTexture.release(),this.replicateBottomTexture&&this.replicateBottomTexture.release(),this.replicateTopTexture&&this.replicateTopTexture.release(),this.innerShadowTexture=this.softEdgesTexture=this.glowTexture=this.borderTexture=this.shadowTexture=this.replicateBottomTexture=this.replicateTopTexture=void 0)}clearBrushTextures(){var e,t,i,n,r,a;this.styleCache.clearTextures(),null!==(e=this.fillLookupTableCache)&&void 0!==e&&e.texture&&(null===(n=this.fillLookupTableCache)||void 0===n||n.texture.release(),this.fillLookupTableCache=void 0),null!==(t=this.lineLookupTableCache)&&void 0!==t&&t.texture&&(null===(r=this.lineLookupTableCache)||void 0===r||r.texture.release(),this.lineLookupTableCache=void 0),null!==(i=this.pictureLookupTableCache)&&void 0!==i&&i.texture&&(null===(a=this.pictureLookupTableCache)||void 0===a||a.texture.release(),this.pictureLookupTableCache=void 0)}clearTextures(){this.initTextureStage=n.fromBegining;for(let e of this.distanceFields||[])e&&e.texture&&e.texture.release();this.clearBrushTextures(),this.clearEffectsTextures(!0,!0),this.distanceFields=void 0}releaseGeneratedResources(){var e;this.clearBounds(),this.clearTextures(),this.isBlankSlate=!0,this.coutoutLayer&&(null===(e=this.coutoutLayer.texture)||void 0===e||e.release(),this.coutoutLayer=void 0)}initFadeTexture(e,t,i){if(!e.getGraphicsProcessor())return;const n=i?i.preset==r.d.draw?t.changeTracker.currentUniqueId:i.param+":"+i.preset:"";if(!this.fadeTexture||i&&i.preset!=r.d.uniform&&this.fadeTexture.isValid(e)&&this.fadeTexture.tag==n||(this.fadeTexture.release(),this.fadeTexture=void 0),!this.fadeTexture)if(t.getType()==a.g.shape&&i&&i.preset==r.d.draw){const n=t,r=n.style.pictureBrush,c=r?e.getTextureFromImageBrush(r):void 0;if(r&&c){var o,h,m,f;const t=l.b.RecycleOrReplace("PictureDrawFade",void 0,e,c.size,l.e.DisposableCache,{useFloat:!0});t.originalSize=c.originalSize;const n=Object(a.o)(r.alignment),s=new u.e(n.negate(),r.scale,0,n.add(r.offset)),d=new u.e(new u.f(0,-1),new u.f(1,-1)),p=u.c.FromTransforms(d,s.toInverseMatrix3(),d),g=null!==(o=null===(h=i.drawFadeOptions)||void 0===h?void 0:h.mode)&&void 0!==o?o:0,_=null!==(m=null===(f=i.drawFadeOptions)||void 0===f?void 0:f.order)&&void 0!==m?m:0,S=i.param,v=u.f.Flip(i.flipX,i.flipY),y=i.transposeXY;e.drawTextureToTexture(t,c,l.a.drawMask,{textureTransform:p,drawMaskParams:{drawMaskMode:g,drawMaskOrder:_,drawMaskParam:S,drawMaskFlipXY:v,drawMaskTransposeXY:y}}),this.fadeTexture=t,this.fadeMode=3}else if(n.paths&&n.paths.length>0){const t=new d.a("FadeMask/Draw",e,void 0,s.e.normal,n.mergeMode,0,l.e.DisposableCache,!1);t.generateDrawFadeMask=!0,t.refresh(e,n,!1),this.fadeTexture=t.texture,this.fadeMode=2}}else i&&i.preset!=r.d.uniform&&i.preset!=r.d.draw?(this.fadeTexture=Object(c.c)(e,this.fadeTexture,i.preset,i.param,n),this.fadeMode=2):this.fadeMode=i?1:0}initBrushTexture(e,t,i){const n=this.styleCache.getBrushTexture(i),r=Object(c.b)(e,n,t,i);n!=r&&this.styleCache.setBrushTexture(i,r)}initTextCutoutLayer(e,t,i){if(t){this.coutoutLayer=new d.a("TextCutoutLayer",e,void 0,s.e.normal,a.h.fragment,0,l.e.DisposableCache,!1),this.coutoutLayer.isGlyphCacheDisabled=!0;const n=new a.j(t,i.style);this.coutoutLayer.refresh(e,n,!1);const r=Object(a.q)(n,!1);this.coutoutLayerCenter=null==r?void 0:r.center}else{var n;this.coutoutLayer&&(null===(n=this.coutoutLayer.texture)||void 0===n||n.release(),this.coutoutLayer=void 0)}}updateLookupTableCache(e,t,i){let n=t;return t?t.texture&&(!i||!t.texture.isValid(e)||i&&t.lookupTable&&i!=t.lookupTable&&!i.equals(t.lookupTable))&&(t.texture.release(),t.texture=void 0):i&&(n={lookupTable:i}),n&&!n.texture&&i&&(n.texture=_(e,i,l.e.DisposableCache)),n}ensureLookupTableTexture(e,t,i){var n,r,s;switch(t){case a.a.fill:return this.fillLookupTableCache=this.updateLookupTableCache(e,this.fillLookupTableCache,i),null===(n=this.fillLookupTableCache)||void 0===n?void 0:n.texture;case a.a.line:return this.lineLookupTableCache=this.updateLookupTableCache(e,this.lineLookupTableCache,i),null===(r=this.lineLookupTableCache)||void 0===r?void 0:r.texture;case a.a.picture:return this.pictureLookupTableCache=this.updateLookupTableCache(e,this.pictureLookupTableCache,i),null===(s=this.pictureLookupTableCache)||void 0===s?void 0:s.texture}h.a.Error(509728260,"Invalid brush source")}constructor(){this.initTextureStage=n.fromBegining,this.fadeMode=0,this.spriteQuality=0,this.spriteHitTest=!1,this.isBlankSlate=!1,this.styleCache=new p}}function _(e,t,i){return l.c.CreateFromByteBuffer("LookupTable",e,t.resolution,t.table,m.d.RGB,f.y.clamp,!0,!1,i,!1,1)}},function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return o}));var n,r=(n=[],{fireEvent:function(e){n.forEach((function(t){return t(e)}))},addListener:function(e){e&&n.push(e)}});function a(){return r}function s(e,t,i){r.fireEvent({level:e,category:t,message:i})}function o(e,t,i){s(0,e,(function(){var e=i instanceof Error?i.message:"";return"".concat(t,": ").concat(e)}))}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));const n={};function r(e,t=!1){if(!t||!n[e])return n[e]=!0,e+" needs to be imported before as it contains a side-effect required by your code."}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=4096;var r;!function(e){e.FailedToCreateWebGLContext="Failed to create WebGL context",e.NoBlendMinMaxExt="Unsupported WebGL extension: EXT_blend_minmax",e.NoInstancedArrays="Unsupported WebGL extension: ANGLE_instanced_arrays",e.InsufficientMaxTextureResolution="Insufficient max texture resolution",e.InsufficientCapabilities="Insufficient hardware capabilities",e.BlockedRenderer="Unsupported WebGL renderer",e.Exception="Exception while generating compatibility report"}(r||(r={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(49),r=i(41),a=i(65),s=i(82);class o{static get ShadersRepository(){return a.a.ShadersRepository}static set ShadersRepository(e){a.a.ShadersRepository=e}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new n.a),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}_processShaderCode(e=null,t=!1,i=null){this._processingContext=i||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const n={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:null!=e?e:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:a.a.GetShadersRepository(this._shaderLanguage),includesShadersStore:a.a.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};Object(s.a)(n,this.name,this._processFinalCode,(e,i)=>{this._vertexSourceCode=e,this._fragmentSourceCode=i,this._prepareEffect(t)},this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(e){return this._attributes[e]}getAttributeLocationByName(e){return this._attributeLocationByName[e]}getAttributesCount(){return this._attributes.length}getUniformIndex(e){return this._uniformsNames.indexOf(e)}getUniform(e){return this._uniforms[e]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}executeWhenCompiled(e){this.isReady()?e(this):(this.onCompileObservable.add(t=>{e(t)}),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout(()=>{this._checkIsReady(null)},16))}_checkIsReady(e){try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}this._isDisposed||setTimeout(()=>{this._checkIsReady(e)},16)}get vertexSourceCode(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(e=null===(t=this._pipelineContext)||void 0===t?void 0:t._getVertexShaderCode())&&void 0!==e?e:this._vertexSourceCode}get fragmentSourceCode(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(e=null===(t=this._pipelineContext)||void 0===t?void 0:t._getFragmentShaderCode())&&void 0!==e?e:this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(e,t,i,n){this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=(e,t)=>{n&&n(t)},this.onCompiled=()=>{var e,t;const n=this.getEngine().scenes;if(n)for(let e=0;e<n.length;e++)n[e].markAllMaterialsAsDirty(63);null===(e=(t=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===e||e.call(t,i)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(e){if(this._pipelineContext=e,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let e=0;e<this._attributesNames.length;e++){const t=this._attributesNames[e];this._attributeLocationByName[t]=this._attributes[e]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh()}_prepareEffect(e=!1){const t=this._pipelineContext;this._isReady=!1;try{const i=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),n=i?null:this.defines,r=i?this._vertexSourceCodeOverride:this._vertexSourceCode,a=i?this._fragmentSourceCodeOverride:this._fragmentSourceCode,o=this._engine;this._pipelineContext=Object(s.b)({existingPipelineContext:e?t:null,vertex:r,fragment:a,context:"WEBGL2"===o.shaderPlatformName?o._gl:void 0,rebuildRebind:(e,t,i,n)=>this._rebuildProgram(e,t,i,n),defines:n,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:i,parallelShaderCompile:o._caps.parallelShaderCompile,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:i=>{t&&!e&&this._engine._deletePipelineContext(t),i&&this._onRenderingStateCompiled(i)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContext.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(t)}catch(e){this._processCompilationErrors(e,t)}}_getShaderCodeAndErrorLine(e,t,i){const n=i?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let r=null;if(t&&e){const a=t.match(n);if(a&&2===a.length){const t=parseInt(a[1]),n=e.split("\n",-1);n.length>=t&&(r=`Offending line [${t}] in ${i?"fragment":"vertex"} code: ${n[t-1]}`)}}return[e,r]}_processCompilationErrors(e,t=null){this._compilationError=e.message;const i=this._attributesNames,n=this._fallbacks;if(r.a.Error("Unable to compile effect:"),r.a.Error("Uniforms: "+this._uniformsNames.map((function(e){return" "+e}))),r.a.Error("Attributes: "+i.map((function(e){return" "+e}))),r.a.Error("Defines:\n"+this.defines),o.LogShaderCodeOnCompilationError){var a,s;let e=null,t=null,i=null;var l;null!==(a=this._pipelineContext)&&void 0!==a&&a._getVertexShaderCode()&&([i,e]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),i&&(r.a.Error("Vertex code:"),r.a.Error(i))),null!==(s=this._pipelineContext)&&void 0!==s&&s._getFragmentShaderCode()&&([i,t]=this._getShaderCodeAndErrorLine(null===(l=this._pipelineContext)||void 0===l?void 0:l._getFragmentShaderCode(),this._compilationError,!0),i&&(r.a.Error("Fragment code:"),r.a.Error(i))),e&&r.a.Error(e),t&&r.a.Error(t)}r.a.Error("Error: "+this._compilationError);const d=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)};t&&(this._pipelineContext=t,this._isReady=!0,d()),n?(this._pipelineContext=null,n.hasMoreFallbacks?(this._allFallbacksProcessed=!1,r.a.Error("Trying next fallback."),this.defines=n.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,d(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,t||d())}get isSupported(){return""===this._compilationError}_bindTexture(e,t){this._engine._bindTexture(this._samplers[e],t,e)}setTexture(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)}setTextureArray(e,t){const i=e+"Ex";if(-1===this._samplerList.indexOf(i+"0")){const n=this._samplerList.indexOf(e);for(let e=1;e<t.length;e++){const t=i+(e-1).toString();this._samplerList.splice(n+e,0,t)}let r=0;for(const e of this._samplerList)this._samplers[e]=r,r+=1}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)}bindUniformBuffer(e,t){const i=this._uniformBuffersNames[t];void 0===i||o._BaseCache[i]===e&&this._engine._features.useUBOBindingCache||(o._BaseCache[i]=e,this._engine.bindUniformBufferBase(e,i,t))}bindUniformBlock(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)}setInt(e,t){return this._pipelineContext.setInt(e,t),this}setInt2(e,t,i){return this._pipelineContext.setInt2(e,t,i),this}setInt3(e,t,i,n){return this._pipelineContext.setInt3(e,t,i,n),this}setInt4(e,t,i,n,r){return this._pipelineContext.setInt4(e,t,i,n,r),this}setIntArray(e,t){return this._pipelineContext.setIntArray(e,t),this}setIntArray2(e,t){return this._pipelineContext.setIntArray2(e,t),this}setIntArray3(e,t){return this._pipelineContext.setIntArray3(e,t),this}setIntArray4(e,t){return this._pipelineContext.setIntArray4(e,t),this}setUInt(e,t){return this._pipelineContext.setUInt(e,t),this}setUInt2(e,t,i){return this._pipelineContext.setUInt2(e,t,i),this}setUInt3(e,t,i,n){return this._pipelineContext.setUInt3(e,t,i,n),this}setUInt4(e,t,i,n,r){return this._pipelineContext.setUInt4(e,t,i,n,r),this}setUIntArray(e,t){return this._pipelineContext.setUIntArray(e,t),this}setUIntArray2(e,t){return this._pipelineContext.setUIntArray2(e,t),this}setUIntArray3(e,t){return this._pipelineContext.setUIntArray3(e,t),this}setUIntArray4(e,t){return this._pipelineContext.setUIntArray4(e,t),this}setFloatArray(e,t){return this._pipelineContext.setArray(e,t),this}setFloatArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setFloatArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setFloatArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setArray(e,t){return this._pipelineContext.setArray(e,t),this}setArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setMatrices(e,t){return this._pipelineContext.setMatrices(e,t),this}setMatrix(e,t){return this._pipelineContext.setMatrix(e,t),this}setMatrix3x3(e,t){return this._pipelineContext.setMatrix3x3(e,t),this}setMatrix2x2(e,t){return this._pipelineContext.setMatrix2x2(e,t),this}setFloat(e,t){return this._pipelineContext.setFloat(e,t),this}setBool(e,t){return this._pipelineContext.setInt(e,t?1:0),this}setVector2(e,t){return this._pipelineContext.setVector2(e,t),this}setFloat2(e,t,i){return this._pipelineContext.setFloat2(e,t,i),this}setVector3(e,t){return this._pipelineContext.setVector3(e,t),this}setFloat3(e,t,i,n){return this._pipelineContext.setFloat3(e,t,i,n),this}setVector4(e,t){return this._pipelineContext.setVector4(e,t),this}setQuaternion(e,t){return this._pipelineContext.setQuaternion(e,t),this}setFloat4(e,t,i,n,r){return this._pipelineContext.setFloat4(e,t,i,n,r),this}setColor3(e,t){return this._pipelineContext.setColor3(e,t),this}setColor4(e,t,i){return this._pipelineContext.setColor4(e,t,i),this}setDirectColor4(e,t){return this._pipelineContext.setDirectColor4(e,t),this}dispose(){this._pipelineContext&&Object(s.d)(this._pipelineContext),this._engine._releaseEffect(this),this._isDisposed=!0}static RegisterShader(e,t,i,n=0){t&&(a.a.GetShadersStore(n)[e+"PixelShader"]=t),i&&(a.a.GetShadersStore(n)[e+"VertexShader"]=i)}static ResetCache(){o._BaseCache={}}constructor(e,t,i,r=null,a,l=null,d=null,c=null,h=null,u,m="",f=0){this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new n.a,this.onErrorObservable=new n.a,this._onBindObservable=null,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=e,this._key=m;const p=this._key.replace(/\r/g,"").replace(/\n/g,"|");let g=void 0;if(t.attributes){var _,S,v;const e=t;if(this._engine=i,this._attributesNames=e.attributes,this._uniformsNames=e.uniformsNames.concat(e.samplers),this._samplerList=e.samplers.slice(),this.defines=e.defines,this.onError=e.onError,this.onCompiled=e.onCompiled,this._fallbacks=e.fallbacks,this._indexParameters=e.indexParameters,this._transformFeedbackVaryings=e.transformFeedbackVaryings||null,this._multiTarget=!!e.multiTarget,this._shaderLanguage=null!==(_=e.shaderLanguage)&&void 0!==_?_:0,e.uniformBuffersNames){this._uniformBuffersNamesList=e.uniformBuffersNames.slice();for(let t=0;t<e.uniformBuffersNames.length;t++)this._uniformBuffersNames[e.uniformBuffersNames[t]]=t}this._processFinalCode=null!==(S=e.processFinalCode)&&void 0!==S?S:null,this._processCodeAfterIncludes=null!==(v=e.processCodeAfterIncludes)&&void 0!==v?v:void 0,g=e.existingPipelineContext}else this._engine=a,this.defines=null==l?"":l,this._uniformsNames=i.concat(r),this._samplerList=r?r.slice():[],this._attributesNames=t,this._uniformBuffersNamesList=[],this._shaderLanguage=f,this.onError=h,this.onCompiled=c,this._indexParameters=u,this._fallbacks=d;var y;"WEBGL2"===this._engine.shaderPlatformName&&(g=null!==(y=Object(s.c)(p,this._engine._gl))&&void 0!==y?y:g),this._attributeLocationByName={},this.uniqueId=o._UniqueIdSeed++,g?(this._pipelineContext=g,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCode()}}o.LogShaderCodeOnCompilationError=!0,o._UniqueIdSeed=0,o._BaseCache={},o.ShadersStore=a.a.ShadersStore,o.IncludesShadersStore=a.a.IncludesShadersStore},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(9),r=i(3),a=i(7),s=i(4),o=i(10),l=i(1);class d{logFrameData(e,t){const i=Date.now();if("hidden"!==document.visibilityState){if(!this.m_startTime&&e)this.m_startTime=i,this.m_lastFrameTime=this.m_startTime,this.m_frameData=[];else if(this.m_startTime&&e&&this.m_lastFrameTime)this.m_frameData.push(i-this.m_lastFrameTime),this.m_lastFrameTime=i;else if(this.m_startTime&&!e){const e=i-this.m_startTime;if(this.m_startTime=void 0,0===e||e<=l.a.readNumberOrDefault("animLogMinDurationMs",700))return;const c=this.m_frameData.length+1,h=1e3*c/e;this.m_frameData.sort((e,t)=>e-t);const u={};for(const e of this.m_percentiles){const t=d.percentile(this.m_frameData,e);t&&(u[e.toString()]=t)}const m=this.m_frameData.splice(-l.a.readNumberOrDefault("animLogWorstFrameCount",5)),f={Metadata:{...this.m_metadata,...t?t.metadata:void 0},FrameRate:h.toFixed(2),Duration:e,RenderedFrames:c,Worst:m,Percentile:u};if(n.a.sendTraceTag(595653954,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,JSON.stringify(f)),e<=l.a.readNumberOrDefault("animLogVetoMinDurationMs",1e3))return void n.a.sendTraceTag(506857088,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"AnimatedContentLogger::LogFrameData: Animation is too short, skip checking veto. duration:"+e);let p="SlideshowFPSSlow",g=l.a.readNumberOrDefault("animLogVetoMinFPS",24);if(s.ChangeGate.isChangeGateEnabled("SSC.SeparateSlowFPSVeto")&&t&&(t.qosVetoName&&(p=t.qosVetoName),t.vetoFps&&(g=t.vetoFps)),h<g&&!this.m_metadata.ignoreVeto&&o.e.recordVeto("VetoedFPS"+(this.m_metadata.type||""),{Info:f||this.m_metadata,FPS:h.toFixed(2),vetoFps:g,qosVeto:p}),m&&m.length>0){const e=l.a.readNumberOrDefault("animLogVetoWorstFrameIndex",2),t=Math.min(Math.max(e,0),m.length-1),i=m[m.length-1-t];i>l.a.readNumberOrDefault("animLogVetoMaxFrameDurationMs",300)&&o.e.recordVeto("VetoedFrameDuration"+(this.m_metadata.type||""),{Info:f||this.m_metadata,FrameDuration:i,qosVeto:p})}}}else this.m_startTime=void 0}get hasLogIntervalStarted(){return!!this.m_startTime}static percentile(e,t){if(0!==e.length)return 0===t?e[0]:e[Math.ceil(e.length*(t/100))-1];n.a.sendTraceTag(506857059,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`AnimatedContentLogger::percentile: invalid frameData.length . frameData:${!!e}, percentile:${!!t}`)}constructor(e){this.m_frameData=[],this.m_metadata=e,this.m_metadata.dirtyRectTracking=l.a.readBooleanOrDefault("enableDirtyRectTracking",!1),this.m_metadata.hostContainer=l.a.readStringOrDefault("hostContainer","undefined"),this.m_percentiles=l.a.readStringOrDefault("animLogPercentiles","0, 25, 50, 75, 95, 99, 100").split(",").map(Number),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(this.m_startTime=void 0)})}}},function(e,t,i){"use strict";i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return c})),i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return m}));var n=i(51),r=i(40),a=i(65),s=i(41),o=i(115),l=i(67);function d(e,t){return Object(r.j)(t).cachedPipelines[e]}function c(e){const t=e._name,i=e.context;if(t&&i){const e=Object(r.j)(i),n=e.cachedPipelines[t];null==n||n.dispose(),delete e.cachedPipelines[t]}}function h(e,t,i,r,a,s,l){let d,c;const h=Object(n.d)()?null==s?void 0:s.getHostDocument():null;d="string"==typeof t?t:t.vertexSource?"source:"+t.vertexSource:t.vertexElement?(null==h?void 0:h.getElementById(t.vertexElement))||t.vertexElement:t.vertex||t,c="string"==typeof t?t:t.fragmentSource?"source:"+t.fragmentSource:t.fragmentElement?(null==h?void 0:h.getElementById(t.fragmentElement))||t.fragmentElement:t.fragment||t;const m=[void 0,void 0],f=()=>{if(m[0]&&m[1]){e.isFragment=!0;const[n,d]=m;Object(o.c)(d,e,(s,d)=>{l&&(l._fragmentSourceCodeBeforeMigration=d),i&&(s=i("fragment",s));const c=Object(o.a)(n,s,e);e=null;const h=function(e,t,i,n){if(i){return{vertexSourceCode:(1===n?"//":"")+"#define SHADER_NAME vertex:"+(i.vertexElement||i.vertex||i.spectorName||i)+"\n"+e,fragmentSourceCode:(1===n?"//":"")+"#define SHADER_NAME fragment:"+(i.fragmentElement||i.fragment||i.spectorName||i)+"\n"+t}}return{vertexSourceCode:e,fragmentSourceCode:t}}(c.vertexCode,c.fragmentCode,t,a);null==r||r(h.vertexSourceCode,h.fragmentSourceCode)},s)}};u(d,"Vertex","",t=>{Object(o.b)(e),Object(o.c)(t,e,(e,n)=>{l&&(l._rawVertexSourceCode=t,l._vertexSourceCodeBeforeMigration=n),i&&(e=i("vertex",e)),m[0]=e,f()},s)},a),u(c,"Fragment","Pixel",e=>{l&&(l._rawFragmentSourceCode=e),m[1]=e,f()},a)}function u(e,t,i,r,s,o){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void r(Object(n.a)(e));if("source:"===e.substr(0,7))return void r(e.substr(7));if("base64:"===e.substr(0,7))return void r(window.atob(e.substr(7)));const d=a.a.GetShadersStore(s);if(d[e+t+"Shader"])return void r(d[e+t+"Shader"]);if(i&&d[e+i+"Shader"])return void r(d[e+i+"Shader"]);let c;if(c="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:a.a.GetShadersRepository(s)+e,!(o=o||l.d))throw new Error("loadFileInjection is not defined");o(c+"."+t.toLowerCase()+".fx",r)}const m=(e,t,i,n)=>{try{const a=e.existingPipelineContext||t(e.shaderProcessingContext);return a._name=e.name,e.name&&e.context&&(Object(r.j)(e.context).cachedPipelines[e.name]=a),i(a,e.vertex,e.fragment,!!e.createAsRaw,"","",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,"",()=>{n(a,()=>{var t;null===(t=e.onRenderingStateCompiled)||void 0===t||t.call(e,a)})}),a}catch(e){throw s.a.Error("Error compiling effect"),e}}},function(e,t,i){"use strict";i.d(t,"e",(function(){return h})),i.d(t,"c",(function(){return u})),i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return f})),i.d(t,"g",(function(){return p})),i.d(t,"f",(function(){return g})),i.d(t,"d",(function(){return S})),i.d(t,"h",(function(){return v}));var n=i(58),r=i(109),a=i(99),s=i(44),o=i(9),l=i(3),d=i(7),c=i(47);function h(e){if(!e.name)throw new Error("Event is missing a name");const t=g(e.dataFields),i={eventName:e.name,dataFields:t,eventFlags:{}};return e.samplingPolicy===n.e.Sampled&&(i.eventFlags={samplingPolicy:r.a.SamplingPolicy.Measure}),i}function u(e){if(!e.name)throw new Error("Event is missing a name");const t=g(e.dataFields),i={eventName:e.name,dataFields:t,eventFlags:{},telemetryProperties:{dnmInterval:e.dnmInterval,dnmAllowedPartA:[]}};return e.dnmAllowedPartA&&e.dnmAllowedPartA.forEach(e=>{if(e){const t=e;t&&i.telemetryProperties.dnmAllowedPartA.push(t)}}),i}function m(e){if(!e.name)throw new Error("Event is missing a name");const t=g(e.dataFields),i={eventName:e.name,dataFields:t,eventFlags:{},telemetryProperties:{customerContentVersion:e.customerContentVersion,customerContentType:e.customerContentType}};return e.samplingPolicy===n.e.Sampled&&(i.eventFlags={samplingPolicy:r.a.SamplingPolicy.Measure}),i}function f(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=n.a.None);const t=Math.floor(1e3*e.durationMs),i=g(e.dataFields),r=a.a.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:a.a.contractName,dataFields:r},dataFields:i,eventFlags:{}}}function p(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);const t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);const i=g(e.dataFields),n=a.h.getFields({id:Object(c.d)(e.actionId),name:Object(c.d)(e.actionName),commandSurface:Object(c.d)(e.commandSurface),parentName:Object(c.d)(e.parentName),triggerMethod:Object(c.d)(e.triggerMethod),timeOffsetMs:Object(c.d)(e.timeOffsetMs)});i.push(...n);const r=a.a.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:a.a.contractName,dataFields:r},dataFields:i,eventFlags:{}}}function g(e){const t=[];if(e)for(let i=0;i<e.length;i+=1)t.push(..._(e[i]));return t}function _(e,t){if(!e){const e=Error().stack;return o.a.sendTraceTag(508904220,l.a.msoulscat_Wac_Telemetry,d.a.Warning,`Data field is null, namespace: ${t}, stackTrace: ${e}`),[]}e.name||(e.name="DataFieldNameIsMissing");const i=function(e){return null!=e.string?n.g.String:null!=e.bool?n.g.Boolean:null==e.int64||isNaN(e.int64)?null==e.double||isNaN(e.double)?null!=e.contract?n.g.Contract:null==e.date||isNaN(e.date)?n.g.Unspecified:n.g.Date:n.g.Double:n.g.Int64}(e),r=t?t+"."+e.name:e.name;switch(i){case n.g.Unspecified:return[];case n.g.Boolean:return[s.a(r,e.bool)];case n.g.String:return[s.d(r,e.string)];case n.g.Int64:return[s.c(r,Math.floor(e.int64))];case n.g.Double:return[s.b(r,e.double)];case n.g.Date:return[s.d(r,new Date(e.date).toISOString())];case n.g.Contract:return function(e,t){const i=[];if(t.dataFields)for(let n=0;n<t.dataFields.length;n+=1)i.push(..._(t.dataFields[n],e));return i}(r,e.contract);default:throw new Error(i)}}function S(e){switch(e){case r.a.LogLevel.Verbose:return d.a.Verbose;case r.a.LogLevel.Info:return d.a.Info;case r.a.LogLevel.Warning:return d.a.Warning;case r.a.LogLevel.Error:return d.a.Error;default:throw new Error(e)}}function v(e){const t=e.otelEvent;if(!t||!t.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){const i=g(e.additionalDataFields);t.dataFields.push(...i)}return t}},function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i(9),r=i(3),a=i(7),s=i(13),o=i(19),l=i(10),d=i(4),c=i(1),h=i(42),u=i(11),m=i(61);class f{static getDataFromSlideInfoAndImages(e,t,i){if(e.SlideShowInfo){const o=e.SlideShowInfo,p=o.sld[0];let g;if(p.bg.Item.hasOwnProperty("imgID")){const e=p.bg.Item;g={imageFill:{imgID:e.imgID,rect:{left:e.x,top:e.y,right:e.x+e.w,bottom:e.y+e.h}},solidFill:void 0}}else{const e=p.bg.Item;g={imageFill:void 0,solidFill:{r:e.clr[0],g:e.clr[1],b:e.clr[2],t:e.transp}}}const _=[];let S=void 0,v=void 0;c.a.readBooleanOrDefault("enableAddinViewElement",!1)&&p.appLst&&p.appLst.length>0&&(p.appLst.forEach(e=>{const t=h.a.createAppForOfficeByOsfExtensibleDataObject(e);t&&_.push(t)}),p.appThm&&(S=h.a.readAppForOfficeTheme(p.appThm)),v=_.length>0);const y=[],T=(e,t)=>e.slideId.sid===t.slideId.sid&&e.shapeId===t.shapeId;if(c.a.readBooleanOrDefault("backfillMissingSpId",!1))for(const t of p.spLst){let i=651231861351;for(;p.spLst.some(e=>e.spId&&e.spId.spId===i);)i+=1;t.spId||(n.a.sendTraceTag(506856711,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"Backfilling missing spId for shape"),t.spId={sldId:e.ID.sid,spId:i})}const b=[];for(const e of p.spLst){const t={slideId:{sid:e.spId.sldId,cid:0},shapeId:e.spId.spId};b.some(e=>T(t,e))||b.push(t)}const w=b.map(e=>({id:e}));f.adjustMediaAnimations(p);let C=!1;for(const t of b){let i;if(p.sbLst){const e=p.sbLst.filter(e=>e.spId.sldId===t.slideId.sid&&e.spId.spId===t.shapeId);e.length>0&&(i=e[0].sb)}i||C||(l.e.recordVeto("ContentFallback",{slideId:p.id,ShapeId:t.shapeId,errorName:"ShapeBuilderNotSupportedForShape",qosVeto:"ContentFallback",isIntentional:!0}),d.ChangeGate.isChangeGateEnabled("SSC.ReduceVetoVolumeForSB")&&(C=!0));const o=p.spLst?p.spLst.filter(e=>T(t,{slideId:{sid:e.spId.sldId,cid:0},shapeId:e.spId.spId})):[],h=[],u=[];let m,g,v,b,w,I,P=!1;for(const l of o){l.bgSp&&(P=!0);const o=[],_=(e,t)=>({region:{imgID:e.imgID,rect:{left:e.x,top:e.y,right:e.x+e.w,bottom:e.y+e.h}},pos:new s.k(t.x,t.y)}),S=l.bapis||[];if(i&&l.smlprts){const e=l.smlprts,i=2===e.by?s.g.letter:1===e.by?s.g.word:s.g.whole,n=_(l.reg,l.pos);let r;l.children&&(r=l.children.map(e=>_(e.reg,e.pos)));const a={begin:e.trBegin,length:e.trLength,type:1===e.trType?s.h.paragraph:s.h.character};o.push({fShape:!!e.fSp,fText:!!e.fTx,bigParts:S,regionPos:n,childrenRegionPos:r,splitBy:i,textRange:a,shapeId:t})}else if(i)o.push({fShape:!0,fText:!0,bigParts:S,regionPos:_(l.reg,l.pos),splitBy:s.g.whole,shapeId:t});else if(l.children)for(const[e,i]of l.children.entries())o.push({fShape:!0,fText:!0,bigParts:[`${l.id}c${e}`],regionPos:_(i.reg,i.pos),splitBy:s.g.whole,shapeId:t});else o.push({fShape:!0,fText:!0,bigParts:[l.id.toString()],regionPos:_(l.reg,l.pos),splitBy:s.g.whole,shapeId:t});const y=l.id.toString();if(h.push({id:y,parts:o}),l.clckTgts){const e=new Map,t=new Map;for(const i of l.clckTgts)if("CT_Hyperlink:#p"===i.__type){const t=JSON.stringify({tip:i.tip,url:i.url});e.has(t)?e.get(t).push(i):e.set(t,[i])}else if("CT_Action:#p"===i.__type)if(d.ChangeGate.isChangeGateEnabled("SSC.InternalLinkFixes")){const e=JSON.stringify({tip:i.tip,slideId:{sid:i.sldId,cid:0},desc:i.desc});t.has(e)?t.get(e).push(i):t.set(e,[i])}else u.push({action:{region:{left:i.rct.l,right:i.rct.l+i.rct.w,top:i.rct.t,bottom:i.rct.t+i.rct.h},subRegions:[],slideId:{sid:i.sldId,cid:0},tip:i.tip,desc:i.desc,animatableContentId:y}});else if("CT_InteractiveAnimUse:#p"===i.__type)u.push({animation:{region:{left:i.rct.l,right:i.rct.l+i.rct.w,top:i.rct.t,bottom:i.rct.t+i.rct.h},sequenceId:i.seqId,animatableContentId:y}});else if("CT_MediaCtrl:#p"===i.__type)u.push({mediaCtrl:{region:{left:i.rct.l,right:i.rct.l+i.rct.w,top:i.rct.t,bottom:i.rct.t+i.rct.h},elemId:i.elemId,animatableContentId:y}});else if(c.a.readBooleanOrDefault("enableSummaryZoom",!1)&&"CT_SlideSectionSummaryZoom:#p"===i.__type)if(n.a.sendTraceTag(506856710,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"Summary Zoom detected in Parser"),0===i.zmType)for(const e of i.zmObj)u.push({zoom:{type:s.n.Section,region:{left:e.rct.l,right:e.rct.l+e.rct.w,top:e.rct.t,bottom:e.rct.t+e.rct.h},sectionId:e.sctnId,transitionTime:e.transDur,returnToParent:e.rtn,animatableContentId:y}});else 2===i.zmType?u.push({zoom:{type:s.n.Slide,region:{left:i.zmObj[0].rct.l,right:i.zmObj[0].rct.l+i.zmObj[0].rct.w,top:i.zmObj[0].rct.t,bottom:i.zmObj[0].rct.t+i.zmObj[0].rct.h},slideId:{sid:i.zmObj[0].sldId,cid:0},transitionTime:i.zmObj[0].transDur,returnToParent:i.zmObj[0].rtn,animatableContentId:y}}):1===i.zmType&&u.push({zoom:{type:s.n.Section,region:{left:i.zmObj[0].rct.l,right:i.zmObj[0].rct.l+i.zmObj[0].rct.w,top:i.zmObj[0].rct.t,bottom:i.zmObj[0].rct.t+i.zmObj[0].rct.h},sectionId:i.zmObj[0].sctnId,transitionTime:i.zmObj[0].transDur,returnToParent:i.zmObj[0].rtn,animatableContentId:y}});for(const t of e.values()){if(0===t.length)continue;const e={left:t[0].rct.l,right:t[0].rct.l+t[0].rct.w,top:t[0].rct.t,bottom:t[0].rct.t+t[0].rct.h},i=[];for(const n of t){const t={left:n.rct.l,right:n.rct.l+n.rct.w,top:n.rct.t,bottom:n.rct.t+n.rct.h};i.push(t),e.left=Math.min(t.left,e.left),e.top=Math.min(t.top,e.top),e.right=Math.max(t.right,e.right),e.bottom=Math.max(t.bottom,e.bottom)}u.push({hyperlink:{region:e,subRegions:i,url:t[0].url,tip:t[0].tip,desc:t[0].desc,animatableContentId:y}})}if(d.ChangeGate.isChangeGateEnabled("SSC.InternalLinkFixes"))for(const e of t.values()){if(0===e.length)continue;const t={left:e[0].rct.l,right:e[0].rct.l+e[0].rct.w,top:e[0].rct.t,bottom:e[0].rct.t+e[0].rct.h},i=[];for(const n of e){const e={left:n.rct.l,right:n.rct.l+n.rct.w,top:n.rct.t,bottom:n.rct.t+n.rct.h};i.push(e),t.left=Math.min(e.left,t.left),t.top=Math.min(e.top,t.top),t.right=Math.max(e.right,t.right),t.bottom=Math.max(e.bottom,t.bottom)}u.push({action:{region:t,subRegions:i,slideId:{sid:e[0].sldId,cid:0},tip:e[0].tip,desc:e[0].desc,animatableContentId:y}})}}m||(m=f.readMedia(l.media,t,e.AccessibilityModel)),!g&&l.reg.isGif&&(g=f.readGif(e.MediaUrls,p.resCat,l.reg.imgID)),v||(v=f.readCameo(l.lf)),!w&&l.mdl&&(w=l.mdl),c.a.readBooleanOrDefault("enableAnimatedInk",!1)&&p.inkDataLst&&l.id===parseInt(p.inkDataLst.spIdLst,10)&&!I&&(I=f.readInk(p.inkDataLst))}b||(b=_.find(e=>e.Shape.Id===t.shapeId));const E={shapeId:t,isBackground:P,animatableContents:h,shapeBuilderData:i,clickTargets:u,media:m,gif:g,cameo:v,model3d:w,appForOffice:b,appForOfficeTheme:S,ink:I};y.push(E)}let I=f.parseResCat(p);I=I.map(e=>{const t=i.get(e.id);return!e.url&&t?t:e});try{const e=u.a.performanceNowTrimmed(),t=I.filter(e=>!f.isShapebuilderImage(e)),i=I.filter(e=>f.isShapebuilderImage(e)),s=c.a.readBooleanOrDefault("logPayloadBreakdownExpensiveChecks",!1),l={ExpensiveChecks:s,SlideInfoSize:s?JSON.stringify(o).length:0,SBDataSize:p.sbLst?JSON.stringify(p.sbLst).length:0,GlyphDataSize:p.glyps?JSON.stringify(p.glyps).length:0,FallbackImagesSize:t.reduce((e,t)=>e+t.byteCount,0),SBImageDataSize:i.reduce((e,t)=>e+t.byteCount,0)};n.a.sendTraceTag(506856709,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`${JSON.stringify(l)}, TimeTaken: ${u.a.performanceNowTrimmed()-e}ms`)}catch(e){n.a.sendTraceTag(506856708,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"logPayload ex: "+Object(m.c)(e))}const P={x:o.viewSize.w,y:o.viewSize.h};let E=void 0;if(p.trans){let e=void 0;if(p.trans.morph){const t=p.trans.morph,i=e=>e/65536,n=e=>e?e*Math.PI/180:0,r=e=>{if(!e||!e.data||e.data.length<1)return;const t=new Float32Array(e.w*e.h*2);for(let n=0;n<e.h;n+=1){const r=n*e.w;for(let a=0;a<e.w;a+=1){const s=2*(a+n*e.w);t[s]=i(e.data[a+r].x),t[s+1]=i(e.data[a+r].y)}}return{size:new s.k(e.w,e.h),data:t}},a=e=>{const t=[];for(const i of e.spIdLst||[]){let e;i.txtRng&&(e={begin:i.txtRng.cp,length:i.txtRng.len,type:s.h.character});const n={shapeId:i.id?{slideId:{sid:i.id.sldId,cid:0},shapeId:i.id.spId}:void 0,bigPart:i.bapi?i.bapi.v:void 0,isSubtreeIncluded:i.incSub&&i.incSub.v,textRange:e,animatableContentId:i.spId,animatablePartIndicies:i.chdSpLst?i.chdSpLst.split(" ").map(e=>parseInt(e,10)):[]};t.push(n)}const a=e.imageID?{imgID:e.imageID,rect:{bottom:e.tb,left:e.tl,right:e.tr,top:e.tt}}:void 0;if(0!==t.length||a||e.isBg||e.model3DData)return{parts:t,fallbackImage:a,angleRadians:n(i(-e.a2)),center:new s.k(e.cx,e.cy),flipX:e.flipX,flipY:e.flipY,isBg:e.isBg,size:new s.k(e.w,e.h),zIndex:i(e.z),grid:r(e.grid),model3DData:e.model3DData}},o=[];for(const e of t){const t=a(e.keyFrameA),r=a(e.keyFrameB);if(t&&r){const a=function(e,t){return(e%t+t)%t},l=function(e){return a(e,2*Math.PI)},d=l(t.angleRadians),c=l(n(i(-e.keyFrameA.am))),h=new s.k(Math.cos(d),Math.sin(d)),u=new s.k(Math.cos(c),Math.sin(c)),m=u.x*h.y-u.y*h.x>0;o.push({keyFrameA:t,keyFrameB:r,rotateClockwise:m})}else o.push({keyFrameA:t,keyFrameB:r})}e={elements:o,slideSizePixels:P}}E={morph:e,type:p.trans.type,dir:p.trans.dir,dur:p.trans.dur,stopSound:p.trans.stopSound}}const x=this.parseAccessibilityJSON(t,e.ID,e.Title,e.AccessibilityModel),k={slideId:e.ID,slideSizePixels:P,slideBackground:g,shapeGlyph:p.glyps,resCat:I,fHasAddinShape:v,transData:E,accessibilityModelPromise:x},M=[],A={AnimationList:[],SequenceId:"0_anim"};for(const e of p.animLst.anim||[])A.AnimationList.push(this.createAnimation(e));c.a.readBooleanOrDefault("enableAnimatedInk",!1)&&A.AnimationList.push(f.createInkAnimation(p.inkDataLst)),M.push(A);for(const e of p.animSeqs||[]){const t={AnimationList:[],SequenceId:e.id.toString()};for(const i of e.anim)t.AnimationList.push(this.createAnimation(i));M.push(t)}p.fontSubs&&f.logFontMissing(p.fontSubs);const R={id:k.slideId,spLst:w,hidden:p.hidden,animSeqs:M,ssTimes:this.readSlideAdvanceSettings(p.ssTimes),title:e.Title};this.adjustAutoAdvanceTiming(R);try{0===R.spLst.length&&!R.title&&0===y.length&&k.slideBackground.solidFill&&255===k.slideBackground.solidFill.r&&255===k.slideBackground.solidFill.g&&255===k.slideBackground.solidFill.b&&0===k.slideBackground.solidFill.t&&0===k.resCat.length&&void 0===k.transData&&n.a.sendTraceTag(506795658,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"SSC received blank white slide (not even any placeholders)")}catch(e){n.a.sendTraceTag(506795657,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"Exception while checking for blank white slide "+Object(m.c)(e))}return{slide:R,slideViewData:k,shapeViewDatas:y}}}static isShapebuilderImage(e){return e.name.endsWith(".sb")||e.id.includes("_SB_")||/^[0-9]+_[0-9]+/.test(e.id)}static logFontMissing(e){let t=!1,i=!1,n=!1;for(const r of e)if(!r.e)switch(r.c){case 1:t=!0;break;case 2:i=!0;break;case 3:n=!0}!f.s_fLoggedFirstPartyFontMissing&&t&&(l.e.recordVeto("SSFontMissingFirstParty",{qosVeto:"MissingFont"}),f.s_fLoggedFirstPartyFontMissing=!0),!f.s_fLoggedThirdPartyFontMissing&&i&&(l.e.recordVeto("SSFontMissingThirdParty",{qosVeto:"MissingFont"}),f.s_fLoggedThirdPartyFontMissing=!0),!f.s_fLoggedCustomFontMissing&&n&&(l.e.recordVeto("SSFontMissingCustom",{qosVeto:"MissingFont"}),f.s_fLoggedCustomFontMissing=!0)}static parseResCat(e){const t=[];if(e.resCat)for(const i of e.resCat){const e=t.findIndex(e=>e.id===i.id);if(-1===e)t.push({id:i.id,name:i.name,url:i.base64,byteCount:i.base64.length,urlType:s.i.Base64,mimeType:i.base64.substr(5).split(",")[0],size:{width:i.size?i.size.w:0,height:i.size?i.size.h:0}});else{if(""!==t[e].url)continue;const n=i.base64;t[e].url=n,t[e].mimeType=n.substr(5).split(",")[0],t[e].byteCount=n.length,t[e].urlType=s.i.Base64}}return t}static adjustMediaAnimations(e){if(!(e&&e.animLst&&e.animLst.anim))return;let t=!0;for(const i of e.animLst.anim)if(i.cmd&&""!==i.cmd&&0!==i.timing.st){if(e.spLst){const s=e.spLst.filter(e=>e.id-1===i.sp)[0];if(s)if(s.media){const o=s.media.Item;o?(o.autoPlay&&(t?(delete e.animLst.anim[e.animLst.anim.indexOf(i)],n.a.sendTraceTag(506856707,r.a.msoulscat_Wac_PptAnimation,a.a.Info,`Deleted AutoPlay media animation, sld.id: ${e.id}, shape.id: ${s.id}, media.name: ${s.media.name}, animation.cmd: ${i.cmd}, animation.timing.st: ${i.timing.st}`)):o.autoPlay=!1),i&&(i.timing.st=0)):n.a.sendTraceTag(506856706,r.a.msoulscat_Wac_PptAnimation,a.a.Info,`Unable to get mediaItem from shape.media.Item, sld.id: ${e.id}, shape.id: ${s.id}, media.name: ${s.media.name}`)}else n.a.sendTraceTag(506856705,r.a.msoulscat_Wac_PptAnimation,a.a.Info,`Shape.media was null, did we use the wrong shape id? sld.id: ${e.id}, shape.id: ${s.id}`)}}else t=!1;for(let t=e.animLst.anim.length-1;t>=0;t-=1)e.animLst.anim[t]||e.animLst.anim.splice(t,1)}static adjustAutoAdvanceTiming(e){if(!e.ssTimes||!e.ssTimes.autoAdv)return;const t=e.animSeqs.filter(e=>"0_anim"===e.SequenceId)[0].AnimationList;let i=0,n=0;for(let r=0;r<t.length;r+=1){let a=0;a="def"===t[r].animSpeed?1e3:"sld"===t[r].animSpeed||"clk"===t[r].animSpeed?0:Number.parseInt(t[r].animSpeed,10),t[r].autoReverse&&(a*=2),t[r].numRepeats>0&&(a*=t[r].numRepeats+1),a+=t[r].timeOffs,t[r].startTrig!==o.h.WithPrevious?(n+=i,i=a,t[r].startTrig!==o.h.OnClick||e.ssTimes.clickTimes||(t[r].startTrig=o.h.AfterPrevious)):i=Math.max(i,a)}n+=i,e.ssTimes.autoAdvTime=Math.ceil(Math.max(n,1e3*e.ssTimes.autoAdvTime)/1e3)}static readSlideAdvanceSettings(e){return{manualAdv:!e||e.manualAdv,autoAdv:!!e&&e.autoAdv,autoAdvTime:e?e.autoAdvTime/1e3:0,clickTimes:e&&e.clickTimes?e.clickTimes.split(";").map(e=>parseFloat(e)):void 0}}static async getTableText(e,t,i){if(e.hasOwnProperty("val"))return this.getImgElement(e.val,t);const n=document.createElement("table"),r=e.r,a=e.c,s=e.frhead,o=e.lrhead,l=e.fchead,d=e.lchead,c=[];for(let e=0;e<r;e+=1){c[e]=[];for(let t=0;t<a;t+=1)c[e][t]=!0}let h=-1,u=-1,m=document.createElement("tr");for(const t of e.txt){if(!c[t.r][t.c])continue;t.r!==h&&(h=t.r,t.r>0&&n.appendChild(m),m=document.createElement("tr")),u=t.c;const e=0===h&&s||h===r-1&&o,f=0===u&&l||u===a-1&&d,p=e||f?document.createElement("th"):document.createElement("td");if(t.txthtml){const e=await this.getDivForRichHtmlText(t.txthtml);p.appendChild(e)}else{const e=document.createElement("p");e.textContent=i,p.appendChild(e)}if(t.rs){p.setAttribute("rowspan",""+t.rs);for(let e=h+1;e<h+t.rs;e+=1)c[e][u]=!1}if(t.cs){p.setAttribute("colspan",""+t.cs);for(let e=u+1;e<u+t.cs;e+=1)if(c[h][e]=!1,t.rs)for(let i=h+1;i<h+t.rs;i+=1)c[i][e]=!1}e?p.setAttribute("scope","col"):f&&p.setAttribute("scope","row"),m.appendChild(p)}return n.appendChild(m),n}static getSpanForText(e,t){const i=document.createElement("span");return i.innerText=e,t&&(i.lang=t),i}static async getDivForRichHtmlText(e){const t=document.createElement("div"),n=await i.e(0).then(i.t.bind(null,253,7));let r;r=d.ChangeGate.isChangeGateEnabled("SSC.UseDOMPurifyDefaultExport")&&n.default||n;const a=r.sanitize(e);return t.innerHTML=a,t}static getImgElement(e,t){const i=document.createElement("img");return t&&i.setAttribute("aria-roledescription",t),e.replace(/(\r\n|\n|\r)/gm,". "),i.setAttribute("src","data:,"),i.setAttribute("alt",e),i}static async parseAccessibilityJSON(e,t,i,n){const r=document.createElement("div");r.id="InnerAccessibilityElement",r.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;");const a=[];let s="";if(!n)return{accessibilityInnerDiv:r,slideTitleString:s,shapeAccessibilityDataList:a};const o=JSON.parse(n).shp;if(i)s=i;else for(const e of o)if("Title"===e.tp){s=e.val;break}const l=e.findIndex(e=>e.sid===t.sid),d=this.getLocalizedString();r.appendChild(this.getSpanForText(d.slideContentStr.replace("{0}",""+(l+1))));for(const e of o){const i={tp:e.tp,lang:e.lang,id:e.id,txthtml:e.txthtml,slideId:t,shapeId:e.id,val:this.getSpanForText(""+e.val)};if("Title"===e.tp);else if("Subtitle"===e.tp)r.appendChild(this.getImgElement(e.val,d.subtitleStr)),i.val=this.getImgElement(e.val,d.subtitleStr);else if("Text"===e.tp){const t=e.txthtml?await this.getDivForRichHtmlText(e.txthtml):this.getImgElement(e.val,d.shapeStr);r.appendChild(t),i.val=t}else"SmartArt"===e.tp?(r.appendChild(this.getImgElement(e.val,d.smartartStr)),i.val=this.getImgElement(e.val,d.smartartStr)):"Chart"===e.tp?(r.appendChild(this.getImgElement(e.val,d.chartStr)),i.val=this.getImgElement(e.val,d.chartStr)):"Table"===e.tp?(r.appendChild(await this.getTableText(e,d.tableStr,d.blankTableCellStr)),i.val=await this.getTableText(e,d.tableStr,d.blankTableCellStr)):"Group"===e.tp?(r.appendChild(this.getImgElement(e.val,d.groupStr)),i.val=this.getImgElement(e.val,d.groupStr)):"Picture"===e.tp&&(r.appendChild(this.getImgElement(e.val)),i.val=this.getImgElement(e.val));a.push(i)}return{accessibilityInnerDiv:r,slideTitleString:s,shapeAccessibilityDataList:a}}static getLocalizedString(){let e;return e="undefined"!=typeof PowerpointSlideshowStringsManager?{slideContentStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelSlideContentStr),subtitleStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelSubtitle),smartartStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelSmartArt),chartStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelChart),tableStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelTable),groupStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelGroup),shapeStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelShape),blankTableCellStr:PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.BlankTableCellLabel)}:{slideContentStr:"Slide {0} Content:",subtitleStr:"Subtitle",smartartStr:"Smart Art",chartStr:"Chart",tableStr:"Table",groupStr:"Group",shapeStr:"Shape",blankTableCellStr:"Blank Cell"},e}static createAnimation(e){const t=f.readAnimationScale(e);return{after:f.readAnimAfterEffectType(e),animSpeed:e.timing.spd||"def",autoReverse:e.autoRev,childTimeInc:e.iter?e.iter.interval:-1,direction:e.dir,effectId:e.effectId,effectType:f.readAnimEffectCategory(e.effectType),motionPath:f.readMotionPath(e.mp),numRepeats:f.readRepeatSetting(e.repeat),animatedPropertyList:f.readAnimatedPropertyList(e.propLst),rewind:e.rewind,rotAngDegrees:e.rotAng/1e3,scaleByXPercent:t.x,scaleByYPercent:t.y,shapeId:e.sp.toString(),smoothEndFactor:e.smEnd/100,smoothStartFactor:e.smSt/100,startTrig:f.readAnimStartTrigType(e.timing.st),timeOffs:e.timing.off,transparencyAmountPercent:e.transp,rewindChildDelay:0,mediaCmd:e.cmd}}static readMotionPath(e){if(e){const t=[];for(let i=0;i<e.Items.length;i+=1){const n=f.readMotionPathCommand(e.Items[i]);n&&t.push(n)}return{commandList:t,fReversed:e.rev}}}static readMotionPathCommand(e){if("CT_MotionPathMoveCmd:#p"===e.__type){const t=e;return{type:o.k.MoveTo,end:{x:t.x,y:t.y}}}if("CT_MotionPathLineCmd:#p"===e.__type){const t=e;return{type:o.k.LineTo,end:{x:t.x,y:t.y}}}if("CT_MotionPathCurveCmd:#p"===e.__type){const t=e,i={x:t.x1,y:t.y1},n={x:t.x2,y:t.y2},r={x:t.x3,y:t.y3};return{type:o.k.CurveTo,control1:i,control2:n,end:r}}n.a.sendTraceTag(506856704,r.a.msoulscat_Wac_PptAnimation,a.a.Info,"readMotionPathCommand: : unrecognized command type, ignoring.")}static readAnimationScale(e){return e.scaleBy?new s.k(e.scaleBy.x/1e3,e.scaleBy.y/1e3):new s.k(100,100)}static readAnimAfterEffectType(e){return 1===e.hideAfter?o.a.HideImmediatelyAfter:2===e.hideAfter?o.a.HideOnNextClick:o.a.None}static readAnimEffectCategory(e){let t;switch(e){case 1:t=o.f.Exit;break;case 2:t=o.f.Emphasis;break;case 3:t=o.f.MotionPath;break;case 5:t=o.f.Media;break;default:t=o.f.Entrance}return t}static readRepeatSetting(e){if(e)switch(e.type){case 2:return-1;case 1:return-2;case 0:return e.count;default:return 0}return 0}static readAnimatedPropertyList(e){if(!e||0===e.length)return;const t=[];for(const i of e)t.push({name:i.name,times:i.times.split(";").map(e=>parseFloat(e)),values:i.values.split(";").map(e=>parseFloat(e))});return t}static readAnimStartTrigType(e){switch(e){case 1:return o.h.WithPrevious;case 2:return o.h.AfterPrevious;default:return o.h.OnClick}}static readMedia(e,t,i){if(!e)return;const s=e.Item;let o="";if(i){const e=JSON.parse(i),n=e&&e.shp;for(const e of n)if(e.id===t.shapeId){o=e.val;break}}if("CT_MediaLink:#p"===s.__type){const t=e.Item;return{isLocal:!1,src:t.src,contentType:t.ct,name:e.name,autoPlay:t.autoPlay,repeat:f.translateMediaRepeat(t.repeat),fullscreen:t.fullscreen,playAcrossSlides:t.playAcrossSlides,hideWhenStopped:t.hideWhenStopped,trimStartMs:t.trimStart,trimEndMs:t.trimEnd,volume:t.volume,ariaLabel:o,narration:t.narration}}if("CT_MediaLocal:#p"===s.__type){const t=e.Item;return{isLocal:!0,src:t.src,contentType:t.ct,name:e.name,autoPlay:t.autoPlay,repeat:f.translateMediaRepeat(t.repeat),fullscreen:t.fullscreen,playAcrossSlides:t.playAcrossSlides,hideWhenStopped:t.hideWhenStopped,trimStartMs:t.trimStart,trimEndMs:t.trimEnd,volume:t.volume,bmkLst:t.bmkLst?[...t.bmkLst]:[],ariaLabel:o,tracksInfo:t.tracksInfo,cropInfo:{left:t.cl,top:t.ctop,right:t.cr,bottom:t.cb},narration:t.narration}}if("CT_Error:#p"===s.__type){const i=e.Item;n.a.sendTraceTag(506856675,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`readMedia: Found error with code ${i.id}.`);const s=t.slideId?t.slideId.sid:-1,o={errorCode:i.id,mediaName:`${s}s${t.shapeId}`};n.a.sendTraceTag(570750435,r.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify(o)),l.e.recordVeto("MediaPlaybackFailed",{slideId:s,shapeId:t.shapeId,errorName:f.getMediaErrorName(o.errorCode),errorCode:o.errorCode,mediaName:o.mediaName,qosVeto:"MediaPlaybackFailed",isIntentional:!0})}}static getMediaErrorName(e){switch(e){case 48:return"UnsupportedMediaFormat";case 50:return"UnsupportedMediaLinkTarget";case 52:return"EmbeddedMediaExceedsMaxSize";case 54:return"MediaUnavailable";default:return"OtherMediaError"}}static translateMediaRepeat(e){return 4294967295===e?-1:e}static readGif(e,t,i){if(e&&e.length>0&&t){const n=t.filter(e=>e.id===i),r=e.filter(e=>e.Key===i);if(r.length>0){const e=n[0],t=r[0];let i,a;return t.Value.split(";").map(e=>{const t=decodeURIComponent(e);if(t.search("MediaDownloadHandler")>=0)i=t,a=t.concat("&transcode=videogif");else{const e=new RegExp(/(&|\?)mediaId=(\w+).(\w+).media/i).exec(t),n=e&&4===e.length?e[3].toLowerCase():void 0;n&&("gif"===n?i=t:a=t)}}),{name:t.Key,src:e.base64,imageUrl:i,videoUrl:a}}}else if(t&&t.length>0){const e=t.filter(e=>e.id===i);if(e.length>0){const t=e[0];let i,n;return t.name.split(";").map(e=>{const t=decodeURIComponent(e);if(t.search("MediaDownloadHandler")>=0)i=t,n=t.concat("&transcode=videogif");else{const e=new RegExp(/(&|\?)mediaId=(\w+).(\w+).media/i).exec(t),r=e&&4===e.length?e[3].toLowerCase():void 0;r&&("gif"===r?i=t:n=t)}}),{name:t.id,src:t.base64,imageUrl:i,videoUrl:n}}}}static readCameo(e){if(!e)return;let t=s.a.Normal;if(e.bgPr&&e.bgPr.Item)switch(e.bgPr.Item.__type){case"CT_BackgroundRemovedProperties:#p":t=s.a.Removed;break;case"CT_BackgroundBlurProperties:#p":t=s.a.Blur;break;case"CT_BackgroundCustomProperties:#p":t=s.a.Custom;break;default:t=s.a.Normal}return{backgroundProps:{backgroundType:t}}}static convertInkPos(e){return{x:e.x,y:e.y}}static convertHextoRGB(e){if(e.startsWith("#")&&(e=e.slice(1)),6!==e.length)return{r:0,g:0,b:0};const t=e.slice(0,2),i=e.slice(2,4),n=e.slice(4,6);return{r:parseInt(t,16),g:parseInt(i,16),b:parseInt(n,16)}}static convertPen(e){return{color:f.convertHextoRGB(e.c),thickness:e.th,width:e.w,height:e.h}}static convertInkPoint(e){return e.pen?{pos:f.convertInkPos(e.pos),pen:f.convertPen(e.pen),time:e.t,k:f.convertInkActionKind(e.k)}:{pos:f.convertInkPos(e.pos),time:e.t,k:f.convertInkActionKind(e.k)}}static convertInkActionKind(e){switch(e){case 0:return s.b.move;case 1:return s.b.draw;case 2:return s.b.clear}}static readInk(e){let t=-1/0;return void 0===e.ink?{points:[],lastTime:0}:{points:e.ink.map(e=>(e.t>t&&(t=e.t),f.convertInkPoint(e))),lastTime:t}}static createInkAnimation(e){const t=new s.k(100,100);let i="0";if(e.ink&&e.ink.length>0){let t=e.ink[0].t;for(let i=1;i<e.ink.length;i++)e.ink[i].t>t&&(t=e.ink[i].t);i=t.toString()}return{after:o.a.None,animSpeed:i,autoReverse:!1,childTimeInc:-1,direction:0,effectId:73,effectType:o.f.Entrance,motionPath:void 0,numRepeats:0,animatedPropertyList:void 0,rewind:!1,rotAngDegrees:0,scaleByXPercent:t.x,scaleByYPercent:t.y,shapeId:e.spIdLst,smoothEndFactor:0,smoothStartFactor:0,startTrig:f.readAnimStartTrigType(1),timeOffs:0,transparencyAmountPercent:0,rewindChildDelay:0,mediaCmd:""}}}f.s_fLoggedFirstPartyFontMissing=!1,f.s_fLoggedThirdPartyFontMissing=!1,f.s_fLoggedCustomFontMissing=!1},function(e,t,i){"use strict";i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return h})),i.d(t,"f",(function(){return u})),i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return f})),i.d(t,"c",(function(){return g}));var n=i(70),r=i(88),a=i(110),s=i(87),o=i(71),l=i(26);const d=e=>parseInt(e.toString().replace(/\W/g,""));class c{toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=d(this.x);return e=397*e^d(this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return c.FromArrayToRef(e,t,this),this}asArray(){return[this.x,this.y]}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}setAll(e){return this.copyFromFloats(e,e)}add(e){return new c(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}addInPlaceFromFloats(e,t){return this.x+=e,this.y+=t,this}addVector3(e){return new c(this.x+e.x,this.y+e.y)}subtract(e){return new c(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new c(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t}multiplyByFloats(e,t){return new c(this.x*e,this.y*t)}divide(e){return new c(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t}divideInPlace(e){return this.x=this.x/e.x,this.y=this.y/e.y,this}minimizeInPlace(e){return this.minimizeInPlaceFromFloats(e.x,e.y)}maximizeInPlace(e){return this.maximizeInPlaceFromFloats(e.x,e.y)}minimizeInPlaceFromFloats(e,t){return this.x=Math.min(e,this.x),this.y=Math.min(t,this.y),this}maximizeInPlaceFromFloats(e,t){return this.x=Math.max(e,this.x),this.y=Math.max(t,this.y),this}subtractFromFloats(e,t){return new c(this.x-e,this.y-t)}subtractFromFloatsToRef(e,t,i){return i.x=this.x-e,i.y=this.y-t,i}negate(){return new c(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.x=-this.x,e.y=-this.y,e}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){return new c(this.x*e,this.y*e)}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,t}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,t}equals(e){return e&&this.x===e.x&&this.y===e.y}equalsWithEpsilon(e,t=n.a){return e&&Object(l.f)(this.x,e.x,t)&&Object(l.f)(this.y,e.y,t)}equalsToFloats(e,t){return this.x===e&&this.y===t}floor(){return new c(Math.floor(this.x),Math.floor(this.y))}floorToRef(e){return e.x=Math.floor(this.x),e.y=Math.floor(this.y),e}fract(){return new c(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}fractToRef(e){return e.x=this.x-Math.floor(this.x),e.y=this.y-Math.floor(this.y),e}rotateToRef(e,t){const i=Math.cos(e),n=Math.sin(e),r=i*this.x-n*this.y,a=n*this.x+i*this.y;return t.x=r,t.y=a,t}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return 0===e||1===e?this:this.scaleInPlace(1/e)}normalizeToNew(){const e=new c;return this.normalizeToRef(e),e}normalizeToRef(e){const t=this.length();return 0===t&&(e.x=this.x,e.y=this.y),this.scaleToRef(1/t,e)}clone(){return new c(this.x,this.y)}dot(e){return this.x*e.x+this.y*e.y}static Zero(){return new c(0,0)}static One(){return new c(1,1)}static Random(e=0,t=1){return new c(Object(l.d)(e,t),Object(l.d)(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(Object(l.d)(e,t),Object(l.d)(e,t))}static get ZeroReadOnly(){return c._ZeroReadOnly}static FromArray(e,t=0){return new c(e[t],e[t+1])}static FromArrayToRef(e,t,i){return i.x=e[t],i.y=e[t+1],i}static FromFloatsToRef(e,t,i){return i.copyFromFloats(e,t),i}static CatmullRom(e,t,i,n,r){const a=r*r,s=r*a,o=.5*(2*t.x+(-e.x+i.x)*r+(2*e.x-5*t.x+4*i.x-n.x)*a+(-e.x+3*t.x-3*i.x+n.x)*s),l=.5*(2*t.y+(-e.y+i.y)*r+(2*e.y-5*t.y+4*i.y-n.y)*a+(-e.y+3*t.y-3*i.y+n.y)*s);return new c(o,l)}static ClampToRef(e,t,i,n){return n.x=Object(l.a)(e.x,t.x,i.x),n.y=Object(l.a)(e.y,t.y,i.y),n}static Clamp(e,t,i){const n=Object(l.a)(e.x,t.x,i.x),r=Object(l.a)(e.y,t.y,i.y);return new c(n,r)}static Hermite(e,t,i,n,r){const a=r*r,s=r*a,o=2*s-3*a+1,l=-2*s+3*a,d=s-2*a+r,h=s-a,u=e.x*o+i.x*l+t.x*d+n.x*h,m=e.y*o+i.y*l+t.y*d+n.y*h;return new c(u,m)}static Hermite1stDerivative(e,t,i,n,r){return this.Hermite1stDerivativeToRef(e,t,i,n,r,new c)}static Hermite1stDerivativeToRef(e,t,i,n,r,a){const s=r*r;return a.x=6*(s-r)*e.x+(3*s-4*r+1)*t.x+6*(-s+r)*i.x+(3*s-2*r)*n.x,a.y=6*(s-r)*e.y+(3*s-4*r+1)*t.y+6*(-s+r)*i.y+(3*s-2*r)*n.y,a}static Lerp(e,t,i){return c.LerpToRef(e,t,i,new c)}static LerpToRef(e,t,i,n){return n.x=e.x+(t.x-e.x)*i,n.y=e.y+(t.y-e.y)*i,n}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){return c.NormalizeToRef(e,new c)}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Minimize(e,t){const i=e.x<t.x?e.x:t.x,n=e.y<t.y?e.y:t.y;return new c(i,n)}static Maximize(e,t){const i=e.x>t.x?e.x:t.x,n=e.y>t.y?e.y:t.y;return new c(i,n)}static Transform(e,t){return c.TransformToRef(e,t,new c)}static TransformToRef(e,t,i){const n=t.m,r=e.x*n[0]+e.y*n[4]+n[12],a=e.x*n[1]+e.y*n[5]+n[13];return i.x=r,i.y=a,i}static PointInTriangle(e,t,i,n){const r=.5*(-i.y*n.x+t.y*(-i.x+n.x)+t.x*(i.y-n.y)+i.x*n.y),a=r<0?-1:1,s=(t.y*n.x-t.x*n.y+(n.y-t.y)*e.x+(t.x-n.x)*e.y)*a,o=(t.x*i.y-t.y*i.x+(t.y-i.y)*e.x+(i.x-t.x)*e.y)*a;return s>0&&o>0&&s+o<2*r*a}static Distance(e,t){return Math.sqrt(c.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e.x-t.x,n=e.y-t.y;return i*i+n*n}static Center(e,t){return c.CenterToRef(e,t,new c)}static CenterToRef(e,t,i){return i.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,i){const n=c.DistanceSquared(t,i);if(0===n)return c.Distance(e,t);const r=i.subtract(t),a=Math.max(0,Math.min(1,c.Dot(e.subtract(t),r)/n)),s=t.add(r.multiplyByFloats(a,a));return c.Distance(e,s)}constructor(e=0,t=0){this.x=e,this.y=t}}c._ZeroReadOnly=c.Zero(),Object.defineProperties(c.prototype,{dimension:{value:[2]},rank:{value:1}});class h{get x(){return this._x}set x(e){this._x=e,this._isDirty=!0}get y(){return this._y}set y(e){this._y=e,this._isDirty=!0}get z(){return this._z}set z(e){this._z=e,this._isDirty=!0}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z}}`}getClassName(){return"Vector3"}getHashCode(){let e=d(this._x);return e=397*e^d(this._y),e=397*e^d(this._z),e}asArray(){return[this._x,this._y,this._z]}toArray(e,t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,this}fromArray(e,t=0){return h.FromArrayToRef(e,t,this),this}toQuaternion(){return m.RotationYawPitchRoll(this._y,this._x,this._z)}addInPlace(e){return this._x+=e._x,this._y+=e._y,this._z+=e._z,this._isDirty=!0,this}addInPlaceFromFloats(e,t,i){return this._x+=e,this._y+=t,this._z+=i,this._isDirty=!0,this}add(e){return new h(this._x+e._x,this._y+e._y,this._z+e._z)}addToRef(e,t){return t._x=this._x+e._x,t._y=this._y+e._y,t._z=this._z+e._z,t._isDirty=!0,t}subtractInPlace(e){return this._x-=e._x,this._y-=e._y,this._z-=e._z,this._isDirty=!0,this}subtract(e){return new h(this._x-e._x,this._y-e._y,this._z-e._z)}subtractToRef(e,t){return this.subtractFromFloatsToRef(e._x,e._y,e._z,t)}subtractFromFloats(e,t,i){return new h(this._x-e,this._y-t,this._z-i)}subtractFromFloatsToRef(e,t,i,n){return n._x=this._x-e,n._y=this._y-t,n._z=this._z-i,n._isDirty=!0,n}negate(){return new h(-this._x,-this._y,-this._z)}negateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}negateToRef(e){return e._x=-1*this._x,e._y=-1*this._y,e._z=-1*this._z,e._isDirty=!0,e}scaleInPlace(e){return this._x*=e,this._y*=e,this._z*=e,this._isDirty=!0,this}scale(e){return new h(this._x*e,this._y*e,this._z*e)}scaleToRef(e,t){return t._x=this._x*e,t._y=this._y*e,t._z=this._z*e,t._isDirty=!0,t}getNormalToRef(e){const t=this.length();let i=Math.acos(this.y/t);const n=Math.atan2(this.z,this.x);i>Math.PI/2?i-=Math.PI/2:i+=Math.PI/2;const r=t*Math.sin(i)*Math.cos(n),a=t*Math.cos(i),s=t*Math.sin(i)*Math.sin(n);return e.set(r,a,s),e}applyRotationQuaternionToRef(e,t){const i=this._x,n=this._y,r=this._z,a=e._x,s=e._y,o=e._z,l=e._w,d=2*(s*r-o*n),c=2*(o*i-a*r),h=2*(a*n-s*i);return t._x=i+l*d+s*h-o*c,t._y=n+l*c+o*d-a*h,t._z=r+l*h+a*c-s*d,t._isDirty=!0,t}applyRotationQuaternionInPlace(e){return this.applyRotationQuaternionToRef(e,this)}applyRotationQuaternion(e){return this.applyRotationQuaternionToRef(e,new h)}scaleAndAddToRef(e,t){return t._x+=this._x*e,t._y+=this._y*e,t._z+=this._z*e,t._isDirty=!0,t}projectOnPlane(e,t){return this.projectOnPlaneToRef(e,t,new h)}projectOnPlaneToRef(e,t,i){const n=e.normal,r=e.d,a=p.Vector3[0];this.subtractToRef(t,a),a.normalize();const s=h.Dot(a,n);if(Math.abs(s)<1e-10)i.setAll(1/0);else{const e=-(h.Dot(t,n)+r)/s,o=a.scaleInPlace(e);t.addToRef(o,i)}return i}equals(e){return e&&this._x===e._x&&this._y===e._y&&this._z===e._z}equalsWithEpsilon(e,t=n.a){return e&&Object(l.f)(this._x,e._x,t)&&Object(l.f)(this._y,e._y,t)&&Object(l.f)(this._z,e._z,t)}equalsToFloats(e,t,i){return this._x===e&&this._y===t&&this._z===i}multiplyInPlace(e){return this._x*=e._x,this._y*=e._y,this._z*=e._z,this._isDirty=!0,this}multiply(e){return this.multiplyByFloats(e._x,e._y,e._z)}multiplyToRef(e,t){return t._x=this._x*e._x,t._y=this._y*e._y,t._z=this._z*e._z,t._isDirty=!0,t}multiplyByFloats(e,t,i){return new h(this._x*e,this._y*t,this._z*i)}divide(e){return new h(this._x/e._x,this._y/e._y,this._z/e._z)}divideToRef(e,t){return t._x=this._x/e._x,t._y=this._y/e._y,t._z=this._z/e._z,t._isDirty=!0,t}divideInPlace(e){return this._x=this._x/e._x,this._y=this._y/e._y,this._z=this._z/e._z,this._isDirty=!0,this}minimizeInPlace(e){return this.minimizeInPlaceFromFloats(e._x,e._y,e._z)}maximizeInPlace(e){return this.maximizeInPlaceFromFloats(e._x,e._y,e._z)}minimizeInPlaceFromFloats(e,t,i){return e<this._x&&(this.x=e),t<this._y&&(this.y=t),i<this._z&&(this.z=i),this}maximizeInPlaceFromFloats(e,t,i){return e>this._x&&(this.x=e),t>this._y&&(this.y=t),i>this._z&&(this.z=i),this}isNonUniformWithinEpsilon(e){const t=Math.abs(this._x),i=Math.abs(this._y);if(!Object(l.f)(t,i,e))return!0;const n=Math.abs(this._z);return!Object(l.f)(t,n,e)||!Object(l.f)(i,n,e)}get isNonUniform(){const e=Math.abs(this._x);return e!==Math.abs(this._y)||e!==Math.abs(this._z)}floorToRef(e){return e._x=Math.floor(this._x),e._y=Math.floor(this._y),e._z=Math.floor(this._z),e._isDirty=!0,e}floor(){return new h(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fractToRef(e){return e._x=this.x-Math.floor(this._x),e._y=this.y-Math.floor(this._y),e._z=this.z-Math.floor(this._z),e._isDirty=!0,e}fract(){return new h(this.x-Math.floor(this._x),this.y-Math.floor(this._y),this.z-Math.floor(this._z))}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z}get hasAZeroComponent(){return this._x*this._y*this._z==0}normalize(){return this.normalizeFromLength(this.length())}reorderInPlace(e){if("xyz"===(e=e.toLowerCase()))return this;const t=p.Vector3[0].copyFrom(this);return this.x=t[e[0]],this.y=t[e[1]],this.z=t[e[2]],this}rotateByQuaternionToRef(e,t){return e.toRotationMatrix(p.Matrix[0]),h.TransformCoordinatesToRef(this,p.Matrix[0],t),t}rotateByQuaternionAroundPointToRef(e,t,i){return this.subtractToRef(t,p.Vector3[0]),p.Vector3[0].rotateByQuaternionToRef(e,p.Vector3[0]),t.addToRef(p.Vector3[0],i),i}cross(e){return h.CrossToRef(this,e,new h)}normalizeFromLength(e){return 0===e||1===e?this:this.scaleInPlace(1/e)}normalizeToNew(){return this.normalizeToRef(new h)}normalizeToRef(e){const t=this.length();return 0===t||1===t?(e._x=this._x,e._y=this._y,e._z=this._z,e._isDirty=!0,e):this.scaleToRef(1/t,e)}clone(){return new h(this._x,this._y,this._z)}copyFrom(e){return this.copyFromFloats(e._x,e._y,e._z)}copyFromFloats(e,t,i){return this._x=e,this._y=t,this._z=i,this._isDirty=!0,this}set(e,t,i){return this.copyFromFloats(e,t,i)}setAll(e){return this._x=this._y=this._z=e,this._isDirty=!0,this}static GetClipFactor(e,t,i,n){const r=h.Dot(e,i);return(r-n)/(r-h.Dot(t,i))}static GetAngleBetweenVectors(e,t,i){const n=e.normalizeToRef(p.Vector3[1]),r=t.normalizeToRef(p.Vector3[2]);let a=h.Dot(n,r);a=Object(l.a)(a,-1,1);const s=Math.acos(a),o=p.Vector3[3];return h.CrossToRef(n,r,o),h.Dot(o,i)>0?isNaN(s)?0:s:isNaN(s)?-Math.PI:-Math.acos(a)}static GetAngleBetweenVectorsOnPlane(e,t,i){p.Vector3[0].copyFrom(e);const n=p.Vector3[0];p.Vector3[1].copyFrom(t);const r=p.Vector3[1];p.Vector3[2].copyFrom(i);const a=p.Vector3[2],s=p.Vector3[3],o=p.Vector3[4];n.normalize(),r.normalize(),a.normalize(),h.CrossToRef(a,n,s),h.CrossToRef(s,a,o);const d=Math.atan2(h.Dot(r,s),h.Dot(r,o));return Object(l.c)(d)}static PitchYawRollToMoveBetweenPointsToRef(e,t,i){const n=g.Vector3[0];return t.subtractToRef(e,n),i._y=Math.atan2(n.x,n.z)||0,i._x=Math.atan2(Math.sqrt(n.x**2+n.z**2),n.y)||0,i._z=0,i._isDirty=!0,i}static PitchYawRollToMoveBetweenPoints(e,t){const i=h.Zero();return h.PitchYawRollToMoveBetweenPointsToRef(e,t,i)}static SlerpToRef(e,t,i,r){i=Object(l.a)(i,0,1);const a=p.Vector3[0],s=p.Vector3[1];a.copyFrom(e);const o=a.length();a.normalizeFromLength(o),s.copyFrom(t);const d=s.length();s.normalizeFromLength(d);const c=h.Dot(a,s);let u,m;if(c<1-n.a){const e=Math.acos(c),t=1/Math.sin(e);u=Math.sin((1-i)*e)*t,m=Math.sin(i*e)*t}else u=1-i,m=i;return a.scaleInPlace(u),s.scaleInPlace(m),r.copyFrom(a).addInPlace(s),r.scaleInPlace(Object(l.b)(o,d,i)),r}static SmoothToRef(e,t,i,n,r){return h.SlerpToRef(e,t,0===n?1:i/n,r),r}static FromArray(e,t=0){return new h(e[t],e[t+1],e[t+2])}static FromFloatArray(e,t){return h.FromArray(e,t)}static FromArrayToRef(e,t,i){return i._x=e[t],i._y=e[t+1],i._z=e[t+2],i._isDirty=!0,i}static FromFloatArrayToRef(e,t,i){return h.FromArrayToRef(e,t,i)}static FromFloatsToRef(e,t,i,n){return n.copyFromFloats(e,t,i),n}static Zero(){return new h(0,0,0)}static One(){return new h(1,1,1)}static Up(){return new h(0,1,0)}static get UpReadOnly(){return h._UpReadOnly}static get DownReadOnly(){return h._DownReadOnly}static get RightReadOnly(){return h._RightReadOnly}static get LeftReadOnly(){return h._LeftReadOnly}static get LeftHandedForwardReadOnly(){return h._LeftHandedForwardReadOnly}static get RightHandedForwardReadOnly(){return h._RightHandedForwardReadOnly}static get LeftHandedBackwardReadOnly(){return h._LeftHandedBackwardReadOnly}static get RightHandedBackwardReadOnly(){return h._RightHandedBackwardReadOnly}static get ZeroReadOnly(){return h._ZeroReadOnly}static get OneReadOnly(){return h._OneReadOnly}static Down(){return new h(0,-1,0)}static Forward(e=!1){return new h(0,0,e?-1:1)}static Backward(e=!1){return new h(0,0,e?1:-1)}static Right(){return new h(1,0,0)}static Left(){return new h(-1,0,0)}static Random(e=0,t=1){return new h(Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t))}static TransformCoordinates(e,t){const i=h.Zero();return h.TransformCoordinatesToRef(e,t,i),i}static TransformCoordinatesToRef(e,t,i){return h.TransformCoordinatesFromFloatsToRef(e._x,e._y,e._z,t,i),i}static TransformCoordinatesFromFloatsToRef(e,t,i,n,r){const a=n.m,s=e*a[0]+t*a[4]+i*a[8]+a[12],o=e*a[1]+t*a[5]+i*a[9]+a[13],l=e*a[2]+t*a[6]+i*a[10]+a[14],d=1/(e*a[3]+t*a[7]+i*a[11]+a[15]);return r._x=s*d,r._y=o*d,r._z=l*d,r._isDirty=!0,r}static TransformNormal(e,t){const i=h.Zero();return h.TransformNormalToRef(e,t,i),i}static TransformNormalToRef(e,t,i){return this.TransformNormalFromFloatsToRef(e._x,e._y,e._z,t,i),i}static TransformNormalFromFloatsToRef(e,t,i,n,r){const a=n.m;return r._x=e*a[0]+t*a[4]+i*a[8],r._y=e*a[1]+t*a[5]+i*a[9],r._z=e*a[2]+t*a[6]+i*a[10],r._isDirty=!0,r}static CatmullRom(e,t,i,n,r){const a=r*r,s=r*a,o=.5*(2*t._x+(-e._x+i._x)*r+(2*e._x-5*t._x+4*i._x-n._x)*a+(-e._x+3*t._x-3*i._x+n._x)*s),l=.5*(2*t._y+(-e._y+i._y)*r+(2*e._y-5*t._y+4*i._y-n._y)*a+(-e._y+3*t._y-3*i._y+n._y)*s),d=.5*(2*t._z+(-e._z+i._z)*r+(2*e._z-5*t._z+4*i._z-n._z)*a+(-e._z+3*t._z-3*i._z+n._z)*s);return new h(o,l,d)}static Clamp(e,t,i){const n=new h;return h.ClampToRef(e,t,i,n),n}static ClampToRef(e,t,i,n){let r=e._x;r=r>i._x?i._x:r,r=r<t._x?t._x:r;let a=e._y;a=a>i._y?i._y:a,a=a<t._y?t._y:a;let s=e._z;return s=s>i._z?i._z:s,s=s<t._z?t._z:s,n.copyFromFloats(r,a,s),n}static CheckExtends(e,t,i){t.minimizeInPlace(e),i.maximizeInPlace(e)}static Hermite(e,t,i,n,r){const a=r*r,s=r*a,o=2*s-3*a+1,l=-2*s+3*a,d=s-2*a+r,c=s-a,u=e._x*o+i._x*l+t._x*d+n._x*c,m=e._y*o+i._y*l+t._y*d+n._y*c,f=e._z*o+i._z*l+t._z*d+n._z*c;return new h(u,m,f)}static Hermite1stDerivative(e,t,i,n,r){const a=new h;return this.Hermite1stDerivativeToRef(e,t,i,n,r,a),a}static Hermite1stDerivativeToRef(e,t,i,n,r,a){const s=r*r;return a._x=6*(s-r)*e._x+(3*s-4*r+1)*t._x+6*(-s+r)*i._x+(3*s-2*r)*n._x,a._y=6*(s-r)*e._y+(3*s-4*r+1)*t._y+6*(-s+r)*i._y+(3*s-2*r)*n._y,a._z=6*(s-r)*e._z+(3*s-4*r+1)*t._z+6*(-s+r)*i._z+(3*s-2*r)*n._z,a._isDirty=!0,a}static Lerp(e,t,i){const n=new h(0,0,0);return h.LerpToRef(e,t,i,n),n}static LerpToRef(e,t,i,n){return n._x=e._x+(t._x-e._x)*i,n._y=e._y+(t._y-e._y)*i,n._z=e._z+(t._z-e._z)*i,n._isDirty=!0,n}static Dot(e,t){return e._x*t._x+e._y*t._y+e._z*t._z}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z}static Cross(e,t){const i=new h;return h.CrossToRef(e,t,i),i}static CrossToRef(e,t,i){const n=e._y*t._z-e._z*t._y,r=e._z*t._x-e._x*t._z,a=e._x*t._y-e._y*t._x;return i.copyFromFloats(n,r,a),i}static Normalize(e){const t=h.Zero();return h.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Project(e,t,i,n){const r=new h;return h.ProjectToRef(e,t,i,n,r),r}static ProjectToRef(e,t,i,n,r){var a;const s=n.width,l=n.height,d=n.x,c=n.y,u=p.Matrix[1],m=null===(a=o.a.LastCreatedEngine)||void 0===a?void 0:a.isNDCHalfZRange,g=m?1:.5,_=m?0:.5;f.FromValuesToRef(s/2,0,0,0,0,-l/2,0,0,0,0,g,0,d+s/2,l/2+c,_,1,u);const S=p.Matrix[0];return t.multiplyToRef(i,S),S.multiplyToRef(u,S),h.TransformCoordinatesToRef(e,S,r),r}static Reflect(e,t){return this.ReflectToRef(e,t,new h)}static ReflectToRef(e,t,i){const n=g.Vector3[0];return n.copyFrom(t).scaleInPlace(2*h.Dot(e,t)),i.copyFrom(e).subtractInPlace(n)}static _UnprojectFromInvertedMatrixToRef(e,t,i){h.TransformCoordinatesToRef(e,t,i);const n=t.m,r=e._x*n[3]+e._y*n[7]+e._z*n[11]+n[15];return Object(l.f)(r,1)&&i.scaleInPlace(1/r),i}static UnprojectFromTransform(e,t,i,n,r){return this.Unproject(e,t,i,n,r,f.IdentityReadOnly)}static Unproject(e,t,i,n,r,a){const s=new h;return h.UnprojectToRef(e,t,i,n,r,a,s),s}static UnprojectToRef(e,t,i,n,r,a,s){return h.UnprojectFloatsToRef(e._x,e._y,e._z,t,i,n,r,a,s),s}static UnprojectFloatsToRef(e,t,i,n,r,a,s,l,d){var c;const u=p.Matrix[0];a.multiplyToRef(s,u),u.multiplyToRef(l,u),u.invert();const m=p.Vector3[0];return m.x=e/n*2-1,m.y=-(t/r*2-1),null!==(c=o.a.LastCreatedEngine)&&void 0!==c&&c.isNDCHalfZRange?m.z=i:m.z=2*i-1,h._UnprojectFromInvertedMatrixToRef(m,u,d),d}static Minimize(e,t){const i=new h;return i.copyFrom(e),i.minimizeInPlace(t),i}static Maximize(e,t){const i=new h;return i.copyFrom(e),i.maximizeInPlace(t),i}static Distance(e,t){return Math.sqrt(h.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e._x-t._x,n=e._y-t._y,r=e._z-t._z;return i*i+n*n+r*r}static ProjectOnTriangleToRef(e,t,i,r,a){const s=p.Vector3[0],o=p.Vector3[1],d=p.Vector3[2],c=p.Vector3[3],u=p.Vector3[4];i.subtractToRef(t,s),r.subtractToRef(t,o),r.subtractToRef(i,d);const m=s.length(),f=o.length(),g=d.length();if(m<n.a||f<n.a||g<n.a)return a.copyFrom(t),h.Distance(e,t);e.subtractToRef(t,u),h.CrossToRef(s,o,c);const _=c.length();if(_<n.a)return a.copyFrom(t),h.Distance(e,t);c.normalizeFromLength(_);let S=u.length();if(S<n.a)return a.copyFrom(t),0;u.normalizeFromLength(S);const v=h.Dot(c,u),y=p.Vector3[5],T=p.Vector3[6];y.copyFrom(c).scaleInPlace(-S*v),T.copyFrom(e).addInPlace(y);const b=p.Vector3[4],w=p.Vector3[5],C=p.Vector3[7],I=p.Vector3[8];b.copyFrom(s).scaleInPlace(1/m),I.copyFrom(o).scaleInPlace(1/f),b.addInPlace(I).scaleInPlace(-1),w.copyFrom(s).scaleInPlace(-1/m),I.copyFrom(d).scaleInPlace(1/g),w.addInPlace(I).scaleInPlace(-1),C.copyFrom(d).scaleInPlace(-1/g),I.copyFrom(o).scaleInPlace(-1/f),C.addInPlace(I).scaleInPlace(-1);const P=p.Vector3[9];let E;P.copyFrom(T).subtractInPlace(t),h.CrossToRef(b,P,I),E=h.Dot(I,c);const x=E;P.copyFrom(T).subtractInPlace(i),h.CrossToRef(w,P,I),E=h.Dot(I,c);const k=E;P.copyFrom(T).subtractInPlace(r),h.CrossToRef(C,P,I),E=h.Dot(I,c);const M=E,A=p.Vector3[10];let R,O;x>0&&k<0?(A.copyFrom(s),R=t,O=i):k>0&&M<0?(A.copyFrom(d),R=i,O=r):(A.copyFrom(o).scaleInPlace(-1),R=r,O=t);const F=p.Vector3[9],D=p.Vector3[4];if(R.subtractToRef(T,I),O.subtractToRef(T,F),h.CrossToRef(I,F,D),!(h.Dot(D,c)<0))return a.copyFrom(T),Math.abs(S*v);const L=p.Vector3[5];h.CrossToRef(A,D,L),L.normalize();const B=p.Vector3[9];B.copyFrom(R).subtractInPlace(T);const N=B.length();if(N<n.a)return a.copyFrom(R),h.Distance(e,R);B.normalizeFromLength(N);const V=h.Dot(L,B),W=p.Vector3[7];W.copyFrom(T).addInPlace(L.scaleInPlace(N*V)),I.copyFrom(W).subtractInPlace(R),S=A.length(),A.normalizeFromLength(S);let U=h.Dot(I,A)/Math.max(S,n.a);return U=Object(l.a)(U,0,1),W.copyFrom(R).addInPlace(A.scaleInPlace(U*S)),a.copyFrom(W),h.Distance(e,W)}static Center(e,t){return h.CenterToRef(e,t,h.Zero())}static CenterToRef(e,t,i){return i.copyFromFloats((e._x+t._x)/2,(e._y+t._y)/2,(e._z+t._z)/2)}static RotationFromAxis(e,t,i){const n=new h;return h.RotationFromAxisToRef(e,t,i,n),n}static RotationFromAxisToRef(e,t,i,n){const r=p.Quaternion[0];return m.RotationQuaternionFromAxisToRef(e,t,i,r),r.toEulerAnglesToRef(n),n}constructor(e=0,t=0,i=0){this._isDirty=!0,this._x=e,this._y=t,this._z=i}}h._UpReadOnly=h.Up(),h._DownReadOnly=h.Down(),h._LeftHandedForwardReadOnly=h.Forward(!1),h._RightHandedForwardReadOnly=h.Forward(!0),h._LeftHandedBackwardReadOnly=h.Backward(!1),h._RightHandedBackwardReadOnly=h.Backward(!0),h._RightReadOnly=h.Right(),h._LeftReadOnly=h.Left(),h._ZeroReadOnly=h.Zero(),h._OneReadOnly=h.One(),Object.defineProperties(h.prototype,{dimension:{value:[3]},rank:{value:1}});class u{toString(){return`{X: ${this.x} Y: ${this.y} Z: ${this.z} W: ${this.w}}`}getClassName(){return"Vector4"}getHashCode(){let e=d(this.x);return e=397*e^d(this.y),e=397*e^d(this.z),e=397*e^d(this.w),e}asArray(){return[this.x,this.y,this.z,this.w]}toArray(e,t){return void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,this}fromArray(e,t=0){return u.FromArrayToRef(e,t,this),this}addInPlace(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addInPlaceFromFloats(e,t,i,n){return this.x+=e,this.y+=t,this.z+=i,this.w+=n,this}add(e){return new u(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t.z=this.z+e.z,t.w=this.w+e.w,t}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subtract(e){return new u(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z,t.w=this.w-e.w,t}subtractFromFloats(e,t,i,n){return new u(this.x-e,this.y-t,this.z-i,this.w-n)}subtractFromFloatsToRef(e,t,i,n,r){return r.x=this.x-e,r.y=this.y-t,r.z=this.z-i,r.w=this.w-n,r}negate(){return new u(-this.x,-this.y,-this.z,-this.w)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this}negateToRef(e){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=-this.w,e}scaleInPlace(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}scale(e){return new u(this.x*e,this.y*e,this.z*e,this.w*e)}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e,t}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,t.z+=this.z*e,t.w+=this.w*e,t}equals(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w}equalsWithEpsilon(e,t=n.a){return e&&Object(l.f)(this.x,e.x,t)&&Object(l.f)(this.y,e.y,t)&&Object(l.f)(this.z,e.z,t)&&Object(l.f)(this.w,e.w,t)}equalsToFloats(e,t,i,n){return this.x===e&&this.y===t&&this.z===i&&this.w===n}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiply(e){return new u(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t.z=this.z*e.z,t.w=this.w*e.w,t}multiplyByFloats(e,t,i,n){return new u(this.x*e,this.y*t,this.z*i,this.w*n)}divide(e){return new u(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t.z=this.z/e.z,t.w=this.w/e.w,t}divideInPlace(e){return this.divideToRef(e,this)}minimizeInPlace(e){return e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.z<this.z&&(this.z=e.z),e.w<this.w&&(this.w=e.w),this}maximizeInPlace(e){return e.x>this.x&&(this.x=e.x),e.y>this.y&&(this.y=e.y),e.z>this.z&&(this.z=e.z),e.w>this.w&&(this.w=e.w),this}minimizeInPlaceFromFloats(e,t,i,n){return this.x=Math.min(e,this.x),this.y=Math.min(t,this.y),this.z=Math.min(i,this.z),this.w=Math.min(n,this.w),this}maximizeInPlaceFromFloats(e,t,i,n){return this.x=Math.max(e,this.x),this.y=Math.max(t,this.y),this.z=Math.max(i,this.z),this.w=Math.max(n,this.w),this}floorToRef(e){return e.x=Math.floor(this.x),e.y=Math.floor(this.y),e.z=Math.floor(this.z),e.w=Math.floor(this.w),e}floor(){return new u(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fractToRef(e){return e.x=this.x-Math.floor(this.x),e.y=this.y-Math.floor(this.y),e.z=this.z-Math.floor(this.z),e.w=this.w-Math.floor(this.w),e}fract(){return new u(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return 0===e||1===e?this:this.scaleInPlace(1/e)}normalizeToNew(){return this.normalizeToRef(new u)}normalizeToRef(e){const t=this.length();return 0===t||1===t?(e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e):this.scaleToRef(1/t,e)}toVector3(){return new h(this.x,this.y,this.z)}clone(){return new u(this.x,this.y,this.z,this.w)}copyFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}copyFromFloats(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}set(e,t,i,n){return this.copyFromFloats(e,t,i,n)}setAll(e){return this.x=this.y=this.z=this.w=e,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}static FromArray(e,t){return t||(t=0),new u(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e,t,i){return i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3],i}static FromFloatArrayToRef(e,t,i){return u.FromArrayToRef(e,t,i),i}static FromFloatsToRef(e,t,i,n,r){return r.x=e,r.y=t,r.z=i,r.w=n,r}static Zero(){return new u(0,0,0,0)}static One(){return new u(1,1,1,1)}static Random(e=0,t=1){return new u(Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t))}static RandomToRef(e=0,t=1,i){return i.x=Object(l.d)(e,t),i.y=Object(l.d)(e,t),i.z=Object(l.d)(e,t),i.w=Object(l.d)(e,t),i}static Clamp(e,t,i){return u.ClampToRef(e,t,i,new u)}static ClampToRef(e,t,i,n){return n.x=Object(l.a)(e.x,t.x,i.x),n.y=Object(l.a)(e.y,t.y,i.y),n.z=Object(l.a)(e.z,t.z,i.z),n.w=Object(l.a)(e.w,t.w,i.w),n}static CheckExtends(e,t,i){t.minimizeInPlace(e),i.maximizeInPlace(e)}static get ZeroReadOnly(){return u._ZeroReadOnly}static Normalize(e){return u.NormalizeToRef(e,new u)}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Minimize(e,t){const i=new u;return i.copyFrom(e),i.minimizeInPlace(t),i}static Maximize(e,t){const i=new u;return i.copyFrom(e),i.maximizeInPlace(t),i}static Distance(e,t){return Math.sqrt(u.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e.x-t.x,n=e.y-t.y,r=e.z-t.z,a=e.w-t.w;return i*i+n*n+r*r+a*a}static Center(e,t){return u.CenterToRef(e,t,new u)}static CenterToRef(e,t,i){return i.x=(e.x+t.x)/2,i.y=(e.y+t.y)/2,i.z=(e.z+t.z)/2,i.w=(e.w+t.w)/2,i}static TransformCoordinates(e,t){return u.TransformCoordinatesToRef(e,t,new u)}static TransformCoordinatesToRef(e,t,i){return u.TransformCoordinatesFromFloatsToRef(e._x,e._y,e._z,t,i),i}static TransformCoordinatesFromFloatsToRef(e,t,i,n,r){const a=n.m,s=e*a[0]+t*a[4]+i*a[8]+a[12],o=e*a[1]+t*a[5]+i*a[9]+a[13],l=e*a[2]+t*a[6]+i*a[10]+a[14],d=e*a[3]+t*a[7]+i*a[11]+a[15];return r.x=s,r.y=o,r.z=l,r.w=d,r}static TransformNormal(e,t){return u.TransformNormalToRef(e,t,new u)}static TransformNormalToRef(e,t,i){const n=t.m,r=e.x*n[0]+e.y*n[4]+e.z*n[8],a=e.x*n[1]+e.y*n[5]+e.z*n[9],s=e.x*n[2]+e.y*n[6]+e.z*n[10];return i.x=r,i.y=a,i.z=s,i.w=e.w,i}static TransformNormalFromFloatsToRef(e,t,i,n,r,a){const s=r.m;return a.x=e*s[0]+t*s[4]+i*s[8],a.y=e*s[1]+t*s[5]+i*s[9],a.z=e*s[2]+t*s[6]+i*s[10],a.w=n,a}static FromVector3(e,t=0){return new u(e._x,e._y,e._z,t)}static Dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.z=i,this.w=n}}u._ZeroReadOnly=u.Zero(),Object.defineProperties(u.prototype,{dimension:{value:[4]},rank:{value:1}});class m{get x(){return this._x}set x(e){this._x=e,this._isDirty=!0}get y(){return this._y}set y(e){this._y=e,this._isDirty=!0}get z(){return this._z}set z(e){this._z=e,this._isDirty=!0}get w(){return this._w}set w(e){this._w=e,this._isDirty=!0}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z} W: ${this._w}}`}getClassName(){return"Quaternion"}getHashCode(){let e=d(this._x);return e=397*e^d(this._y),e=397*e^d(this._z),e=397*e^d(this._w),e}asArray(){return[this._x,this._y,this._z,this._w]}toArray(e,t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,this}fromArray(e,t=0){return m.FromArrayToRef(e,t,this)}equals(e){return e&&this._x===e._x&&this._y===e._y&&this._z===e._z&&this._w===e._w}equalsWithEpsilon(e,t=n.a){return e&&Object(l.f)(this._x,e._x,t)&&Object(l.f)(this._y,e._y,t)&&Object(l.f)(this._z,e._z,t)&&Object(l.f)(this._w,e._w,t)}clone(){return new m(this._x,this._y,this._z,this._w)}copyFrom(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._w=e._w,this._isDirty=!0,this}copyFromFloats(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._isDirty=!0,this}set(e,t,i,n){return this.copyFromFloats(e,t,i,n)}setAll(e){return this.copyFromFloats(e,e,e,e)}add(e){return new m(this._x+e._x,this._y+e._y,this._z+e._z,this._w+e._w)}addInPlace(e){return this._x+=e._x,this._y+=e._y,this._z+=e._z,this._w+=e._w,this._isDirty=!0,this}addToRef(e,t){return t._x=this._x+e._x,t._y=this._y+e._y,t._z=this._z+e._z,t._w=this._w+e._w,t._isDirty=!0,t}addInPlaceFromFloats(e,t,i,n){return this._x+=e,this._y+=t,this._z+=i,this._w+=n,this._isDirty=!0,this}subtractToRef(e,t){return t._x=this._x-e._x,t._y=this._y-e._y,t._z=this._z-e._z,t._w=this._w-e._w,t._isDirty=!0,t}subtractFromFloats(e,t,i,n){return this.subtractFromFloatsToRef(e,t,i,n,new m)}subtractFromFloatsToRef(e,t,i,n,r){return r._x=this._x-e,r._y=this._y-t,r._z=this._z-i,r._w=this._w-n,r._isDirty=!0,r}subtract(e){return new m(this._x-e._x,this._y-e._y,this._z-e._z,this._w-e._w)}subtractInPlace(e){return this._x-=e._x,this._y-=e._y,this._z-=e._z,this._w-=e._w,this._isDirty=!0,this}scale(e){return new m(this._x*e,this._y*e,this._z*e,this._w*e)}scaleToRef(e,t){return t._x=this._x*e,t._y=this._y*e,t._z=this._z*e,t._w=this._w*e,t._isDirty=!0,t}scaleInPlace(e){return this._x*=e,this._y*=e,this._z*=e,this._w*=e,this._isDirty=!0,this}scaleAndAddToRef(e,t){return t._x+=this._x*e,t._y+=this._y*e,t._z+=this._z*e,t._w+=this._w*e,t._isDirty=!0,t}multiply(e){const t=new m(0,0,0,1);return this.multiplyToRef(e,t),t}multiplyToRef(e,t){const i=this._x*e._w+this._y*e._z-this._z*e._y+this._w*e._x,n=-this._x*e._z+this._y*e._w+this._z*e._x+this._w*e._y,r=this._x*e._y-this._y*e._x+this._z*e._w+this._w*e._z,a=-this._x*e._x-this._y*e._y-this._z*e._z+this._w*e._w;return t.copyFromFloats(i,n,r,a),t}multiplyInPlace(e){return this.multiplyToRef(e,this)}multiplyByFloats(e,t,i,n){return this._x*=e,this._y*=t,this._z*=i,this._w*=n,this._isDirty=!0,this}divide(e){throw new ReferenceError("Can not divide a quaternion")}divideToRef(e,t){throw new ReferenceError("Can not divide a quaternion")}divideInPlace(e){throw new ReferenceError("Can not divide a quaternion")}minimizeInPlace(){throw new ReferenceError("Can not minimize a quaternion")}minimizeInPlaceFromFloats(){throw new ReferenceError("Can not minimize a quaternion")}maximizeInPlace(){throw new ReferenceError("Can not maximize a quaternion")}maximizeInPlaceFromFloats(){throw new ReferenceError("Can not maximize a quaternion")}negate(){return this.negateToRef(new m)}negateInPlace(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this._isDirty=!0,this}negateToRef(e){return e._x=-this._x,e._y=-this._y,e._z=-this._z,e._w=-this._w,e._isDirty=!0,e}equalsToFloats(e,t,i,n){return this._x===e&&this._y===t&&this._z===i&&this._w===n}floorToRef(e){throw new ReferenceError("Can not floor a quaternion")}floor(){throw new ReferenceError("Can not floor a quaternion")}fractToRef(e){throw new ReferenceError("Can not fract a quaternion")}fract(){throw new ReferenceError("Can not fract a quaternion")}conjugateToRef(e){return e.copyFromFloats(-this._x,-this._y,-this._z,this._w),e}conjugateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}conjugate(){return new m(-this._x,-this._y,-this._z,this._w)}invert(){const e=this.conjugate(),t=this.lengthSquared();return 0==t||1==t||e.scaleInPlace(1/t),e}invertInPlace(){this.conjugateInPlace();const e=this.lengthSquared();return 0==e||1==e||this.scaleInPlace(1/e),this}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(e){return 0===e||1===e?this:this.scaleInPlace(1/e)}normalizeToNew(){const e=new m(0,0,0,1);return this.normalizeToRef(e),e}normalizeToRef(e){const t=this.length();return 0===t||1===t?e.copyFromFloats(this._x,this._y,this._z,this._w):this.scaleToRef(1/t,e)}toEulerAngles(){const e=h.Zero();return this.toEulerAnglesToRef(e),e}toEulerAnglesToRef(e){const t=this._z,i=this._x,n=this._y,r=this._w,a=n*t-i*r;if(a<-.4999999)e._y=2*Math.atan2(n,r),e._x=Math.PI/2,e._z=0,e._isDirty=!0;else if(a>.4999999)e._y=2*Math.atan2(n,r),e._x=-Math.PI/2,e._z=0,e._isDirty=!0;else{const s=r*r,o=t*t,l=i*i,d=n*n;e._z=Math.atan2(2*(i*n+t*r),-o-l+d+s),e._x=Math.asin(-2*a),e._y=Math.atan2(2*(t*i+n*r),o-l-d+s),e._isDirty=!0}return e}toAlphaBetaGammaToRef(e){const t=this._z,i=this._x,n=this._y,r=this._w,a=Math.sqrt(i*i+n*n),s=Math.sqrt(t*t+r*r),o=2*Math.atan2(a,s),l=2*Math.atan2(t,r),d=2*Math.atan2(n,i),c=(l+d)/2,h=(l-d)/2;return e.set(h,o,c),e}toRotationMatrix(e){return f.FromQuaternionToRef(this,e),e}fromRotationMatrix(e){return m.FromRotationMatrixToRef(e,this),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}static FromRotationMatrix(e){const t=new m;return m.FromRotationMatrixToRef(e,t),t}static FromRotationMatrixToRef(e,t){const i=e.m,n=i[0],r=i[4],a=i[8],s=i[1],o=i[5],l=i[9],d=i[2],c=i[6],h=i[10],u=n+o+h;let m;return u>0?(m=.5/Math.sqrt(u+1),t._w=.25/m,t._x=(c-l)*m,t._y=(a-d)*m,t._z=(s-r)*m,t._isDirty=!0):n>o&&n>h?(m=2*Math.sqrt(1+n-o-h),t._w=(c-l)/m,t._x=.25*m,t._y=(r+s)/m,t._z=(a+d)/m,t._isDirty=!0):o>h?(m=2*Math.sqrt(1+o-n-h),t._w=(a-d)/m,t._x=(r+s)/m,t._y=.25*m,t._z=(l+c)/m,t._isDirty=!0):(m=2*Math.sqrt(1+h-n-o),t._w=(s-r)/m,t._x=(a+d)/m,t._y=(l+c)/m,t._z=.25*m,t._isDirty=!0),t}static Dot(e,t){return e._x*t._x+e._y*t._y+e._z*t._z+e._w*t._w}static AreClose(e,t,i=.1){const n=m.Dot(e,t);return 1-n*n<=i}static SmoothToRef(e,t,i,n,r){let a=0===n?1:i/n;return a=Object(l.a)(a,0,1),m.SlerpToRef(e,t,a,r),r}static Zero(){return new m(0,0,0,0)}static Inverse(e){return new m(-e._x,-e._y,-e._z,e._w)}static InverseToRef(e,t){return t.set(-e._x,-e._y,-e._z,e._w),t}static Identity(){return new m(0,0,0,1)}static IsIdentity(e){return e&&0===e._x&&0===e._y&&0===e._z&&1===e._w}static RotationAxis(e,t){return m.RotationAxisToRef(e,t,new m)}static RotationAxisToRef(e,t,i){i._w=Math.cos(t/2);const n=Math.sin(t/2)/e.length();return i._x=e._x*n,i._y=e._y*n,i._z=e._z*n,i._isDirty=!0,i}static FromArray(e,t){return t||(t=0),new m(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e,t,i){return i._x=e[t],i._y=e[t+1],i._z=e[t+2],i._w=e[t+3],i._isDirty=!0,i}static FromFloatsToRef(e,t,i,n,r){return r.copyFromFloats(e,t,i,n),r}static FromEulerAngles(e,t,i){const n=new m;return m.RotationYawPitchRollToRef(t,e,i,n),n}static FromEulerAnglesToRef(e,t,i,n){return m.RotationYawPitchRollToRef(t,e,i,n),n}static FromEulerVector(e){const t=new m;return m.RotationYawPitchRollToRef(e._y,e._x,e._z,t),t}static FromEulerVectorToRef(e,t){return m.RotationYawPitchRollToRef(e._y,e._x,e._z,t),t}static FromUnitVectorsToRef(e,t,i,r=n.a){const a=h.Dot(e,t)+1;return a<r?Math.abs(e.x)>Math.abs(e.z)?i.set(-e.y,e.x,0,0):i.set(0,-e.z,e.y,0):(h.CrossToRef(e,t,g.Vector3[0]),i.set(g.Vector3[0].x,g.Vector3[0].y,g.Vector3[0].z,a)),i.normalize()}static RotationYawPitchRoll(e,t,i){const n=new m;return m.RotationYawPitchRollToRef(e,t,i,n),n}static RotationYawPitchRollToRef(e,t,i,n){const r=.5*i,a=.5*t,s=.5*e,o=Math.sin(r),l=Math.cos(r),d=Math.sin(a),c=Math.cos(a),h=Math.sin(s),u=Math.cos(s);return n._x=u*d*l+h*c*o,n._y=h*c*l-u*d*o,n._z=u*c*o-h*d*l,n._w=u*c*l+h*d*o,n._isDirty=!0,n}static RotationAlphaBetaGamma(e,t,i){const n=new m;return m.RotationAlphaBetaGammaToRef(e,t,i,n),n}static RotationAlphaBetaGammaToRef(e,t,i,n){const r=.5*(i+e),a=.5*(i-e),s=.5*t;return n._x=Math.cos(a)*Math.sin(s),n._y=Math.sin(a)*Math.sin(s),n._z=Math.sin(r)*Math.cos(s),n._w=Math.cos(r)*Math.cos(s),n._isDirty=!0,n}static RotationQuaternionFromAxis(e,t,i){const n=new m(0,0,0,0);return m.RotationQuaternionFromAxisToRef(e,t,i,n),n}static RotationQuaternionFromAxisToRef(e,t,i,n){const r=p.Matrix[0];return f.FromXYZAxesToRef(e.normalize(),t.normalize(),i.normalize(),r),m.FromRotationMatrixToRef(r,n),n}static FromLookDirectionLH(e,t){const i=new m;return m.FromLookDirectionLHToRef(e,t,i),i}static FromLookDirectionLHToRef(e,t,i){const n=p.Matrix[0];return f.LookDirectionLHToRef(e,t,n),m.FromRotationMatrixToRef(n,i),i}static FromLookDirectionRH(e,t){const i=new m;return m.FromLookDirectionRHToRef(e,t,i),i}static FromLookDirectionRHToRef(e,t,i){const n=p.Matrix[0];return f.LookDirectionRHToRef(e,t,n),m.FromRotationMatrixToRef(n,i)}static Slerp(e,t,i){const n=m.Identity();return m.SlerpToRef(e,t,i,n),n}static SlerpToRef(e,t,i,n){let r,a,s=e._x*t._x+e._y*t._y+e._z*t._z+e._w*t._w,o=!1;if(s<0&&(o=!0,s=-s),s>.999999)a=1-i,r=o?-i:i;else{const e=Math.acos(s),t=1/Math.sin(e);a=Math.sin((1-i)*e)*t,r=o?-Math.sin(i*e)*t:Math.sin(i*e)*t}return n._x=a*e._x+r*t._x,n._y=a*e._y+r*t._y,n._z=a*e._z+r*t._z,n._w=a*e._w+r*t._w,n._isDirty=!0,n}static Hermite(e,t,i,n,r){const a=r*r,s=r*a,o=2*s-3*a+1,l=-2*s+3*a,d=s-2*a+r,c=s-a,h=e._x*o+i._x*l+t._x*d+n._x*c,u=e._y*o+i._y*l+t._y*d+n._y*c,f=e._z*o+i._z*l+t._z*d+n._z*c,p=e._w*o+i._w*l+t._w*d+n._w*c;return new m(h,u,f,p)}static Hermite1stDerivative(e,t,i,n,r){const a=new m;return this.Hermite1stDerivativeToRef(e,t,i,n,r,a),a}static Hermite1stDerivativeToRef(e,t,i,n,r,a){const s=r*r;return a._x=6*(s-r)*e._x+(3*s-4*r+1)*t._x+6*(-s+r)*i._x+(3*s-2*r)*n._x,a._y=6*(s-r)*e._y+(3*s-4*r+1)*t._y+6*(-s+r)*i._y+(3*s-2*r)*n._y,a._z=6*(s-r)*e._z+(3*s-4*r+1)*t._z+6*(-s+r)*i._z+(3*s-2*r)*n._z,a._w=6*(s-r)*e._w+(3*s-4*r+1)*t._w+6*(-s+r)*i._w+(3*s-2*r)*n._w,a._isDirty=!0,a}static Normalize(e){const t=m.Zero();return m.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){return e.normalizeToRef(t),t}static Clamp(e,t,i){const n=new m;return m.ClampToRef(e,t,i,n),n}static ClampToRef(e,t,i,n){return n.copyFromFloats(Object(l.a)(e.x,t.x,i.x),Object(l.a)(e.y,t.y,i.y),Object(l.a)(e.z,t.z,i.z),Object(l.a)(e.w,t.w,i.w))}static Random(e=0,t=1){return new m(Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t))}static RandomToRef(e=0,t=1,i){return i.copyFromFloats(Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t),Object(l.d)(e,t))}static Minimize(){throw new ReferenceError("Quaternion.Minimize does not make sense")}static Maximize(){throw new ReferenceError("Quaternion.Maximize does not make sense")}static Distance(e,t){return Math.sqrt(m.DistanceSquared(e,t))}static DistanceSquared(e,t){const i=e.x-t.x,n=e.y-t.y,r=e.z-t.z,a=e.w-t.w;return i*i+n*n+r*r+a*a}static Center(e,t){return m.CenterToRef(e,t,m.Zero())}static CenterToRef(e,t,i){return i.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2,(e.z+t.z)/2,(e.w+t.w)/2)}constructor(e=0,t=0,i=0,n=1){this._isDirty=!0,this._x=e,this._y=t,this._z=i,this._w=n}}Object.defineProperties(m.prototype,{dimension:{value:[4]},rank:{value:1}});class f{static get Use64Bits(){return s.a.MatrixUse64Bits}get m(){return this._m}markAsUpdated(){this.updateFlag=f._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}_updateIdentityStatus(e,t=!1,i=!1,n=!0){this._isIdentity=e,this._isIdentity3x2=e||i,this._isIdentityDirty=!this._isIdentity&&t,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const e=this._m;this._isIdentity=1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const e=this._m,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],d=e[8],c=e[9],h=e[10],u=e[11],m=e[12],f=e[13],p=e[14],g=e[15],_=h*g-p*u,S=c*g-f*u,v=c*p-f*h,y=d*g-m*u,T=d*p-h*m,b=d*f-m*c;return t*+(s*_-o*S+l*v)+i*-(a*_-o*y+l*T)+n*+(a*S-s*y+l*b)+r*-(a*v-s*T+o*b)}toString(){return`{${this.m[0]}, ${this.m[1]}, ${this.m[2]}, ${this.m[3]}\n${this.m[4]}, ${this.m[5]}, ${this.m[6]}, ${this.m[7]}\n${this.m[8]}, ${this.m[9]}, ${this.m[10]}, ${this.m[11]}\n${this.m[12]}, ${this.m[13]}, ${this.m[14]}, ${this.m[15]}}`}toArray(e=null,t=0){if(!e)return this._m;const i=this._m;for(let n=0;n<16;n++)e[t+n]=i[n];return this}asArray(){return this._m}fromArray(e,t=0){return f.FromArrayToRef(e,t,this)}copyFromFloats(...e){return f.FromArrayToRef(e,0,this)}set(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=e[i];return this.markAsUpdated(),this}setAll(e){const t=this._m;for(let i=0;i<16;i++)t[i]=e;return this.markAsUpdated(),this}invert(){return this.invertToRef(this),this}reset(){return f.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(e){const t=new f;return this.addToRef(e,t),t}addToRef(e,t){const i=this._m,n=t._m,r=e.m;for(let e=0;e<16;e++)n[e]=i[e]+r[e];return t.markAsUpdated(),t}addToSelf(e){const t=this._m,i=e.m;return t[0]+=i[0],t[1]+=i[1],t[2]+=i[2],t[3]+=i[3],t[4]+=i[4],t[5]+=i[5],t[6]+=i[6],t[7]+=i[7],t[8]+=i[8],t[9]+=i[9],t[10]+=i[10],t[11]+=i[11],t[12]+=i[12],t[13]+=i[13],t[14]+=i[14],t[15]+=i[15],this.markAsUpdated(),this}addInPlace(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]+=i[e];return this.markAsUpdated(),this}addInPlaceFromFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]+=e[i];return this.markAsUpdated(),this}subtract(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]-=i[e];return this.markAsUpdated(),this}subtractToRef(e,t){const i=this._m,n=e.m,r=t._m;for(let e=0;e<16;e++)r[e]=i[e]-n[e];return t.markAsUpdated(),t}subtractInPlace(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]-=i[e];return this.markAsUpdated(),this}subtractFromFloats(...e){return this.subtractFromFloatsToRef(...e,new f)}subtractFromFloatsToRef(...e){const t=e.pop(),i=this._m,n=t._m,r=e;for(let e=0;e<16;e++)n[e]=i[e]-r[e];return t.markAsUpdated(),t}invertToRef(e){if(!0===this._isIdentity)return f.IdentityToRef(e),e;const t=this._m,i=t[0],n=t[1],r=t[2],a=t[3],s=t[4],o=t[5],l=t[6],d=t[7],c=t[8],h=t[9],u=t[10],m=t[11],p=t[12],g=t[13],_=t[14],S=t[15],v=u*S-_*m,y=h*S-g*m,T=h*_-g*u,b=c*S-p*m,w=c*_-u*p,C=c*g-p*h,I=+(o*v-l*y+d*T),P=-(s*v-l*b+d*w),E=+(s*y-o*b+d*C),x=-(s*T-o*w+l*C),k=i*I+n*P+r*E+a*x;if(0===k)return e.copyFrom(this),e;const M=1/k,A=l*S-_*d,R=o*S-g*d,O=o*_-g*l,F=s*S-p*d,D=s*_-p*l,L=s*g-p*o,B=l*m-u*d,N=o*m-h*d,V=o*u-h*l,W=s*m-c*d,U=s*u-c*l,z=s*h-c*o,H=-(n*v-r*y+a*T),G=+(i*v-r*b+a*w),j=-(i*y-n*b+a*C),$=+(i*T-n*w+r*C),q=+(n*A-r*R+a*O),Z=-(i*A-r*F+a*D),J=+(i*R-n*F+a*L),X=-(i*O-n*D+r*L),Y=-(n*B-r*N+a*V),K=+(i*B-r*W+a*U),Q=-(i*N-n*W+a*z),ee=+(i*V-n*U+r*z);return f.FromValuesToRef(I*M,H*M,q*M,Y*M,P*M,G*M,Z*M,K*M,E*M,j*M,J*M,Q*M,x*M,$*M,X*M,ee*M,e),e}addAtIndex(e,t){return this._m[e]+=t,this.markAsUpdated(),this}multiplyAtIndex(e,t){return this._m[e]*=t,this.markAsUpdated(),this}setTranslationFromFloats(e,t,i){return this._m[12]=e,this._m[13]=t,this._m[14]=i,this.markAsUpdated(),this}addTranslationFromFloats(e,t,i){return this._m[12]+=e,this._m[13]+=t,this._m[14]+=i,this.markAsUpdated(),this}setTranslation(e){return this.setTranslationFromFloats(e._x,e._y,e._z)}getTranslation(){return new h(this._m[12],this._m[13],this._m[14])}getTranslationToRef(e){return e.x=this._m[12],e.y=this._m[13],e.z=this._m[14],e}removeRotationAndScaling(){const e=this.m;return f.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e[12],e[13],e[14],e[15],this),this._updateIdentityStatus(0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]),this}copyFrom(e){e.copyToArray(this._m);const t=e;return this.updateFlag=t.updateFlag,this._updateIdentityStatus(t._isIdentity,t._isIdentityDirty,t._isIdentity3x2,t._isIdentity3x2Dirty),this}copyToArray(e,t=0){const i=this._m;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],this}multiply(e){const t=new f;return this.multiplyToRef(e,t),t}multiplyInPlace(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]*=i[e];return this.markAsUpdated(),this}multiplyByFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]*=e[i];return this.markAsUpdated(),this}multiplyByFloatsToRef(...e){const t=e.pop(),i=this._m,n=t._m,r=e;for(let e=0;e<16;e++)n[e]=i[e]*r[e];return t.markAsUpdated(),t}multiplyToRef(e,t){return this._isIdentity?(t.copyFrom(e),t):e._isIdentity?(t.copyFrom(this),t):(this.multiplyToArray(e,t._m,0),t.markAsUpdated(),t)}multiplyToArray(e,t,i){const n=this._m,r=e.m,a=n[0],s=n[1],o=n[2],l=n[3],d=n[4],c=n[5],h=n[6],u=n[7],m=n[8],f=n[9],p=n[10],g=n[11],_=n[12],S=n[13],v=n[14],y=n[15],T=r[0],b=r[1],w=r[2],C=r[3],I=r[4],P=r[5],E=r[6],x=r[7],k=r[8],M=r[9],A=r[10],R=r[11],O=r[12],F=r[13],D=r[14],L=r[15];return t[i]=a*T+s*I+o*k+l*O,t[i+1]=a*b+s*P+o*M+l*F,t[i+2]=a*w+s*E+o*A+l*D,t[i+3]=a*C+s*x+o*R+l*L,t[i+4]=d*T+c*I+h*k+u*O,t[i+5]=d*b+c*P+h*M+u*F,t[i+6]=d*w+c*E+h*A+u*D,t[i+7]=d*C+c*x+h*R+u*L,t[i+8]=m*T+f*I+p*k+g*O,t[i+9]=m*b+f*P+p*M+g*F,t[i+10]=m*w+f*E+p*A+g*D,t[i+11]=m*C+f*x+p*R+g*L,t[i+12]=_*T+S*I+v*k+y*O,t[i+13]=_*b+S*P+v*M+y*F,t[i+14]=_*w+S*E+v*A+y*D,t[i+15]=_*C+S*x+v*R+y*L,this}divide(e){return this.divideToRef(e,new f)}divideToRef(e,t){const i=this._m,n=e.m,r=t._m;for(let e=0;e<16;e++)r[e]=i[e]/n[e];return t.markAsUpdated(),t}divideInPlace(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]/=i[e];return this.markAsUpdated(),this}minimizeInPlace(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]=Math.min(t[e],i[e]);return this.markAsUpdated(),this}minimizeInPlaceFromFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=Math.min(t[i],e[i]);return this.markAsUpdated(),this}maximizeInPlace(e){const t=this._m,i=e.m;for(let e=0;e<16;e++)t[e]=Math.min(t[e],i[e]);return this.markAsUpdated(),this}maximizeInPlaceFromFloats(...e){const t=this._m;for(let i=0;i<16;i++)t[i]=Math.min(t[i],e[i]);return this.markAsUpdated(),this}negate(){return this.negateToRef(new f)}negateInPlace(){const e=this._m;for(let t=0;t<16;t++)e[t]=-e[t];return this.markAsUpdated(),this}negateToRef(e){const t=this._m,i=e._m;for(let e=0;e<16;e++)i[e]=-t[e];return e.markAsUpdated(),e}equals(e){const t=e;if(!t)return!1;if((this._isIdentity||t._isIdentity)&&!this._isIdentityDirty&&!t._isIdentityDirty)return this._isIdentity&&t._isIdentity;const i=this.m,n=t.m;return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]}equalsWithEpsilon(e,t=0){const i=this._m,n=e.m;for(let e=0;e<16;e++)if(!Object(l.f)(i[e],n[e],t))return!1;return!0}equalsToFloats(...e){const t=this._m;for(let i=0;i<16;i++)if(t[i]!=e[i])return!1;return!0}floor(){return this.floorToRef(new f)}floorToRef(e){const t=this._m,i=e._m;for(let e=0;e<16;e++)i[e]=Math.floor(t[e]);return e.markAsUpdated(),e}fract(){return this.fractToRef(new f)}fractToRef(e){const t=this._m,i=e._m;for(let e=0;e<16;e++)i[e]=t[e]-Math.floor(t[e]);return e.markAsUpdated(),e}clone(){const e=new f;return e.copyFrom(this),e}getClassName(){return"Matrix"}getHashCode(){let e=d(this._m[0]);for(let t=1;t<16;t++)e=397*e^d(this._m[t]);return e}decomposeToTransformNode(e){return e.rotationQuaternion=e.rotationQuaternion||new m,this.decompose(e.scaling,e.rotationQuaternion,e.position)}decompose(e,t,i,n,r=!0){if(this._isIdentity)return i&&i.setAll(0),e&&e.setAll(1),t&&t.copyFromFloats(0,0,0,1),!0;const a=this._m;if(i&&i.copyFromFloats(a[12],a[13],a[14]),(e=e||p.Vector3[0]).x=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),e.y=Math.sqrt(a[4]*a[4]+a[5]*a[5]+a[6]*a[6]),e.z=Math.sqrt(a[8]*a[8]+a[9]*a[9]+a[10]*a[10]),n){const t=(r?n.absoluteScaling.x:n.scaling.x)<0?-1:1,i=(r?n.absoluteScaling.y:n.scaling.y)<0?-1:1,a=(r?n.absoluteScaling.z:n.scaling.z)<0?-1:1;e.x*=t,e.y*=i,e.z*=a}else this.determinant()<=0&&(e.y*=-1);if(0===e._x||0===e._y||0===e._z)return t&&t.copyFromFloats(0,0,0,1),!1;if(t){const i=1/e._x,n=1/e._y,r=1/e._z;f.FromValuesToRef(a[0]*i,a[1]*i,a[2]*i,0,a[4]*n,a[5]*n,a[6]*n,0,a[8]*r,a[9]*r,a[10]*r,0,0,0,0,1,p.Matrix[0]),m.FromRotationMatrixToRef(p.Matrix[0],t)}return!0}getRow(e){if(e<0||e>3)return null;const t=4*e;return new u(this._m[t+0],this._m[t+1],this._m[t+2],this._m[t+3])}getRowToRef(e,t){if(e>=0&&e<=3){const i=4*e;t.x=this._m[i+0],t.y=this._m[i+1],t.z=this._m[i+2],t.w=this._m[i+3]}return t}setRow(e,t){return this.setRowFromFloats(e,t.x,t.y,t.z,t.w)}transpose(){const e=new f;return f.TransposeToRef(this,e),e}transposeToRef(e){return f.TransposeToRef(this,e),e}setRowFromFloats(e,t,i,n,r){if(e<0||e>3)return this;const a=4*e;return this._m[a+0]=t,this._m[a+1]=i,this._m[a+2]=n,this._m[a+3]=r,this.markAsUpdated(),this}scale(e){const t=new f;return this.scaleToRef(e,t),t}scaleToRef(e,t){for(let i=0;i<16;i++)t._m[i]=this._m[i]*e;return t.markAsUpdated(),t}scaleAndAddToRef(e,t){for(let i=0;i<16;i++)t._m[i]+=this._m[i]*e;return t.markAsUpdated(),t}scaleInPlace(e){const t=this._m;for(let i=0;i<16;i++)t[i]*=e;return this.markAsUpdated(),this}toNormalMatrix(e){const t=p.Matrix[0];this.invertToRef(t),t.transposeToRef(e);const i=e._m;return f.FromValuesToRef(i[0],i[1],i[2],0,i[4],i[5],i[6],0,i[8],i[9],i[10],0,0,0,0,1,e),e}getRotationMatrix(){const e=new f;return this.getRotationMatrixToRef(e),e}getRotationMatrixToRef(e){const t=p.Vector3[0];if(!this.decompose(t))return f.IdentityToRef(e),e;const i=this._m,n=1/t._x,r=1/t._y,a=1/t._z;return f.FromValuesToRef(i[0]*n,i[1]*n,i[2]*n,0,i[4]*r,i[5]*r,i[6]*r,0,i[8]*a,i[9]*a,i[10]*a,0,0,0,0,1,e),e}toggleModelMatrixHandInPlace(){const e=this._m;return e[2]*=-1,e[6]*=-1,e[8]*=-1,e[9]*=-1,e[14]*=-1,this.markAsUpdated(),this}toggleProjectionMatrixHandInPlace(){const e=this._m;return e[8]*=-1,e[9]*=-1,e[10]*=-1,e[11]*=-1,this.markAsUpdated(),this}static FromArray(e,t=0){const i=new f;return f.FromArrayToRef(e,t,i),i}static FromArrayToRef(e,t,i){for(let n=0;n<16;n++)i._m[n]=e[n+t];return i.markAsUpdated(),i}static FromFloat32ArrayToRefScaled(e,t,i,n){return n._m[0]=e[0+t]*i,n._m[1]=e[1+t]*i,n._m[2]=e[2+t]*i,n._m[3]=e[3+t]*i,n._m[4]=e[4+t]*i,n._m[5]=e[5+t]*i,n._m[6]=e[6+t]*i,n._m[7]=e[7+t]*i,n._m[8]=e[8+t]*i,n._m[9]=e[9+t]*i,n._m[10]=e[10+t]*i,n._m[11]=e[11+t]*i,n._m[12]=e[12+t]*i,n._m[13]=e[13+t]*i,n._m[14]=e[14+t]*i,n._m[15]=e[15+t]*i,n.markAsUpdated(),n}static get IdentityReadOnly(){return f._IdentityReadOnly}static FromValuesToRef(e,t,i,n,r,a,s,o,l,d,c,h,u,m,f,p,g){const _=g._m;_[0]=e,_[1]=t,_[2]=i,_[3]=n,_[4]=r,_[5]=a,_[6]=s,_[7]=o,_[8]=l,_[9]=d,_[10]=c,_[11]=h,_[12]=u,_[13]=m,_[14]=f,_[15]=p,g.markAsUpdated()}static FromValues(e,t,i,n,r,a,s,o,l,d,c,h,u,m,p,g){const _=new f,S=_._m;return S[0]=e,S[1]=t,S[2]=i,S[3]=n,S[4]=r,S[5]=a,S[6]=s,S[7]=o,S[8]=l,S[9]=d,S[10]=c,S[11]=h,S[12]=u,S[13]=m,S[14]=p,S[15]=g,_.markAsUpdated(),_}static Compose(e,t,i){const n=new f;return f.ComposeToRef(e,t,i,n),n}static ComposeToRef(e,t,i,n){const r=n._m,a=t._x,s=t._y,o=t._z,l=t._w,d=a+a,c=s+s,h=o+o,u=a*d,m=a*c,f=a*h,p=s*c,g=s*h,_=o*h,S=l*d,v=l*c,y=l*h,T=e._x,b=e._y,w=e._z;return r[0]=(1-(p+_))*T,r[1]=(m+y)*T,r[2]=(f-v)*T,r[3]=0,r[4]=(m-y)*b,r[5]=(1-(u+_))*b,r[6]=(g+S)*b,r[7]=0,r[8]=(f+v)*w,r[9]=(g-S)*w,r[10]=(1-(u+p))*w,r[11]=0,r[12]=i._x,r[13]=i._y,r[14]=i._z,r[15]=1,n.markAsUpdated(),n}static Identity(){const e=f.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return e._updateIdentityStatus(!0),e}static IdentityToRef(e){return f.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(!0),e}static Zero(){const e=f.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return e._updateIdentityStatus(!1),e}static RotationX(e){const t=new f;return f.RotationXToRef(e,t),t}static Invert(e){const t=new f;return e.invertToRef(t),t}static RotationXToRef(e,t){const i=Math.sin(e),n=Math.cos(e);return f.FromValuesToRef(1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1,t),t._updateIdentityStatus(1===n&&0===i),t}static RotationY(e){const t=new f;return f.RotationYToRef(e,t),t}static RotationYToRef(e,t){const i=Math.sin(e),n=Math.cos(e);return f.FromValuesToRef(n,0,-i,0,0,1,0,0,i,0,n,0,0,0,0,1,t),t._updateIdentityStatus(1===n&&0===i),t}static RotationZ(e){const t=new f;return f.RotationZToRef(e,t),t}static RotationZToRef(e,t){const i=Math.sin(e),n=Math.cos(e);return f.FromValuesToRef(n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(1===n&&0===i),t}static RotationAxis(e,t){const i=new f;return f.RotationAxisToRef(e,t,i),i}static RotationAxisToRef(e,t,i){const n=Math.sin(-t),r=Math.cos(-t),a=1-r;e.normalize();const s=i._m;return s[0]=e._x*e._x*a+r,s[1]=e._x*e._y*a-e._z*n,s[2]=e._x*e._z*a+e._y*n,s[3]=0,s[4]=e._y*e._x*a+e._z*n,s[5]=e._y*e._y*a+r,s[6]=e._y*e._z*a-e._x*n,s[7]=0,s[8]=e._z*e._x*a-e._y*n,s[9]=e._z*e._y*a+e._x*n,s[10]=e._z*e._z*a+r,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,i.markAsUpdated(),i}static RotationAlignToRef(e,t,i,r=!1){const a=h.Dot(t,e),s=i._m;if(a<-1+n.a)s[0]=-1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r?1:-1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r?-1:1,s[11]=0;else{const i=h.Cross(t,e),n=1/(1+a);s[0]=i._x*i._x*n+a,s[1]=i._y*i._x*n-i._z,s[2]=i._z*i._x*n+i._y,s[3]=0,s[4]=i._x*i._y*n+i._z,s[5]=i._y*i._y*n+a,s[6]=i._z*i._y*n-i._x,s[7]=0,s[8]=i._x*i._z*n-i._y,s[9]=i._y*i._z*n+i._x,s[10]=i._z*i._z*n+a,s[11]=0}return s[12]=0,s[13]=0,s[14]=0,s[15]=1,i.markAsUpdated(),i}static RotationYawPitchRoll(e,t,i){const n=new f;return f.RotationYawPitchRollToRef(e,t,i,n),n}static RotationYawPitchRollToRef(e,t,i,n){return m.RotationYawPitchRollToRef(e,t,i,p.Quaternion[0]),p.Quaternion[0].toRotationMatrix(n),n}static Scaling(e,t,i){const n=new f;return f.ScalingToRef(e,t,i,n),n}static ScalingToRef(e,t,i,n){return f.FromValuesToRef(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1,n),n._updateIdentityStatus(1===e&&1===t&&1===i),n}static Translation(e,t,i){const n=new f;return f.TranslationToRef(e,t,i,n),n}static TranslationToRef(e,t,i,n){return f.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e,t,i,1,n),n._updateIdentityStatus(0===e&&0===t&&0===i),n}static Lerp(e,t,i){const n=new f;return f.LerpToRef(e,t,i,n),n}static LerpToRef(e,t,i,n){const r=n._m,a=e.m,s=t.m;for(let e=0;e<16;e++)r[e]=a[e]*(1-i)+s[e]*i;return n.markAsUpdated(),n}static DecomposeLerp(e,t,i){const n=new f;return f.DecomposeLerpToRef(e,t,i,n),n}static DecomposeLerpToRef(e,t,i,n){const r=p.Vector3[0],a=p.Quaternion[0],s=p.Vector3[1];e.decompose(r,a,s);const o=p.Vector3[2],l=p.Quaternion[1],d=p.Vector3[3];t.decompose(o,l,d);const c=p.Vector3[4];h.LerpToRef(r,o,i,c);const u=p.Quaternion[2];m.SlerpToRef(a,l,i,u);const g=p.Vector3[5];return h.LerpToRef(s,d,i,g),f.ComposeToRef(c,u,g,n),n}static LookAtLH(e,t,i){const n=new f;return f.LookAtLHToRef(e,t,i,n),n}static LookAtLHToRef(e,t,i,n){const r=p.Vector3[0],a=p.Vector3[1],s=p.Vector3[2];t.subtractToRef(e,s),s.normalize(),h.CrossToRef(i,s,r);const o=r.lengthSquared();0===o?r.x=1:r.normalizeFromLength(Math.sqrt(o)),h.CrossToRef(s,r,a),a.normalize();const l=-h.Dot(r,e),d=-h.Dot(a,e),c=-h.Dot(s,e);return f.FromValuesToRef(r._x,a._x,s._x,0,r._y,a._y,s._y,0,r._z,a._z,s._z,0,l,d,c,1,n),n}static LookAtRH(e,t,i){const n=new f;return f.LookAtRHToRef(e,t,i,n),n}static LookAtRHToRef(e,t,i,n){const r=p.Vector3[0],a=p.Vector3[1],s=p.Vector3[2];e.subtractToRef(t,s),s.normalize(),h.CrossToRef(i,s,r);const o=r.lengthSquared();0===o?r.x=1:r.normalizeFromLength(Math.sqrt(o)),h.CrossToRef(s,r,a),a.normalize();const l=-h.Dot(r,e),d=-h.Dot(a,e),c=-h.Dot(s,e);return f.FromValuesToRef(r._x,a._x,s._x,0,r._y,a._y,s._y,0,r._z,a._z,s._z,0,l,d,c,1,n),n}static LookDirectionLH(e,t){const i=new f;return f.LookDirectionLHToRef(e,t,i),i}static LookDirectionLHToRef(e,t,i){const n=p.Vector3[0];n.copyFrom(e),n.scaleInPlace(-1);const r=p.Vector3[1];return h.CrossToRef(t,n,r),f.FromValuesToRef(r._x,r._y,r._z,0,t._x,t._y,t._z,0,n._x,n._y,n._z,0,0,0,0,1,i),i}static LookDirectionRH(e,t){const i=new f;return f.LookDirectionRHToRef(e,t,i),i}static LookDirectionRHToRef(e,t,i){const n=p.Vector3[2];return h.CrossToRef(t,e,n),f.FromValuesToRef(n._x,n._y,n._z,0,t._x,t._y,t._z,0,e._x,e._y,e._z,0,0,0,0,1,i),i}static OrthoLH(e,t,i,n,r){const a=new f;return f.OrthoLHToRef(e,t,i,n,a,r),a}static OrthoLHToRef(e,t,i,n,r,a){const s=2/e,o=2/t,l=2/(n-i),d=-(n+i)/(n-i);return f.FromValuesToRef(s,0,0,0,0,o,0,0,0,0,l,0,0,0,d,1,r),a&&r.multiplyToRef(_,r),r._updateIdentityStatus(1===s&&1===o&&1===l&&0===d),r}static OrthoOffCenterLH(e,t,i,n,r,a,s){const o=new f;return f.OrthoOffCenterLHToRef(e,t,i,n,r,a,o,s),o}static OrthoOffCenterLHToRef(e,t,i,n,r,a,s,o){const l=2/(t-e),d=2/(n-i),c=2/(a-r),h=-(a+r)/(a-r),u=(e+t)/(e-t),m=(n+i)/(i-n);return f.FromValuesToRef(l,0,0,0,0,d,0,0,0,0,c,0,u,m,h,1,s),o&&s.multiplyToRef(_,s),s.markAsUpdated(),s}static ObliqueOffCenterLHToRef(e,t,i,n,r,a,s,o,l,d,c){const h=-s*Math.cos(o),u=-s*Math.sin(o);return f.TranslationToRef(0,0,-l,p.Matrix[1]),f.FromValuesToRef(1,0,0,0,0,1,0,0,h,u,1,0,0,0,0,1,p.Matrix[0]),p.Matrix[1].multiplyToRef(p.Matrix[0],p.Matrix[0]),f.TranslationToRef(0,0,l,p.Matrix[1]),p.Matrix[0].multiplyToRef(p.Matrix[1],p.Matrix[0]),f.OrthoOffCenterLHToRef(e,t,i,n,r,a,d,c),p.Matrix[0].multiplyToRef(d,d),d}static OrthoOffCenterRH(e,t,i,n,r,a,s){const o=new f;return f.OrthoOffCenterRHToRef(e,t,i,n,r,a,o,s),o}static OrthoOffCenterRHToRef(e,t,i,n,r,a,s,o){return f.OrthoOffCenterLHToRef(e,t,i,n,r,a,s,o),s._m[10]*=-1,s}static ObliqueOffCenterRHToRef(e,t,i,n,r,a,s,o,l,d,c){const h=s*Math.cos(o),u=s*Math.sin(o);return f.TranslationToRef(0,0,l,p.Matrix[1]),f.FromValuesToRef(1,0,0,0,0,1,0,0,h,u,1,0,0,0,0,1,p.Matrix[0]),p.Matrix[1].multiplyToRef(p.Matrix[0],p.Matrix[0]),f.TranslationToRef(0,0,-l,p.Matrix[1]),p.Matrix[0].multiplyToRef(p.Matrix[1],p.Matrix[0]),f.OrthoOffCenterRHToRef(e,t,i,n,r,a,d,c),p.Matrix[0].multiplyToRef(d,d),d}static PerspectiveLH(e,t,i,n,r,a=0){const s=new f,o=2*i/e,l=2*i/t,d=(n+i)/(n-i),c=-2*n*i/(n-i),h=Math.tan(a);return f.FromValuesToRef(o,0,0,0,0,l,0,h,0,0,d,1,0,0,c,0,s),r&&s.multiplyToRef(_,s),s._updateIdentityStatus(!1),s}static PerspectiveFovLH(e,t,i,n,r,a=0,s=!1){const o=new f;return f.PerspectiveFovLHToRef(e,t,i,n,o,!0,r,a,s),o}static PerspectiveFovLHToRef(e,t,i,n,r,a=!0,s,o=0,l=!1){const d=i,c=n,h=1/Math.tan(.5*e),u=a?h/t:h,m=a?h:h*t,p=l&&0===d?-1:0!==c?(c+d)/(c-d):1,g=l&&0===d?2*c:0!==c?-2*c*d/(c-d):-2*d,S=Math.tan(o);return f.FromValuesToRef(u,0,0,0,0,m,0,S,0,0,p,1,0,0,g,0,r),s&&r.multiplyToRef(_,r),r._updateIdentityStatus(!1),r}static PerspectiveFovReverseLHToRef(e,t,i,n,r,a=!0,s,o=0){const l=1/Math.tan(.5*e),d=a?l/t:l,c=a?l:l*t,h=Math.tan(o);return f.FromValuesToRef(d,0,0,0,0,c,0,h,0,0,-i,1,0,0,1,0,r),s&&r.multiplyToRef(_,r),r._updateIdentityStatus(!1),r}static PerspectiveFovRH(e,t,i,n,r,a=0,s=!1){const o=new f;return f.PerspectiveFovRHToRef(e,t,i,n,o,!0,r,a,s),o}static PerspectiveFovRHToRef(e,t,i,n,r,a=!0,s,o=0,l=!1){const d=i,c=n,h=1/Math.tan(.5*e),u=a?h/t:h,m=a?h:h*t,p=l&&0===d?1:0!==c?-(c+d)/(c-d):-1,g=l&&0===d?2*c:0!==c?-2*c*d/(c-d):-2*d,S=Math.tan(o);return f.FromValuesToRef(u,0,0,0,0,m,0,S,0,0,p,-1,0,0,g,0,r),s&&r.multiplyToRef(_,r),r._updateIdentityStatus(!1),r}static PerspectiveFovReverseRHToRef(e,t,i,n,r,a=!0,s,o=0){const l=1/Math.tan(.5*e),d=a?l/t:l,c=a?l:l*t,h=Math.tan(o);return f.FromValuesToRef(d,0,0,0,0,c,0,h,0,0,-i,-1,0,0,-1,0,r),s&&r.multiplyToRef(_,r),r._updateIdentityStatus(!1),r}static GetFinalMatrix(e,t,i,n,r,a){const s=e.width,o=e.height,l=e.x,d=e.y,c=f.FromValues(s/2,0,0,0,0,-o/2,0,0,0,0,a-r,0,l+s/2,o/2+d,r,1),h=new f;return t.multiplyToRef(i,h),h.multiplyToRef(n,h),h.multiplyToRef(c,h)}static GetAsMatrix2x2(e){const t=e.m,i=[t[0],t[1],t[4],t[5]];return s.a.MatrixUse64Bits?i:new Float32Array(i)}static GetAsMatrix3x3(e){const t=e.m,i=[t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]];return s.a.MatrixUse64Bits?i:new Float32Array(i)}static Transpose(e){const t=new f;return f.TransposeToRef(e,t),t}static TransposeToRef(e,t){const i=e.m,n=i[0],r=i[4],a=i[8],s=i[12],o=i[1],l=i[5],d=i[9],c=i[13],h=i[2],u=i[6],m=i[10],f=i[14],p=i[3],g=i[7],_=i[11],S=i[15],v=t._m;return v[0]=n,v[1]=r,v[2]=a,v[3]=s,v[4]=o,v[5]=l,v[6]=d,v[7]=c,v[8]=h,v[9]=u,v[10]=m,v[11]=f,v[12]=p,v[13]=g,v[14]=_,v[15]=S,t.markAsUpdated(),t._updateIdentityStatus(e._isIdentity,e._isIdentityDirty),t}static Reflection(e){const t=new f;return f.ReflectionToRef(e,t),t}static ReflectionToRef(e,t){e.normalize();const i=e.normal.x,n=e.normal.y,r=e.normal.z,a=-2*i,s=-2*n,o=-2*r;return f.FromValuesToRef(a*i+1,s*i,o*i,0,a*n,s*n+1,o*n,0,a*r,s*r,o*r+1,0,a*e.d,s*e.d,o*e.d,1,t),t}static FromXYZAxesToRef(e,t,i,n){return f.FromValuesToRef(e._x,e._y,e._z,0,t._x,t._y,t._z,0,i._x,i._y,i._z,0,0,0,0,1,n),n}static FromQuaternionToRef(e,t){const i=e._x*e._x,n=e._y*e._y,r=e._z*e._z,a=e._x*e._y,s=e._z*e._w,o=e._z*e._x,l=e._y*e._w,d=e._y*e._z,c=e._x*e._w;return t._m[0]=1-2*(n+r),t._m[1]=2*(a+s),t._m[2]=2*(o-l),t._m[3]=0,t._m[4]=2*(a-s),t._m[5]=1-2*(r+i),t._m[6]=2*(d+c),t._m[7]=0,t._m[8]=2*(o+l),t._m[9]=2*(d-c),t._m[10]=1-2*(n+i),t._m[11]=0,t._m[12]=0,t._m[13]=0,t._m[14]=0,t._m[15]=1,t.markAsUpdated(),t}constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,s.a.MatrixTrackPrecisionChange&&s.a.MatrixTrackedMatrices.push(this),this._m=new s.a.MatrixCurrentType(16),this.markAsUpdated()}}f._UpdateFlagSeed=0,f._IdentityReadOnly=f.Identity(),Object.defineProperties(f.prototype,{dimension:{value:[4,4]},rank:{value:2}});class p{}p.Vector3=Object(r.b)(11,h.Zero),p.Matrix=Object(r.b)(2,f.Identity),p.Quaternion=Object(r.b)(3,m.Zero);class g{}g.Vector2=Object(r.b)(3,c.Zero),g.Vector3=Object(r.b)(13,h.Zero),g.Vector4=Object(r.b)(3,u.Zero),g.Quaternion=Object(r.b)(3,m.Zero),g.Matrix=Object(r.b)(8,f.Identity),Object(a.b)("BABYLON.Vector2",c),Object(a.b)("BABYLON.Vector3",h),Object(a.b)("BABYLON.Vector4",u),Object(a.b)("BABYLON.Matrix",f);const _=f.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1)},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(0),r=i(6),a=i(15);const s=[a.g.position,a.g.position,a.g.type,a.g.distance,a.g.pressure,a.g.tilt,a.g.tilt];function o(e,t,i=!1,n=!1,s){const o=a.g.alignedVec4|a.g.position|a.g.type|a.g.pressure,c=[],h=n?[]:void 0;if(!e.figures||0==e.figures.length)return{buffers:c,endDistance:0};let u=0;for(let r=0;r<e.figures.length;r++){const m=i?e.figures[r].toPolygon():e.figures[r],f=Object(a.j)(o),p=m.isLastPointDuplicated(),g=m.isClosed||p,_=l(m.points,m.format,o,0,p?m.points.length-m.pointDataSize:m.points.length,1,3,g,e.maxPressure),S=_.length/f;let v;if(n){const e=d(_,o,g,u,s,1,3);v=e.distanceArray,u=e.endDistance}const y=_.length;if(y>t){const e=t/f-4,i=Math.ceil((S-4)/e),n=e+4;let r=0;for(let e=0;e<i;e++){const e=Math.min(n,S-r),t=e-4;c.push(_.subarray(r*f,(r+e)*f)),h&&v&&h.push(v.subarray(r,r+e)),r+=t}}else{const e=new Float32Array(4*Math.ceil(y/4));e.set(_,0),c.push(e),h&&v&&h.push(v)}}return h&&h.length!=c.length&&r.a.Error(592525388,"Invalid distance array"),{buffers:c,distanceBuffers:h,endDistance:u}}function l(e,t,i,n=0,o=e.length,l=0,d=0,c=!0,h=1){let u=Object(a.j)(t),m=o-n;if(!(m%u==0&&t&a.g.position&&i&a.g.position))throw r.a.Error(592525389,"list of source points invalid");let f=e,p=m/u;1==p&&(f=new Float32Array(2*e.length),f.set(e,0),f.set(e,e.length),p=2);const g=u;u=Object(a.j)(i);const _=new Float32Array((l+p+d)*u);for(let e=0;e<p;e++){let r=n+e*g,o=(l+e)*u;for(const e of s)e&i&&(e==a.g.pressure?_[o]=e&t?f[r]/h:1:_[o]=e&t?f[r]:e==a.g.type?1:0,o++),e&t&&r++}if((l||d)&&(l>0&&_.copyWithin(0,_.length-(l+d)*u,_.length-d*u),d>0&&_.copyWithin(_.length-d*u,l*u,(l+d)*u),!c&&i&a.g.type)){for(let e=0;e<l;e++)_[e*u+2]=0;for(let e=0;e<d;e++)_[_.length-(e+1)*u+2]=0}return _}function d(e,t,i,s=0,o,l=0,d=0){const c=o?function(e,t,i){const n=Object(a.j)(t);if(0==n||e.length%n!=0||!(t&a.g.position))throw r.a.Error(592525390,"list of points for invalid for measuring distance");const s=i.m,o=new Float32Array(e);for(let t=0;t<e.length;t+=n){const i=e[t],n=e[t+1];o[t]=i*s[0]+n*s[3]+s[6],o[t+1]=i*s[1]+n*s[4]+s[7]}return o}(e,t,o):e,h=Object(a.j)(t);if(0==h||c.length%h!=0||c.length/h<l+d+1||!(t&a.g.position))throw r.a.Error(587534800,"list of points for invalid for measuring distance");const u=new Float32Array(c.length/h),m=l*h,f=(c.length-d*h-m)/h,p=t&a.g.type;let g=s||0;for(let e=0;e<f;e++){const t=m+e*h;if((p?c[t+2]:a.f.corner)!=a.f.bezier&&(u[l+e]=g,i||e<f-1)){const r=m+(e+1)%f*h,s=p?c[r+2]:a.f.corner;if(s!=a.f.bezier){let e=c[r]-c[t],i=c[r+1]-c[t+1];g+=Math.sqrt(e*e+i*i)}else if(s==a.f.bezier&&(i||e<f-2)){const i=m+(e+2)%f*h;let a=c[t],s=c[t+1],o=c[r],l=c[r+1],d=c[i],u=c[i+1];g+=Object(n.o)(a,s,o,l,d,u)}}}const _=g-s;for(let e=0;e<l;e++)u[e]=u[l+f-l+e]-_;for(let e=l+f;e<c.length/h;e++)u[e]=u[e+l-(l+f)]+_;for(let e=0;e<f;e++){const t=m+e*h;if(p&&c[t+2]==a.f.bezier){const t=0==l&&0==e?f-1:l+e-1,i=0==d&&e==f-1?l:l+e+1;u[l+e]=.5*(u[t]+u[i])}}return{distanceArray:u,endDistance:g}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static SetMatrixPrecision(e){if(n.MatrixTrackPrecisionChange=!1,e&&!n.MatrixUse64Bits&&n.MatrixTrackedMatrices)for(let e=0;e<n.MatrixTrackedMatrices.length;++e){const t=n.MatrixTrackedMatrices[e],i=t._m;t._m=new Array(16);for(let e=0;e<16;++e)t._m[e]=i[e]}n.MatrixUse64Bits=e,n.MatrixCurrentType=n.MatrixUse64Bits?Array:Float32Array,n.MatrixTrackedMatrices=null}}n.MatrixUse64Bits=!1,n.MatrixTrackPrecisionChange=!0,n.MatrixCurrentType=Float32Array,n.MatrixTrackedMatrices=[]},function(e,t,i){"use strict";function n(e,t){const i=[];for(let n=0;n<e;++n)i.push(t());return i}function r(e,t){return n(e,t)}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return s}));const a=["push","splice","pop","shift","unshift"];function s(e,t){const i=a.map(i=>function(e,t,i){const n=e[t];if("function"!=typeof n)return null;const r=function(){const n=e.length,a=r.previous.apply(e,arguments);return i(t,n),a};return n.next=r,r.previous=n,e[t]=r,()=>{const i=r.previous;if(!i)return;const n=r.next;n?(i.next=n,n.previous=i):(i.next=void 0,e[t]=i),r.next=void 0,r.previous=void 0}}(e,i,t));return()=>{i.forEach(e=>{null==e||e()})}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return $})),i.d(t,"c",(function(){return q})),i.d(t,"a",(function(){return Z}));var n,r,a=i(8),s=i(13),o=i(34),l=i(52),d=i(9),c=i(3),h=i(7),u=i(19),m=i(10),f=i(11),p=i(45),g=i(4),_=i(1);!function(e){e.Init="init",e.Goto="goto",e.Prefetch="prefetch",e.Prerender="prerender",e.CheckHidden="CheckHidden",e.UpdateResourceProviders="UpdateResourceProviders",e.ChangeRenderingModeToSVG="ChangeRenderingModeToSVG"}(n||(n={})),function(e){e.EnsureSlideView="ensureSlideView",e.ResizeViewContainer="resizeViewContainer",e.RenderTransition="renderTransition",e.RenderSlide="renderSlide",e.ReloadTexture="reloadTexture"}(r||(r={}));class S{init(e){this.m_settings=e}recordInitData(e){if(!e.hasOwnProperty(n.Init)||!this.m_settings)return;const t={sessionId:this.m_settings.appSettings.userSessionId,InitInfo:e,initDurFromEndUser:e[n.Init].end-this.m_settings.appSettings.initTime,initDur:e[n.Init].end-e[n.Init].start,Config:f.a.getSessionConfig()};0===Object.keys(this.m_initInfo).length&&(this.m_initInfo=t.InitInfo);const i={initDur:t.initDur,initDurFromEndUser:t.initDurFromEndUser};this.m_settings.appSettings.useSnapDownloadUrl&&(t[S.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl,i[S.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),f.a.recordSessionStats(i),d.a.sendTraceTag(592483858,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("SSCoreInit",t))}recordNavData(e,t,i,r){if(!i||0===Object.keys(i).length||!i.hasOwnProperty("sid")||!this.m_settings)return;let s=!1,o=!1,l=!1;const u=i.sid.toString();if(r&&r.bootMetrics){if(0===this.m_startFromTime&&(s=!0,this.m_navigationData.hasOwnProperty(u))){const e=this.m_navigationData[u];e.hasOwnProperty(n.Prerender)&&(o=!0),e.hasOwnProperty(n.Prefetch)&&(l=!0)}this.m_startFromTime=r.startFromTime?r.startFromTime:0,this.m_maxGotoSlideMs=0,this.m_navigationData={},r.startFromTime||d.a.sendTraceTag(588804161,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"NavigationLogger::recordNavData Boot metrics object was present, but there was no startFromTime.")}if(this.m_navigationData.hasOwnProperty(u)||(this.m_navigationData[u]={}),i.hasOwnProperty(S.TextureMetadata)&&(i[S.TextureMetadata]=void 0),i.hasOwnProperty("createTransition")&&i.createTransition.hasOwnProperty("rendererEnvironment")&&(i.createTransition.rendererEnvironment.hasOwnProperty(S.RenderTransitionTextures)&&(i.createTransition.rendererEnvironment[S.RenderTransitionTextures]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(S.GenerateMorphResource)&&(i.createTransition.rendererEnvironment[S.GenerateMorphResource]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(S.RenderToTexture)&&(i.createTransition.rendererEnvironment[S.RenderToTexture]=void 0)),i.hasOwnProperty("missingTextureIds")){const e={id:i&&i.id,sr:i&&i.sr,missingTextureIds:i.missingTextureIds};d.a.sendTraceTag(507598877,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("addOnTrimmedDataTextureIds",e)),i.missingTextureIds=void 0,i.hasMissingTextureIds=!0}const p=this.m_navigationData[u];if(i.hasOwnProperty(S.Metadata)){p.hasOwnProperty(S.Metadata)||(p[S.Metadata]=[]),p[S.Metadata]=p[S.Metadata].concat(i[S.Metadata].filter(e=>!p[S.Metadata].includes(e)));let e=!1;for(const t in i[S.Metadata])if(i[S.Metadata][t].hasOwnProperty(S.MediaInfo)){e=!0;break}e&&!f.a.getSessionStats("hasMedia")&&f.a.recordSessionStats({hasMedia:!0}),e&&m.a.addOrUpdatePartCDimensions(new Map([["NavigatedToSlideWithMedia","true"]]))}if(i.hasOwnProperty(S.Metadata)){const e={id:i&&i.id,sr:i&&i.sr,metadata:i[S.Metadata]};d.a.sendTraceTag(507597592,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("addOnTrimmedDataMetadata",e)),i[S.Metadata]=void 0,i.hasMetadata=!0}let v,y=0;if(r&&r.navMetrics&&r.navMetrics.checkHiddenSlideResult&&(y=S.getDuration(r.navMetrics.checkHiddenSlideResult)),!(t===n.Goto&&p.hasOwnProperty(n.Goto)&&i.hasOwnProperty(n.Goto)&&S.getDuration(p[n.Goto])+S.getDuration(p[n.CheckHidden])>=S.getDuration(i[n.Goto])+y||t===n.Prefetch&&p.hasOwnProperty(n.Prefetch))){for(const t in i)if(t===n.Goto)if(p[n.CheckHidden]=y,r&&r.bootMetrics){const n={sessionId:this.m_settings.appSettings.userSessionId,startFromTime:r?r.startFromTime:void 0,bootMetrics:r?r.bootMetrics:void 0,Config:f.a.getSessionConfig(),EUPL:r.startFromTime&&0!==r.startFromTime?i[t].end-r.startFromTime:void 0,firstStartMetrics:{firstStart:s}};if(r&&r.id&&(n.id=r.id),i.hasOwnProperty("pptSpinnerStartTime")&&n.bootMetrics&&(n.bootMetrics.pptSpinnerStartTime=i.pptSpinnerStartTime),i.hasOwnProperty("errorName")&&(n.errors=i.errorName),this.m_settings.appSettings.useSnapDownloadUrl&&(n[S.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),i.hasOwnProperty(S.Metadata)){const e=this.getMetadataSummary(i[S.Metadata]);e.length>0&&(n[S.Metadata]=e),n.NavigationInfo=Object.keys(i).reduce((e,t)=>(t!==S.Metadata&&(e[t]=i[t]),e),{})}else n.NavigationInfo=i;n.slideIndex=e.getVisibleSlideIndex({sid:i.sid,cid:0}),g.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&(this.m_slideIndexFromBoot=n.slideIndex),s&&(n.firstStartMetrics.prefetched=l,n.firstStartMetrics.prerendered=o),0!==Object.keys(this.m_initInfo).length&&(n.initMetrics=this.m_initInfo),n.EUPL>_.a.readNumberOrDefault("vetoBootDurationMs",2e3)&&m.e.recordVeto("VetoedSlideShowBootTimeMs",{qosVeto:"PerceivedOpenSlow",...n}),i.hasOwnProperty(S.GetItemsResult)&&void 0!==i[S.GetItemsResult]&&(n[S.GetItemsResult]=i[S.GetItemsResult]),this.m_bootLaunchId=r&&r.id,d.a.sendTraceTag(594650330,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("boot",n))}else r&&!r.bootMetrics&&(i.hasOwnProperty("errorName")||(p[t]=i[t],i.hasOwnProperty("SBCurrentFrameSummary")&&i.SBCurrentFrameSummary.hasOwnProperty("totalCostMs")&&(p[S.RenderCost]=i.SBCurrentFrameSummary.totalCostMs),i.hasOwnProperty(S.NavigationStep)&&0!==i[S.NavigationStep]&&1!==i[S.NavigationStep]&&(p[S.NavigationStep]=i[S.NavigationStep]),r&&r.navigationType&&r.navigationType!==a.c.Init&&r.navigationType!==a.c.Next&&r.navigationType!==a.c.Prev&&(p.navigation=r.navigationType),i.hasOwnProperty(S.CachedInServer)&&(p[S.CachedInServer]=i[S.CachedInServer]),i.hasOwnProperty(S.RequestInfo)&&(p[S.RequestInfo]=i[S.RequestInfo]),i.hasOwnProperty(S.PlayTransitionMs)||(this.m_maxGotoSlideMs=Math.max(this.m_maxGotoSlideMs,S.getDuration(p[t])),S.getDuration(i[t])+y>_.a.readNumberOrDefault("vetoNavigationDurationMs",1250)&&0!==this.m_startFromTime&&m.e.recordVeto("VetoedSlideShowNavTimeMs",{qosVeto:"SlideShowNavSlow",...this.m_navigationData[u.toString()]}))));else t===n.Prefetch&&(i.hasOwnProperty("errorName")?p.hasOwnProperty("errorCount")?p.errorCount+=1:p.errorCount=1:p[t]=i[t],i.hasOwnProperty(n.Prerender)&&(p[n.Prerender]=i[n.Prerender]),i.hasOwnProperty(S.CachedInServer)&&(p[S.CachedInServer]=i[S.CachedInServer]),i.hasOwnProperty(S.RequestInfo)&&(p[S.RequestInfo]=i[S.RequestInfo]));if(i.sessionId=this.m_settings.appSettings.userSessionId,i.action=t,i.startFromTime=this.m_startFromTime,d.a.sendTraceTag(594650332,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,S.getLogString("navigation",i)),v=e.getVisibleSlideIndex({sid:i.sid,cid:0}),g.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&t===n.Goto){const e={id:i&&i.id,navType:r&&r.navigationType,sIdx:void 0!==this.m_slideIndexFromBoot?this.m_slideIndexFromBoot:void 0,timestamp:Date.now()};if(e.sr=i.sr,e.playTransitionMs=i.playTransitionMs,e.slideDistanceFromLaunch=void 0!==this.m_slideIndexFromBoot&&void 0!==v?v-this.m_slideIndexFromBoot:void 0,e.loadSlide=i.LoadSlide,e.fPrepared=i.fPrepared,e.bootLaunchId=this.m_bootLaunchId,r&&r.navigationType===a.c.Init)this.m_userActionTimestamp=f.a.performanceNowTrimmed();else if(r&&(r.navigationType===a.c.Next||r.navigationType===a.c.Prev||r.navigationType===a.c.GoTo)){const t=f.a.performanceNowTrimmed();e.timeSpentOnPrevSlide=t-this.m_userActionTimestamp,this.m_userActionTimestamp=t,e.navType=r.navigationType}d.a.sendTraceTag(507787460,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("addOnnavigation",e))}}}logPerfData(){if(0===Object.keys(this.m_navigationData).length||!this.m_settings)return;const e=[],t=Object.keys(this.m_navigationData).map(t=>{const i=this.m_navigationData[t],r={};return r.id=t,Object.keys(i).forEach(t=>{if(t===n.Goto||t===n.Prefetch||t===n.Prerender)r[t]=S.getDuration(i[t]);else if(t===S.Metadata){for(const t of i[S.Metadata])t.hasOwnProperty(S.MediaInfo)&&e.push(t[S.MediaInfo]);const t=this.getMetadataSummary(i[S.Metadata]);t.length>0&&(r[S.Metadata]=t)}else r[t]=i[t]}),r}),i={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,maxNav:this.m_maxGotoSlideMs,navList:t,Config:f.a.getSessionConfig()};f.a.recordSessionStats({maxNav:this.m_maxGotoSlideMs}),d.a.sendTraceTag(594650331,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("navSummary",i));const r={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,mediaInfoObjects:e,Config:f.a.getSessionConfig()};Object.keys(e).length>0&&d.a.sendTraceTag(591165197,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,S.getLogString("mediaSummary",r))}getMetadataSummary(e){const t=[];for(const i in e)if(e[i].hasOwnProperty(S.MediaInfo)){const n=e[i][S.MediaInfo];t.includes(n.type)||t.push(n.type)}else t.includes(e[i])||t.push(e[i]);return t}static getDuration(e){return e.end-e.start}static getLogString(e,t){if(!t)return"";const i=JSON.stringify(t),n=i.length;return n>3e3&&d.a.sendTraceTag(572289234,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`log size is too long! size:${n}, source:${e}`),i}constructor(){this.m_navigationData={},this.m_maxGotoSlideMs=0,this.m_startFromTime=0,this.m_userActionTimestamp=0,this.m_initInfo={}}}S.RenderCost="render",S.Metadata="metadata",S.NavigationStep="step",S.CachedInServer="cached",S.PlayTransitionMs="playTransitionMs",S.GetItemsResult="getItemsResult",S.UseSnapDownloadUrlString="useSnap",S.MediaInfo="mediaInfo",S.RequestInfo="requestInfo",S.TextureMetadata="textureMetadata",S.RenderTransitionTextures="renderTransitionTextures",S.GenerateMorphResource="generateMorphResource",S.RenderToTexture="renderToTexture";var v=i(21),y=i(36);class T{show(){this.m_loadingDiv.style.display="block"}hide(){this.m_loadingDiv.style.display="none"}get isVisible(){return"block"===this.m_loadingDiv.style.display}constructor(e){const t=document.createElement("style");t.setAttribute("type","text/css"),t.textContent="\n     #scc_loading_ui{width:100%;height:100%;position:absolute;text-align:center;display:none;}\n     #scc_loading_centerer{position:absolute;left:50%;right:0;bottom:50%;}\n     #scc_loading_spinner {\n         position: absolute;\n         display: block;\n         border: 2px solid #d9d9d9;\n         border-top: 2px solid #b7472a;\n         border-radius: 95%;\n         top: 7px;\n         left: 6px;\n         width: 48px;\n         height: 48px;\n         margin-left: -25px;\n         margin-top: -25px;\n         z-index: 1051;\n         -moz-animation: scc_fastbootspin 1.4s ease infinite;\n         -webkit-animation: scc_fastbootspin 1.4s ease infinite;\n         animation: scc_fastbootspin 1.4s ease infinite;\n     }\n     @-moz-keyframes scc_fastbootspin {\n         100% {\n             -moz-transform: rotate(360deg);\n         }\n     }\n     @-webkit-keyframes scc_fastbootspin {\n         100% {\n             -webkit-transform: rotate(360deg);\n         }\n     }\n     @keyframes scc_fastbootspin {\n         100% {\n             -webkit-transform: rotate(360deg);\n             transform: rotate(360deg);\n         }\n     }",document.getElementsByTagName("head")[0].appendChild(t),this.m_loadingDiv=document.createElement("div"),this.m_loadingDiv.id="scc_loading_ui",e.appendChild(this.m_loadingDiv);const i=document.createElement("div");i.id="scc_loading_centerer",this.m_loadingDiv.appendChild(i);const n=document.createElement("span");n.id="scc_loading_spinner",i.appendChild(n)}}class b{get state(){return this.m_state}getTelemetry(){return this.m_telemetry}setState(e){if(e!==this.m_state){switch(this.m_state=e,e){case a.g.Normal:window.clearTimeout(this.m_showLoadingUITimeoutId),this.m_isBoot=!1,this.m_loadingUI.hide();break;case a.g.Loading:window.clearTimeout(this.m_showLoadingUITimeoutId),this.m_showLoadingUITimeoutId=window.setTimeout(()=>{this.m_loadingUI.show(),this.m_isBoot&&(this.m_telemetry.pptSpinnerStartTime=f.a.performanceNowTrimmed()),d.a.sendTraceTag(506857091,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCoreStateManager: Showing Loading Spinner. isBoot: ${this.m_isBoot}.`)},this.m_progressIndicatorWaitTimeMs)}this.m_events.emit("stateChanged")}}constructor(e,t){this.m_showLoadingUITimeoutId=-1,this.m_events=new o.EventEmitter,this.m_isBoot=!0,this.m_telemetry={},this.m_state=e,this.m_loadingUI=t,this.m_progressIndicatorWaitTimeMs=_.a.readNumberOrDefault("progressIndicatorWaitTimeMs",1250),d.a.sendTraceTag(506857092,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCoreStateManager: Progress Indicator wait time: "+this.m_progressIndicatorWaitTimeMs)}}function w(e,t){for(const i of t)if(i.id.toString()===e)return i;return null}function C(e,t){const i=w(e,t);return i&&i.sldIds.length>0?(i.sldIds[0].cid=0,i.sldIds[0]):null}function I(e,t){const i=w(e,t);return i&&i.sldIds.length>0?i.sldIds[i.sldIds.length-1]:null}class P{get targetSlide(){return this.m_targetSlide}get returnToParent(){return this.m_returnToParent}get originSlide(){return this.m_originSlide}get lastSlide(){return this.m_lastSlide}constructor(e,t,i,n,r,a){this.m_returningEntry=!1,this.m_targetSlide=e,this.m_lastSlide=t,this.m_section=i,this.m_originSlide=r,this.m_returnToParent=n,this.m_returningEntry=a}}class E{clear(){this.m_zoomStack=[],this.m_zoomCollection=[]}addSlide(e,t,i){const n=new P(e,e,"",i,t,!1);this.m_zoomStack.push(n),this.m_zoomCollection.push(n)}addSection(e,t,i){const n=C(e,this.m_viewDataManager.sections),r=I(e,this.m_viewDataManager.sections);if(!n||!r)return;const a=new P(n,r,e,i,t,!1);this.m_zoomStack.push(a),this.m_zoomCollection.push(a),1===this.m_zoomCollection.length&&d.a.sendTraceTag(506856911,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCoreZoomManager::addSection - Starting summary zoom navigation")}needsToReturnOnNext(e){return this.m_zoomStack.length>0&&e.sid===this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid&&this.m_zoomStack[this.m_zoomStack.length-1].returnToParent}nextReturnToParentId(e){if(this.m_zoomCollection.length>0&&e.sid===this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid&&this.m_zoomStack[this.m_zoomStack.length-1].returnToParent){let e=this.m_zoomStack[this.m_zoomStack.length-1];return this.m_zoomStack.pop(),e=new P(e.targetSlide,e.lastSlide,e.m_section,e.returnToParent,e.originSlide,!0),this.m_zoomCollection.push(e),e?e.originSlide:null}return null}needsToJumpOnNext(e){return!(this.m_zoomCollection.length<=0)&&(!this.m_zoomStack[this.m_zoomStack.length-1]||this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid===e.sid)&&e.sid===this.m_zoomCollection[this.m_zoomCollection.length-1].originSlide.sid&&this.m_zoomCollection[this.m_zoomCollection.length-1].m_returningEntry}slideWhereZoomLeftOff(e){let t=e;return e.sid===this.m_zoomCollection[this.m_zoomCollection.length-1].originSlide.sid&&this.m_zoomCollection[this.m_zoomCollection.length-1].m_returningEntry&&(t=this.m_zoomCollection[this.m_zoomCollection.length-1].lastSlide),t.cid=0,t}zoomOnCurrentSlide(e,t,i){for(const n of t){let t,r;if(n.slideId&&(t=n.slideId,r=n.slideId),n.sectionId&&(t=C(n.sectionId,this.m_viewDataManager.sections),r=I(n.sectionId,this.m_viewDataManager.sections)),t&&r&&t.sid===e.sid)return n.slideId&&this.addSlide(t,i,n.returnToParent),n.sectionId&&this.addSection(n.sectionId,i,n.returnToParent),!0}return!1}checkZoomGoBack(e){if(this.m_zoomCollection.length>0){let t;const i=this.m_zoomCollection[this.m_zoomCollection.length-1];return t=i.m_returningEntry?i.originSlide:i.targetSlide,e.sid===t.sid}return!1}zoomGoBack(e){if(this.m_zoomCollection.length>0){let t,i;const n=this.m_zoomCollection[this.m_zoomCollection.length-1];return n.m_returningEntry?(t=n.originSlide,i=n.lastSlide):(t=n.targetSlide,i=n.originSlide),e.sid===t.sid&&(this.m_zoomCollection.pop(),n.m_returningEntry?(n.m_returningEntry=!1,this.m_zoomStack.push(n)):this.m_zoomStack.pop()),i.cid=0,i}return null}constructor(e){this.m_zoomStack=[],this.m_zoomCollection=[],this.m_viewDataManager=e}}class x{static convertToSlideShowError(e){switch(e){case"ErrorRESERVEDItemFailed":case"ErrorContentDispositionHeaderNotValid":case"ErrorItemNameNotValid":case"ErrorResponseNotValid":return a.h.GetItemsFailedInvalidResponse;case"ErrorRequestTimeout":return a.h.GetItemsTimeout;case"ErrorFailedToFetch":case"ErrorRequestCanceled":case"ErrorConnectionLost":case"ErrorRequestFailed":return a.h.GetItemsRequestFailed;case"ServerErrorFileDownloadStatusCodeNotFound":return a.h.GetItemsFailedDownloadFile;case"ErrorFailedToLoadPresInfo":case"ErrorMissingClientWidthOrHeight":case"ErrorFailedToLoadSlide":case"ErrorFailedToParseSlideInfo":case"ErrorFailedToLoadSlideViewData":case"ErrorFailedToLoadShapeViewData":case"ErrorFailedToLoadResourceEntry":case"ErrorMissingEntriesInOptions":case"ErrorFailedToLoadSlideInfo":case"ErrorMissingSlideId":return a.h.LoadFailed;case"ErrorResourceNotFound":case"ErrorResourceNotAllowed":case"ErrorResourceLoaderNotAvailable":return a.h.ResourceLoaderFailed;case"FailedToRenderContextLost":case"FailedToRenderSBNotReady":case"FailedToRenderMissingSceneView":case"TexturesNotLoaded":case"MissingSceneView":case"TryPrepareTimeout":return a.h.SlideVisualizationFailed;case"InvalidHiddenSlideInfo":case"SlideMetadataNotFound":return a.h.EnsureSlideFailed;case"ServerFailedToDownloadMetadata":return a.h.ServerFailedToDownloadMetadata}return e}}class k{static getMemoryUsage(){const e=window.performance;if(!e||!e.memory)return void d.a.sendTraceTag(506856862,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"performance.memory not supported");const t={heapLimit:e.memory.jsHeapSizeLimit,totalHeapSize:e.memory.totalJSHeapSize,usedHeapSize:e.memory.usedJSHeapSize};return navigator.deviceMemory&&(t.availableRAMInGB=navigator.deviceMemory),t}static logMemoryUsage(){const e=k.getMemoryUsage();e&&d.a.sendTraceTag(506856861,c.a.msoulscat_Wac_PptSlideshow,e.usedHeapSize/e.heapLimit>.8?h.a.Warning:h.a.Info,JSON.stringify(e))}constructor(){k.getMemoryUsage()&&window.setInterval(k.logMemoryUsage,6e4)}}var M=i(61),A=i(42);class R{injectInterface(e){}getEditMode(){return A.d.None}getThemeBySlideId(e){return new A.c}getDocumentUrl(){return""}async goToByIndex(e){if(null==this.m_slideshowCore||0===e.length)return A.e.errorCodes.ooeInternalError;const t=this.m_slideshowCore.getSlideLocation();let i=void 0;switch(e){case"previous":if(await this.m_slideshowCore.prevSlide(!1),i=this.m_slideshowCore.getSlideLocation(),t&&i&&t.slideIndex===i.slideIndex)return A.e.errorCodes.ooeNavOutOfBound;break;case"next":if(await this.m_slideshowCore.nextSlide(!1),i=this.m_slideshowCore.getSlideLocation(),t&&i&&t.slideIndex===i.slideIndex)return A.e.errorCodes.ooeNavOutOfBound;break;case"first":await this.m_slideshowCore.gotoFirstSlide(!0);break;case"last":await this.m_slideshowCore.gotoLastSlide(!0);break;default:const n=Number.parseInt(e,10)-1;if(Number.isNaN(n))return A.e.errorCodes.ooeInternalError;if(n<0||n>=this.m_slideshowCore.getSlideCount())return A.e.errorCodes.ooeNavOutOfBound;await this.m_slideshowCore.gotoSlide({slideIndex:n})}return A.e.errorCodes.ooeSuccess}async goToBySlide(e){const t=Number.parseInt(e,10);return null==this.m_slideshowCore||Number.isNaN(t)?A.e.errorCodes.ooeInternalError:t<0?A.e.errorCodes.ooeNavOutOfBound:(await this.m_slideshowCore.gotoSlide({slideId:{sid:t,cid:0}}),A.e.errorCodes.ooeSuccess)}async getSelectedSlides(){let e=void 0;if(!this.m_slideshowCore||!(e=this.m_slideshowCore.getSlideLocation()))return"";let t=e.slideIndex;const i=e.slideId.sid;t+=1;const n=await this.m_slideshowCore.getSlideTitle(),r=[[i.toString(),n,t.toString()]];return JSON.stringify(r)}async setAddinSyncState(e){return this.m_slideshowCore.events.emit("slideAddinSyncStateEvent",e),A.e.errorCodes.ooeSuccess}async getAddinSyncState(e){}get requiredInterfaces(){return[]}constructor(e){this.m_slideshowCore=e}}var O=i(53);class F{get isHealthy(){return this.m_isHealthy}startPinging(){this.m_shouldPing&&this.m_pingLoopActive||(this.m_shouldPing=!0,this.runPingLoopAsync())}stopPinging(){this.m_shouldPing=!1}async runPingLoopAsync(){for(this.m_pingLoopActive=!0;this.m_shouldPing;){let e=!1,t=!1;const i=setTimeout(()=>{this.m_isPingHealthy=!1,t=!0},_.a.readNumberOrDefault("pingTimeoutMs",1e4));let n,r;try{n=await fetch(this.m_pingUrl,{cache:"no-cache"})}catch(t){e=!0}clearTimeout(i),this.m_isPingHealthy=!!n&&200===n.status&&!t&&!e,this.updateNetworkHealth(),r=this.m_isPingHealthy?_.a.readNumberOrDefault("pingIntervalMs",2e3):t?0:_.a.readNumberOrDefault("pingIntervalAfterFailureMs",200),await Object(O.d)(r)}this.m_pingLoopActive=!1}updateNetworkHealth(){const e=navigator.onLine&&this.m_isPingHealthy;e!==this.m_isHealthy&&(this.m_isHealthy=e,this.events.emit("isHealthyChanged",e),d.a.sendTraceTag(506857221,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify({isHealthy:e,onLine:navigator.onLine,isPingHealthy:this.m_isPingHealthy})))}constructor(e){this.events=new o.EventEmitter,this.m_shouldPing=!1,this.m_pingLoopActive=!1,this.m_isPingHealthy=!0,this.m_isHealthy=!0,this.m_pingUrl=e,window.addEventListener("online",()=>{this.updateNetworkHealth()}),window.addEventListener("offline",()=>{this.updateNetworkHealth()})}}var D=i(92);class L{get zoomSource(){return this.m_zoomSource}get isZooming(){return this.m_isZooming}async animateZoomAsync(e,t,i,n,r){return new Promise(a=>{this.m_zoomAnimClock=new u.d;const s=this.m_slideShowCore.opticalZoomStateInfo.currentState.zoomLevel;this.m_isZooming=!0,this.resolvePromise=a,this.m_zoomSource=r||null,this.m_zoomAnimClock.events.on("tick",o=>{const l=this.m_slideShowCore.getSlideLocation();if(!i)return d.a.sendTraceTag(506857058,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - viewController undefined."),void a();if(!l)return d.a.sendTraceTag(506857057,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - current slide location undefined."),void a();try{const u=i.getBounds.getClientSizeFromCanvas(),m=Math.min(1,o/t),f=s+(e-s)*(.5-.5*Math.cos(2*Math.PI*(1-1/(m+1)))),p=n||u.scale(.5),g=i.calculateCanvasCenterSlidePointPercentAfterZoom(p,f,l.slideId,this.m_slideShowCore.opticalZoomStateInfo.currentState);if(!g)return void a();if(isNaN(g.x)||isNaN(g.y))return this.finishZoomAnimation(),void d.a.sendTraceTag(506857056,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"OpticalZoomAnimationController::animateZoomAsync - Finishing zoom animation due to NaN");const S={zoomLevel:f,canvasCenterSlidePointPercent:g};if(this.m_slideShowCore.setOpticalZoomState({currentState:S,metadata:r?{source:r}:void 0}),_.a.readBooleanOrDefault("enableInkOpticalZoom",!1)){const e=i.getBounds.getBoundingClientRectFromCanvas(),t={width:e.width*f,height:e.height*f,zoomPositionX:p.x,zoomPositionY:p.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",t)}m>=1&&(this.stopZoomAnimation(),a())}catch(e){d.a.sendTraceTag(506857055,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"OpticalZoomAnimationController::animateZoomAsync - "+e),this.stopZoomAnimation(),a()}}),this.m_zoomAnimClock.start()})}async animateZoomWithAnimationProgressEventsAsync(e,t,i,n){return new Promise(r=>{this.m_zoomAnimClock=new u.d,this.m_isZooming=!0,this.resolvePromise=r,this.m_zoomSource=n&&n.source?n.source:null,this.m_startOpticalZoomState=this.m_slideShowCore.opticalZoomStateInfo.currentState;const a=i.getBounds.getClientSizeFromCanvas(),s=n&&n.canvasZoomPositionInPixels?n.canvasZoomPositionInPixels:a.scale(.5),o=this.calculateOpticalZoomStateAtTime(1,i,s);if(this.m_targetOpticalZoomState={zoomLevel:e,canvasCenterSlidePointPercent:{x:.5,y:.5}},o&&(this.m_targetOpticalZoomState=o),this.m_slideShowCore.setOpticalZoomState({currentState:this.m_slideShowCore.opticalZoomStateInfo.currentState,animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:n&&n.source?{source:n.source}:void 0}),o){if(window.matchMedia("(prefers-reduced-motion: no-preference)").matches)this.m_zoomAnimClock.events.on("tick",e=>{this.calculateNextZoomFrame(e,t,i,n&&n.canvasZoomPositionInPixels)}),this.m_zoomAnimClock.start();else if(this.finishZoomAnimation(),_.a.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!_.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){const e=i.getBounds.getBoundingClientRectFromCanvas(),t={width:e.width*o.zoomLevel,height:e.height*o.zoomLevel,zoomPositionX:s.x,zoomPositionY:s.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",t)}}else this.finishZoomAnimation()})}calculateNextZoomFrame(e,t,i,n){try{const r=Math.min(1,e/t),a=i.getBounds.getClientSizeFromCanvas(),s=n||a.scale(.5),o=this.calculateOpticalZoomStateAtTime(r,i,s);if(!o)return void this.finishZoomAnimation();if(this.m_slideShowCore.setOpticalZoomState({currentState:o,animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:this.m_zoomSource?{source:this.m_zoomSource}:void 0}),_.a.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!_.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){const e=i.getBounds.getBoundingClientRectFromCanvas(),t={width:e.width*o.zoomLevel,height:e.height*o.zoomLevel,zoomPositionX:s.x,zoomPositionY:s.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",t)}r>=1&&this.stopZoomAnimation()}catch(e){d.a.sendTraceTag(506857054,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"OpticalZoomAnimationController::animateZoomAsync - "+e),this.stopZoomAnimation()}}calculateOpticalZoomStateAtTime(e,t,i){const n=this.m_slideShowCore.getSlideLocation();if(!t)return d.a.sendTraceTag(506857053,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - viewController undefined."),null;if(!n)return d.a.sendTraceTag(506857052,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - current slide location undefined."),null;const r=this.m_startOpticalZoomState.zoomLevel,a=r+(this.m_targetOpticalZoomState.zoomLevel-r)*(.5-.5*Math.cos(2*Math.PI*(1-1/(e+1)))),s=t.calculateCanvasCenterSlidePointPercentAfterZoom(i,a,n.slideId,this.m_slideShowCore.opticalZoomStateInfo.currentState);return s?isNaN(s.x)||isNaN(s.y)?(d.a.sendTraceTag(506857051,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"OpticalZoomAnimationController::animateZoomAsync - Finishing zoom animation due to NaN"),null):{zoomLevel:a,canvasCenterSlidePointPercent:s}:null}stopZoomAnimation(){return this.m_isZooming=!1,!!this.m_zoomAnimClock&&(this.m_zoomAnimClock.stop(),this.resolvePromise&&this.resolvePromise(),this.resolvePromise=void 0,this.m_zoomAnimClock=null,!0)}finishZoomAnimation(){return!!this.stopZoomAnimation()&&(_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)?this.m_slideShowCore.setOpticalZoomState({currentState:{zoomLevel:this.m_targetOpticalZoomState.zoomLevel,canvasCenterSlidePointPercent:this.m_targetOpticalZoomState.canvasCenterSlidePointPercent},animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:this.m_zoomSource?{source:this.m_zoomSource}:void 0}):this.m_slideShowCore.zoomToAsync(1),!0)}constructor(e){this.m_isZooming=!1,this.m_zoomAnimClock=null,this.m_slideShowCore=e,this.resolvePromise=void 0,this.m_zoomSource=null;const t={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}};this.m_startOpticalZoomState=t,this.m_targetOpticalZoomState=t}}class B{pause(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())}resume(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())}setTime(e){this.isPaused&&(this.m_pausedTimeMs=Date.now()),this.m_timeoutMs=e+(Date.now()-this.m_startTimeMs),this.updateTimeout()}addTime(e){this.m_timeoutMs+=e,this.updateTimeout()}abort(){window.clearTimeout(this.m_timeoutId),this.m_callback=()=>{}}get isPaused(){return this.m_pausedTimeMs>this.m_resumedTimeMs}updateTimeout(){window.clearTimeout(this.m_timeoutId);const e=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(e)&&(this.m_timeoutId=window.setTimeout(this.m_callback,e-(Date.now()-this.m_startTimeMs)))}constructor(e,t,i){this.m_pausedTimeMs=0,this.m_resumedTimeMs=0,this.m_maxTimeoutDurationMs=i?i.maxTimeoutDurationMs:void 0,this.m_callback=e,this.m_timeoutMs=t,this.m_startTimeMs=Date.now(),this.updateTimeout()}}class N{static recordInput(e){N.s_queuedRenderEvents.push({source:e,startTime:performance.now()})}static recordRender(){if(0===N.s_queuedRenderEvents.length)return;const e=performance.now(),t=_.a.readNumberOrDefault("actionToRenderTimeoutUntilLogMs",1e3);for(const i of N.s_queuedRenderEvents){const n=Math.round(e-i.startTime),r=N.s_sourceToAvgTimePerRenderMap.get(i.source);r?(r.timeToLog.setTime(t),r.inputToRenderTimesMs.push(n)):N.s_sourceToAvgTimePerRenderMap.set(i.source,{inputToRenderTimesMs:[n],timeToLog:new B(()=>{N.logInputToRenderTime(i.source)},t)})}N.s_queuedRenderEvents=[]}static logInputToRenderTime(e){const t=N.s_sourceToAvgTimePerRenderMap.get(e);t&&(d.a.sendTraceTag(509441479,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,JSON.stringify({source:e,actionToRenderTimes:t.inputToRenderTimesMs})),N.s_sourceToAvgTimePerRenderMap.delete(e))}}N.s_queuedRenderEvents=[],N.s_sourceToAvgTimePerRenderMap=new Map;const V=i(116);var W,U;function z(e,t){e&&(t.meta_clientWidth=_.a.readNumberOrDefault("hackClientWidth",e.x),t.meta_clientHeight=_.a.readNumberOrDefault("hackClientHeight",e.y))}function H(e,t){if(!e||!e[0])return;let i=e[0];const n=e=>t.x>t.y?e.x:e.y,r=(e,t)=>Math.abs(n(e)-n(t));let a=r(i,t);for(const n of e)r(n,t)<a&&(a=r(n,t),i=n);return i}!function(e){e.FixedSize="FixedSize",e.BucketedSize="BucketedSize",e.FlexibleSizeWithMinMax="FlexibleSizeWithMinMax"}(W||(W={})),function(e){e.InitPresInfo="initPresInfo",e.GotoSlideEnsureSlide="gotoSlideEnsureSlide",e.GotoSlideRenderSlide="gotoSlideRenderSlide",e.UpdateResourceProvidersPresInfo="updateResourceProvidersPresInfo",e.UpdateViewDataManager="updateViewDataManager",e.PrefetchEnsureSlide="prefetchEnsureSlide",e.GotoSlideRenderTransition="GotoSlideRenderTransition",e.CheckHidden="checkHidden"}(U||(U={}));let G,j=!1;const $={};function q(e){if(e.logger&&(d.a.setLogger(e.logger),Z.logger=e.logger,!j)){d.a.sendTraceTag(506856856,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore Version: 8.4.43, SVM Version: 9.2.34, SB Version: 1.9.27"),Object(M.a)();const t=e.logger;G=()=>{"flushOnClose"in t&&t.flushOnClose()},window.addEventListener("beforeunload",G),j=!0}e.logger&&e.vetoSessionId&&m.e.setVetoUtil({SessionId:e.vetoSessionId},e.logger),e.settings&&_.a.load(e.settings?e.settings.slideshowcore:{}),e.disabledChangeGates&&g.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.ssc=$),Object(s.p)(e),Object(l.c)({logger:e.logger,stringifyError:M.b})}class Z{get shouldFetchCustomShows(){return this.m_customShowRequestedTime>this.m_customShowReceivedTime}addClientSizeToLoader(e){return{load:(t,i)=>{const n=this.addCommonResourceMetadata(i||{});return e.load(t,n)}}}endSession(e){this.setBlankSlideState(a.a.Black),g.ChangeGate.isChangeGateEnabled("RemoveRestoreSlideIdOrderAtEndSession")||this.m_isCustomSlideShowActive&&this.restoreSlideIdOrder(),this.m_viewController&&(this.m_viewController.stopCrossSlideAudio(),this.m_viewController.cleanUpAccessibilityContainer()),this.m_shouldNavigateToHiddenSlides=!1,this.m_cameoPresenceCache={},this.flushSessionEndLogs(e),this.events.emit("sessionEnded")}raiseSlideshowRenderedEvent(){this.events.emit("slideShowRenderedToCanvas"),d.a.sendTraceTag(506856852,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::raiseSlideshowRenderedEvent: ${performance.now()}, slideShowRenderedEvent raised`)}async init(){const e=Object(y.v4)(),t={correlationId:e};t[v.a.Init]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},this.m_sessionSettings.bootMetrics&&(this.m_sessionSettings.bootMetrics.initSlideShowCoreTime=t[v.a.Init].start),t.getPresInfo={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},this.m_stateManager.setState(a.g.Loading);const i={slideLocation:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation,isBootRequest:!0},n=await this.getPresInfoItem(e,v.a.Init,i);if(!n||!n.resource){const i=n&&n.metadata&&n.metadata.hasOwnProperty("errorName")?n.metadata.errorName:"ErrorFailedToLoadPresInfo";return"ServerErrorFileDownloadResourceInconsistent"===i?(d.a.sendTraceTag(506856851,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::init - Failed to get PresInfo due to handling resource incosistent status"),{fSucceeded:!1,metrics:t,errorName:"presInfoFailed"}):(this.handleErrors({errorName:i},{errorAction:U.InitPresInfo}),d.a.sendTraceTag(506856850,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::init - Failed to get PresInfo. correlation:${e}, ErrorName:${i}`),{fSucceeded:!1,metrics:t,errorName:"presInfoFailed"})}let r;d.a.sendTraceTag(506856849,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::init - Got PresInfo. correlation:"+e),this.events.emit("bootStageChanged","InitViewController"),n&&n.metadata&&n.metadata.hasOwnProperty(v.c.GetItemsResult)&&(t[v.c.GetItemsResult]=n.metadata[v.c.GetItemsResult]),t.getPresInfo.end=f.a.performanceNowTrimmed(),this.m_viewController=new s.l(this.m_container,new s.k(n.resource.SlideEmuWidth,n.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid,this.m_appForOfficeManager),this.m_viewController.rendererEnvironment.glContext||_.a.readBooleanOrDefault("forceSvg",!1)||(d.a.sendTraceTag(506856848,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::SetupWebGLContextFailed - Switching renderingMode from webGL to SVG on boot"),_.a.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","forceSvg","true"),q({logger:this.m_logger,settings:this.m_sessionSettings.slideShowCoreSettings.settings,disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates}),this.m_viewControllerSettings.transparentCanvasForVideoEnabled=_.a.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!_.a.readBooleanOrDefault("forceSvg",!1)||!1,await this.updateResourceProviders(this.m_providers,{shouldResetProviders:!0}),this.m_viewController&&this.m_viewController.dispose(),this.m_viewController=new s.l(this.m_container,new s.k(n.resource.SlideEmuWidth,n.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid,this.m_appForOfficeManager)),await this.m_viewController.init(),g.ChangeGate.isChangeGateEnabled("SSC.SetMediaCommandScope")&&(this.m_sessionSettings.appSettings.initialSlideShowRole?this.m_viewController.mediaCommandScope=this.m_sessionSettings.appSettings.initialSlideShowRole===a.i.Presenter?s.c.All:s.c.Local:this.m_viewController.mediaCommandScope=s.c.None),d.a.sendTraceTag(506856847,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::init - ViewController Initialized. "),this.m_contextIsLoaded=!0,this.m_viewController.rendererEnvironment.glContext&&this.m_viewController.events.on("renderingStageChanged",e=>this.events.emit("bootStageChanged",e)),this.m_viewController.events.on("webglcontextlost",()=>{if(this.m_contextIsLoaded=!1,!this.m_currentSlideLocation||!this.m_viewController)return void d.a.sendTraceTag(506856846,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::init - Raised event WebGLContext lost currentSlideLocation: ${!!this.m_currentSlideLocation}, viewController: ${!!this.m_viewController}. `);const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);e&&e.animClock.pause(),this.pauseTransition()}),this.m_viewController.events.on("webglcontextrestored",()=>{if(this.m_contextIsLoaded=!0,!this.m_currentSlideLocation||!this.m_viewController)return void d.a.sendTraceTag(506856845,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::init - Raised event webglcontextrestored currentSlideLocation: ${!!this.m_currentSlideLocation}, viewController: ${!!this.m_viewController}. `);const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);e&&e.animClock.resume(),this.resumeTransition(),this.setOpticalZoomState({currentState:Z.s_defaultOpticalZoomState,metadata:{source:"webglcontextrestored"}}),this.events.emit("webglcontextrestored")}),this.m_viewController.events.on("restoreWebGLContextFailed",async()=>{await this.changeRenderingModeToSVG(),d.a.sendTraceTag(506856844,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::restoreWebGLContextFailed - Switching renderingMode from webGL to SVG midsession")}),this.m_viewController.events.on("glyphCacheFailed",()=>{this.m_slideRefreshNeeded=!0}),g.ChangeGate.isChangeGateEnabled("SlideshowRenderedVerifyGlyphStartEventRaiseEnabled")&&this.m_viewController.events.on("verifyGlyphStart",()=>{this.raiseSlideshowRenderedEvent()}),new ResizeObserver(this.onResizeObservedAsync.bind(this)).observe(this.m_container),this.m_stateManager.setState(a.g.Normal);let o=void 0;if(_.a.readBooleanOrDefault("enableNoFirstVisibleSlideCallDuringInit",!1)){if(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(d.a.sendTraceTag(506856842,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::init - try to get targetSlideLocation from setting's startingSlideLocation."),r=this.resolvePartialSlideLocation(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation)),!r){if(d.a.sendTraceTag(506856841,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::init - no valid SlideLocation from setting, try to get first visible slide."),o=await this.getFirstVisibleSlideIndex(),o.hasOwnProperty("errorName"))return d.a.sendTraceTag(556847947,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::init - getFirstVisibleSlideResult return with error: ${o.errorName}, return from init.`),{fSucceeded:!1,metrics:t};o[v.a.CheckHidden]&&(t[v.a.CheckHidden]=o[v.a.CheckHidden]),r=this.resolvePartialSlideLocation({slideId:o.slideId})}}else{if(o=await this.getFirstVisibleSlideIndex(),o.hasOwnProperty("errorName"))return g.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&d.a.sendTraceTag(507909345,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::init - getFirstVisibleSlideResult return with error: ${o.errorName}.`),{fSucceeded:!1,metrics:t};o[v.a.CheckHidden]&&(t[v.a.CheckHidden]=o[v.a.CheckHidden]),this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(r=this.resolvePartialSlideLocation(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation)||this.resolvePartialSlideLocation({slideId:o.slideId}))}if(this.m_lastRequestedSlideState={slideLocation:r,options:{animationState:this.m_sessionSettings.slideShowCoreSettings.startingAnimationState}},d.a.sendTraceTag(506856840,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::init - Begin GoToSlide. "),this.events.emit("bootStageChanged","GotoTargetSlide"),r){d.a.sendTraceTag(506856839,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::init - call gotoSlide with targetSlideLocation: ${JSON.stringify(r)}. `),t[v.a.Goto]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()};const e=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0;await this.gotoSlide(r,{animationState:this.m_sessionSettings.slideShowCoreSettings.startingAnimationState,actionContext:{navigationType:a.c.Init,startFromTime:e,bootMetrics:this.m_sessionSettings.bootMetrics}}),t[v.a.Goto].end=f.a.performanceNowTrimmed()}else{if(d.a.sendTraceTag(506856838,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::init - continue init without targetSlideLocation and try to use getFirstVisibleSlideResult."),!o)return d.a.sendTraceTag(506856837,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::init - getFirstVisibleSlideResult not valid."),{fSucceeded:!1,metrics:t};const e=this.resolvePartialSlideLocation({slideId:o.slideId});if(e){const t=Object(y.v4)(),i=this.addCommonResourceMetadata({meta_correlationId:t,meta_isInit:!0});this.m_viewDataManager.getSlideViewData(e.slideId,i).then(i=>{i.resource&&this.m_viewController&&i.resource.slideSizePixels?(this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,i.resource.slideSizePixels),this.prefetchSlide(e,!0),this.events.emit("prefetchOnInit",e)):d.a.sendTraceTag(506856836,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::init - Failed to get slideViewData. sid:${e.slideId.sid}, errorName:${i.metadata.errorName}, correlation:${t}`)})}}return d.a.sendTraceTag(506856835,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::init - End GoToSlide. "),t[v.a.Init].end=f.a.performanceNowTrimmed(),this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordInitData({correlationId:e,...t}),{fSucceeded:!0,metrics:t}}updateSlideIdOrder(e){this.m_isCustomSlideShowActive=!0,this.m_currentCustomShowIndex=-1,this.m_slideIdOrder=e,this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder)}async onResizeObservedAsync(e){for(const t of e)t.target.id===this.m_container.id&&await this.resizeAsync(0)}async resizeAsync(e){if(this.m_viewController&&(_.a.readBooleanOrDefault("forceSvg",!1)||this.m_contextIsLoaded)&&this.m_container.offsetParent){if(this.m_viewController.onResize(),this.m_currentSlideLocation){const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(t&&(this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,t.slideSizePixels),this.m_blankSlideState===a.a.Hidden)){t.fImageTextureLoaded||(d.a.sendTraceTag(506856833,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"ResizeObserver textures not loaded for current slide, reloading"),await this.m_viewController.ensureTextureLoaded(this.m_currentSlideLocation.slideId));const i=this.m_viewController.rendererEnvironment.canvas,n=this.m_viewController.getBounds.getClientSizeFromContainer(),r=this.m_viewController.getBounds.getClientSizeFromCanvas();d.a.sendTraceTag(506856832,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"ResizeObserver "+JSON.stringify({reRenderingSlideId:this.m_currentSlideLocation.slideId,containerSize:`${this.m_container.clientWidth}x${this.m_container.clientHeight}`,canvasSize:`${i.clientWidth}x${i.clientHeight}`,containerSizeCached:`${n.x}x${n.y}`,canvasSizeCached:`${r.x}x${r.y}`,isTiny:Math.min(r.x,r.y)<_.a.readNumberOrDefault("tinySizeForContainer",50)})),_.a.readBooleanOrDefault("useDirtyFlagForResize",!1)?(this.m_slideRefreshNeeded=!0,this.events.once("animatedContentStateChanged",()=>{this.onRenderAfterResize(e)})):(this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.onRenderAfterResize(e))}}this.events.emit("slideDimensionsChanged")}else d.a.sendTraceTag(506856834,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"Resize returning early, "+JSON.stringify({viewController:!!this.m_viewController,contextIsLoaded:this.m_contextIsLoaded,forceSVG:_.a.readBooleanOrDefault("forceSvg",!1),offsetParent:!!this.m_container.offsetParent}))}onRenderAfterResize(e){if(!this.m_viewController)return;const t=this.m_viewController.rendererEnvironment.canvas,i=this.m_viewController.getBounds.getClientSizeFromContainer(),n=this.m_viewController.getBounds.getClientSizeFromCanvas(),r=Math.min(n.x,n.y)<_.a.readNumberOrDefault("tinySizeForContainer",50);if(d.a.sendTraceTag(506856803,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"First render after resize "+JSON.stringify({containerSize:`${this.m_container.clientWidth}x${this.m_container.clientHeight}`,canvasSize:`${t.clientWidth}x${t.clientHeight}`,containerSizeCached:`${i.x}x${i.y}`,canvasSizeCached:`${n.x}x${n.y}`,isTiny:r})),0===e&&this.m_resizeAfterTinyCanvasTC&&(this.m_resizeAfterTinyCanvasTC.abort(),this.m_resizeAfterTinyCanvasTC=void 0),r){const t=_.a.readNumberOrDefault("maxRetriesForTinySize",0);e<t&&(this.m_resizeAfterTinyCanvasTC=new B(()=>{this.resizeAsync(e+1)},_.a.readNumberOrDefault("retryTimeoutForTinySizeMs",1e3)))}if(r){const t=_.a.readNumberOrDefault("tinySizeTimeout",4e3);this.m_tinyCanvasTooLongTC&&0===e?this.m_tinyCanvasTooLongTC.setTime(t):this.m_tinyCanvasTooLongTC=new B(()=>{d.a.sendTraceTag(506856802,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`Canvas still tiny ${t}ms after last resize`)},t)}!r&&this.m_tinyCanvasTooLongTC&&(this.m_tinyCanvasTooLongTC.abort(),this.m_tinyCanvasTooLongTC=void 0)}async changeRenderingModeToSVG(e){d.a.sendTraceTag(506856801,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::changeRenderingModeToSVG - Switching renderingMode from webGL to SVG");const t=Date.now();_.a.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","forceSvg","true"),q({settings:this.m_sessionSettings.slideShowCoreSettings.settings}),this.m_viewControllerSettings.transparentCanvasForVideoEnabled=_.a.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!_.a.readBooleanOrDefault("forceSvg",!1)||!1,await this.updateResourceProviders(this.m_providers,{shouldResetProviders:!0,switchToSvg:!0});const i=e&&e.location?e.location:this.m_currentSlideLocation;i&&(this.m_viewDataManager.imageDataMap=new Map,await this.gotoSlide(i,{actionContext:{navigationType:a.c.Init},animationState:this.getAnimationState(!0),fForceRetry:!0,fForceNavigate:!0,fSkipTransition:!0,fSuppressNavigatedFromEvent:_.a.readBooleanOrDefault("enableSuppressingNavigatedFromEvent",!1)})),d.a.sendTraceTag(506856800,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::changeRenderingModeToSVG - Switched renderingMode from webGL to SVG in ${Date.now()-t} ms`),this.events.emit("renderingModeChangedToSVG")}ensureAppForOfficeManager(){if(this.m_appForOfficeManager||(this.m_appForOfficeManager=new A.b,this.m_appForOfficeManager.ApiFacade=new R(this),this.m_appForOfficeManager.events.on("frameTrustCheck",()=>{this.events.emit("frameTrustCheck")})),this.m_appForOfficeManager&&!this.m_appForOfficeManager.fInitialized()){const e={IsRtl:void 0!==this.m_sessionSettings.appSettings.isRtl&&this.m_sessionSettings.appSettings.isRtl,AppForOfficeAllowExternalMarketplace:_.a.readBooleanOrDefault("appForOfficeAllowExternalMarketplace",!0),AppLcid:this.m_sessionSettings.appSettings.applicationLcid&&this.m_sessionSettings.appSettings.applicationLcid.length>0?this.m_sessionSettings.appSettings.applicationLcid:"1033",AppUILocale:this.m_sessionSettings.appSettings.applicationLocaleName&&this.m_sessionSettings.appSettings.applicationLocaleName.length>0?this.m_sessionSettings.appSettings.applicationLocaleName:"en-US",AppForOfficeOmexBaseUrl:_.a.readStringOrDefault("appForOfficeOmexBaseUrl","https://store.office.com"),ServerUrl:this.m_sessionSettings.appSettings.serverUrl,AppForOfficeTrustUXIsEnabledForPowerPoint:_.a.readBooleanOrDefault("appForOfficeTrustUXIsEnabledForPowerPoint",!0),AppsForOfficePrivateCatalogEnabled:_.a.readBooleanOrDefault("appsForOfficePrivateCatalogEnabled",!0),UploadFileDevCatalogIsDisabled:_.a.readBooleanOrDefault("uploadFileDevCatalogIsDisabled",!1),AreThirdPartyAddInsAllowed:this.m_sessionSettings.appSettings.areThirdPartyAddInsAllowed||_.a.readBooleanOrDefault("areThirdPartyAddInsAllowed",!1),JsScriptsBasePath:this.m_sessionSettings.appSettings.jsScriptsBasePath,UiHost:this.m_sessionSettings.appSettings.uiHost,SlideShowRole:this.m_sessionSettings.appSettings.initialSlideShowRole,TeamsCallId:this.m_sessionSettings.appSettings.teamsCallId,TheWsaClient:this.m_sessionSettings.appSettings.theWsaClient,ExtLogger:this.m_logger,AppForOfficeContextActivationParameters:this.m_sessionSettings.appSettings.appForOfficeContextActivationParameters,CoreSettings:this.m_sessionSettings.slideShowCoreSettings.settings,AppsForOfficeAuthFactory:this.m_sessionSettings.appSettings.appForOfficeAuthFactory,SdxCdnUrl:"",Sdx1CdnUrl:"",ForceUseSdx1Cdn:!1,SdxDmsUrl:"",SovereignFederationDMSToken:"",SovereignFederationDMSTokenSuffix:"",sdxExceptionFrom1CDNList:""};this.m_appForOfficeManager.initialize(null,e)}}async getPresInfoItem(e,t,i){var n;let r;const a={meta_correlationId:e,meta_requestInfo:{ActionType:t}};if(a.meta_filterHiddenSlideInfo=i&&i.isBootRequest,a.meta_includeSections=_.a.readBooleanOrDefault("enableSectionsData",!1),a.meta_isInit=t===v.a.Init,i?this.m_sessionSettings&&this.m_sessionSettings.slideShowCoreSettings&&this.m_sessionSettings.slideShowCoreSettings.usePresInfoFromClient&&i.isPresInfoFromClient?r=await this.m_providers.presInfo.load("",this.addCommonResourceMetadata(a)):(d.a.sendTraceTag(506856799,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::getPresInfoItem - slidelocation:${JSON.stringify(i.slideLocation)}, correlation:${e}`),r=await this.m_providers.presInfoAndSlideInfo.load(i.slideLocation?JSON.stringify(i.slideLocation):JSON.stringify({slideIndex:0}),this.addCommonResourceMetadata(a))):r=await this.m_providers.presInfo.load("",this.addCommonResourceMetadata(a)),!r||!r.resource)return r;r.resource.Sections&&(this.m_viewDataManager.sections=r.resource.Sections),this.m_customShowRequestedTime=Date.now();let s=[];if(this.m_isCustomSlideShowActive&&(g.ChangeGate.isChangeGateEnabled("FixDeleteSlideCustomSlideShow")&&-1!==this.m_currentCustomShowIndex&&this.handleCustomSlideshow(this.m_currentCustomShowIndex),s=this.m_slideIdOrder),r.resource.SlideShowProperties.Item){if(r.resource.SlideShowProperties.Item.start){const e=r.resource.SlideShowProperties.Item;this.m_slideIdOrder=r.resource.SlideOrder.slice(0,e.end-e.start)}else if(r.resource.SlideShowProperties.Item.sid){this.m_slideIdOrder=[];const e=r.resource.SlideShowProperties.Item;for(let t=0;t<e.sid.length;t+=1)this.m_slideIdOrder.push({sid:e.sid[t],cid:0})}}else this.m_slideIdOrder=r.resource.SlideOrder;return this.m_defaultSlideIdOrder=this.m_slideIdOrder,this.m_isCustomSlideShowActive&&s&&s.length>0&&(this.m_slideIdOrder=s),this.m_hiddenSlideIdOrder=null!==(n=r.resource.HiddenSlideOrder)&&void 0!==n?n:[],i&&i.isBootRequest?this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder):this.m_viewDataManager.setSlideIdOrderWithHidden(this.m_slideIdOrder,this.m_hiddenSlideIdOrder),f.a.recordSessionStats({SlideCount:this.m_slideIdOrder.length}),r}flushSessionEndLogs(e){this.m_navigationLoggerNew&&this.m_navigationLoggerNew.logPerfData(),this.events.emit("logSessionEnd");const t=k.getMemoryUsage();if(t&&f.a.recordSessionStats(t),this.m_viewController){const e=this.m_viewController.getGpuMemory();f.a.recordSessionStats({gpuMemoryTotal:e.total,gpuMemoryImages:e.images,leaksPrevented:e.leaksPrevented})}f.a.logSessionEnd(e),"flushOnClose"in this.m_logger&&this.m_logger.flushOnClose()}addCommonResourceMetadata(e){let t=[],i=[],n=[];if(_.a.readBooleanOrDefault("enableSlideSizeAdjustToAvailableSize",!1))try{t=JSON.parse(_.a.readStringOrDefault("availableRenderSlideSizes","[]")),i=JSON.parse(_.a.readStringOrDefault("availableRenderSlideSizesLowConfigClient","[]")),n=JSON.parse(_.a.readStringOrDefault("availableRenderSlideSizesSlowNetworkClient","[]"))}catch(e){d.a.sendTraceTag(506856798,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"addCommonResourceMetadata failed to parse availableRenderSlideSizes: "+e)}const r=e.meta_isInit;let a=W.FixedSize;this.m_sessionSettings.slideShowCoreSettings.enableSlideSizeAdjust?a=W.FlexibleSizeWithMinMax:_.a.readBooleanOrDefault("enableSlideSizeAdjustToAvailableSize",!1)&&(a=W.BucketedSize);const o=JSON.parse(_.a.readStringOrDefault("slideSizeDefault",'{"x":1504,"y":849}')),l=JSON.parse(_.a.readStringOrDefault("slideSizeMax",'{"x":1504,"y":849}')),u=JSON.parse(_.a.readStringOrDefault("slideSizeMin",'{"x":348,"y":261}'));return function(e,t,i,n,r,a,o,l,u,m,f,p,g){const S=_.a.readBooleanOrDefault("maxDPRForGetItemsEnabled",!1)?_.a.readNumberOrDefault("maxDPRForGetItems",5):5,v=Math.min(window.devicePixelRatio||1,S),y=new s.k(t.x*v,t.y*v);let T=!1;if(n){const e=function(){try{const e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(e){const t=null!=e.downlink?e.downlink:void 0;return d.a.sendTraceTag(506856859,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::getNetworkDownlink client network info - downlinkSpeed: ${t}Mbps`),t}}catch(e){d.a.sendTraceTag(506856858,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::getNetworkDownlink network information API not supported by the browser")}}();T=!!e&&e/8<_.a.readNumberOrDefault("downlinkSpeedCutoffForSlowClientsMBps",.77)}const b=H(g,y);b&&(e.meta_clientWidthReduced=b.x,e.meta_clientHeightReduced=b.y);const w=H(g,{x:0,y:0});w&&n&&(e.meta_clientWidthMin=w.x,e.meta_clientHeightMin=w.y);const C=_.a.readNumberOrDefault("overrideDownloadTimeoutIfBadNetworkMs",0);switch(C>0&&n&&(e.meta_overrideDownloadTimeoutIfBadNetworkMs=C),i){case W.FixedSize:z(u,e);break;case W.FlexibleSizeWithMinMax:0!==y.x&&0!==y.y||!u?l&&o&&z({x:Math.min(Math.max(y.x,l.x),o.x),y:Math.min(Math.max(y.y,l.y),o.y)},e):z(u,e);break;case W.BucketedSize:let t=m;n&&d.a.sendTraceTag(506856860,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,JSON.stringify({useSmallResolutionSizeForSlowNetworkClient:_.a.readBooleanOrDefault("useSmallResolutionSizeForSlowNetworkClient",!1),uiHost:r,DPR:window.devicePixelRatio,cappedDPR:v,useSmallResolutionSize:a,isSlowNetworkClient:T,specifiedSlideSize:y})),a&&(!_.a.readBooleanOrDefault("useSmallResolutionSizeForBootOnly",!1)||n)||T&&n&&_.a.readBooleanOrDefault("useSmallResolutionSizeForSlowNetworkClient",!1)?t=g:f&&(t=p),function(e,t,i,n){const r=H(e,i);r&&(z(r,t),n&&d.a.sendTraceTag(506856857,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,JSON.stringify({assignedWidth:r.x,assignedHeight:r.y,slideWidth:i.x,slideHeight:i.y})))}(t,e,y,n)}e.meta_clientWidth&&e.meta_clientHeight||z(y,e)}(e,this.m_viewController?this.m_viewController.getBounds.getClientSizeFromContainer():new s.k(this.m_container.clientWidth,this.m_container.clientHeight),a,r,this.m_sessionSettings.appSettings.uiHost,this.m_sessionSettings.slideShowCoreSettings.useSmallResolutionSize,l,u,o,t,_.a.readBooleanOrDefault("isLowConfigClient",!1),i,n),this.m_sessionSettings.slideShowCoreSettings.isHighContrast&&(e.meta_isHighContrast=!0),this.m_sessionSettings.slideShowCoreSettings.colorMode&&(e.meta_colorMode=this.m_sessionSettings.slideShowCoreSettings.colorMode),e.meta_translateLanguage=this.m_sessionSettings.slideShowCoreSettings.translateLanguage?this.m_sessionSettings.slideShowCoreSettings.translateLanguage:"",this.m_sessionSettings.slideShowCoreSettings.clientColorSettings&&(e.meta_clientColorSettings=this.m_sessionSettings.slideShowCoreSettings.clientColorSettings),_.a.readBooleanOrDefault("morphEnabled",!0)&&(e.meta_enableMorph=!0),e.meta_imageAppendOption=this.m_sessionSettings.slideShowCoreSettings.imageSettings?this.m_sessionSettings.slideShowCoreSettings.imageSettings.imageAppendOption:"embed",e.meta_enableClustering=!!this.m_sessionSettings.slideShowCoreSettings.imageSettings&&this.m_sessionSettings.slideShowCoreSettings.imageSettings.enableClustering,e.meta_enableSVGAsWebGLTexture=_.a.readBooleanOrDefault("enableSVGAsWebGLTexture",!0),e.meta_convertGifToVideo=!0===this.m_sessionSettings.slideShowCoreSettings.convertGifToVideo,_.a.readBooleanOrDefault("enableKnownGlyphsOptimization",!0)&&(e.meta_knownGlyphs=this.m_viewDataManager.glyphStore.knownGlyphsString),_.a.readBooleanOrDefault("enableRegionalFormattingOnBoot",!1)&&(e.meta_localeName=this.m_sessionSettings.appSettings.applicationLocaleName),e}updateLastRequestedSlideState(e){this.m_lastRequestedSlideState=e}getGpuMemory(){if(!this.m_viewController)return;const e=this.m_viewController.getGpuMemory();return{total:e.total,images:e.images,leaks:e.leaks}}handleCustomSlideshow(e){if(d.a.sendTraceTag(506856797,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlide: Custom Slideshow, customShowIndex:"+e),this.shouldFetchCustomShows){const e=this.m_providers.presInfo.getLoadResultInCache("");if(!(e&&e.resource&&e.resource.CustomShows))return void(e&&e.resource?d.a.sendTraceTag(506856795,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::gotoSlide: Custom Slideshow, CustomShows not found in presItem present in cache"):d.a.sendTraceTag(506856796,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::gotoSlide: Custom Slideshow, presItem not found in cache"));this.m_customShows=e.resource.CustomShows,this.m_customShowReceivedTime=Date.now()}if(this.m_customShows)if(e>=0&&e<this.m_customShows.length){const t=this.m_customShows[e];t&&t.sid&&t.sid.length>0&&(this.m_currentCustomShowIndex=e,this.setSlideIdOrderforCustomSlideShow(t))}else d.a.sendTraceTag(506856794,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::gotoSlide: Custom Slideshow, Invalid customShowIndex")}handleSlideIdOrderDuringSlideShowLaunch(e,t=[]){-1!==e?this.handleCustomSlideshow(e):t.length>0?this.updateSlideIdOrder(t):this.m_isCustomSlideShowActive&&this.restoreSlideIdOrder()}async gotoSlideImpl(e,t){const i=t?t.actionContext:void 0;var n,r;d.a.sendTraceTag(506856793,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::gotoSlide: currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)},\n      slideState:${JSON.stringify(e)},\n      animationState:${JSON.stringify(t?t.animationState:"")},\n      skipTansition:${t?t.fSkipTransition:""},\n      fForceRetry:${t?t.fForceRetry:""},\n      fForceNavigate:${t?t.fForceNavigate:""},\n      fSuppressNavigatedFromEvent:${t?t.fSuppressNavigatedFromEvent:""},\n      fClearNavigationState:${t?t.fClearNavigationState:""}`),g.ChangeGate.isChangeGateEnabled("SetSlideIdOrderWhenInSlideState")?(e&&null!==e.customShowIndex&&void 0!==e.customShowIndex||null!=e&&e.slideIdOrder&&e.slideIdOrder.length>0)&&this.handleSlideIdOrderDuringSlideShowLaunch(null!==(n=e.customShowIndex)&&void 0!==n?n:-1,null!==(r=null==e?void 0:e.slideIdOrder)&&void 0!==r?r:[]):e&&null!==e.customShowIndex&&void 0!==e.customShowIndex&&this.handleSlideIdOrderDuringSlideShowLaunch(e.customShowIndex),t&&t.fClearNavigationState&&this.clearNavigationState(),i&&i.startFromTime&&(f.a.logSessionStart(i.startFromTime),m.e.setVetoUtil({SessionId:this.m_sessionSettings.appSettings.userSessionId,StartFromTime:i.startFromTime},this.m_logger));const o=Object(y.v4)(),l={renderTransition:{},renderSlide:{},createTexture:{},id:o};_.a.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)&&this.m_presInfoPromise&&(d.a.sendTraceTag(506856792,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::gotoSlide: : m_presInfoPromise is not resolved yet."),await this.m_presInfoPromise);const u=_.a.readBooleanOrDefault("fixLoaderOnSlideNavigation",!1)&&_.a.readBooleanOrDefault("GotoSlideUseAsyncUtils",!1);if(!this.m_viewController||!u&&this.m_stateManager.state===a.g.Loading||this.m_zoomAnimationController.isZooming||this.isTransitioning&&this.cancelTransition())return d.a.sendTraceTag(592483859,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::gotoSlide returns early. m_viewController:${!!this.m_viewController},\n          this.m_stateManager.state:${this.m_stateManager.state},\n          isInitialized:${!!f.a.getSessionStats("initDur")},\n          bootMetrics:${!(!i||!i.bootMetrics)},\n          navMetrics:${!(!i||!i.navMetrics)},\n          isZooming:${this.m_zoomAnimationController.isZooming} due to ${this.m_zoomAnimationController.zoomSource},\n          this.isTransitioning:${this.isTransitioning}\n          navigationType:${i?i.navigationType:""}`),{fSucceeded:!1,error:a.f.SkippedBusy};let p={};p[v.a.Goto]={start:f.a.performanceNowTrimmed()},p[v.b.EnsureSlideView]={start:f.a.performanceNowTrimmed()};const T=this.resolvePartialSlideLocation(e),b=!V(T,this.m_currentSlideLocation),w=!(!i||i.navigationType!==a.c.Init),C=!(!t||!t.fForceNavigate)&&t.fForceNavigate,I=!(!t||!t.fSuppressNavigatedFromEvent)&&t.fSuppressNavigatedFromEvent,P=b||w||C,E=b||C;w&&(this.m_cameoPresenceCache={}),d.a.sendTraceTag(506856791,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlide: "+JSON.stringify({shouldNavigate:P,targetSlideHasNewContent:E,isDifferentSlide:b,isInit:w,isForceNavigate:C,suppressNavigatedFromEvent:I}));if(T&&P){_.a.readBooleanOrDefault("emitSlideNavigationStartedEvents",!1)&&this.events.emit("slideNavigationStarted",{targetSlideLocation:T,actionContext:i}),_.a.readBooleanOrDefault("enableOpticalZoom",!1)&&b&&(t&&t.fSkipTransition?(this.m_zoomAnimationController.stopZoomAnimation(),this.setOpticalZoomState({currentState:Z.s_defaultOpticalZoomState,metadata:{source:"slideLocationChanged"}})):await this.zoomToAsync(1,void 0,{fAnimate:!0,source:a.d.SlideLocationChanged})),E&&(this.m_currentSlideLocation&&this.onNavigatingFrom(this.m_currentSlideLocation.slideId),this.onNavigatingTo(T.slideId));const e=Object(y.v4)();p={...p,sid:T.slideId.sid,correlationId:e,step:this.m_currentSlideLocation?T.slideIndex-this.m_currentSlideLocation.slideIndex:0};const n=f.a.performanceNowTrimmed();this.m_stateManager.setState(a.g.Loading);const r=setTimeout(()=>{0!==f.a.startFrom&&i&&!i.bootMetrics&&m.e.recordVeto("VetoedSlideShowNavTimeMs",{...p,reportTime:f.a.performanceNowTrimmed(),qosVeto:"SlideShowNavSlow"})},_.a.readNumberOrDefault("vetoNavigationDurationMs",1250)),u=await this.ensureSlideViewElementAsync(T.slideId,!0,e,v.a.Goto,w,i);if(clearTimeout(r),i&&i.navMetrics&&(p.navMetrics=i.navMetrics),i&&i.additionalMetrics){const e=!i.additionalMetrics.isUpdateResourceProviderCalled&&i.additionalMetrics.isSlideCached;d.a.sendTraceTag(508067914,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify({isSlideCached:e,isSlideCachedRaw:!!i.additionalMetrics.isSlideCached,isUpdateResourceProviderCalled:!!i.additionalMetrics.isUpdateResourceProviderCalled,id:i.id}))}this.handleErrors(u,{errorAction:U.GotoSlideEnsureSlide,navigationType:i?i.navigationType:void 0});const C=this.m_viewController.getSlideViewElement(T.slideId);if(this.m_isHandlingResourceInconsistent)d.a.sendTraceTag(506856790,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlide: skip rendering due to handling resource incosistent status");else{if(!C)return d.a.sendTraceTag(593860625,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::gotoSlide slideViewElement of targetSlideLocation is missing. Reverting to previous slide.\n          bootMetrics:${!(!i||!i.bootMetrics)},\n          navMetrics:${!(!i||!i.navMetrics)}`),this.m_stateManager.setState(a.g.Normal),this.m_currentSlideLocation&&E&&(this.onNavigatedFrom(this.m_currentSlideLocation.slideId),this.onNavigatedTo(this.m_currentSlideLocation.slideId)),g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")?{fSucceeded:!1,error:a.f.Failed,errorName:u.hasOwnProperty("errorName")?u.errorName:a.h.SlideViewElementUndefined,metrics:p}:{fSucceeded:!1,error:a.f.Failed};p[v.b.EnsureSlideView].end=f.a.performanceNowTrimmed(),p[v.b.ResizeViewContainer]={start:f.a.performanceNowTrimmed()},this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,C.slideSizePixels),p[v.b.ResizeViewContainer].end=f.a.performanceNowTrimmed(),_.a.readBooleanOrDefault("allowSkipRenderInSetBlankSlideState",!1)?this.setBlankSlideStateInternal(a.a.Hidden,{fSkipRenderSlide:w}):this.setBlankSlideState(a.a.Hidden),p[v.b.RenderTransition]={start:f.a.performanceNowTrimmed()};const r=this.m_container.contains(document.activeElement);let m,y;t&&t.fSkipTransition||!this.m_currentSlideLocation||(w&&this.events.emit("bootStageChanged","RenderingTransition"),m=await this.renderTransition(T,this.m_currentSlideLocation,{correlationId:e}),m&&this.handleErrors(m,{errorAction:U.GotoSlideRenderTransition,navigationType:i?i.navigationType:void 0})),this.m_stateManager.setState(a.g.Normal),p.spinnerDisplayTime=f.a.performanceNowTrimmed()-n,p[v.b.RenderTransition].end=f.a.performanceNowTrimmed(),p[v.b.RenderSlide]={start:f.a.performanceNowTrimmed()};let b=0;b=s.l.performanceNowTrimmed(),this.onBeforeFirstRenderAfterNavigation(C.slideId),l.renderSlide.preRenderEventDuration=s.l.performanceNowTrimmed()-b,d.a.sendTraceTag(506856789,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlideImpl - Rendering SlideId: "+T.slideId.sid);let I=0;if(I=s.l.performanceNowTrimmed(),y=this.m_viewController.renderSlideByIdCollectingPerfData(T.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:w,slideIndex:T.slideIndex,id:o,prefetchWindowRange:this.prefetchWindowRange,navType:i&&i.navigationType,step:this.m_currentSlideLocation?T.slideIndex-this.m_currentSlideLocation.slideIndex:0,navInitTimestamp:t&&t.navInitTimestamp}),y&&y.hasOwnProperty("additionalPerfMeta")&&(y.additionalPerfMeta=void 0),l.renderSlide.renderSlideById=s.l.performanceNowTrimmed()-I,y&&y.hasOwnProperty("errorName")){if("TryPrepareTimeout"===y.errorName){w&&this.events.emit("bootStageChanged","SwitchingToSVG");let e=0;return e=s.l.performanceNowTrimmed(),window.setTimeout(()=>this.changeRenderingModeToSVG({location:T}),0),l.renderSlide.switchSVG=s.l.performanceNowTrimmed()-e,g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")?{fSucceeded:!1,error:a.f.Failed,errorName:y.errorName,metrics:p}:{fSucceeded:!1,error:a.f.Failed}}if("TexturesNotLoaded"===y.errorName){d.a.sendTraceTag(506856788,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::gotoSlideImpl - Before Reloading textures for SlideId: ${T.slideId.sid} RenderResult: ${JSON.stringify(y)}`),p[v.b.ReloadTexture]={start:f.a.performanceNowTrimmed()},w&&this.events.emit("bootStageChanged","ReEnsureTextureLoaded");let e=0;e=s.l.performanceNowTrimmed();const n=await this.m_viewController.ensureTextureLoaded(T.slideId);l.renderSlide.ensureTexture=s.l.performanceNowTrimmed()-e,p[v.b.ReloadTexture].end=f.a.performanceNowTrimmed();let r=0;r=s.l.performanceNowTrimmed(),y=this.m_viewController.renderSlideByIdCollectingPerfData(T.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:w,slideIndex:T.slideIndex,id:o,prefetchWindowRange:this.prefetchWindowRange,navType:i&&i.navigationType,step:this.m_currentSlideLocation?T.slideIndex-this.m_currentSlideLocation.slideIndex:0,navInitTimestamp:t&&t.navInitTimestamp}),l.renderSlide.renderSlideById2=s.l.performanceNowTrimmed()-r,d.a.sendTraceTag(506856787,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::gotoSlideImpl - After Reloading textures for SlideId: ${T.slideId.sid} TextureLoadResult:${JSON.stringify(n)} RenderResult: ${JSON.stringify(y)}`)}}y&&y.hasOwnProperty("errorName")&&this.handleErrors(y,{errorAction:U.GotoSlideRenderSlide,navigationType:i?i.navigationType:void 0}),r&&!_.a.readBooleanOrDefault("disableFocusCallAfterGoToSlide",!1)&&this.m_container.focus(),p[v.b.RenderSlide].end=f.a.performanceNowTrimmed(),p[v.a.Goto].end=f.a.performanceNowTrimmed(),g.ChangeGate.isChangeGateEnabled("SSEUPLBugTelemetry")&&i&&i.bootMetrics&&i.startFromTime&&0!==i.startFromTime&&d.a.sendTraceTag(506856786,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::gotoSlide: New EUPL: "+(p[v.a.Goto].end-i.startFromTime));const P=[];u.hasOwnProperty("errorName")&&P.push(u.errorName),m&&m.hasOwnProperty("errorName")&&P.push(m.errorName),y&&y.hasOwnProperty("errorName")&&P.push(y.errorName);const x=P.length?{errorName:P}:{};m&&m.hasOwnProperty("createTransition")&&m.createTransition.hasOwnProperty("rendererEnvironment")&&(m.createTransition.rendererEnvironment.hasOwnProperty(S.RenderTransitionTextures)&&(l.renderTransition.renderTransitionTextures=m.createTransition.rendererEnvironment[S.RenderTransitionTextures]),m.createTransition.rendererEnvironment.hasOwnProperty(S.GenerateMorphResource)&&(l.renderTransition.generateMorphResource=m.createTransition.rendererEnvironment[S.GenerateMorphResource]),m.createTransition.rendererEnvironment.hasOwnProperty(S.RenderToTexture)&&(l.renderTransition.renderToTexture=m.createTransition.rendererEnvironment[S.RenderToTexture])),u&&u.hasOwnProperty(S.TextureMetadata)&&(l.createTexture=u[S.TextureMetadata]),d.a.sendTraceTag(506856785,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(l)),this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordNavData(this.m_viewController.viewDataManager,v.a.Goto,{sr:_.a.readBooleanOrDefault("EnableSourceAppType",!1)?this.m_appType:this.m_source,id:l.id,...this.m_stateManager.getTelemetry(),...u,...m,...y,...p,...x},i)}!E&&g.ChangeGate.isChangeGateEnabled("PreventNavEventForNoChangeInSlide")||(this.m_currentSlideLocation&&!I&&this.onNavigatedFrom(this.m_currentSlideLocation.slideId),this.onNavigatedTo(T.slideId)),this.m_currentTimelineStates=[],C&&(this.m_currentTimelineStates=C.animTimeline.getTimelineStates(!1)),d.a.sendTraceTag(506856784,c.a.msoulscat_Wac_PptSlideshow,T?h.a.Info:h.a.Error,`SlideShowCore::gotoSlide: reset global animationTimeline targetSlideLocation:${JSON.stringify(T)} currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)}, target SlideViewElement is null:${!C}`),this.m_currentSlideLocation=T,this.events.emit("slideLocationChanged",{actionContext:i})}else d.a.sendTraceTag(506856783,c.a.msoulscat_Wac_PptSlideshow,T?h.a.Info:h.a.Error,`SlideShowCore::gotoSlide: targetSlideLocation:${JSON.stringify(T)} currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)} slideState:${JSON.stringify(e)}`);return t&&t.animationState&&(this.gotoAnimationState(t.animationState,_.a.readBooleanOrDefault("emitActionContextWithAnimationState",!1)?i:void 0),this.setBlankSlideState(a.a.Hidden)),d.a.sendTraceTag(506856782,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::gotoSlide: Sucessfully navigated to targetSlideLocation:${JSON.stringify(T)} currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)} slideState:${JSON.stringify(e)}`),g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")?g.ChangeGate.isChangeGateEnabled("LoggingEnsureSlideResult")?{fSucceeded:!0,metrics:{gotoSlideResult:p,ensureSlideResult:{}}}:{fSucceeded:!0,metrics:p}:{fSucceeded:!0}}gotoSlideQueueHandler(e,t){if(null==e||!e.length)return d.a.sendTraceTag(506504274,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlideQueueHandler: QueueRequest is empty"),{nextArg:[],handledRequests:[],remainingRequests:[]};const i=Z.removeByCondition(e,e=>t&&!(e.args[1]||{}).fForceRetry);for(const e of i)e.resolve({fSucceeded:!1,error:a.f.SkippedBusy});if(0===e.length)return{nextArg:[],handledRequests:[],remainingRequests:[]};const n=e[e.length-1];if(!n)return d.a.sendTraceTag(506795656,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::gotoSlideQueueHandler: lastRequest is undefined. This should not happen."),{nextArg:[],handledRequests:[],remainingRequests:[]};const r={slideLocation:n.args[0],options:n.args[1]},s=!(!n.args[1]||!n.args[1].fClearNavigationState),o=Z.removeByCondition(e,e=>{if(s&&e!==n)return!0;const t={slideLocation:e.args[0],options:e.args[1]};return!this.fAreSlideStatesEqual(t,r)});for(const e of o)e.resolve({fSucceeded:!1,error:a.f.SkippedNewTarget});for(const t of e){const e=t.args[1];e&&e.actionContext&&e.actionContext.navMetrics&&(e.actionContext.navMetrics.isForceRetry=!0)}return{nextArg:n.args,handledRequests:e,remainingRequests:[]}}static removeByCondition(e,t){const i=[];for(let n=e.length-1;n>=0;n--)t(e[n])&&i.push(e.splice(n,1)[0]);return i}async gotoSlideUsingAsyncUtils(e,t){const i=this.m_gotoSlideRequestCount++;d.a.sendTraceTag(506466891,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::gotoSlideUsingAsyncUtils called for slideId: ${e.slideId}, requestId: ${i}`);try{const n=await this.m_gotoSlideThrottlerAsync.callAsync(e,t);return this.m_networkHealthManager&&this.m_networkHealthManager.stopPinging(),d.a.sendTraceTag(506795655,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlide result:"+JSON.stringify({requestId:i,fSucceeded:n.fSucceeded,error:n.error,navigationType:t&&t.actionContext?t.actionContext.navigationType:""})),n}catch(e){return d.a.sendTraceTag(506795654,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::gotoSlide error:"+JSON.stringify({requestId:i,exeception:Object(M.c)(e)})),{fSucceeded:!1,error:a.f.Failed}}}async gotoSlide(e,t){let i;if(d.a.sendTraceTag(506466890,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::gotoSlide called for slideId: "+e.slideId),_.a.readBooleanOrDefault("EnableSourceAppType",!1)&&t&&t.actionContext&&t.actionContext.bootMetrics&&t.actionContext.bootMetrics.sr&&(this.m_appType=t.actionContext.bootMetrics.sr),_.a.readBooleanOrDefault("GotoSlideUseAsyncUtils",!1))return this.gotoSlideUsingAsyncUtils(e,t);const n=t&&t.actionContext&&t.actionContext.navMetrics?t.actionContext.navMetrics:{},r=!!n.isForceRetry;i=r?void 0!==n.requestId?n.requestId:-1:this.m_gotoSlideRequestCount+=1;const s=await this.gotoSlideImpl(e,t),o=t&&t.fClearNavigationState;d.a.sendTraceTag(508078273,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::gotoSlide:result:${s.fSucceeded},Navigation Type:${t&&t.actionContext?t.actionContext.navigationType:""}`);const l={slideLocation:e,options:t};this.m_networkHealthManager&&this.m_networkHealthManager.stopPinging();const u={requestId:i,stateRequested:JSON.stringify(l),isRetryRequest:r,fRetryAttempted:!1,fRetrySet:!1,stateRequestedForRetry:"",stateRetryWasCalledWith:"",fSucceededAndStateMatchesRetry:!1,fSucceededAndRunningRetry:!1};let m;if(s.error&&s.error===a.f.SkippedBusy&&t&&t.fForceRetry)u.fRetryAttempted=!0,this.fAreSlideStatesEqual(l,this.m_lastRequestedSlideState,o)||(u.fRetrySet=!0,this.m_lastRequestedSlideStateResolveFunction&&(this.m_lastRequestedSlideStateResolveFunction({fSucceeded:!1,error:a.f.SkippedNewTarget}),this.m_lastRequestedSlideStateResolveFunction=void 0),_.a.readBooleanOrDefault("updateLastRequestedSlideState",!0)||(this.m_lastRequestedSlideState={slideLocation:e,options:{...t,requestId:i}}),u.stateRequestedForRetry=JSON.stringify(this.m_lastRequestedSlideState),m=await new Promise(async e=>{this.m_lastRequestedSlideStateResolveFunction=e}));else if(s.fSucceeded&&l&&this.m_lastRequestedSlideState&&l.slideLocation&&this.m_lastRequestedSlideState.slideLocation)if(this.fAreSlideStatesEqual(l,this.m_lastRequestedSlideState,o))this.m_lastRequestedSlideState={},this.m_lastRequestedSlideStateResolveFunction&&(this.m_lastRequestedSlideStateResolveFunction({fSucceeded:!0}),this.m_lastRequestedSlideStateResolveFunction=void 0),u.fSucceededAndStateMatchesRetry=!0;else try{d.a.sendTraceTag(506856781,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`goToSlide: Just went to ${l.slideLocation.slideIndex}, `+JSON.stringify(l.options?l.options.animationState:"")+". "+`Try to go to this.m_lastRequestedSlide: ${JSON.stringify(this.m_lastRequestedSlideState.slideLocation)}, `+JSON.stringify(this.m_lastRequestedSlideState.options?this.m_lastRequestedSlideState.options.animationState:"")),this.m_lastRequestedSlideState.options&&this.m_lastRequestedSlideState.options.actionContext&&this.m_lastRequestedSlideState.options.actionContext.navMetrics&&(this.m_lastRequestedSlideState.options.actionContext.navMetrics.isForceRetry=!0,this.m_lastRequestedSlideState.options.actionContext.navMetrics.requestId=this.m_lastRequestedSlideState.options.requestId),u.fSucceededAndRunningRetry=!0,u.stateRetryWasCalledWith=JSON.stringify(this.m_lastRequestedSlideState),this.gotoSlide(this.m_lastRequestedSlideState.slideLocation,this.m_lastRequestedSlideState.options)}catch(e){d.a.sendTraceTag(506856780,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"goToSlide retry caught exception: "+e)}return d.a.sendTraceTag(506856779,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"gotoSlide controlFlowTelemetry: "+JSON.stringify({...u,retryResult:Z.copyWithoutMetrics(m),navigationResult:Z.copyWithoutMetrics(s)})),m||s}static copyWithoutMetrics(e){if(!e)return;const{metrics:t,...i}=e;return i}setSlideIdOrderforCustomSlideShow(e){this.m_isCustomSlideShowActive=!0,this.m_slideIdOrder=[];for(const t of e.sid)this.m_slideIdOrder.push({sid:t,cid:0});this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder)}restoreSlideIdOrder(){this.m_isCustomSlideShowActive=!1,this.m_currentCustomShowIndex=-1,this.m_slideIdOrder=this.m_defaultSlideIdOrder,this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder)}fAreSlideStatesEqual(e,t,i){if(i)return!1;if(!e.slideLocation&&!t.slideLocation)return!0;if(e.slideLocation&&t.slideLocation&&e.slideLocation.slideIndex===t.slideLocation.slideIndex&&e.slideLocation.slideId===t.slideLocation.slideId){if(!e.options&&!t.options)return!0;if(e.options&&t.options&&V(e.options.animationState,t.options.animationState))return!0}return!1}handleErrors(e,t){const i=[],n=t.errorAction,r=t.navigationType;if(this.m_isHandlingResourceInconsistent){const t=e.hasOwnProperty("errorName")?e.errorName:"";d.a.sendTraceTag(506856778,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::handleErrors - not triggering slideshow error due to handling resource inconsistent status. action:${n}, error:${t} `)}else{if(e.hasOwnProperty("errorName")){const s=e.errorName;let o=x.convertToSlideShowError(s);""===s&&(o=n+"EmptyError",e.errorName=o),t.errorCode=o,o!==a.h.SlideVisualizationFailed&&(o===a.h.GetItemsFailedDownloadFile||o===a.h.ServerFailedToDownloadMetadata?(this.events.emit("slideshowError",t),f.a.recordSessionStats({downloadFileFailed:"handleErrors-"+n}),d.a.sendTraceTag(506856777,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::handleErrors - slideshowError emitted for navigationType: ${r}, errorCode: ${o}, errorAction: ${n}`)):(0!==f.a.startFrom&&n!==U.PrefetchEnsureSlide||n===U.InitPresInfo||n===U.CheckHidden)&&(this.events.emit("slideshowError",t),d.a.sendTraceTag(506856776,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::handleErrors - slideshowError emitted for navigationType: ${r}, errorCode: ${o}, errorAction: ${n}`))),i.push({errorName:s,errorInfo:o})}if(e.hasOwnProperty("imgErrorName")){const t=e.imgErrorName;e.hasOwnProperty("errorName")||(e.errorName="IMG"+t),i.push({errorName:t,errorInfo:x.convertToSlideShowError(e.imgErrorName)})}if(e.hasOwnProperty("invalidImageIds")&&(d.a.sendTraceTag(506856775,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::handleErrors. action:${n}, startFrom:${f.a.startFrom}, ${JSON.stringify(e)}`),i.push({errorName:"InvalidImages",errorInfo:e.invalidImageIds}),e.hasOwnProperty("errorName")||(e.errorName="InvalidImage"),e.invalidImageIds=""),e.hasOwnProperty("missingTextureIds")&&(d.a.sendTraceTag(506856774,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::handleErrors. action:${n}, startFrom:${f.a.startFrom}, ${JSON.stringify(e)}`),i.push({errorName:"missingTextureIds",errorInfo:""}),e.hasOwnProperty("errorName")||(e.errorName="MissingTexture"),e.missingTextureIds=""),e.hasOwnProperty("invalidShapeIds")&&(d.a.sendTraceTag(506856773,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::handleErrors. action:${n}, startFrom:${f.a.startFrom}, ${JSON.stringify(e)}`),i.push({errorName:"invalidShapeIds",errorInfo:""}),e.hasOwnProperty("errorName")||(e.errorName="InvalidShape"),e.invalidShapeIds=""),e.hasOwnProperty("axError")){const t=e.axError;i.push({errorName:"missingAccessabilityModel",errorInfo:t}),e.hasOwnProperty("errorName")||(e.errorName="AX"+t)}if(e.hasOwnProperty("imagesMissingFromServer")){const t=e.imagesMissingFromServer;i.push({errorName:"imagesMissingFromServer",errorInfo:t}),e.hasOwnProperty("errorName")||(e.errorName="ImagesMissingFromServer")}0!==f.a.startFrom&&i.length>0&&n!==U.PrefetchEnsureSlide&&(i.find(e=>e.errorInfo===a.h.GetItemsFailedDownloadFile)?m.e.recordVeto("NavigationInterruption",{...e,qosVeto:"ContentRenderFailed"}):(e.hasOwnProperty("errorName")||(e.errorName=n+"EmptyError"),m.e.recordVeto("ACE",{...e,action:n,qosVeto:"ContentRenderFailed"}))),i.length>0&&d.a.sendTraceTag(593757456,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::handleErrors. action:${n}, startFrom:${f.a.startFrom}, ${JSON.stringify(i)}`),i.length>0&&i.find(e=>e.errorInfo===a.h.GetItemsFailedDownloadFile)||!f.a.getSessionStats("downloadFileFailed")||f.a.recordSessionStats({downloadFileFailed:"EnsureSlideViewElementSucceeded"})}}static filterToResourceEntriesWithMissingImages(e){return e.filter(e=>""===e.url&&!e.name.startsWith("./getmedia.ashx")&&!e.name.endsWith(".gif"))}async updateSlideResources(e,t,i){const n={loadImagesGetSlideViewData:{start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()}},r=await this.m_viewDataManager.getSlideViewData(e.id);if(n.loadImagesGetSlideViewData.end=f.a.performanceNowTrimmed(),!r.resource||!this.m_viewController)return d.a.sendTraceTag(506856772,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::updateSlideResources. missing slideViewData. slideViewData:${!!r.resource}, viewController:${!!this.m_viewController}, currentSlideLocation:${this.m_currentSlideLocation?this.m_currentSlideLocation.slideId.sid:""}`),r.metadata.hasOwnProperty("errorName")&&(n.errorName=r.metadata.errorName),n;const s=r.resource,o=Z.filterToResourceEntriesWithMissingImages(s.resCat);if(!o||0===o.length)return n;const l=[],u={meta_slideId:e.id,meta_resourceEntries:o,meta_correlationId:t,meta_isInit:i};this.addCommonResourceMetadata(u);for(const e of o)l.push(this.m_providers.imageData.load(e.id,u));n.loadImages={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()};const m=await Promise.all(l);n.loadImages.end=f.a.performanceNowTrimmed();const p=s.resCat.find(e=>""===e.url);if(p){n.missingResourceId=p.id;const e=new Set;m.forEach(t=>{t.metadata&&t.metadata.hasOwnProperty("errorName")&&e.add(t.metadata.errorName)}),0===e.size&&e.add(a.h.LoadFailed),n.imgErrorName=Array.from(e),d.a.sendTraceTag(506856771,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(n))}return n}async renderTransition(e,t,i){if(e.slideId.cid===t.slideId.cid&&e.slideId.sid===t.slideId.sid)return;const n=this.m_viewController;if(!n)return;const r=e.slideIndex>=t.slideIndex,s={createTransition:{start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()}},o=await n.createTransition(e.slideId,t.slideId,r,i);return this.m_stateManager.setState(a.g.Normal),s.createTransition.end=f.a.performanceNowTrimmed(),g.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&o.metadata&&(o.metadata.getSlideViewPerfInTransitionMS&&(s.createTransition.slideVInT=o.metadata.getSlideViewPerfInTransitionMS),o.metadata.rendererEnvironment&&(s.createTransition.rendererEnvironment=o.metadata.rendererEnvironment)),o.fSuccess?(o.effectId&&void 0!==o.isSupported&&f.a.recordSessionTransitionStats(o),s.metadata=["transition-"+o.effectId],s[v.c.PlayTransitionMs]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},this.setTransitionState(!0,o),new Promise(e=>{const t=n.getTransitionController();if(!t)return this.setTransitionState(!1,o),void e(s);let i=-1;const r=()=>{"hidden"===document.visibilityState&&this.isTransitioning?i=window.setTimeout(()=>{n.finishTransition(),i=-1},t.duration-t.clock.currentTimeMs):window.clearTimeout(i)};t.clock.events.on("tick",async i=>(document.addEventListener("visibilitychange",r),this.setTransitionState(t.render(i),o),this.isTransitioning||(n.finishTransition(),e(s)),s)),t.clock.events.on("notRunning",async()=>{document.removeEventListener("visibilitychange",r),this.setTransitionState(!1,o),s[v.c.PlayTransitionMs].end=f.a.performanceNowTrimmed(),e(s)})})):(o.metadata&&o.metadata.hasOwnProperty("errorName")&&d.a.sendTraceTag(506856770,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::renderTransition: create transition failed. from:${t.slideId.sid}, to:${e.slideId.sid}, effectId:${o.effectId}, isSupported:${o.isSupported}, errorName:${o.metadata?o.metadata.errorName:""}`),s)}isHiddenFromHiddenList(e){return this.m_hiddenSlideIdOrder.some(t=>t.sid===this.m_slideIdOrder[e].sid&&t.cid===this.m_slideIdOrder[e].cid)}async isHidden(e){let t=!1;const i={};if(_.a.readBooleanOrDefault("fixForSSLaunchAfterRehydrate",!1)&&this.m_presInfoPromise){d.a.sendTraceTag(506856769,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::isHidden: : m_presInfoPromise is not resolved yet.");const e=await this.m_presInfoPromise;g.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&(t=!e||!e.resource)}if(_.a.readBooleanOrDefault("useHiddenListFromPresInfo",!1)){const t=this.m_providers.presInfo.getLoadResultInCache("");if(t&&t.resource&&t.resource.HiddenSlideOrder){const n=t.resource.HiddenSlideOrder.some(t=>t.sid===this.m_slideIdOrder[e].sid&&t.cid===this.m_slideIdOrder[e].cid);return i.isHidden=n,i.isHiddenFromPresInfo=!0,i}}const n=this.m_slideIdOrder[e];let r=this.m_viewDataManager.slideMetadataMap.get(n.sid);if(!r||void 0===r.isHidden){this.logSlideMetadataMapContentWithMessage("Slide Data not found in slideMetadataMap. Trying to Ensure SlideViewElement."),i.ensureSlideStart=f.a.performanceNowTrimmed();const e=await this.ensureSlideViewElementAsync(n,!1,Object(y.v4)(),v.a.CheckHidden,!1);i.ensureSlideEnd=f.a.performanceNowTrimmed(),i.ensureSlideResult=e,r=this.m_viewDataManager.slideMetadataMap.get(n.sid),r&&void 0!==r.isHidden||(this.logSlideMetadataMapContentWithMessage("Slide Data not found in slideMetadataMap after ensure SlideViewElement."),g.ChangeGate.isChangeGateEnabled("SlideShowErrorLoggingFix")?e.hasOwnProperty("errorName")||(r?void 0===r.isHidden&&(e.errorName="InvalidHiddenSlideInfo"):e.errorName="SlideMetadataNotFound",i.errorName=e.errorName):e.hasOwnProperty("errorName")||(e.errorName="InvalidHiddenSlideInfo",i.errorName=e.errorName),d.a.sendTraceTag(506856768,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::isHidden: invalid slideMetadata or undefined isHidden property after ensure SlideViewElement. slideMetadata:${!!r}, Sid:${n.sid}, presInfoFailed:${t}`)),this.handleErrors(e,{errorAction:U.CheckHidden})}return i.isHidden=r?r.isHidden:void 0,i}logSlideMetadataMapContentWithMessage(e){g.ChangeGate.isChangeGateEnabled("SlideShowSlideMetadataLogging")&&d.a.sendTraceTag(506856739,c.a.msoulscat_Wac_PptSession,h.a.Info,`SlideShowCore::isHidden: ${e}:${JSON.stringify(Array.from(this.m_viewDataManager.slideMetadataMap))}`)}getSlideLocation(){return this.m_currentSlideLocation||d.a.sendTraceTag(506856738,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::getSlideLocation: Undefined m_currentSlideLocation"),this.m_currentSlideLocation}async nextSlide(e){const t={fSucceeded:!1,metrics:{}};if(!this.m_viewController||!this.m_currentSlideLocation||this.handleBlankSlideNavigation(!0)||this.m_stateManager.state===a.g.Loading||this.isTransitioning&&this.cancelTransition())return g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.SlideShowCoreState=this.m_stateManager.state,t.metrics.isTransitioning=this.isTransitioning,t.metrics.returnEarly=!0),t;let i;i=Date.now();const n=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e||n&&n.animTimeline.hasTimelineFinished(u.e.MainTimelineId)){const e={};if(e[v.a.CheckHidden]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},_.a.readBooleanOrDefault("enableSummaryZoom",!1))if(this.m_zoomManager&&this.m_zoomManager.needsToReturnOnNext(this.m_currentSlideLocation.slideId)){d.a.sendTraceTag(506856737,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::nextSlide - Zoom returning to parent");const e=this.m_zoomManager.nextReturnToParentId(this.m_currentSlideLocation.slideId);if(e){const n=await this.gotoSlide({slideId:e},{actionContext:{navigationType:a.c.Next},navInitTimestamp:i});g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.gotoSlideResult=n,t.fSucceeded=n.fSucceeded,t.errorName=n.errorName?n.errorName:n.error)}}else{let r=this.m_currentSlideLocation,s=!1;if(this.m_zoomManager){let e;if(s=this.m_zoomManager.needsToJumpOnNext(this.m_currentSlideLocation.slideId),s){d.a.sendTraceTag(506856736,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::nextSlide - Zoom Jumping Slides");const t=this.m_zoomManager.slideWhereZoomLeftOff(this.m_currentSlideLocation.slideId);e=this.resolvePartialSlideLocation({slideId:t})}r=e||r}try{this.setSlideShowStateOnNextOrPrev(a.g.Loading);for(let o=r.slideIndex+1;o<this.m_slideIdOrder.length;o+=1){const r=await this.isHidden(o),l=r.isHidden;if(g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.isHiddenResult=r),void 0===l)return t.errorName=r.hasOwnProperty("errorName")?r.errorName:a.h.IsHiddenFailed,t;if(this.m_shouldNavigateToHiddenSlides||!l){e[v.a.CheckHidden].end=f.a.performanceNowTrimmed();const r=this.resolvePartialSlideLocation({slideIndex:o});if(n&&this.m_zoomManager&&r){const e=n.getAllZoomsOnSlide();!this.m_zoomManager.zoomOnCurrentSlide(r.slideId,e,this.m_currentSlideLocation.slideId)&&s&&(d.a.sendTraceTag(506856735,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::nextSlide - matching zoom not detected on slide"),this.m_zoomManager.addSlide(r.slideId,this.m_currentSlideLocation.slideId,!1))}const l=await this.gotoSlide({slideIndex:o},{actionContext:{navigationType:a.c.Next,navMetrics:e},navInitTimestamp:i});return g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.gotoSlideResult=l,t.fSucceeded=l.fSucceeded,t.errorName=l.errorName?l.errorName:l.error),t}}}catch(e){d.a.sendTraceTag(506557959,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::nextSlide - exception: "+e)}finally{this.setSlideShowStateOnNextOrPrev(a.g.Normal)}this.m_sessionSettings.slideShowCoreSettings.shouldDisableEndOfShow||(this.setBlankSlideState(a.a.EndOfShow),t.metrics.endOfShow=!0,t.fSucceeded=!0)}else{try{this.setSlideShowStateOnNextOrPrev(a.g.Loading);for(let n=this.m_currentSlideLocation.slideIndex+1;n<this.m_slideIdOrder.length;n+=1){const r=await this.isHidden(n),s=r.isHidden;if(g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.isHiddenResult=r),void 0===s)return t.errorName=r.hasOwnProperty("errorName")?r.errorName:a.h.IsHiddenFailed,t;if(this.m_shouldNavigateToHiddenSlides||!s){e[v.a.CheckHidden].end=f.a.performanceNowTrimmed();const r=await this.gotoSlide({slideIndex:n},{actionContext:{navigationType:a.c.Next,navMetrics:e},navInitTimestamp:i});return g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.gotoSlideResult=r,t.fSucceeded=r.fSucceeded,t.errorName=r.errorName?r.errorName:r.error),t}}}catch(e){d.a.sendTraceTag(506574081,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::nextSlide - exception: "+e)}finally{this.setSlideShowStateOnNextOrPrev(a.g.Normal)}this.m_sessionSettings.slideShowCoreSettings.shouldDisableEndOfShow||(this.setBlankSlideState(a.a.EndOfShow),t.metrics.endOfShow=!0,t.fSucceeded=!0)}}else if(n){const e=n.animTimeline.getTimelineStates(!1);if(!e)return t;const i=e.filter(e=>e.timelineId===u.e.MainTimelineId)[0],r=n.animTimeline.getEndTime(u.e.MainTimelineId);if(!r)return t;i.step=r.ClickNum+1,this.gotoAnimationState({timelineStates:[i]}),g.ChangeGate.isChangeGateEnabled("LogAnimationNavs")&&(t.metrics.AnimationStateChange=!0,t.fSucceeded=!0)}return t}async prevSlide(e){const t={fSucceeded:!1,metrics:{}};if(!this.m_currentSlideLocation||this.handleBlankSlideNavigation(!1)||this.m_stateManager.state===a.g.Loading||this.isTransitioning&&this.cancelTransition()||!this.m_viewController)return g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.SlideShowCoreState=this.m_stateManager.state,t.metrics.isTransitioning=this.isTransitioning,t.metrics.returnEarly=!0),t;let i;if(i=Date.now(),_.a.readBooleanOrDefault("enableSummaryZoom",!1)&&this.m_zoomManager&&this.m_zoomManager.checkZoomGoBack(this.m_currentSlideLocation.slideId)){d.a.sendTraceTag(506856734,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::prevSlide - Zoom: different previous slide");const e=this.m_zoomManager.zoomGoBack(this.m_currentSlideLocation.slideId);if(e){const n=await this.gotoSlide({slideId:e},{actionContext:{navigationType:a.c.Prev},navInitTimestamp:i});g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.gotoSlideResult=n,t.fSucceeded=n.fSucceeded,t.errorName=n.errorName?n.errorName:n.error)}return t}const n=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e||n&&0===n.animTimeline.getNumTimelineClicks(u.e.MainTimelineId)){this.setSlideShowStateOnNextOrPrev(a.g.Loading);try{const e={};e[v.a.CheckHidden]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()};for(let n=this.m_currentSlideLocation.slideIndex-1;n>=0;n-=1){const r=await this.isHidden(n),s=r.isHidden;if(g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.isHiddenResult=r),void 0===s)return t.errorName=r.hasOwnProperty("errorName")?r.errorName:a.h.IsHiddenFailed,t;if(this.m_shouldNavigateToHiddenSlides||!s){const r=await this.gotoSlide({slideIndex:n},{actionContext:{navigationType:a.c.Prev,navMetrics:e},navInitTimestamp:i});return g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(t.metrics.gotoSlideResult=r,t.fSucceeded=r.fSucceeded,t.errorName=r.errorName?r.errorName:r.error),t}}}catch(e){d.a.sendTraceTag(506574080,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::prevSlide - exception: "+e)}finally{this.setSlideShowStateOnNextOrPrev(a.g.Normal)}if(g.ChangeGate.isChangeGateEnabled("FixForPreviousNavigationOnFirstSlide"))return t.fSucceeded=!0,t}else n&&(n.animTimeline.resetTimeline(u.e.MainTimelineId),this.checkForAnimationStateChanges(),g.ChangeGate.isChangeGateEnabled("LogAnimationNavs")&&(t.metrics.AnimationStateChange=!0,t.fSucceeded=!0));return t}async getFirstVisibleSlideIndex(){d.a.sendTraceTag(506856733,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore - call getFirstVisibleSlideIndex");const e={};e[v.a.CheckHidden]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},e.slideId=this.m_slideIdOrder[0],e.isHiddenResult={};for(let t=0;t<this.m_slideIdOrder.length;t+=1){const i=await this.isHidden(t),n=i.isHidden;if(g.ChangeGate.isChangeGateEnabled("LoggingIsHiddenResult")&&(e.isHiddenResult[t]=i),void 0===n)return e.errorName="invalidHiddenSlideInfo",e;if(!n){e.slideId=this.m_slideIdOrder[t];break}}return e[v.a.CheckHidden].end=f.a.performanceNowTrimmed(),e}async getLastVisibleSlideIndex(){const e={};e[v.a.CheckHidden]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},e.slideId=this.m_slideIdOrder[this.m_slideIdOrder.length-1];for(let t=this.m_slideIdOrder.length-1;t>=0;t-=1){const i=(await this.isHidden(t)).isHidden;if(void 0===i)return e.errorName="invalidHiddenSlideInfo",e;if(!i){e.slideId=this.m_slideIdOrder[t];break}}return e[v.a.CheckHidden].end=f.a.performanceNowTrimmed(),e}async gotoFirstSlideOptions(e,t){return await this.gotoFirstSlide(e,void 0,t)}async gotoFirstSlide(e,t,i){const n=i&&i.actionContext||t||{};n.navigationType||(n.navigationType=a.c.GoToFirst),g.ChangeGate.isChangeGateEnabled("RemoveRestoreSlideIdOrderAtEndSession")&&this.m_isCustomSlideShowActive&&this.restoreSlideIdOrder();let r={slideIndex:0};const s={};if(e){Z.addStartEndToDict(s,"getFirstVisibleSlideResult",!0);const e=await this.getFirstVisibleSlideIndex();if(Z.addStartEndToDict(s,"getFirstVisibleSlideResult",!1),s.getFirstVisibleSlideResult=e,e.hasOwnProperty("errorName")){g.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&d.a.sendTraceTag(507909343,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::gotoFirstSlide - getFirstVisibleSlideResult return with error: ${e.errorName}.`);const t={fSucceeded:!1,error:e.errorName};return g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(s.getFirstVisibleSlideError=e.errorName,t.metrics={getFirstVisibleSlideResult:s}),t}n.navMetrics=e[v.a.CheckHidden],r={slideId:e.slideId}}let o;g.ChangeGate.isChangeGateEnabled("AddCustomShowIndexRegularSlideshow")&&(r.customShowIndex=-1);const l=i&&i.fClearNavigationState;return o=await this.gotoSlide(r,{actionContext:n,fSkipTransition:!0,fClearNavigationState:l}),g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(o.metrics?o.metrics.getFirstVisibleSlideResult=s:o.metrics={getFirstVisibleSlideResult:s}),o}async gotoLastSlide(e){let t={slideIndex:this.m_slideIdOrder.length-1};if(e){const e=await this.getLastVisibleSlideIndex();if(e.hasOwnProperty("errorName"))return;t={slideId:e.slideId}}await this.gotoSlide(t,{actionContext:{navigationType:a.c.GoToLast},fSkipTransition:!0})}getSlideCount(){return this.m_slideIdOrder.length}async refreshViewControllerSSC(){this.m_viewController&&this.setTransitionState(!1)}clearNavigationState(){this.m_viewController&&this.m_viewController.clearNavigationState(),this.setBlankSlideState(a.a.Black);const e=_.a.readBooleanOrDefault("preventRenderingOldSlide",!1);this.m_viewController&&this.m_currentSlideLocation&&!e&&this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.m_zoomManager&&g.ChangeGate.isChangeGateEnabled("FixSummaryZoomNavigation")&&this.m_zoomManager.clear()}async invalidateProviderCacheBySlideID(e,t){if(t){const i={},n=this.addCommonResourceMetadata(i),r=JSON.parse(t),a={sid:r.Sid,cid:r.Cid};return await e.invalidateSlideAsync(a,n)}}async updateResourceProviders(e,t){return await this.m_updateResourceProvidersThrottler.callAsync(e,t)}static updateResourceProvidersQueueHandler(e){return{nextArg:e.map(e=>e.args).reduce((e,t)=>{const i=[];i[0]=t[0];const n=e[1],r=t[1];return i[1]={shouldResetProviders:r&&r.shouldResetProviders,shouldRerenderSlide:n&&n.shouldRerenderSlide||r&&r.shouldRerenderSlide,switchToSvg:n&&n.switchToSvg||r&&r.switchToSvg},i}),handledRequests:e,remainingRequests:[]}}async updateResourceProvidersAsyncImplAsync(e,t){const i={};Z.addStartEndToDict(i,"updateResourceProviders",!0);const n=t&&t.switchToSvg;t&&t.shouldResetProviders&&e.resetProviders(),t&&t.isCacheRetentionEnabled&&t.updateSlideShowCoreAfterLaunch||this.m_stateManager.setState(a.g.Loading),this.m_providers=e,this.m_viewDataManager=new s.m(this.addClientSizeToLoader(e.slideViewData),this.addClientSizeToLoader(e.shapeViewData),e.localizedString),g.ChangeGate.isChangeGateEnabled("FixAllSlidesHiddenSlideshowSSCore")&&(this.m_shouldNavigateToHiddenSlides=!(null==t||!t.fShouldNavigateToHiddenSlides)),_.a.readBooleanOrDefault("enableSummaryZoom",!1)&&(this.m_zoomManager=new E(this.m_viewDataManager)),Z.addStartEndToDict(i,"getPresInfo",!0);const r=Object(y.v4)(),o={slideLocation:_.a.readBooleanOrDefault("enableFetchSlideInfoForCurrentSlide",!1)&&t&&t.startSlideIndex?{slideIndex:t.startSlideIndex}:this.m_currentSlideLocation?this.m_currentSlideLocation:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation,isBootRequest:!1,isPresInfoFromClient:t&&t.isPresInfoFromClient},l=n?v.a.ChangeRenderingModeToSVG:v.a.UpdateResourceProviders;let u;if(_.a.readBooleanOrDefault("fixForSSLaunchAfterRehydrate",!1)?(this.m_presInfoPromise=this.getPresInfoItem(r,l,o),u=await this.m_presInfoPromise,this.m_presInfoPromise=void 0):u=await this.getPresInfoItem(r,l,o),Z.addStartEndToDict(i,"getPresInfo",!1),_.a.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)&&this.m_stateManager.setState(a.g.Normal),!u||!u.resource)return d.a.sendTraceTag(506856732,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::updateResourceProviders - getPresInfo. correlation:${r}, errorName:${u.metadata.errorName}, actionType:${l}`),this.handleErrors(u.metadata,{errorAction:n?U.InitPresInfo:U.UpdateResourceProvidersPresInfo}),g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(i.getPresInfoError=u.metadata.errorName),{fSucceeded:!1,metrics:i};if(n&&(Z.addStartEndToDict(i,"switchToSvg",!0),this.m_viewController&&this.m_viewController.dispose(),this.m_viewController=new s.l(this.m_container,new s.k(u.resource.SlideEmuWidth,u.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid),await this.m_viewController.init(),Z.addStartEndToDict(i,"switchToSvg",!1)),this.m_viewController){const e=this.m_sessionSettings.slideShowCoreSettings.translateLanguage;if(void 0!==e&&this.m_viewController.updateAccessibilityLanguage(e),t&&t.shouldRerenderSlide&&!t.fSetBlankSlideToBlack&&this.m_currentSlideLocation){Z.addStartEndToDict(i,"ensureSlideView",!0);const e=Object(y.v4)(),t=await this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,e,v.a.UpdateResourceProviders,!1);Z.addStartEndToDict(i,"ensureSlideView",!1),d.a.sendTraceTag(506856731,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::updateResourceProviders - ensureSlideViewElement. Correlation:${e}, ErrorName:${t&&t.hasOwnProperty("errorName")?t.errorName:""}`),Z.addStartEndToDict(i,"renderSlide",!0);const n=this.m_viewController.renderSlideByIdCollectingPerfData(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState);Z.addStartEndToDict(i,"renderSlide",!1),n&&n.hasOwnProperty("errorName")&&d.a.sendTraceTag(506856730,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::updateResourceProviders - renderSlide return with error:${n.errorName}, sid:${n.hasOwnProperty("sid")?n.sid:""}`)}t&&t.fSetBlankSlideToBlack&&this.setBlankSlideState(a.a.Black),Z.addStartEndToDict(i,"updateViewDataManager",!0);const n=Object(y.v4)(),r=this.addCommonResourceMetadata({meta_correlationId:n,fSkipRendering:t&&t.fSetBlankSlideToBlack}),s=await this.m_viewController.updateViewDataManager(this.m_viewDataManager,this.m_opticalZoomStateInfo.currentState,r);Z.addStartEndToDict(i,"updateViewDataManager",!1),d.a.sendTraceTag(506856729,c.a.msoulscat_Wac_PptSlideshow,s.hasOwnProperty("errorName")?h.a.Error:h.a.Info,`SlideShowCore::updateResourceProviders - updateViewDataManager. Correlation:${n}, errorName:${s.errorName}, sid:${s.hasOwnProperty("sid")?s.sid:""}`),this.handleErrors(s,{errorAction:U.UpdateViewDataManager}),s.hasOwnProperty("errorName")||(f.a.getSessionStats("downloadFileFailed")?f.a.recordSessionStats({downloadFileFailed:"UpdateResourceProvidersSucceeded"}):f.a.recordSessionStats({resourceProvidersUpdated:!0}))}if(_.a.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)||this.m_stateManager.setState(a.g.Normal),Z.addStartEndToDict(i,"triggerPrefetch",!0),!this.m_currentSlideLocation||t&&t.skipPrefetchSlides||(this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex+1},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex+2},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex-1},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex-2},!0)),Z.addStartEndToDict(i,"triggerPrefetch",!1),Z.addStartEndToDict(i,"initMedia",!0),this.m_viewController&&this.m_currentSlideLocation){const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);e&&e.initMediaAfterSlideContentChanged()}return Z.addStartEndToDict(i,"initMedia",!1),Z.addStartEndToDict(i,"updateResourceProviders",!1),{fSucceeded:!0,metrics:i}}setBlankSlideState(e){this.setBlankSlideStateInternal(e)}setBlankSlideStateInternal(e,t){if(this.m_blankSlideState===e||!this.m_viewController||!this.m_currentSlideLocation)return;switch(this.cancelTransition(),e){case a.a.Black:if(this.m_blankSlideState===a.a.EndOfShow)return;this.m_viewController.renderBlankSlide("black");break;case a.a.White:if(this.m_blankSlideState===a.a.EndOfShow)return;this.m_viewController.renderBlankSlide("white");break;case a.a.EndOfShow:if(!this.m_sessionSettings.slideShowCoreSettings.endOfShowText)return;this.setOpticalZoomState({currentState:Z.s_defaultOpticalZoomState,metadata:{source:a.d.EndOfShow}}),this.m_viewController.renderBlankSlide("black",this.m_sessionSettings.slideShowCoreSettings.endOfShowText,"white"),this.m_viewController.stopCrossSlideAudio(),this.m_viewController.cleanUpAccessibilityContainer();break;default:d.a.sendTraceTag(506856728,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::setBlankSlideState - Rendering SlideId: "+this.m_currentSlideLocation.slideId),t&&t.fSkipRenderSlide&&e===a.a.Hidden&&_.a.readBooleanOrDefault("allowSkipRenderInSetBlankSlideState",!1)||this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState)}const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);i&&(e===a.a.Hidden?i.animClock.resume():i.animClock.pause()),this.m_blankSlideState=e,this.events.emit("blankSlideStateChanged",e)}showLoadingSpinner(){this.m_viewController&&this.m_stateManager&&(d.a.sendTraceTag(506856727,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::showLoadingSpinner"),this.m_stateManager.setState(a.g.Loading))}hideLoadingSpinner(){this.m_viewController&&this.m_stateManager&&this.m_stateManager.setState(a.g.Normal)}static addStartEndToDict(e,t,i){g.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(i?e[t]={start:f.a.performanceNowTrimmed()}:e[t].end=f.a.performanceNowTrimmed())}async prefetchOnPodSessionRefresh(){if(_.a.readBooleanOrDefault("enablePrefetchOnRefreshPodSession",!1)){const e=await this.getFirstVisibleSlideIndex();if(e.hasOwnProperty("errorName"))return void(g.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&d.a.sendTraceTag(507909342,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::prefetchOnPodSessionRefresh - getFirstVisibleSlideResult return with error: ${e.errorName}.`));const t=this.resolvePartialSlideLocation({slideId:e.slideId})||{slideIndex:0};this.events.emit("prefetchOnRefreshPodSession",t)}}handleBlankSlideNavigation(e){return this.m_blankSlideState===a.a.EndOfShow&&(e?this.events.emit("exitFromEndOfShow"):this.setBlankSlideState(a.a.Hidden),!0)}gotoAnimationState(e,t){if(!this.m_currentSlideLocation||!this.m_viewController||this.m_stateManager.state===a.g.Loading)return!1;this.setBlankSlideState(a.a.Hidden);const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return!!i&&(i.animTimeline.setTimelineStates(e.timelineStates),null!=e.startTimeOffset&&i.animClock.start(e.startTimeOffset),this.checkForAnimationStateChanges(t),!0)}getAnimationState(e){if(!this.m_currentSlideLocation||!this.m_viewController)return{timelineStates:[]};const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!t)return{timelineStates:[]};const i=t.animTimeline.getTimelineStates(e)||[];return e?{timelineStates:i,startTimeOffset:t.animClock.currentTimeMs}:{timelineStates:i}}async nextStep(e,t){const i=f.a.performanceNowTrimmed(),n=Object(y.v4)();d.a.sendTraceTag(576979915,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::nextStep: CurrentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)},\n       timelineId:${e}; source: ${t}, correlationId: ${n}`);const r=this.handleBlankSlideNavigation(!0);if(!this.m_currentSlideLocation||!this.m_viewController||r||this.isTransitioning&&this.cancelTransition()||this.m_stateManager.state===a.g.Loading)return d.a.sendTraceTag(576979916,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::nextStep returns early. m_viewController:${!!this.m_viewController},\n          this.m_currentSlideLocation:${!!this.m_currentSlideLocation},\n          this.handleBlankSlideNavigation:${r},\n          this.m_stateManager.state:${this.m_stateManager.state},\n          this.isTransitioning:${this.isTransitioning},\n          correlationId: ${n}`),void(this.m_currentSlideLocation&&this.m_viewController||this.raiseSlideShowNavErrorEvent(this.m_currentSlideLocation?a.h.ViewControllerUndefined:a.h.CurrentSlideLocationUndefined,a.c.Next));let s=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!s){let e={};if(_.a.readBooleanOrDefault("ensureSlideOnSVEUndefined",!1)&&(e=await this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,n,v.a.Goto,!1),s=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId)),!s)return d.a.sendTraceTag(507127107,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::nextStep returns as slideViewElement is undefined with correlationId: ${n}, ensureSlideResult: ${JSON.stringify(e)}`),void this.raiseSlideShowNavErrorEvent(a.h.SlideViewElementUndefined,a.c.Next)}if(e===u.e.MainTimelineId&&s.animTimeline.hasTimelineFinished(e)&&(t!==a.j.Mouse||s.fOnMouseClickAdvance)){const e=await this.nextSlide(Z.c_preferFullyBuilt);e.metrics&&(e.metrics.startTime=i,e.metrics.endTime=f.a.performanceNowTrimmed(),e.metrics.correlationId=n,e.metrics.fromIndex=this.m_currentSlideLocation.slideIndex),g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&!e.fSucceeded?(d.a.sendTraceTag(507127106,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,JSON.stringify(e.metrics?e.metrics:{})),this.raiseSlideShowNavErrorEvent(e.errorName?e.errorName:a.h.Unknown,a.c.Next)):this.logNavigationSuccess(e)}else e!==u.e.MainTimelineId&&s.animTimeline.hasTimelineFinished(e)?(s.animTimeline.resetTimeline(e),s.animTimeline.addTimelineClick(e),this.checkForAnimationStateChanges(),t!==a.j.AutoAdvance&&this.events.emit("stopAutoAdvance"),this.logAnimationNavClicks(i,a.c.Next,n)):(s.animTimeline.addTimelineClick(e),this.checkForAnimationStateChanges(),t!==a.j.AutoAdvance&&this.events.emit("stopAutoAdvance"),this.logAnimationNavClicks(i,a.c.Next,n))}async prevStep(e,t){const i=f.a.performanceNowTrimmed(),n=Object(y.v4)();d.a.sendTraceTag(576979917,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::prevStep: CurrentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)},\n       timelineId:${e}; source: ${void 0!==t?t:"None"}, correlationId: ${n}`);const r=this.handleBlankSlideNavigation(!1);if(!this.m_currentSlideLocation||!this.m_viewController||r||this.isTransitioning&&this.cancelTransition()||this.m_stateManager.state===a.g.Loading)return d.a.sendTraceTag(576979918,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::prevStep returns early. m_viewController:${!!this.m_viewController},\n          this.m_currentSlideLocation:${!!this.m_currentSlideLocation},\n          this.handleBlankSlideNavigation:${r},\n          this.m_stateManager.state:${this.m_stateManager.state},\n          this.isTransitioning:${this.isTransitioning},\n          correlationId: ${n}`),void(this.m_currentSlideLocation&&this.m_viewController||this.raiseSlideShowNavErrorEvent(this.m_currentSlideLocation?a.h.ViewControllerUndefined:a.h.CurrentSlideLocationUndefined,a.c.Prev));let s=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!s){let e={};if(_.a.readBooleanOrDefault("ensureSlideOnSVEUndefined",!1)&&(e=await this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,n,v.a.Goto,!1),s=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId)),!s)return d.a.sendTraceTag(507127075,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,`SlideShowCore::prevStep returns as slideViewElement is undefined with correlationId: ${n}, ensureSlideResult: ${JSON.stringify(e)}`),void this.raiseSlideShowNavErrorEvent(a.h.SlideViewElementUndefined,a.c.Prev)}if(e===u.e.MainTimelineId&&0===s.animTimeline.getNumTimelineClicks(e)){const e=await this.prevSlide(Z.c_preferFullyBuilt);e.metrics&&(e.metrics.startTime=i,e.metrics.endTime=f.a.performanceNowTrimmed(),e.metrics.correlationId=n,e.metrics.fromIndex=this.m_currentSlideLocation.slideIndex),g.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&!e.fSucceeded?(d.a.sendTraceTag(507127074,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,JSON.stringify(e.metrics?e.metrics:{})),this.raiseSlideShowNavErrorEvent(e.errorName?e.errorName:a.h.Unknown,a.c.Prev)):this.logNavigationSuccess(e)}else s.animTimeline.removeTimelineClick(e),this.checkForAnimationStateChanges(),this.logAnimationNavClicks(i,a.c.Prev,n)}raiseSlideShowNavErrorEvent(e,t){if(g.ChangeGate.isChangeGateEnabled("RaiseSSNavErrorEvent")){const i={errorCode:e,navigationType:t};this.events.emit("slideshowNavigationError",i)}}logAnimationNavClicks(e,t,i){g.ChangeGate.isChangeGateEnabled("LogSSAnimationNavClicks")&&d.a.sendTraceTag(506994954,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::logAnimationNavClicks startTime: ${e}, endTime: ${f.a.performanceNowTrimmed()}, navType: ${t}, correlationId: ${i}`)}logNavigationSuccess(e){g.ChangeGate.isChangeGateEnabled("LogNavigationSuccess")&&d.a.sendTraceTag(506795653,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,JSON.stringify(e.metrics?e.metrics:{}))}setSlideShowStateOnNextOrPrev(e){_.a.readBooleanOrDefault("fixLoaderOnSlideNavigation",!1)&&(e===a.g.Loading?this.showLoadingSpinner():this.hideLoadingSpinner())}playMedia(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateMediaViewElement(e,s.d.MediaPlayed)}pauseMedia(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateMediaViewElement(e,s.d.MediaPaused)}seekMedia(e,t){if(!this.m_viewController||!this.m_currentSlideLocation)return;const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);i&&i.updateMediaViewElement(e,s.d.MediaSeeked,t)}getMediaNamesBySlideIndex(e){if(!this.m_viewController||this.m_slideIdOrder.length<=e)return;const t=this.m_viewController.getSlideViewElement(this.m_slideIdOrder[e]);return t?t.getMediaNamesOnSlide():void 0}async isMediaPresentInSlide(e){if(!this.m_viewController||this.m_slideIdOrder.length<=e)return;const t=this.m_viewController.getSlideViewElement(this.m_slideIdOrder[e]);return t?await t.isMediaPresentInSlideAsync():void 0}getMediaInfo(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return t?t.getMediaInfo(e):void 0}updateMediaState(e,t){let i=`Blocking - ${this.m_viewController?"m_currentSlideLocation":"m_viewController"} undefined`;if(this.m_viewController&&this.m_currentSlideLocation){const n=void 0!==t?t.slideId:this.m_currentSlideLocation.slideId,r=this.m_viewController.getSlideViewElement(n);if(i=r?"Passing to SlideViewElement":"Blocking - SlideViewElement undefined",r)return D.a.updateMediaSyncMetadataAndLog(i,"SlideShowCore",e),void r.updateMediaState(e)}D.a.updateMediaSyncMetadataAndLog(i,"SlideShowCore",e)}setAddinSyncState(e){this.m_appForOfficeManager?this.m_appForOfficeManager.updateAddinSyncState(e):d.a.sendTraceTag(506856726,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,"SlideShowCore::setAddinSyncState: recieving addin sync state before AppForOfficeManager initialized.")}setVideoPlayButtonVisibility(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateVideoPlayButtonVisibility(e)}setMediaCommandScope(e){this.m_viewController&&(this.m_viewController.mediaCommandScope=e)}restoreFocus(){this.m_container.focus()}static preloadShaders(e){let t;if(e&&e.shapeBuilderCanvasContext&&(t=e.shapeBuilderCanvasContext.gl),!t){const e=document.createElement("canvas");t=_.a.readBooleanOrDefault("webgl2Enabled",!1)&&e.getContext("webgl2")||e.getContext("webgl")||e.getContext("experimental-webgl")}return!!t&&(s.l.preloadShaders(t,e),!0)}getCurrentSlideDimensions(){return this.m_viewController?this.m_viewController.getSlideDimensions():void 0}getCurrentSlideViewBounds(){return this.m_viewController?this.m_viewController.getSlideViewBounds():void 0}async prefetchSlide(e,t=!1,i){const n=this.resolvePartialSlideLocation(e);if(!n||!this.m_viewController)return;const r=Object(y.v4)(),a={};a[v.a.Prefetch]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()};const s=await this.ensureSlideViewElementAsync(n.slideId,!1,r,v.a.Prefetch,!1);this.handleErrors(s,{errorAction:U.PrefetchEnsureSlide});const o=i&&i.source?i.source:"unknown";g.ChangeGate.isChangeGateEnabled("TelemetryForPrefetchFailure")&&s.hasOwnProperty("errorName")&&d.a.sendTraceTag(506856725,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,`SlideShowCore::prefetchSlide - ensureSlideResult return with error: ${s.errorName} at SlideLocation:${n} during prefetch at:${o}.`);let l={};if(t&&!this.isHiddenFromHiddenList(n.slideIndex)&&!s.hasOwnProperty("errorName")){a[v.a.Prerender]={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},l=await this.m_viewController.ensureTextureLoaded(n.slideId,{isPrefetch:!0});const e=this.resolvePartialSlideLocation({slideIndex:n.slideIndex-1});await this.m_viewController.preRenderSlideById(n.slideId,e?e.slideId:void 0),a[v.a.Prerender].end=f.a.performanceNowTrimmed()}this.emitIfCameoDetected(n.slideIndex),await this.emitIfMediaDetected(n.slideIndex),a[v.a.Prefetch].end=f.a.performanceNowTrimmed(),this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordNavData(this.m_viewController.viewDataManager,v.a.Prefetch,{sid:n.slideId.sid,correlationId:r,sr:_.a.readBooleanOrDefault("EnableSourceAppType",!1)?this.m_appType:this.m_source,...s,...l,...a})}async getSlideShowTimings(e){const t=this.addCommonResourceMetadata({meta_correlationId:Object(y.v4)()}),i=(await this.m_providers.slide.load(JSON.stringify(e.slideId),t)).resource;return i?i.ssTimes:void 0}async getSlideTitle(){let e="";if(this.m_currentSlideLocation){const t=await this.m_viewDataManager.getSlideViewData(this.m_currentSlideLocation.slideId);t.resource&&t.resource.accessibilityModelPromise&&(e=(await t.resource.accessibilityModelPromise).slideTitleString)}return e}get isAnimating(){return this.m_isAnimating}setIsAnimating(e){e!==this.m_isAnimating&&(this.m_isAnimating=e,this.m_viewController&&(this.m_viewController.isAnimating=this.m_isAnimating)),this.events.emit("animationStateChanging",{isAnimating:this.m_isAnimating,metadata:{isGpuHardwareDisabled:s.l.s_gpuHardwareDisabled,rendererTech:s.l.s_rendererTech,isBadGPU:s.l.s_isBadGpu,isSvg:_.a.readBooleanOrDefault("forceSvg",!1),isGlyphCacheDisabled:s.l.s_isGlyphCacheDisabled,scale:Z.getScaleForAnimations(),hostExperience:this.m_sessionSettings.appSettings.hostExperience}})}get isCameoActive(){return this.m_isCameoActive}set isCameoActive(e){e!==this.m_isCameoActive&&(this.m_isCameoActive=e,e||(this.m_slideRefreshNeeded=!0))}isMediaPlaying(){if(!this.m_viewController||!this.m_currentSlideLocation)return!1;const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return null!==e&&e.isMediaPlayingOnSlideCanvas()}setTransitionState(e,t){e!==this.m_isTransitioning&&(this.m_isTransitioning=e,this.m_viewController&&(this.m_viewController.isTransitioning=this.m_isTransitioning));const i=t||{};i.isGpuHardwareDisabled=s.l.s_gpuHardwareDisabled,i.rendererTech=s.l.s_rendererTech,i.isBadGPU=s.l.s_isBadGpu,i.isGlyphCacheDisabled=s.l.s_isGlyphCacheDisabled,i.isSvg=_.a.readBooleanOrDefault("forceSvg",!1),i.hostExperience=this.m_sessionSettings.appSettings.hostExperience,this.events.emit("slideLocationChanging",{isTransitioning:this.m_isTransitioning,metadata:i})}get isTransitioning(){return this.m_isTransitioning}async ensureSlideViewElementAsync(e,t,i,n,r,a){return await this.m_ensureSlideViewElementThrottler.callAsync(e,t,i,n,r,n===v.a.Prefetch,a)}registerMediaEventHandlers(e){e.on("mediaPlayed",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaPaused",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaSeeked",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaVolumeChanged",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaEnded",e=>{this.events.emit("slideMediaEvent",e)}),e.on("aadTokenRequest",e=>{this.events.emit("aadTokenRequest",e)}),e.on("mediaInitState",e=>{this.events.emit("mediaInitState",e)}),e.on("userMediaAction",e=>{this.events.emit("userMediaAction",e)})}async ensureSlideViewElementImplAsync(e,t,i,n,r,o,l){if(!this.m_viewController)return{};let p,S=this.m_viewController.getSlideViewElement(e);if(S&&n!==v.a.UpdateResourceProviders){t&&!S.fImageTextureLoaded&&(p=await this.m_viewController.ensureTextureLoaded(e,{isPrefetch:o}));const n={slideId:e.sid,correlation:i},r=this.m_providers.slide.getLoadResultInCache(JSON.stringify(e));return r&&r.resource?(n[v.c.CachedInServer]=!(!r.hasOwnProperty("metadata")||!r.metadata.hasOwnProperty(v.c.CachedInServer))&&r.metadata[v.c.CachedInServer],n[v.c.RequestInfo]=r.hasOwnProperty("metadata")&&r.metadata.hasOwnProperty(v.c.RequestInfo)?r.metadata[v.c.RequestInfo]:void 0,n[v.c.GetItemsResult]=r.hasOwnProperty("metadata")&&r.metadata.hasOwnProperty(v.c.GetItemsResult)?r.metadata[v.c.GetItemsResult]:void 0,d.a.sendTraceTag(506856723,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::ensureSlideViewElement: slideViewElement exists, fLoadTexture:${t}, fImageTextureLoaded:${S.fImageTextureLoaded}.`),l&&l.additionalMetrics&&(l.additionalMetrics.isSlideCached=!0),{...n,...p}):(r&&r.metadata&&r.metadata.hasOwnProperty("errorName")&&(n.errorName=r.metadata.errorName),d.a.sendTraceTag(506856724,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(n)),{...n,...p})}const y={loadSlide:{start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()},slideId:e.sid,correlation:i},T={meta_correlationId:i};n===v.a.Prefetch&&_.a.readBooleanOrDefault("enableSequentialGetItems",!1)&&(T.meta_priorityHint=a.e.Low),T.meta_requestInfo={ActionType:n},T.meta_isInit=r;const b=this.addCommonResourceMetadata(T);l&&l.additionalMetrics&&(l.additionalMetrics.isSlideCached=this.m_providers.isSlideCached(JSON.stringify(e)));const w=await this.m_providers.slide.load(JSON.stringify(e),b);if(y.loadSlide.end=f.a.performanceNowTrimmed(),!w||!w.resource)return w&&w.metadata&&w.metadata.hasOwnProperty("errorName")&&(y.errorName=w.metadata.errorName),d.a.sendTraceTag(506856722,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(y)),y;w.metadata.axErrorName&&(y.axError=w.metadata.axErrorName),y[v.c.CachedInServer]=!(!w.hasOwnProperty("metadata")||!w.metadata.hasOwnProperty(v.c.CachedInServer))&&w.metadata[v.c.CachedInServer],y[v.c.RequestInfo]=w.hasOwnProperty("metadata")&&w.metadata.hasOwnProperty(v.c.RequestInfo)?w.metadata[v.c.RequestInfo]:void 0,y[v.c.GetItemsResult]=w.hasOwnProperty("metadata")&&w.metadata.hasOwnProperty(v.c.GetItemsResult)?w.metadata[v.c.GetItemsResult]:void 0,y.loadSlideViewData={start:f.a.performanceNowTrimmed(),end:f.a.performanceNowTrimmed()};const I=await this.m_viewDataManager.getSlideViewData(w.resource.id);if(!I.resource)return I.metadata.hasOwnProperty("errorName")&&(y.errorName=I.metadata.errorName),d.a.sendTraceTag(506856721,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(y)),{...y,...I};const P=I.resource;P&&P.transData&&this.m_transitionResourceLoader.load(P.transData.type),y.loadSlideViewData.end=f.a.performanceNowTrimmed();let E={};if(_.a.readBooleanOrDefault("enableUpdateSlideResources",!0)&&(E=await this.updateSlideResources(w.resource,i,r)),P){const e=Z.filterToResourceEntriesWithMissingImages(P.resCat);if(e&&e.length>0){const t=new Set;for(const i of e){let e=i.id;!e.includes(".")&&i.name.lastIndexOf(".")>0&&i.name.substring(i.name.lastIndexOf(".")).length<6&&(e+=i.name.substring(i.name.lastIndexOf("."))),t.add(i.id)}const i=Array.from(t);if(y.imagesMissingFromServer=i,d.a.sendTraceTag(506856720,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,"SlideShowCore::ensureSlideViewElement ImagesMissingFromServer:"+JSON.stringify(i)),_.a.readBooleanOrDefault("missingImagesVetoEnabled",!1)&&m.e.recordVeto("ImagesMissingFromServer",{missingImages:i}),_.a.readBooleanOrDefault("missingImagesReturnEarlyEnabled",!1))return{...y,...E}}}if(S=this.m_viewController.getSlideViewElement(w.resource.id),S&&n!==v.a.UpdateResourceProviders)return!t&&S.fImageTextureLoaded||(p=await this.m_viewController.ensureTextureLoaded(w.resource.id,{isPrefetch:o})),{...y,...E,...p};const x=await this.m_viewController.ensureSlideViewElement(w.resource);if(x.hasOwnProperty("errorName"))return y.errorName=x.metadata.errorName,d.a.sendTraceTag(506856719,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(y)),{...y,...E,...x};t&&(p=await this.m_viewController.ensureTextureLoaded(w.resource.id,{isPrefetch:o})),S=this.m_viewController.getSlideViewElement(w.resource.id);let k=0;return S&&(S.animClock.events.on("tick",async e=>{if(!S||!this.m_viewController||!this.m_currentSlideLocation||this.m_currentSlideLocation.slideId.sid!==S.slideId.sid)return;const t=performance.now();_.a.readBooleanOrDefault("hackLogAnimationFrameTime",!1)&&console.log("Time between Frames: "+(t-k));const i=this.isAnimating,n=S.animTimeline.setTimeAndCalculate(e),r=S.fHasContinuouslyAnimatedContent&&this.m_sessionSettings.slideShowCoreSettings.convertGifToVideo,a=_.a.readBooleanOrDefault("useIsMediaPlaying",!0)&&this.isMediaPlaying(),o=g.ChangeGate.isChangeGateEnabled("SSC.CameoSlidePresenceCheck")?this.isCameoActive&&await this.isCameoDetectedOnCurrentSlideAsync():this.isCameoActive,l=_.a.readBooleanOrDefault("lowResAnimsEnabled",!1);if(l||this.setIsAnimating(n),(l?i:n)||r||o||a||this.m_slideRefreshNeeded||this.m_zoomAnimationController.isZooming&&!_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)){let e=1;if(l&&(e=n?Z.getScaleForAnimations():1,this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,S.slideSizePixels,{canvasScale:e})),(_.a.readBooleanOrDefault("enableCameoInPPTOSlideShow",!1)||_.a.readBooleanOrDefault("enableCameoInT2",!1))&&o&&this.m_viewController.updateCameoTextureFromVideoElement(),this.m_viewController.renderSlideAnimationFrameById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.events.emit("animatedContentStateChanged",{hasContinuouslyAnimatedContent:r||o||a,metadata:{isGpuHardwareDisabled:s.l.s_gpuHardwareDisabled,rendererTech:s.l.s_rendererTech,isBadGPU:s.l.s_isBadGpu,isGlyphCacheDisabled:s.l.s_isGlyphCacheDisabled,isSvg:_.a.readBooleanOrDefault("forceSvg",!1),scale:e,hostExperience:this.m_sessionSettings.appSettings.hostExperience}}),_.a.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1))N.recordRender();else if(this.m_slideRefreshNeeded&&this.m_opticalZoomRenderPerfStartTime){const e=performance.now();d.a.sendTraceTag(512278924,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`Optical Zoom time from zoom invocation to render: ${e-this.m_opticalZoomRenderPerfStartTime}ms`),this.m_opticalZoomRenderPerfStartTime=void 0}this.m_slideRefreshNeeded=!1}if(l&&this.setIsAnimating(n),_.a.readBooleanOrDefault("hackLogAnimationFrameTime",!1)){const e=performance.now();console.log("Frame Duration: "+(e-t)),k=e}}),S.animClock.events.on("notRunning",()=>{this.setIsAnimating(!1)}),S.events.on("clickTarget-interactiveAnimation",e=>{this.nextStep(e,a.j.Mouse)}),S.events.on("mediaAnimation-nextStep",()=>{this.nextStep(u.e.MainTimelineId,a.j.API)}),S.events.on("clickTarget-gotoSlide",e=>{this.gotoSlide({slideId:e},{actionContext:{navigationType:a.c.ClickTarget}}).then(e=>{g.ChangeGate.isChangeGateEnabled("ClickTargetGotoSlideTelemetry")&&!e.fSucceeded&&d.a.sendTraceTag(506856718,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,JSON.stringify(e.metrics))})}),S.events.on("clickTarget-gotoZoomSlide",e=>{this.m_currentSlideLocation&&e.slideId&&this.m_zoomManager&&this.m_zoomManager.addSlide(e.slideId,this.m_currentSlideLocation.slideId,e.returnToParent),this.gotoSlide({slideId:e.slideId},{actionContext:{navigationType:a.c.ClickTarget}}).then(e=>{g.ChangeGate.isChangeGateEnabled("ClickTargetGotoSlideTelemetry")&&!e.fSucceeded&&d.a.sendTraceTag(506856717,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,JSON.stringify(e.metrics))})}),S.events.on("clickTarget-gotoZoomSection",e=>{if(this.m_currentSlideLocation&&e.sectionId&&this.m_zoomManager){const t=C(e.sectionId,this.m_viewDataManager.sections);this.m_zoomManager.addSection(e.sectionId,this.m_currentSlideLocation.slideId,e.returnToParent),t&&this.gotoSlide({slideId:t},{actionContext:{navigationType:a.c.ClickTarget}}).then(e=>{g.ChangeGate.isChangeGateEnabled("ClickTargetGotoSlideTelemetry")&&!e.fSucceeded&&d.a.sendTraceTag(506856716,c.a.msoulscat_Wac_PptSlideshow,h.a.Error,JSON.stringify(e.metrics))})}}),this.registerMediaEventHandlers(S.events)),{...y,...p}}static getScaleForAnimations(){const e=_.a.readNumberOrDefault("maxDprForAnimations",1);return _.a.readBooleanOrDefault("lowResAnimsEnabled",!1)&&window.devicePixelRatio>e?e/window.devicePixelRatio:1}onNavigatingFrom(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&(t.animClock.pause(),t.events.emit("navigatingFrom"))}onNavigatedTo(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&(t.animClock.resume(),t.events.emit("navigatedTo"))}onNavigatedFrom(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("navigatedFrom")}onNavigatingTo(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("navigatingTo")}onBeforeFirstRenderAfterNavigation(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("beforeFirstRenderAfterNavigation")}resolvePartialSlideLocation(e){let t=this.m_slideIdOrder.map((e,t)=>({slideId:e,index:t}));if(void 0!==e.slideId){if(t=t.filter(t=>t.slideId.cid===e.slideId.cid&&t.slideId.sid===e.slideId.sid),t.length>1&&void 0!==e.slideIndex){const i=t.filter(t=>t.index===e.slideIndex);0!==i.length&&(t=i)}}else void 0!==e.slideIndex&&(t=t.filter(t=>t.index===e.slideIndex));if(0!==t.length&&(void 0!==e.slideId||void 0!==e.slideIndex))return{slideId:t[0].slideId,slideIndex:t[0].index}}checkForAnimationStateChanges(e){if(!this.m_currentSlideLocation||!this.m_viewController)return!1;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!t)return!1;const i=t.animTimeline.getTimelineStates(!1);return JSON.stringify(this.m_currentTimelineStates)!==JSON.stringify(i)&&(this.m_currentTimelineStates=i,this.events.emit("animationStateChanged",e?{actionContext:e}:void 0)),!0}getTransitionController(){return this.m_viewController?this.m_viewController.getTransitionController():null}cancelTransition(){if(this.isTransitioning){const e=this.getTransitionController();return e&&e.clock.stop(),!0}return!1}pauseTransition(){if(this.isTransitioning){const e=this.getTransitionController();return e&&e.clock.pause(),!0}return!1}resumeTransition(){if(!this.isTransitioning){const e=this.getTransitionController();return e&&e.clock.resume(),!0}return!1}async isCameoDetectedOnCurrentSlideAsync(){if(!this.m_currentSlideLocation)return!1;const e=this.m_currentSlideLocation.slideIndex;return await this.isCameoDetectedAtSlideIndexAsync(e)}recordSessionStats(e){f.a.recordSessionStats(e)}setMaxSceneCount(e,t){this.m_viewController&&this.m_viewController.setMaxSceneCount(e,t)}setAadToken(e){if(this.m_viewController&&this.m_currentSlideLocation){const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(t)return void t.setAadToken(e)}g.ChangeGate.isChangeGateEnabled("SSC.Stream2AadToken")&&s.f.setStream2AadToken(e)}setFrameTrustStatus(e){this.m_appForOfficeManager&&this.m_appForOfficeManager.setFrameTrustStatus(e)}async isCameoDetectedAtSlideIndexAsync(e){if(!this.m_viewController||e<0||e>=this.m_slideIdOrder.length)return!1;const t=this.m_slideIdOrder[e];if(!t)return!1;if(!(e in this.m_cameoPresenceCache)){const i=this.m_viewController.getSlideViewElement(t);if(!i)return!1;this.m_cameoPresenceCache[e]=await i.isCameoPresentInSlideAsync()}return this.m_cameoPresenceCache[e]}async isCameoDetectedNearbyAsync(){if(!this.m_currentSlideLocation)return!1;const e=this.m_currentSlideLocation.slideIndex;return await this.isCameoDetectedAtSlideIndexAsync(e)||await this.isCameoDetectedAtSlideIndexAsync(e-1)||await this.isCameoDetectedAtSlideIndexAsync(e+1)}emitIfCameoDetected(e){this.isCameoDetectedAtSlideIndexAsync(e).then(e=>{!this.m_cameoDetectedInPresentation&&e&&(this.m_cameoDetectedInPresentation=!0,d.a.sendTraceTag(506856715,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::emitIfCameoDetected - Cameo detected in Presentation"),this.events.emit("cameoDetectedInPresentation",{cameoDetected:!0}))})}getCameoInfoFromActiveSlide(){if(!this.m_viewController||!this.m_currentSlideLocation)return;const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e)return;const t=e.getCameoInfoInSlide();return d.a.sendTraceTag(506856714,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,`SlideShowCore::getCameoInfoFromActiveSlide - Cameo details - ${JSON.stringify(t)} in slide ${JSON.stringify(this.m_currentSlideLocation)}}`),t}setCameoVideoElement(e){this.m_viewController&&this.m_viewController.setCameoVideoElement(e)}videoFrameToPptForCameo(e,t){this.m_viewController&&this.m_viewController.sendFrameToCameo(e,t)}clearCameo(){this.m_viewController&&this.m_viewController.clearCameo()}async emitIfMediaDetected(e){this.m_fMediaDetectedInPresentation||await this.isMediaPresentInSlide(e)&&(this.m_fMediaDetectedInPresentation=!0,d.a.sendTraceTag(506856713,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::emitIfMediaDetected - Media detected in Presentation"),this.events.emit("mediaDetectedInPresentation"))}getContentInfoFromActiveSlide(){if(!this.m_viewController||!this.m_currentSlideLocation)return{};const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return e?e.slideContentTelemetry:{}}getMediaCurrentState(e){if(!this.m_viewController)return;if(!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return null!==t?t.getMediaCurrentState(e):void 0}set isHandlingResourceInconsistent(e){this.m_isHandlingResourceInconsistent=e}get isHandlingResourceInconsistent(){return this.m_isHandlingResourceInconsistent}setGlobalMute(e){this.m_viewController&&this.m_viewController.updateGlobalMute(e)}get opticalZoomStateInfo(){return this.m_opticalZoomStateInfo}getGlobalMute(){return this.m_viewController?this.m_viewController.isGlobalMute:void 0}setOpticalZoomState(e,t){const i=_.a.readNumberOrDefault("minimumZoom",1),n=_.a.readNumberOrDefault("maximumZoom",2);if(e.currentState.canvasCenterSlidePointPercent.x<0||e.currentState.canvasCenterSlidePointPercent.x>1||e.currentState.canvasCenterSlidePointPercent.y<0||e.currentState.canvasCenterSlidePointPercent.y>1)return;const r=Math.min(n,Math.max(i,e.currentState.zoomLevel)),a=r===this.m_opticalZoomStateInfo.currentState.zoomLevel,s=e.currentState.canvasCenterSlidePointPercent.x===this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent.x&&e.currentState.canvasCenterSlidePointPercent.y===this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent.y,o=V(this.m_opticalZoomStateInfo.animationData,e.animationData);if(_.a.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&!a&&(r>i?(this.m_container.style.cursor="-moz-grab",this.m_container.style.cursor="-webkit-grab",this.m_container.style.cursor="grab"):this.m_container.style.cursor="auto"),_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)){if(a&&s&&o)return}else if(a&&s)return;_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&t&&t.fEndZoomAnimation&&this.m_zoomAnimationController.finishZoomAnimation(),this.m_opticalZoomStateInfo.currentState={zoomLevel:r,canvasCenterSlidePointPercent:e.currentState.canvasCenterSlidePointPercent},_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&(this.m_opticalZoomStateInfo.animationData=e.animationData,this.m_slideRefreshNeeded=!0),this.events.emit("opticalZoomStateChanged",e)}async zoomToAsync(e,t,i){const n=this.m_blankSlideState!==a.a.Hidden||this.m_isTransitioning||this.m_zoomAnimationController.isZooming;if(!this.enableOpticalZoom||!this.m_viewController||!this.m_currentSlideLocation||n)return;const r=_.a.readNumberOrDefault("maximumZoom",2),o=_.a.readNumberOrDefault("minimumZoom",1),l=this.m_opticalZoomStateInfo.currentState.zoomLevel;if(l<=o&&e<=l||l>=r&&e>=l||e===l)return;_.a.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)&&i&&!i.fAnimate&&i.source?N.recordInput(i.source):i&&i.source&&(i.source===a.d.KeyboardPlus||i.source===a.d.KeyboardMinus||i.source===a.d.UIPlus||i.source===a.d.UIMinus)&&(this.m_opticalZoomRenderPerfStartTime=performance.now());const u=Math.max(o,Math.min(r,e)),m=this.m_viewController.getBounds.getBoundingClientRectFromCanvas(),f=this.m_viewController.getBounds.getClientSizeFromCanvas(),p=t?new s.k(t.x-m.left,t.y-m.top):f.scale(.5);if(_.a.readBooleanOrDefault("enableOpticalZoomAnimation",!1)&&i&&i.fAnimate){let e=!0;if(g.ChangeGate.isChangeGateEnabled("SSC.ZoomOutBasedOnOSSetting")&&(e=window.matchMedia("(prefers-reduced-motion: no-preference)").matches||_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)),e){const e=i.fAnimationDurationInMs&&i.fAnimationDurationInMs>0?i.fAnimationDurationInMs:_.a.readNumberOrDefault("zoomAnimationDurationMs",250);return _.a.readBooleanOrDefault("isZoomSyncEnabled",!1)?void await this.m_zoomAnimationController.animateZoomWithAnimationProgressEventsAsync(u,e,this.m_viewController,{canvasZoomPositionInPixels:p,source:i?i.source:void 0}):(await this.m_zoomAnimationController.animateZoomAsync(u,e,this.m_viewController,p,i?i.source:void 0),void(this.m_slideRefreshNeeded=!0))}}let S=this.m_viewController.calculateCanvasCenterSlidePointPercentAfterZoom(p,u,this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState);if(!S)return;(isNaN(S.x)||isNaN(S.y))&&(S=new s.k(.5,.5),d.a.sendTraceTag(506856712,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,"SlideShowCore::zoomToAsync - Defaulting canvasCenterSlidePointPercent due to NaN"));const v={currentState:{zoomLevel:u,canvasCenterSlidePointPercent:S},metadata:i&&i.source?{source:i.source}:void 0};if(this.setOpticalZoomState(v),_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)||(this.m_slideRefreshNeeded=!0),_.a.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!_.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){const e={width:m.width*u,height:m.height*u,zoomPositionX:p.x,zoomPositionY:p.y,containerSizeChanged:!1};this.events.emit("updateCanvasZoom",e)}}panByAmount(e,t){const i=this.m_blankSlideState!==a.a.Hidden||this.m_isTransitioning||this.m_zoomAnimationController.isZooming;if(!this.enableOpticalZoom||!this.m_viewController||!this.m_currentSlideLocation||i)return;if(g.ChangeGate.isChangeGateEnabled("SSC.PreventPanIfZoomAtMinimum")&&this.m_opticalZoomStateInfo.currentState.zoomLevel===_.a.readNumberOrDefault("minimumZoom",1))return;const n=this.m_viewController.calculateCanvasCenterPointPercentAfterPan(new s.k(e.x,e.y),this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState);if(!n)return;const r=this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent;if(r.x===n.x&&r.y===n.y)return;_.a.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)&&t&&t.source&&N.recordInput(t.source);const o={zoomLevel:this.m_opticalZoomStateInfo.currentState.zoomLevel,canvasCenterSlidePointPercent:n};this.setOpticalZoomState({currentState:o,metadata:t&&t.source?{source:t.source}:void 0}),_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)||(this.m_slideRefreshNeeded=!0),_.a.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!_.a.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&this.events.emit("updateCanvasPan",{x:e.x,y:e.y})}constructor(e,t,n,r,l){this.events=new o.EventEmitter,this.enableOpticalZoom=!1,this.prefetchWindowRange={first:-1,last:-1},this.m_isHandlingResourceInconsistent=!1,this.m_slideIdOrder=[],this.m_defaultSlideIdOrder=[],this.m_customShows=[],this.m_currentCustomShowIndex=-1,this.m_isCustomSlideShowActive=!1,this.m_shouldNavigateToHiddenSlides=!1,this.m_hiddenSlideIdOrder=[],this.m_currentTimelineStates=null,this.m_isAnimating=!1,this.m_isTransitioning=!1,this.m_blankSlideState=a.a.Hidden,this.m_contextIsLoaded=!1,this.m_gotoSlideRequestCount=0,this.m_cameoDetectedInPresentation=!1,this.m_cameoPresenceCache={},this.m_isCameoActive=!1,this.m_fMediaDetectedInPresentation=!1,this.m_slideRefreshNeeded=!1,this.m_networkHealthChangedEvents=[],this.m_source=1,this.m_gotoSlideThrottlerAsync=new O.a(this.gotoSlideImpl.bind(this),this.gotoSlideQueueHandler.bind(this)),this.m_updateResourceProvidersThrottler=new O.a(this.updateResourceProvidersAsyncImplAsync.bind(this),Z.updateResourceProvidersQueueHandler),this.m_ensureSlideViewElementThrottler=new O.b(this.ensureSlideViewElementImplAsync.bind(this),O.c,e=>JSON.stringify(e)),this.m_customShowReceivedTime=0,this.m_customShowRequestedTime=0,this.m_logger=n,window.exposed instanceof Object||(window.exposed={}),q({logger:n,settings:r.slideShowCoreSettings.settings,disabledChangeGates:r.slideShowCoreSettings.disabledChangeGates,vetoSessionId:r.appSettings.userSessionId,exposed:window.exposed}),$.this=this,$.appVersion="8.4.43",$.svmVersion="9.2.34",$.sbVersion="1.9.27",$.settings=r.slideShowCoreSettings.settings,$.sessionId=r.appSettings.userSessionId,$.enableUnsafeStringOverrides=()=>{localStorage.setItem("unsafeStringOverridesEnabled",Date.now().toString())},$.disableUnsafeStringOverrides=()=>{localStorage.removeItem("unsafeStringOverridesEnabled")},d.a.sendTraceTag(506856855,c.a.msoulscat_Wac_PptSlideshow,h.a.Info,JSON.stringify({uintTest:_.a.readNumberOrDefault("uintTest",0),boolTest:_.a.readBooleanOrDefault("boolTest",!1),strTest:_.a.readStringOrDefault("strTest","")})),this.m_sessionSettings=r,f.a.init(r,"8.4.43","9.2.34","1.9.27"),f.a.logSessionStart(0),this.m_navigationLoggerNew=new S,this.m_navigationLoggerNew.init(r),this.m_transitionResourceLoader=new p.d(this.m_sessionSettings.slideShowCoreSettings.transitionResourceCDNPath,!0),this.m_sessionSettings.appSettings.jsScriptsBasePath&&""!==this.m_sessionSettings.appSettings.jsScriptsBasePath&&(i.p=this.m_sessionSettings.appSettings.jsScriptsBasePath),this.m_viewDataManager=new s.m(this.addClientSizeToLoader(t.slideViewData),this.addClientSizeToLoader(t.shapeViewData),t.localizedString),_.a.readBooleanOrDefault("enableSummaryZoom",!1)&&(this.m_zoomManager=new E(this.m_viewDataManager)),_.a.readBooleanOrDefault("enableAddinViewElement",!1)&&this.ensureAppForOfficeManager();const u=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0;this.m_viewControllerSettings={sessionId:this.m_sessionSettings.appSettings.userSessionId,editAudioEnabled:this.m_sessionSettings.slideShowCoreSettings.editAudioEnabled,transparentCanvasForVideoEnabled:_.a.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!_.a.readBooleanOrDefault("forceSvg",!1)||!1,serverUrl:this.m_sessionSettings.appSettings.serverUrl,uiHost:this.m_sessionSettings.appSettings.uiHost||"",morphEnabled:_.a.readBooleanOrDefault("morphEnabled",!0),disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates||"",showCustomPlayButtonForVideo:this.m_sessionSettings.slideShowCoreSettings.showCustomPlayButtonForVideo,stringifyError:M.b,settings:this.m_sessionSettings.slideShowCoreSettings.settings,jsScriptsBasePath:this.m_sessionSettings.appSettings.jsScriptsBasePath||"",applicationLcid:this.m_sessionSettings.appSettings.applicationLcid||"",startFromTime:u,initTime:this.m_sessionSettings.appSettings.initTime||0,hubbleVideoEndpoint:this.m_sessionSettings.appSettings.hubbleVideoEndpoint,acceptLanguage:this.m_sessionSettings.appSettings.acceptLanguage,teamsCallId:this.m_sessionSettings.appSettings.teamsCallId,isMultiSlideshowcoreEnabled:this.m_sessionSettings.slideShowCoreSettings.isMultiSlideshowcoreEnabled||!1,flights:this.m_sessionSettings.flights||{},shapeBuilderCanvasContext:l&&"object"==typeof l?l.shapeBuilderCanvasContext:void 0},e.style.outline="none",this.m_container=e,l&&"object"!=typeof l&&(this.m_source=l),void 0!==this.m_sessionSettings.slideShowCoreSettings.instanceSource&&(this.m_source=this.m_sessionSettings.slideShowCoreSettings.instanceSource);const m="undefined"!=typeof PowerpointSlideshowStringsManager?PowerpointSlideshowStringsManager.get(PowerpointSlideshowStringsEnum.SlideShowAccessibilityLabelCurrentSlidePane):"Current Slide Pane";if(this.m_container.setAttribute("aria-label",m),this.m_stateManager=new b(a.g.Normal,new T(e)),this.m_providers=t,this.m_lastRequestedSlideState={},window.addEventListener("beforeunload",()=>{this.flushSessionEndLogs()}),G&&window.removeEventListener("beforeunload",G),new k,_.a.readBooleanOrDefault("pingEnabled",!1)){if(_.a.readBooleanOrDefault("overrideAllTimeoutsForBoot",!1)){const e=_.a.readNumberOrDefault("AddedTimeoutTimeMs",13e4);e?setTimeout(()=>this.events.emit("networkHealthChanged",{isHealthy:!0,addTimeoutTimeMs:e}),0):setTimeout(async()=>{this.events.emit("networkHealthChanged",{isHealthy:!1,addTimeoutTimeMs:13e4}),await Object(O.d)(100),this.events.emit("networkHealthChanged",{isHealthy:!0,addTimeoutTimeMs:13e4})},0)}this.m_customShowRequestedTime=Date.now();const e=`${this.m_sessionSettings.appSettings.serverUrl}/resources/${this.m_sessionSettings.appSettings.applicationLcid}/progress.gif`;this.m_networkHealthManager=new F(e),this.m_networkHealthManager.startPinging();const t=this.m_networkHealthManager;this.m_networkHealthManager.events.on("isHealthyChanged",()=>{0===this.m_networkHealthChangedEvents.length&&d.a.sendTraceTag(506856854,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify({datetime:Date.now(),perf:performance.now()})),this.m_networkHealthChangedEvents.push({time:performance.now(),isHealthy:t.isHealthy});const e=t.isHealthy?0:_.a.readNumberOrDefault("AddedTimeoutTimeIfBadNetworkMs",13e4);_.a.readBooleanOrDefault("networkHealthChangedEventEnabled",!1)&&this.events.emit("networkHealthChanged",{isHealthy:t.isHealthy,addedTimeoutTimeIfBadNetworkMs:e})}),setTimeout(()=>{const e=[];let t=!0,i=0;for(const n of this.m_networkHealthChangedEvents)n.isHealthy!==t&&(n.isHealthy?(e.push({start:i,length:n.time-i}),i=0):i=n.time,t=n.isHealthy);i>0&&e.push({start:i,length:performance.now()-i}),d.a.sendTraceTag(506856853,c.a.msoulscat_Wac_PptSlideshow,h.a.Warning,JSON.stringify(JSON.stringify(e)))},5e4-performance.now())}this.m_opticalZoomStateInfo={currentState:{zoomLevel:_.a.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:new s.k(.5,.5)}},this.m_zoomAnimationController=new L(this)}}Z.c_preferFullyBuilt=!0,Z.s_defaultOpticalZoomState={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return c}));var n=i(0),r=i(73),a=i(2),s=i(15);function o(e,t,i,r,o){if(0==i&&e.cachedBoundsContributor)return{points:e.cachedBoundsContributor.points,curves:e.cachedBoundsContributor.curves,transform:t};const l=0!=i,d={points:new Array,curves:new Array,transform:l?void 0:t},c=e.getPointCount();for(let h=0;h<c;h++){let c=e.getPoint(h-1),u=e.getPoint(h),m=e.getPoint(h+1);if(l&&(c=t.transformPoint(c),u=t.transformPoint(u),m=t.transformPoint(m)),e.getPointType(h)==s.f.bezier)i?(d.curves.push([c.add(new n.f(-i,0)),u.add(new n.f(-i,0)),m.add(new n.f(-i,0))]),d.curves.push([c.add(new n.f(i,0)),u.add(new n.f(i,0)),m.add(new n.f(i,0))]),d.curves.push([c.add(new n.f(0,-i)),u.add(new n.f(0,-i)),m.add(new n.f(0,-i))]),d.curves.push([c.add(new n.f(0,i)),u.add(new n.f(0,i)),m.add(new n.f(0,i))])):d.curves.push([c,u,m]);else if(d.points.push(u),i)if(r==a.i.round)i?(d.points.push(u.add(new n.f(-i,0))),d.points.push(u.add(new n.f(i,0))),d.points.push(u.add(new n.f(0,-i))),d.points.push(u.add(new n.f(0,i)))):d.points.push(u);else{let e=u.subtract(c).normalized(),t=m.subtract(u).normalized();if(e&&t){e=e.scale(i),t=t.scale(i);let s=new n.f(-e.y,e.x),l=new n.f(-t.y,t.x);e.dot(l)<0&&(s=s.negate(),l=l.negate());const c=u.add(s),h=u.add(l);if(d.points.push(c),d.points.push(h),r==a.i.miter||r==a.i.miterOrBevel){const s=n.f.CalculateLineIntersection(c,c.add(e),h,h.subtract(t));s&&(n.f.Distance(s,u)<o*i?d.points.push(s):r==a.i.miter&&(d.points.push(c.add(e.scale(o))),d.points.push(h.subtract(t.scale(o)))))}}}}return 0!=i||e.cachedBoundsContributor||(e.cachedBoundsContributor={points:d.points,curves:d.curves,transform:void 0}),d}function l(e,t,i,n,s,l){for(const d of e){const e=d.transform.toMatrix3().multiply(n);for(const n of d.figures)if(l.push(o(n,e,t,s?a.i.miter:i.pen.lineJoin,i.pen.miterLimit)),t&&!n.isClosed&&i.pen){if(i.pen.headEnd&&i.pen.headEnd.end!=a.q.none){const s=Object(r.a)(i.pen.headEnd,i.pen.adjustedLineWidthForArrowHead);if(s){const d=Object(r.b)(n,!1,i.pen.headEnd,2*t,e);d&&l.push(o(s,d,t,a.i.miter,i.pen.miterLimit))}}if(i.pen.tailEnd&&i.pen.tailEnd.end!=a.q.none){const s=Object(r.a)(i.pen.tailEnd,i.pen.adjustedLineWidthForArrowHead);if(s){const d=Object(r.b)(n,!0,i.pen.tailEnd,2*t,e);d&&l.push(o(s,d,t,a.i.miter,i.pen.miterLimit))}}}}}function d(e,t){let i=!0,r=0,a=0,s=0,o=0;const l=e.transform&&t?e.transform.multiply(t):t||e.transform,d=!l||l.isSimpleScaleTranslationOnly(),c=d?void 0:l,h=e.points,u=e.curves,m=h&&h.length>0?h[0]:u&&u.length>0?u[0][0]:void 0;if(m){let e=0,t=0,f=0,p=0,g=0,_=0;if(c&&(e=c.m[0],t=c.m[1],f=c.m[3],p=c.m[4],g=c.m[6],_=c.m[7]),i&&(r=c?m.x*e+m.y*f+g:m.x,s=c?m.x*t+m.y*p+_:m.y,a=r,o=s,i=!1),h&&h.length>0)for(let i=1;i<h.length;i++){const n=h[i],l=c?n.x*e+n.y*f+g:n.x,d=c?n.x*t+n.y*p+_:n.y;r=l<r?l:r,a=l>a?l:a,s=d<s?d:s,o=d>o?d:o}for(const i of u||[]){const n=i[0],l=i[1],d=i[2],h=c?n.x*e+n.y*f+g:n.x,u=c?n.x*t+n.y*p+_:n.y,m=c?l.x*e+l.y*f+g:l.x,S=c?l.x*t+l.y*p+_:l.y,v=c?d.x*e+d.y*f+g:d.x,y=c?d.x*t+d.y*p+_:d.y;r=h<r?h:r,a=h>a?h:a,s=u<s?u:s,o=u>o?u:o,r=v<r?v:r,a=v>a?v:a,s=y<s?y:s,o=y>o?y:o;const T=(h-m)/(h+v-2*m);if(0<T&&T<1){const e=T*T,t=h*(e-2*T+1)+v*e+2*m*(T-e),i=u*(e-2*T+1)+y*e+2*S*(T-e);r=t<r?t:r,a=t>a?t:a,s=i<s?i:s,o=i>o?i:o}const b=(u-S)/(u+y-2*S);if(0<b&&b<1){const e=b*b,t=h*(e-2*b+1)+v*e+2*m*(b-e),i=u*(e-2*b+1)+y*e+2*S*(b-e);r=t<r?t:r,a=t>a?t:a,s=i<s?i:s,o=i>o?i:o}}let S=new n.d(r,s,a,o);return d&&(S=l?S.multiply(l.getSimpleScale()).translate(l.getSimpleTranslation()):S),S}}function c(e){let t=void 0;for(const i of e){if(0!=i.transform.rotation)return;const e=i.untransformedBounds;e&&(t=n.d.UnionRect(t,e.transformedBounds(i.transform)))}return t}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n="undefined"!=typeof FinalizationRegistry?new FinalizationRegistry(e=>{const t=e;for(let e in t)t[e].onFinalization()}):void 0},function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(13),r=i(9),a=i(3),s=i(7),o=i(23),l=i(8),d=i(36),c=i(10),h=i(105);class u{updateMediaStateCache(e){const t=this.m_mediaStateMap.has(e.mediaName)?"Updated MediaStateCache With Received State":"Set New MediaStateCache With Received State";let i=0;e.metadata&&e.metadata.timeStamps&&(i=e.metadata.timeStamps.Total_Elapsed_MS),this.m_mediaStateMap.set(e.mediaName,{mediaSyncState:e,lastCacheUpdateTimestampMs:Date.now(),latencyTimeMs:i}),u.updateMediaSyncMetadataAndLog(t,"MediaAddon",e)}shouldSendMediaSyncMessage(e,t){const i=this.m_slideShowRole===l.i.Presenter?"Passing":"Blocking";return r.a.sendTraceTag(506857157,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon: ${i} Media Sync ${t?"Initial State":"Event"}: ${JSON.stringify(e)}`),this.m_slideShowRole===l.i.Presenter}isInPrivateViewing(){return this.m_slideShowRole===l.i.PrivateViewing}registerAppEventListeners(){this.m_slideShowCore.events.on("mediaInitState",e=>{this.onMediaInitState(e.mediaSlideInfo,e.mediaSyncInitState)}),this.m_slideShowAppEvents.on("cleanupMediaStateCache",e=>this.cleanupMediaStateCache(e.isNavTriggerSSInBoundMessage,e.mediaNamesBySlideId)),this.m_slideShowAppEvents.on("returnToPresenterUpdateAllMedia",e=>this.returnToPresenterUpdateAllMedia(e.slideId,e.slideIndex)),this.registerSlideShowUIEvents()}returnToPresenterUpdateAllMedia(e,t){if(t){const e=this.m_slideShowCore.getMediaNamesBySlideIndex(t);this.cleanupMediaStateCache(!0,e)}this.m_mediaStateMap.forEach((t,i)=>{if(e){const n={slideId:e,mediaName:i};this.sendUpdatedMediaState(t,n)}else this.sendUpdatedMediaState(t)})}onMediaInitState(e,t){r.a.sendTraceTag(506857156,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon::onMediaInitState: Received mediaInitState event from media in slide: ${JSON.stringify(e)}, initState: ${JSON.stringify(t)}`);const i=t.mediaName;this.m_mediaStateMap.get(i)?(r.a.sendTraceTag(506857155,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon::onMediaInitState: Discard local mediaInitState ${JSON.stringify(t)} and update media with state cached ${JSON.stringify(this.m_mediaStateMap.get(i))}`),this.updateMediaState(e)):this.shouldSendMediaSyncMessage(t,!0)&&this.m_slideShowAppEvents.emit("mediaInitState",t)}updateMediaState(e){if(this.m_slideShowRole===l.i.PrivateViewing)return;const t=e.mediaName,i=this.m_mediaStateMap.get(t);this.sendUpdatedMediaState(i,e,!0)}sendUpdatedMediaState(e,t,i){if(void 0===e)return;this.addTimeToPlayerPositionSkew(e),e.mediaSyncState.origin.isFromLocalCache=!0;const n="Passing Media State to SlideShowCore on "+(i?"Player Ready":"Sync Back To Presenter");u.updateMediaSyncMetadataAndLog(n,"MediaAddon",e.mediaSyncState),r.a.sendTraceTag(506857154,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`MediaAddOn: Retrieving cached Media Sync state (${JSON.stringify(e.mediaSyncState)})`),this.m_slideShowCore.updateMediaState(e.mediaSyncState,t)}addTimeToPlayerPositionSkew(e){const t=e.mediaSyncState;t.state.playerState===n.e.MediaPlayed&&(t.state.playerPositionSkew=e.latencyTimeMs+Date.now()-e.lastCacheUpdateTimestampMs)}cleanupMediaStateCache(e,t){if(e||this.m_slideShowRole===l.i.Presenter){if(!t)return void(this.m_slideShowRole===l.i.Presenter&&this.m_mediaStateMap.clear());for(const e of this.m_mediaStateMap.keys())t.includes(e)||this.m_mediaStateMap.delete(e)}}static updateMediaSyncMetadataAndLog(e,t,i){if(!i.metadata||!i.metadata.mediaSyncTimeLine)return void r.a.sendTraceTag(506857153,a.a.msoulscat_Wac_PptLive,s.a.Info,t+"::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine.");const n=`${t}: ${e}`;i.metadata.mediaSyncTimeLine.push(n),r.a.sendTraceTag(506857152,a.a.msoulscat_Wac_PptLive,s.a.Info,JSON.stringify({fileName:t,mediaSyncState:i}))}registerSlideShowUIEvents(){this.m_slideShowUIEvents&&this.m_slideShowUIEvents.on("roleChanged",e=>{const t=this.m_slideShowRole;this.m_slideShowRole=e,e===l.i.Presenter&&t!==l.i.Presenter&&this.emitStateOfMediaInSlide();const i=e===l.i.Presenter;this.updateVideoPlayButtonVisibility(i),this.updateMediaCommandScope()})}emitStateOfMediaInSlide(){const e=this.m_slideShowCore.getSlideLocation();if(void 0===e)return;const t=this.m_slideShowCore.getMediaNamesBySlideIndex(e.slideIndex);if(t)for(const e of t){const t=this.m_slideShowCore.getMediaCurrentState(e);if(!t)continue;const i=this.m_slideShowCore.getMediaInfo(e);if(i&&i.isLoopingBackgroundVideo)continue;const n={mediaName:e,state:t,origin:{hostName:i?h.a[i.type]:"undefined",isInitial:!1,isFromRoleChange:!0},correlationId:Object(d.v4)()};this.m_slideShowCore.getGlobalMute()&&(n.state.muted=void 0),this.shouldSendMediaSyncMessage(n,!0)&&this.m_slideShowAppEvents.emit("mediaInitState",n)}}set slideShowUIEvents(e){e&&(this.m_slideShowUIEvents=e,this.registerSlideShowUIEvents())}get slideShowUIEvents(){return this.m_slideShowUIEvents}onUserMediaAction(e){if(this.m_slideShowRole!==l.i.Attendee)return;let t;switch(e.actionType){case n.j.PauseButtonClick:case n.j.PlayButtonClick:case n.j.ProgressSliderInput:case n.j.CustomPlayButtonClick:case n.j.VideoFrameClick:t=!0;break;default:t=!1}let i=!0,o=!0;const d=e.mediaName,h=this.m_slideShowCore.getSlideLocation();if(h){const e=this.m_slideShowCore.getMediaNamesBySlideIndex(h.slideIndex);e&&-1!==e.indexOf(d)||(i=!1,o=!1)}else r.a.sendTraceTag(506857123,a.a.msoulscat_Wac_PptSession,s.a.Warning,`MediaAddon::onUserMediaAction: Couldn't check if media ${e.mediaName} is in the current slide`);this.m_slideShowCore.getMediaCurrentState(e.mediaName)||(o=!1),i?o||e.actionType===n.j.CustomPlayButtonClick||r.a.sendTraceTag(506857121,a.a.msoulscat_Wac_PptSession,s.a.Error,`MediaAddon::onUserMediaAction: Received userMediaAction event from media that isn't ready\n          (actionInfo: ${JSON.stringify(e)})`):r.a.sendTraceTag(506857122,a.a.msoulscat_Wac_PptSession,s.a.Error,`MediaAddon::onUserMediaAction: Received userMediaAction event from media that isn't in the current slide\n          (actionInfo: ${JSON.stringify(e)})`),t&&(r.a.sendTraceTag(506857120,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon::onUserMediaAction: Entering Private Viewing mode (actionInfo: ${JSON.stringify(e)})`),this.m_slideShowAppEvents.emit("requestPrivateViewingChanged",{isInPrivateViewing:!0,source:this.m_sourceIdentifier}),i&&(o||e.actionType===n.j.CustomPlayButtonClick)||c.e.recordVeto("Media_VetoedTeamsPrivateViewingUnintentional",{qosVeto:"SharingWrongSlideStateDisplayed",isMediaOnCurrentSlide:i,isMediaReady:o,actionInfo:e}))}updateVideoPlayButtonVisibility(e){this.m_slideShowCore.setVideoPlayButtonVisibility(e)}updateMediaCommandScope(){this.m_slideShowCore.setMediaCommandScope(this.m_slideShowRole===l.i.Presenter?n.c.All:n.c.Local)}constructor(e,t,i,n,a){this.m_slideShowCore=e,this.m_mediaStateMap=new Map,r.a.setLogger(t),this.m_slideShowAppEvents=i,this.m_sourceIdentifier=o.b.Media,this.m_slideShowRole=n,this.m_slideShowUIEvents=a,this.registerAppEventListeners()}}},,function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var n=i(211),r=n.Buffer;function a(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=s),s.prototype=Object.create(r.prototype),a(r,s),s.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,i)},s.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"==typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(9),r=i(3),a=i(7),s=i(17),o=i(13),l=i(27);class d{bindCoreEventsToAddons(e,t,i,n){e.on("userMediaAction",e=>{t.onUserMediaAction(e)}),e.on("slideShowAnnotationEvent",e=>{!n||"pen"!==i.pickToolInputType&&void 0!==i.pickToolInputType||e.eventType!==l.a.WetStrokeStart&&e.eventType!==l.a.LaserStart||i.updateSelectToolOnInstantToolChange(i.activeInkingTool)}),e.on("inkToolStateChanged",e=>{i.updateSelectToolOnInstantToolChange(e.tool)})}switchRole(e){try{n.a.sendTraceTag(506856288,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`SyncAddonsConnector - switchRole is called, role=${e}.`),this.m_inkAddon.enableLocalInking(!0),this.m_inkAddon.inkAddonCore.updateInkCanvasDimensions(),this.m_inkAddon.updateRole(e)}catch(e){n.a.sendTraceTag(506856287,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`SyncAddonsConnector - exception in switchRole: ${e}.`)}}changeTheme(e){this.m_inkAddon.onSlideHighContrastChanged(e)}setInkingActivity(e){this.m_inkAddon.onInkManagerActivity(e)}handleAnnotationEvent(e){this.m_inkAddon.handleAnnotationEvent(e)}static furnishMediaSyncState(e,t,i,n,r,a,s){return{mediaName:e,state:{playerState:r,position:t,muted:n,volume:i,playerPositionSkew:r===o.e.MediaPlayed&&a.Total_Elapsed_MS||0,mediaName:e},origin:{isInitial:a.origin?a.origin.isInitial:s,hostName:a.origin?a.origin.hostName:void 0,eventTrigger:a.mediaEventType,actionType:a.origin?a.origin.actionType:void 0,isFromStateServiceCache:a.isFromStateServiceCache,isFromRoleChange:a.origin?a.origin.isFromRoleChange:void 0},correlationId:a.CorrelationId,metadata:{timeStamps:{PPT_ModernSS_Emit_Media:a.PPT_ModernSS_Emit_Media,Skew_Emitter:a.Skew_Emitte,State_Notified:a.State_Notified,State_Local:a.State_Local,Skew_Receiver:a.Skew_Receiver,PPT_ModernSS_Complete_Media:a.PPT_ModernSS_Complete_Media,Total_Elapsed_MS:a.Total_Elapsed_MS},mediaSyncTimeLine:a.mediaSyncTimeLine,senderID:a.senderId,source:a.source}}}updateMediaState(e){s.f.updateMediaSyncMetadataAndLog("Passing to MediaAddon","PresenterViewApp",e),this.m_mediaAddon.updateMediaStateCache(e)}updateCameraState(e){this.m_cameraAddon&&this.m_cameraAddon.setCameraState(e)}setOpticalZoomState(e,t){this.m_opticalZoomSyncStateHandlerAddon&&this.m_opticalZoomSyncStateHandlerAddon.handleOpticalZoomStateChangeAsync(e,t)}constructor(e,t,i,n,r,a){this.m_mediaAddon=e,this.m_inkAddon=t,this.m_cameraAddon=i,this.m_opticalZoomSyncStateHandlerAddon=a,this.bindCoreEventsToAddons(n,e,t,r)}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return _})),i.d(t,"a",(function(){return S}));var n=i(71),r=i(41),a=i(80),s=i(87),o=i(181);class l{get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}constructor(e=!0){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}}class d{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}reset(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(e){var t;if(!e)return;const i=!this.useStencilGlobalOnly&&!(null===(t=this.stencilMaterial)||void 0===t||!t.enabled);this.enabled=i?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=i?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=i?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=i?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=i?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=i?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=i?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=i?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}constructor(e=!0){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}}class c{reset(){this.enabled=!1,this.mask=255,this.func=c.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=c.KEEP,this.opDepthFail=c.KEEP,this.opStencilDepthPass=c.REPLACE}get stencilFunc(){return this.func}set stencilFunc(e){this.func=e}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(e){this.funcRef=e}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(e){this.funcMask=e}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(e){this.opStencilFail=e}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(e){this.opDepthFail=e}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(e){this.opStencilDepthPass=e}get stencilMask(){return this.mask}set stencilMask(e){this.mask=e}get stencilTest(){return this.enabled}set stencilTest(e){this.enabled=e}constructor(){this.reset()}}c.ALWAYS=519,c.KEEP=7680,c.REPLACE=7681;class h{get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(e,t,i,n){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===i&&this._blendConstants[3]===n||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=i,this._blendConstants[3]=n,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(e,t,i,n){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===i&&this._blendFunctionParameters[3]===n||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=n,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}}var u=i(78),m=i(55),f=i(51),p=i(49),g=i(67);function _(e,t){if(Object(f.d)()){const{requestAnimationFrame:i}=t||window;if("function"==typeof i)return i(e)}else if("function"==typeof requestAnimationFrame)return requestAnimationFrame(e);return setTimeout(e,16)}class S{get frameId(){return this._frameId}get isWebGPU(){return this._isWebGPU}_getShaderProcessor(e){return this._shaderProcessor}get shaderPlatformName(){return this._shaderPlatformName}_clearEmptyResources(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}get useReverseDepthBuffer(){return this._useReverseDepthBuffer}set useReverseDepthBuffer(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?518:515)}setColorWrite(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}_getGlobalDefines(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(this.useExactSrgbConversions?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);{let e="";return this.isNDCHalfZRange&&(e+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}_rebuildInternalTextures(){const e=this._internalTexturesCache.slice();for(const t of e)t._rebuild()}_rebuildRenderTargetWrappers(){const e=this._renderTargetWrapperCache.slice();for(const t of e)t._rebuild()}_rebuildEffects(){for(const e in this._compiledEffects){const t=this._compiledEffects[e];t._pipelineContext=null,t._prepareEffect()}a.a.ResetCache()}_rebuildGraphicsResources(){var e;this.wipeCaches(!0),this._rebuildEffects(),null===(e=this._rebuildComputeEffects)||void 0===e||e.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){r.a.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(e){setTimeout(async()=>{this._clearEmptyResources();const t=this._depthCullingState.depthTest,i=this._depthCullingState.depthFunc,n=this._depthCullingState.depthMask,r=this._stencilState.stencilTest;await e(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=i,this._depthCullingState.depthMask=n,this._stencilState.stencilTest=r,this._flagContextRestored()},0)}get isDisposed(){return this._isDisposed}get snapshotRendering(){return!1}set snapshotRendering(e){}get snapshotRenderingMode(){return 0}set snapshotRenderingMode(e){}getClassName(){return"AbstractEngine"}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get activeRenderLoops(){return this._activeRenderLoops}stopRenderLoop(e){if(!e)return this._activeRenderLoops.length=0,void this._cancelFrame();const t=this._activeRenderLoops.indexOf(e);t>=0&&(this._activeRenderLoops.splice(t,1),0==this._activeRenderLoops.length&&this._cancelFrame())}_cancelFrame(){if(0!==this._frameHandler){const e=this._frameHandler;if(this._frameHandler=0,Object(f.d)()){const{cancelAnimationFrame:t}=this.getHostWindow()||window;if("function"==typeof t)return t(e)}else if("function"==typeof cancelAnimationFrame)return cancelAnimationFrame(e);return clearTimeout(e)}}beginFrame(){this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}_renderLoop(){if(this._frameHandler=0,!this._contextWasLost){let e=!0;(this._isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++)(0,this._activeRenderLoops[e])()}_renderViews(){return!1}_queueNewFrame(e,t){return _(e,t)}runRenderLoop(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(e){this._depthCullingState.depthTest=e}setZOffset(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e}getZOffset(){const e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e}setZOffsetUnits(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e}getZOffsetUnits(){const e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e}getHostWindow(){return Object(f.d)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(e){this._compatibilityMode=!0}_rebuildTextures(){for(const e of this.scenes)e._rebuildTextures();for(const e of this._virtualScenes)e._rebuildTextures()}_releaseRenderTargetWrapper(e){const t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)}get currentViewport(){return this._cachedViewport}setViewport(e,t,i){const n=t||this.getRenderWidth(),r=i||this.getRenderHeight(),a=e.x||0,s=e.y||0;this._cachedViewport=e,this._viewport(a*n,s*r,n*e.width,r*e.height)}createCanvasImage(){return document.createElement("img")}get description(){let e=this.name+this.version;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e}_createTextureBase(e,t,i,a,s=3,o=null,l=null,d,c,h=null,u=null,f=null,p=null,g,_,v){const y="data:"===(e=e||"").substr(0,5),T="blob:"===e.substr(0,5),b=y&&-1!==e.indexOf(";base64,"),w=u||new m.a(this,1);w!==u&&(w.label=e.substring(0,60));const C=e;!this._transformTextureUrl||b||u||h||(e=this._transformTextureUrl(e)),C!==e&&(w._originalUrl=C);const I=e.lastIndexOf(".");let P=p||(I>-1?e.substring(I).toLowerCase():""),E=null;P.indexOf("?")>-1&&(P=P.split("?")[0]);for(const e of S._TextureLoaders)if(e.canLoad(P,g)){E=e;break}a&&a.addPendingData(w),w.url=e,w.generateMipMaps=!t,w.samplingMode=s,w.invertY=i,w._useSRGBBuffer=this._getUseSRGBBuffer(!!v,t),this._doNotHandleContextLost||(w._buffer=h);let x=null;o&&!u&&(x=w.onLoadedObservable.add(o)),u||this._internalTexturesCache.push(w);const k=(i,u)=>{a&&a.removePendingData(w),e===C?(x&&w.onLoadedObservable.remove(x),n.a.UseFallbackTexture&&e!==n.a.FallbackTexture&&this._createTextureBase(n.a.FallbackTexture,t,w.invertY,a,s,null,l,d,c,h,w),i=(i||"Unknown error")+(n.a.UseFallbackTexture?" - Fallback texture was used":""),w.onErrorObservable.notifyObservers({message:i,exception:u}),l&&l(i,u)):(r.a.Warn(`Failed to load ${e}, falling back to ${C}`),this._createTextureBase(C,t,w.invertY,a,s,o,l,d,c,h,w,f,p,g,_,v))};if(E){const t=e=>{E.loadData(e,w,(e,t,i,n,r,o)=>{o?k("TextureLoader failed to load data"):d(w,P,a,{width:e,height:t},w.invertY,!i,n,()=>(r(),!1),s)},_)};h?h instanceof ArrayBuffer?t(new Uint8Array(h)):ArrayBuffer.isView(h)?t(h):l&&l("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(e,e=>t(new Uint8Array(e)),void 0,a?a.offlineProvider:void 0,!0,(e,t)=>{k("Unable to load "+(e&&e.responseURL,t))})}else{const i=e=>{T&&!this._doNotHandleContextLost&&(w._buffer=e),d(w,P,a,e,w.invertY,t,!1,c,s)};!y||b?h&&("string"==typeof h.decoding||h.close)?i(h):S._FileToolsLoadImage(e||"",i,k,a?a.offlineProvider:null,g,w.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof h||h instanceof ArrayBuffer||ArrayBuffer.isView(h)||h instanceof Blob?S._FileToolsLoadImage(h,i,k,a?a.offlineProvider:null,g,w.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):h&&i(h)}return w}_rebuildBuffers(){for(const e of this._uniformBuffers)e._rebuildAfterContextLost()}get _shouldUseHighPrecisionShader(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:Object(f.b)()?document:null}getLoadedTexturesCache(){return this._internalTexturesCache}clearInternalTexturesCache(){this._internalTexturesCache.length=0}getCaps(){return this._caps}resetTextureCache(){for(const e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1}get name(){return this._name}set name(e){this._name=e}static get NpmPackage(){return"babylonjs@7.20.1"}static get Version(){return"7.20.1"}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}setHardwareScalingLevel(e){this._hardwareScalingLevel=e,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(e){this._doNotHandleContextLost=e}get isStencilEnable(){return this._isStencilEnable}getCreationOptions(){return this._creationOptions}resize(e=!1){let t,i;if(this.adaptToDeviceRatio){const e=Object(f.d)()&&window.devicePixelRatio||1,t=this._lastDevicePixelRatio/e;this._lastDevicePixelRatio=e,this._hardwareScalingLevel*=t}if(Object(f.d)()&&Object(f.b)())if(this._renderingCanvas){const e=this._renderingCanvas.getBoundingClientRect?this._renderingCanvas.getBoundingClientRect():{width:this._renderingCanvas.width*this._hardwareScalingLevel,height:this._renderingCanvas.height*this._hardwareScalingLevel};t=this._renderingCanvas.clientWidth||e.width||this._renderingCanvas.width||100,i=this._renderingCanvas.clientHeight||e.height||this._renderingCanvas.height||100}else t=window.innerWidth,i=window.innerHeight;else t=this._renderingCanvas?this._renderingCanvas.width:100,i=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(t/this._hardwareScalingLevel,i/this._hardwareScalingLevel,e)}setSize(e,t,i=!1){if(!this._renderingCanvas)return!1;if(e|=0,t|=0,!i&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t)return!1;if(this._renderingCanvas.width=e,this._renderingCanvas.height=t,this.scenes){for(let e=0;e<this.scenes.length;e++){const t=this.scenes[e];for(let e=0;e<t.cameras.length;e++)t.cameras[e]._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}createRawTexture(e,t,i,n,r,a,s,o,l,d,c){throw Object(u.a)("engine.rawTexture")}createRawCubeTexture(e,t,i,n,r,a,s,o){throw Object(u.a)("engine.rawTexture")}createRawTexture3D(e,t,i,n,r,a,s,o,l,d,c){throw Object(u.a)("engine.rawTexture")}createRawTexture2DArray(e,t,i,n,r,a,s,o,l,d,c){throw Object(u.a)("engine.rawTexture")}_sharedInit(e){this._renderingCanvas=e}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{const e=navigator.userAgent;this.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&Object(f.b)()&&"ontouchend"in document},this._checkForMobile(),Object(f.d)()&&window.addEventListener("resize",this._checkForMobile))}createVideoElement(e){return document.createElement("video")}_reportDrawCall(e=1){var t;null===(t=this._drawCalls)||void 0===t||t.addCount(e,!1)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}_createImageBitmapFromSource(e,t){throw new Error("createImageBitmapFromSource is not implemented")}createImageBitmap(e,t){return createImageBitmap(e,t)}resizeImageBitmap(e,t,i){throw new Error("resizeImageBitmap is not implemented")}getFontOffset(e){throw new Error("getFontOffset is not implemented")}static _CreateCanvas(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);const i=document.createElement("canvas");return i.width=e,i.height=t,i}createCanvas(e,t){return S._CreateCanvas(e,t)}static _FileToolsLoadImage(e,t,i,n,r,a){throw Object(u.a)("FileTools")}_loadFile(e,t,i,n,r,a){const s=Object(g.d)(e,t,i,n,r,a);return this._activeRequests.push(s),s.onCompleteObservable.add(()=>{const e=this._activeRequests.indexOf(s);-1!==e&&this._activeRequests.splice(e,1)}),s}static _FileToolsLoadFile(e,t,i,n,r,a){if(g.a.loadFile)return g.a.loadFile(e,t,i,n,r,a);throw Object(u.a)("FileTools")}dispose(){var e;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),a.a.ResetCache();for(const e of this._activeRequests)e.abort();this._boundRenderFunction=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),Object(f.d)()&&window.removeEventListener("resize",this._checkForMobile);const t=n.a.Instances.indexOf(this);t>=0&&n.a.Instances.splice(t,1),n.a.Instances.length||(n.a.OnEnginesDisposedObservable.notifyObservers(this),n.a.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}static DefaultLoadingScreenFactory(e){throw Object(u.a)("LoadingScreen")}constructor(e,t,i){var r,a,u,m,g,_,S,v,y,T,b,w;this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new l,this._stencilStateComposer=new d,this._stencilState=new c,this._alphaState=new h,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new p.a,this.onCanvasFocusObservable=new p.a,this.onNewSceneAddedObservable=new p.a,this.onResizeObservable=new p.a,this.onCanvasPointerOutObservable=new p.a,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new p.a,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=()=>this._renderLoop(),this.onBeforeShaderCompilationObservable=new p.a,this.onAfterShaderCompilationObservable=new p.a,this.onBeginFrameObservable=new p.a,this.onEndFrameObservable=new p.a,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new p.a,this.onContextRestoredObservable=new p.a,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.onDisposeObservable=new p.a,n.a.Instances.push(this),this.startTime=o.a.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,s.a.SetMatrixPrecision(!!t.useHighPrecisionMatrix),Object(f.c)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=null!==(r=i)&&void 0!==r&&r,t.antialias=null!=e?e:t.antialias,t.deterministicLockstep=null!==(a=t.deterministicLockstep)&&void 0!==a&&a,t.lockstepMaxSteps=null!==(u=t.lockstepMaxSteps)&&void 0!==u?u:4,t.timeStep=null!==(m=t.timeStep)&&void 0!==m?m:1/60,t.audioEngine=null===(g=t.audioEngine)||void 0===g||g,t.stencil=null===(_=t.stencil)||void 0===_||_,this._audioContext=null!==(S=null===(v=t.audioEngineOptions)||void 0===v?void 0:v.audioContext)&&void 0!==S?S:null,this._audioDestination=null!==(y=null===(T=t.audioEngineOptions)||void 0===T?void 0:T.audioDestination)&&void 0!==y?y:null,this.premultipliedAlpha=null===(b=t.premultipliedAlpha)||void 0===b||b,this._doNotHandleContextLost=!!t.doNotHandleContextLost,this._isStencilEnable=!!t.stencil,this.useExactSrgbConversions=null!==(w=t.useExactSrgbConversions)&&void 0!==w&&w;const C=Object(f.d)()&&window.devicePixelRatio||1,I=t.limitDeviceRatio||C;i=i||t.adaptToDeviceRatio||!1,this._hardwareScalingLevel=i?1/Math.min(I,C):1,this._lastDevicePixelRatio=C,this._creationOptions=t}}S._TextureLoaders=[],S._RenderPassIdCounter=0,S._RescalePostProcessFactory=null},function(e,t,i){"use strict";function n(e){let t=1;do{t*=2}while(t<e);return t===e}function r(e,t,i){return e*(1-i)+t*i}function a(e){const t=s(e),i=o(e);return t-e>e-i?i:t}function s(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function o(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)}function l(e,t,i=2){let n;switch(i){case 1:n=o(e);break;case 2:n=a(e);break;case 3:default:n=s(e)}return Math.min(n,t)}i.d(t,"d",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"f",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return l}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return h})),i.d(t,"d",(function(){return l})),i.d(t,"b",(function(){return m})),i.d(t,"f",(function(){return f})),i.d(t,"c",(function(){return u})),i.d(t,"e",(function(){return _}));var n=i(44);function r(e,t){return e?e+"."+t:t}function a(e,t,i,a,s){void 0===s&&(s=4),a&&e.push(Object(n.d)("".concat(r(t,i)),a,s))}function s(e,t,i,a){"boolean"==typeof a&&e.push(Object(n.a)("".concat(r(t,i)),a))}function o(e,t,i,a){"number"==typeof a&&e.push(Object(n.c)("".concat(r(t,i)),a))}var l,d={contractName:"Office.System.Activity",getFields:function(e){var t=[];return a(t,"Activity","CV",e.cV),o(t,"Activity","Duration",e.duration),o(t,"Activity","Count",e.count),o(t,"Activity","AggMode",e.aggMode),s(t,"Activity","Success",e.success),e.result&&t.push.apply(t,function(e){var t=[];return o(t,"Activity.Result","Code",e.code),a(t,"Activity.Result","Type",e.type),o(t,"Activity.Result","Tag",e.tag),s(t,"Activity.Result","IsExpected",e.isExpected),t.push(Object(n.d)("zC.Activity.Result","Office.System.Result")),t}(e.result)),t.push(Object(n.d)("zC.Activity",this.contractName)),t}},c={getFields:function(e){var t=[];return a(t,"User","PrimaryIdentityHash",e.primaryIdentityHash),a(t,"User","PrimaryIdentitySpace",e.primaryIdentitySpace),a(t,"User","TenantId",e.tenantId,1),a(t,"User","TenantGroup",e.tenantGroup,1),s(t,"User","IsAnonymous",e.isAnonymous),s(t,"User","IsSignedIn",e.isSignedIn),t}},h={getFields:function(e){var t=[];return o(t,"UserAction","Id",e.id),a(t,"UserAction","Name",e.name),a(t,"UserAction","CommandSurface",e.commandSurface),a(t,"UserAction","ParentName",e.parentName),a(t,"UserAction","TriggerMethod",e.triggerMethod),o(t,"UserAction","TimeOffsetMs",e.timeOffsetMs),t}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(l||(l={}));var u,m={getFields:function(e){var t=[];return a(t,"App","Name",e.name,1),a(t,"App","Platform",e.platform,1),a(t,"App","Version",e.version,1),t}},f={getFields:function(e){var t=[];return a(t,"Session","Id",e.id,1),a(t,"Session","EcsETag",e.ecsETag,1),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(u||(u={}));var p,g,_={getFields:function(e){var t=[];return a(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,i,r,o;(o=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",o.IsSeen="IsSeen",o.IsTried="IsTried",o.IsKept="IsKept",o.IsRejected="IsRejected",(r=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",r.Commanding="Commanding",r.QAandSummaries="QA and Summaries",r.Collaboration="Collaboration",r.Suggestions="Suggestions",(i=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",i.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return a(t,"Copilot","FeatureActionType",e.featureActionType),s(t,"Copilot","IsUserInitiated",e.isUserInitiated),a(t,"Copilot","FeatureName",e.featureName),a(t,"Copilot","SubFeatureName",e.subFeatureName),a(t,"Copilot","Capability",e.capability),s(t,"Copilot","IsThumbsUp",e.isThumbsUp),a(t,"Copilot","EntryPoint",e.entryPoint),a(t,"Copilot","Verb",e.verb),a(t,"Copilot","InteractionId",e.interactionId),a(t,"Copilot","ConversationId",e.conversationId),t.push(Object(n.d)("zC.".concat("Copilot"),"Office.System.Copilot")),t}}(p||(p={})),function(e){var t;(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return a(t,"Asha","EventType",e.eventType),a(t,"Asha","Pillar",e.pillar),a(t,"Asha","Scenario",e.scenario),a(t,"Asha","Veto",e.veto),a(t,"Asha","Error",e.error),s(t,"Asha","InStaging",e.inStaging),s(t,"Asha","IsSessionEndingError",e.isSessionEndingError),s(t,"Asha","IsIntentional",e.isIntentional),s(t,"Asha","IsInternal",e.isInternal),t.push(Object(n.d)("zC.".concat("Asha"),"Office.System.Asha")),t}}(g||(g={}))},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},function(e,t,i){var n=i(95).Buffer;function r(e,t){this._block=n.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}r.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=n.from(e,t));for(var i=this._block,r=this._blockSize,a=e.length,s=this._len,o=0;o<a;){for(var l=s%r,d=Math.min(a-o,r-l),c=0;c<d;c++)i[l+c]=e[o+c];o+=d,(s+=d)%r==0&&this._update(i)}return this._len+=a,this},r.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var n=(4294967295&i)>>>0,r=(i-n)/4294967296;this._block.writeUInt32BE(r,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var a=this._hash();return e?a.toString(e):a},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=r},function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(9),r=i(3),a=i(7),s=i(1),o=i(81),l=i(4),d=i(53);class c{logFrameData(e){this.m_isAnimating=e.isAnimating}onSlideLocationChanged(e){this.m_startedTests||(window.clearTimeout(this.m_runTestsTimeoutId),window.setTimeout(this.runTestsAsync.bind(this),1e3*s.a.readNumberOrDefault("perfCheckerDelaySec",60)))}async runTestsAsync(){if(this.m_startedTests||this.m_isAnimating)return;this.m_startedTests=!0;const e=navigator.connection;e&&(c.logNetworkInformation(e,!1),e.addEventListener("change",()=>c.logNetworkInformation(e,!0))),s.a.readBooleanOrDefault("cpuSpeedTestEnabled",!0)&&n.a.sendTraceTag(506856918,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon CPU Speed: "+JSON.stringify(c.calculatePI(10))),!s.a.readBooleanOrDefault("networkBandwidthTestEnabled",!1)||e&&e.saveData&&s.a.readBooleanOrDefault("respectSaveDataForTesting",!1)||await this.runNetworkBandwidthTestAsync(),s.a.readBooleanOrDefault("networkRttTestEnabled",!1)&&await c.runNetworkRttTestAsync(this.m_settings.appSettings.serverUrl+"/podhandler.ashx?action=GetSessionUTC&format=jsms"),s.a.readBooleanOrDefault("longRunningFramesTestEnabled",!0)&&await this.longRunningFramesTestAsync()}bootPayloadTest(){try{const e=this.m_settings.bootMetrics&&void 0!==this.m_settings.bootMetrics.aspxTime?this.m_settings.bootMetrics.aspxTime:this.m_settings.appSettings.initTime,t=[];let i=0,s=0,o=0,l=0;for(const d of performance.getEntriesByType("resource")){const h=c.sanitizeUrl(d.name),u=c.getJsonFromPerformanceEntry(d),m=u?u.encodedBodySize:0,f=h.toLowerCase();if("slideshowcore.js"===f||"slideshowcore.min.js"===f||"slideshowapp.js"===f)return i+=m,void n.a.sendTraceTag(506856917,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon Boot Payload: "+JSON.stringify({totalSize:i,bootJsSize:m,jsSize:s,cssSize:o,otherSize:l,timings:t}));if(d.startTime>e){const e={name:h,encodedSize:m,startTime:d.startTime,duration:d.duration};t.push(e),i+=e.encodedSize,h.endsWith(".js")?s+=e.encodedSize:h.endsWith(".css")?o+=e.encodedSize:l+=e.encodedSize}}}catch(e){n.a.sendTraceTag(506856916,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon::bootPayloadTest exception: "+e)}}static sanitizeUrl(e){try{if(!e)return"";const t=document.createElement("a");return t.href=e,t.pathname.substring(t.pathname.lastIndexOf("/")+1)}catch(e){return""}}static logNetworkInformation(e,t){const i={isOnNetworkChanged:t,downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:e.saveData};n.a.sendTraceTag(506856915,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon NetworkInformation: "+JSON.stringify(i))}static calculatePI(e){let t=0,i=0;const n=performance.now();let r=1;for(;i%100||performance.now()-n<e;)t+=4/r,r+=2,t-=4/r,r+=2,i+=1;return{numIterations:i,timeLimitMs:e,pi:t}}async runNetworkBandwidthTestAsync(e=0,t=0){const i=1e3*s.a.readNumberOrDefault("networkEmptyWaitTimeForTestsSec",30);for(const n of performance.getEntriesByType("resource"))if(n.name.indexOf("getitems.ashx")>=0&&performance.now()-n.responseEnd<i)return void(e<100&&(await Object(d.d)(i),await this.runNetworkBandwidthTestAsync(e+1,t)));const o=performance.now(),l="https://cdn.hubblecontent.osi.office.net/getty/publish/transitions/curtainsdata.json?r="+Date.now(),h=new AbortController,u=()=>h.abort();let m,f;this.m_slideshowCore.events.on("slideLocationChanged",u);try{m=await fetch(l,{signal:h.signal})}catch(e){"AbortError"!==e.name&&n.a.sendTraceTag(506856914,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"PerfCheckerAddon Network Bandwidth: unexpected fetch exception: "+e)}m&&(f=await c.waitForPerformanceEntryAsync(l)),this.m_slideshowCore.events.off("slideLocationChanged",u);const p=performance.now();if(!m||!f||200!==m.status)return void(t<3&&(await Object(d.d)(i),await this.runNetworkBandwidthTestAsync(e,t+1)));let g=!1,_=Number(m.headers.get("content-length"));_||(_=814493,g=!0);const S=8*_/1048576,v=(f.responseEnd-f.responseStart)/1e3;n.a.sendTraceTag(506856913,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon Network Bandwidth: "+JSON.stringify({estimatedMbps:S/v,actualTimeMs:Math.round(p-o),guessedContentLength:g,requestData:f}))}static waitForPerformanceEntryAsync(e){return new Promise(t=>{for(const i of performance.getEntriesByType("resource"))if(i.name===e)return void t(c.getJsonFromPerformanceEntry(i));const i=new PerformanceObserver(n=>{const r=n.getEntriesByType("resource");for(const n of r)if(n.name===e)return t(c.getJsonFromPerformanceEntry(n)),void i.disconnect()});i.observe({entryTypes:["resource"]})})}static getJsonFromPerformanceEntry(e){const t=e.toJSON();for(const e in t)"number"==typeof t[e]&&(t[e]=Math.round(t[e])),t.name=void 0;return t}static async runNetworkRttTestAsync(e){let t=0,i=0;for(let n=0;n<5;n+=1){const n=performance.now();200===(await fetch(e)).status&&(t=performance.now()-n,i+=1)}n.a.sendTraceTag(506856912,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon Network Rtt: "+JSON.stringify({rttMs:Math.round(t/i),numSuccess:i,numAttempts:5}))}async longRunningFramesTestAsync(e=0){if(this.m_isAnimating&&e<100)return await Object(d.d)(3e4),void await this.longRunningFramesTestAsync(e+1);const t=performance.now(),i=new o.a({type:"LongRunningFramesTest",ignoreVeto:!0});await this.startMeasuringFramesAsync(t,i,e)}startMeasuringFramesAsync(e,t,i){return new Promise(n=>{requestAnimationFrame(()=>this.measureFrameAsync(e,t,i,n))})}async measureFrameAsync(e,t,i,n){return this.m_isAnimating?(await this.longRunningFramesTestAsync(i),void n()):performance.now()-e>s.a.readNumberOrDefault("longRunningFramesTestTimeLimitMs",1e4)?(t.logFrameData(!1),void n()):(t.logFrameData(!0),void requestAnimationFrame(()=>this.measureFrameAsync(e,t,i,n)))}constructor(e,t,i){this.m_startedTests=!1,this.m_isAnimating=!1,this.m_runTestsTimeoutId=0,this.m_slideshowCore=e;const r=t.slideShowCoreSettings.settings;s.a.load(r?r.slideshowcore:{}),n.a.setLogger(i),l.ChangeGate.initSettings({disabledChangeGates:t.slideShowCoreSettings.disabledChangeGates||""}),this.m_settings=t,e.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),e.events.on("animationStateChanging",this.logFrameData.bind(this)),l.ChangeGate.isChangeGateEnabled("SSC.bootPayloadTest")&&this.bootPayloadTest()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{get underlyingResource(){return this._webGLTexture}setUsage(){}set(e){this._webGLTexture=e}reset(){this._webGLTexture=null,this._MSAARenderBuffers=null}addMSAARenderBuffer(e){this._MSAARenderBuffers||(this._MSAARenderBuffers=[]),this._MSAARenderBuffers.push(e)}releaseMSAARenderBuffers(){if(this._MSAARenderBuffers){for(const e of this._MSAARenderBuffers)this._context.deleteRenderbuffer(e);this._MSAARenderBuffers=null}}getMSAARenderBuffer(e=0){var t,i;return null!==(t=null===(i=this._MSAARenderBuffers)||void 0===i?void 0:i[e])&&void 0!==t?t:null}release(){this.releaseMSAARenderBuffers(),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}constructor(e=null,t){if(this._MSAARenderBuffers=null,this._context=t,!e&&!(e=t.createTexture()))throw new Error("Unable to create webGL texture");this.set(e)}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return f}));var n=i(6),r=i(0),a=i(15),s=i(2),o=i(5),l=i(12);function d(e,t,i){let n=r.f.Zero,l=1,d=0,h=void 0,u=1;const m=new Array;if(t)for(let g=0;g<t.length;g++){var f;const _=t[g],S=_.push instanceof a.a?_.push:new a.a([n.x,n.y,1,n.x+_.push.x,n.y+_.push.y,1]),v=S.measureLength();let y;for(let t=0;t<_.count;t++){const n=(t+1)/_.count,a=S.getPointFromDist(v*n),f=Object(r.p)(l,l*_.scale,n),T=d+_.rotate*n;y=_.recolor instanceof Array?c(_.recolor,n):_.recolor instanceof s.d?_.recolor:void 0;let b=1;y&&_.recolorInterpolate&&(h?y=s.d.InterpolateLinear(h,y,n):b=n);let w=_.opacity;var p;void 0!==w&&_.opacityInterpolate&&(w=Object(r.p)(u,w,n)),(void 0===i||i===g)&&m.push(new o.e(new r.e(e.center.negate(),new r.f(f,f),T,e.center.add(a)),{colorize:!_.recolorSolid&&y?new s.d(y.r,y.g,y.b,y.a*b):void 0,colorMatrix:y&&_.recolorSolid?new r.c(1-b,0,0,0,1-b,0,0,0,1-b):void 0,colorOffset:y&&_.recolorSolid?new r.g(y.r*b,y.g*b,y.b*b):void 0,opacity:y&&_.recolorSolid?(null!==(p=w)&&void 0!==p?p:1)*y.a:w}))}n=S.getPoint(S.getPointCount()-1),l*=_.scale,d+=_.rotate,u=null!==(f=_.opacity)&&void 0!==f?f:1,h=y}return m}function c(e,t){if(e.length<1)return s.d.Transparent;if(e[0].position>t)return e[0].color;for(let i=0;i<e.length-1;i++)if(e[i+1].position>t){const n=e[i].color,r=e[i+1].color,a=t-e[i].position,o=e[i+1].position-e[i].position;return s.d.InterpolateLinear(n,r,Math.max(0,Math.min(1,0==o?0:a/o)))}return e[e.length-1].color}function h(e,t){let i;for(const n of t){const t=n.transform;i=r.d.UnionRect(i,e.transformedBounds(t))}return i}function u(e,t,i){return h(t,d(e,i))}function m(e,t,i,r,a,l,c,h,u,m){const f=e.getGraphicsProcessor();if(!f)throw n.a.Error(506848279,"glContext must be provided");const p=d(a,(h?r.topSlices:r.bottomSlices)||[],u);h||p.reverse();const g=new s.h;e.attachTextureToImage(g,i);const _=o.j.CreateRectangle(l,new s.x(new s.g(g)));_.instances=p,_.style.blendingMode=m?s.a.normal:r.blendingMode,e.tryPrepareItemInWebGlScope(_,f,!0,void 0);const S=!m&&(r.blendingMode==s.a.darken||r.blendingMode==s.a.multiply);e.renderItemInWebGLRenderScope(_,S?s.d.White:s.d.Transparent,{target:t,transform:c}),_.clearCache()}function f(e,t,i,a){if(!e.getGraphicsProcessor())return void n.a.Error(506848278,"glContext must be provided");const c=a?i.topSlices:i.bottomSlices,u=a?i.topFilter:i.bottomFilter;if(0==u||!c||0==c.length)return;const f=e.createTextureRasterizedItem("Effect/Replicate",t,o.b.innerShadow|o.b.softEdges|o.b.border,void 0,void 0,0,o.b.none,3==u?10:1==u?11:12,1,l.e.KeepUntilRelease);let g;if(f){let t=!1;for(let e of c||[])e.recolor instanceof s.b&&(t=!0);const n=r.d.FromSizeAndCenter(f.contentLocation.logicalSize,f.contentLocation.logicalCenter),o=r.d.FromSizeAndCenter(f.contentLocation.physicalSize,f.contentLocation.physicalCenter),u=h(o,d(n,c)),_=i.blendingMode==s.a.darken||i.blendingMode==s.a.multiply?s.d.White:s.d.Transparent;if(u&&!u.isEmpty()){const d=Object(l.o)(u.size);g=new l.b("Effect/Replicate",e,d,l.e.KeepUntilRelease);const h=d.y/u.height,S=new r.e(u.center.negate(),new r.f(h,h),0,g.size.scale(.5));if(t){if(c){const r=new l.b("Effect/ReplicateSlice",e,d,l.e.KeepUntilRelease);for(let l=0;l<c.length;l++){const d=a?l:c.length-1-l,h=c[d].recolor;m(e,r,f,i,n,o,S,a,d,t),p(e,g,0==l?_:void 0,r,h instanceof s.b?h:void 0)}r.release()}}else m(e,g,f,i,n,o,S,a,void 0,t);g&&(g.contentLocation={logicalCenter:n.center.transformPoint(S),logicalSize:n.size.transformVector(S),physicalCenter:g.size.scale(.5),physicalSize:g.size,rotation:0,flipX:!1,flipY:!1})}f.release()}return g}function p(e,t,i,a,l){const d=e.getGraphicsProcessor();if(!d)throw n.a.Error(506848277,"glContext must be provided");const c=new s.x(l),h=new s.h;e.attachTextureToImage(h,a),c.pictureBrush=new s.g(h),c.pictureFillMode=l?s.u.fillMaskedByPicture:s.u.pictureOverFill;const u=o.j.CreateRectangle(r.d.FromSize(t.size),c);e.tryPrepareItemInWebGlScope(u,d,!0,void 0),e.renderItemInWebGLRenderScope(u,i,{target:t}),u.clearCache()}},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.GIF=2]="GIF",e[e.StreamClassic=3]="StreamClassic",e[e.YouTube=4]="YouTube",e[e.Vimeo=5]="Vimeo",e[e.Flip=6]="Flip",e[e.Ted=7]="Ted",e[e.Stream2=8]="Stream2",e[e.SlideShare=9]="SlideShare",e[e.Other=10]="Other"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(11);class r{static stopInkActivityTimer(){if(""!==r.m_currentInkActivity&&0!==r.m_currentInkActivityStart){const e=r.m_sessionTelemetry[r.m_currentInkActivity];r.m_sessionTelemetry[r.m_currentInkActivity]=void 0===e?Date.now()-r.m_currentInkActivityStart:e+Date.now()-r.m_currentInkActivityStart,n.a.recordSessionStats({AnnotationStats:r.m_sessionTelemetry})}}static logInkActivity(e){switch(e){case"InitInk":if(""===r.m_currentInkActivity){const e=Date.now();r.m_sessionTelemetry.InkStart=e,r.m_currentInkActivity="None",r.m_currentInkActivityStart=e,n.a.recordSessionStats({AnnotationStats:r.m_sessionTelemetry})}break;case"SessionEnd":""!==this.m_currentInkActivity&&(r.stopInkActivityTimer(),r.m_sessionTelemetry.InkEnd=Date.now(),n.a.recordSessionStats({AnnotationStats:r.m_sessionTelemetry}),r.m_currentInkActivityStart=0,r.m_currentInkActivity="",r.m_sessionTelemetry={});break;case"ToAttendee":r.stopInkActivityTimer(),r.m_currentInkActivityStart=0;break;case"ToPresenter":""!==r.m_currentInkActivity&&(r.m_currentInkActivityStart=Date.now());break;case"Pen":case"Highlighter":case"Eraser":case"Laser":case"Select":case"None":const t=Date.now();""===r.m_currentInkActivity?(r.m_sessionTelemetry.InkStart=t,r.m_currentInkActivity=e,r.m_currentInkActivityStart=t,n.a.recordSessionStats({AnnotationStats:r.m_sessionTelemetry})):r.m_currentInkActivity!==e&&(r.stopInkActivityTimer(),r.m_currentInkActivity=e,r.m_currentInkActivityStart=Date.now())}}}r.m_currentInkActivity="",r.m_currentInkActivityStart=0,r.m_sessionTelemetry={}},function(e,t,i){"use strict";i.d(t,"b",(function(){return j})),i.d(t,"c",(function(){return Y})),i.d(t,"e",(function(){return Q})),i.d(t,"f",(function(){return ee})),i.d(t,"a",(function(){return ne})),i.d(t,"d",(function(){return re}));var n=i(83),r=i(77),a=i(272),s=i(109),o=i(44),l=function(e){return"number"==typeof e},d=function(){return Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"function"==typeof window.performance.now&&(d=function(){return window.performance.now()});var c=i(29);function h(e){return"object"==typeof e}function u(e,t,i){for(var n="",r="",a=0,s=e;a<s.length;a++){var o=s[a],l=n+r+JSON.stringify(o);if(l.length>t)break;n=l,i.sp+=1,r="\n"}return n}function m(e,t,i,n){f(["Event","Source"],"OTelJS",0,e,t),f(["Event","Name"],i,0,e,t),f(["Event","Time"],n,"dt",e,t),f(["baseData","properties","version"],"OTelJSMin=4.19.5",0,e,t)}function f(e,t,i,n,r){var a,s=t,o=0;if(void 0!==s&&""!==s){switch(l(t)&&(o=6),i){case 3:o=6;break;case 2:o=4;break;case 4:o=8;break;case"dt":o=9;break;case 0:s="string"==typeof s?s.substr(0,25e3):s}if(r){for(var d=n.data,u=n.ext.metadata,m=0;m<e.length-1;){var f=e[m];if(!f)return;if(d[f]){if(!h(d))return}else d[f]={};if(d=d[f],o){var p=u.f||{};p[f]||(p[f]={}),u.f=p,u=p[f]}m++}var g=e[m];h(d)&&!h(d[g])&&(d[g]=s,o&&(u.f=Object(c.a)(Object(c.a)({},u.f),((a={})[g]={t:o},a))))}else{var _=e.join(".");n.data[_]=t,o&&(n.ext.metadata.f[_]={t:o})}}}function p(e,t,i,n){if(0!==e.length&&0!==t.length){var r=i+"?cors=true&w=2&content-type=application/x-json-stream&apikey="+t.join();n.useSendBeacon?function(e,t,i){var n=t.length;if(Boolean(null===navigator||void 0===navigator?void 0:navigator.sendBeacon)){var r=function(e,t){return navigator.sendBeacon(e,t)};if(r(e,u(t,65536,i)))i.ss=i.ss+i.sp;else{for(var a=0;a<n&&r(e,JSON.stringify(t[a]));)a++;i.ss+=a,i.sd=i.sp-a}}else i.sd+=n}(r,e,n.stats):function(e,t,i){var n=u(t,4194304,i),r=new XMLHttpRequest;r.onload=function(){var e=r.responseText;if(e){var t=JSON.parse(e);t.acc&&(i.ss+=parseInt(t.acc,10)),t.rej&&(i.sd+=parseInt(t.rej,10))}},r.onerror=function(){i.sd=i.sp},r.open("POST",e),r.send(n)}(r,e,n.stats)}}var g=function(){var e,t,i,n=[];function r(t,i,n){t&&t.forEach((function(t){var r=t.classification;if(4===r||1===r){var a=t.name.split(".");"zC"!==a[0]&&(i&&a.unshift("Data"),f(a,t.value,t.dataType,n,e))}}))}this.init=function(n,r){var a,s;e=!0===(null===(s=null===(a=r.extensionConfig)||void 0===a?void 0:a.PostChannel)||void 0===s?void 0:s.enableCompoundKey),t=r,i=n},this.enqueue=function(e){return 1===e.t&&(n.push(e),!0)},this.processQueue=function(){var a=[],s={},o=i.uuid(),l=i.stats.pw+1;n.forEach((function(i){var n=i.event.telemetryProperties.ariaTenantToken,d=function(i,n,a,s){var o=i.event,l=o.timestamp,d=(l?new Date(l):new Date).toISOString(),c=o.eventFlags.diagnosticLevel;if(t.enableOptionalEvents||10===c||110===c||120===c){var h=o.eventName,u={name:h,time:d,ver:"4.0",iKey:"o:"+n.substr(0,32),ext:{sdk:{seq:a},metadata:{f:{}}},data:{}};m(u,e,h,d),r(t.persistentDataFields,!1,u),f(["Event","Sequence"],a,2,u,e),f(["Event","Id"],s+"."+a,0,u,e);var p="custom",g=o.eventContract;if(g){var _=g.name;f(["Event","Contract"],_,0,u,e),p+="."+_.toLowerCase().replace(/\./g,"_"),r(g.dataFields,!1,u)}return u.data.baseType=p,r(o.dataFields,!0,u),u}}(i,n,l,o);d&&(a.push(d),s[n]=!0,l+=1)})),p(a,Object.keys(s),t.endpointUrl,i)}},_=!1;function S(e){v(1,e)}function v(e,t){Object(r.b)(e,1,(function(){return"WebSink:"+t}))}var y,T,b,w=function(){function e(e){var t;this.preprocessors=[],this.stats=((t={}).md=0,t.mm=0,t.mn=0,t.q=0,t.po={},t.pw=0,t.wa=0,t.wp=0,t.wd=0,t.wr={},t.ws=0,t.pm=0,t.sp=0,t.ss=0,t.sd=0,t.wh=0,t.pd={},t.d=0,t.b=0,t.s=0,t),this._batchInterval=1e3,this._initialQueueSize=500,this._batchSize=100,this._queue=[],this.enabled=!0,e&&e.queueSize&&(this._initialQueueSize=e.queueSize)}return e.prototype.init=function(e,t){return e.endpointUrl&&t.uuid&&t.getWorker?(e.uploadFrequency&&(this._batchInterval=e.uploadFrequency),e.batchSize&&(this._batchSize=e.batchSize),this._props=e,this._utils=t,!0):(this.enabled=!1,v(0,2),!1)},e.prototype.isInitialized=function(){if(this.enabled){if(this._props)return!0;S(1)}return!1},e.prototype.mergeStats=function(e){var t=this;Object.keys(e).forEach((function(i){l(t.stats[i])?l(e[i])?t.stats[i]+=e[i]:t.stats[i]=e[i]:"wr"===i?Object.keys(e.wr).forEach((function(i){t.stats.wr[i]=t.stats.wr[i]+e.wr||e.wr[i]})):"pd"===i&&Object.keys(e.pd).forEach((function(i){t.stats.pd[i]=t.stats.pd[i]||0+e.pd[i]}))}))},e.prototype.startWorker=function(){var e=this;if(this.isInitialized()){this.stats.s=1;try{this._worker=this._utils.getWorker(),this._worker.addEventListener("message",(function(t){var i=t.data;switch(i.t){case 1:e.handleLoadedMessage();break;case 4:e.mergeStats(i.d);break;case 5:S(i.d);break;default:S(14)}})),this._worker.addEventListener("error",(function(t){S(12),1===e.stats.s&&e.failToStartWorker()})),this._worker.addEventListener("errormessage",(function(e){S(13)}))}catch(e){S(10),this.failToStartWorker()}}},e.prototype.handleLoadedMessage=function(){if(this.isInitialized()){this.stats.s=2,Object(r.b)(2,1,(function(){return"WebSink:Loaded"}));var e={t:2,d:this._props};this._worker.postMessage(e),this.flushQueue()}},e.prototype.failToStartWorker=function(){this.stats.s=4,this.shutdown(!1)},e.prototype.flushQueue=function(){var e=d(),t=this.stats,i=this._queue.slice(0,this._batchSize),n=i.length;this._queue=this._queue.slice(this._batchSize);try{if(n){t.pw+=n;var r={t:3,d:i};this._worker.postMessage(r)}}catch(e){S(11)}finally{var a=d()-e;t.md+=a,a>=t.mm&&(t.mm=a,t.mn=n),this._queueTimeout&&clearTimeout(this._queueTimeout),this._queueTimeout=setTimeout(this.flushQueue.bind(this),this._batchInterval)}},e.prototype.preprocessAndQueueEvent=function(e,t){if(this.enabled){var i=Object(a.c)(e);i.timestamp=i.timestamp||(new Date).getTime();for(var n=0;n<this.preprocessors.length;n++){var r=this.preprocessors[n],s=r.name,l=!1;if(3!==t||"EventThrottler"===s){var c=d();try{l=r.processEvent(i)}catch(e){}var h=d()-c;if(this.stats.pd[s]=this.stats.pd[s]+h||h,!l)return void(this.stats.po[s]=this.stats.po[s]+1||1)}}i.dataFields.push(Object(o.d)("OTelJS.Sink","WebSink")),2===this.stats.s||this._queue.length<this._initialQueueSize?(this.stats.q+=1,this._queue.push({event:i,t:t})):(S(3),this.stats.s=3,this.shutdown(!1))}},e.prototype.sendTelemetryEvent=function(e){this.preprocessAndQueueEvent(e,1)},e.prototype.sendCustomerContent=function(e){this.preprocessAndQueueEvent(e,2)},e.prototype.sendNonStandardEvent=function(e,t){this.preprocessAndQueueEvent(e,t)},e.prototype.shutdown=function(e){if(this.isInitialized())try{this.stats.pm=this._queue.length,function(e,t,i){if(_)Object(r.b)(0,1,(function(){return"OTelJSMin:20"}));else{var n=e.minSinkLimit;n=l(n)?n:500;var a=i.slice(0,n),s=t.minSinkHandlers||[];s.unshift(new g),s.forEach((function(i){i.init(t,e)}));var o=0;try{a.forEach((function(e){var t=!1;s.forEach((function(i){i.enqueue(e)&&(t=!0)})),t||o++})),t.stats.sd+=o,s.forEach((function(e){e.processQueue()})),_=!0}catch(e){Object(r.b)(0,1,(function(){return"OTelJSMin:22"}))}}}(this._props,{uuid:this._utils.uuid,useSendBeacon:e,minSinkHandlers:this._utils.minSinkHandlers,stats:this.stats},this._queue),this._queue=[]}catch(e){S(30)}this.enabled=!1,this._queueTimeout&&clearTimeout(this._queueTimeout)},e}(),C=i(183),I=((y={})[3]="App.Name",y[4]="App.Platform",y[5]="App.Version",y[2]="WAC.Ring",y[1]="Release.AudienceGroup",y),P=function(e){var t,i,n,r=[];function a(e,i,n){var r=!0;if(e)for(var a=0,s=e;a<s.length;a++){var o=s[a],l=o.classification,d=o.dataType,c=o.name;if(l&&4!==l&&1!==l&&2048!==l){r=!1;break}if(i&&3!==d&&1!==d&&2!==d&&"OTelJS.Version"!==c&&"OTelJS.Sink"!==c){r=!1;break}var h=o.name.split(".");"zC"!==h[0]&&(i&&h.unshift("Data"),f(h,o.value,o.dataType,n,t))}return r}this.init=function(e,r){var a,s;t=!0===(null===(s=null===(a=r.extensionConfig)||void 0===a?void 0:a.PostChannel)||void 0===s?void 0:s.enableCompoundKey),i=r,n=e},this.enqueue=function(e){return 3===e.t&&(r.push(e),!0)},this.processQueue=function(){var s=[],o={};r.forEach((function(e){var n=e.event.telemetryProperties.dnmToken;o[n]=!0;var r=function(e,n){var r,s=e.event,o=Object(C.j)(e.event).toISOString(),l=s.eventFlags.diagnosticLevel;if(i.enableOptionalEvents||10===l||110===l||120===l){var d,c,h,u=s.eventName,f={name:u,time:o,ver:"4.0",iKey:"o:"+n.substr(0,32),ext:{sdk:{seq:0},metadata:{f:{}},utc:{eventFlags:2097152}},data:{}};if(m(f,t,u,o),a((d=i.persistentDataFields,c=null===(r=s.telemetryProperties)||void 0===r?void 0:r.dnmAllowedPartA,h=[],c&&c.forEach((function(e){var t=I[e];d.forEach((function(e){t===e.name&&h.push(e)}))})),h),!1,f),f.data.baseType="custom",a(s.dataFields,!0,f))return f}}(e,n);r&&s.push(r)})),p(s,Object.keys(o),e.endpointUrl,n)}},E=i(151),x=i(186),k=i(47);!function(e){e[e.msoulscat_MSOSP_OTelJSInWebWoker=226]="msoulscat_MSOSP_OTelJSInWebWoker"}(T||(T={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose"}(b||(b={}));var M,A=i(57),R=i(268),O=i(269);function F(e){let t=void 0;const i=e.alwaysOnMetadata;if(!i)return t;const n=i.loggableUserId,r=i.sessionId,a=e.sampleRate;return"number"==typeof a&&(t=new O.a,t.setSampleRate(a),n&&t.enableWithIdentifier("PrimaryIdentityHash",n)||r&&t.enableWithIdentifier("SessionId",r))?t:void 0}function D(e,t){return t(526513555,T.msoulscat_MSOSP_OTelJSInWebWoker,b.Warning,"Failed to initialize worker because "+e),{succeeded:!1,failureReason:e}}!function(e){e.WebSinkStat={Bytes:"b",WebWorkerProcessingDuration:"d",MessagingDuration:"md",MaxMessagingDuration:"mm",MaxMessagingDurationNumEvents:"mn",PreprocessingDuration:"pd",PassedToMinSink:"pm",PreprocessedOut:"po",PassedToWebWorker:"pw",Queued:"q",WebWorkerStatus:"s",MinSinkDropped:"sd",MinSinkProcessed:"sp",MinSinkSent:"ss",WebWorkerAccepted:"wa",WebWorkerDropped:"wd",WebWorkerHandlingDuration:"wh",WebWorkerProcessed:"wp",WebWorkerDroppedReason:"wr",WebWorkerSent:"ws"},e.WebWorkerStatus={Uninitialized:0,Initializing:1,Initialized:2,QueueFull:3,Error:4},e.WebSinkError={Uninitialized:1,Initialization:2,QueueFull:3,WorkerInitialization:10,WorkerPostTelemetryEvent:11,WorkerError:12,WorkerErrorMessage:13,WorkerUnhandledMessage:14,WorkerUninitialized:15,MinSinkReused:20,EndpointUrl:21,MinSinkThrows:22,Shutdown:30},e.WebWorkerMessageType={Loaded:1,Initialize:2,TelemetryEvents:3,Stats:4,Error:5}}(M||(M={}));var L=i(252),B=i(270),N=i(271);let V,W,U=!1,z=!1,H=!0,G=void 0;function j(){H=!1}const $={processed:0,conversionDurationMs:0,logDurationMs:0,webSinkBatchSize:0};let q,Z="Office.Online.UserAction",J="Office.Online.Data.Activity";const X=new Promise(e=>{q=e});function Y(){return Boolean(V)}function K(){var e,t;if(!U||!W)return{succeeded:!1,failureReason:"NotEnabled"};Object(A.h)(()=>{});const i=W();if(!i)return{succeeded:!1,failureReason:"NoSettings"};if(!i.ulsLoggingMethods||!i.ulsLoggingMethods.sendTraceTag)return{succeeded:!1,failureReason:"ULSLoggingMethods"};const l=i.ulsLoggingMethods.sendTraceTag;if(Y())return D("WebSinkAlreadyInitialized",l);const d=i.workerUrl;if(!d)return D("WorkerUrl",l);const c=i.telemetryLoggerSettings;if(!c)return D("TelemetrySettings",l);const h=c.ariaEndpointUrl;if(!c.ariaEndpointUrl)return D("AriaUrl",l);const u=c.alwaysOnMetadata;if(!u)return D("AlwaysOnMetadata",l);if(!i.uuid)return D("Uuid",l);i.batchSize&&($.webSinkBatchSize=i.batchSize),Object(r.c)().addListener(ie),c.enableCustomerContent&&(z=!0),function(e,t){e.name?(Z=`Office.${e.name}.Online.UserAction.`,J=`Office.${e.name}.Online.Data.Activity.`):t(541411084,T.msoulscat_MSOSP_OTelJSInWebWoker,b.Verbose,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")}(u,l);const m=Object(n.f)(Object(x.a)(u)),f=new a.a(void 0,void 0,{disableValidation:!0});for(const e of E.a)f.setTenantToken(e.namespace,e.ariaTenant);for(const e of E.b)f.setDNMToken(e.namespace,e.ariaTenant);let p="",g="";var _,S;null!==(e=i.pgContext)&&void 0!==e&&e.userName&&(p=null===(_=i.pgContext)||void 0===_?void 0:_.userName),null!==(t=i.pgContext)&&void 0!==t&&t.userAlias&&(g=null===(S=i.pgContext)||void 0===S?void 0:S.userAlias);const v={context:{UserName:p,UserAlias:g},notificationEventName:k.b,iKey:k.a},y=new w;return y.init({endpointUrl:h,persistentDataFields:m,enableOptionalEvents:!0,extensionConfig:{PostChannel:{enableCompoundKey:!0},PrivacyGuardPlugin:v},minSinkLimit:i.minSinkLimit,batchSize:Object(k.d)(i.batchSize),uploadFrequency:Object(k.d)(i.batchFrequencyMs),custom:{enableDNM:Object(k.d)(c.enableDNM),enableCustomerContent:Object(k.d)(c.enableCustomerContent),enablePG:Object(k.d)(c.enablePG)}},{uuid:i.uuid,getWorker:()=>{const e=new Blob([`try{importScripts('${encodeURI(d)}');}catch(e){self.postMessage("Error loading Worker script")}`],{type:"application/javascript"});if(!i.TrustedTypesPolicy)return new Worker(URL.createObjectURL(e));try{return new Worker(B.a.createScriptURL(URL.createObjectURL(e)))}catch{return new Worker(N.a.createScriptURL(""))}},minSinkHandlers:Object(k.d)(i.enableMinSinkDNM)?[new P({endpointUrl:L.a.PUBLIC})]:[]}),c.samplingIsEnabled&&(function(e,t){const i=F(t);return i&&e.preprocessors.push(i),i}(y,c)||l(541411083,T.msoulscat_MSOSP_OTelJSInWebWoker,b.Warning,"Could not enable sampler")),f.addSink(y),q(f),V={getLogger:()=>f,getWebSink:()=>y,getSettings:()=>i,sendTraceTag:l},Object(A.g)(e=>{!function(e){if(!Y())return;V.sendTraceTag(541411082,T.msoulscat_MSOSP_OTelJSInWebWoker,b.Info,"SendToWorkerApi with "+e.kind);const t=Object(k.c)();let i=void 0;const r=V.getLogger();let a=r.sendTelemetryEvent.bind(r);switch(e.kind){case"addNamespaceMapping":return void r.setTenantToken(e.namespace,e.ariaTenantToken);case"setDNMToken":return void r.setDNMToken(e.namespace,e.ariaTenantToken);case"flush":return;case"shutdown":return void function(){const e=V.getWebSink().stats;H&&function(e,t,i){const n={eventName:"Office.Online.Telemetry.OTelJS.WebSink.Session.Stats",dataFields:[Object(o.c)("Queued",e[M.WebSinkStat.Queued]),Object(o.c)("PassedToWebWorker",e[M.WebSinkStat.PassedToWebWorker]),Object(o.c)("WebWorkerAccepted",e[M.WebSinkStat.WebWorkerAccepted]),Object(o.c)("WebWorkerProcessed",e[M.WebSinkStat.WebWorkerProcessed]),Object(o.c)("WebWorkerDropped",e[M.WebSinkStat.WebWorkerDropped]),Object(o.c)("WebWorkerSent",e[M.WebSinkStat.WebWorkerSent]),Object(o.b)("MessagingDurationMs",e[M.WebSinkStat.MessagingDuration]),Object(o.b)("MaxMessagingDurationMs",e[M.WebSinkStat.MaxMessagingDuration]),Object(o.c)("MaxMessagingDurationNumEvents",e[M.WebSinkStat.MaxMessagingDurationNumEvents]),Object(o.c)("WebSinkBatchSize",t.webSinkBatchSize),Object(o.b)("WebWorkerProcessingDurationMs",e[M.WebSinkStat.WebWorkerProcessingDuration]),Object(o.b)("WebWorkerHandlingDurationMs",e[M.WebSinkStat.WebWorkerHandlingDuration]),Object(o.b)("ConversionDurationMs",t.conversionDurationMs),Object(o.b)("LogDurationMs",t.logDurationMs),Object(o.c)("Bytes",e[M.WebSinkStat.Bytes]),Object(o.c)("WebWorkerStatus",e[M.WebSinkStat.WebWorkerStatus])],eventFlags:{samplingPolicy:s.a.SamplingPolicy.CriticalBusinessImpact,diagnosticLevel:s.a.DiagnosticLevel.RequiredServiceData}};if(e[M.WebSinkStat.PreprocessedOut])for(const t in e[M.WebSinkStat.PreprocessedOut])"EventThrottler"!==t&&"Sampler"!==t&&"DiagnosticLevel"!==t||n.dataFields.push(Object(o.c)("PreprocessedOut."+t,e[M.WebSinkStat.PreprocessedOut][t]));i.sendTelemetryEvent(n)}(e,$,V.getLogger()),V.getWebSink().shutdown(!0),H&&function(e,t,i){const n=JSON.stringify({...t,...e});i(526513554,T.msoulscat_MSOSP_OTelJSInWebWoker,b.Info,n)}(e,$,V.sendTraceTag)}();case"event":i=te(Object(n.e)(e.event),e);break;case"dnm":i=te(Object(n.c)(e.event),e),a=r.sendDirectNumericEvent.bind(r);break;case"cc":i=te(Object(n.b)(e.event),e),a=r.sendCustomerContent.bind(r);break;case"action":i=te(function(e){return null==e.name&&(e.name=Z,null!=e.actionName&&(e.name+=e.actionName)),Object(n.g)(e)}(e.event),e);break;case"activity":i=te(function(e){return null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=J+e.name)),Object(n.a)(e)}(e.event),e);break;case"otel":i=Object(n.h)(e.event);break;case"otelcc":z&&(i=Object(n.h)(e.event),a=r.sendCustomerContent.bind(r));break;case"oteldnm":i=Object(n.h)(e.event),a=r.sendDirectNumericEvent.bind(r)}if(i){const e=Object(k.c)()-t,n=Object(k.c)();a(i);const r=Object(k.c)()-n;$.conversionDurationMs+=e,$.logDurationMs+=r,$.processed+=1}}(e)}),{succeeded:!0}}function Q(e,t){e&&t?(U=!0,W=t,Object(A.h)(()=>K())):(U=!1,W=void 0)}function ee(){const e=K();if(!e.succeeded)return e;const t=V.getWebSink();return t.startWorker(),function(e,t){if(t.wacAriaThrottlingIsEnabled){const i=new R.a("WebSink",e);i.setSingleEventThrottle(Object(k.d)(t.wacAriaSingleEventThrottlePerSec)),i.setTotalEventThrottle(Object(k.d)(t.wacAriaTotalEventsThrottlePerSec));const n=t.otelEventNamesToBeSuppressedCommaSeparated;n&&n.split(",").forEach(e=>{i.setNamedEventThrottle(e,0)}),e.preprocessors.push(i)}}(t,V.getSettings().telemetryLoggerSettings),e}function te(e,t){return e.timestamp=t.timestamp,e}function ie(e){if(!Y())return;const t=e.message();let i=b.Info;const n=e.level;n===s.a.LogLevel.Error?i=b.Error:n===s.a.LogLevel.Warning&&(i=b.Warning),e.category===s.a.Category.Sink&&"WebSink"===t.substring(0,7)&&V.sendTraceTag(540657436,T.msoulscat_MSOSP_OTelJSInWebWoker,i,t)}function ne(e){e&&X.then(t=>{t.addSink(e)})}function re(){if(G)return G.isMeasuresEnabled();if(!U||!W)return!1;const e=W();if(!e)return!1;const t=e.telemetryLoggerSettings;return!!t&&(!t.samplingIsEnabled||(G=F(t),!!G&&G.isMeasuresEnabled()))}},function(e,t,i){var n;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(r,a,s,o){"use strict";var l,d=["","webkit","Moz","MS","ms","o"],c=a.createElement("div"),h=Math.round,u=Math.abs,m=Date.now;function f(e,t,i){return setTimeout(T(e,i),t)}function p(e,t,i){return!!Array.isArray(e)&&(g(e,i[t],i),!0)}function g(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(void 0!==e.length)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function _(e,t,i){var n="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=r.console&&(r.console.warn||r.console.log);return a&&a.call(r.console,n,i),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}:Object.assign;var S=_((function(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;)(!i||i&&void 0===e[n[r]])&&(e[n[r]]=t[n[r]]),r++;return e}),"extend","Use `assign`."),v=_((function(e,t){return S(e,t,!0)}),"merge","Use `assign`.");function y(e,t,i){var n,r=t.prototype;(n=e.prototype=Object.create(r)).constructor=e,n._super=r,i&&l(n,i)}function T(e,t){return function(){return e.apply(t,arguments)}}function b(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function w(e,t){return void 0===e?t:e}function C(e,t,i){g(x(t),(function(t){e.addEventListener(t,i,!1)}))}function I(e,t,i){g(x(t),(function(t){e.removeEventListener(t,i,!1)}))}function P(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function E(e,t){return e.indexOf(t)>-1}function x(e){return e.trim().split(/\s+/g)}function k(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function M(e){return Array.prototype.slice.call(e,0)}function A(e,t,i){for(var n=[],r=[],a=0;a<e.length;){var s=t?e[a][t]:e[a];k(r,s)<0&&n.push(e[a]),r[a]=s,a++}return i&&(n=t?n.sort((function(e,i){return e[t]>i[t]})):n.sort()),n}function R(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),a=0;a<d.length;){if((n=(i=d[a])?i+r:t)in e)return n;a++}}var O=1;function F(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var D="ontouchstart"in r,L=void 0!==R(r,"PointerEvent"),B=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N=["x","y"],V=["clientX","clientY"];function W(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){b(e.options.enable,[e])&&i.handler(t)},this.init()}function U(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,a=1&t&&n-r==0,s=12&t&&n-r==0;i.isFirst=!!a,i.isFinal=!!s,a&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=z(t)),r>1&&!i.firstMultiple?i.firstMultiple=z(t):1===r&&(i.firstMultiple=!1);var a=i.firstInput,s=i.firstMultiple,o=s?s.center:a.center,l=t.center=H(n);t.timeStamp=m(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=q(o,l),t.distance=$(o,l),function(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(r=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}(i,t),t.offsetDirection=j(t.deltaX,t.deltaY);var d,c,h=G(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=u(h.x)>u(h.y)?h.x:h.y,t.scale=s?(d=s.pointers,$((c=n)[0],c[1],V)/$(d[0],d[1],V)):1,t.rotation=s?function(e,t){return q(t[1],t[0],V)+q(e[1],e[0],V)}(s.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,n,r,a,s=e.lastInterval||t,o=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(o>25||void 0===s.velocity)){var l=t.deltaX-s.deltaX,d=t.deltaY-s.deltaY,c=G(o,l,d);n=c.x,r=c.y,i=u(c.x)>u(c.y)?c.x:c.y,a=j(l,d),e.lastInterval=t}else i=s.velocity,n=s.velocityX,r=s.velocityY,a=s.direction;t.velocity=i,t.velocityX=n,t.velocityY=r,t.direction=a}(i,t);var f=e.element;P(t.srcEvent.target,f)&&(f=t.srcEvent.target),t.target=f}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function z(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:h(e.pointers[i].clientX),clientY:h(e.pointers[i].clientY)},i++;return{timeStamp:m(),pointers:t,center:H(t),deltaX:e.deltaX,deltaY:e.deltaY}}function H(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var i=0,n=0,r=0;r<t;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:h(i/t),y:h(n/t)}}function G(e,t,i){return{x:t/e||0,y:i/e||0}}function j(e,t){return e===t?1:u(e)>=u(t)?e<0?2:4:t<0?8:16}function $(e,t,i){i||(i=N);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function q(e,t,i){i||(i=N);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(F(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(F(this.element),this.evWin,this.domHandler)}};var Z={mousedown:1,mousemove:2,mouseup:4};function J(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,W.apply(this,arguments)}y(J,W,{handler:function(e){var t=Z[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var X={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Y={2:"touch",3:"pen",4:"mouse",5:"kinect"},K="pointerdown",Q="pointermove pointerup pointercancel";function ee(){this.evEl=K,this.evWin=Q,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(K="MSPointerDown",Q="MSPointerMove MSPointerUp MSPointerCancel"),y(ee,W,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=X[n],a=Y[e.pointerType]||e.pointerType,s="touch"==a,o=k(t,e.pointerId,"pointerId");1&r&&(0===e.button||s)?o<0&&(t.push(e),o=t.length-1):12&r&&(i=!0),o<0||(t[o]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),i&&t.splice(o,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ie(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,W.apply(this,arguments)}function ne(e,t){var i=M(e.touches),n=M(e.changedTouches);return 12&t&&(i=A(i.concat(n),"identifier",!0)),[i,n]}y(ie,W,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var i=ne.call(this,e,t);12&t&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}});var re={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ae(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},W.apply(this,arguments)}function se(e,t){var i=M(e.touches),n=this.targetIds;if(3&t&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,a,s=M(e.changedTouches),o=[],l=this.target;if(a=i.filter((function(e){return P(e.target,l)})),1===t)for(r=0;r<a.length;)n[a[r].identifier]=!0,r++;for(r=0;r<s.length;)n[s[r].identifier]&&o.push(s[r]),12&t&&delete n[s[r].identifier],r++;return o.length?[A(a.concat(o),"identifier",!0),o]:void 0}function oe(){W.apply(this,arguments);var e=T(this.handler,this);this.touch=new ae(this.manager,e),this.mouse=new J(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function le(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,de.call(this,t)):12&e&&de.call(this,t)}function de(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout((function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)}),2500)}}function ce(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],a=Math.abs(t-r.x),s=Math.abs(i-r.y);if(a<=25&&s<=25)return!0}return!1}y(ae,W,{handler:function(e){var t=re[e.type],i=se.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}),y(oe,W,{handler:function(e,t,i){var n="touch"==i.pointerType,r="mouse"==i.pointerType;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)le.call(this,t,i);else if(r&&ce.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var he=R(c.style,"touchAction"),ue=void 0!==he,me=function(){if(!ue)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){e[i]=!t||r.CSS.supports("touch-action",i)})),e}();function fe(e,t){this.manager=e,this.set(t)}function pe(e){this.options=l({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ge(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function _e(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Se(e,t){var i=t.manager;return i?i.get(e):e}function ve(){pe.apply(this,arguments)}function ye(){ve.apply(this,arguments),this.pX=null,this.pY=null}function Te(){ve.apply(this,arguments)}function be(){pe.apply(this,arguments),this._timer=null,this._input=null}function we(){ve.apply(this,arguments)}function Ce(){ve.apply(this,arguments)}function Ie(){pe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Pe(e,t){return(t=t||{}).recognizers=w(t.recognizers,Pe.defaults.preset),new Ee(e,t)}function Ee(e,t){var i;this.options=l({},Pe.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((i=this).options.inputClass||(L?ee:B?ae:D?oe:J))(i,U),this.touchAction=new fe(this,this.options.touchAction),xe(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function xe(e,t){var i,n=e.element;n.style&&(g(e.options.cssProps,(function(r,a){i=R(n.style,a),t?(e.oldCssProps[i]=n.style[i],n.style[i]=r):n.style[i]=e.oldCssProps[i]||""})),t||(e.oldCssProps={}))}fe.prototype={set:function(e){"compute"==e&&(e=this.compute()),ue&&this.manager.element.style&&me[e]&&(this.manager.element.style[he]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){b(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(E(e,"none"))return"none";var t=E(e,"pan-x"),i=E(e,"pan-y");return t&&i?"none":t||i?t?"pan-x":"pan-y":E(e,"manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,r=E(n,"none")&&!me.none,a=E(n,"pan-y")&&!me["pan-y"],s=E(n,"pan-x")&&!me["pan-x"];if(r){var o=1===e.pointers.length,l=e.distance<2,d=e.deltaTime<250;if(o&&l&&d)return}if(!s||!a)return r||a&&6&i||s&&24&i?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},pe.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(p(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Se(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return p(e,"dropRecognizeWith",this)||(e=Se(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(p(e,"requireFailure",this))return this;var t=this.requireFail;return-1===k(t,e=Se(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(p(e,"dropRequireFailure",this))return this;e=Se(e,this);var t=k(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,i=this.state;function n(i){t.manager.emit(i,e)}i<8&&n(t.options.event+ge(i)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),i>=8&&n(t.options.event+ge(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!b(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},y(ve,pe,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=6&t,r=this.attrTest(e);return n&&(8&i||!r)?16|t:n||r?4&i?8|t:2&t?4|t:2:32}}),y(ye,ve,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push("pan-y"),24&e&&t.push("pan-x"),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,a=e.deltaX,s=e.deltaY;return r&t.direction||(6&t.direction?(r=0===a?1:a<0?2:4,i=a!=this.pX,n=Math.abs(e.deltaX)):(r=0===s?1:s<0?8:16,i=s!=this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return ve.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=_e(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),y(Te,ve,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),y(be,pe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!n||!i||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=f((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=m(),this.manager.emit(this.options.event,this._input)))}}),y(we,ve,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),y(Ce,ve,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ye.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return 30&i?t=e.overallVelocity:6&i?t=e.overallVelocityX:24&i&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&u(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=_e(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),y(Ie,pe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&r&&i){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||$(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&a?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=f((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=f((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Pe.VERSION="2.0.7",Pe.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[we,{enable:!1}],[Te,{enable:!1},["rotate"]],[Ce,{direction:6}],[ye,{direction:6},["swipe"]],[Ie],[Ie,{event:"doubletap",taps:2},["tap"]],[be]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ee.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var n=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var a=0;a<n.length;)i=n[a],2===t.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&14&i.state&&(r=t.curRecognizer=i),a++}},get:function(e){if(e instanceof pe)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(p(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(p(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=k(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var i=this.handlers;return g(x(e),(function(e){i[e]=i[e]||[],i[e].push(t)})),this}},off:function(e,t){if(void 0!==e){var i=this.handlers;return g(x(e),(function(e){t?i[e]&&i[e].splice(k(i[e],t),1):delete i[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var i=a.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&xe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Pe,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ee,Input:W,TouchAction:fe,TouchInput:ae,MouseInput:J,PointerEventInput:ee,TouchMouseInput:oe,SingleTouchInput:ie,Recognizer:pe,AttrRecognizer:ve,Tap:Ie,Pan:ye,Swipe:Ce,Pinch:Te,Rotate:we,Press:be,on:C,off:I,each:g,merge:v,extend:S,assign:l,inherit:y,bindFn:T,prefixed:R}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=Pe,void 0===(n=function(){return Pe}.call(t,i,t,e))||(e.exports=n)}(window,document)},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));const n={};function r(e,t){n[e]=t}function a(e){return n[e]}},function(e,t,i){"use strict";i.d(t,"b",(function(){return m})),i.d(t,"c",(function(){return p})),i.d(t,"a",(function(){return y}));var n=i(0),r=i(86),a=i(5),s=i(2),o=i(12),l=i(28),d=i(75),c=i(62),h=i(6),u=i(30);function m(e,t,i,m){const f=e.getGraphicsProcessor();if(!f)return;const p=t instanceof o.c&&!t.isValidForGraphicsProcessor(f);let T=t;const b=Object(a.c)(i,m);if(b){const f=b.getType();if(f==s.c.image){const r=b;if(r.image){const l=b.wrapMode,d=void 0!==l?l:s.y.clamp,u=e.ensureImageRenderData(r.image);u.state==c.b.deleted?h.a.Error(592472275,"Trying to use deleted texture id:"+r.image.id):u.state==c.b.uninitialized&&h.a.Error(592472276,"Trying to use uninitialized texture id:"+r.image.id);const f=u.texture,g=r.pictureEffects||(i instanceof a.j&&m==a.a.picture?i.style.pictureEffects:void 0);if(u.loader&&i instanceof a.j){var w,C;const e=Object(a.q)(i,!1,n.c.Scale2D(i.transform.scale.abs()));let t=null!==(w=null==e?void 0:e.size.x)&&void 0!==w?w:0,r=null!==(C=null==e?void 0:e.size.y)&&void 0!==C?C:0;for(const e of i.instances||[]){var I,P;const n=Object(a.q)(i,!1,e.transform.toMatrix3());t=Math.max(t,null!==(I=null==n?void 0:n.width)&&void 0!==I?I:0),r=Math.max(t,null!==(P=null==n?void 0:n.height)&&void 0!==P?P:0)}t>0&&r>0&&u.loader.prepareForRenderSize(new n.f(t,r)),T={loader:u.loader,wrapMode:d}}else!p&&t instanceof o.c&&(t==f||f&&t.tag==f.changeTracker.currentUniqueId)||(T=null!=g&&g.hasImpact||!f||f.wrapMode==d?f:f.cloneWithNewWrapMode("ImageWrapResample",e,d,o.e.DisposableCache));if(null!=g&&g.hasImpact){var E;const n=T instanceof o.c?T:null===(E=T)||void 0===E?void 0:E.loader.getTexture(T.wrapMode);if(n){const r=n.changeTracker.currentUniqueId+"/"+g.changeTracker.currentUniqueId+"/"+d;if(t instanceof o.c&&!p&&t.tag==r)T=t;else{var x;const a=e.ensureRenderNode(i).cache.ensureLookupTableTexture(e,m,g.lookupTable),s=null!=g&&g.mask?e.getTextureFromImage(null==g||null===(x=g.mask)||void 0===x?void 0:x.mask):void 0;T=y("Brush/PictureEffects",e,t!=f&&t instanceof o.b?t:void 0,n,g,d,a,s,void 0,void 0,!1,!1),T&&(T.tag=r)}}}}else T=void 0}else if(f==s.c.pattern){let i=-performance.now();t&&!p&&t instanceof o.c&&t.tag==b.pattern||(T=function(e,t,i){if(!e.getGraphicsProcessor())throw h.a.Error(592525326,"Graphics processor not initialized");if(t<0||t>s.k.count)return void h.a.Error(592525327,"pattern out of range");const n=new Uint8Array(64),r=v[t];for(let e=0;e<16;e++){const t=r[e];for(let i=0;i<4;i++){const r=(t&3<<2*i)>>2*i,a=0==r?255:1==r?127:0;n[4*e+i]=a}}const a=o.c.CreateFromByteBuffer("Pattern",e,S,n,l.d.LUMINANCE,s.y.tile,!1,!1,i);return a.tag=t,a}(e,b.pattern,o.e.DisposableCache)),i+=performance.now(),e.getCurrentFramePerformanceSummary().patternTextureCostMs+=i}else if(s.b.IsGradient(f)){let l=-performance.now();if(f==s.c.pathGradient){const c=t instanceof o.b?t:void 0;c&&!p&&c.tag==i.changeTracker.currentUniqueId||(i instanceof a.j?T=function(e,t,i,l,c){const m=e.getGraphicsProcessor();if(!m)throw h.a.Error(592525324,"Graphics processor not initialized");if(l.getType()!=s.c.pathGradient)throw h.a.Error(592525325,"This is not a path gradient");const f=Object(a.q)(i,!1);if(!f||f.isEmpty()||!i.paths)return;const p=f.size.multiply(i.transform.scale.abs()),S=p.scale(Math.min(1,o.h/p.x,o.h/p.y)),v=new n.f(Math.floor(S.x+1),Math.floor(S.y+1)),y=o.b.RecycleOrReplace("PathGradient",t,e,v,c);return y.tag=i.changeTracker.currentUniqueId,function(e,t,i,a,o,l){const c=performance.now(),h=g(i),m=h.colors,f=h.colors.length<4?s.d.Transparent:new s.d(m[m.length-4],m[m.length-3],m[m.length-2],m[m.length-1]),p=e.activateShaderProgram(u.a.gradient);p.begin(t.tryGetBabylonTextureForRenderToTexture(e),f,!1);const S=p.getBabylonEffect(),v=p.getBabylonEngine();if(S.setInt("u_0",1),S.setVector2("u_1",o),S.setVector2("u_2",l),S.setFloatArray("bfrag_0",h.stops),S.setFloatArray4("bfrag_1",h.colors),S.setInt("ufrag_0",0),S.setInt("ufrag_3",i&&i.isGammaCorrected?1:0),S.setInt("ufrag_4",i.blendBellShape?1:0),S.setVector2("ufrag_5",i.blendBellShape||n.f.Zero),a){const e=Object(d.b)();for(const t of a){const i=t.transform.toMatrix3(),n=Object(r.a)(t,e,!0).buffers,a=n.map(e=>v.createVertexBuffer(e));for(let e=0;e<n.length;e++){const t=n[e].length/4-4;v.bindInstancesBuffer(a[e],_,!1),S.setMatrix3x3("u_3",i.m),p.drawQuadInstances(t),v._releaseBuffer(a[e])}}p.disableInstanceAttribute("a_p1"),p.disableInstanceAttribute("a_p2")}p.end(),t.renderCost=performance.now()-c}(m,y,l,i.paths,f.center,f.size.inverse()),y}(e,c,i,b,o.e.DisposableCache):h.a.Error(592525320,"Path gradient only supported on Shape items")),l+=performance.now(),e.getCurrentFramePerformanceSummary().pathGradientTextureCostMs+=l}else{const i=t instanceof o.b?t:void 0;i&&!p&&i.tag==b.changeTracker.currentUniqueId||(T=function(e,t,i,r){const a=e.getGraphicsProcessor();if(!a)throw h.a.Error(592525322,"Graphics processor not initialized");const l=i.getType();if(l!=s.c.linearGradient&&l!=s.c.rectangularGradient&&l!=s.c.radialGradient)throw h.a.Error(592525323,"Unsupported Gradient type");const d=l==s.c.linearGradient||l==s.c.rectangularGradient,c=new n.f(o.l,d?1:o.l),m=l==s.c.linearGradient?"LinearGradient":l==s.c.rectangularGradient?"RectangularGradient":"RadialGradient",f=o.b.RecycleOrReplace(m,t,e,c,r);return f.tag=i.changeTracker.currentUniqueId,function(e,t,i){const r=performance.now(),a=g(i),o=e.activateShaderProgram(u.a.gradient);o.begin(t.tryGetBabylonTextureForRenderToTexture(e),s.d.Black,!1);const l=o.getBabylonEffect();o.setDummyPointerAttribute("a_p1"),o.setDummyPointerAttribute("a_p2"),l.setFloatArray("bfrag_0",a.stops),l.setFloatArray4("bfrag_1",a.colors),l.setInt("u_0",0);const d=i&&i.getType()==s.c.radialGradient;if(l.setInt("ufrag_0",d?1:0),l.setFloat("ufrag_6",i&&i.isGammaCorrected?2.2:1),l.setFloat("ufrag_7",i&&i.alphaGamma),i&&d){const e=i.fillToRect?i.fillToRect.center:new n.f(.5,.5),t=i.fillFromRect?e.subtract(i.fillFromRect.leftTop).divide(i.fillFromRect.size):e;l.setVector2("ufrag_2",t)}l.setInt("ufrag_4",i.blendBellShape?1:0),l.setVector2("ufrag_5",i.blendBellShape||n.f.Zero),o.drawQuads(1),o.end(),t.renderCost=performance.now()-r}(a,f,i),f}(e,i,b,o.e.DisposableCache)),l+=performance.now(),e.getCurrentFramePerformanceSummary().gradientTextureCostMs+=l}}}else T=void 0;return t&&t!=T&&t instanceof o.c&&t.releasePolicy==o.e.DisposableCache&&t.release(),T}const f=new n.f(1024,1024);function p(e,t,i,n,r){const a=e.getGraphicsProcessor();if(!a)throw h.a.Error(592525321,"Graphics processor not initialized");const l=o.b.RecycleOrReplace("FadeMask/Standard",t,e,f,o.e.DisposableCache);return l.tag=r,function(e,t,i,n){const r=performance.now(),a=e.activateShaderProgram(u.a.fade);a.begin(t.tryGetBabylonTextureForRenderToTexture(e),s.d.Black,!1);const o=a.getBabylonEffect();o.setInt("ufrag_0",i),o.setFloat("ufrag_1",n),a.drawQuads(1),a.end(),t.renderCost=performance.now()-r}(a,l,i,n),l}function g(e){const t=e.gradientStops.length,i=new Float32Array(t+2),n=new Float32Array(4*(t+2));for(let r=0;r<t+2;r++){const a=Math.min(Math.max(r-1,0),t-1),s=e.gradientStops[a].color;i[r]=0==r?0:r==t+1?1:e.gradientStops[a].position,n[4*r+0]=s.r,n[4*r+1]=s.g,n[4*r+2]=s.b,n[4*r+3]=s.a}return{stops:i,colors:n}}const _=[{attributeName:"a_p1",attributeSize:4,offset:16},{attributeName:"a_p2",attributeSize:4,offset:32}],S=new n.f(8,8),v=[[255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0],[7,64,29,0,116,0,208,1,64,7,0,29,0,116,1,208],[1,208,0,116,0,29,64,7,208,1,116,0,29,0,7,64],[255,255,3,0,3,0,3,0,3,0,3,0,3,0,3,0],[7,208,29,116,116,29,208,7,208,7,116,29,29,116,7,208],[3,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0],[3,0,0,0,0,3,0,0,3,0,0,0,0,3,0,0],[3,3,0,0,48,48,0,0,3,3,0,0,48,48,0,0],[3,3,48,48,3,3,48,48,3,3,48,48,3,3,48,48],[51,51,12,12,51,51,192,192,51,51,12,12,51,51,192,192],[51,51,204,204,51,51,204,192,51,51,204,204,51,51,192,204],[51,51,204,204,51,51,204,204,51,51,204,204,51,51,204,204],[63,63,204,204,243,243,204,204,63,63,204,204,243,243,204,204],[252,252,207,207,252,252,207,207,252,252,207,207,252,252,207,207],[252,252,255,255,207,207,255,255,252,252,255,255,207,207,255,255],[63,255,255,255,255,63,255,255,63,255,255,255,255,63,255,255],[255,255,255,255,255,255,255,252,255,255,255,255,255,255,252,255],[3,3,12,12,48,48,192,192,3,3,12,12,48,48,192,192],[192,192,48,48,12,12,3,3,192,192,48,48,12,12,3,3],[15,15,60,60,240,240,195,195,15,15,60,60,240,240,195,195],[240,240,60,60,15,15,195,195,240,240,60,60,15,15,195,195],[15,192,63,0,252,0,240,3,192,15,0,63,0,252,3,240],[3,240,0,252,0,63,192,15,240,3,252,0,63,0,15,192],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0],[204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204],[255,255,0,0,255,255,0,0,255,255,0,0,255,255,0,0],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[255,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0],[0,0,0,0,3,3,12,12,48,48,192,192,0,0,0,0],[0,0,0,0,192,192,48,48,12,12,3,3,0,0,0,0],[255,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0],[3,0,3,0,3,0,3,0,0,3,0,3,0,3,0,3],[3,0,0,3,12,0,0,48,192,0,0,192,48,0,0,12],[243,192,240,0,0,240,192,243,207,3,15,0,0,15,3,207],[3,192,12,48,48,12,192,3,3,192,12,48,48,12,192,3],[0,0,192,3,48,204,15,0,0,0,192,3,48,204,15,0],[0,192,0,48,0,12,0,3,192,3,48,12,12,48,3,192],[255,255,3,0,3,0,3,0,255,255,0,3,0,3,0,3],[3,3,204,12,48,48,12,204,3,3,192,12,48,48,204,192],[51,51,204,204,51,51,204,204,255,0,255,0,255,0,255,0],[0,0,192,0,0,3,192,0,0,0,3,0,0,192,3,0],[51,51,0,0,3,0,0,0,3,0,0,0,3,0,0,0],[3,0,0,0,48,48,0,0,0,3,0,0,48,48,0,0],[0,240,3,12,12,3,240,0,0,15,0,48,0,192,0,192],[255,255,60,60,255,255,195,195,255,255,60,60,255,255,195,195],[252,252,3,195,3,255,3,255,252,252,195,3,255,3,255,3],[255,255,3,3,3,3,3,3,255,255,3,3,3,3,3,3],[195,195,60,60,60,60,195,195,195,195,60,60,60,60,195,195],[255,0,255,0,255,0,255,0,0,255,0,255,0,255,0,255],[3,48,12,12,48,3,192,0,48,3,12,12,3,48,0,192],[192,0,240,3,252,15,255,63,252,15,240,3,192,0,0,0]];function y(e,t,i,r,a,s,l,d,c,h,u,m){const f=t.getGraphicsProcessor();if(!f)return;const p=f.isInRenderScope();if(p||f.beginRenderScope()){var g,_,S;const y=null!==(g=null!=h?h:null==c?void 0:c.size)&&void 0!==g?g:r.size,T=o.c.GetRequiredSizeForWrapMode(f,y,s),b=2===(null===(_=t.getBabylonEngine())||void 0===_?void 0:_.webGLVersion)||Object(o.m)(T.x)&&Object(o.m)(T.y),w=o.b.RecycleOrReplace(e,i,t,T,o.e.DisposableCache,{format:r.format,wrapMode:s,isMipMapped:b,disableFiltering:u});w.originalSize=y;const C=c?new n.e(n.f.Zero,c.size.divide(r.originalSize),0,c.leftTop.divide(r.originalSize)).toMatrix3():void 0;if(null!=a&&null!==(S=a.sharpness)&&void 0!==S&&S.hasImpact){var v;const e=new o.b("PictureEffects/Sharpness/BlurIntermediateTexture",t,T,o.e.DisposableCache);e.originalSize=r.originalSize,Object(o.f)(t,r,e,a.sharpness,w,null==a||null===(v=a.mask)||void 0===v?void 0:v.mode,d,a.maskChannel),t.drawTextureToTexture(w,e,o.a.pictureEffects,{pictureEffects:a,lookupTableTexture:l,maskTexture:d,outputStraightAlpha:m}),e.release()}else t.drawTextureToTexture(w,r,o.a.pictureEffects,{pictureEffects:a,lookupTableTexture:l,maskTexture:d,outputStraightAlpha:m,textureTransform:C});return p||f.endRenderScope(),w}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));const n={},r="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t},a=(e,t,i=r)=>{try{n[e]||(n[e]=i.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch{console.info("Skipped duplicate policy creation: "+e)}return n[e]}},function(e,t,i){"use strict";i.d(t,"b",(function(){return I})),i.d(t,"a",(function(){return P})),i.d(t,"c",(function(){return E}));var n=i(0),r=i(2),a=i(5),s=i(25),o=i(12),l=i(28),d=i(75),c=i(33),h=i(6),u=i(37),m=i(68),f=i(15);function p(e,t,i,a){a>0&&a<1?(e.paths=function(e,t,i){const r=new Array(Math.max(e.length,t.length));for(let a=0;a<r.length;a++){const s=a<e.length?e[a]:void 0,o=a<t.length?t[a]:void 0,l=s||o;let d;if(l){if(s&&o){d=new Array(Math.max(s.figures.length,o.figures.length));for(let e=0;e<d.length;e++){const t=e<s.figures.length?s.figures[e]:void 0,n=e<o.figures.length?o.figures[e]:void 0;t&&n?d[e]=v(t,n,s.transform,o.transform,i):t?d[e]=g(t,s.transform,1-i):n&&(d[e]=g(n,o.transform,i))}}else d=l.figures.map(e=>g(e,l.transform,s?1-i:i));r[a]=new f.d({figures:d,fillMode:l.fillMode,lineEnabled:l.lineEnabled,extrusionEnabled:l.extrusionEnabled,transform:n.e.Identity})}else h.a.Error(507910022,"no path")}return r}(t.paths||[],i.paths||[],a),(t.incrementalPath||i.incrementalPath)&&h.a.Error(507910023,"Incremental path interpolation not yet implemented"),e.overlapMode=t.overlapMode,e.mergeMode=t.mergeMode,e.style=function(e,t,i){const a=new r.x,s=e.fillBrush&&!(e.fillBrush instanceof r.v&&e.fillBrush.color.equals(r.d.Transparent)),o=t.fillBrush&&!(t.fillBrush instanceof r.v&&t.fillBrush.color.equals(r.d.Transparent)),l=e.fillBrush instanceof r.g&&!e.pictureBrush?e.fillBrush:s?void 0:e.pictureBrush,d=t.fillBrush instanceof r.g&&!t.pictureBrush?t.fillBrush:o?void 0:t.pictureBrush;if(!l&&!d||y(e.fillBrush,t.fillBrush)||y(e.pictureBrush,t.pictureBrush))if(a.fillBrush=T(e.fillBrush,t.fillBrush,i),e.pictureBrush instanceof r.g&&t.pictureBrush instanceof r.g){const n=T(e.pictureBrush,t.pictureBrush,i);n instanceof r.g||!n?a.pictureBrush=n:h.a.Error(507910021,"Interpolated ImageBrush returned wrong type")}else a.pictureBrush=e.pictureBrush;else if(d){if(a.fillBrush=w(l||e.fillBrush,1-i),a.pictureBrush=w(d,i),l&&d&&e.pictureBrush&&t.pictureBrush&&a.fillBrush instanceof r.g&&a.pictureBrush instanceof r.g){const r=n.f.InterpolateLinear(e.pictureBrush.scale,t.pictureBrush.scale,i),s=n.f.InterpolateLinear(e.pictureBrush.offset,t.pictureBrush.offset,i);a.fillBrush.scale=r,a.pictureBrush.scale=r,a.fillBrush.offset=s,a.pictureBrush.offset=s}}else a.fillBrush=w(t.fillBrush,i),a.pictureBrush=w(l,1-i);return a.lineBrush=T(e.lineBrush,t.lineBrush,i),a.pen=function(e,t,i){if(i>0&&i<1){const r=e.clone();return r.lineWidth=Object(n.p)(e.lineWidth,t.lineWidth,i),r.lineHeight=Object(n.p)(e.lineHeight,t.lineHeight,i),r.miterLimit=Object(n.p)(e.miterLimit,t.miterLimit,i),r.dashOffset=Object(n.p)(e.dashOffset,t.dashOffset,i),r}return i<1?e:t}(e.pen,t.pen,i),a.blendingMode=e.blendingMode,a}(t.style,i.style,a),e.shape3D=t.shape3D,e.clipBounds=t.clipBounds,e.text=t.text,e.textEffectMetrics=t.textEffectMetrics,e.role=t.role,e.effects=function(e,t,i){if(i>0&&i<1){const a=e.clone();return a.glow=function(e,t,i){if(e&&t)return new m.b(r.d.InterpolateLinear(e.color,t.color,i),Object(n.p)(e.radius,t.radius,i));const a=e||t;if(a){const t=a.clone();return t.color=a.color.modulateOpacity(e?1-i:i),t}}(e.glow,t.glow,i),a.shadow=function(e,t,i){if(e&&t)return new m.e(r.d.InterpolateLinear(e.color,t.color,i),Object(n.p)(e.radius,t.radius,i),Object(n.m)(e.angle,t.angle,i,void 0),Object(n.p)(e.distance,t.distance,i),n.f.InterpolateLinear(e.scale,t.scale,i),n.f.InterpolateLinear(e.skew,t.skew,i),i<1?e.alignment:t.alignment,i<1?e.rotateWithShape:t.rotateWithShape,i<1?e.shadowType:t.shadowType);const a=e||t;if(a){const t=a.clone();return t.color=a.color.modulateOpacity(e?1-i:i),t}}(e.shadow,t.shadow,i),a.innerShadow=function(e,t,i){if(e&&t)return new m.c(r.d.InterpolateLinear(e.color,t.color,i),Object(n.p)(e.radius,t.radius,i),Object(n.m)(e.angle,t.angle,i,void 0),Object(n.p)(e.distance,t.distance,i));const a=e||t;if(a){const t=a.clone();return t.color=a.color.modulateOpacity(e?1-i:i),t}}(e.innerShadow,t.innerShadow,i),a.reflection=function(e,t,i){if(e&&t)return new m.d(Object(n.p)(e.radius,t.radius,i),Object(n.p)(e.startAlpha,t.startAlpha,i),Object(n.p)(e.startPosition,t.startPosition,i),Object(n.p)(e.endAlpha,t.endAlpha,i),Object(n.p)(e.endPosition,t.endPosition,i),Object(n.p)(e.distance,t.distance,i));const r=e||t;if(r){const t=r.clone();return t.startAlpha=r.startAlpha*(e?1-i:i),t.endAlpha=r.endAlpha*(e?1-i:i),t}}(e.reflection,t.reflection,i),a.softEdges=function(e,t,i){if(e&&t)return new m.f(Object(n.p)(e.radius,t.radius,i));const r=e||t;r&&(r.clone().radius=r.radius*(e?1-i:i))}(e.softEdges,t.softEdges,i),a.direction=i<1?e.direction:t.direction,a}return i<1?e:t}(t.effects,i.effects,a),e.transform=function(e,t,i){return new n.e(n.f.InterpolateLinear(e.preTranslation,t.preTranslation,i),n.f.InterpolateLinear(e.scale,t.scale,i),Object(n.m)(e.rotation,t.rotation,i,void 0),n.f.InterpolateLinear(e.translation,t.translation,i))}(t.transform,i.transform,a),e.fade=t.fade,e.animationTransform=t.animationTransform,e.fillBoundsOverride=t.fillBoundsOverride,e.scene3D=t.scene3D,e.isHidden=t.isHidden,e.instances=t.instances):function(e,t){e.paths=t.paths,e.incrementalPath=t.incrementalPath,e.overlapMode=t.overlapMode,e.mergeMode=t.mergeMode,e.style=t.style,e.shape3D=t.shape3D,e.clipBounds=t.clipBounds,e.text=t.text,e.textEffectMetrics=t.textEffectMetrics,e.role=t.role,e.effects=t.effects,e.transform=t.transform,e.fade=t.fade,e.animationTransform=t.animationTransform,e.fillBoundsOverride=t.fillBoundsOverride,e.scene3D=t.scene3D,e.isHidden=t.isHidden,e.instances=t.instances}(e,a<1?t:i)}function g(e,t,i){const r=Object(f.h)([e]);if(r){const s=r.center,o=e.points.slice(0);for(let r=0;r<e.getPointCount();r++){var a;const l=r*e.pointDataSize;let d=new n.f((o[l]-s.x)*i+s.x,(o[l+1]-s.y)*i+s.y);d=null!==(a=null==t?void 0:t.transformPoint(d))&&void 0!==a?a:d,o[l]=d.x,o[l+1]=d.y}return new f.a(o,e.isClosed,e.format)}return e}function _(e,t){const i=Math.max(0,Math.min(e.length-1,Math.floor(e.length*t))),r=Math.max(0,Math.min(1,e.length*t-i)),a=e[i];return a.quadraticControl?n.f.InterpolateQuadratic(a.a,a.quadraticControl,a.b,r):n.f.InterpolateLinear(a.a,a.b,r)}function S(e,t){const i=new Array;if(0==e.length)return i;const n=new Array;for(let t=0;t<e.length;t++)n.push(t/e.length);for(let e=0;e<t;e++)n.push(e/t);n.sort((e,t)=>e-t),i.push(e[0].a.x,e[0].a.y,1);for(let t=0;t<n.length;t++){const r=n[t],a=t+1<n.length?n[t+1]:1;if(r!=a){const t=_(e,r),n=_(e,(r+a)/2),s=_(e,a);i.push(n.x+n.x-.5*(t.x+s.x),n.y+n.y-.5*(t.y+s.y),2),i.push(s.x,s.y,1)}}return i}function v(e,t,i,r,a){const s=new Array,o=new Array;e.forEachSegment((e,t,i)=>(s.push({a:e,quadraticControl:t,b:i}),!0),i),t.forEachSegment((e,t,i)=>(o.push({a:e,quadraticControl:t,b:i}),!0),r);const l=S(s,o.length),d=S(o,s.length);if(l.length!=d.length)return h.a.Error(507312322,"interpolateFigure data size mismatch"),e;const c=new Array(l.length);for(let e=0;e<c.length;e++)c[e]=Object(n.p)(l[e],d[e],a);return new f.a(c,e.isClosed&&t.isClosed,f.g.position|f.g.type)}function y(e,t){return e instanceof r.g&&t instanceof r.g&&e.image&&t.image&&e.image.id==t.image.id}function T(e,t,i){if(i>0&&i<1){if(!e&&!t)return;if(!e)return w(t,i);if(!t)return w(e,1-i);if(e instanceof r.v&&t instanceof r.v)return new r.v(r.d.InterpolateLinear(e.color,t.color,i));if(e instanceof r.v&&t instanceof r.e||e instanceof r.e&&t instanceof r.v){const n=e instanceof r.e?e:t,a=e instanceof r.v?e.color:t.color,s=n.clone();return s.gradientStops=n.gradientStops.map(t=>new r.f(t.position,r.d.InterpolateLinear(t.color,a,e instanceof r.e?i:1-i))),s}if(e instanceof r.v&&t instanceof r.j||e instanceof r.j&&t instanceof r.v){const n=e instanceof r.j?e:t,a=e instanceof r.v?e.color:t.color,s=e instanceof r.j?i:1-i;return new r.j(n.pattern,r.d.InterpolateLinear(n.foregroundColor,a,s),r.d.InterpolateLinear(n.backgroundColor,a,s))}if(e instanceof r.e&&t instanceof r.e){const a=new Array(Math.max(e.gradientStops.length,t.gradientStops.length));for(let s=0;s<a.length;s++){const o=b(e.gradientStops,s/(a.length-1)),l=b(t.gradientStops,s/(a.length-1));a[s]=new r.f(Object(n.p)(o.position,l.position,i),r.d.InterpolateLinear(o.color,l.color,i))}const s=new r.e(e.getType(),a);return s.angle=Object(n.m)(e.angle,t.angle,i,void 0),s.fillFromRect=n.d.InterpolateLinear(e.fillFromRect,t.fillFromRect,i),s.fillToRect=n.d.InterpolateLinear(e.fillToRect,t.fillToRect,i),s.rotateWithShape=e.rotateWithShape,s.isStretched=e.isStretched,s.shadeFromTitle=e.shadeFromTitle,s.isGammaCorrected=e.isGammaCorrected,s.blendBellShape=e.blendBellShape,s}if(e instanceof r.g&&t instanceof r.g&&y(e,t)){const r=e.clone();return r.scale=n.f.InterpolateLinear(e.scale,t.scale,i),r.offset=n.f.InterpolateLinear(e.offset,t.offset,i),r.opacity=Object(n.p)(e.opacity,t.opacity,i),r}}return i<1?e:t}function b(e,t){const i=t*(e.length-1),a=Math.floor(i),s=i-a,o=e[Math.min(a,e.length-1)],l=e[Math.min(a+1,e.length-1)];return new r.f(Object(n.p)(o.position,l.position,s),r.d.InterpolateLinear(o.color,l.color,s))}function w(e,t){if(e instanceof r.v)return new r.v(e.color.modulateOpacity(t));if(e instanceof r.e){const i=e.clone();return i.gradientStops=e.gradientStops.map(e=>new r.f(e.position,e.color.modulateOpacity(t))),i}if(e instanceof r.g){const i=e.clone();return i.opacity*=t,i}return e instanceof r.j?new r.j(e.pattern,e.foregroundColor.modulateOpacity(t),e.backgroundColor.modulateOpacity(t)):(h.a.Error(507910020,"Unexpected brush type not interpolated"),e)}var C=i(30);class I{releaseGeneratedResources(){this.texture&&this.texture.releasePolicy==o.e.DisposableCache&&this.texture.release(),this.textureDeltaWhite&&this.textureDeltaWhite.releasePolicy==o.e.DisposableCache&&this.textureDeltaWhite.release(),this.texturePicture&&this.texturePicture.releasePolicy==o.e.DisposableCache&&this.texturePicture.release()}onFinalization(){}constructor(){}}class P{releaseGeneratedResources(){var e;null===(e=this.interpolatedShapeSprite)||void 0===e||e.release()}onFinalization(){}constructor(){}}class E{tryInitMorphKeyFrame(e,t,i){var s,o;const l=e.ensureMorphKeyFrameRenderData(t);if(!(l.texture&&!l.texture.size.isZero()&&l.texture.isValid(e)&&(!l.textureDeltaWhite||l.textureDeltaWhite.isValid(e))&&(!l.texturePicture||l.texturePicture.isValid(e)))&&i&&(l.texture&&(e.fixedMemoryLeakAmounts.pictureCropBWTextures+=l.texture.memoryUsage),l.textureDeltaWhite&&(e.fixedMemoryLeakAmounts.pictureCropBWTextures+=l.textureDeltaWhite.memoryUsage)),i){const i=function(e,t){if(1==t.contents.length){const i=t.contents[0];if(i&&i.item instanceof a.j){const t=i.item.style.pictureBrush;if(t&&t.image){const i=e.getTextureFromImageBrush(t),r=Object(a.o)(t.alignment).multiply(n.f.One.subtract(t.scale)),s=n.d.FromSize(t.scale).translate(r.add(t.offset).subtract(new n.f(.5,.5)));if(i)return{texture:i,pictureRelativeBounds:s}}}}h.a.Error(572073356,"Texture not found")}(e,t);i&&(l.texturePicture=i.texture,l.pictureRelativeBounds=i.pictureRelativeBounds)}if(l.texture&&!l.texture.size.isZero()&&l.texture.isValid(e)&&(!l.textureDeltaWhite||l.textureDeltaWhite.isValid(e)))return!0;let d=void 0;for(let e of t.contents){const i=n.c.FromTransforms(t.parentTransform||n.c.Identity,e.item.animationTransform||n.c.Identity),r=Object(a.p)(e.item,e.includeSubtree||null!=e.textRange,a.b.all,a.b.all,i,e.includeSubtree,e.textRange);d=n.d.UnionRect(d,r)}return null===(s=l.texture)||void 0===s||s.release(),null===(o=l.textureDeltaWhite)||void 0===o||o.release(),d&&(t.location?i?(l.texture=x(e,t,d,r.d.Black),l.textureDeltaWhite=x(e,t,d,r.d.White)):l.texture=x(e,t,d,void 0):h.a.Error(591672911,"No KeyFrame location")),!0}tryPrepareMorphInRenderScope(e,t,i){if(!e.getGraphicsProcessor())return h.a.Error(575942947,"glContext must be provided"),!1;const n=performance.now();e.m_initDeadline=i?n+i:void 0;const r=[];for(const i of t.elements)for(const t of i.keyFrames)if(t){const i=e.ensureMorphKeyFrameRenderData(t);if(!i.texture||i.texture.size.isZero()||!i.texture.isValid(e))for(const e of t.contents){if(e.item instanceof a.j){const t=e.item;if(e.textRange)if(t.text){const i=t.text.getFullRange();i&&i.contains(e.textRange)?e.textRange.equals(i)||t.text.forceSplit(s.m.ByLetter):h.a.Error(591672913,"Text KeyFrame out of range: ["+e.textRange.start+", "+e.textRange.last+"], fullRange: "+(i?"["+i.start+", "+i.last+"]":"undefined"))}else h.a.Error(591672914,"Text KeyFrame on Shape with no Text")}e.item&&!r.find(t=>t==e.item)&&r.push(e.item)}}for(let t of r){const i=e.m_initDeadline?e.m_initDeadline-performance.now():void 0;if(null!=i&&i<=0)return!1;if(!e.tryPrepareItemInWebGlScope(t,e.getGraphicsProcessor(),!0,i))return!1}for(let i of t.elements){const t=M(i);for(let n of i.keyFrames)if(n){if(!this.tryInitMorphKeyFrame(e,n,t))return!1;if(e.initOutOfTime())return!1}}return!0}tryPrepareMorph(e,t,i){const n=e.getGraphicsProcessor();if(!n)return h.a.Error(591672912,"glContext must be provided"),!1;const r=n.isInRenderScope();let a=!1;return(r||n.beginRenderScope())&&(a=this.tryPrepareMorphInRenderScope(e,t,i),r||n.endRenderScope()),a}renderMorph(e,t,i,r,s,l){const u=e.getGraphicsProcessor();if(!u)return void h.a.Error(591672915,"glContext must be provided");if(u&&!u.beginRenderScope())return;const m=u.getBabylonEngine();if(!this.tryPrepareMorph(e,t,void 0))return void h.a.Error(591672916,"failed to initialize Morph");const f=[];for(let r of t.elements){const s=r.keyFrames.length>0&&r.keyFrames[0]?r.keyFrames[0]:void 0,l=r.keyFrames.length>1&&r.keyFrames[1]?r.keyFrames[1]:void 0,g=s?s.location:l?l.location:void 0,_=l?l.location:g,S=e.ensureMorphElementRenderData(r);if(g&&_){if(s&&l&&A(s)&&A(l)){const t=new a.j;p(t,null==s?void 0:s.contents[0].item,null==l?void 0:l.contents[0].item,i),t.text=void 0,e.tryPrepareItemInWebGlScope(t,u,!0,void 0);const n=e.createTextureRasterizedItem("MorphInterpolatedShape",t,a.b.all,S.interpolatedShapeSprite,void 0,0,a.b.none,1,1,o.e.DisposableCache);t.clearCache(),S.interpolatedShapeSprite&&S.interpolatedShapeSprite!=n&&S.interpolatedShapeSprite.release(),S.interpolatedShapeSprite=n,S.layer=new c.b(n,n,void 0,void 0,void 0,void 0)}else{const i=s?e.ensureMorphKeyFrameRenderData(s):void 0,a=l?e.ensureMorphKeyFrameRenderData(l):void 0,o=i?[i.texture,i.textureDeltaWhite,i.texturePicture]:[void 0,void 0,void 0],f=a?[a.texture,a.textureDeltaWhite,a.texturePicture]:[void 0,void 0,void 0],p=S.layer instanceof c.c?[S.layer.textureA,S.layer.textureDeltaWhiteA,S.layer.texturePictureA]:[S.layer?S.layer.textureA:void 0,void 0,void 0],g=S.layer instanceof c.c?[S.layer.textureB,S.layer.textureDeltaWhiteB,S.layer.texturePictureB]:[S.layer?S.layer.textureB:void 0,void 0,void 0];let _=!1;for(let e=0;e<3;e++)p[e]==o[e]&&g[e]==f[e]||(_=!0);if(!S.layer||_){let e,i,a;if(s&&l&&s.morphingGrid&&l.morphingGrid){const t=s.morphingGrid.size.x*s.morphingGrid.size.y*2;s.morphingGrid.size.equals(l.morphingGrid.size)&&t>0&&s.morphingGrid.data.length==t&&l.morphingGrid.data.length==t?(e=m.createVertexBuffer(s.morphingGrid.data),i=m.createVertexBuffer(l.morphingGrid.data),a=d.a.CreateGridXY(u,s.morphingGrid.size.x,s.morphingGrid.size.y,new n.d(-1,-1,1,1))):h.a.Error(591672917,"Wrong morphing grid size")}else(s&&s.morphingGrid||l&&l.morphingGrid)&&h.a.Error(591672918,"Morphing grids should come by pair");o[0]&&f[0]&&o[1]&&f[1]&&o[2]&&f[2]?S.layer=new c.c(o[0],f[0],o[1],f[1],o[2],f[2],e,i,a,t.panVector):S.layer=new c.b(o[0],f[0],e,i,a,t.panVector),S.layer.clientObject=r}}if(S.layer){const a=s?s.zPosition:l?l.zPosition:0,o=l?l.zPosition:a,d=!(s&&l||t.panVector);if(S.layer.progress=d?s?Object(n.h)(3*i,0,1):Object(n.h)(3*i-2,0,1):i,r.snapFade&&(S.layer.progress=S.layer.progress<.5?0:1),S.layer.contentCenter=n.f.InterpolateLinear(g.center,_.center,i),S.layer.contentSize=n.f.InterpolateLinear(g.size,_.size,i),S.layer.contentFlip=n.f.InterpolateLinear(n.f.Flip(g.flipX,g.flipY),n.f.Flip(_.flipX,_.flipY),i),S.layer.contentRotation=Object(n.m)(g.rotation,_.rotation,i,r.rotateClockwise),r.textureUnflip&&(S.layer.textureFlip=new n.f(S.layer.contentFlip.x<0?-1:1,S.layer.contentFlip.y<0?-1:1)),S.layer.depth=Object(n.p)(a,o,i),S.layer instanceof c.c){const t=s?e.ensureMorphKeyFrameRenderData(s).pictureRelativeBounds:void 0,r=l?e.ensureMorphKeyFrameRenderData(l).pictureRelativeBounds:void 0;if(t&&r){const e=new n.d(Object(n.p)(t.left,r.left,i),Object(n.p)(t.top,r.top,i),Object(n.p)(t.right,r.right,i),Object(n.p)(t.bottom,r.bottom,i)),a=S.layer.contentSize,s=e.size.multiply(a);let o=e.center.multiply(a);S.layer.pictureTransformUV=n.c.Translation2D(o.negate()).multiply(n.c.Scale2D(s.inverse()))}else h.a.Error(572073352,"PictureMorphLayer needs pictureCrop"),S.layer.pictureTransformUV=void 0}f.push(S.layer)}}}u.updateViewportSize();const g=l?l.tryGetBabylonTextureForRenderToTexture(u):void 0,_=l?l.size:u.getCurrentViewportSize(),S=u.activateShaderProgram(C.a.shapeRender);S.begin(g,r,!0),c.j&&S.clearAndEnbaleDepthBuffer(),f.sort((e,t)=>e.depth-t.depth);for(let e=0;e<f.length;e++){let i=f[e];i.depthFar=1-e/t.elements.length,i.depthNear=1-(e+.9)/t.elements.length,Object(c.f)(u,i,S,_,s?s.toMatrix3():void 0,void 0)}S.end(),u.endRenderScope()}}function x(e,t,i,s){const d=e.getGraphicsProcessor();if(!d)return void h.a.Error(572073353,"glContext must be provided");if(1==t.contents.length&&t.contents[0].item instanceof a.j){const c=t.contents[0].item,h=Object(a.t)(c);if(h)if(null!=s){if(u.a.readBooleanOrDefault("morphOptimizeFillColorOverride",!1))return o.c.CreateFromByteBuffer("morphOptimizeFillColorOverride",e,n.f.One,new Uint8Array([255*s.r,255*s.g,255*s.g,255*s.a]),l.d.RGBA,r.y.clamp,!0)}else if(u.a.readBooleanOrDefault("morphOptimizeImages",!1)){const r=e.getTextureFromImage(h),s=Object(a.q)(c,!1,t.parentTransform?t.parentTransform.toMatrix3():n.c.Identity);if(r&&s){const n=r.tryUseBabylonTexture(d,void 0,"MorphKeyFrameImgRef");if(n){const a=new o.c("MorphKeyFrameImgRef",e,n,r.size,r.format,r.wrapMode,o.e.ExternallyManaged),l=a.size.divide(s.size);return a.contentLocation={logicalCenter:t.location.center.subtract(i.leftTop).multiply(l),logicalSize:t.location.size.multiply(l),physicalCenter:a.size.scale(.5),physicalSize:a.size,rotation:t.location.rotation-c.transform.rotation,flipX:t.location.flipX,flipY:t.location.flipY},a}}}}const c=Math.min(o.i,o.h/Math.max(i.width,i.height));let m=new o.b("MorphKeyFrame",e,new n.f(Math.max(1,Math.ceil(i.size.x*c)),Math.max(1,Math.ceil(i.size.y*c))),o.e.DisposableCache);const f=new n.e(i.leftTop.negate(),new n.f(c,c));for(let i=0;i<t.contents.length;i++){let o,l,c=t.contents[i];s&&c.item instanceof a.j?(l=c.item.clone(),l.style.pictureBrush=void 0,l.style.fillBrush=new r.v(s),e.tryPrepareItemInWebGlScope(l,d,!0,void 0)||h.a.Error(572073354,"Failed to prepare color clone"),o=l):o=c.item,e.renderItemInWebGLRenderScope(o,0==i?r.d.Transparent:void 0,{target:m,noSubtree:!c.includeSubtree,textRange:c.textRange,transform:n.c.FromTransforms(t.parentTransform||n.c.Identity,n.c.FromTransforms(f))}),l&&l.clearCache()}return t.location?m.contentLocation={logicalCenter:t.location.center.subtract(i.leftTop).scale(c),logicalSize:t.location.size.scale(c),physicalCenter:m.size.scale(.5),physicalSize:m.size,rotation:t.location.rotation,flipX:t.location.flipX,flipY:t.location.flipY}:h.a.Error(572073355,"No KeyFrame location"),m}function k(e){return e.isStretched&&(e.wrapMode==r.y.clamp||void 0===e.wrapMode)&&1==e.rotateWithShape&&1==e.opacity}function M(e){if(u.a.readBooleanOrDefault("morphPictureCrop",!0)&&2==e.keyFrames.length){const t=e.keyFrames[0],i=e.keyFrames[1];if(t&&i&&1==t.contents.length&&1==i.contents.length){const n=t.contents[0],r=i.contents[0];if(n&&r&&n.item instanceof a.j&&r.item instanceof a.j){const t=n.item.style.pictureBrush,i=r.item.style.pictureBrush;if(t&&i&&k(t)&&k(i)&&(e.hasDynamicContent||!t.scale.equals(i.scale)||!t.offset.equals(i.offset)||t.alignment!=i.alignment)&&n.item.transform.scale.sign().equals(r.item.transform.scale.sign()))return!0}}}return!1}function A(e){if(!e.shapeInterpolation||1!=e.contents.length)return!1;const t=e.contents[0];return t.item instanceof a.j&&!t.textRange&&(!t.includeSubtree||!t.item.text)}},function(e,t,i){"use strict";i.d(t,"v",(function(){return w})),i.d(t,"w",(function(){return C})),i.d(t,"q",(function(){return I})),i.d(t,"p",(function(){return P})),i.d(t,"j",(function(){return E})),i.d(t,"s",(function(){return x})),i.d(t,"o",(function(){return k})),i.d(t,"x",(function(){return M})),i.d(t,"A",(function(){return A})),i.d(t,"I",(function(){return R})),i.d(t,"J",(function(){return O})),i.d(t,"H",(function(){return F})),i.d(t,"m",(function(){return D})),i.d(t,"k",(function(){return L})),i.d(t,"n",(function(){return B})),i.d(t,"t",(function(){return N})),i.d(t,"r",(function(){return V})),i.d(t,"l",(function(){return W})),i.d(t,"M",(function(){return z})),i.d(t,"a",(function(){return H})),i.d(t,"b",(function(){return G})),i.d(t,"c",(function(){return j})),i.d(t,"d",(function(){return $})),i.d(t,"K",(function(){return q})),i.d(t,"C",(function(){return X})),i.d(t,"y",(function(){return Y})),i.d(t,"f",(function(){return K})),i.d(t,"B",(function(){return Q})),i.d(t,"e",(function(){return ee})),i.d(t,"h",(function(){return te})),i.d(t,"G",(function(){return ie})),i.d(t,"i",(function(){return ne})),i.d(t,"g",(function(){return re})),i.d(t,"u",(function(){return ae})),i.d(t,"L",(function(){return se})),i.d(t,"E",(function(){return oe})),i.d(t,"F",(function(){return le})),i.d(t,"D",(function(){return de})),i.d(t,"z",(function(){return ce}));var n=i(38),r=i(236),a=i(32),s=i(142),o=n.d,l=n.b.freeze,d=(n.b.seal,n.b.keys),c=String[n.k],h=c.trim,u=c.endsWith,m=c.startsWith,f=Date[n.k].toISOString,p=Array.isArray,g=n.f.toString,_=n.e.toString,S=_[a.c](n.b),v=/-([a-z])/g,y=/([^\w\d_$])/g,T=/^(\d+[\w\d_$])/,b=Object.getPrototypeOf;function w(e,t){return typeof e===t}function C(e){return void 0===e||typeof e===n.l}function I(e){return null===e||C(e)}function P(e){return!I(e)}function E(e,t){return!(!e||!n.e[a.c](e,t))}function x(e){return!(!e||typeof e!==n.j)}function k(e){return!(!e||typeof e!==n.h)}function M(e){var t=e;return t&&N(t)&&(t=(t=(t=t[a.J](v,(function(e,t){return t.toUpperCase()})))[a.J](y,"_"))[a.J](T,(function(e,t){return"_"+t}))),t}function A(e,t){if(e)for(var i in e)n.e[a.c](e,i)&&t[a.c](e,i,e[i])}function R(e,t){var i=!1;return e&&t&&!(i=e===t)&&(i=u?e.endsWith(t):function(e,t){var i=!1,n=t?t[a.x]:0,r=e?e[a.x]:0;if(n&&r&&r>=n&&!(i=e===t)){for(var s=r-1,o=n-1;o>=0;o--){if(e[s]!=t[o])return!1;s--}i=!0}return i}(e,t)),i}function O(e,t){var i=!1;return e&&t&&!(i=e===t)&&(i=m?e.startsWith(t):function(e,t){var i=!1,n=t?t[a.x]:0;if(e&&n&&e[a.x]>=n&&!(i=e===t)){for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;i=!0}return i}(e,t)),i}function F(e,t){return!(!e||!t)&&-1!==e[a.r](t)}function D(e){return!(!e||"[object Date]"!==g[a.c](e))}var L=p||function(e){return!(!e||"[object Array]"!==g[a.c](e))};function B(e){return!(!e||"[object Error]"!==g[a.c](e))}function N(e){return"string"==typeof e}function V(e){return"number"==typeof e}function W(e){return"boolean"==typeof e}function U(e){var t=!1;if(e&&"object"==typeof e){var i=b?b(e):function(e){if(e){if(b)return b(e);var t=e.__proto__||e[n.k]||e.constructor;if(t)return t}return null}(e);i?(i.constructor&&n.e[a.c](i,"constructor")&&(i=i.constructor),t=typeof i===n.h&&_[a.c](i)===S):t=!0}return t}function z(e){if(e)return f?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[a.x]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function H(e,t,i){var n=e[a.x];try{for(var r=0;r<n&&(!(r in e)||-1!==t[a.c](i||e,e[r],r,e));r++);}catch(e){}}function G(e,t,i){if(e){if(e.indexOf)return e.indexOf(t,i);var n=e[a.x],r=i||0;try{for(var s=Math.max(r>=0?r:n-Math.abs(r),0);s<n;s++)if(s in e&&e[s]===t)return s}catch(e){}}return-1}function j(e,t,i){var n;if(e){if(e.map)return e.map(t,i);var r=e[a.x],s=i||e;n=new Array(r);try{for(var o=0;o<r;o++)o in e&&(n[o]=t[a.c](s,e[o],e))}catch(e){}}return n}function $(e,t,i){var n;if(e){if(e.reduce)return e.reduce(t,i);var r=e[a.x],s=0;if(arguments[a.x]>=3)n=arguments[2];else{for(;s<r&&!(s in e);)s++;n=e[s++]}for(;s<r;)s in e&&(n=t(n,e[s],s,e)),s++}return n}function q(e){return e&&(e=h&&e.trim?e.trim():e[a.J]?e[a.J](/^\s+|(?=\s)\s+$/g,s.e):e),e}var Z=!{toString:null}.propertyIsEnumerable("toString"),J=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function X(e){var t=typeof e;if(t===n.h||t===n.j&&null!==e||Object(r.c)("objKeys called on non-object"),!Z&&d)return d(e);var i=[];for(var s in e)e&&n.e[a.c](e,s)&&i[a.H](s);if(Z)for(var o=J[a.x],l=0;l<o;l++)e&&n.e[a.c](e,J[l])&&i[a.H](J[l]);return i}function Y(e,t,i,n){if(o)try{var r={enumerable:!0,configurable:!0};return i&&(r.get=i),n&&(r.set=n),o(e,t,r),!0}catch(e){}return!1}function K(e){return l&&A(e,(function(e,t){(L(t)||x(t))&&l(t)})),Q(e)}var Q=l||function(e){return e};function ee(){var e=Date;return e.now?e.now():(new e).getTime()}function te(e){return B(e)?e[a.D]:s.e}function ie(e,t,i,n,r){var a=i;return e&&((a=e[t])===i||r&&!r(a)||n&&!n(i)||(a=i,e[t]=a)),a}function ne(e,t,i){var n;return e?!(n=e[t])&&I(n)&&(n=C(i)?{}:i,e[t]=n):n=C(i)?{}:i,n}function re(e,t){return I(e)?t:e}function ae(e){return!!e}function se(e){throw new Error(e)}function oe(e,t,i,n,r){e&&t&&i&&(!1!==r||C(e[t]))&&(e[t]=function(e,t){var i=null,n=null;return k(e)?i=e:n=e,function(){var e=arguments;if(i&&(n=i()),n)return n[t][a.b](n,e)}}(i,n))}function le(e,t,i,n){return e&&t&&x(e)&&L(i)&&H(i,(function(i){N(i)&&oe(e,i,t,i,n)})),e}function de(e){return e&&n.a&&(e=Object(n.b)(Object(n.a)({},e))),e}function ce(e,t,i,r,s,o){var l=arguments,d=l[0]||{},c=l[a.x],h=!1,u=1;for(c>0&&W(d)&&(h=d,d=l[u]||{},u++),x(d)||(d={});u<c;u++){var m=l[u],f=L(m),p=x(m);for(var g in m){var _=f&&g in m||p&&n.e[a.c](m,g);if(_){var S=m[g],v=void 0;if(h&&S&&((v=L(S))||U(S))){var y=d[g];v?L(y)||(y=[]):U(y)||(y={}),S=ce(h,y,S)}void 0!==S&&(d[g]=S)}}}return d}},function(e,t,i){"use strict";i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return w})),i.d(t,"a",(function(){return C})),i.d(t,"d",(function(){return k})),i.d(t,"e",(function(){return M}));class n{isValid(e){return!0}process(e,t){let i="";if(this.line){let c=this.line;const h=t.processor;if(h){var n,r,a,s,o,l,d;h.lineProcessor&&(c=h.lineProcessor(c,t.isFragment,t.processingContext));const i=null!==(n=null===(r=t.processor)||void 0===r?void 0:r.attributeKeywordName)&&void 0!==n?n:"attribute",u=t.isFragment&&null!==(a=t.processor)&&void 0!==a&&a.varyingFragmentKeywordName?null===(s=t.processor)||void 0===s?void 0:s.varyingFragmentKeywordName:!t.isFragment&&null!==(o=t.processor)&&void 0!==o&&o.varyingVertexKeywordName?null===(l=t.processor)||void 0===l?void 0:l.varyingVertexKeywordName:"varying";!t.isFragment&&h.attributeProcessor&&this.line.startsWith(i)?c=h.attributeProcessor(this.line,e,t.processingContext):h.varyingProcessor&&(null!==(d=h.varyingCheck)&&void 0!==d&&d.call(h,this.line,t.isFragment)||!h.varyingCheck&&this.line.startsWith(u))?c=h.varyingProcessor(this.line,t.isFragment,e,t.processingContext):h.uniformProcessor&&h.uniformRegexp&&h.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(c=h.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):h.uniformBufferProcessor&&h.uniformBufferRegexp&&h.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(c=h.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):h.textureProcessor&&h.textureRegexp&&h.textureRegexp.test(this.line)?c=h.textureProcessor(this.line,t.isFragment,e,t.processingContext):(h.uniformProcessor||h.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?h.uniformProcessor&&(c=h.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):h.uniformBufferProcessor&&(c=h.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,h.endOfUniformBufferProcessor&&(c=h.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}i+=c+"\n"}return this.children.forEach(n=>{i+=n.process(e,t)}),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),i}constructor(){this.children=[]}}class r{get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(e){this._lines.length=0;for(const t of e){if(!t||"\r"===t)continue;if("#"===t[0]){this._lines.push(t);continue}const e=t.trim();if(!e)continue;if(e.startsWith("//")){this._lines.push(t);continue}const i=e.indexOf(";");if(-1===i)this._lines.push(e);else if(i===e.length-1)e.length>1&&this._lines.push(e);else{const e=t.split(";");for(let t=0;t<e.length;t++){let i=e[t];i&&(i=i.trim(),i&&this._lines.push(i+(t!==e.length-1?";":"")))}}}}constructor(){this._lines=[]}}class a extends n{process(e,t){for(let i=0;i<this.children.length;i++){const n=this.children[i];if(n.isValid(e))return n.process(e,t)}return""}}class s extends n{isValid(e){return this.testExpression.isTrue(e)}}class o{isTrue(e){return!0}static postfixToInfix(e){const t=[];for(const i of e)if(void 0===o._OperatorPriority[i])t.push(i);else{const e=t[t.length-1],n=t[t.length-2];t.length-=2,t.push(`(${n}${i}${e})`)}return t[t.length-1]}static infixToPostfix(e){const t=o._InfixToPostfixCache.get(e);if(t)return t.accessTime=Date.now(),t.result;if(!(e.includes("&&")||e.includes("||")||e.includes(")")||e.includes("(")))return[e];const i=[];let n=-1;const r=()=>{c=c.trim(),""!==c&&(i.push(c),c="")},a=e=>{n<o._Stack.length-1&&(o._Stack[++n]=e)},s=()=>o._Stack[n],l=()=>-1===n?"!!INVALID EXPRESSION!!":o._Stack[n--];let d=0,c="";for(;d<e.length;){const t=e.charAt(d),h=d<e.length-1?e.substr(d,2):"";if("("===t)c="",a(t);else if(")"===t){for(r();-1!==n&&"("!==s();)i.push(l());l()}else if(o._OperatorPriority[h]>1){for(r();-1!==n&&o._OperatorPriority[s()]>=o._OperatorPriority[h];)i.push(l());a(h),d++}else c+=t;d++}for(r();-1!==n;)"("===s()?l():i.push(l());return o._InfixToPostfixCache.size>=o.InfixToPostfixCacheLimitSize&&o.ClearCache(),o._InfixToPostfixCache.set(e,{result:i,accessTime:Date.now()}),i}static ClearCache(){const e=Array.from(o._InfixToPostfixCache.entries()).sort((e,t)=>e[1].accessTime-t[1].accessTime);for(let t=0;t<o.InfixToPostfixCacheCleanupSize;t++)o._InfixToPostfixCache.delete(e[t][0])}}o.InfixToPostfixCacheLimitSize=5e4,o.InfixToPostfixCacheCleanupSize=25e3,o._InfixToPostfixCache=new Map,o._OperatorPriority={")":0,"(":1,"||":2,"&&":3},o._Stack=["","","","","","","","","","","","","","","","","","","",""];class l extends o{isTrue(e){let t=void 0!==e[this.define];return this.not&&(t=!t),t}constructor(e,t=!1){super(),this.define=e,this.not=t}}class d extends o{isTrue(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}class c extends o{isTrue(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}class h extends o{isTrue(e){let t=e[this.define];void 0===t&&(t=this.define);let i=!1;const n=parseInt(t),r=parseInt(this.testValue);switch(this.operand){case">":i=n>r;break;case"<":i=n<r;break;case"<=":i=n<=r;break;case">=":i=n>=r;break;case"==":i=n===r;break;case"!=":i=n!==r}return i}constructor(e,t,i){super(),this.define=e,this.operand=t,this.testValue=i}}var u=i(78),m=i(67);const f=/defined\s*?\((.+?)\)/g,p=/defined\s*?\[(.+?)\]/g,g=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,_=/__decl__/,S=/light\{X\}.(\w*)/g,v=/\{X\}/g,y=[],T=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function b(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}function w(e,t,i,a){var s;null!==(s=t.processor)&&void 0!==s&&s.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),k(e,t,e=>{t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e,t.defines));const s=function(e,t,i){let a=function(e,t){var i;if(null!==(i=t.processor)&&void 0!==i&&i.noPrecision)return e;const n=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=n?"precision highp float;\n"+e:"precision mediump float;\n"+e:n||(e=e.replace("precision highp float","precision mediump float")),e}(e,t);if(!t.processor)return a;if(0===t.processor.shaderLanguage&&-1!==a.indexOf("#version 3")&&(a=a.replace("#version 300 es",""),!t.processor.parseGLES3))return a;const s=t.defines,o=function(e,t){var i;const n=e.defines,r={};for(const e of n){const t=e.replace("#define","").replace(";","").trim().split(" ");r[t[0]]=t.length>1?t[1]:""}return 0===(null===(i=e.processor)||void 0===i?void 0:i.shaderLanguage)&&(r.GL_ES="true"),r.__VERSION__=e.version,r[e.platformName]="true",Object(m.c)(r,null==t?void 0:t.isNDCHalfZRange,null==t?void 0:t.useReverseDepthBuffer,null==t?void 0:t.useExactSrgbConversions),r}(t,i);return t.processor.preProcessor&&(a=t.processor.preProcessor(a,s,o,t.isFragment,t.processingContext)),a=function(e,t,i){const a=new n,s=new r;return s.lineIndex=-1,s.lines=e.split("\n"),x(s,a),a.process(t,i)}(a,o,t),t.processor.postProcessor&&(a=t.processor.postProcessor(a,s,t.isFragment,t.processingContext,i?{drawBuffersExtensionDisabled:!i.getCaps().drawBuffersExtension}:{})),null!=i&&i._features.needShaderCodeInlining&&(a=i.inlineShaderCode(a)),a}(e,t,a);i(s,e)})}function C(e,t,i){return i.processor&&i.processor.finalizeShaders?i.processor.finalizeShaders(e,t,i.processingContext):{vertexCode:e,fragmentCode:t}}function I(e){const t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new l(t[1].trim(),"!"===e[0]);const i=["==","!=",">=","<=","<",">"];let n="",r=0;for(n of i)if(r=e.indexOf(n),r>-1)break;if(-1===r)return new l(e);const a=e.substring(0,r).trim(),s=e.substring(r+n.length).trim();return new h(a,n,s)}function P(e,t){const i=new s,n=e.substring(0,t);let r=e.substring(t);return r=r.substring(0,(r.indexOf("//")+1||r.length+1)-1).trim(),i.testExpression="#ifdef"===n?new l(r):"#ifndef"===n?new l(r,!0):function(e){e=e.replace(f,"defined[$1]");const t=o.infixToPostfix(e),i=[];for(const e of t)if("||"!==e&&"&&"!==e)i.push(e);else if(i.length>=2){let t=i[i.length-1],n=i[i.length-2];i.length-=2;const r="&&"==e?new c:new d;"string"==typeof t&&(t=t.replace(p,"defined($1)")),"string"==typeof n&&(n=n.replace(p,"defined($1)")),r.leftOperand="string"==typeof n?I(n):n,r.rightOperand="string"==typeof t?I(t):t,i.push(r)}let n=i[i.length-1];return"string"==typeof n&&(n=n.replace(p,"defined($1)")),"string"==typeof n?I(n):n}(r),i}function E(e,t,i){let r=e.currentLine;for(;x(e,i);){r=e.currentLine;const a=r.substring(0,5).toLowerCase();if("#else"===a){const i=new n;return t.children.push(i),void x(e,i)}if("#elif"===a){const e=P(r,5);t.children.push(e),i=e}}}function x(e,t){for(;e.canRead;){e.lineIndex++;const i=e.currentLine;if(i.indexOf("#")>=0){const n=T.exec(i);if(n&&n.length){switch(n[0]){case"#ifdef":{const n=new a;t.children.push(n);const r=P(i,6);n.children.push(r),E(e,n,r);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const n=new a;t.children.push(n);const r=P(i,7);n.children.push(r),E(e,n,r);break}case"#if":{const n=new a,r=P(i,3);t.children.push(n),n.children.push(r),E(e,n,r);break}}continue}}const r=new n;if(r.line=i,t.children.push(r),"#"===i[0]&&"d"===i[1]){const e=i.replace(";","").split(" ");r.additionalDefineKey=e[1],3===e.length&&(r.additionalDefineValue=e[2])}}return!1}function k(e,t,i){let n;for(y.length=0;null!==(n=g.exec(e));)y.push(n);let r=String(e),a=[e],s=!1;for(const e of y){let n=e[1];if(-1!==n.indexOf("__decl__")&&(n=n.replace(_,""),t.supportsUniformBuffers&&(n=n.replace("Vertex","Ubo").replace("Fragment","Ubo")),n+="Declaration"),!t.includesShadersStore[n]){const e=t.shadersRepository+"ShadersInclude/"+n+".fx";return void M.loadFile(e,e=>{t.includesShadersStore[n]=e,k(a.join(""),t,i)})}{let i=t.includesShadersStore[n];if(e[2]){const t=e[3].split(",");for(let e=0;e<t.length;e+=2){const n=new RegExp(t[e],"g"),r=t[e+1];i=i.replace(n,r)}}if(e[4]){const n=e[5];if(-1!==n.indexOf("..")){const e=n.split(".."),r=parseInt(e[0]);let a=parseInt(e[1]),s=i.slice(0);i="",isNaN(a)&&(a=t.indexParameters[e[1]]);for(let e=r;e<a;e++)t.supportsUniformBuffers||(s=s.replace(S,(e,t)=>t+"{X}")),i+=s.replace(v,e.toString())+"\n"}else t.supportsUniformBuffers||(i=i.replace(S,(e,t)=>t+"{X}")),i=i.replace(v,n)}const r=[];for(const t of a){const n=t.split(e[0]);for(let e=0;e<n.length-1;e++)r.push(n[e]),r.push(i);r.push(n[n.length-1])}a=r,s=s||i.indexOf("#include<")>=0||i.indexOf("#include <")>=0}}y.length=0,r=a.join(""),s?k(r.toString(),t,i):i(r)}const M={loadFile:(e,t,i,n,r,a)=>{throw Object(u.a)("FileTools")}}},function(e,t,i){(function(e,i){var n="[object Arguments]",r="[object Map]",a="[object Object]",s="[object Set]",o=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[n]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[r]=d["[object Number]"]=d[a]=d["[object RegExp]"]=d[s]=d["[object String]"]=d["[object WeakMap]"]=!1;var c="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,u=c||h||Function("return this")(),m=t&&!t.nodeType&&t,f=m&&"object"==typeof i&&i&&!i.nodeType&&i,p=f&&f.exports===m,g=p&&c.process,_=function(){try{return g&&g.binding&&g.binding("util")}catch(e){}}(),S=_&&_.isTypedArray;function v(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}function y(e){var t=-1,i=Array(e.size);return e.forEach((function(e,n){i[++t]=[n,e]})),i}function T(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}var b,w,C,I=Array.prototype,P=Function.prototype,E=Object.prototype,x=u["__core-js_shared__"],k=P.toString,M=E.hasOwnProperty,A=(b=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+b:"",R=E.toString,O=RegExp("^"+k.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=p?u.Buffer:void 0,D=u.Symbol,L=u.Uint8Array,B=E.propertyIsEnumerable,N=I.splice,V=D?D.toStringTag:void 0,W=Object.getOwnPropertySymbols,U=F?F.isBuffer:void 0,z=(w=Object.keys,C=Object,function(e){return w(C(e))}),H=fe(u,"DataView"),G=fe(u,"Map"),j=fe(u,"Promise"),$=fe(u,"Set"),q=fe(u,"WeakMap"),Z=fe(Object,"create"),J=Se(H),X=Se(G),Y=Se(j),K=Se($),Q=Se(q),ee=D?D.prototype:void 0,te=ee?ee.valueOf:void 0;function ie(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function ne(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function re(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function ae(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new re;++t<i;)this.add(e[t])}function se(e){var t=this.__data__=new ne(e);this.size=t.size}function oe(e,t){for(var i=e.length;i--;)if(ve(e[i][0],t))return i;return-1}function le(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":V&&V in Object(e)?function(e){var t=M.call(e,V),i=e[V];try{e[V]=void 0;var n=!0}catch(e){}var r=R.call(e);return n&&(t?e[V]=i:delete e[V]),r}(e):function(e){return R.call(e)}(e)}function de(e){return Pe(e)&&le(e)==n}function ce(e,t,i,o,l){return e===t||(null==e||null==t||!Pe(e)&&!Pe(t)?e!=e&&t!=t:function(e,t,i,o,l,d){var c=Te(e),h=Te(t),u=c?"[object Array]":ge(e),m=h?"[object Array]":ge(t),f=(u=u==n?a:u)==a,p=(m=m==n?a:m)==a,g=u==m;if(g&&be(e)){if(!be(t))return!1;c=!0,f=!1}if(g&&!f)return d||(d=new se),c||Ee(e)?he(e,t,i,o,l,d):function(e,t,i,n,a,o,l){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new L(e),new L(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ve(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case r:var d=y;case s:var c=1&n;if(d||(d=T),e.size!=t.size&&!c)return!1;var h=l.get(e);if(h)return h==t;n|=2,l.set(e,t);var u=he(d(e),d(t),n,a,o,l);return l.delete(e),u;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,u,i,o,l,d);if(!(1&i)){var _=f&&M.call(e,"__wrapped__"),S=p&&M.call(t,"__wrapped__");if(_||S){var v=_?e.value():e,b=S?t.value():t;return d||(d=new se),l(v,b,i,o,d)}}return!!g&&(d||(d=new se),function(e,t,i,n,r,a){var s=1&i,o=ue(e),l=o.length;if(l!=ue(t).length&&!s)return!1;for(var d=l;d--;){var c=o[d];if(!(s?c in t:M.call(t,c)))return!1}var h=a.get(e);if(h&&a.get(t))return h==t;var u=!0;a.set(e,t),a.set(t,e);for(var m=s;++d<l;){var f=e[c=o[d]],p=t[c];if(n)var g=s?n(p,f,c,t,e,a):n(f,p,c,e,t,a);if(!(void 0===g?f===p||r(f,p,i,n,a):g)){u=!1;break}m||(m="constructor"==c)}if(u&&!m){var _=e.constructor,S=t.constructor;_==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof S&&S instanceof S||(u=!1)}return a.delete(e),a.delete(t),u}(e,t,i,o,l,d))}(e,t,i,o,ce,l))}function he(e,t,i,n,r,a){var s=1&i,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var d=a.get(e);if(d&&a.get(t))return d==t;var c=-1,h=!0,u=2&i?new ae:void 0;for(a.set(e,t),a.set(t,e);++c<o;){var m=e[c],f=t[c];if(n)var p=s?n(f,m,c,t,e,a):n(m,f,c,e,t,a);if(void 0!==p){if(p)continue;h=!1;break}if(u){if(!v(t,(function(e,t){if(s=t,!u.has(s)&&(m===e||r(m,e,i,n,a)))return u.push(t);var s}))){h=!1;break}}else if(m!==f&&!r(m,f,i,n,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function ue(e){return function(e,t,i){var n=t(e);return Te(e)?n:function(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e}(n,i(e))}(e,xe,pe)}function me(e,t){var i,n,r=e.__data__;return("string"==(n=typeof(i=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof t?"string":"hash"]:r.map}function fe(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ie(e)||function(e){return!!A&&A in e}(e))&&(we(e)?O:o).test(Se(e))}(i)?i:void 0}ie.prototype.clear=function(){this.__data__=Z?Z(null):{},this.size=0},ie.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ie.prototype.get=function(e){var t=this.__data__;if(Z){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return M.call(t,e)?t[e]:void 0},ie.prototype.has=function(e){var t=this.__data__;return Z?void 0!==t[e]:M.call(t,e)},ie.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Z&&void 0===t?"__lodash_hash_undefined__":t,this},ne.prototype.clear=function(){this.__data__=[],this.size=0},ne.prototype.delete=function(e){var t=this.__data__,i=oe(t,e);return!(i<0||(i==t.length-1?t.pop():N.call(t,i,1),--this.size,0))},ne.prototype.get=function(e){var t=this.__data__,i=oe(t,e);return i<0?void 0:t[i][1]},ne.prototype.has=function(e){return oe(this.__data__,e)>-1},ne.prototype.set=function(e,t){var i=this.__data__,n=oe(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this},re.prototype.clear=function(){this.size=0,this.__data__={hash:new ie,map:new(G||ne),string:new ie}},re.prototype.delete=function(e){var t=me(this,e).delete(e);return this.size-=t?1:0,t},re.prototype.get=function(e){return me(this,e).get(e)},re.prototype.has=function(e){return me(this,e).has(e)},re.prototype.set=function(e,t){var i=me(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this},ae.prototype.add=ae.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ae.prototype.has=function(e){return this.__data__.has(e)},se.prototype.clear=function(){this.__data__=new ne,this.size=0},se.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var i=this.__data__;if(i instanceof ne){var n=i.__data__;if(!G||n.length<199)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new re(n)}return i.set(e,t),this.size=i.size,this};var pe=W?function(e){return null==e?[]:(e=Object(e),function(t,i){for(var n=-1,r=null==t?0:t.length,a=0,s=[];++n<r;){var o=t[n];l=o,B.call(e,l)&&(s[a++]=o)}var l;return s}(W(e)))}:function(){return[]},ge=le;function _e(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function Se(e){if(null!=e){try{return k.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ve(e,t){return e===t||e!=e&&t!=t}(H&&"[object DataView]"!=ge(new H(new ArrayBuffer(1)))||G&&ge(new G)!=r||j&&"[object Promise]"!=ge(j.resolve())||$&&ge(new $)!=s||q&&"[object WeakMap]"!=ge(new q))&&(ge=function(e){var t=le(e),i=t==a?e.constructor:void 0,n=i?Se(i):"";if(n)switch(n){case J:return"[object DataView]";case X:return r;case Y:return"[object Promise]";case K:return s;case Q:return"[object WeakMap]"}return t});var ye=de(function(){return arguments}())?de:function(e){return Pe(e)&&M.call(e,"callee")&&!B.call(e,"callee")},Te=Array.isArray,be=U||function(){return!1};function we(e){if(!Ie(e))return!1;var t=le(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ce(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ie(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Pe(e){return null!=e&&"object"==typeof e}var Ee=S?function(e){return function(t){return e(t)}}(S):function(e){return Pe(e)&&Ce(e.length)&&!!d[le(e)]};function xe(e){return null!=(t=e)&&Ce(t.length)&&!we(t)?function(e,t){var i=Te(e),n=!i&&ye(e),r=!i&&!n&&be(e),a=!i&&!n&&!r&&Ee(e),s=i||n||r||a,o=s?function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}(e.length,String):[],l=o.length;for(var d in e)!t&&!M.call(e,d)||s&&("length"==d||r&&("offset"==d||"parent"==d)||a&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||_e(d,l))||o.push(d);return o}(e):function(e){if(i=(t=e)&&t.constructor,t!==("function"==typeof i&&i.prototype||E))return z(e);var t,i,n=[];for(var r in Object(e))M.call(e,r)&&"constructor"!=r&&n.push(r);return n}(e);var t}i.exports=function(e,t){return ce(e,t)}}).call(this,i(94),i(209)(e))},function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i(42),r=i(1),a=i(8),s=i(89),o=i(9),l=i(3),d=i(7),c=i(4),h=i(10);const u=i(116);class m{setIsUserPrivatelyZooming(e){this.m_isUserPrivatelyZooming=e,this.m_slideShowAppEvents.emit("isUserPrivatelyZooming",this.m_isUserPrivatelyZooming),o.a.sendTraceTag(506857097,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"OpticalZoomSyncStateHandlerAddon::setIsUserPrivatelyZooming - isUserPrivatelyZooming: "+this.m_isUserPrivatelyZooming)}registerSlideShowCoreListeners(){this.m_slideshowCore.events.on("opticalZoomStateChanged",e=>{e.metadata&&(e.metadata.currentRole=this.m_slideShowRole),this.m_slideShowAppEvents.emit("opticalZoomStateChanged",e),this.m_slideShowUIEvents.emit("opticalZoomStateChanged",e.currentState.zoomLevel)})}registerSlideShowAppListeners(){this.m_slideShowAppEvents.on("returnToPresenter",()=>{this.returnToPresenter()}),r.a.readBooleanOrDefault("allowUserToPrivatelyZoom",!1)&&(this.m_slideShowAppEvents.on("opticalZoomStateChanged",e=>{e.metadata&&!this.m_isUserPrivatelyZooming&&this.m_slideShowRole===n.f.Attendee&&e.metadata.source!==a.d.Sync&&e.metadata.source!==a.d.SlideLocationChanged&&(this.setIsUserPrivatelyZooming(!0),this.m_slideShowUIEvents.emit("showReturnToPresenterButton",!0))}),this.m_slideShowAppEvents.on("slideLocationChanged",()=>{this.m_slideShowRole===n.f.PrivateViewing&&this.m_slideshowCore.zoomToAsync(1,void 0,{source:a.d.SlideLocationChanged}),this.m_slideShowRole===n.f.Attendee&&(this.setOpticalZoomStateAsync(this.m_globalOpticalZoomState,{source:a.d.Sync}),this.returnToPresenter())}))}registerSlideShowUIListeners(){this.m_slideShowUIEvents.on("roleChanged",e=>{this.m_slideShowRole!==e&&(e===n.f.PrivateViewing&&this.setIsUserPrivatelyZooming(!0),e===n.f.Presenter&&(c.ChangeGate.isChangeGateEnabled("SSC.ResetOpticalZoomStateWithSource")?this.m_slideshowCore.zoomToAsync(1,void 0,{source:a.d.RoleChanged}):this.m_slideshowCore.zoomToAsync(1,void 0),this.setIsUserPrivatelyZooming(!1)),r.a.readBooleanOrDefault("enableOpticalZoomForPresenter",!1)&&this.m_slideShowRole===n.f.Presenter&&e===n.f.Attendee&&(c.ChangeGate.isChangeGateEnabled("SSC.ResetOpticalZoomStateWithSource")?this.m_slideshowCore.zoomToAsync(1,void 0,{source:a.d.RoleChanged}):this.m_slideshowCore.zoomToAsync(1,void 0),this.m_slideShowAppEvents.emit("initOpticalZoomState",{currentState:s.a.s_defaultOpticalZoomState,metadata:{source:a.d.RoleChanged}})),this.m_slideShowRole===n.f.PrivateViewing&&e===n.f.Attendee&&this.returnToPresenter(),this.m_slideShowRole=e)})}returnToPresenter(){this.m_isUserPrivatelyZooming&&(this.setIsUserPrivatelyZooming(!1),this.setOpticalZoomStateAsync(this.m_globalOpticalZoomState,{source:a.d.Sync}),this.m_slideShowUIEvents.emit("showReturnToPresenterButton",!1))}handleOpticalZoomStateChangeAsync(e,t){this.ensureZoomStateInSync(),this.m_globalOpticalZoomState=e,this.m_isUserPrivatelyZooming||this.m_slideShowRole===n.f.PrivateViewing||t&&t.presentersSource===a.d.SlideLocationChanged||this.setOpticalZoomStateAsync(e,t)}ensureZoomStateInSync(){if(this.m_isUserPrivatelyZooming)return;const e=this.m_slideshowCore.opticalZoomStateInfo.animationData?this.m_slideshowCore.opticalZoomStateInfo.animationData.targetOpticalZoomState:this.m_slideshowCore.opticalZoomStateInfo.currentState;m.areRoundedOpticalZoomStatesEqual(this.m_globalOpticalZoomState,e)||(o.a.sendTraceTag(508614021,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,`OpticalZoomSyncStateHandlerAddon::ensureZoomStateInSync - Optical Zoom State is out of sync. Actual: ${JSON.stringify(e)} Expected: ${JSON.stringify(this.m_globalOpticalZoomState)}`),c.ChangeGate.isChangeGateEnabled("SSC.LogVetoForOpticalZoomOutOfSync")&&h.e.recordVeto("SharingOutOfSync",{qosVeto:"SharingOutOfSync",errorName:"OpticalZoom_SharingOutOfSync"}))}static areRoundedOpticalZoomStatesEqual(e,t){const i={zoomLevel:e.zoomLevel,canvasCenterSlidePointPercent:{x:Math.round(100*e.canvasCenterSlidePointPercent.x)/100,y:Math.round(100*e.canvasCenterSlidePointPercent.y)/100}},n={zoomLevel:t.zoomLevel,canvasCenterSlidePointPercent:{x:Math.round(100*t.canvasCenterSlidePointPercent.x)/100,y:Math.round(100*t.canvasCenterSlidePointPercent.y)/100}};return u(i,n)}async setOpticalZoomStateAsync(e,t){if(t&&t.fAnimate)await this.m_slideshowCore.zoomToAsync(e.zoomLevel,void 0,{fAnimate:t.fAnimate,source:t.source});else{const i={currentState:e,metadata:t&&t.source?{source:t.source}:void 0};this.m_slideshowCore.setOpticalZoomState(i,{fEndZoomAnimation:!0})}}constructor(e,t,i,n){this.m_isUserPrivatelyZooming=!1,this.m_slideshowCore=e,this.m_slideShowUIEvents=n,this.m_slideShowAppEvents=i,this.m_globalOpticalZoomState={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}},this.m_slideShowRole=t,this.registerSlideShowCoreListeners(),this.registerSlideShowAppListeners()}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));class n{async loadAsync(){return new this.m_loadCtor}constructor(e){this.m_loadCtor=e}}class r{async loadAsync(){return new(0,(await this.m_moduleLoader()).default)}constructor(e){this.m_moduleLoader=e}}},function(e,t,i){"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=i(221)},,function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(9),r=i(3),a=i(7),s=i(146),o=i(69);class l{async startMediaCaptureAsync(e){return this.mediaStream=await navigator.mediaDevices.getUserMedia({video:{deviceId:e.deviceId,width:e.width,height:e.height,frameRate:e.frameRate},audio:!1}),this.streamInitializationStatus()}stopMediaCapture(){if(this.mediaStream){for(const e of this.mediaStream.getTracks())e.stop();this.mediaStream=void 0}}get stream(){return this.mediaStream}pauseMediaCapture(){this.setMediaEnabled(!1)}resumeMediaCapture(){this.setMediaEnabled(!0)}setMediaEnabled(e){if(this.mediaStream)for(const t of this.mediaStream.getTracks())t.enabled=e}streamInitializationStatus(){return this.mediaStream?0===this.mediaStream.getVideoTracks().length?o.a.ErrorNoVideoTracks:o.a.ErrorNone:o.a.ErrorStreamStartFailure}}class d{get isActive(){return this.m_toggledOn&&this.m_cameoDetectedNearby}setCameraState(e){this.m_toggledOn=e,this.updateCameoState()}updateWebcamDevice(e,t){if(!e)return void n.a.sendTraceTag(506857220,r.a.msoulscat_Wac_PptSession,a.a.Error,"CameoWebcamAddon::updateWebcamDevice: Invalid deviceId");const i={exact:e};let s={deviceId:i};t&&t.facingMode&&("user"===t.facingMode||"environment"===t.facingMode)&&(s={deviceId:i,facingMode:{exact:t.facingMode}}),this.m_mediaStreamClient.isActive?this.startMediaCaptureAsync(s,!0):this.m_mediaStreamClient.updateConstraints(s,!0)}getDefaultCameraLabel(){return this.m_defaultCameraLabel}getActiveCameraLabel(){if(this.m_mediaStreamClient&&this.m_mediaStreamClient.isActive){const e=this.m_mediaStreamClient.VideoElement.srcObject.getVideoTracks()[0];if(e)return e.label}return""}registerCoreEventListeners(){this.m_slideshowCore.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),this.m_slideshowCore.events.on("logSessionEnd",this.onSlideShowSessionEnd.bind(this))}onSlideLocationChanged(){const e=this.isActive;this.isCameoDetectedNearbyAsync().then(t=>{this.m_cameoDetectedNearby=t,e!==this.isActive&&this.updateCameoState()})}onSlideShowSessionEnd(){this.m_cameoDetectedNearby=!1}updateCameoState(){this.m_slideshowCore.isCameoActive=this.isActive,n.a.sendTraceTag(506857219,r.a.msoulscat_Wac_PptSession,a.a.Info,`CameoWebcamAddon::updateCameoState: isActive=${this.isActive}, toggledOn=${this.m_toggledOn}, isCameoDetectedNearby=${this.m_cameoDetectedNearby}`),this.isActive?(n.a.sendTraceTag(506857218,r.a.msoulscat_Wac_PptSession,a.a.Info,"CameoWebcamAddon::updateCameoState: starting webcam capture"),this.startMediaCaptureAsync()):(this.clearCameo(),this.stopMediaCapture())}async isCameoDetectedNearbyAsync(){return!!this.m_slideshowCore&&this.m_slideshowCore.isCameoDetectedNearbyAsync()}clearCameo(){this.m_slideshowCore&&this.m_slideshowCore.clearCameo()}async startMediaCaptureAsync(e,t=!1){try{const i=await this.m_mediaStreamClient.startMediaCaptureAsync(e,t);i===o.a.ErrorNone?(this.setCameoVideoElement(this.m_mediaStreamClient.VideoElement),""===this.m_defaultCameraLabel&&(this.m_defaultCameraLabel=this.getActiveCameraLabel()),this.m_notificationCallback&&this.m_notificationCallback("CameraStarted","Streaming"),n.a.sendTraceTag(506857217,r.a.msoulscat_Wac_PptSession,a.a.Info,"CameoWebcamAddon::startMediaCaptureAsync: success")):(n.a.sendTraceTag(506857216,r.a.msoulscat_Wac_PptSession,a.a.Error,"CameoWebcamAddon::startMediaCapture : MediaStreamClient startMediaCapture failed with error="+i),this.m_notificationCallback&&this.m_notificationCallback(i,"Error"))}catch(e){if(n.a.sendTraceTag(506857187,r.a.msoulscat_Wac_PptSession,a.a.Error,"CameoWebcamAddon::startMediaCapture : MediaStreamClient startMediaCapture threw error="+e),this.m_toggledOn=!1,this.updateCameoState(),this.m_mediaStreamClient.resetToOriginalConstraints(),this.m_notificationCallback){const t=e.toString();t&&"string"==typeof t?this.m_notificationCallback(t,"Error"):this.m_notificationCallback("unknown","Error")}}}stopMediaCapture(){this.m_mediaStreamClient.stopMediaCapture()}setCameoVideoElement(e){e?this.m_slideshowCore&&this.m_slideshowCore.setCameoVideoElement(e):n.a.sendTraceTag(506857186,r.a.msoulscat_Wac_PptSession,a.a.Error,"CameoWebcamAddon::setCameoVideoElement : MediaStreamClient VideoElement is missing")}constructor(e,t){this.m_toggledOn=!1,this.m_cameoDetectedNearby=!1,this.m_defaultCameraLabel="",this.m_slideshowCore=e,this.m_mediaStreamClientConfig={id:"cameo-webcam",source:new l,videoConstraints:{}},this.m_mediaStreamClient=new s.a(this.m_mediaStreamClientConfig),this.m_notificationCallback=t&&t.notificationCallback,this.registerCoreEventListeners()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(9),r=i(3),a=i(7),s=i(4);class o{get skew(){return this.m_skew}get sessionUTC(){return Date.now()+this.m_skew}beginCalculateSkewLoop(){this.calculateSkew(),this.m_skewCalculatorInterval=window.setInterval(this.calculateSkew.bind(this),2e4)}calculateSkew(){if(this.m_slowerSkewCalculationAttempts>this.m_maximumSlowerSkewCalculationAttempts)return n.a.sendTraceTag(506856604,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"calculateSkew GetSessionUTC maxSlowerSkewCalculationAttempts reached."),void window.clearInterval(this.m_skewCalculatorInterval);if(this.m_podsProxy){const e=Date.now();this.m_podsProxy.getSessionUtcAsync().then(t=>{const i=Date.now(),s=i-e;if(s>this.m_lastElapsed)this.m_slowerSkewCalculationAttempts+=1,n.a.sendTraceTag(506856602,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`calculateSkew GetSessionUTC slower attempt. ${this.m_slowerSkewCalculationAttempts}. Current m_skew: ${this.m_skew}`);else{this.m_successSkewCalculationAttempts+=1,this.m_lastElapsed=s;const o=s/2;this.m_skew=t+o-i,n.a.sendTraceTag(506856601,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`calculateSkew getSessionUTC: sentTime: ${e}; receivedTime: ${i}; serverTime: ${t}; elapsedTime: ${s}; skew: ${this.m_skew}; successAttempts: ${this.m_successSkewCalculationAttempts}; failedAttempts: ${this.m_failedSkewCalculationAttempts}`)}}).catch(e=>{this.m_failedSkewCalculationAttempts+=1,n.a.sendTraceTag(506856600,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"calculateSkew GetSessionUTC: error: "+e)})}else n.a.sendTraceTag(506856603,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"calculateSkew getSessionUTC: m_podsProxy is null"),this.m_failedSkewCalculationAttempts+=1}constructor(e,t,i,r){this.m_skew=0,this.m_slowerSkewCalculationAttempts=0,this.m_successSkewCalculationAttempts=0,this.m_failedSkewCalculationAttempts=0,this.m_lastElapsed=Number.MAX_SAFE_INTEGER,this.m_skewCalculatorInterval=0,this.m_podsProxy=t,this.m_logger=e,n.a.setLogger(this.m_logger),this.m_maximumSlowerSkewCalculationAttempts=i,s.ChangeGate.initSettings({disabledChangeGates:r||""})}}},,function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(17),r=i(1),a=i(4),s=i(9),o=i(3),l=i(7);class d{bindCoreEventsToAppEvents(e,t){e.on("bootStageChanged",e=>{t.emit("bootStageChanged",e)}),e.on("networkHealthChanged",e=>{t.emit("networkHealthChanged",e)}),e.on("slideshowError",e=>{t.emit("slideshowError",e.errorCode)}),a.ChangeGate.isChangeGateEnabled("ProgressiveLoaderForPVApp")&&e.on("slideShowRenderedToCanvas",()=>{t.emit("slideShowRenderedToCanvas")}),a.ChangeGate.isChangeGateEnabled("PVA.SlideNavStartSyncFix")&&e.on("slideNavigationStarted",e=>{e.actionContext&&e.actionContext.navMetrics&&"SSInboundMessage"===e.actionContext.navMetrics.navTrigger||t.emit("slideNavigationStarted",e.targetSlideLocation)}),e.on("slideLocationChanged",e=>{e.actionContext&&e.actionContext.navMetrics&&"SSInboundMessage"===e.actionContext.navMetrics.navTrigger||t.emit("slideLocationChanged")}),e.on("animationStateChanged",e=>{e&&e.actionContext.navMetrics&&"SSInboundMessage"===e.actionContext.navMetrics.navTrigger||t.emit("animationStateChanged")}),e.on("slideMediaEvent",e=>{t.emit("slideMediaEvent",e)}),e.on("blankSlideStateChanged",e=>{this.m_inboundBlankSlideStateBeingApplied!==e&&t.emit("blankSlideStateChanged",e)}),e.on("renderingModeChangedToSVG",()=>{r.a.readBooleanOrDefault("forceSvg",!1)&&t.emit("renderingModeChangedToSVG")}),e.on("aadTokenRequest",e=>{t.emit("aadTokenRequest",e)}),e.on("frameTrustCheck",()=>{t.emit("frameTrustCheck")}),e.on("slideShowAnnotationEvent",e=>{t.emit("slideShowAnnotationEvent",e)}),e.on("cameoDetectedInPresentation",e=>{t.emit("cameoDetectedInPresentation",e)}),e.on("mediaDetectedInPresentation",()=>{t.emit("mediaDetectedInPresentation")}),e.on("slideAddinSyncStateEvent",e=>{t.emit("slideAddinSyncStateEvent",e)}),r.a.readBooleanOrDefault("isZoomSyncEnabled",!1)||e.on("opticalZoomStateChanged",e=>{t.emit("opticalZoomStateChanged",e)})}getSlideCount(){return this.m_slideShowCore.getSlideCount()}async nextSlide(e){await this.m_slideShowCore.nextSlide(e)}async prevSlide(e){await this.m_slideShowCore.prevSlide(e)}async nextStep(e){this.m_slideShowAppEvents.emit("cleanupMediaStateCache",{isNavTriggerSSInBoundMessage:!1,undefined:void 0}),a.ChangeGate.isChangeGateEnabled("SSA.clearLastRequestedSlideState")&&this.m_slideShowCore.updateLastRequestedSlideState({}),await this.m_slideShowCore.nextStep(e||"0_anim",n.p.API)}async prevStep(e){this.m_slideShowAppEvents.emit("cleanupMediaStateCache",{isNavTriggerSSInBoundMessage:!1,undefined:void 0}),a.ChangeGate.isChangeGateEnabled("SSA.clearLastRequestedSlideState")&&this.m_slideShowCore.updateLastRequestedSlideState({}),await this.m_slideShowCore.prevStep(e||"0_anim",n.p.API)}async gotoSlide(e,t,i,n){const a=this.m_slideShowCore.getSlideLocation(),d=t&&t.navMetrics&&t.navMetrics.navTrigger&&"SSInboundMessage"===t.navMetrics.navTrigger;s.a.sendTraceTag(506856348,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideshowApp GoToSlide: location: ${JSON.stringify(e)}; metadata: ${t?JSON.stringify(t.navMetrics):"none"}`),r.a.readBooleanOrDefault("updateLastRequestedSlideState",!0)&&this.m_slideShowCore.updateLastRequestedSlideState({slideLocation:e,options:{actionContext:t,animationState:i,fSkipTransition:n}});const c=await this.m_slideShowCore.gotoSlide(e,{actionContext:t,animationState:i,fSkipTransition:n,fForceRetry:!0});if(c.fSucceeded){const t=this.getMediaNamesBySlideIndex(e.slideIndex);this.m_slideShowAppEvents.emit("cleanupMediaStateCache",{isNavTriggerSSInBoundMessage:d,mediaNamesBySlideId:t})}t&&t.navMetrics&&(t.navigationType&&(t.navMetrics.navType=t.navigationType.toString()),a&&e&&e.slideIndex&&(t.navMetrics.navDistance=Math.abs(a.slideIndex-e.slideIndex)),c&&(t.navMetrics.navResultStatus=c.fSucceeded?"Success":c.error?c.error.toString():"Failed Without Message"),t.navMetrics.slideIndex=e.slideIndex)}getMediaNamesBySlideIndex(e){if(e)return this.m_slideShowCore.getMediaNamesBySlideIndex(e)}playMedia(e){this.m_slideShowCore.playMedia(e)}pauseMedia(e){this.m_slideShowCore.pauseMedia(e)}seekMedia(e,t){this.m_slideShowCore.seekMedia(e,t)}getSlideLocation(){return this.m_slideShowCore.getSlideLocation()}getAnimationState(e){return this.m_slideShowCore.getAnimationState(e)}restoreFocus(){this.m_slideShowCore.restoreFocus()}exitSlideShow(){this.m_slideShowCore.endSession(performance.now()),this.m_slideShowAppEvents.emit("onExitSlideShow")}setAadToken(e){this.m_slideShowCore.setAadToken(e)}setFrameTrustStatus(e){this.m_slideShowCore.setFrameTrustStatus(e)}setBlankSlideState(e){this.m_inboundBlankSlideStateBeingApplied=e,this.m_slideShowCore.setBlankSlideState(e),this.m_inboundBlankSlideStateBeingApplied=void 0}returnToPresenterInbound(){this.m_slideShowAppEvents.emit("returnToPresenter")}updateMediaState(e){n.f.updateMediaSyncMetadataAndLog("Passing to SlideShowCore","PresenterViewApp",e),this.m_slideShowCore.updateMediaState(e,void 0)}setSharingLayoutMode(e){e&&(s.a.sendTraceTag(506856347,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowApp::setSharingLayoutMode - received new sharingLayoutMode=${e} while old sharingLayoutMode=${e}`),this.m_slideShowAppEvents.emit("sharingLayoutModeChanged",e))}emitIfCameoDetected(e){this.m_slideShowCore.emitIfCameoDetected(e)}emitIfMediaDetected(e){this.m_slideShowCore.emitIfMediaDetected(e)}setAddinSyncState(e){e?this.m_slideShowCore.setAddinSyncState(e):s.a.sendTraceTag(506856346,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"SlideShowApp::setAddinSyncState - addinSyncState is null.")}constructor(e,t){this.m_slideShowCore=e,this.m_slideShowAppEvents=t,this.bindCoreEventsToAppEvents(e.events,t)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(34);class r{createAppEvents(){return new n.EventEmitter}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(192),r=i(17),a=i(122),s=i(39),o=i(96);class l{get skew(){return this.m_clockSkewCalculator.skew}get sessionUTC(){return this.m_clockSkewCalculator.sessionUTC}get appSettings(){return this.m_sessionSettings.appSettings}get slideShowAppEvents(){return this.m_appEvents}get logger(){return this.m_logger}get sessionInfo(){return this.m_sessionInfo}get podsProxy(){throw new Error("Method intentionally not implemented. Should not be invoked.")}init(){return this.m_appEvents.emit("slideShowReady"),Promise.resolve()}postBoot(e){return this.m_clockSkewCalculator.beginCalculateSkewLoop(),Promise.resolve()}getSlideCount(){return this.m_slideShowCoreConnector.getSlideCount()}async nextSlide(e){await this.m_slideShowCoreConnector.nextSlide(e)}async prevSlide(e){await this.m_slideShowCoreConnector.prevSlide(e)}setLaserPointerActivation(e,t){}async nextStep(e,t){await this.m_slideShowCoreConnector.nextStep(e)}async prevStep(e,t){await this.m_slideShowCoreConnector.prevStep(e)}async gotoSlide(e,t,i,n){await this.m_slideShowCoreConnector.gotoSlide(e,t,i,n)}playMedia(e,t){this.m_slideShowCoreConnector.playMedia(e),t&&s.a.logMediaSyncCompletedMetadata(t,this.sessionUTC,this.skew)}pauseMedia(e,t){this.m_slideShowCoreConnector.pauseMedia(e),t&&s.a.logMediaSyncCompletedMetadata(t,this.sessionUTC,this.skew)}seekMedia(e,t,i){this.m_slideShowCoreConnector.seekMedia(e,t),i&&s.a.logMediaSyncCompletedMetadata(i,this.sessionUTC,this.skew)}getSlideLocation(){return this.m_slideShowCoreConnector.getSlideLocation()}getAnimationState(e){return this.m_slideShowCoreConnector.getAnimationState(e)}setNavigationOptions(e,t){}restoreFocus(){this.m_slideShowCoreConnector.restoreFocus()}exitSlideShow(){this.m_slideShowCoreConnector.exitSlideShow()}switchRole(e){this.m_syncAddonsConnector.switchRole(e)}changeTheme(e,t){return this.appSettings.toggleHighContrastModeEnabled&&!this.appSettings.slideShowToolbarEnabledForPresenter||this.m_syncAddonsConnector.changeTheme(e),Promise.resolve()}sendPresenterStateDuringPrivateViewing(e,t,i){}setPrivateViewingToggle(e){}setInkingActivity(e){this.m_syncAddonsConnector.setInkingActivity(e)}setAadToken(e){this.m_slideShowCoreConnector.setAadToken(e)}setFrameTrustStatus(e){this.m_slideShowCoreConnector.setFrameTrustStatus(e)}updateMeetingCoachStatus(e){}getSlideAreaContainerBounds(){}getSlideViewBounds(){}handleAnnotationEvent(e){this.m_syncAddonsConnector.handleAnnotationEvent(e),e.metadata&&s.a.logAnnotationCompletedMetadata(e.metadata,this.sessionUTC,this.skew,this.sessionInfo.uiHostRing)}setBlankSlideState(e){this.m_slideShowCoreConnector.setBlankSlideState(e)}videoFrameToPptForCameo(e,t){}updateBufferInfoForCameo(e){}returnToPresenterInbound(){this.m_slideShowCoreConnector.returnToPresenterInbound()}updateMediaState(e,t,i,n,a,l,d){if(s.a.isDuplicateMediaSyncMessage(l.CorrelationId,!1))return;s.a.logMediaSyncCompletedMetadata(l,this.sessionUTC,this.skew);const c=o.a.furnishMediaSyncState(e,t,i,n,a,l,d);this.m_syncAddonsConnector.updateMediaState(c),c.origin.isInitial?r.f.updateMediaSyncMetadataAndLog("Blocking - isInitState: true","PresenterViewApp",c):this.m_slideShowCoreConnector.updateMediaState(c)}getCameoInfoFromActiveSlide(){}getCameoManagerState(){return!1}setSharingLayoutMode(e){this.m_slideShowCoreConnector.setSharingLayoutMode(e)}emitIfCameoDetected(e){this.m_slideShowCoreConnector.emitIfCameoDetected(e)}emitIfMediaDetected(e){this.m_slideShowCoreConnector.emitIfMediaDetected(e)}updateCustomBackgroundForAPL(e,t){}setGlobalMute(e){}setAddinSyncState(e){this.m_slideShowCoreConnector.setAddinSyncState(e)}hideCameo(e,t){}updatePresenterName(e){}shouldPreventBroadcastOutboundSlideNavEvent(e,t){return!1}setOpticalZoomState(e,t){this.m_syncAddonsConnector.setOpticalZoomState(e,t)}changeCameraState(e){this.m_syncAddonsConnector.updateCameraState(e),this.m_uiSyncConnector&&this.m_uiSyncConnector.updateCameraToolbarButtonState(e)}changeSubtitlesState(e){this.m_uiSyncConnector&&this.m_uiSyncConnector.updateSubtitlesToolbarButtonState(e)}renderDynamicWatermark(e){}constructor(e,t,i,s,o,l,d){const c=t.appSettings;this.m_logger=r.m.logger?r.m.logger:Object(n.a)(c.userSessionId,c.serverUrl+"/RemoteUls.ashx"),this.m_sessionInfo=e,this.m_sessionSettings=t,this.m_slideShowCoreConnector=i,this.m_syncAddonsConnector=s,this.m_uiSyncConnector=d,this.m_appEvents=o;const h=c&&c.clockSkewCalculatorMaxSlowerAttempts?c.clockSkewCalculatorMaxSlowerAttempts:10;this.m_clockSkewCalculator=new a.a(this.m_logger,l,h,this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return c}));var n,r,a=i(9),s=i(3),o=i(7),l=i(135);!function(e){e.PPTSharingResumeSlideShow="PPTSharingResumeSlideShowObject",e.PPTLiveGlobalAppState="PPTLiveGlobalAppStateObject"}(n||(n={}));class d{static getCurrentInstance(e){return this.m_localStorageHelper||(this.m_localStorageHelper=new d(e)),this.m_localStorageHelper}clearEntryFromLocalStorage(e){try{localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){this.m_logger.sendTraceTag(506856588,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper:clearEntryFromLocalStorage - error while trying to clear previous call state: "+e)}}writeToLocalStorage(e,t){try{this.m_logger.sendTraceTag(506856587,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LocalStorageHelper: Writing to localStorage for localStorageCaller: "+e),localStorage.setItem(e,JSON.stringify(t)),this.m_logger.sendTraceTag(506856586,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LocalStorageHelper:Saved to local storage for : "+e)}catch(e){this.m_logger.sendTraceTag(506856585,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper: Error when saving State: "+e)}}readFromLocalStorage(e){try{const t=localStorage.getItem(e);if(t)return t}catch(e){this.m_logger.sendTraceTag(506856584,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper: Error when reading from local storage: "+e)}return""}constructor(e){this.m_logger=e}}!function(e){e.PrivateViewingAddon="PrivateViewingAddon",e.GridView="GridView",e.SlideShowToolbar="SlideShowToolbar",e.SlideShowInkingToolbar="SlideShowInkingToolbar"}(r||(r={}));class c{updateGlobalState(e,t){let i=this.fetchGlobalState();switch(a.a.sendTraceTag(506856593,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: update GlobalState for "+e),i&&i.SessionKey!==this.m_sessionKey&&(this.m_localStorageHelper.clearEntryFromLocalStorage(n.PPTLiveGlobalAppState),a.a.sendTraceTag(506856592,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: Current SessionKey is different from SessionKey in localStorage, clearing entry."),i=void 0),i||(i={SessionKey:this.m_sessionKey,LocalAppState:{}}),e){case r.PrivateViewingAddon:i.LocalAppState.role=t.role,i.LocalAppState.currentSlideLocation=t.currentSyncState,i.LocalAppState.currentAnimationState=t.currentAnimationState,i.LocalAppState.globalSyncState=t.globalSyncState,i.LocalAppState.globalAnimationState=t.globalAnimationState;break;default:a.a.sendTraceTag(506856591,s.a.msoulscat_Wac_PptLive,o.a.Error,`PPTLiveGlobalStateManager: ${e} not in in PPTLiveAppComponent list.`),i.LocalAppState.CallerNotDefined=t}this.m_localStorageHelper.writeToLocalStorage(n.PPTLiveGlobalAppState,i)}fetchGlobalState(){try{const e=JSON.parse(this.m_localStorageHelper.readFromLocalStorage(n.PPTLiveGlobalAppState));if(e&&e.LocalAppState)return e}catch(e){this.m_logger.sendTraceTag(506856590,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"PPTLiveGlobalStateManager: Error when reading from local storage: "+e)}}fetchGlobalStateForCurrentSharingSession(){const e=this.fetchGlobalState();if(e&&e.LocalAppState&&e.SessionKey===this.m_sessionKey)return e}sanitizeAndHashUrl(e){if(e){const t=e.split("tempauth=");if(t&&t.length>=1){const e=t[0];if(e)return this.calculateHash(e)}}return a.a.sendTraceTag(506856589,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: Failed to get document Url."),""}calculateHash(e){return e?""+(new l.sha256).update(e).digest("hex"):""}constructor(e,t,i){this.m_logger=i,this.sanitizeAndHashUrl(t),this.m_sessionKey="sharing_"+e,this.m_localStorageHelper=d.getCurrentInstance(this.m_logger)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(82),r=i(40),a=i(67),s=i(65);async function o(e,t,o=r.f.bind(null,t),l=r.d){var d,c,h;Object(r.j)(t);const u=e.platformName||"WEBGL2";let m=null===(d=e.extendedProcessingOptions)||void 0===d?void 0:d.processor;const f=e.shaderLanguage||0;if(!m)switch(u){case"WEBGL1":m=new((await Promise.resolve().then(i.bind(null,144))).WebGLShaderProcessor);break;case"WEBGL2":default:m=new((await Promise.resolve().then(i.bind(null,145))).WebGL2ShaderProcessor)}const p=e.shaderNameOrContent,g=p.vertex||p.vertexSource||p,_=p.fragment||p.fragmentSource||p,S=(null===(c=Object(a.c)())||void 0===c?void 0:c.split("\n"))||[],v=[...e.defines||[],...e.addGlobalDefines?S:[]],y=(null===(h=e.key)||void 0===h?void 0:h.replace(/\r/g,"").replace(/\n/g,"|"))||g+"+"+_+"@"+v.join("|"),T={defines:v,indexParameters:void 0,isFragment:!1,shouldUseHighPrecisionShader:!0,processor:m,supportsUniformBuffers:!1,shadersRepository:s.a.GetShadersRepository(f),includesShadersStore:s.a.GetIncludesShadersStore(f),version:"WEBGL2"===u?"200":"100",platformName:u,processingContext:null,isNDCHalfZRange:!1,useReverseDepthBuffer:!1,...e.extendedProcessingOptions};return new Promise((i,a)=>{try{Object(n.a)(T,p,void 0,(function(s,l){try{var d;const a=Object(n.b)({name:y,vertex:s,fragment:l,context:t,defines:v.length?v.join("\n"):null,shaderProcessingContext:(null===(d=e.extendedProcessingOptions)||void 0===d?void 0:d.processingContext)||null,transformFeedbackVaryings:null,...e.extendedCreatePipelineOptions},o,r.d,r.b);i(a)}catch(e){a(e)}}),f)}catch(e){a(e)}})}},function(e,t,i){"use strict";i.d(t,"a",(function(){return M})),i(194);var n=i(48),r=i(55),a=i(80),s=i(0),o=i(2),l=i(224),d=i(225),c=i(226),h=i(227),u=i(228),m=i(229),f=i(230),p=i(231),g=i(232),_=i(233),S=i(234),v=i(235),y=i(28),T=i(75),b=i(6),w=i(131),C=(i(193),i(103)),I=i(30);let P=1;const E=[l.a,d.a,c.a,h.a,u.a,m.a,f.a,p.a,g.a,_.a,S.a,v.a],x={x:0,y:0,width:1,height:1},k=[{attributeName:"",index:0,attributeSize:2,offset:0,divisor:0}];class M{getBabylonEngine(){return this.m_engine}get maxSupportedTextureSize(){return this.m_engine.getCaps().maxTextureSize}get quadMesh(){return this.m_quadMesh}get emptyTexture(){return this.m_emptyTexture}get whiteTexture(){return this.m_whiteTexture}needPowerOf2TexturesForTilingOrMipMap(){return this.m_needPowerOf2TexturesForTilingOrMipMap}isCurrentWebGLContext(e){return this.m_gl==e}isValid(){return this.m_gl&&!this.m_gl.isContextLost()}setWebGLContextOrBabylonEngine(e){const t=e instanceof WebGLRenderingContext||e instanceof WebGL2RenderingContext?e:e._gl;if(this.m_gl!=t){this.m_engine&&(this.m_emptyTexture&&this.m_emptyTexture.dispose(),this.m_whiteTexture&&this.m_whiteTexture.dispose(),this.m_quadMesh&&this.m_quadMesh.discard()),this.m_gl=t;const i=t.canvas.width,r=t.canvas.height;this.m_canvasRenderSize=new s.f(i,r),e instanceof n.a?this.m_engine=e:(this.m_engine=new n.a(t),this.m_engine.preventCacheWipeBetweenFrames=!0,this.m_engine.doNotHandleContextLost=!0,this.m_engine.setSize(i,r),this.m_engine.setViewport(x));const a=this.m_engine.getCaps();this.m_parallelShaderCompilationExtension=a.parallelShaderCompile,a.parallelShaderCompile=void 0,this.m_renderToFilteredFloat=a.textureFloatRender&&a.textureFloatLinearFiltering,this.m_renderToFilteredHalfFloat=a.textureHalfFloatRender&&a.textureHalfFloatLinearFiltering,this.m_needPowerOf2TexturesForTilingOrMipMap=this.m_engine.needPOTTextures,this.m_uniqueGraphicsProcessorId=P,P++;for(let e=0;e<I.a.count;e++)this.m_shaderPrograms[e]=void 0}}updateViewportSize(){const e=this.m_gl.canvas.width,t=this.m_gl.canvas.height;this.m_canvasRenderSize=new s.f(e,t),this.m_engine.setSize(e,t),this.m_engine.setViewport(x)}onWebGLContextLost(){for(let e=0;e<I.a.count;e++)this.m_shaderPrograms[e]=void 0}async initializeProgramsAsync(e){this.m_isInitializeReady=!1;const t=this.preCompileShadersAsync(null!=e?e:[...Array(I.a.count).keys()]);await Promise.all(t),this.m_isInitializeReady=!0}preCompileShadersAsync(e){const t=this.m_engine.getCaps();this.m_disableParallelShaderCompile||(t.parallelShaderCompile=this.m_parallelShaderCompilationExtension);const i=[];if(!this.beginRenderScopeInternal(!1))throw b.a.Error(592328457,"Failed to enter render scope.");for(const t of e){const e=this.getProgramInWebGlScope(t);i.push(e.enureDoneAsync())}return this.endRenderScopeInternal(!1),i}isInRenderScope(){return this.m_isInScope}beginRenderScope(){if(!this.m_isInitializeReady)throw b.a.Error(592525269,"Please, wait for onDone to be called in initialize.");return this.beginRenderScopeInternal(!0)}endRenderScope(){this.endRenderScopeInternal(!0)}beginRenderScopeInternal(e){const t=this.m_gl.isContextLost();return this.m_isInScope&&b.a.Error(592525270,"already in glContext scope"),t&&b.a.Error(592525271,"Invalnew glContext context is lostid"),!this.m_gl||t?this.m_isInScope=!1:(this.m_isInScope=!0,e&&(this.m_stateRestorer?(this.m_stateRestorer.init(this.m_gl),this.m_stateRestorer.setDefaults(),this.m_engine.wipeCaches(!0),this.m_engine.depthCullingState.cull=!1):this.m_wipeStateBetweenScopes&&(this.m_engine.wipeCaches(!0),this.m_engine.depthCullingState.cull=!1)),this.ensureVertexBufferAndMaxTapeInitialized()),this.m_isInScope}endRenderScopeInternal(e){this.m_isInScope?this.m_gl.isContextLost()?b.a.Error(592525273,"leaving glContext context is lost"):this.m_stateRestorer&&e&&this.m_stateRestorer.restore():b.a.Error(592525272,"leaving glContext not in scope"),this.m_isInScope=!1}ensureVertexBufferAndMaxTapeInitialized(){this.m_emptyTexture||(this.m_emptyTexture=this.createTextureGraphicsResource(s.f.One,new Uint8Array([0,0,0,0]),y.d.RGBA,!1,o.y.clamp,!1,!1)),this.m_whiteTexture||(this.m_whiteTexture=this.createTextureGraphicsResource(s.f.One,new Uint8Array([1,1,1,1]),y.d.RGBA,!1,o.y.clamp,!1,!1)),this.m_quadMesh||(this.m_quadMesh=T.a.CreateGridXY(this,2,2,new s.d(-1,-1,1,1)))}getProgramInWebGlScope(e){let t=this.m_shaderPrograms[e];return t||(t=this.m_shaderPrograms[e]=new A(this,e)),t}createTextureGraphicsResourceFromExternalWebGLTexture(e,t,i,n,a){let s=i instanceof WebGLTexture?i:null;var o;if(i instanceof r.a&&(s=null===(o=i._hardwareTexture)||void 0===o?void 0:o.underlyingResource),!s)throw b.a.Error(592525275,"wrong texture type");const l=R(n,a),d=new r.a(this.m_engine,0,!0);return d._hardwareTexture=new C.a(s,this.m_engine._gl),d.width=e.x,d.height=e.y,d.baseWidth=e.x,d.baseHeight=e.y,d.type=0,d.format=t,this.m_engine.updateTextureSamplingMode(l,d,a),d}updateTextureGraphicsResourceFromHTMLElement(e,t,i){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var n;const r=this.m_gl,a=null===(n=e._hardwareTexture)||void 0===n?void 0:n.underlyingResource;a&&(r.bindTexture(r.TEXTURE_2D,a),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,i),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.bindTexture(r.TEXTURE_2D,null))}}updateTextureGraphicsResourceFromByteBuffer(e,t,i,n){const r=this.m_engine;if(t instanceof Uint8Array||t instanceof Float32Array){let a=t,s=this.getTypeFromData(t,i);if(!(t instanceof Uint8Array&&0==s||t instanceof Float32Array&&1==s)){b.a.Error(572867294,"Wrong buffer data type: needs conversion");const e=0==s?new Uint8Array(t.length):new Float32Array(t.length),i=0==s?255:1/255;for(let n=0;n<t.length;n++)e[n]=t[n]*i;a=e}r._bindTextureDirectly(3553,e,!0,!0),this.m_gl.pixelStorei(this.m_gl.UNPACK_ALIGNMENT,n),r._uploadDataToTextureDirectly(e,a,0,0,void 0,!0),this.m_gl.pixelStorei(this.m_gl.UNPACK_ALIGNMENT,4),r._bindTextureDirectly(3553,null,!0,!0)}}createTextureGraphicsRenderTargetResource(e,t,i,n,r,a,s,o){const l=this.m_engine;let d=this.getTypeFromData(t,n);const c=R(s,!!o),h=l.createRenderTargetTexture({width:e.x,height:e.y},{generateDepthBuffer:!1,generateStencilBuffer:r,format:i,type:d,samplingMode:c,generateMipMaps:!!o});if(!h.texture)throw b.a.Error(592525276,"No InternalTexture in RenderTargetWrapper");return this.setWrapMode(h.texture,a),h}createRenderTargetWrapper(e){return this.m_engine._createHardwareRenderTargetWrapper(!1,!1,{width:e.x,height:e.y})}createTextureGraphicsResource(e,t,i,n,a,s,o,l,d){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){const n=this.m_gl;let r;if(r=n.createTexture(),r){n.bindTexture(n.TEXTURE_2D,r),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,o),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindTexture(n.TEXTURE_2D,null);const l=this.createTextureGraphicsResourceFromExternalWebGLTexture(e,i,r,s,!!d);return l&&this.setWrapMode(l,a),l}}const c=this.m_engine;let h=this.getTypeFromData(t,n);const u=R(s,!!d),m=new r.a(c,r.b.Unknown);return m.updateSize(e.x,e.y),m.type=h,m.format=i,m.invertY=o,c.updateTextureSamplingMode(u,m),(t instanceof Uint8Array||t instanceof Float32Array)&&this.updateTextureGraphicsResourceFromByteBuffer(m,t,n,l||4),this.setWrapMode(m,a),m}getTypeFromData(e,t){let i=0;return t&&(e instanceof Float32Array&&this.m_renderToFilteredFloat?i=1:e||(this.m_renderToFilteredHalfFloat?i=2:this.m_renderToFilteredFloat&&(i=1))),i}setRenderTarget(e){e?(this.m_engine.bindFramebuffer(e),this.m_currentRenderTarget=e):(this.m_engine.restoreDefaultFramebuffer(),this.m_currentRenderTarget=void 0)}setWrapMode(e,t){if(!e)throw b.a.Error(592525277,"Invalid texture resource");const i=t==o.y.clamp?0:t==o.y.tileFlipX||t==o.y.tileFlipXY?2:1,n=t==o.y.clamp?0:t==o.y.tileFlipY||t==o.y.tileFlipXY?2:1;this.m_engine.updateTextureWrappingMode(e,i,n)}copyTexturePixelsToArray(e,t,i){if(!e.texture)throw b.a.Error(507011862,"Invalid texture resource");const n=Math.floor(t.left),r=Math.floor(t.top),a=Math.floor(t.width),s=Math.floor(t.height);this.setRenderTarget(e);const o=this.m_engine._readTexturePixelsSync(e.texture,a,s,void 0,void 0,void 0,void 0,void 0,n,r);return this.setRenderTarget(void 0),o}getCurrentViewportSize(){return this.m_currentRenderTarget?new s.f(this.m_currentRenderTarget.width,this.m_currentRenderTarget.height):this.m_canvasRenderSize}setScissorRect(e,t){if(t||!Object(s.j)(e,this.m_currentScissorRect)){const t=this.m_gl,i=this.getCurrentViewportSize();e?(t.enable(t.SCISSOR_TEST),t.scissor(e.left,i.y-e.bottom,e.width,e.height)):(t.disable(t.SCISSOR_TEST),t.scissor(0,0,i.x,i.y))}this.m_currentScissorRect=e}getUniqueGraphicsProcessorId(){return this.m_uniqueGraphicsProcessorId}isFloatTextureSupported(){return this.m_renderToFilteredFloat||this.m_renderToFilteredHalfFloat}activateShaderProgram(e){const t=this.getProgramInWebGlScope(e);return t.activate(),t}getWebGLState(){return Object(w.b)(this.m_gl)}preCompileShaderAsync(e){this.beginRenderScopeInternal(!1)&&(this.getProgramInWebGlScope(e),this.endRenderScopeInternal(!1))}preLinkShaderAsync(e){this.preCompileShaderAsync(e)}tryPrepareProgramResourcesInWebGlScope(e){for(let e=0;e<I.a.countMinimalSet;e++)this.m_shaderPrograms[e]||this.getProgramInWebGlScope(e);return!0}constructor(e,t,i,n){this.m_shaderPrograms=new Array(I.a.count),this.m_isInitializeReady=!0,this.m_isInScope=!1,this.m_stateRestorer=n,this.m_wipeStateBetweenScopes=t,this.m_disableParallelShaderCompile=i,this.setWebGLContextOrBabylonEngine(e)}}class A{getBabylonEngine(){return this.m_engine}getBabylonEffect(){return this.m_effect}done(){return void 0!==this.effectErrors||this.m_effect.isReady()}enureDoneAsync(){return new Promise((e,t)=>{this.done()?e(void 0):(this.m_effect.onCompileObservable.add(()=>e(void 0)),this.m_effect.onErrorObservable.add(t))})}createEffect(){Object(I.c)(this.programId)?b.a.Message(507008355,"Using shader "+this.programId):b.a.Message(592525280,"Compiling shader "+this.programId+" on demand");const e=new a.a({vertexSource:E[this.programId].v,fragmentSource:E[this.programId].f},E[this.programId].a,E[this.programId].u,E[this.programId].s,this.m_engine,void 0,void 0,void 0,(e,t)=>{this.effectErrors=t},void 0,Object(I.b)(this.programId));return Object(I.d)(this.programId,E[this.programId]),e}activate(){this.handleActivationErrors(),this.m_engine.enableEffect(this.m_effect),this.m_currentMesh=void 0,this.bindMesh(void 0)}bindMesh(e){const t=e||this.graphicsProcessor.quadMesh;t&&t.isValid(this.graphicsProcessor)?this.m_currentMesh!=t&&(t.vertexBuffer&&t.indexBuffer&&t.isValid(this.graphicsProcessor)&&(this.m_engine._bindIndexBufferWithCache(t.indexBuffer),k[0].index=this.m_effect.getAttributeLocationByName("a_v"),this.m_engine.bindInstancesBuffer(t.vertexBuffer,k,!1)),this.m_currentMesh=t):b.a.Error(592525281,"Invalid Mesh")}handleActivationErrors(){if(!this.effectErrors&&this.m_effect.isReady())return;const e="Program "+this.programId+" ";if(this.effectErrors){const t=this.m_effect.getPipelineContext();if(t.vertexCompilationError)throw b.a.Error(592525282,e+"V compile failed: "+t.vertexCompilationError);if(t.fragmentCompilationError)throw b.a.Error(592525283,e+"V compile failed: "+t.fragmentCompilationError);if(t.programLinkError)throw b.a.Error(592525312,e+"link failed: "+t.programLinkError);if(t.programValidationError)throw b.a.Error(592525313,e+"validation failed: "+t.programValidationError);throw b.a.Error(592525314,e+"preparation failed:"+this.effectErrors)}if(!this.m_effect.isReady())throw b.a.Error(592525315,e+"Effect not ready yet.")}setTexture(e,t){const i=t||this.graphicsProcessor.emptyTexture;this.m_effect._bindTexture(e,i||null)}clearAndEnbaleDepthBuffer(){this.m_engine.depthCullingState.depthFunc=513,this.m_engine.depthCullingState.depthMask=!0,this.m_engine.depthCullingState.depthTest=!0,this.m_engine.clear(null,!1,!0,!1)}setDistanceFieldStencilSumIncrement(e){const t=e?34055:34056,i=this.m_engine;i.stencilState.stencilOpStencilFail=t,i.stencilState.stencilOpDepthFail=t,i.stencilState.stencilOpStencilDepthPass=t}setBlendingMode(e){const t=this.m_engine;t.alphaState.alphaBlend=!0,e==o.a.normal?(t.alphaState.setAlphaBlendFunctionParameters(1,771,1,771),t.alphaState.setAlphaEquationParameters(32774,32774)):e==o.a.darken?(t.alphaState.setAlphaBlendFunctionParameters(1,1,0,1),t.alphaState.setAlphaEquationParameters(32775,32774)):e==o.a.exclusion?(t.alphaState.setAlphaBlendFunctionParameters(775,769,0,1),t.alphaState.setAlphaEquationParameters(32774,32774)):e==o.a.cutout?(t.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),t.alphaState.setAlphaEquationParameters(32779,32779)):e==o.a.add?(t.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),t.alphaState.setAlphaEquationParameters(32774,32774)):e==o.a.multiply?(t.alphaState.setAlphaBlendFunctionParameters(774,0,0,1),t.alphaState.setAlphaEquationParameters(32774,32774)):e==o.a.simulateOverlay?b.a.Error(507581190,"simulateOverlay should be handled as a 2 pass approach with multiply and add"):b.a.Error(592525318,"Wrong blending mode")}begin(e,t,i){const n=this.m_engine;this.graphicsProcessor.setRenderTarget(e),this.m_engine.setViewport(x),t&&n.clear(t,!0,!1,!1),i?this.setBlendingMode(o.a.normal):n.alphaState.alphaBlend=!1,n.depthCullingState.depthTest=!1,n.depthCullingState.depthMask=!0,n.stencilState.stencilTest=!1,n.stencilState.stencilMask=255,n.setColorWrite(!0)}end(){this.graphicsProcessor.setRenderTarget(void 0),this.m_engine.unbindInstanceAttributes(),this.m_engine.setViewport(x)}drawQuads(e){this.bindMesh(void 0),this.m_engine.drawElementsType(0,0,6*e)}drawQuadInstances(e){this.bindMesh(void 0),this.m_engine.drawElementsType(0,0,6,e)}drawMesh(e){this.bindMesh(e),this.m_engine.drawElementsType(0,0,3*e.triangleCount)}setDummyPointerAttribute(e){if(this.graphicsProcessor.quadMesh&&this.graphicsProcessor.quadMesh.vertexBuffer){const t=this.graphicsProcessor.quadMesh.vertexBuffer,i=this.m_engine,n=[{attributeName:e,attributeSize:1,offset:0,divisor:0,index:this.m_effect.getAttributeLocationByName(e)}];i.bindInstancesBuffer(t,n,!1)}else b.a.Error(592525319,"Quad not initialized")}disableInstanceAttribute(e){this.m_engine.disableInstanceAttributeByName(e)}constructor(e,t){this.graphicsProcessor=e,this.m_engine=e.getBabylonEngine(),this.programId=t,this.m_effect=this.createEffect()}}function R(e,t){return e?t?3:2:1}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{get underlyingResource(){return null}constructor(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=n._Counter++}}n._Counter=0},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));var n=i(6);function r(e){const t=[e.ACTIVE_TEXTURE,e.ARRAY_BUFFER_BINDING,e.BLEND,e.BLEND_COLOR,e.BLEND_DST_ALPHA,e.BLEND_DST_RGB,e.BLEND_EQUATION_ALPHA,e.BLEND_EQUATION_RGB,e.BLEND_SRC_ALPHA,e.BLEND_SRC_RGB,e.COLOR_CLEAR_VALUE,e.COLOR_WRITEMASK,e.CULL_FACE,e.CULL_FACE_MODE,e.CURRENT_PROGRAM,e.DEPTH_CLEAR_VALUE,e.DEPTH_FUNC,e.DEPTH_RANGE,e.DEPTH_TEST,e.DEPTH_WRITEMASK,e.DITHER,e.ELEMENT_ARRAY_BUFFER_BINDING,e.FRAMEBUFFER_BINDING,e.FRONT_FACE,e.GENERATE_MIPMAP_HINT,e.LINE_WIDTH,e.PACK_ALIGNMENT,e.POLYGON_OFFSET_FACTOR,e.POLYGON_OFFSET_FILL,e.POLYGON_OFFSET_UNITS,e.RENDERBUFFER_BINDING,e.SAMPLE_COVERAGE_INVERT,e.SAMPLE_COVERAGE_VALUE,e.SCISSOR_BOX,e.SCISSOR_TEST,e.STENCIL_BACK_FAIL,e.STENCIL_BACK_FUNC,e.STENCIL_BACK_PASS_DEPTH_FAIL,e.STENCIL_BACK_PASS_DEPTH_PASS,e.STENCIL_BACK_REF,e.STENCIL_BACK_VALUE_MASK,e.STENCIL_BACK_WRITEMASK,e.STENCIL_CLEAR_VALUE,e.STENCIL_FAIL,e.STENCIL_FUNC,e.STENCIL_PASS_DEPTH_FAIL,e.STENCIL_PASS_DEPTH_PASS,e.STENCIL_REF,e.STENCIL_TEST,e.STENCIL_VALUE_MASK,e.STENCIL_WRITEMASK,e.TEXTURE_BINDING_2D,e.TEXTURE_BINDING_CUBE_MAP,e.UNPACK_ALIGNMENT,e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.UNPACK_FLIP_Y_WEBGL,e.UNPACK_PREMULTIPLY_ALPHA_WEBGL];let i=e.getParameter(e.VIEWPORT),n=new Array(57);for(let i=0;i<57;i++)n[i]=e.getParameter(t[i]);let r=new Array(2);for(let t=0;t<2;t++)r[t]=e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_ENABLED);return{viewport:i,params:n,VERTEX_ATTRIB_ARRAY_ENABLED:r}}class a{init(e){if(this.gl&&n.a.Error(591663577,"Previous Init has not been Restored"),this.gl=e,this.webGLRestoreToDefault)this.old_VIEWPORT=e.getParameter(e.VIEWPORT);else{let{viewport:t,params:i,VERTEX_ATTRIB_ARRAY_ENABLED:n}=r(e);this.old_VIEWPORT=t,this.old=i,this.old_VERTEX_ATTRIB_ARRAY_ENABLED=n}}setDefaults(){const e=this.gl;if(e){e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,null),e.disable(e.BLEND),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.disable(e.CULL_FACE),e.cullFace(e.BACK),e.useProgram(null),e.clearDepth(1),e.depthFunc(e.LESS),e.depthRange(0,1),e.disable(e.DEPTH_TEST),e.depthMask(!0),e.disable(e.DITHER),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.polygonOffset(0,0),e.disable(e.POLYGON_OFFSET_FILL),e.bindRenderbuffer(e.RENDERBUFFER,null),e.sampleCoverage(1,!1),e.scissor(0,0,this.old_VIEWPORT[2],this.old_VIEWPORT[3]),e.disable(e.SCISSOR_TEST),e.stencilFunc(e.ALWAYS,0,1),e.stencilMask(255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.disable(e.STENCIL_TEST),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e.viewport(this.old_VIEWPORT[0],this.old_VIEWPORT[1],this.old_VIEWPORT[2],this.old_VIEWPORT[3]);for(let t=0;t<2;t++)e.disableVertexAttribArray(t)}else n.a.Error(591663578,"Trying to set default without Init")}restore(){const e=this.gl;if(!e)return void n.a.Error(591663579,"Trying to Restore without Init");const t=this.old;if(this.webGLRestoreToDefault)this.setDefaults();else{e.activeTexture(t[0]),e.bindBuffer(e.ARRAY_BUFFER,t[1]),t[2]?e.enable(e.BLEND):e.disable(e.BLEND);const i=t[3];e.blendColor(i[0],i[1],i[2],i[3]),e.blendEquationSeparate(t[7],t[6]),e.blendFuncSeparate(t[9],t[5],t[8],t[4]);const n=t[10];e.clearColor(n[0],n[1],n[2],n[3]);const r=t[11];e.colorMask(r[0],r[1],r[2],r[3]),t[12]?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.cullFace(t[13]),e.useProgram(t[14]),e.clearDepth(t[15]),e.depthFunc(t[16]),e.depthRange(t[17][0],t[17][1]),t[18]?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(t[19]),t[20]?e.enable(e.DITHER):e.disable(e.DITHER),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t[21]),e.bindFramebuffer(e.FRAMEBUFFER,t[22]),e.frontFace(t[23]),e.hint(e.GENERATE_MIPMAP_HINT,t[24]),e.lineWidth(t[25]),e.pixelStorei(e.PACK_ALIGNMENT,t[26]),e.polygonOffset(t[27],t[29]),t[28]?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.bindRenderbuffer(e.RENDERBUFFER,t[30]),e.sampleCoverage(t[32],t[31]);const a=t[33];e.scissor(a[0],a[1],a[2],a[3]),t[34]?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFuncSeparate(e.FRONT,t[44],t[47],t[49]),e.stencilFuncSeparate(e.BACK,t[36],t[39],t[40]),e.stencilMaskSeparate(e.FRONT,t[50]),e.stencilMaskSeparate(e.BACK,t[41]),e.stencilOpSeparate(e.FRONT,t[43],t[45],t[46]),e.stencilOpSeparate(e.BACK,t[35],t[37],t[38]),e.clearStencil(t[42]),t[48]?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.bindTexture(e.TEXTURE_2D,t[51]),e.bindTexture(e.TEXTURE_CUBE_MAP,t[52]),e.pixelStorei(e.UNPACK_ALIGNMENT,t[53]),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,t[54]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t[55]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t[56]),e.viewport(this.old_VIEWPORT[0],this.old_VIEWPORT[1],this.old_VIEWPORT[2],this.old_VIEWPORT[3]);for(let t=0;t<2;t++)this.old_VERTEX_ATTRIB_ARRAY_ENABLED[t]?e.enableVertexAttribArray(t):e.disableVertexAttribArray(t)}this.gl=void 0}constructor(e){this.webGLRestoreToDefault=!1,this.old=new Array(57),this.old_VERTEX_ATTRIB_ARRAY_ENABLED=new Array(2),this.webGLRestoreToDefault=e}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i(0),r=i(15),a=i(25),s=i(6),o=i(5),l=i(68),d=i(2),c=i(20);class h{clearCache(){for(let e of this.textShapes)e.clearCache();for(let e of this.hitTestLineShapes)e.clearCache();for(let e of this.selectionShapes||[])e.clearCache()}getTextShapes(){return this.textShapes}getSelectionShapes(){return this.selectionShapes||[]}initShapeEffectsAndBoundsOverrides(e,t,i,r,s,o){if(t.effects=function(e,t,i){if(!e)return;const n=t?t.fontHeightInPoints:0,r=e.clone(),a=0==n?1:n/I;return r.glow&&(r.glow.radius=p(r.glow.radius,n,g,_,S)/2),r.shadow&&(r.shadow.radius=p(r.shadow.radius,n,v,y,T),r.shadow.distance=p(r.shadow.distance,n,v,y,T)),r.innerShadow&&(r.innerShadow.radius=p(r.innerShadow.radius,n,b,w,C),r.innerShadow.distance=p(r.innerShadow.distance,n,b,w,C)),r.reflection&&(r.reflection.radius*=a,t&&(r.reflection.distance*=0!=t.ascent&&0!=t.descent?n*t.descent/t.ascent/P:a)),r.softEdges&&(r.softEdges.radius*=a),r.direction=i,r}(e.getEffetcsAt(s),i?i.textEffectMetrics:void 0,-e.frameToShape.rotation)||new l.a,!i.bender){if(e.applyEffectsPerCharacter||o){const i=e.getBoundsOfRange(new a.j(s,1));t.effectsBoundsOverride=i,o&&t.style.fillBrush instanceof d.g||(t.fillBoundsOverride=i)}else{const a=i.fillBounds.translate(r).transformedBounds(n.c.FromTransforms(e.layoutToFrame,e.frameToShape));t.effectsBoundsOverride=a,t.fillBoundsOverride=e.spreadFill?e.getBoundsOfRange(void 0):a}t.textEffectMetrics=i.textEffectMetrics}}getTextShape(e,t){const i=e.getStyleAt(t.start),n=e.getTextPathsForRange(t,null==i?void 0:i.hasLine),r=new o.j(n,i),a=e.getLineAndParagraphAt(t.start);return a&&this.initShapeEffectsAndBoundsOverrides(e,r,a.line,a.line.offset.add(a.paragraph.offset),t.start,!1),r.role=o.k.text,r.textRange=t,r.overlapMode=o.i.winding,r.transform=e.frameToShape,r}getStrokeShape(e,t,i){const n=new o.j(this.getStrokePaths(e,t,i),i.style?i.style:e.getStyleAt(t.start)),r=e.getLineAndParagraphAt(t.start);return r&&this.initShapeEffectsAndBoundsOverrides(e,n,r.line,r.line.offset.add(r.paragraph.offset),t.start,!1),n.role=o.k.text,n.textRange=t,n.overlapMode=o.i.winding,n.transform=e.frameToShape,n}getSelectionHighlightShapes(e){if(!e.selectionHighlights)return;const t=[];for(let i of e.selectionHighlights)if(i.range.length>0){let n=e.getSelectionRectPaths(i.range);n&&t.push(new o.j(n,i.style))}else{let n=e.getSelectionLayoutCaretPath(i.range.start,i.caretWidth,i.isAnchoredToPrevious);n&&t.push(new o.j([n],i.style))}return t}update(e){if(e.textVersion!=this.lastKnownTextVersion){this.lastKnownTextVersion=e.textVersion,this.clearCache(),this.textShapes=[],this.hitTestLineShapes=[];const t=[],i=[];e.renderMode!=a.k.TextInFrontOfShape&&(this.cutoutLayerPaths=void 0);for(let n of e.paragraphs)if(n.bullet){const r=e.getLineAndParagraphAt(n.globalRange.start);if(r){const s=new a.j(n.globalRange.start,0);for(let r of n.bullet.strokes?n.bullet.strokes.elements:[])r.type==a.o.highlighter?t.push(this.getStrokeShape(e,s,r)):i.push(this.getStrokeShape(e,s,r));const l=e.getTextPathsForCharacter(n.bullet.character,n.offset,n.lines.length>0?n.lines[0].bender:void 0),d=new o.j(l,n.bullet.style?n.bullet.style:e.getStyleAt(s.start));this.initShapeEffectsAndBoundsOverrides(e,d,r.line,r.paragraph.offset,s.start,!0),d.role=o.k.text,d.textRange=new a.j(n.globalRange.start,0),d.transform=e.frameToShape,i.push(d)}}const s=e.getSelectionRectPaths(void 0);for(let t of s||[]){const i=new o.j([t],new d.x(new d.v(d.d.Black)));i.transform=e.frameToShape,this.hitTestLineShapes.push(i)}const l=e.getRunRanges(),h=[];for(let t of l){const i=e.getBoundsOfRange(t);if(i&&i.width>2048){const e=Math.ceil(i.width/2048);for(let i=0;i<e;i++){const n=Math.floor(t.start+i*t.length/e),r=i==e-1?t.last+1:Math.floor(t.start+(i+1)*t.length/e);n<r&&h.push(a.j.FromFirstLast(n,r-1))}}else h.push(t)}for(let t of h)i.push(this.getTextShape(e,t));for(let n of h){const r=e.getStrokesAt(n.start);for(let s of r?r.elements:[])s.type==a.o.highlighter?t.push(this.getStrokeShape(e,n,s)):i.push(this.getStrokeShape(e,n,s))}for(let t of e.paragraphs)for(let s of t.lines)for(let l=0;l<s.characters.length;l++){const c=s.characters[l];if(c.textImage){let h=r.a.CreateFromRect(c.textImage.rect);c.textImage.useLocalCordinates&&(h=h.transform(n.c.FromTransforms(c.textImage.transform,n.c.Translation2D(s.offset.add(t.offset)),e.layoutToFrame)));const u=new o.j([new r.d({figures:[h]})],new d.x(new d.g(c.textImage.image)));u.role=c.textImage.useLocalCordinates?o.k.text:o.k.textImageNotLocal,u.textRange=new a.j(l+s.localRange.start+t.globalRange.start,1),u.transform=c.textImage.useLocalCordinates?e.frameToShape:c.textImage.transform,i.push(u)}}if(c.y){for(let t of e.paragraphs)for(let n of t.lines)if(n.bender instanceof a.p){const a=new o.j([r.d.CreateFromFigure(n.bender.topPath)],new d.x(void 0,new d.v(d.d.Cyan),new d.l(1))),s=new o.j([r.d.CreateFromFigure(n.bender.bottomPath)],new d.x(void 0,new d.v(d.d.Magenta),new d.l(1)));a.textRange=s.textRange=n.localRange.move(t.globalRange.start),a.transform=e.frameToShape,s.transform=e.frameToShape,i.push(a),i.push(s)}else if(n.bender instanceof a.a){const a=new o.j([r.d.CreateFromFigure(n.bender.path)],new d.x(void 0,new d.v(d.d.Yellow),new d.l(1)));a.textRange=n.localRange.move(t.globalRange.start),a.transform=e.frameToShape,i.push(a)}const t=e.getAnimatablePartRanges(a.m.ByLetter,void 0,!0);for(let n of t||[]){const t=e.getBoundsOfRange(n);if(t){const e=new o.j([r.d.CreateFromRect(t)],new d.x(void 0,new d.v(d.d.Blue),new d.l(1)));e.textRange=n,i.push(e)}}for(let t of e.paragraphs)for(let a of t.lines){const s=a.fillBounds.translate(a.offset.add(t.offset)).transformedBounds(n.c.FromTransforms(e.layoutToFrame,e.frameToShape));if(s&&a.textEffectMetrics){const e=new n.d(s.left,s.top,s.right,s.top+a.textEffectMetrics.ascent),l=new n.d(s.left,s.bottom-a.textEffectMetrics.descent,s.right,s.bottom),c=new o.j([r.d.CreateFromRect(e)],new d.x(void 0,new d.v(d.d.Red),new d.l(1))),h=new o.j([r.d.CreateFromRect(l)],new d.x(void 0,new d.v(d.d.Green),new d.l(1)));c.textRange=a.localRange.move(t.globalRange.start),h.textRange=a.localRange.move(t.globalRange.start),i.push(c),i.push(h)}}}this.textShapes.push(...t),this.textShapes.push(...i);for(let t of this.textShapes)if(t.role==o.k.textImageNotLocal){if(e.clipBounds){const i=t.getBounds(!1,!1,!0),r=null==i?void 0:i.transformedBounds(e.frameToShape.toInverseMatrix3()),a=r?e.clipBounds.clip(r):void 0,s=null==a?void 0:a.transformedBounds(e.frameToShape.toMatrix3().multiply(t.transform.toInverseMatrix3()));t.clipBounds=s?n.b.CreateFromRect(s):void 0,s||(t.paths=[])}}else t.clipBounds=e.clipBounds;if(e.renderMode!=a.k.TextInFrontOfShape){if(this.cutoutLayerPaths=[],e.renderMode==a.k.LinesCutout){const t=e.getCutoutLinePath(void 0,e.linesCutoutMargin);for(let e of t||[])this.cutoutLayerPaths.push(e)}for(let e of t)this.cutoutLayerPaths.push(...e.paths||[]);for(let e of i)this.cutoutLayerPaths.push(...e.paths||[])}}if(e.selectionVersion!=this.lastKnownSelectionVersion){this.lastKnownSelectionVersion=e.selectionVersion;const t=this.getSelectionHighlightShapes(e);if(t){if(this.selectionShapes=[],new d.x(new d.v(d.d.White)).blendingMode=d.a.exclusion,t){this.selectionShapes.push(...t);for(let t of this.selectionShapes)t.transform=e.frameToShape}}else{for(let e of this.selectionShapes||[])e.clearCache();this.selectionShapes=void 0}}}getStrokePaths(e,t,i){const s=[];for(let o of e.paragraphs)if(o.globalRange.intersects(t))for(let l of o.lines){let d,c;const h=new a.j(0,l.characters.length).getIntersection(t.move(-o.globalRange.start-l.localRange.start));if(h)for(let e=h.start;e<=h.last;e++){const t=l.characters[e].layoutBounds;t.isEmpty()||(d=null==d?t.left:Math.min(d,t.left),c=null==c?t.right:Math.max(c,t.right))}if(null!=d&&null!=c&&d<c){const t=n.c.Translation2D(l.offset.add(o.offset)).multiply(e.layoutToFrame.toMatrix3()).tryGetTransform(n.f.Zero);if(t){let e=new r.d({figures:f(i,d,c),transform:t});const n=l.bender instanceof a.a?l.bender.equivalentWarpingEnvelope:l.bender;n&&(e=n.warpPath(e)),s.push(e)}}}return s}constructor(){this.textShapes=[],this.hitTestLineShapes=[]}}function u(e,t,i){const n=t.y-i,a=Math.ceil(t.x/(2*n));let s=e.x;const o=new r.b;o.moveTo(s,e.y),o.lineTo(s,e.y+i);for(let r=0;r<a;r++)s+=n,o.lineTo(s,e.y+t.y),s+=n,o.lineTo(s,e.y+i);o.lineTo(s,e.y);for(let r=0;r<a;r++)s-=n,o.lineTo(s,e.y+t.y-i),s-=n,o.lineTo(s,e.y);return o.close(),o.createFigure()}function m(e,t,i,a,s,o){const l=[];let d=e.x;const c=t.y,h=t.y*i,u=t.y*a,m=o?e.y-t.y:e.y,f=o?e.y+t.y/2:e.y+t.y;let p=0;for(;d<e.x+t.x;){const i=s&&p%(s+1)!=0?c:h,a=Math.min(d+i,t.x+e.x);l.push(r.a.CreateFromRect(new n.d(d,m,a,f))),d+=u+i,p++}return l}function f(e,t,i){const o=new n.f(t,e.verticalCenter-.5*e.thickness),l=new n.f(i-t,e.thickness),d=[],c=e.type==a.o.heavy||e.type==a.o.dottedHeavy||e.type==a.o.dashHeavy||e.type==a.o.dashLongHeavy||e.type==a.o.dotDashHeavy||e.type==a.o.dotDotDashHeavy||e.type==a.o.wavyHeavy;switch(e.type){case a.o.heavy:case a.o.single:case a.o.highlighter:c?d.push(r.a.CreateFromRect(new n.d(o.x,o.y-l.y,o.x+l.x,o.y+Math.ceil(l.y/2)))):d.push(r.a.CreateFromRect(new n.d(o.x,o.y,o.x+l.x,o.y+l.y)));break;case a.o.double:{const e=!1;d.push(...function(e,t,i){const a=[];return i?(a.push(r.a.CreateFromRect(new n.d(e.x,e.y,e.x+t.x,e.y+t.y/2))),a.push(r.a.CreateFromRect(new n.d(e.x,e.y+t.y,e.x+t.x,e.y+3*t.y/2)))):(a.push(r.a.CreateFromRect(new n.d(e.x,e.y-t.y,e.x+t.x,e.y-t.y/2))),a.push(r.a.CreateFromRect(new n.d(e.x,e.y+t.y/2,e.x+t.x,e.y+t.y)))),a}(o,l,e));break}case a.o.dottedHeavy:case a.o.dotted:d.push(...m(o,l,1,1,1,c));break;case a.o.dashHeavy:case a.o.dash:d.push(...m(o,l,3,2,0,c));break;case a.o.dashLongHeavy:case a.o.dashLong:d.push(...m(o,l,7,4,0,c));break;case a.o.dotDash:case a.o.dotDashHeavy:d.push(...m(o,l,3,2,1,c));break;case a.o.dotDotDash:case a.o.dotDotDashHeavy:d.push(...m(o,l,3,2,2,c));break;case a.o.wavy:case a.o.wavyHeavy:{let t=2*l.y,i=1;e.type==a.o.wavyHeavy&&(t=Math.floor(Math.max(3,2*l.y)),i=Math.max(2,Math.floor(l.y/2))),d.push(u(new n.f(o.x,o.y-Math.ceil(l.y/2)),new n.f(l.x,t),i))}break;case a.o.wavyDouble:{const e=1,t=Math.max(2,l.y),i=o.y-t;d.push(u(new n.f(o.x,i),new n.f(l.x,t),e)),d.push(u(o,new n.f(l.x,t),e))}break;default:s.a.Error(591525085,"Unknown stroke type")}return d}function p(e,t,i,n,r){return t>0&&r<e?(e-r)*Math.pow(t,n)/Math.pow(i,n)+r:0==t?e:0}const g=72,_=.7,S=1,v=72,y=.7,T=.4,b=108,w=1,C=.001,I=72,P=4},function(e,t,i){var n;!function(r,a){"use strict";var s="model",o="name",l="type",d="vendor",c="version",h="mobile",u="tablet",m="smarttv",f=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},p=function(e,t){return"string"==typeof e&&-1!==g(t).indexOf(g(e))},g=function(e){return e.toLowerCase()},_=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,""),void 0===t?e:e.substring(0,350)},S=function(e,t){for(var i,n,r,a,s,o,l=0;l<t.length&&!s;){var d=t[l],c=t[l+1];for(i=n=0;i<d.length&&!s;)if(s=d[i++].exec(e))for(r=0;r<c.length;r++)o=s[++n],"object"==typeof(a=c[r])&&a.length>0?2===a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,o):this[a[0]]=a[1]:3===a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=o?o.replace(a[1],a[2]):void 0:this[a[0]]=o?a[1].call(this,o,a[2]):void 0:4===a.length&&(this[a[0]]=o?a[3].call(this,o.replace(a[1],a[2])):void 0):this[a]=o||void 0;l+=2}},v=function(e,t){for(var i in t)if("object"==typeof t[i]&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(p(t[i][n],e))return"?"===i?void 0:i}else if(p(t[i],e))return"?"===i?void 0:i;return e},y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},T={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[o,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[c,[o,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[o,c],[/opios[\/ ]+([\w\.]+)/i],[c,[o,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[c,[o,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[o,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[c,[o,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[c,[o,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[o,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[o,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[c,[o,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[o,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[o,/(.+)/,"$1 Secure Browser"],c],[/\bfocus\/([\w\.]+)/i],[c,[o,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[c,[o,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[c,[o,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[o,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[o,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[c,[o,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[c,[o,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[o,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[o,/(.+)/,"$1 Browser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],c],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[o,c],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[o],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[o,"Facebook"],c],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[o,c],[/\bgsa\/([\w\.]+) .*safari\//i],[c,[o,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[c,[o,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[o,"Chrome WebView"],c],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[c,[o,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[o,c],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[c,[o,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[c,o],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[o,[c,v,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[o,c],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[o,"Netscape"],c],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[c,[o,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[o,c],[/(cobalt)\/([\w\.]+)/i],[o,[c,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",g]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",g]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",g]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[s,[d,"Samsung"],[l,u]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[s,[d,"Samsung"],[l,h]],[/\((ip(?:hone|od)[\w ]*);/i],[s,[d,"Apple"],[l,h]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[s,[d,"Apple"],[l,u]],[/(macintosh);/i],[s,[d,"Apple"]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[s,[d,"Huawei"],[l,u]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[s,[d,"Huawei"],[l,h]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[s,/_/g," "],[d,"Xiaomi"],[l,h]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[s,/_/g," "],[d,"Xiaomi"],[l,u]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[s,[d,"OPPO"],[l,h]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[s,[d,"Vivo"],[l,h]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[s,[d,"Realme"],[l,h]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[s,[d,"Motorola"],[l,h]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[s,[d,"Motorola"],[l,u]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[s,[d,"LG"],[l,u]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[s,[d,"LG"],[l,h]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[s,[d,"Lenovo"],[l,u]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[s,/_/g," "],[d,"Nokia"],[l,h]],[/(pixel c)\b/i],[s,[d,"Google"],[l,u]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[s,[d,"Google"],[l,h]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[d,"Sony"],[l,h]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[s,"Xperia Tablet"],[d,"Sony"],[l,u]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[s,[d,"OnePlus"],[l,h]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[s,[d,"Amazon"],[l,u]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[s,/(.+)/g,"Fire Phone $1"],[d,"Amazon"],[l,h]],[/(playbook);[-\w\),; ]+(rim)/i],[s,d,[l,u]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[s,[d,"BlackBerry"],[l,h]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[s,[d,"ASUS"],[l,u]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[s,[d,"ASUS"],[l,h]],[/(nexus 9)/i],[s,[d,"HTC"],[l,u]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[s,/_/g," "],[l,h]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[s,[d,"Acer"],[l,u]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[s,[d,"Meizu"],[l,h]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[s,[d,"Sharp"],[l,h]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,s,[l,h]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,s,[l,u]],[/(surface duo)/i],[s,[d,"Microsoft"],[l,u]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[s,[d,"Fairphone"],[l,h]],[/(u304aa)/i],[s,[d,"AT&T"],[l,h]],[/\bsie-(\w*)/i],[s,[d,"Siemens"],[l,h]],[/\b(rct\w+) b/i],[s,[d,"RCA"],[l,u]],[/\b(venue[\d ]{2,7}) b/i],[s,[d,"Dell"],[l,u]],[/\b(q(?:mv|ta)\w+) b/i],[s,[d,"Verizon"],[l,u]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[s,[d,"Barnes & Noble"],[l,u]],[/\b(tm\d{3}\w+) b/i],[s,[d,"NuVision"],[l,u]],[/\b(k88) b/i],[s,[d,"ZTE"],[l,u]],[/\b(nx\d{3}j) b/i],[s,[d,"ZTE"],[l,h]],[/\b(gen\d{3}) b.+49h/i],[s,[d,"Swiss"],[l,h]],[/\b(zur\d{3}) b/i],[s,[d,"Swiss"],[l,u]],[/\b((zeki)?tb.*\b) b/i],[s,[d,"Zeki"],[l,u]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],s,[l,u]],[/\b(ns-?\w{0,9}) b/i],[s,[d,"Insignia"],[l,u]],[/\b((nxa|next)-?\w{0,9}) b/i],[s,[d,"NextBook"],[l,u]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],s,[l,h]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],s,[l,h]],[/\b(ph-1) /i],[s,[d,"Essential"],[l,h]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[s,[d,"Envizen"],[l,u]],[/\b(trio[-\w\. ]+) b/i],[s,[d,"MachSpeed"],[l,u]],[/\btu_(1491) b/i],[s,[d,"Rotor"],[l,u]],[/(shield[\w ]+) b/i],[s,[d,"Nvidia"],[l,u]],[/(sprint) (\w+)/i],[d,s,[l,h]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[d,"Microsoft"],[l,h]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[s,[d,"Zebra"],[l,u]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[s,[d,"Zebra"],[l,h]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,s,[l,"console"]],[/droid.+; (shield) bui/i],[s,[d,"Nvidia"],[l,"console"]],[/(playstation [345portablevi]+)/i],[s,[d,"Sony"],[l,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[s,[d,"Microsoft"],[l,"console"]],[/smart-tv.+(samsung)/i],[d,[l,m]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[d,"Samsung"],[l,m]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,"LG"],[l,m]],[/(apple) ?tv/i],[d,[s,"Apple TV"],[l,m]],[/crkey/i],[[s,"Chromecast"],[d,"Google"],[l,m]],[/droid.+aft(\w)( bui|\))/i],[s,[d,"Amazon"],[l,m]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[s,[d,"Sharp"],[l,m]],[/(bravia[\w ]+)( bui|\))/i],[s,[d,"Sony"],[l,m]],[/(mitv-\w{5}) bui/i],[s,[d,"Xiaomi"],[l,m]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[d,_],[s,_],[l,m]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,m]],[/((pebble))app/i],[d,s,[l,"wearable"]],[/droid.+; (glass) \d/i],[s,[d,"Google"],[l,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[s,[d,"Zebra"],[l,"wearable"]],[/(quest( 2)?)/i],[s,[d,"Facebook"],[l,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[l,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[s,[l,h]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[s,[l,u]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,u]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[l,h]],[/(android[-\w\. ]{0,9});.+buil/i],[s,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[c,[o,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[o,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[o,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,o]],os:[[/microsoft (windows) (vista|xp)/i],[o,c],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[o,[c,v,y]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[o,"Windows"],[c,v,y]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[o,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[o,"Mac OS"],[c,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[c,o],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[o,c],[/\(bb(10);/i],[c,[o,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[c,[o,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[c,[o,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[o,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[o,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[o,"Chromium OS"],c],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[o,c],[/(sunos) ?([\w\.\d]*)/i],[[o,"Solaris"],c],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[o,c]]},b=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof b))return new b(e,t).getResult();var i=e||(void 0!==r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),n=t?function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i}(T,t):T;return this.getBrowser=function(){var e,t={name:void 0,version:void 0};return S.call(t,i,n.browser),t.major="string"==typeof(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return S.call(e,i,n.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return S.call(e,i,n.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return S.call(e,i,n.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return S.call(e,i,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i="string"==typeof e&&e.length>350?_(e,350):e,this},this.setUA(i),this};b.VERSION="0.7.33",b.BROWSER=f([o,c,"major"]),b.CPU=f(["architecture"]),b.DEVICE=f([s,d,l,"console",h,m,u,"wearable","embedded"]),b.ENGINE=b.OS=f([o,c]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=b),t.UAParser=b):i(207)?void 0===(n=function(){return b}.call(t,i,t,e))||(e.exports=n):void 0!==r&&(r.UAParser=b);var w=void 0!==r&&(r.jQuery||r.Zepto);if(w&&!w.ua){var C=new b;w.ua=C.getResult(),w.ua.get=function(){return C.getUA()},w.ua.set=function(e){C.setUA(e);var t=C.getResult();for(var i in t)w.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(9),r=i(3),a=i(7),s=i(10);class o{logActivity(e,t,i,n){this.sendPenOrInkMinutesEvent(e,i,n)}sendPenOrInkMinutesEvent(e,t,i){const n=[];for(let e=0;e<t.length;e+=1)t[e]&&i[e]&&n.push({name:t[e],string:i[e]});const r={name:"Office.PowerPoint.Online.Data.Activity."+e,dataFields:n};this.sendTelemetryEvent(r)}sendTelemetryEvent(e){try{this.telemetryLogger?this.telemetryLogger.sendTelemetryEvent(e):s.b.sendOtelEvent(e)}catch(e){n.a.sendTraceTag(506856899,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"Failed to send PenOrInkMinutes TelemetryEvent. Ex: "+e)}}constructor(e){e&&e.telemetryLogger&&(this.telemetryLogger=e.telemetryLogger)}}},function(e,t,i){(t=e.exports=function(e){e=e.toLowerCase();var i=t[e];if(!i)throw new Error(e+" is not supported (we accept pull requests)");return new i}).sha=i(210),t.sha1=i(215),t.sha224=i(216),t.sha256=i(179),t.sha384=i(217),t.sha512=i(180)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(22);n.__exportStar(i(218),t),n.__exportStar(i(219),t)},function(e,t,i){"use strict";i.d(t,"a",(function(){return V})),i.d(t,"b",(function(){return U}));var n=i(20),r=i(0),a=i(153),s=i(25),o=i(2),l=i(15),d=i(90),c=i(63),h=i(5),u=i(28),m=i(12),f=i(75),p=i(33),g=i(60),_=i(86),S=i(62);class v{get tapeBuffers(){return this.m_tapeBuffers}get hwTapeBuffers(){return this.m_hwTapeBuffers}releaseGeneratedResources(){if(this.m_hwTapeBuffers&&this.m_engine)for(const e of this.m_hwTapeBuffers)this.m_engine._releaseBuffer(e);this.m_hwTapeBuffers=void 0}onFinalization(){}refreshCachedTapeBuffers(e){return this.m_tapeBuffers||(this.m_tapeBuffers=Object(_.a)(e,Object(f.b)()).buffers),this.m_tapeBuffers}refreshCachedHwTapeBuffers(e,t){if(!this.m_hwTapeBuffers||!this.m_engine||this.m_compatibleGraphicsProcessorId!=t.getUniqueGraphicsProcessorId()){const i=Object(_.a)(e,Object(f.b)(),!1,!1,void 0),n=t.getBabylonEngine();this.m_hwTapeBuffers=i.buffers.map(e=>n.createVertexBuffer(e)),this.m_compatibleGraphicsProcessorId=t.getUniqueGraphicsProcessorId(),this.m_engine=t.getBabylonEngine()}return this.m_hwTapeBuffers}constructor(){this.m_compatibleGraphicsProcessorId=0}}class y{getState(){return this.m_state}getSize(){return this.m_texture?this.m_texture.size:void 0}getLogicalCenter(){return this.m_texture&&this.m_texture.contentLocation?this.m_texture.contentLocation.logicalCenter:void 0}tryConvertToBufferRGBA(){return this.m_texture instanceof m.b?this.m_texture.tryConvertToBufferRGBA():void 0}constructor(e,t){this.m_state=e,this.m_texture=t}}class T{releaseGeneratedResources(){this.m_texture&&(this.m_texture.release(),this.m_state=S.b.deleted)}onFinalization(){}get texture(){return this.m_texture}get loader(){return this.m_loader}set texture(e){this.m_loader&&(this.m_loader.release(),this.m_loader=void 0),this.m_texture=e,this.m_state=S.b.assigned}set loader(e){this.m_texture&&(this.m_texture=void 0),this.m_loader&&this.m_loader!=e&&this.m_loader.release(),this.m_loader=e,this.m_state=S.b.assigned}get state(){return this.m_state}constructor(){this.m_state=S.b.uninitialized}}var b=i(76),w=i(113),C=i(6),I=i(132);function P(e,t,i,n,a){if(!i)return r.c.Identity;const s=i.getType();if(s==o.c.pattern)return r.c.Scale2D(a.scale(1/16));const l=o.b.IsGradient(s);if(s!=o.c.image&&!l)return r.c.Identity;const d=i.rotateWithShape;let c=0;const u=d?r.c.Scale2D(t.transform.scale):t.transform.toMatrix3(),m=Object(h.q)(t,n,u);let f=t.fillBoundsOverride?t.fillBoundsOverride:m;if(t.fillBoundsOverride&&f&&d&&(f=f.transformedBounds(r.c.FromTransforms(t.transform.toInverseMatrix3(),u))),!m||!f)return r.c.Identity;const p=f.size;let g=r.f.One,_=r.f.Zero,S=!0,v=r.a.center;if(s==o.c.image){const t=i;if(_=t.offset,g=t.scale.abs(),c=t.rotation,S=t.isStretched,v=t.alignment,S){if(g=g.multiply(p),t.fillToPreserveAspectRatio){const i=e.getTextureFromImageBrush(t);if(i){const e=i.originalSize.x/i.originalSize.y,t=p.x/p.y;g=g.multiply(new r.f(e>t?e/t:1,e<t?t/e:1))}else C.a.Error(524026452,"No texture")}_=_.multiply(p)}else{const i=e.getTextureFromImageBrush(t);i?g=g.multiply(i.originalSize):C.a.Error(590960595,"No texture")}}else if(s==o.c.pathGradient)g=p;else if(l){const e=i;if(g=e.fillFromRect?e.fillFromRect.size:r.f.One,_=(e.fillFromRect?e.fillFromRect.center:r.f.Zero).subtract(new r.f(.5,.5)).multiply(p),S=e.isStretched||s==o.c.rectangularGradient,s==o.c.linearGradient){g=g.multiply(p);const t=S?r.d.FromSize(r.f.One):r.d.FromSize(g),i=t.transformedBounds(r.c.RotationZ(e.angle));g=i?g.scale(i.width/t.width):g,c=e.angle}else S?g=g.multiply(p):(g=g.scale(Math.max(p.x,p.y)),s==o.c.radialGradient&&(g=g.scale(Math.sqrt(p.x*p.x+p.y*p.y)/Math.max(p.x,p.y))))}else g=g.multiply(p);const y=new r.d(-p.x/2+g.x/2,-p.y/2+g.y/2,p.x/2-g.x/2,p.y/2-g.y/2);_=_.add(Object(h.o)(v,y)).multiply(new r.f(1,-1));let T=r.c.Identity;if(T=T.multiply(r.c.Translation2D(m.center.subtract(f.center))),T=T.multiply(r.c.Scale2D(new r.f(1,-1))),d||(T=T.multiply(r.c.Scale2D(t.transform.scale.sign())),T=T.multiply(r.c.RotationZ(-t.transform.rotation))),T=T.multiply(r.c.Translation2D(_.negate())),c)if(l)T=T.multiply(r.c.Translation2D(f.center.subtract(m.center))),S&&(T=T.multiply(r.c.Scale2D(p.inverse()))),T=T.multiply(r.c.RotationZ(c)),S&&(T=T.multiply(r.c.Scale2D(p))),T=T.multiply(r.c.Translation2D(m.center.subtract(f.center)));else if(s==o.c.image){const e=i.rotationCenter.add(new r.f(-.5,-.5)).multiply(new r.f(g.x,-g.y));T=T.multiply(r.c.RotationAroundPoint(c,e))}return T=T.multiply(r.c.Scale2D(g.inverse())),T=T.multiply(r.c.Scale2D(new r.f(1,-1))),T}function E(e,t,i,n,a,l,d,c,u,f,g,_,S,v,y,T,b,w,E){const x=e.getGraphicsProcessor();if(!x)return void C.a.Error(572867293,"Unable to get graphicsProcessor");const k=Object(h.q)(d,!1);if(!k)return void C.a.Error(588006215,"Unable to get bounds");const M=new p.a(n?n.texture:void 0,Object(m.s)(k,d.transform),c);if(M.fillTexture=i.resolvedFillTexture||void 0,M.lineTexture=i.resolvedLineTexture||void 0,M.pictureTexture=i.resolvedPictureTexture||void 0,M.innerShadowTexture=t.innerShadowTexture||void 0,M.softEdgesTexture=t.softEdgesTexture||void 0,M.fillTransformUV=P(e,d,c.fillBrush,!1,u),M.pictureTransformUV=P(e,d,c.pictureBrush,!1,u),M.lineTransformUV=P(e,d,c.lineBrush,!0,u),M.localClipRect=S,M.fillBrightness=n?n.getFillBrightness():0,M.mergeMode=d.mergeMode,M.distanceFieldMode=n?n.distanceFieldMode:2,M.distRangeSize=n?n.distRangeSize:0,M.softEdges=d.effects&&a&h.b.softEdges?d.effects.softEdges:void 0,M.innerShadow=d.effects&&a&h.b.innerShadow?d.effects.innerShadow:void 0,M.blendingMode=c.blendingMode,M.fillBoundsOverride=d.fillBoundsOverride,M.pictureFillMode=d.style.pictureFillMode,M.hideFill=w,M.hideLine=E,(0==g||7==g)&&t.fade&&(M.fadeInfo={fade:t.fade,fadeTexture:t.fadeTexture,fadeMode:t.fadeMode}),M.clientObject=t,d.text&&d.text.renderMode!=s.k.TextInFrontOfShape)if(d.text&&d.text.cache instanceof I.a&&t.coutoutLayer&&t.coutoutLayer.texture&&t.coutoutLayerCenter){M.textRenderMode=d.text.renderMode;const e=t.coutoutLayer.texture.contentLocation.logicalSize.scale(1/t.coutoutLayer.contentQuality),i=k.multiply(d.transform.scale.abs()),n=t.coutoutLayerCenter;M.textCutoutTransform=r.c.Scale2D(d.transform.scale.sign()),M.textCutoutTransform=M.textCutoutTransform.multiply(r.c.Translation2D(i.center)),M.textCutoutTransform=M.textCutoutTransform.multiply(d.text.frameToShape.toInverseMatrix3()),M.textCutoutTransform=M.textCutoutTransform.multiply(r.c.Translation2D(d.transform.preTranslation.multiply(d.transform.scale.abs()).subtract(n))),M.textCutoutTransform=M.textCutoutTransform.multiply(r.c.Scale2D(i.size.divide(e))),M.textCutoutTexture=t.coutoutLayer.texture}else if(d.text.renderMode!=s.k.ShapeCutout)return;M.overallOpacity=v,M.colorMatrix=y,M.colorOffset=T,M.colorize=b;const A=performance.now();Object(p.f)(x,M,l,u,f,5==g?o.d.White:_,g),e.onLayerRendered(d.role==h.k.text?"text":"shape","SDF",A,M)}var x=i(129),k=i(37),M=i(104),A=i(30),R=i(79);const O={itemHit:void 0,itemStack:void 0,textHit:void 0};let F=0;class D{releaseGeneratedResources(){this.cache.releaseGeneratedResources()}onFinalization(){if(n.p&&!this.cache.isBlankSlate){let e=0,t=0;for(const i of this.cache.getFulltextureList())i&&i.releasePolicy!=m.e.ExternallyManaged&&(e++,t+=i.memoryUsage);const i=n.q?W(this.cache.clientData,n.q):"";C.a.Error(529096734,`Generated resources not released on ${this.isGroup?"Group":"Shape"} ${i}, leaking ${Math.ceil(t/1e4)/100}MB on ${e} textures`)}n.o&&this.releaseGeneratedResources()}constructor(e){this.cache=new b.b,this.isGroup=e}}class L{get color(){const e=this.index%256,t=(this.index-e)/256%256,i=(this.index-e-256*t)/65536%256;return new o.d(e/255,t/255,i/255,1)}next(){this.index++}constructor(){this.index=0}}class B{constructor(e,t,i,n){var a,s;this.scene3D=null!==(a=null==e?void 0:e.scene3D)&&void 0!==a?a:t.scene3D;const o=null!==(s=null==e?void 0:e.fade)&&void 0!==s?s:t.fade;if(o){if(this.fade=o.clone(),o.isDistributedByLength&&null!=e&&e.drawDistribution&&n+1<e.drawDistribution.length){const t=e.drawDistribution[n],i=e.drawDistribution[n+1];this.fade.progress=(o.progress-t)/(i-t)}else o.isDistributedByLength&&e&&C.a.Error(592525086,"Unable to distribute by length"),this.fade.progress=o.progress;if(t.getType()==h.g.group&&o.isDistributedByLength){if(!i.cache.drawDistribution){let e=0;const n=t=>{for(const i of t.paths||[])e+=i.measureLength(r.c.FromTransforms(i.transform,t.transform));return!0};Object(h.n)(t,n);const a=e;let s=0;const o=t;i.cache.drawDistribution=[];for(let t=0;t<o.items.length;t++)i.cache.drawDistribution.push(s/a),e=0,Object(h.n)(o.items.getAt(t),n),s+=e;i.cache.drawDistribution.push(1)}this.drawDistribution=i.cache.drawDistribution}}}}let N=1;class V{getMaxSupportedTextureSize(){const e=this.m_graphicsProcessor;return e?e.maxSupportedTextureSize:(C.a.Error(507012247,"glContext must be provided"),0)}getTextureManager(){return this.m_textureManager}hasMorphPlayer(){return!!this.m_morphPlayer}setMorphPlayer(e){this.m_morphPlayer=e}hasDebugStringProvider(){return!!this.m_debugStringProvider}setDebugStringProvider(e){this.m_debugStringProvider=e}async initializeAsync(e,t){if(this.setWebGLContextOrBabylonEngine(e),!this.m_graphicsProcessor)throw C.a.Error(592328459,"Failed to initialize graphics processor.");await this.m_graphicsProcessor.initializeProgramsAsync(t?t.programIds:void 0)}setBabylonEngine(e){this.setWebGLContextOrBabylonEngine(e)}setWebGLContext(e){this.setWebGLContextOrBabylonEngine(e)}setWebGLContextOrBabylonEngine(e){const t=e instanceof WebGLRenderingContext||e instanceof WebGL2RenderingContext?e:e._gl;this.m_graphicsProcessor&&!this.m_graphicsProcessor.isCurrentWebGLContext(t)&&this.onWebGLContextLost(),this.m_graphicsProcessor?this.m_graphicsProcessor.setWebGLContextOrBabylonEngine(e):this.m_graphicsProcessor=new x.a(e,this.m_babylonWipeStateBetweenScopes,this.m_babylonDisableParallelShaderCompile,this.m_stateRestorer)}onWebGLContextLost(){if(this.m_scratchBuffers){for(let e of this.m_scratchBuffers)e.release();this.m_scratchBuffers=void 0}Object(g.b)(),this.m_graphicsProcessor&&(this.m_graphicsProcessor.onWebGLContextLost(),this.m_graphicsProcessor=void 0)}verifyGlyphCacheIntegrityAndTryRecover(){return!Object(g.h)()||(this.m_glyphCachePreviouslyFailed?(C.a.Error(555782369,"GlyphCache failed for the second time: disable glyph cache"),Object(m.k)(!1)):this.m_glyphCachePreviouslyFailed=!0,Object(g.b)(),!1)}isValid(){return!!this.m_graphicsProcessor&&this.m_graphicsProcessor.isValid()}getGraphicsProcessor(){return this.m_graphicsProcessor}getBabylonEngine(){return this.m_graphicsProcessor?this.m_graphicsProcessor.getBabylonEngine():void 0}getPerformanceSummary(){const e=e=>{if(!e)return;const t=e;for(const e in t)e.endsWith("Ms")&&(t[e]=q(t[e]))};return this.m_perfSummary.averageFrameCost&&(this.m_perfSummary.averageFrameCost=q(this.m_perfSummary.averageFrameCost)),e(this.m_perfSummary.perfInfoCurrentFrame),e(this.m_perfSummary.perfInfoFirstFrame),e(this.m_perfSummary.perfInfoSumOfAllFrames),this.m_perfSummary}resetPerformanceSummary(){this.m_perfSummary=new u.c}getCurrentFramePerformanceSummary(){return this.m_currentFramePerformanceSummary}getDebugStringProvider(){return this.m_debugStringProvider}ensureScratchBuffers(){if(!this.m_scratchBuffers){this.m_scratchBuffers=[];for(let e=0;e<m.p;e++)this.m_scratchBuffers.push(new m.b("ScratchBuffer",this,new r.f(m.q,m.q),m.e.KeepUntilRelease,{isMipMapped:!0}))}return this.m_scratchBuffers}ensureRenderNode(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new D(e.getType()==h.g.group),e.renderDataMap[this.m_rendererId]=t),t}ensurePathRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new v,e.renderDataMap[this.m_rendererId]=t),t}ensureImageRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new T,e.renderDataMap[this.m_rendererId]=t),t}ensureMorphKeyFrameRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new w.b,e.renderDataMap[this.m_rendererId]=t),t}ensureMorphElementRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new w.a,e.renderDataMap[this.m_rendererId]=t),t}attachTextureToImage(e,t){const i=this.ensureImageRenderData(e);e.changeTracker.replaceListener(i.texture,t),i.texture=t}attachLoaderToImage(e,t){const i=this.ensureImageRenderData(e);e.changeTracker.replaceListener(i.texture,t),i.loader=t}getTextureFromImage(e){if(!e)return;const t=this.ensureImageRenderData(e);return t.loader?(C.a.Error(520663959,"getTextureFromImage may return the wrong wrap mode for ImageTextureLoader"),t.loader.getTexture(o.y.clamp)):t.texture}getTextureFromImageBrush(e){if(!e.image)return;const t=this.ensureImageRenderData(e.image);var i;return t.loader?t.loader.getTexture(null!==(i=e.wrapMode)&&void 0!==i?i:o.y.clamp):t.texture}deleteAllTextures(e){e.releaseGeneratedResources()}tryGetImageDebugData(e){const t=this.ensureImageRenderData(e);return new y(t.state,t.texture)}getDebugGlyphCacheInfo(e){return Object(g.d)(e)}generateTextureMemoryReport(e,t){let i={externalImages:0,managedImages:0,scratchBuffers:this.hasHitTestTexture()?4:0,glyphPages:0,shapeDistanceFields:0,textDistanceFields:0,otherBrushes:0,effects:0,rasterizedItems:0,fadeMasks:0,morphTextures:0,totalTarget:0,totalTargetExpected:this.getTextureManager().textureMemoryAllocated};for(let e of this.m_scratchBuffers||[])i.scratchBuffers+=e.memoryUsage;for(let e of g.g||[])i.glyphPages+=e.texture?e.texture.memoryUsage:0;for(let t of e)G(this,t,i);for(let e of t||[])j(this,e,i);return i.totalTarget=i.scratchBuffers+i.glyphPages+i.shapeDistanceFields+i.textDistanceFields+i.otherBrushes+i.effects+i.rasterizedItems+i.fadeMasks+i.morphTextures,i}initOutOfTime(){return this.m_initDeadline&&this.m_initDeadline<performance.now()}updateSettingsBeforeRender(){const e=k.a.readNumberOrDefault("debugMode",-1);-1!=e&&Object(n.B)(e);const t=k.a.readBooleanOrDefault("debugTextLines",!1);t&&Object(n.h)(t);const i=k.a.readNumberOrDefault("quality",0);0!=i&&Object(m.r)(i),k.a.readBooleanOrDefault("disableGlyphTable",!1)&&Object(m.k)(!1);const r=k.a.readNumberOrDefault("hitTestSlop",0);0!=r&&Object(n.G)(r);const a=k.a.readNumberOrDefault("minLineWidth",0),s=k.a.readNumberOrDefault("minLineWidthForArrowHead",0);0==a&&0==s||Object(n.J)(a||n.w,s||n.x);const o=k.a.readNumberOrDefault("hitTestCache",0);0!=o&&Object(n.F)(o);const l=k.a.readBooleanOrDefault("useLegacyBrightness",n.z);Object(n.L)(l);const d=k.a.readBooleanOrDefault("useLegacyContrast",n.A);Object(n.M)(d);const c=k.a.readNumberOrDefault("glyphCacheTextureResolution",0);0!=c&&Object(n.E)(c);const h=k.a.readNumberOrDefault("glyphCacheMaxFactor",0);0!=h&&Object(n.D)(h);const u=k.a.readBooleanOrDefault("exportAsStraightAlpha",!1);u&&Object(n.C)(u)}fillRenderRectMap(e,t,i,n,a,s,o,l,d){const c=t.changeTracker.currentUniqueId+","+t.animationChangeTracker.currentUniqueId+","+s.index+(o?"+"+o:"")+(d?"*":""),u=t.instances?t.instances.length:1;for(let m=0;m<u;m++){const u=t.instances?t.instances[m].transform.toMatrix3().multiply(n):n,f=t.instances?c+","+m:c;if(t instanceof h.j||t.effects.hasEffects){let n=t.getBounds(!l,!0,!0,u);if(t instanceof h.j&&t.style.pictureOverflow&&t.style.pictureBrush){const e=t.fillBoundsOverride?t.fillBoundsOverride:Object(h.q)(t,!1,t.transform.toMatrix3()),i=this.getTextureFromImageBrush(t.style.pictureBrush);if(e&&i){const a=new r.e(e.center.negate(),r.f.Flip(t.transform.scale.x<0,t.transform.scale.y<0),0,e.center),s=r.c.FromTransforms(a,u),o=t.animationTransform?r.c.FromTransforms(s,t.animationTransform):s,l=Object(p.g)(e,t.style.pictureBrush,i,o);l&&(n=r.d.UnionRect(n,l))}}l&&(n=n?n.transformedBounds(l):n),n=n?n.transformedBounds(a):n,n=i?r.d.IntersectRect(i,n):n,n&&(e[f]=n)}if(t instanceof h.d){const n=(t.animationTransform||t.fade?t.animationChangeTracker.currentUniqueId:"")+":"+t.opacity+"/"+o,r=l||t.animationTransform;for(let o of t.items.elements)s.next(),this.fillRenderRectMap(e,o,i,t.transform.toMatrix3().multiply(u),a,s,n,r,d||t.isHidden)}}}calculateDirtyRect(e,t){let i,n=n=>{const a=e[n],s=t[n];Object(r.j)(a,s)||(i=r.d.UnionRect(i,a),i=r.d.UnionRect(i,s))};for(let t in e)n(t);for(let e in t)n(e);return i?i.inflate(2):void 0}getLastRenderRectMap(){return this.m_lastRenderRectMap}render(e,t,i,n){this.renderBatch([{item:e,eraseBackground:t,options:i}],n)}renderBatch(e,t){var i;if(!this.isValid())return void C.a.Message(512297154,"renderer context not valid in renderBatch");this.m_lastRenderRectMap=void 0,this.m_verboseRenderLogging&&C.a.Message(538208403,"RenderBatch begin");const n=null==t?void 0:t.enableDirtyRect,a=null==t?void 0:t.previousRenderRectMap;let s,l;const d=this.m_graphicsProcessor;if(!d)return void C.a.Error(592525091,"glContext must be provided");this.updateSettingsBeforeRender();const c=performance.now();if(n){s={};for(let t of e){var f,p;const e=new L;this.fillRenderRectMap(s,t.item,null===(f=t.options)||void 0===f?void 0:f.scissor,r.c.Identity,(null===(p=t.options)||void 0===p||null===(p=p.transform)||void 0===p?void 0:p.toMatrix3())||r.c.Identity,e,void 0,void 0,!1)}a&&(l=this.calculateDirtyRect(a,s))}if(this.m_verboseRenderLogging&&C.a.Message(525960788,"RenderBatch computed RenderRectMap"),!d.beginRenderScope())return;this.m_verboseRenderLogging&&C.a.Message(538208404,"RenderBatch entered render scope");const _=new u.b;_.glResetCostMs+=performance.now()-c,_.beginTime=(new Date).getTime(),this.m_currentFramePerformanceSummary=_,_.totalCostMs=-performance.now();for(let t of e)this.tryPrepareItemInWebGlScope(t.item,d,!0,void 0)||C.a.Error(592525120,"could not fully prepare scene");if(_.shapeRenderCostMs=-performance.now(),this.m_verboseRenderLogging&&C.a.Message(538208405,"RenderBatch Items prepared"),l||!n||!a)for(let t of e)this.renderItemInWebGLRenderScope(t.item,t.eraseBackground,t.options,l);this.m_verboseRenderLogging&&C.a.Message(538208406,"RenderBatch Items rendered");const v=e.length>0&&(null===(i=e[0].options)||void 0===i?void 0:i.target)instanceof m.b?e[0].options.target.size:d.getCurrentViewportSize();if(g.f&&Object(g.c)(d,v),_.shapeRenderCostMs+=performance.now(),_.glRestoreCostMs=-performance.now(),l&&k.a.readBooleanOrDefault("debugDirtyRects",!1)){const e=h.j.CreateRectangle(l,new o.x(new o.v(new o.d(Math.random(),Math.random(),Math.random(),.25))));this.renderItemInWebGLRenderScope(e,void 0)}if(d.endRenderScope(),_.glRestoreCostMs+=performance.now(),_.totalCostMs+=performance.now(),_.endTime=(new Date).getTime(),this.m_perfSummary.perfInfoCurrentFrame=_,this.m_perfSummary.perfInfoFirstFrame||(this.m_perfSummary.perfInfoFirstFrame=_),this.m_perfSummary.perfInfoSumOfAllFrames||(this.m_perfSummary.perfInfoSumOfAllFrames=new u.b),this.m_perfSummary.perfInfoSumOfAllFrames.add(_),this.m_perfSummary.frameCount++,this.m_perfSummary.averageFrameCost=this.m_perfSummary.perfInfoSumOfAllFrames.totalCostMs/this.m_perfSummary.frameCount,this.m_perfSummary.viewWidth=v.x,this.m_perfSummary.viewHeight=v.y,this.m_perfSummary.frameCount>1){const e=(this.m_perfSummary.perfInfoSumOfAllFrames.totalCostMs-this.m_perfSummary.perfInfoFirstFrame.totalCostMs)/(this.m_perfSummary.frameCount-1);this.m_perfSummary.estimatedFps=Math.floor(Math.min(1e3/e,60))}else this.m_perfSummary.estimatedFps=Math.floor(Math.min(1e3/this.m_perfSummary.perfInfoCurrentFrame.shapeRenderCostMs,60));this.m_currentFramePerformanceSummary=new u.b,S.a.OnRender(this,e),this.m_verboseRenderLogging&&C.a.Message(538208407,"RenderBatch finished"),this.m_lastRenderRectMap=s}renderItemInWebGLRenderScope(e,t,i,n){const a=this.m_graphicsProcessor;if(!a)return void C.a.Error(592525121,"glContext must be provided");a.updateViewportSize();const s=i?i.target:void 0,o=s?s.size:a.getCurrentViewportSize(),l=i?i.transform:void 0,d=null!=i&&i.scissor&&n?r.d.IntersectRect(null==i?void 0:i.scissor,n):(null==i?void 0:i.scissor)||n;if((null!=i&&i.scissor||n)&&!d)return;a.setScissorRect(null==d?void 0:d.inflateToInteger(),!0);const c=performance.now(),u=a.activateShaderProgram(A.a.shapeRender);if(this.isVerboseRenderLoggingEnabled()){const e=q(performance.now()-c);C.a.Message(529077967,`RenderBatch shapeRender shader activation cost ${e}ms`)}u.begin(s?s.tryGetBabylonTextureForRenderToTexture(a):void 0,t,!0),this.drawItem(h.b.all,u,e,o,r.c.Identity,void 0,l?l.toMatrix3():r.c.Identity,0,void 0,!1,i,d,void 0),u.end(),a.setScissorRect(void 0)}renderMorph(e,t,i,n,r){if(!this.m_morphPlayer)throw C.a.Error(591667344,"Morph not available for this renderer");this.m_morphPlayer.renderMorph(this,e,t,i,n,r)}tryPrepareMorph(e,t){if(!this.m_morphPlayer)throw C.a.Error(591667345,"Morph not available for this renderer");return this.m_morphPlayer.tryPrepareMorph(this,e,t)}tryGetImageDebugDataForMorphKeyFrame(e){const t=this.ensureMorphKeyFrameRenderData(e);return t.texture?new y(S.b.assigned,t.texture):void 0}renderLayers(e,t,i){const n=this.m_graphicsProcessor;if(!n)return void C.a.Error(592525125,"glContext must be provided");if(n&&!n.beginRenderScope())return;const r=this.m_targetTexture?this.m_targetTexture.size:n.getCurrentViewportSize(),a=n.activateShaderProgram(A.a.shapeRender);a.begin(this.m_targetTexture?this.m_targetTexture.tryGetBabylonTextureForRenderToTexture(n):void 0,t,!0),p.j&&a.clearAndEnbaleDepthBuffer();for(let t=0;t<e.length;t++){let s=e[t];Object(p.f)(n,s,a,r,i?i.toMatrix3():void 0,void 0)}a.end(),n.endRenderScope()}retrieveHitTestResult(e,t,i,n){if(t==i.index){const t={itemHit:e,itemStack:[e],textHit:void 0};if(e instanceof h.j){const i=e.text;if(i){const a=n.transformPoint(r.c.FromTransforms(new r.e(e.transform.translation.negate()),i.frameToShape.toInverseMatrix3(),i.layoutToFrame.toInverseMatrix3()));t.textHit=i.hitTest(a)?i.getSelectionFromLayoutPosition(a):void 0}}return t}if(e instanceof h.d)for(const r of e.items.elements){i.next();const a=this.retrieveHitTestResult(r,t,i,n.transformPoint(e.transform.toInverseMatrix3()));if(null!=a&&a.itemStack)return a.itemStack.splice(0,0,e),a}}renderHitTestBuffer(e,t,i,n,a){const s=performance.now();this.m_hitTestCache=void 0;const l=this.m_graphicsProcessor;if(!l)return void C.a.Error(592525129,"glContext must be provided");if(!l.beginRenderScope())return;this.tryPrepareItemInWebGlScope(e,l,!0,void 0)||C.a.Error(592525131,"could not fully prepare"),this.m_hitTestTexture&&this.m_hitTestTexture.isValid(this)&&this.m_hitTestTexture.size.equals(i)||(this.m_hitTestTexture&&this.m_hitTestTexture.release(),this.m_hitTestTexture=new m.b("HitTestPixel",this,i,m.e.KeepUntilRelease));const d=new L,c=l.activateShaderProgram(A.a.shapeRender);c.begin(this.m_hitTestTexture.tryGetBabylonTextureForRenderToTexture(l),o.d.Transparent,!0);const u=t.negate(),f=n?n.toMatrix3().multiply(r.c.Translation2D(u)):r.c.Translation2D(u);this.drawItem(h.b.none,c,e,this.m_hitTestTexture.size,r.c.Identity,void 0,f,7,d,!1,{filter:a},void 0,void 0),c.end(),this.m_hitTestTexture.renderCost=performance.now()-s;const p=this.m_hitTestTexture.tryUseBabylonTargetTexture(l,void 0,"hitTest"),g=p?l.copyTexturePixelsToArray(p,new r.d(0,0,this.m_hitTestTexture.size.x,this.m_hitTestTexture.size.y),!0):void 0;l.endRenderScope(),g&&(this.m_hitTestCache={buffer:g,uniqueId:e.changeTracker.currentUniqueId,origin:t,renderTransform:n})}isHitTestBufferValid(e,t,i,a,s){if(s||0==n.t||!this.m_hitTestCache||this.m_hitTestCache.uniqueId!=e.changeTracker.currentUniqueId)return!1;if(!this.m_hitTestCache.renderTransform&&!a||this.m_hitTestCache.renderTransform&&a&&!this.m_hitTestCache.renderTransform.toMatrix3().equals(a.toMatrix3()))return!1;const o=this.m_hitTestCache.origin?new r.d(this.m_hitTestCache.origin.x,this.m_hitTestCache.origin.y,this.m_hitTestCache.origin.x+i.x-1,this.m_hitTestCache.origin.y+i.y-1):void 0;return!(!o||!o.isPointInRect(t))}hitTestScene(e,t,i,a){if(!this.isValid())return C.a.Message(512297153,"renderer context not valid in hitTestScene"),O;const s=n.t&&!a?new r.f(n.t,n.t):r.f.One;if(!this.isHitTestBufferValid(e,t,s,i,a)){const n=t.floor().subtract(new r.f(Math.floor(s.x/2),Math.floor(s.y/2)));this.renderHitTestBuffer(e,n,s,i,a)}if(!this.m_hitTestCache)return O;const o=t.subtract(this.m_hitTestCache.origin).floor(),l=4*(o.x+(s.y-1-o.y)*s.x);if(l<0||l+3>=this.m_hitTestCache.buffer.length||0==this.m_hitTestCache.buffer[l+3])return O;const d=this.m_hitTestCache.buffer[l+0]+256*this.m_hitTestCache.buffer[l+1]+65536*this.m_hitTestCache.buffer[l+2],c=new L,h=i instanceof r.c?i.tryGetTransform(r.f.Zero):i,u=h?h.toInverseMatrix3():void 0;return this.retrieveHitTestResult(e,d,c,u?t.transformPoint(u):t)||(F++,F<=100&&C.a.Error(592525132,"Unable to retrieve hit shape "+d),100==F&&C.a.Error(520119570,"Hit test failed too many times, not reporting anymore"),O)}hasHitTestTexture(){return null!=this.m_hitTestTexture}tryInitTextures(e,t,i,n,a){var d;if(t.isHidden)return!0;const f=this.ensureRenderNode(t);f.cache.beforeInitTextures(t,e);const p=new B(n,t,f,a),_=t instanceof h.j&&void 0!==t.shape3D,S=t instanceof h.j&&(null===(d=t.effects.textureEffect)||void 0===d||null===(d=d.getOptions())||void 0===d?void 0:d.useDistanceField);if(t instanceof h.j){const n=t;if(n.incrementalPath&&(f.cache.initTextureStage=b.a.fromBegining),f.cache.initTextureStage<b.a.distanceFieldsReady){if(n.incrementalPath)f.cache.distanceFields&&1==f.cache.distanceFields.length||(f.cache.distanceFields=[new g.a("DistanceField/incremental",this,void 0,l.e.none,h.h.fragment,0,m.e.DisposableCache,!1)]);else if(n.paths){const e=(_||S)&&!f.cache.getBevelDistanceField();if(!f.cache.distanceFields&&!n.isSolidRect()||e){var v;let e=-performance.now();if(f.cache.distanceFields=[],(null===(v=n.paths)||void 0===v?void 0:v.length)>0){let e=0,i=0,r=n.paths[0].fillMode;for(let t=0;t<n.paths.length;t++){const a=t==n.paths.length-1,d=a?l.e.none:n.paths[t+1].fillMode;(a||d!=r)&&(!n.style.hasLine||n.style.pen.headEnd.end==o.q.none&&n.style.pen.tailEnd.end==o.q.none?f.cache.distanceFields.push(new g.a("DistanceField/fillAndLine",this,s.j.FromFirstLast(e,i),r,n.mergeMode,0,m.e.DisposableCache,!1)):(r!=l.e.none&&null!=n.style.fillBrush&&f.cache.distanceFields.push(new g.a("DistanceField/fillOnly",this,s.j.FromFirstLast(e,i),r,n.mergeMode,1,m.e.DisposableCache,!1)),f.cache.distanceFields.push(new g.a("DistanceField/arrowAndLine",this,s.j.FromFirstLast(e,i),r,n.mergeMode,2,m.e.DisposableCache,!1))),r=d,e=t+1),i=t+1}if(_||S){var y;const e=new g.a("DistanceField/displacement",this,void 0,r,n.mergeMode,0,m.e.DisposableCache,!0);e.minimalPadding=t instanceof h.j?null===(y=t.effects.textureEffect)||void 0===y||null===(y=y.getOptions())||void 0===y?void 0:y.distanceFieldMinimalPadding:void 0,f.cache.distanceFields.push(e)}}if(e+=performance.now(),n.role==h.k.text?this.m_currentFramePerformanceSummary.distanceFieldForTextCostMs+=e:this.m_currentFramePerformanceSummary.distanceFieldForShapeCostMs+=e,this.initOutOfTime())return!1}}for(const e of f.cache.distanceFields||[]){let t=-performance.now();const i=null!=n.incrementalPath;let r=e.refresh(this,n,i);if(!r&&i&&(r=e.refresh(this,n,!1)),r||C.a.Error(592525133,"error in distanceField refresh"),t+=performance.now(),n.role==h.k.text?this.m_currentFramePerformanceSummary.distanceFieldForTextCostMs+=t:this.m_currentFramePerformanceSummary.distanceFieldForShapeCostMs+=t,this.initOutOfTime())return!1}f.cache.initTextureStage=b.a.distanceFieldsReady}if(f.cache.initTextureStage<b.a.brushTexturesReady||n.instances){if(f.cache.initBrushTexture(this,t,h.a.fill),this.initOutOfTime())return!1;if(f.cache.initBrushTexture(this,t,h.a.line),this.initOutOfTime())return!1;if(f.cache.initBrushTexture(this,t,h.a.picture),this.initOutOfTime())return!1;f.cache.initTextureStage=b.a.brushTexturesReady}if(n.text&&n.text.cache)if(n.text.renderMode==s.k.TextInFrontOfShape){let t=0;for(const a of n.text.cache.textShapes||[]){if(n.text.animationProps)if(a.textRange){const e=n.text.animationProps.getAt(a.textRange.start);a.fade=e.fade,a.animationTransform=e.animationTransform,a.isHidden=e.isHidden}else C.a.Error(592525134,"no range");else a.fade=void 0,a.animationTransform=r.c.Identity,a.isHidden=!1;if(!this.tryInitTextures(e,a,i,p,t))return!1;t++}for(const t of n.text.cache.selectionShapes||[])if(!this.tryInitTextures(e,t,i,p,0))return!1;for(const t of n.text.cache.hitTestLineShapes||[])if(!this.tryInitTextures(e,t,i,p,0))return!1}else f.cache.initTextCutoutLayer(this,n.text.cache.cutoutLayerPaths,n)}else{if(!(t instanceof h.d))throw C.a.Error(592525135,"Unknown Item type");{f.cache.initTextureStage<b.a.brushTexturesReady&&(f.cache.initBrushTexture(this,t,h.a.fill),f.cache.initTextureStage=b.a.brushTexturesReady);const n=t;for(let t=0;t<n.items.length;t++){const r=n.items.getAt(t);if(r&&!this.tryInitTextures(e,r,i,p,t))return!1;if(this.initOutOfTime())return!1}}}let T=-performance.now();if(f.cache.fade=p.fade,f.cache.initFadeTexture(this,t,p.fade),T+=performance.now(),t.fade&&(this.m_currentFramePerformanceSummary.fadeTextureCostMs+=T),this.initOutOfTime())return!1;if(i&&f.cache.initTextureStage<b.a.effectsReady){if(t.effects){if(t.effects.innerShadow&&t.effects.innerShadow.color.a>0&&!f.cache.innerShadowTexture&&(f.cache.innerShadowTexture=this.createTextureRasterizedItem("Effect/InnerShadow",t,h.b.none,f.cache.innerShadowTexture,o.d.Black,t.effects.innerShadow.radius,h.b.innerShadow,2,m.g,m.e.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.softEdges&&t.effects.softEdges.radius>0&&!f.cache.softEdgesTexture&&(f.cache.softEdgesTexture=this.createTextureRasterizedItem("Effect/SoftEdges",t,h.b.none,f.cache.softEdgesTexture,o.d.Black,t.effects.softEdges.radius,h.b.softEdges,5,m.g,m.e.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.border&&t.effects.border.radius>0&&t.effects.border.color.a>0&&!f.cache.borderTexture&&(f.cache.borderTexture=this.createTextureRasterizedItem("Effect/Border",t,h.b.softEdges,f.cache.borderTexture,t.effects.border.color,t.effects.border.radius,h.b.border,4,m.g,m.e.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.replicate){if(!f.cache.replicateBottomTexture&&(f.cache.replicateBottomTexture=Object(M.a)(this,t,t.effects.replicate,!1),this.initOutOfTime()))return!1;if(!f.cache.replicateTopTexture&&(f.cache.replicateTopTexture=Object(M.a)(this,t,t.effects.replicate,!0),this.initOutOfTime()))return!1}if(t.effects.glow&&t.effects.glow.radius>0&&t.effects.glow.color.a>0&&!f.cache.glowTexture&&(f.cache.glowTexture=this.createTextureRasterizedItem("Effect/Glow",t,h.b.softEdges|h.b.border|h.b.replicate,f.cache.glowTexture,t.effects.glow.color,2*t.effects.glow.radius,h.b.glow,3,m.g,m.e.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.shadow&&t.effects.shadow.color.a>0&&!f.cache.shadowTexture&&(f.cache.shadowTexture=this.createTextureRasterizedItem("Effect/Shadow",t,h.b.softEdges|h.b.border|h.b.replicate|h.b.glow,f.cache.shadowTexture,t.effects.shadow.color,t.effects.shadow.radius,h.b.shadow,6,m.g,m.e.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.reflection&&!f.cache.reflectionTexture&&(f.cache.reflectionTexture=this.createTextureRasterizedItem("Effect/Reflection",t,h.b.innerShadow|h.b.softEdges|h.b.border|h.b.replicate|h.b.glow|h.b.shadow,f.cache.reflectionTexture,void 0,t.effects.reflection.radius,h.b.reflection,6,m.g,m.e.DisposableCache),this.initOutOfTime()))return!1}f.cache.initTextureStage=b.a.effectsReady}if(i)if(_||t.fade&&t.fade.preset!=c.d.draw||t instanceof h.d&&t.opacity<1||t.effects.textureEffect){f.cache.spriteHitTest=_||void 0!==t.fade&&t.fade.preset!=c.d.draw;const i=t.animationTransform?t.animationTransform.transformVector(r.f.One.scale(Math.sqrt(2)/2)).length():1,n=Math.max(.1,m.i*i);if(!f.cache.spriteTexture||f.cache.spriteTexture.tag!=t.changeTracker.currentUniqueId||f.cache.spriteQuality<n){var w;let i;if(f.cache.spriteTexture&&(this.fixedMemoryLeakAmounts.recreatingSprites+=f.cache.spriteTexture.memoryUsage),null===(w=f.cache.spriteTexture)||void 0===w||w.release(),i=_?function(e,t,i,n){const a=e.getGraphicsProcessor();if(!a)return void C.a.Error(572867290,"failed to get graphicsProcessor");const s=e.ensureRenderNode(t),l=Object(h.p)(t,!0,h.b.all,h.b.all,t.transform.toInverseMatrix3().multiply(r.c.Scale2D(t.transform.scale))),d=U(t),c=e.createTextureRasterizedItem("RasterizeFor3D/Item",t,h.b.innerShadow|h.b.softEdges,s.cache.spriteTexture,void 0,0,h.b.none,1,n,m.e.DisposableCache),f=s.cache.glowTexture||s.cache.borderTexture||s.cache.shadowTexture||s.cache.reflectionTexture||s.cache.replicateBottomTexture?e.createTextureRasterizedItem("RasterizeFor3D/Effects",t,h.b.all,s.cache.spriteTexture,void 0,0,h.b.none,8,n,m.e.DisposableCache):void 0,p=s.cache.getBevelDistanceField();let g;if(l&&d&&c&&null!=p&&p.texture){const s=Math.min(n,m.h/l.size.x,m.h/l.size.y),_=new r.f(Math.min(m.h,Math.ceil(l.size.x*s)),Math.min(m.h,Math.ceil(l.size.y*s)));g=new m.b("rasterized3D",e,_,m.e.DisposableCache),g.tag=t.changeTracker.currentUniqueId,g.contentLocation={logicalCenter:d.center.subtract(l.leftTop).scale(s),logicalSize:d.size.scale(s),physicalCenter:g.size.scale(.5),physicalSize:g.size,rotation:0,flipX:!1,flipY:!1};const S=g.tryGetBabylonTextureForRenderToTexture(a);if(S){let n,s=r.f.Zero;t instanceof h.j&&t.shape3D&&t.shape3D.topBevel&&(n=function(e,t,i,n){function a(e,t,i){for(let n=Math.floor(t.x);n<=Math.floor(i.x);n++)n>=0&&n<e.length&&(e[n]=Math.max(e[n],t.y+(n-t.x)*(i.y-t.y)/(i.x-t.x)))}const s=new Array(256);s.fill(0),i.forEachSegment((e,t,i)=>{if(t){const n=Math.max(8,i.x-e.x);for(let o=0;o<n;o++)a(s,r.f.InterpolateQuadratic(e,t,i,o/n),r.f.InterpolateQuadratic(e,t,i,(o+1)/n))}else a(s,e,i);return!0},r.c.Scale2D(n));const l=new Float32Array(768);for(let e=0;e<256;e++)l[3*e]=l[3*e+1]=l[3*e+2]=s[e];return m.c.CreateFromByteBuffer("PathProfile",e,new r.f(256,1),l,u.d.RGB,o.y.clamp,!0)}(e,0,t.shape3D.topBevel.profile,new r.f(255,1)),s=t.shape3D.topBevel.size);const l=a.activateShaderProgram(A.a.draw3D);l.begin(S,o.d.Transparent,!0),f&&$(a,l,f,void 0,void 0,g.size,g.contentLocation.logicalSize,g.contentLocation.logicalCenter,r.f.Zero,0,void 0,void 0,o.d.Transparent,0),$(a,l,c,p,n,g.size,g.contentLocation.logicalSize,g.contentLocation.logicalCenter,s,t instanceof h.j?t.style.pen.lineWidth:0,i,t instanceof h.j&&t.shape3D?t.shape3D.material:void 0,t instanceof h.j&&t.shape3D&&t.shape3D.contourColor?t.shape3D.contourColor:o.d.Transparent,t instanceof h.j&&t.shape3D?t.shape3D.adjustedContourWidth:0),l.end(),n&&n.release()}else C.a.Error(572867291,"failed to get textureTarget")}else C.a.Error(572867292,"failed to get textures for 3D rendering");return c&&c.release(),f&&f.release(),g}(this,t,p.scene3D,n):this.createTextureRasterizedItem("SpriteCache",t,h.b.all,f.cache.spriteTexture,void 0,0,h.b.none,1,n,m.e.DisposableCache),t.effects.textureEffect&&i&&i.contentLocation){let n=t.effects.textureEffect.getSizeAndLocation(i.size,i.contentLocation);if(n.size=n.size.ceil(),n.size.x>R.a||n.size.y>R.a){C.a.Error(506046549,`TextureEffect asked size is too big ( ${n.size.x} x ${n.size.y} ), texture is downscaled to max recommended ${R.a}`);const e=Math.min(R.a/n.size.x,R.a/n.size.y),t=n.location;n.size=n.size.scale(e).ceil(),n.location={logicalCenter:t.logicalCenter.scale(e),logicalSize:t.logicalSize.scale(e),physicalCenter:t.physicalCenter.scale(e),physicalSize:t.physicalSize.scale(e),rotation:t.rotation,flipX:t.flipX,flipY:t.flipY}}const a=new m.b("TextureEffect",this,n.size,m.e.KeepUntilRelease),s=t.effects.textureEffect.getOptions(),o={sizeAndLocation:n};if(s.usePath&&t instanceof h.j&&t.paths){const e=U(t);if(e&&t.paths){const a=n.location.logicalSize.divide(e.size),s=new r.e(e.center.negate(),t.transform.scale.multiply(a),0,i.contentLocation.logicalCenter);o.paths=t.paths.map(e=>e.copyTransformed(s))}}if(s.useDistanceField&&t instanceof h.j){const e=f.cache.getBevelDistanceField();null!=e&&e.texture&&(o.distanceField={texture:e.texture,distRangeSize:e.distRangeSize})}e.endRenderScope(),t.effects.textureEffect.render(this,a,i,o),e.beginRenderScope(),a.contentLocation=n.location,i.release(),f.cache.spriteTexture=a}else f.cache.spriteTexture=i;if(f.cache.spriteTexture&&(f.cache.spriteTexture.tag=t.changeTracker.currentUniqueId,f.cache.spriteQuality=n),this.initOutOfTime())return!1}}else{var I;null===(I=f.cache.spriteTexture)||void 0===I||I.release(),f.cache.spriteTexture=void 0,f.cache.spriteQuality=0,f.cache.spriteHitTest=!1}return!0}tryPreparePaths(e){for(const t of e)if(this.ensurePathRenderData(t).refreshCachedTapeBuffers(t),this.initOutOfTime())return!1;return!0}tryPrepareGeneratedShapes(e){const t=this;return Object(h.n)(e,e=>(Object(h.l)(e),!t.initOutOfTime()))}tryPrepareTapes(e){const t=this;return Object(h.n)(e,e=>{if(e.paths){if(!t.tryPreparePaths(e.paths))return!1;if(e.shapeBoundsCache&&e.shapeBoundsCache.geometryVersion==e.geometryTracker.version||(e.shapeBoundsCache={geometryVersion:e.geometryTracker.version}),e.shapeBoundsCache.pathsBounds||e.style.hasLine||(e.shapeBoundsCache.pathsBounds=Object(d.c)(e.paths)),t.initOutOfTime())return!1}return!0})}tryPrepareItemInWebGlScope(e,t,i,n){const r=performance.now();if(this.m_initDeadline=n?r+n:void 0,t){if(!t.tryPrepareProgramResourcesInWebGlScope(this.m_initDeadline))return!1}else Object(f.b)();if(!this.tryPrepareGeneratedShapes(e))return!1;if(!this.tryPrepareTapes(e))return!1;if(t){let n=!1;return Object(g.e)(this,e),this.initOutOfTime()||(n=this.tryInitTextures(t,e,i,void 0,0)),n}return!0}tryPrepareItem(e,t,i){if(!this.isValid())return C.a.Message(512297152,"renderer context not valid in tryPrepareItem"),!1;const n=this.m_graphicsProcessor;if(!n)return C.a.Error(592525136,"glContext must be provided"),!1;if(this.updateSettingsBeforeRender(),!n.beginRenderScope())return!1;const r=this.tryPrepareItemInWebGlScope(e,n,t,i);return n.endRenderScope(),r}drawItem(e,t,i,n,r,a,s,o,l,d,c,u,m){const f=i.instances||h.e.DefaultArray;for(let I of f){let f=i;if(i instanceof h.d&&void 0!==I.groupIndex&&i.items.length>0){const e=I.groupIndex;e>=0&&e<i.items.length?f=i.items.getAt(e):(f=void 0,C.a.Error(509617671,`Instance index out of range: ${e}, count: ${i.items.length}`))}if(f){var p,g,_,S,v,y,T,b,w;const i=null!==(p=I.transform.toMatrix3().multiply(r))&&void 0!==p?p:r,h={opacity:null!==(g=null!==(_=I.opacity)&&void 0!==_?_:null==m?void 0:m.opacity)&&void 0!==g?g:1,colorMatrix:null!==(S=null!==(v=I.colorMatrix)&&void 0!==v?v:null==m?void 0:m.colorMatrix)&&void 0!==S?S:void 0,colorOffset:null!==(y=null!==(T=I.colorOffset)&&void 0!==T?T:null==m?void 0:m.colorOffset)&&void 0!==y?y:void 0,colorize:null!==(b=null!==(w=I.colorize)&&void 0!==w?w:null==m?void 0:m.colorize)&&void 0!==b?b:void 0};this.drawItemOnce(e,t,f,n,i,a,s,o,l,d,c,u,h)}}}drawItemOnce(e,t,i,a,o,l,d,c,u,f,g,_,S){var v,y,T,b;const w=0==c||7==c,C=l||i.animationTransform,I=i instanceof h.j?i.role==h.k.text?"text":"shape":"group",P=w&&C?o.multiply(C.multiply(d)):o.multiply(d);if(!this.m_graphicsProcessor||9==c||7==c&&i.isHitTestHidden||i.isHidden||g&&g.filter&&!g.filter(i)||i instanceof h.d&&0==i.opacity){if(i instanceof h.d)for(const e of i.items.elements)u&&u.next(),this.drawItem(h.b.all,t,e,a,o,l,d,9,u,f,g,_,S);return}this.m_graphicsProcessor.setScissorRect(null==_?void 0:_.inflateToInteger(),!0);const x=this.ensureRenderNode(i);let k=null===(v=x.cache)||void 0===v?void 0:v.fade,M=null!==(y=null===(T=x.cache)||void 0===T?void 0:T.fadeMode)&&void 0!==y?y:0;const A=7==c?1:(null!==(b=null==S?void 0:S.opacity)&&void 0!==b?b:1)*(i instanceof h.d?i.opacity:1),R=U(i);let O,F=!1;if(i instanceof h.j&&i.clipBounds&&R&&(O=i.getBounds(),O=O?O.transformedBounds(i.transform.toInverseMatrix3()):void 0,O=O?i.clipBounds.clip(O):void 0,O=O?O.translate(R.center.negate()).multiply(i.transform.scale):void 0,F=!O),w&&x.cache.spriteTexture&&(7!=c||x.cache.spriteHitTest)){if(R&&!F){const e=new p.d(x.cache.spriteTexture,Object(m.s)(R,i.transform));e.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,e.localClipRect=O,e.clientObject=x.cache,e.overallOpacity=A,e.colorMatrix=null==S?void 0:S.colorMatrix,e.colorOffset=null==S?void 0:S.colorOffset,e.colorize=null==S?void 0:S.colorize;const n=performance.now();Object(p.f)(this.m_graphicsProcessor,e,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"SpriteCache",n,e)}}else{const l=e!=h.b.none&&i.effects&&(i.effects.glow||i.effects.shadow||i.effects.reflection||i.effects.border||i.effects.replicate)&&n.a==n.b&&7!=c&&!(g&&g.textRange)&&R&&!F;if(l){const n=R.center.transformPoint(i.transform);let s;if(e&h.b.reflection&&i.effects.reflection||e&h.b.shadow&&i.effects.shadow){const e=new r.e(n.negate(),r.f.One,i.effects.direction,n);s=i.effectsBoundsOverride?i.effectsBoundsOverride.transformedBounds(e):Object(h.p)(i,!1,h.b.none,h.b.border|h.b.glow,e.toMatrix3())}const o=R?Object(m.s)(R,i.transform):void 0,l=o?new r.e(r.f.Zero,r.f.Flip(o.flipX,o.flipY),o.rotation+i.effects.direction,o.center):void 0,d=l?l.toInverseMatrix3():void 0;if(e&h.b.reflection&&i.effects.reflection&&x.cache.reflectionTexture&&s&&R&&o&&l&&d&&!F){let e=i.effects.reflection,n=s.bottom+e.distance/2;i instanceof h.j&&i.textEffectMetrics&&(n-=i.textEffectMetrics.descent);const m=r.c.Translation2D(new r.f(0,-n)).multiply(r.c.Scale2D(new r.f(1,-1))).multiply(r.c.Translation2D(new r.f(0,n)));let f=new r.f(s.center.x,n),g=new r.f(s.center.x,n+s.height);const _={opacity0:e.startAlpha,opacity1:e.endAlpha,pos0:r.f.InterpolateLinear(f,g,e.startPosition).transformPoint(d),pos1:r.f.InterpolateLinear(f,g,e.endPosition).transformPoint(d)},v=new p.d(x.cache.reflectionTexture,o);v.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,v.effectTransform=r.c.FromTransforms(l,m,d),v.localClipRect=O,v.reflectionGradient=_,v.clientObject=x.cache,v.overallOpacity=A,v.colorMatrix=null==S?void 0:S.colorMatrix,v.colorOffset=null==S?void 0:S.colorOffset,v.colorize=null==S?void 0:S.colorize;const y=performance.now();Object(p.f)(this.m_graphicsProcessor,v,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"Reflection",y,v)}if(e&h.b.shadow&&i.effects.shadow&&x.cache.shadowTexture&&s&&R&&o&&l&&d&&!F){const e=Object(h.o)(i.effects.shadow.alignment,s),n=Object(h.r)(i.effects.shadow.angle,i.effects.shadow.distance,i.effects.shadow.scale,i.effects.shadow.skew,e),m=new p.d(x.cache.shadowTexture,o);m.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,m.effectTransform=r.c.FromTransforms(l,n,d),m.localClipRect=O,m.clientObject=x.cache,m.overallOpacity=A,m.colorMatrix=null==S?void 0:S.colorMatrix,m.colorOffset=null==S?void 0:S.colorOffset,m.colorize=null==S?void 0:S.colorize;const f=performance.now();Object(p.f)(this.m_graphicsProcessor,m,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"Shadow",f,m)}if(e&h.b.glow&&i.effects.glow&&x.cache.glowTexture&&R&&o&&l&&d&&!F){let e;const n=this.getTextureFromImage(i.effects.glow.image);e=n?new p.d(n,o,void 0,x.cache.glowTexture):new p.d(x.cache.glowTexture,o),e.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,e.localClipRect=O,e.clientObject=x.cache,e.overallOpacity=A,e.colorMatrix=null==S?void 0:S.colorMatrix,e.colorOffset=null==S?void 0:S.colorOffset,e.colorize=null==S?void 0:S.colorize,e.blendingMode=i.effects.glow.blendingMode;const r=performance.now();Object(p.f)(this.m_graphicsProcessor,e,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"Glow",r,e)}if(e&h.b.border&&i.effects.border&&x.cache.borderTexture&&R&&o&&!F){const e=new p.d(x.cache.borderTexture,o);e.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,e.localClipRect=O,e.clientObject=x.cache,e.overallOpacity=A,e.colorMatrix=null==S?void 0:S.colorMatrix,e.colorOffset=null==S?void 0:S.colorOffset,e.colorize=null==S?void 0:S.colorize;const i=performance.now();Object(p.f)(this.m_graphicsProcessor,e,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"Border",i,e)}if(e&h.b.replicate&&i.effects.replicate&&x.cache.replicateBottomTexture&&R&&o&&!F){const e=new p.d(x.cache.replicateBottomTexture,o);e.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,e.localClipRect=O,e.clientObject=x.cache,e.overallOpacity=A,e.colorMatrix=null==S?void 0:S.colorMatrix,e.colorOffset=null==S?void 0:S.colorOffset,e.colorize=null==S?void 0:S.colorize,e.blendingMode=i.effects.replicate.blendingMode;const n=performance.now();Object(p.f)(this.m_graphicsProcessor,e,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"ReplicateBottom",n,e)}}if(8!=c)if(i.getType()==h.g.shape){const l=i;if(!(g&&g.textRange||F)){let i=l.isSolidRect()?[void 0]:x.cache.distanceFields;const n=w&&C?o.multiply(C.multiply(d)):o.multiply(d);for(const r of i||[])if(!r||!r.isDisplacementMap){const i=11==c||12==c||10==c;E(this,x.cache,x.cache.styleCache,r,e,t,l,l.style,a,n,c,u?u.color:void 0,O,A,null==S?void 0:S.colorMatrix,null==S?void 0:S.colorOffset,null==S?void 0:S.colorize,!(!l.effects.replicate||(i?12!=c:1&l.effects.replicate.mainFilter)),!(!l.effects.replicate||(i?11!=c:2&l.effects.replicate.mainFilter)))}}if(l.text&&l.text.cache&&(!g||!g.noSubtree||g.textRange)){const e=new r.e(r.f.Zero,r.f.One,l.transform.rotation,l.transform.translation),i=n.v?e.toMatrix3().multiply(o):e.toMatrix3(),m=n.v&&!l.text.animationProps?C:void 0,p=n.v?d:l.text.hasAnimationProps()?o.multiply(d):P;if(u)for(const e of l.text.cache.hitTestLineShapes||[])(!g||!g.textRange||e.textRange&&g.textRange.includes(e.textRange.start))&&this.drawItem(h.b.all,t,e,a,i,m,p,c,u,f,void 0,_,S);else if(l.text.renderMode==s.k.TextInFrontOfShape){for(const e of l.text.cache.textShapes||[])(!g||!g.textRange||e.textRange&&g.textRange.includes(e.textRange.start))&&this.drawItem(h.b.all,t,e,a,i,m,p,c,u,f,void 0,_,S);if(0==c)for(const e of l.text.cache.selectionShapes||[])this.drawItem(h.b.all,t,e,a,i,m,p,c,u,f,void 0,_,S)}}}else if(i.getType()==h.g.group&&(!g||!g.noSubtree&&!g.textRange)){const e=i;if(e)for(let i=0;i<e.items.length;i++){const s=e.items.getAt(i);{u&&u.next();const i=n.v?e.transform.toMatrix3().multiply(o):r.c.Identity,l=n.v?C:void 0,m=n.v?d:e.transform.toMatrix3().multiply(P);let p=_,v=!1;if(e.clipBounds){let t=_||new r.d(0,0,a.x,a.y);const n=l?r.c.FromTransforms(i,l,m):i.multiply(m),s=null==n?void 0:n.inverse(),o=s?t.transformedBounds(s):void 0,d=o?e.clipBounds.clip(o):void 0,c=null==d?void 0:d.transformedBounds(n);p=c?r.d.IntersectRect(c,t):void 0,v=null==p}this.drawItem(h.b.all,t,s,a,i,l,m,v?9:c,u,f,g,p,S)}}}if(l&&e&h.b.replicate&&i.effects.replicate&&x.cache.replicateTopTexture&&R&&!F){const e=R?Object(m.s)(R,i.transform):void 0;if(e){const n=new p.d(x.cache.replicateTopTexture,e);n.fadeInfo=w&&k?{fade:k,fadeTexture:x.cache.fadeTexture,fadeMode:M}:void 0,n.localClipRect=O,n.clientObject=x.cache,n.overallOpacity=A,n.colorMatrix=null==S?void 0:S.colorMatrix,n.colorOffset=null==S?void 0:S.colorOffset,n.colorize=null==S?void 0:S.colorize,n.blendingMode=i.effects.replicate.blendingMode;const r=performance.now();Object(p.f)(this.m_graphicsProcessor,n,t,a,P,u?u.color:void 0,c),this.onLayerRendered(I,"ReplicateTop",r,n)}}}this.m_graphicsProcessor.setScissorRect(void 0)}renderToTexture(e,t,i,n,a,s,l,d,c,u){a&&a.size.equals(s)||(a=new m.b(e,this,s,c,{isMipMapped:u}));const f=t.activateShaderProgram(A.a.shapeRender);f.begin(a.tryGetBabylonTextureForRenderToTexture(t),o.d.Transparent,!0);const p={noSubtree:(3==d||4==d)&&i instanceof h.j};return this.drawItemOnce(n,f,i,s,r.c.Identity,void 0,l.toMatrix3(),d,void 0,!1,p,void 0,void 0),f.end(),a}drawTextureToTexture(e,t,i,n){const a=this.m_graphicsProcessor;if(!a)throw C.a.Error(592525137,"No Graphics Processor");const s=i==m.a.noFilter?A.a.copyTexture:i==m.a.drawMask?A.a.copyTextureDrawMask:A.a.copyTexturePictureEffects,l=a.isInRenderScope();if(!l&&!a.beginRenderScope())throw C.a.Error(591541203,"Failed to begin RenderScope");{const d=a.activateShaderProgram(s);d.begin(e.tryGetBabylonTextureForRenderToTexture(a),o.d.Transparent,!0),Object(m.j)(a,d,t,[new r.d(0,0,t.size.x,t.size.y)],[new r.d(0,0,e.size.x,e.size.y)],e.size,i,1,void 0,n),d.end(),l||a.endRenderScope()}}createTextureRasterizedItem(e,t,i,n,a,s,o,l,d,c){const u=this.m_graphicsProcessor;if(!u)throw C.a.Error(591541204,"No Graphics Processor");d<=0&&C.a.Error(509698625,"Quality is "+d);const f=performance.now(),g=o!=h.b.border&&s?d*Math.min(1,4/Math.sqrt(s)):d,_=!!(o&h.b.reflection),S=!!(o&(h.b.innerShadow|h.b.softEdges)),v=!(t.getType()==h.g.group&&t.isDocumentShape),y=_||v&&!S;let T=Object(h.p)(t,y,i,h.b.all,t.transform.toInverseMatrix3().multiply(r.c.Scale2D(t.transform.scale)));if(!T)return;T=T.inflate(Math.max(2/g,s));const b=T.size,w=T.center.divide(t.transform.scale).transformPoint(t.transform);if(!b||!w)return;const I=Math.min(g,m.q/Math.max(b.x,b.y)),P=b.scale(I);if(!P.isFinitePositive())return;const E=0!=s||null!=a,x=new r.f(Object(r.h)(E?Object(r.l)(P.x):P.x,16,m.q),Object(r.h)(E?Object(r.l)(P.y):P.y,16,m.q)),k=Math.min(I,Math.min(x.x/b.x,x.y/b.y)),M=new r.e(w.negate(),new r.f(k,k),-t.transform.rotation,new r.f(x.x/2,x.y/2)),A=U(t);if(!A)return;n=this.renderToTexture(e,u,t,i,n,x,M,l,c,o!=h.b.border&&E),E&&Object(p.e)(this,n,s*k,o,a,this.ensureRenderNode(t).cache),n.contentLocation={logicalCenter:A.center.transformPoint(t.transform).transformPoint(M),logicalSize:A.size.multiply(t.transform.scale).scale(k),physicalCenter:n.size.scale(.5),physicalSize:b.scale(k),rotation:0,flipX:!1,flipY:!1};const R=performance.now()-f;return 6==l||3==l||4==l||2==l||5==l?this.m_currentFramePerformanceSummary.effectsCostMs+=R:1==l&&(this.m_currentFramePerformanceSummary.cacheToSpriteCostMs+=R),n.renderCost=R,n}preCompileShaderAsync(e){this.m_graphicsProcessor?this.m_graphicsProcessor.preCompileShaderAsync(e):C.a.Error(592525138,"Graphics Processor not initialized")}preLinkShaderAsync(e){this.m_graphicsProcessor?this.m_graphicsProcessor.preLinkShaderAsync(e):C.a.Error(592525139,"Graphics Processor not initialized")}getDebugString(e){return this.m_debugStringProvider?e instanceof h.f?this.m_debugStringProvider.getDebugStringForItem(e,this):e instanceof a.a?this.m_debugStringProvider.getDebugStringForMorph(e,this):"unsupported object":"no debug string provider"}getTexturesUsedByObject(e,t){if(e instanceof m.c&&t.push(e),e instanceof h.f){const i=e.getBrushImages();t.push(...i.map(e=>this.ensureImageRenderData(e).texture)),this.getTexturesUsedItemCacheGL(e,t)}if(e instanceof a.a)for(let i of e.elements)for(let e of i.keyFrames)if(e){const i=this.ensureMorphKeyFrameRenderData(e);i.texture&&t.push(i.texture),i.textureDeltaWhite&&t.push(i.textureDeltaWhite),i.texturePicture&&t.push(i.texturePicture)}}getTexturesUsedItemCacheGL(e,t){const i=this.ensureRenderNode(e).cache;if(t.push(...i.getFulltextureList()),e instanceof h.d)for(let i of e.items.elements)this.getTexturesUsedItemCacheGL(i,t);if(e instanceof h.j&&e.text&&e.text.cache){for(const i of e.text.cache.getTextShapes())this.getTexturesUsedItemCacheGL(i,t);for(const i of e.text.cache.getSelectionShapes())this.getTexturesUsedItemCacheGL(i,t)}}getAllocatedTextures(e){const t=new Array;for(let i of e||[])this.getTexturesUsedByObject(i,t);return this.getTextureManager().allocatedTextures.filter(e=>!t.includes(e))}getAllocatedTexturesDebugTable(e,t){const i=this.getAllocatedTextures(t),n=[],r=["✅ Valid","❌ Empty","⚠️ Sneaky","⁉️ WrongR","⁉️ WrongC"],a=["Keep","Dispose","External"];for(let t of i){const i=t.lastUsage?performance.now()-t.lastUsage:void 0,s=t.lastRenderTime?performance.now()-t.lastRenderTime:void 0,o=t.scenario,l=r[t.getState(this)],d=a[t.releasePolicy],c=t.size.x,h=t.size.y,u=t.memoryUsage,m=t.renderCost;let f="[ ";if(t.usageRecord.length>0)for(let i=0;i<t.usageRecord.length;i++){const n=t.usageRecord[i];f+=0==i?"":", ",f+='{"id":"'+W(n.clientObject,e)+'", "scenario":"'+n.lastScenario+'", "lastRead":'+(performance.now()-n.lastUsage)+"}"}f+="]",n.push({lastRead:i,lastWrite:s,scenario:o,state:l,policy:d,width:c,height:h,memory:u,cost:m,clients:f})}return n}enableVerboseRenderLogging(e){this.m_verboseRenderLogging=e}isVerboseRenderLoggingEnabled(){return this.m_verboseRenderLogging}onLayerRendered(e,t,i,n){const r=Math.ceil(n.contentSize.x)*Math.ceil(n.contentSize.y);if(this.getCurrentFramePerformanceSummary().pixelCountShapeRender+=r,"text"==e&&this.getCurrentFramePerformanceSummary().shapeLayerCountText++,this.isVerboseRenderLoggingEnabled()){const n=q(performance.now()-i);C.a.Message(529077968,`RenderBatch ${e} layer ${t} rendered ${r} pixels, cost ${n}ms`)}}testRenderFidelity(){const e=new h.j([l.d.CreateFromFigure(new l.a([0,10,1,10,0,1,10,10,1]))],new o.x(new o.v(o.d.Blue))),t=new h.j([l.d.CreateFromFigure(new l.a([0,0,1,0,10,1,10,10,1]))],new o.x(new o.v(o.d.Red))),i=new h.j([l.d.CreateFromFigure(new l.a([0,10,1,5,5,1,10,10,1]))],new o.x(new o.v(new o.d(1,1,0,.5)))),n=new h.d([e,t,i]),a=new m.b("RenderTest",this,new r.f(9,9),m.e.KeepUntilRelease);this.render(n,o.d.Green,{target:a});const s=a.tryConvertToBufferRGBA();a.release();let d=!0,c=[];if(s){const e=[{x:1,y:4,r:255,g:0,b:0,a:255,tolerence:1},{x:4,y:1,r:0,g:255,b:0,a:255,tolerence:1},{x:7,y:4,r:0,g:0,b:255,a:255,tolerence:1},{x:4,y:7,r:255,g:128,b:0,a:255,tolerence:2}];for(let t of e){const e=4*(t.x+9*(8-t.y));(Math.abs(s[e]-t.r)>t.tolerence||Math.abs(s[e+1]-t.g)>t.tolerence||Math.abs(s[e+2]-t.b)>t.tolerence||Math.abs(s[e+3]-t.a)>t.tolerence)&&(d=!1,c.push({expectedValues:t,actualValues:{r:s[e],g:s[e+1],b:s[e+2],a:s[e+3]}}))}}return{fSucceeded:d,triangleTestDifferences:c}}getWebGLState(){var e;return null===(e=this.m_graphicsProcessor)||void 0===e?void 0:e.getWebGLState()}constructor(e){this.m_babylonWipeStateBetweenScopes=!0,this.m_babylonDisableParallelShaderCompile=!1,this.m_currentFramePerformanceSummary=new u.b,this.m_textureManager=new m.d,this.m_glyphCachePreviouslyFailed=!1,this.m_verboseRenderLogging=!1,this.fixedMemoryLeakAmounts=new u.a,this.m_babylonWipeStateBetweenScopes=!e.stateRestorer,this.m_babylonDisableParallelShaderCompile=1==e.babylonDisableParallelShaderCompile,this.m_stateRestorer=e.stateRestorer,this.m_morphPlayer=e.morphPlayer,this.m_debugStringProvider=e.debugStringProvider,this.m_perfSummary=new u.c,this.m_rendererId="🦆"+N++}}function W(e,t){if(!e)return;const i=e&&e.constructor?e.constructor.name:void 0,n=t.split(".");let r=e;for(let e of n)r=r?r[e]:void 0;return(i||"")+(r?" "+r:"")}function U(e){return e.getType()==h.g.shape?Object(h.q)(e,!1):Object(h.p)(e,!1,h.b.none,h.b.none,e.transform.toInverseMatrix3())}function z(e){return e?e.memoryUsage:0}function H(e,t){e&&(e instanceof m.b&&e.tag?t.otherBrushes+=z(e):e.releasePolicy!=m.e.ExternallyManaged?t.managedImages+=z(e):t.externalImages+=z(e))}function G(e,t,i,n=!1){var r;const a=e.ensureRenderNode(t);if(a.cache){for(let e of a.cache.distanceFields||[])e.texture&&(n?i.textDistanceFields+=z(e.texture):i.shapeDistanceFields+=z(e.texture));H(a.cache.styleCache.resolvedFillTexture,i),H(a.cache.styleCache.resolvedLineTexture,i),H(a.cache.styleCache.resolvedPictureTexture,i),i.effects+=z(a.cache.innerShadowTexture),i.effects+=z(a.cache.softEdgesTexture),i.effects+=z(a.cache.glowTexture),i.effects+=z(a.cache.borderTexture),i.effects+=z(a.cache.shadowTexture),i.effects+=z(a.cache.reflectionTexture),i.effects+=z(a.cache.replicateBottomTexture),i.fadeMasks+=z(a.cache.fadeTexture),i.rasterizedItems+=z(a.cache.spriteTexture)}if(t instanceof h.j&&null!==(r=t.text)&&void 0!==r&&r.cache){const n=t.text.cache;n.textShapes.forEach(t=>{G(e,t,i,!0)}),n.hitTestLineShapes.forEach(t=>{G(e,t,i,!0)}),n.selectionShapes&&n.selectionShapes.forEach(t=>{G(e,t,i,!0)})}t instanceof h.d&&t.items.elements.forEach(t=>{G(e,t,i)})}function j(e,t,i){for(let n of t.elements)for(let t of n.keyFrames)if(t){const n=e.ensureMorphKeyFrameRenderData(t);n.texture&&(i.morphTextures+=z(n.texture))}}function $(e,t,i,n,a,s,l,d,c,h,u,m,f,g){const _=n?n.texture:void 0,S=r.c.ScaleTranslation2D(s,s.scale(.5).subtract(d)),v=S,y=r.c.Translation2D(d),T=S.multiply(Object(p.h)(i,l)),b=_?S.multiply(Object(p.h)(_,l)):r.c.Identity,w=t.getBabylonEffect();w.setMatrix3x3("u_0",v.m),w.setMatrix3x3("u_1",y.m),w.setMatrix3x3("u_2",T.m),w.setMatrix3x3("u_3",b.m),w.setVector2("u_4",s),w.setInt("ufrag_0",n?1:0),w.setVector2("ufrag_1",n?n.size.inverse().scale(n.contentQuality):r.f.Zero),w.setFloat("ufrag_2",n?2*n.distRangeSize:0),w.setFloat("ufrag_3",n?-n.distRangeSize+.5*h:0),w.setVector2("ufrag_4",c);const C=new Array(16);C.fill(0);const I=new Array(12);I.fill(0);const P=new Array(16);if(P.fill(0),u)for(let e=0;e<Math.min(u.lights.length,4);e++){const t=u.lights[e],i=Math.sqrt(t.direction.x*t.direction.x+t.direction.y*t.direction.y+t.direction.z*t.direction.z);C[4*e]=Math.abs(t.color.r),C[4*e+1]=Math.abs(t.color.g),C[4*e+2]=Math.abs(t.color.b),C[4*e+3]=Math.abs(t.color.a),I[3*e]=t.direction.x/i,I[3*e+1]=t.direction.y/i,I[3*e+2]=t.direction.z/i,P[4*e]=t.wrapScale,P[4*e+1]=t.wrapOffset,P[4*e+2]=t.diffuse,P[4*e+3]=t.specular}w.setDirectColor4("ufrag_5",u?u.ambientColor:o.d.Black),w.setArray4("ufrag_6",C),w.setArray3("ufrag_7",I),w.setArray4("ufrag_8",P),w.setDirectColor4("ufrag_9",m?m.diffuseColor:o.d.Black),w.setDirectColor4("ufrag_10",m?m.specularColor:o.d.Black),w.setDirectColor4("ufrag_11",m?m.ambientColor:o.d.Black),w.setDirectColor4("ufrag_12",m?m.emissiveColor:o.d.Black),m?w.setFloat4("ufrag_13",m.specularPower,m.useBlinnHighlight?1:0,m.diffuseFresnel,m.alphaFresnel):w.setFloat4("ufrag_13",0,0,0,0),w.setInt("ufrag_14",m?m.materialType:0),w.setFloat("ufrag_15",g),w.setDirectColor4("ufrag_16",f);const E=y?y.transformVector(r.f.One.scale(Math.sqrt(2)/2)).length():1;w.setFloat("ufrag_17",1/E),t.setTexture("t_0",i.tryUseBabylonTexture(e,void 0,"draw3D:T")),t.setTexture("t_1",_?_.tryUseBabylonTexture(e,void 0,"draw3D:D"):void 0),t.setTexture("t_2",a?a.tryUseBabylonTexture(e,void 0,"draw3D:P"):void 0),t.drawQuadInstances(1)}function q(e){return Math.round(1e3*(e+100*Number.EPSILON))/1e3}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(81),r=i(9),a=i(4),s=i(1);class o{registerCoreEventListeners(){this.m_slideshowCore.events.on("slideLocationChanging",this.stopLoggerIntervalIfActive.bind(this)),this.m_slideshowCore.events.on("slideLocationChanged",this.stopLoggerIntervalIfActive.bind(this)),this.m_slideshowCore.events.on("animatedContentStateChanged",this.onSlideWithAnimatedContentsRendered.bind(this))}onSlideShowExit(){this.stopLoggerIntervalIfActive()}onSlideWithAnimatedContentsRendered(e){!this.m_wasCameoActiveDuringInterval&&this.m_cameoStateCallback()&&(this.m_wasCameoActiveDuringInterval=!0),e.hasContinuouslyAnimatedContent?(this.m_slideAnimatedContentLogger&&!this.m_slideAnimatedContentLogger.hasLogIntervalStarted&&(this.m_metadata={...e.metadata}),this.m_slideAnimatedContentLogger.logFrameData(!0)):this.stopLoggerIntervalIfActive()}stopLoggerIntervalIfActive(){if(this.m_slideAnimatedContentLogger&&this.m_slideAnimatedContentLogger.hasLogIntervalStarted){const e={...this.m_metadata,sharingLayoutMode:this.m_sharingLayoutMode||"undefined",cameoData:this.getCameoActivityData()};this.m_wasCameoActiveDuringInterval?this.m_slideAnimatedContentLogger.logFrameData(!1,{metadata:e,vetoFps:s.a.readNumberOrDefault("cameoRenderingLogVetoMinFPS",20),qosVetoName:"CameoLowFPS"}):this.m_slideAnimatedContentLogger.logFrameData(!1,{metadata:e}),this.slideNavCleanUp()}}getCameoActivityData(){if(!a.ChangeGate.isChangeGateEnabled("SSC.logCameoActivityData"))return{};const e=this.m_slideshowCore.getContentInfoFromActiveSlide().contentCounts;if(e){const t=e.Cameo>0;return{isCameoActive:t&&this.m_cameoStateCallback(),wasCameoActiveDuringInterval:t&&this.m_wasCameoActiveDuringInterval}}return{isCameoActive:this.m_cameoStateCallback(),wasCameoActiveDuringInterval:this.m_wasCameoActiveDuringInterval}}slideNavCleanUp(){this.m_metadata={},this.m_wasCameoActiveDuringInterval=!1}constructor(e,t,i,a,s){this.m_metadata={},this.m_wasCameoActiveDuringInterval=!1,this.m_sharingLayoutMode=void 0,r.a.setLogger(i),this.m_slideshowCore=e,this.m_cameoStateCallback=a,this.m_slideAnimatedContentLogger=new n.a({type:"Slide"}),this.registerCoreEventListeners(),s&&(s.appEvents&&s.appEvents.on("sharingLayoutModeChanged",e=>{this.m_sharingLayoutMode=e}),s.sharingLayoutMode&&(this.m_sharingLayoutMode=s.sharingLayoutMode))}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return l}));var n,r,a=i(3),s=i(7),o=i(11);!function(e){e.SlideShowCoreStringJs="SlideShowCoreStringJs",e.SlideShowUIStringJs="SlideShowUIStringJs",e.SlideShowUIJs="SlideShowUIJs",e.SlideShowUIIconJs="SlideShowUIIconJs",e.SlideGridJs="SlideGridJs",e.FocusVisibleJs="FocusVisibleJs",e.ResourceLoadTest="ResourceLoadTest",e.PresenterViewUIJs="PresenterViewUIJs"}(n||(n={})),function(e){e.PPTGridComponentCss="PPTGridComponentCss",e.PresenterCss="PresenterCss",e.ResumeslideshowCss="ResumeslideshowCss",e.GridviewCss="GridviewCss",e.FloatingContainerCss="FloatingContainerCss",e.SlideshowtoolbarCss="SlideshowtoolbarCss",e.ToolbarIconsCss="ToolbarIconsCss",e.FloatinglabelCss="FloatinglabelCss"}(r||(r={}));class l{async loadResourceFiles(){try{this.m_logger&&this.m_logger.sendTraceTag(506856345,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"calling loadResourceFiles.");const e="loadAllResources";this.m_resourceLoadTelemetry[e]={s:o.a.performanceNowTrimmed(),e:o.a.performanceNowTrimmed()},await this.loadCssFiles(),await this.loadJsFiles(),this.m_resourceLoadTelemetry[e].e=o.a.performanceNowTrimmed(),this.m_resourceLoadTelemetry[e].d=this.m_resourceLoadTelemetry[e].e-this.m_resourceLoadTelemetry[e].s,this.m_logger&&this.m_logger.sendTraceTag(506856344,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"loadResourceFiles called: "+JSON.stringify(this.m_resourceLoadTelemetry))}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856343,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"Exception when calling loadResourceFiles: "+e)}}async loadJsFiles(){this.m_logger&&this.m_logger.sendTraceTag(506856342,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowResourceLoader - loadJsFiles");const e=document.createElement("div");e.id="slideshow-resource-loader-js",document.head.prepend(e);for(const t in this.jsFilePathMap)try{if(this.jsFilePathMap[t]&&""!==this.jsFilePathMap[t]){const i=new Promise((i,n)=>{try{const r=o.a.performanceNowTrimmed(),a=document.createElement("script");a.addEventListener("error",()=>{this.onResourceLoadFailed(t,this.jsFilePathMap[t],r,n)}),a.addEventListener("load",()=>{this.onResourceLoaded(t,r,i)}),a.type="text/javascript",a.src=this.jsFilePathMap[t],e.appendChild(a)}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856341,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowResourceLoader - loadJsFiles failed for "+t)}});await i}}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856340,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,`SlideShowResourceLoader - exception while handling loadJsFiles promise for ${t}: ${e}`)}}async loadCssFiles(){this.m_logger&&this.m_logger.sendTraceTag(506856339,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowResourceLoader - loadCssFiles");const e=document.createElement("div");e.id="slideshow-resource-loader-css",document.head.prepend(e);for(const t in this.cssFilePathMap)try{if(this.cssFilePathMap[t]&&""!==this.cssFilePathMap[t]){const i=new Promise((i,n)=>{try{const r=o.a.performanceNowTrimmed(),a=document.createElement("link");a.addEventListener("error",()=>{this.onResourceLoadFailed(t,this.cssFilePathMap[t],r,n)}),a.addEventListener("load",()=>{this.onResourceLoaded(t,r,i)}),a.type="text/css",a.rel="stylesheet",a.href=this.cssFilePathMap[t],e.appendChild(a)}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856338,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowResourceLoader - loadCssFiles failed for "+t)}});await i}}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856337,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,`SlideShowResourceLoader - exception while handling loadCssFiles promise for ${t}: ${e}`)}}onResourceLoaded(e,t,i){try{const n=o.a.performanceNowTrimmed(),r={s:t,e:n,d:n-t,succeed:!0};this.m_logger&&this.m_logger.sendTraceTag(506856336,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`Resource loaded: {${e} : ${JSON.stringify(r)}}`),this.m_resourceLoadTelemetry[e]=r,i()}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856335,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"Exception in resource load handler: "+e)}}onResourceLoadFailed(e,t,i,n){try{const r=o.a.performanceNowTrimmed(),l={n:e,s:i,e:r,d:r-i,succeed:!1};this.m_logger&&(this.m_logger.sendTraceTag(506856334,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"Resource load failed: "+JSON.stringify(l)),this.m_remainingTimesToFetchFailureHeaders>0&&(this.m_remainingTimesToFetchFailureHeaders=this.m_remainingTimesToFetchFailureHeaders-1,this.fetchHeadersOnFailure(e,t))),this.m_resourceLoadTelemetry[e]=l,n()}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856333,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"Exception in resource load handler: "+e)}}async fetchHeadersOnFailure(e,t){if(!this.m_logger)return;this.m_logger.sendTraceTag(506856332,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`Running fetch request for resource ${e} to get failure headers`);const i=await fetch(t,{method:"GET"}).catch(async e=>{this.m_logger.sendTraceTag(506856331,a.a.msoulscat_Wac_PptSession,s.a.Error,"SlideShowResourceLoader failed direct fetch: "+e)});if(i){const e=i.headers.get("x-cdn-provider"),t=i.headers.get("x-ms-request-id"),n=i.headers.get("X-Correlationid");this.m_logger.sendTraceTag(506856330,a.a.msoulscat_Wac_PptSession,s.a.Info,`SlideShowResourceLoader direct fetch headers x-cdn-provider ${e}, x-ms-request-id ${t}, statusCode ${i.status}, x-correlationId ${n}`)}else this.m_logger.sendTraceTag(506856329,a.a.msoulscat_Wac_PptSession,s.a.Error,"SlideShowResourceLoader no response from direct fetch")}constructor(e,t){this.jsFilePathMap={},this.cssFilePathMap={},this.m_resourceLoadTelemetry={},this.m_logger=e,this.m_remainingTimesToFetchFailureHeaders=t||0}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{registerUIEventListeners(){this.m_slideShowUIEvents&&(this.m_slideShowUIEvents.on("currentSlideViewBoundsUpdated",this.m_currentSlideViewBoundsUpdatedBound),this.m_slideShowUIEvents.on("slideDimensionsChanged",this.m_slideDimensionsChangedBound))}onCurrentSlideViewBoundsUpdated(e){this.m_slideShowUIBounds=e,this.m_slideDimensionsChangedBound()}onSlideDimensionsChanged(){this.m_slideShowAppEvents&&this.m_slideShowAppEvents.emit("slideViewBoundsChanged")}getSlideViewBounds(){return void 0===this.m_slideShowUIBounds?this.m_slideshowCore.getCurrentSlideViewBounds():this.m_slideShowUIBounds}set slideShowUIEvents(e){e&&(this.m_slideShowUIEvents=e,this.registerUIEventListeners())}get slideShowUIEvents(){return this.m_slideShowUIEvents}constructor(e,t,i){this.m_currentSlideViewBoundsUpdatedBound=this.onCurrentSlideViewBoundsUpdated.bind(this),this.m_slideDimensionsChangedBound=this.onSlideDimensionsChanged.bind(this),this.m_slideshowCore=e,this.m_slideShowUIEvents=i,this.m_slideShowAppEvents=t,this.registerUIEventListeners()}}},,function(e,t,i){"use strict";i.d(t,"e",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"k",(function(){return l})),i.d(t,"j",(function(){return d})),i.d(t,"o",(function(){return c})),i.d(t,"n",(function(){return h})),i.d(t,"i",(function(){return u})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return f})),i.d(t,"m",(function(){return p})),i.d(t,"f",(function(){return g})),i.d(t,"p",(function(){return _})),i.d(t,"l",(function(){return S}));var n="",r="channels",a="core",s="createPerfMgr",o="disabled",l="extensionConfig",d="extensions",c="processTelemetry",h="priority",u="eventsSent",m="eventsDiscarded",f="eventsSendRequest",p="perfEvent",g="errorToConsole",_="warnToConsole",S="getPerfMgr"},function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i(31),r=i(52),a=i(13),s=i(84),o=i(10),l=i(3),d=i(36),c=i(4),h=i(89),u=i(1),m=i(53),f=i(61);class p{disposeImage(e){e.resource&&e.resource.urlType===a.i.ObjectUrl&&URL.revokeObjectURL(e.resource.url)}dispose(){for(const e of this.imageData.getAllLoadResultsInCache())this.imageData.remove(e.resourceId,e.options)}updatePodsProxy(e){this.m_podProxy=e}isSlideCached(e){return!!this.slideInfo.getLoadResultInCache(e)}async invalidateSlideAsync(e,t){const i=e.sid,n=e.cid;if(!this.slideInfo.getLoadResultsInCache(JSON.stringify({sid:i,cid:0})))return;const r=await this.slideInfo.load(JSON.stringify({sid:i,cid:0}),t),a=await this.presInfo.load("",t);if(!r.resource||!a.resource)return;const o=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource])),l=s.a.getDataFromSlideInfoAndImages(r.resource,a.resource.SlideOrder,o);if(!l)return;for(let e=0;e<l.shapeViewDatas.length;e+=1){const t=`${JSON.stringify(l.slideViewData.slideId)}_${JSON.stringify(l.shapeViewDatas[e].shapeId)}`;this.shapeViewData.remove(t)}const d=l.slideViewData.resCat;if(d&&0!==d.length){for(const e of d)this.imageData.remove(e.id);this.slideViewData.remove(JSON.stringify({sid:i,cid:0})),this.slide.remove(JSON.stringify({sid:i,cid:0})),this.slideInfo.remove(JSON.stringify({sid:i,cid:0})),this.slideViewData.remove(JSON.stringify(l.slideViewData.slideId)),this.slide.remove(JSON.stringify(l.slide.id)),this.slideInfo.remove(JSON.stringify({sid:i,cid:n})),this.presInfo.remove(""),this.presInfoAndSlideInfo.remove(JSON.stringify({slideIndex:0}))}}resetProviders(){this.dispose(),this.presInfoAndSlideInfo=new r.b(this.presInfoAndSlideInfoLoader),this.presInfo=new r.b(this.presInfoLoader),this.slide=new r.b(this.slideLoader),this.slideViewData=new r.b(this.slideViewDataLoader),this.imageData=new r.b(this.imageLoader),this.imageData.events.on("removed",e=>this.disposeImage(e)),this.shapeViewData=new r.b(this.shapeViewDataLoader),this.slideInfo=new r.b(this.slideInfoLoader),this.localizedString=new r.b(this.localizedStringLoader)}shouldTimeoutResponseStreamDownload(e){if(e>=this.m_settings.retryCount-1)return this.m_logger.sendTraceTag(506856992,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,"shouldTimeoutResponseStream - last retry attemp, so should not timeout. "),!1;let t=!1;try{const e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(e){const i=null!=e.downlink?e.downlink:void 0,n=null!=e.rtt?e.rtt:void 0;i>=u.a.readNumberOrDefault("fallbackRequestMinNetworkSpeed",1)&&n<=u.a.readNumberOrDefault("fallbackRequestMaxRTT",1e3)&&(t=!0),this.m_logger.sendTraceTag(506856991,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`DefaultResourceProviders::Client network info - downlinkSpeed: ${i}Mbps, rtt: ${n}ms, shouldTimeoutResponseStream:${t}`)}else this.m_logger.sendTraceTag(506856990,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,"DefaultResourceProviders::network information API not supported by the browser")}catch(e){this.m_logger.sendTraceTag(506856989,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,"DefaultResourceProviders::shouldTimeoutResponseStreamDownload exception: "+e)}return t}static getImageAppendOption(e){switch(e){case"none":return n.i.None;case"all":return n.i.All;case"partial":return n.i.Partial;case"embed":default:return n.i.Embed}}shouldRetry(e){return e.itemErrorCategoryMap&&Array.from(e.itemErrorCategoryMap.values()).some(e=>this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.indexOf(e.trim())>=0)||e.itemErrorCodeMap&&Array.from(e.itemErrorCodeMap.values()).some(e=>this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.indexOf(e.trim())>=0)||this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.includes(e.responseErrorCategory.toString())||!this.m_settings.retryOnCategories}getErrorFromResponse(e,t,i){let n="",r="";if("ErrorRESERVEDSuccess"!==e.responseErrorCode.toString())n=e.responseErrorCode.toString();else if(e.itemErrorCodeMap){if(""!==i)n=e.itemErrorCodeMap.get(i)||"";else{const t=Array.from(e.itemErrorCodeMap.values()).filter(e=>"ErrorRESERVEDSuccess"!==e.trim());t.length>0&&(n=t[0])}r=JSON.stringify([...e.itemErrorCodeMap])}return n&&!n.startsWith("Server")&&(this.m_logger.sendTraceTag(506856988,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,"Prefixing Server to errorName:"+n),n="Server"+n),n}isValidSlideInfo(e){return!!e.slideInfo&&e.slideInfo.length>0&&!!e.slideInfo[0].SlideShowInfo}isValidSlideAXInfo(e,t){return!!e.slideInfo&&e.slideInfo.length>0&&(!t.GetSlideAccessibilityModelData||!!e.slideInfo[0].AccessibilityModel)}addImages(e,t,i,n){if(t)for(const r of t){const t=e?e.find(e=>e.id===r.Id):void 0;if(t&&!this.imageData.getLoadResultInCache(t.id,i)){t.byteCount=r.ByteCount,t.mimeType=r.MimeType,r.Binary?(t.url=URL.createObjectURL(new Blob([r.Binary],{type:t.mimeType})),t.urlType=a.i.ObjectUrl):(t.url=r.Base64,t.urlType=a.i.Base64),t.url||this.m_logger.sendTraceTag(506856987,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,"imageLoader: Got empty url - "+JSON.stringify({resourceId:r.Id,correlation:i.meta_correlationId,res:t}));const e={resourceId:t.id,resource:t,metadata:{created:Date.now(),lastAccessed:Date.now(),cached:n,requestInfo:i.meta_requestInfo},options:i};this.imageData.add(e)}r.Binary&&(r.Binary=void 0)}}adjustRequestParamsForRetry(e,t){let i=t.meta_clientHeightReduced,n=t.meta_clientWidthReduced;(u.a.readBooleanOrDefault("loadMinResolutionOnRetry",!1)||u.a.readBooleanOrDefault("loadMinResolutionIfBadNetwork",!0)&&this.m_isNetworkHealthSpotty)&&t.meta_clientHeightMin&&t.meta_clientWidthMin&&(i=t.meta_clientHeightMin,n=t.meta_clientWidthMin),i&&n&&(c.ChangeGate.isChangeGateEnabled("SSC.logAdjustRequestParamClientResolution")&&this.m_logger.sendTraceTag(506856986,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,"DefaultResourceProvider: adjusted request param client resolution - "+JSON.stringify({oldClientHeight:e.ClientHeight,oldClientWidth:e.ClientWidth,newClientHeight:i,newClientWidth:n})),e.ClientWidth=n,e.ClientHeight=i)}static shouldReduceResolution(e){const t=u.a.readStringOrDefault("errorsToReduceResolutionOnRetry","");return e.itemErrorCategoryMap&&Array.from(e.itemErrorCategoryMap.values()).some(e=>t.indexOf(e.trim())>=0)||e.itemErrorCodeMap&&Array.from(e.itemErrorCodeMap.values()).some(e=>t.indexOf(e.trim())>=0)||t.includes(e.responseErrorCategory.toString())}setNetworkHealth(e){e||(this.m_isNetworkHealthSpotty=!0),this.m_isNetworkHealthy=e}constructor(e,t,i){this.m_isNetworkHealthSpotty=!1,this.m_isNetworkHealthy=!0,this.presInfoLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadPresInfo"}};if(null==t.meta_clientWidth||null==t.meta_clientHeight)return this.m_logger.sendTraceTag(506857050,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"missing clientWidth or clientHeight"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;const r={ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,CorrelationId:t.meta_correlationId||"",FilterHiddenSlideInfo:t.meta_filterHiddenSlideInfo,RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,IncludeSections:t.meta_includeSections};let a={presInfo:void 0,responseErrorCode:n.c.ErrorRESERVEDSuccess,responseErrorCategory:n.b.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},s=0;for(;s<this.m_settings.retryCount&&(a=await this.m_podProxy.getItemsPresInfoAsync(r),s+=1,!a.presInfo)&&this.shouldRetry(a);){const i=t.meta_correlationId;t.meta_correlationId=Object(d.v4)(),r.CorrelationId=t.meta_correlationId,this.m_logger.sendTraceTag(506857049,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`presInfoLoader: Generating new correlationId for retrying request - resourceId:${e}, old correlation:${i}, new correlation:${t.meta_correlationId}, attempts:${s},\n            responseErrorCode:${a.responseErrorCode.toString()}, errorCodeMap:${a.itemErrorCodeMap?JSON.stringify([...a.itemErrorCodeMap]):""}`)}return a.presInfo?(this.m_logger.sendTraceTag(506857048,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`presInfoLoader: Got presInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${s}`),i.resource=a.presInfo,i.metadata={created:new Date,lastAccessed:new Date,cached:a.usedOutputCache&&"true"===a.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},a.metadata&&(i.metadata.getItemsResult=a.metadata),i):(i.metadata.errorName=this.getErrorFromResponse(a,{responseType:"presInfo",resourceId:e,cid:t.meta_correlationId,attempts:s},n.d.PresInfoMetaData),i)}},this.slideLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadSlide"}};try{const n=JSON.parse(e).sid;if(!n)return this.m_logger.sendTraceTag(506857047,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;let r;t.meta_correlationId||this.m_logger.sendTraceTag(506857046,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,"missing correlation in slideLoader. resourceId:"+e);try{if(r=await this.slideInfo.load(JSON.stringify({sid:n,cid:0}),t),!r.resource)return this.m_logger.sendTraceTag(506857045,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideLoader: failed to load slideInfo."),i.metadata.errorName="ErrorFailedToLoadSlideInfo",r.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=r.metadata.errorName),r.metadata.hasOwnProperty("getItemsResult")&&r.metadata.getItemsResult&&(i.metadata.getItemsResult=r.metadata.getItemsResult),i}catch(e){return this.m_logger.sendTraceTag(506857044,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideLoader: failed to load slideInfo. Exception:"+Object(f.c)(e)),i.metadata.errorName="ErrorFailedToLoadSlideInfo",i}const a=await this.presInfo.load("",t);if(!a||!a.resource)return i.metadata.errorName="ErrorFailedToLoadPresInfo",a&&!a.resource&&a.metadata&&a.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=a.metadata.errorName),i;const d=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource]));let c;try{if(c=s.a.getDataFromSlideInfoAndImages(r.resource,a.resource.SlideOrder,d),!c)return i.metadata.errorName="ErrorFailedToParseSlideInfo",i}catch(e){return this.m_logger.sendTraceTag(506857043,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideLoader: failed to parse data from slideInfo. Exception:"+Object(f.c)(e)),i.metadata.errorName="ErrorFailedToParseSlideInfo",i}i.resource=c.slide,i.metadata={created:new Date,lastAccessed:new Date,cached:r.metadata.hasOwnProperty("cached")&&r.metadata.cached&&"true"===r.metadata.cached.toString().toLowerCase().trim()},r.metadata.hasOwnProperty("requestInfo")&&r.metadata.requestInfo&&(i.metadata.requestInfo=r.metadata.requestInfo),r.metadata.hasOwnProperty("getItemsResult")&&r.metadata.getItemsResult&&(i.metadata.getItemsResult=r.metadata.getItemsResult),r.metadata.hasOwnProperty("axErrorName")&&(i.metadata.axErrorName=r.metadata.axErrorName);for(let e=0;e<c.shapeViewDatas.length;e+=1){const n={resourceId:`${JSON.stringify(c.slideViewData.slideId)}_${JSON.stringify(c.shapeViewDatas[e].shapeId)}`,resource:c.shapeViewDatas[e],metadata:i.metadata,options:t};this.shapeViewData.add(n)}const h={resourceId:e,resource:c.slideViewData,metadata:i.metadata,options:t};return this.slideViewData.add(h),this.m_logger.sendTraceTag(506857042,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,"slideLoader: slide loaded. sid:"+n),i}catch(e){return this.m_logger.sendTraceTag(506857041,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideLoader: failed to load slide. Exception:"+Object(f.c)(e)),i}}},this.slideViewDataLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadSlideViewData"}},n=JSON.parse(e).sid;if(!n)return this.m_logger.sendTraceTag(506857040,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideViewDataLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;const r=await this.slideInfo.load(JSON.stringify({sid:n,cid:0}),t);if(!r.resource)return i.metadata.errorName="ErrorFailedToLoadSlideInfo",r.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=r.metadata.errorName),this.m_logger.sendTraceTag(506857039,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,`slideViewDataLoader: failed to load slideInfo. errorName:${i.metadata.errorName}, resourceId:${e}, correlation:${t.meta_correlationId}`),i;const a=await this.presInfo.load("",t);if(!a||!a.resource)return i.metadata.errorName="ErrorFailedToLoadPresInfo",a&&!a.resource&&a.metadata&&a.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=a.metadata.errorName),i;const d=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource])),c=s.a.getDataFromSlideInfoAndImages(r.resource,a.resource.SlideOrder,d);if(!c)return i.metadata.errorName="ErrorFailedToParseSlideInfo",i;i.resource=c.slideViewData,i.metadata={created:new Date,lastAccessed:new Date,cached:r.metadata.hasOwnProperty("cached")&&r.metadata.cached&&"true"===r.metadata.cached.toString().toLowerCase().trim()},r.metadata.hasOwnProperty("requestInfo")&&r.metadata.requestInfo&&(i.metadata.requestInfo=r.metadata.requestInfo),r.metadata.hasOwnProperty("getItemsResult")&&r.metadata.getItemsResult&&(i.metadata.getItemsResult=r.metadata.getItemsResult);for(let e=0;e<c.shapeViewDatas.length;e+=1){const n={resourceId:`${JSON.stringify(c.slideViewData.slideId)}_${JSON.stringify(c.shapeViewDatas[e].shapeId)}`,resource:c.shapeViewDatas[e],metadata:i.metadata,options:t};this.shapeViewData.add(n)}const h={resourceId:e,resource:c.slide,metadata:i.metadata,options:t};return this.slide.add(h),i}},this.shapeViewDataLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadShapeViewData"}},n=e.split("_")[0],r=JSON.parse(n).sid;if(!r)return this.m_logger.sendTraceTag(506857038,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"shapeViewDataLoader: invalid slideIdString "+n),i.metadata.errorName="ErrorMissingSlideId",i;const a=await this.slideInfo.load(JSON.stringify({sid:r,cid:0}),t);if(!a||!a.resource)return i.metadata.errorName="ErrorFailedToLoadSlideInfo",a&&!a.resource&&a.metadata&&a.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=a.metadata.errorName),i;const d=await this.presInfo.load("",t);if(!d||!d.resource)return i.metadata.errorName="ErrorFailedToLoadPresInfo",d&&!d.resource&&d.metadata&&d.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=d.metadata.errorName),i;const c=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource])),h=s.a.getDataFromSlideInfoAndImages(a.resource,d.resource.SlideOrder,c);if(!h)return i.metadata.errorName="ErrorFailedToParseSlideInfo",i;i.resource=h.shapeViewDatas.filter(t=>JSON.stringify(t.shapeId)===e.split("_")[1])[0],i.metadata={created:new Date,lastAccessed:new Date,cached:a.metadata.hasOwnProperty("cached")&&a.metadata.cached&&"true"===a.metadata.cached.toString().toLowerCase().trim()},a.metadata.hasOwnProperty("requestInfo")&&a.metadata.requestInfo&&(i.metadata.requestInfo=a.metadata.requestInfo),a.metadata.hasOwnProperty("getItemsResult")&&a.metadata.getItemsResult&&(i.metadata.getItemsResult=a.metadata.getItemsResult);const u={resourceId:JSON.stringify(h.slide.id),resource:h.slide,metadata:i.metadata,options:t};this.slide.add(u);const m={resourceId:JSON.stringify(h.slideViewData.slideId),resource:h.slideViewData,metadata:i.metadata,options:t};return this.slideViewData.add(m),i}},this.resourceIdToImageLoadPromise={},this.imageLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadResourceEntry"}};if(!t||null==t.meta_clientWidth||null==t.meta_clientHeight||!t.meta_resourceEntries)return this.m_logger.sendTraceTag(506857037,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"missing clientWidth or clientHeight or resourceEntries"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;if(e in this.resourceIdToImageLoadPromise){await this.resourceIdToImageLoadPromise[e];const i=this.imageData.getLoadResultInCache(e,t);if(i)return i}const r=t.meta_resourceEntries;if(!r)return i.metadata.errorName="ErrorMissingEntriesInOptions",i;let a=[];a=r.map(e=>({Id:e.id,Name:e.name}));const s=new Promise(async s=>{const c={ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,ResourceParams:a,EnableClustering:!0===t.meta_enableClustering,IsHighContrast:t.meta_isHighContrast,ColorMode:t.meta_colorMode,ClientColorSettings:t.meta_clientColorSettings,CorrelationId:t.meta_correlationId||"",RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,LocaleName:t.meta_localeName};let h={slideInfo:[],responseErrorCode:n.c.ErrorRESERVEDSuccess,responseErrorCategory:n.b.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},u=0;for(;u<this.m_settings.retryCount&&(u>=1&&p.shouldReduceResolution(h)&&this.adjustRequestParamsForRetry(c,t),h=await this.m_podProxy.getItemsResourceAsync(c),u+=1,!(h.slideInfo&&h.slideInfo.length>0))&&this.shouldRetry(h);){const i=t.meta_correlationId;t.meta_correlationId=Object(d.v4)(),c.CorrelationId=t.meta_correlationId,this.m_logger.sendTraceTag(506857036,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`imageLoader: Generating new correlationId for retrying request - resourceId:${e}, old correlation:${i}, new correlation:${t.meta_correlationId}, attempts:${u}, responseErrorCode:${h.responseErrorCode.toString()}, errorCodeMap:${h.itemErrorCodeMap?JSON.stringify([...h.itemErrorCodeMap]):""}`)}if(0===h.slideInfo.length||!h.slideInfo[0].ResourceData)return i.metadata.errorName=this.getErrorFromResponse(h,{responseType:"slideInfo_image",resourceId:e,cid:t.meta_correlationId,hasSlideInfo:!!h.slideInfo,slideInfoLen:h.slideInfo?h.slideInfo.length:0,hasRes:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].ResourceData,attempts:u},""),s(),i;this.m_logger.sendTraceTag(506857035,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`imageLoader: Got slideInfoResponse - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${u}`);const m=h.slideInfo[0].ResourceData,f=!(!h.usedOutputCache||"true"!==h.usedOutputCache.toString().toLowerCase().trim());return this.addImages(r,m,t,f),i.metadata={created:new Date,lastAccessed:new Date,cached:h.usedOutputCache&&"true"===h.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},s(),i});for(const e of a)this.resourceIdToImageLoadPromise[e.Id]=s;await s;for(const e of a)delete this.resourceIdToImageLoadPromise[e.Id];return this.imageData.getLoadResultInCache(e,t)||i}},this.slideInfoLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadSlideInfo"}};if(null==t.meta_clientWidth||null==t.meta_clientHeight)return this.m_logger.sendTraceTag(506857034,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"missing clientWidth or clientHeight"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;const r=JSON.parse(e).sid;if(!r)return this.m_logger.sendTraceTag(506857033,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"slideInfoLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;t.meta_correlationId||this.m_logger.sendTraceTag(506857032,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,"missing correlationId in slideInfoLoader. resourceId:"+e);const a={SlideLocations:[{slideId:{sid:r,cid:0}}],GetSlideImage:!1,ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,DevicePixelRatio:window.devicePixelRatio||1,RenderOptions:{RenderSlides:!0,RenderThumbs:!1},GetSlideAccessibilityModelData:!0,IsHighContrast:t.meta_isHighContrast,ColorMode:t.meta_colorMode,ClientColorSettings:t.meta_clientColorSettings,TranslateLanguage:t.meta_translateLanguage,CorrelationId:t.meta_correlationId||"",RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,LocaleName:t.meta_localeName},c={ExportAsImages:u.a.readBooleanOrDefault("forceSvg",!1)};c.Settings=this.m_getItemsSettings,c.ImageAppendOption=p.getImageAppendOption(t.meta_imageAppendOption),c.EnableClustering=!0===t.meta_enableClustering,c.UseAnimatableParts=!0,c.ExportShapeBuilderSVG=t.meta_enableSVGAsWebGLTexture,c.ConvertGifToVideo=t.meta_convertGifToVideo,t.meta_knownGlyphs&&(c.KnownGlyphs=t.meta_knownGlyphs),t.meta_knownSlideParts&&(c.KnownSlideParts=t.meta_knownSlideParts),t.meta_knownSlidePartsFlights&&(c.KnownSlidePartsFlights=t.meta_knownSlidePartsFlights),a.Filters=c;let h={slideInfo:[],responseErrorCode:n.c.ErrorRESERVEDSuccess,responseErrorCategory:n.b.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},m=0;for(;m<this.m_settings.retryCount&&(m>=1&&p.shouldReduceResolution(h)&&this.adjustRequestParamsForRetry(a,t),h=await this.m_podProxy.getItemsSlideInfosAsync(a),m+=1,!this.isValidSlideInfo(h)||!this.isValidSlideAXInfo(h,a))&&this.shouldRetry(h);)t.meta_correlationId=Object(d.v4)(),a.CorrelationId=t.meta_correlationId;let f="";if(this.isValidSlideInfo(h)&&this.isValidSlideAXInfo(h,a)||(f=this.getErrorFromResponse(h,{responseType:"slideInfo",resourceId:e,cid:t.meta_correlationId,hasSlideInfo:!!h.slideInfo,slideInfoLen:h.slideInfo?h.slideInfo.length:0,hasSlideshowInfo:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].SlideShowInfo,getAX:a.GetSlideAccessibilityModelData,hasAX:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].AccessibilityModel,attempts:m},"")),!this.isValidSlideInfo(h))return i.metadata.errorName=f,i;this.m_logger.sendTraceTag(506857031,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`slideInfoLoader: Got slideInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${m}, responseError:${f}, SlideShowInfo is not empty:${!!h.slideInfo&&h.slideInfo.length>0&&!!h.slideInfo[0].SlideShowInfo}`);const g=h.slideInfo;this.m_logger.sendTraceTag(506857030,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`slideInfoLoader: Got slideInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${m}, enableKnownGlyphsOptimization:${!!t.meta_knownGlyphs}, SlideShowInfo length:${JSON.stringify(g).length}`),i.resource=g[0],i.metadata={created:new Date,lastAccessed:new Date,cached:h.usedOutputCache&&"true"===h.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},!this.isValidSlideAXInfo(h,a)&&f&&(i.metadata.axErrorName=f),h.metadata&&(i.metadata.getItemsResult=h.metadata);let _,S=h.slideInfo[0].ResourceData;u.a.readBooleanOrDefault("hackTestMissingImages",!1)&&(S=[]),h.slideInfo[0].SlideShowInfo&&(_=s.a.parseResCat(h.slideInfo[0].SlideShowInfo.sld[0]).filter(e=>""===e.url));const v=!(!h.usedOutputCache||"true"!==h.usedOutputCache.toString().toLowerCase().trim());return this.addImages(_,S,t,v),i}},this.localizedStringLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorLocalizedStringNotFound"}};return this.m_settings&&this.m_settings.localizedStrings&&this.m_settings.localizedStrings[e]?(i.resource=this.m_settings.localizedStrings[e],i.metadata={created:new Date,lastAccessed:new Date},i):i}},this.presInfoAndSlideInfoLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadPresInfo"}};try{if(null==t.meta_clientWidth||null==t.meta_clientHeight)return this.m_logger.sendTraceTag(506857029,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"missing clientWidth or clientHeight"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;const r=JSON.parse(e);if(!(r.slideId&&r.slideId.sid||void 0!==r.slideIndex))return this.m_logger.sendTraceTag(506857028,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,"presInfoAndSlideInfoLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;const a={ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,CorrelationId:t.meta_correlationId||"",FilterHiddenSlideInfo:t.meta_filterHiddenSlideInfo,RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,IncludeSections:t.meta_includeSections};t.meta_correlationId||this.m_logger.sendTraceTag(506857027,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,"missing correlationId in presInfoAndSlideInfoLoader. resourceId:"+e);const h={SlideLocations:[r],GetSlideImage:!1,ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,DevicePixelRatio:window.devicePixelRatio||1,RenderOptions:{RenderSlides:!0,RenderThumbs:!1},GetSlideAccessibilityModelData:!0,IsHighContrast:t.meta_isHighContrast,ColorMode:t.meta_colorMode,ClientColorSettings:t.meta_clientColorSettings,TranslateLanguage:t.meta_translateLanguage,CorrelationId:t.meta_correlationId||"",RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,LocaleName:t.meta_localeName},f={ExportAsImages:u.a.readBooleanOrDefault("forceSvg",!1)};f.Settings=this.m_getItemsSettings,f.ImageAppendOption=p.getImageAppendOption(t.meta_imageAppendOption),f.EnableClustering=!0===t.meta_enableClustering,f.UseAnimatableParts=!0,f.ExportShapeBuilderSVG=t.meta_enableSVGAsWebGLTexture,f.ConvertGifToVideo=t.meta_convertGifToVideo,h.Filters=f;let g={presInfo:void 0,slideInfo:[],responseErrorCode:n.c.ErrorRESERVEDSuccess,responseErrorCategory:n.b.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},_=0,S=!1,v=this.m_settings.retryCount;for(;_<v;){try{S&&(h.GetSlideAccessibilityModelData=!1);const i=this.shouldTimeoutResponseStreamDownload(_);_>=1&&(p.shouldReduceResolution(g)&&this.adjustRequestParamsForRetry(h,t),u.a.readBooleanOrDefault("retryWhenGoodNetworkForBoot",!1)&&await Object(m.e)(()=>this.m_isNetworkHealthy));let r,s=t.meta_overrideDownloadTimeoutIfBadNetworkMs&&this.m_isNetworkHealthSpotty?t.meta_overrideDownloadTimeoutIfBadNetworkMs:void 0;if((u.a.readBooleanOrDefault("overrideAllTimeoutsForBoot",!1)||u.a.readBooleanOrDefault("overrideAllTimeoutsForBootIfBadNetwork",!1)&&this.m_isNetworkHealthSpotty)&&(s=u.a.readNumberOrDefault("overrideDownloadTimeoutForBootMs",0)||s,r=u.a.readNumberOrDefault(`overrideGetItemsTimeoutForBootAttempt${_+1}Ms`,0)||r),g=await this.m_podProxy.getItemsPresInfoAndSlideInfosAsync(a,h,{shouldTimeoutResponseStreamDownload:i,overrideDownloadTimeoutMs:s,overrideGetItemsTimeoutMs:r}),_+=1,g.presInfo&&this.isValidSlideInfo(g)&&(!c.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.RetryOnAXError")||this.isValidSlideAXInfo(g,h)))break;if(g.responseErrorCode!==n.c.ErrorDownloadResponseStreamTimeout||S){if(this.shouldRetry(g)){const i=t.meta_correlationId;t.meta_correlationId=Object(d.v4)(),a.CorrelationId=t.meta_correlationId,this.m_logger.sendTraceTag(506857025,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`presInfoAndSlideInfoResponse: Generating new correlationId for retrying request - resourceId:${e}, old correlation:${i}, new correlation:${t.meta_correlationId},\n                attempts:${_}, responseErrorCode:${g.responseErrorCode.toString()}, errorCodeMap:${g.itemErrorCodeMap?JSON.stringify([...g.itemErrorCodeMap]):""}`);continue}break}this.m_logger.sendTraceTag(506857026,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,"presInfoAndSlideInfoLoader - switch to use fallback request as ErrorDownloadResponseStreamTimeout error received."),S=!0,_-=1}catch(e){this.m_logger.sendTraceTag(506857024,l.a.msoulscat_Wac_PptSlideshow,o.c.Warning,`presInfoAndSlideInfoLoader - exception during call m_podProxy.getItemsPresInfoAndSlideInfosAsync, attempts:${_}, info: ${e}. `)}this.m_isNetworkHealthSpotty&&u.a.readBooleanOrDefault("overrideRetryCountForBootIfBadNetwork",!1)&&(v=u.a.readNumberOrDefault("overrideRetryCount",v))}let y="";if(g.presInfo&&this.isValidSlideInfo(g)&&this.isValidSlideAXInfo(g,h)||(y=this.getErrorFromResponse(g,{responseType:"presInfoAndSlideInfo",resourceId:e,cid:t.meta_correlationId,hasSlideInfo:!!g.slideInfo,slideInfoLen:g.slideInfo?g.slideInfo.length:0,hasSlideshowInfo:!!(g.slideInfo&&g.slideInfo.length>0)&&!!g.slideInfo[0].SlideShowInfo,getAX:h.GetSlideAccessibilityModelData,hasAX:!!(g.slideInfo&&g.slideInfo.length>0)&&!!g.slideInfo[0].AccessibilityModel,attempts:_},"")),!g.presInfo)return i.metadata.errorName=y,i.metadata.isIntentional=g.responseIsIntentional,i;this.m_logger.sendTraceTag(506856995,l.a.msoulscat_Wac_PptSlideshow,o.c.Info,`presInfoAndSlideInfoResponse: Got presInfoAndSlideInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${_}`),i.metadata={created:new Date,lastAccessed:new Date,cached:g.usedOutputCache&&"true"===g.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},g.metadata&&(i.metadata.getItemsResult=g.metadata);const T={resourceId:"",resource:g.presInfo,metadata:i.metadata,options:t};if(this.presInfo.add(T),!this.isValidSlideInfo(g))return i.resource=g.presInfo,this.m_logger.sendTraceTag(506856994,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,`presInfoAndSlideInfoResponse: failed to get slideInfo in presInfoAndSlideInfo. errorName:${y}, resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${_}`),T;{i.resource={...g.presInfo,...g.slideInfo[0]},this.isValidSlideAXInfo(g,h)||(i.metadata.axErrorName=y);const e={resourceId:JSON.stringify({sid:g.slideInfo[0].ID.sid,cid:0}),resource:g.slideInfo[0],metadata:i.metadata,options:t};this.slideInfo.add(e);const n=g.slideInfo[0].ResourceData;let r;g.slideInfo[0].SlideShowInfo&&(r=s.a.parseResCat(g.slideInfo[0].SlideShowInfo.sld[0]).filter(e=>""===e.url));const a=!(!g.usedOutputCache||"true"!==g.usedOutputCache.toString().toLowerCase().trim());this.addImages(r,n,t,a)}return i}catch(e){return this.m_logger.sendTraceTag(506856993,l.a.msoulscat_Wac_PptSlideshow,o.c.Error,`presInfoAndSlideInfoLoader - exception during call load: ${e}. `),i}}},this.m_podProxy=e,this.m_logger=t,this.m_settings=i||{retryCount:3};const a={};if(i&&i.settings){u.a.addOrUpdateSetting(i.settings,"getitemsmanaged","supportsSlideInfoResult",u.a.readStringOrDefault("enableSlideInfoResult","false"));for(const e in i.settings){if(-1===e.toLowerCase().indexOf("getitems"))continue;const t=i.settings[e],n={};for(const e in t)n[e]=t[e].toString();a[e]=n}}this.m_getItemsSettings=a,Object(h.c)({logger:this.m_logger,settings:i?i.settings:void 0,disabledChangeGates:this.m_settings.disabledChangeGates}),this.presInfoAndSlideInfo=new r.b(this.presInfoAndSlideInfoLoader),this.presInfo=new r.b(this.presInfoLoader),this.slide=new r.b(this.slideLoader),this.slideViewData=new r.b(this.slideViewDataLoader),this.imageData=new r.b(this.imageLoader),this.imageData.events.on("removed",e=>this.disposeImage(e)),this.shapeViewData=new r.b(this.shapeViewDataLoader),this.slideInfo=new r.b(this.slideInfoLoader),this.localizedString=new r.b(this.localizedStringLoader)}}},function(e,t,i){"use strict";i.r(t),i.d(t,"WebGLShaderProcessor",(function(){return n}));class n{postProcessor(e,t,i,n,r){if(r.drawBuffersExtensionDisabled){const t=/#extension.+GL_EXT_draw_buffers.+(enable|require)/g;e=e.replace(t,"")}return e}constructor(){this.shaderLanguage=0}}},function(e,t,i){"use strict";i.r(t),i.d(t,"WebGL2ShaderProcessor",(function(){return r}));const n=/(flat\s)?\s*varying\s*.*/;class r{attributeProcessor(e){return e.replace("attribute","in")}varyingCheck(e,t){return n.test(e)}varyingProcessor(e,t){return e.replace("varying",t?"in":"out")}postProcessor(e,t,i){const n=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),i){const t=-1!==e.search(/layout *\(location *= *0\) *out/g);e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(n||t?"":"layout(location = 0) out vec4 glFragColor;\n")+"void main(")}else if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e;return e}constructor(){this.shaderLanguage=0}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(69),r=i(13),a=i(9),s=i(3),o=i(7);class l{}l.defaultVideoHeight=480,l.defaultVideoWidth=640,l.defaultFrameRate=30;class d{async startMediaCaptureAsync(e,t=!1){e&&this.updateConstraints(e,t),this.mediaStreamSource.stream&&this.mediaStreamSource.stopMediaCapture();const i=await this.mediaStreamSource.startMediaCaptureAsync(this.videoConstraints);if(i!==n.a.ErrorNone)return i;if(!this.mediaStreamSource.stream)return n.a.ErrorUnknown;const r=this.getMediaStreamResolution(this.mediaStreamSource.stream);this.videoElement.width=r.x,this.videoElement.height=r.y,this.videoElement.srcObject=this.mediaStreamSource.stream;try{await this.videoElement.play()}catch(e){return n.a.ErrorVideoPlaybackFailed}return n.a.ErrorNone}stopMediaCapture(){this.videoElement.pause(),this.videoElement.srcObject=null,this.mediaStreamSource.stopMediaCapture()}get VideoElement(){return this.videoElement}get DeviceId(){if(this.videoConstraints.deviceId)return"string"==typeof this.videoConstraints.deviceId?this.videoConstraints.deviceId:JSON.stringify(this.videoConstraints.deviceId)}get isActive(){return!(!this.mediaStreamSource||!this.mediaStreamSource.stream)&&this.mediaStreamSource.stream.active}resetToOriginalConstraints(){this.videoConstraints=this.originalVideoConstraints}updateConstraints(e,t){const i=t?{deviceId:void 0,width:void 0,height:void 0,frameRate:void 0,facingMode:void 0}:this.videoConstraints,n=i;e.deviceId&&e.deviceId!==i.deviceId&&(n.deviceId=e.deviceId),e.width&&e.width!==i.width&&(n.width=e.width),e.height&&e.height!==i.height&&(n.height=e.height),e.frameRate&&e.frameRate!==i.frameRate&&(n.frameRate=e.frameRate),e.facingMode&&e.facingMode!==i.facingMode&&(n.facingMode=e.facingMode),this.videoConstraints=n}getMediaStreamResolution(e){if(e){const t=e.getVideoTracks();if(t&&t.length>0){const e=t[0].getSettings();if(e.width&&e.height)return a.a.sendTraceTag(506857090,s.a.msoulscat_Wac_PptSession,o.a.Info,`MediaStreamClient::getMediaStreamResolution : extracted resolution from MediaStream video track. width=${e.width}, height=${e.height}`),new r.k(e.width,e.height)}}return a.a.sendTraceTag(506857089,s.a.msoulscat_Wac_PptSession,o.a.Error,"MediaStreamClient::getMediaStreamResolution : Unable to get resolution from MediaStream track. Falling back to default dimensions."),new r.k(l.defaultVideoWidth,l.defaultVideoHeight)}constructor(e){this.mediaStreamSource=e.source,this.videoConstraints=e.videoConstraints?e.videoConstraints:{},this.originalVideoConstraints=this.videoConstraints;const t=document.createElement("video");t.id=e.id,this.videoElement=t}}},function(e,t,i){(function(e){function i(e,t){for(var i=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}t.resolve=function(){for(var t="",r=!1,a=arguments.length-1;a>=-1&&!r;a--){var s=a>=0?arguments[a]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,r="/"===s.charAt(0))}return(r?"/":"")+(t=i(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var a=t.isAbsolute(e),s="/"===r(e,-1);return(e=i(n(e.split("/"),(function(e){return!!e})),!a).join("/"))||a||(e="."),e&&s&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,i){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var r=n(e.split("/")),a=n(i.split("/")),s=Math.min(r.length,a.length),o=s,l=0;l<s;l++)if(r[l]!==a[l]){o=l;break}var d=[];for(l=o;l<r.length;l++)d.push("..");return(d=d.concat(a.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,n=-1,r=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!r){n=a;break}}else r=!1;return-1===n?i?"/":".":i&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var i=function(e){"string"!=typeof e&&(e+="");var t,i=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){i=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(i,n)}(e);return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,i=0,n=-1,r=!0,a=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(47!==o)-1===n&&(r=!1,n=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1);else if(!r){i=s+1;break}}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===i+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,i(168))},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(9),r=i(3),a=i(7);class s{static getInstance(){return this.m_componentManager||(this.m_componentManager=new s),this.m_componentManager}registerComponent(e,t){const i={componentId:e,loader:t};this.m_components.find(e=>e.componentId===i.componentId)?n.a.sendTraceTag(506857104,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`ComponentManager: Component ${i.componentId} already registered`):this.m_components.push(i)}getComponent(e){const t=this.m_components.find(t=>t.componentId===e);if(t)return t.componentInstance?t.componentInstance:void 0;n.a.sendTraceTag(506857103,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`ComponentManager: Attempting to fetch a Component that isn't registered. ComponentId: ${e}.`)}async loadComponentAsync(e){const t=this.m_components.find(t=>t.componentId===e);if(!t){const t="ComponentManager: Attempting to load a Component that hasn't been registered yet. ComponentId: "+e;return n.a.sendTraceTag(506857102,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,t),Promise.reject(new Error(t))}if(t.componentInstance)return t.componentInstance;let i=this.m_pendingLoads.get(e);i||(i=this.loadComponentInternalAsync(t),this.m_pendingLoads.set(e,i));try{t.componentInstance=await i}catch(t){const i=`ComponentManager: Exception while loading Component or one of its dependencies. ComponentId: ${e}, Exception:${t}`;return n.a.sendTraceTag(506857101,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,i),Promise.reject(new Error(i))}finally{this.m_pendingLoads.delete(e)}return t.componentInstance}async loadComponentInternalAsync(e){n.a.sendTraceTag(506857100,r.a.msoulscat_Wac_PptSession,a.a.Info,"ComponentManager: Loading Component with ComponentId: "+e.componentId);const t=await e.loader.loadAsync();if(t.componentId!==e.componentId){const i=`ComponentManager: Loaded Component Id doesn't match the requested Component Id. Requested ComponentId: ${e.componentId}, Loaded ComponentId: ${t.componentId}`;return n.a.sendTraceTag(506857099,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,i),Promise.reject(new Error(i))}return await Promise.all(t.dependencies.map(e=>this.loadComponentAsync(e))),n.a.sendTraceTag(506857098,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"ComponentManager: Initializing Component with ComponentId: "+e.componentId),await t.onLoadedAsync(this),t}constructor(){this.m_components=[],this.m_pendingLoads=new Map}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(9),r=i(3),a=i(7),s=i(1),o=i(166),l=i(61),d=i(4),c=i(10),h=i(133);class u{onLoadedAsync(e){return Promise.resolve()}addEvents(e){e.events.on("sessionEnded",()=>{this.m_networkMonitorAddon&&this.m_networkMonitorAddon.stopAndRecord()})}initialize(e,t){s.a.readBooleanOrDefault("enableNetworkMonitorAddon",!0)&&void 0!==e&&void 0!==t&&(this.m_networkMonitorAddon=new o.a(e,t),window.addEventListener("beforeunload",()=>{this.m_networkMonitorAddon&&this.m_networkMonitorAddon.stopAndRecord()}));try{const e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(e){const t=Date.now(),i=null!=e.downlink?e.downlink:void 0,s=null!=e.rtt?e.rtt:void 0,o=null!=e.effectiveType?e.effectiveType:void 0,l=Date.now()-t;n.a.sendTraceTag(561836061,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`SlideShowApp::Client network info - downlinkSpeed: ${i}Mbps, rtt: ${s}ms, effectiveType: ${o}, measure call duration ${l}`)}else n.a.sendTraceTag(561640279,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"SlideShowApp::network information API not supported by the browser")}catch(e){n.a.sendTraceTag(561640280,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"SlideShowApp::logClientNetworkInfo exception: "+Object(l.c)(e))}}startHeartbeatTelemetry(e,t,i){if(!d.ChangeGate.isChangeGateEnabled("SSA.enableSendingHeartbeatTelemetry"))return;let n=0,s=0,o=0;const l=window.setInterval(()=>{i&&(o=Date.now(),i.sendTraceTag(571081889,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`SlideShowApp - sending heartbeat telemetry, counter: ${n}, currentTime: ${o}, performanceNow: ${Math.round(performance.now())}, lastHeartbeatDuration:${s>0?o-s:0}`),n+=1,s=o,n>t&&(i.sendTraceTag(571078674,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"SlideShowApp - stop heartbeat telemetry as it hits max count"),window.clearInterval(l)),"flush"in i&&i.flush())},e)}convertBootMetricTimesToPerformanceNowTiming(e){e&&(e.startFromTime&&(e.startFromTime=e.startFromTime-performance.timing.navigationStart),e.initWopiTime&&(e.initWopiTime=e.initWopiTime-performance.timing.navigationStart),e.bootstrapperInitTime&&(e.bootstrapperInitTime=e.bootstrapperInitTime-performance.timing.navigationStart),e.createViewerTime&&(e.createViewerTime=e.createViewerTime-performance.timing.navigationStart),e.previewSessionLoadAppTime&&(e.previewSessionLoadAppTime=e.previewSessionLoadAppTime-performance.timing.navigationStart),e.loadSlideShowTime&&(e.loadSlideShowTime=e.loadSlideShowTime-performance.timing.navigationStart),e.aspxTime&&(e.aspxTime=e.aspxTime-performance.timing.navigationStart),e.jsDownloadTime&&(e.jsDownloadTime=e.jsDownloadTime-performance.timing.navigationStart),e.sliceLoadTime&&(e.sliceLoadTime=e.sliceLoadTime-performance.timing.navigationStart),e.uiHostLoadingSpinnerStartTime&&(e.uiHostLoadingSpinnerStartTime=e.uiHostLoadingSpinnerStartTime-performance.timing.navigationStart),e.driveItemRequestStartTime&&(e.driveItemRequestStartTime=e.driveItemRequestStartTime-performance.timing.navigationStart),e.driveItemRequestEndTime&&(e.driveItemRequestEndTime=e.driveItemRequestEndTime-performance.timing.navigationStart),e.presenterStartTime&&(e.presenterStartTime=e.presenterStartTime-performance.timing.navigationStart),e.bootstrapperScriptLoadStartTime&&(e.bootstrapperScriptLoadStartTime=e.bootstrapperScriptLoadStartTime-performance.timing.navigationStart),e.bootstrapperScriptLoadEndTime&&(e.bootstrapperScriptLoadEndTime=e.bootstrapperScriptLoadEndTime-performance.timing.navigationStart),e.incomingSessionJoinedTime&&(e.incomingSessionJoinedTime=e.incomingSessionJoinedTime-performance.timing.navigationStart),e.getPresentationUrlStartTime&&(e.getPresentationUrlStartTime=e.getPresentationUrlStartTime-performance.timing.navigationStart),e.getPresentationUrlEndTime&&(e.getPresentationUrlEndTime=e.getPresentationUrlEndTime-performance.timing.navigationStart),e.containerCreationStartTime&&(e.containerCreationStartTime=e.containerCreationStartTime-performance.timing.navigationStart),e.containerCreationEndTime&&(e.containerCreationEndTime=e.containerCreationEndTime-performance.timing.navigationStart))}initUsageTelemetry(e,t,i,o,l,d){if(!t.remoteTelemetryUrl)return void n.a.sendTraceTag(570787426,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"ViewingApp - HealthAdapter not created. RemoteTelemetryUrl provided: "+!!t.remoteTelemetryUrl);const u={isHealthEnabled:!0,remoteTelemetryUrl:t.remoteTelemetryUrl,isQosEnabled:!0,isKpiEnabled:!1,heartbeatIntervalMs:s.a.readNumberOrDefault("healthAdapterHeartbeatIntervalMs",3e5),recordQosPillarToWarmPipelineIntervalMs:s.a.readNumberOrDefault("healthAdapterWarmPipeIntervalMs",864e5)},m=(new h.UAParser).getResult(),f={application:"PowerPoint",applicationLcid:e.applicationLocaleName?i.appSettings.applicationLocaleName:i.appSettings.applicationLcid,applicationMode:"Slideshow",applicationModeExtended:d,browser:m.browser.name,browserVersion:m.browser.version,clientVersion:e.clientVersion,datacenter:t.datacenter,fileExtension:t.fileExtension,host:i.appSettings.fileHost,loggableUserId:Object(c.f)(i.appSettings.userId),osVersion:`${m.os.name}(${m.os.version})`,ring:i.appSettings.ring,serverDocId:t.docId,session_id:e.userSessionId,tenantId:e.tenantId,uiHost:i.appSettings.uiHost},p=new Map;e.uiHostRing&&p.set("uiHostRing",e.uiHostRing),i.appSettings.teamsCallId&&p.set("TeamsCallId",i.appSettings.teamsCallId),e.hostExperience&&p.set("HostExperience",e.hostExperience),t.fileSizeBytes&&p.set("FileSizeBytes",""+t.fileSizeBytes),e.contentId&&p.set("ContentId",e.contentId),e.participantId&&p.set("ParticipantId",e.participantId),e.endpointId&&p.set("EndpointId",e.endpointId);for(const[e,t]of l)p.set(e,t);void 0!==e.isRetry&&null!==e.isRetry&&p.set("IsRetrySession",e.isRetry.toString()),e.clientBuildRing&&p.set("ClientBuildRing",e.clientBuildRing),c.a.init(u,f,p).then(()=>{n.a.sendTraceTag(571839374,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"ViewingApp - HealthAdapter init completed"),c.a.addToQosPillar("Open")}).catch(e=>{n.a.sendTraceTag(571839375,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"ViewingApp - HealthAdapter init error: "+e)}),c.b.init({ariaEndpointTarget:t.ariaEndpointTarget,logger:o},f).then(()=>{n.a.sendTraceTag(556897806,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"ViewingApp - OtelJSWrapper init completed")}).catch(e=>{n.a.sendTraceTag(556897807,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"ViewingApp - OtelJSWrapper init error: "+e)})}constructor(){this.componentId="CommonMonitoring",this.dependencies=[]}}},function(e,t,i){"use strict";function n(e,t){let i,n;const r=(...a)=>{i=a,n||(e(...i),n=window.setTimeout(()=>{n=void 0,i&&(r(...i),i=null)},t),i=null)};return r}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));const n=[{namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{namespace:"Office.Shared.Online.Data",ariaTenant:"4ad8b2b2029e481fb82edb7aac29de59-94494dd8-b684-4f92-ab7f-6b414eb77798-7917"},{namespace:"Office.PowerPoint",ariaTenant:"e97859101370486fbcb67f5a023da3fc-29b89831-2d28-4841-8fa6-338080fae3a4-7206"},{namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{namespace:"Office.Excel.Client",ariaTenant:"19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873"},{namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{namespace:"Office.Shared.Online",ariaTenant:"d034371e26194a76a187c7108b3837ca-731725e8-1dc7-4eca-a754-b09c9d2b8dd5-6502"},{namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"},{namespace:"Office.Extensibility",ariaTenant:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439"}],r=[{namespace:"Office.DNM.Word.Online",ariaTenant:"541f81cf685f4bccb9e5395b0add4d41-2c1afbab-72ae-471a-a985-efea62ea9e83-7130"},{namespace:"Office.DNM.Visio.Online",ariaTenant:"feba3d98f7c0481c8b63754573a80618-7311e9e0-365d-4a1b-b0fb-a238e0bc7528-6955"},{namespace:"Office.DNM.Sandbox",ariaTenant:"b0aae8a3009047b9bf4d3b17439319b6-e96e56cc-5657-463a-a2f2-dc8c0fb9d41b-7136"},{namespace:"Office.DNM.Excel",ariaTenant:"58fd209df5254081ba538f7f4bc34ef5-7b3b52dc-fdf5-4d95-917e-a356694c1ebc-7071"}]},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(130);class r extends n.a{get underlyingResource(){return this._buffer}constructor(e){super(),this._buffer=e}}},function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return l}));var n=i(0),r=i(6),a=i(5);class s{clearCache(){for(const e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}static CreateFromItem(e,t,i,r,a,o,l){const d=n.c.FromTransforms(e.transform,o||n.c.Identity,e.animationTransform||n.c.Identity),c=d.transformVector(new n.f(1,0)),h=d.transformVector(new n.f(0,1)),u=i.transformedBounds(d),m={center:u?u.center:n.f.Zero,size:u?i.size.multiply(new n.f(c.length(),h.length())):n.f.Zero,rotation:e.transform.rotation,flipX:e.transform.scale.x<0,flipY:e.transform.scale.y<0};return new s([{item:e,includeSubtree:r,textRange:a}],m,t,void 0,o,l)}static TryCreateFromShape(e,t,i,n,r){const o=Object(a.q)(e,!1);return o?s.CreateFromItem(e,t,o,i,void 0,n,r):void 0}static TryCreateFromText(e,t,i,a){if(e.text){const o=e.text.getFullRange(),l=i||o;if(o&&l&&o.contains(l)){const i=e.text.getBoundsOfRange(l);if(i){const r=i.transformedBounds(n.e.fromScaleAndTranslation(e.transform.scale.inverse(),e.transform.preTranslation.negate()));return r?s.CreateFromItem(e,t,r,!0,l,a):void 0}}else r.a.Error(592525387,`TryCreateFromText out of range: ${i?(i.start,i.last,"]"):void 0} fullRange: ${o?(o.start,o.last,"]"):"undefined"}`)}else r.a.Error(592525386,"TryCreateFromText on Shape with no Text")}static TryCreateFromGroup(e,t,i,n){const r=Object(a.p)(e,!1,a.b.none,a.b.none,e.transform.toInverseMatrix3());return r?s.CreateFromItem(e,t,r,i,void 0,n):void 0}constructor(e,t,i,n,r,a){this.renderDataMap={},this.contents=e,this.location=t,this.zPosition=i,this.parentTransform=r,this.morphingGrid=n,this.shapeInterpolation=a}}class o{clearCache(){for(let e of this.keyFrames||[])e&&e.clearCache()}constructor(e=[]){this.renderDataMap={},this.keyFrames=e}}class l{clearCache(){this.elements.forEach(e=>e.clearCache())}constructor(){this.elements=[]}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return c}));var n,r,a=i(9),s=i(3),o=i(7),l=i(135);!function(e){e.PPTSharingResumeSlideShow="PPTSharingResumeSlideShowObject",e.PPTLiveGlobalAppState="PPTLiveGlobalAppStateObject"}(n||(n={}));class d{static getCurrentInstance(e){return this.m_localStorageHelper||(this.m_localStorageHelper=new d(e)),this.m_localStorageHelper}clearEntryFromLocalStorage(e){try{localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){this.m_logger.sendTraceTag(506856278,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper:clearEntryFromLocalStorage - error while trying to clear previous call state: "+e)}}writeToLocalStorage(e,t){try{this.m_logger.sendTraceTag(506856277,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LocalStorageHelper: Writing to localStorage for localStorageCaller: "+e),localStorage.setItem(e,JSON.stringify(t)),this.m_logger.sendTraceTag(506856276,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LocalStorageHelper:Saved to local storage for : "+e)}catch(e){this.m_logger.sendTraceTag(506856275,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper: Error when saving State: "+e)}}readFromLocalStorage(e){try{const t=localStorage.getItem(e);if(t)return t}catch(e){this.m_logger.sendTraceTag(506856274,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper: Error when reading from local storage: "+e)}return""}constructor(e){this.m_logger=e}}!function(e){e.PrivateViewingAddon="PrivateViewingAddon",e.GridView="GridView",e.SlideShowToolbar="SlideShowToolbar",e.SlideShowInkingToolbar="SlideShowInkingToolbar"}(r||(r={}));class c{updateGlobalState(e,t){let i=this.fetchGlobalState();switch(a.a.sendTraceTag(506856273,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: update GlobalState for "+e),i&&i.SessionKey!==this.m_sessionKey&&(this.m_localStorageHelper.clearEntryFromLocalStorage(n.PPTLiveGlobalAppState),a.a.sendTraceTag(506856272,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: Current SessionKey is different from SessionKey in localStorage, clearing entry."),i=void 0),i||(i={SessionKey:this.m_sessionKey,LocalAppState:{}}),e){case r.PrivateViewingAddon:i.LocalAppState.role=t.role,i.LocalAppState.currentSlideLocation=t.currentSyncState,i.LocalAppState.currentAnimationState=t.currentAnimationState,i.LocalAppState.globalSyncState=t.globalSyncState,i.LocalAppState.globalAnimationState=t.globalAnimationState;break;default:a.a.sendTraceTag(506856271,s.a.msoulscat_Wac_PptLive,o.a.Error,`PPTLiveGlobalStateManager: ${e} not in in PPTLiveAppComponent list.`),i.LocalAppState.CallerNotDefined=t}this.m_localStorageHelper.writeToLocalStorage(n.PPTLiveGlobalAppState,i)}fetchGlobalState(){try{const e=JSON.parse(this.m_localStorageHelper.readFromLocalStorage(n.PPTLiveGlobalAppState));if(e&&e.LocalAppState)return e}catch(e){this.m_logger.sendTraceTag(506856270,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"PPTLiveGlobalStateManager: Error when reading from local storage: "+e)}}fetchGlobalStateForCurrentSharingSession(){const e=this.fetchGlobalState();if(e&&e.LocalAppState&&e.SessionKey===this.m_sessionKey)return e}sanitizeAndHashUrl(e){if(e){const t=e.split("tempauth=");if(t&&t.length>=1){const e=t[0];if(e)return this.calculateHash(e)}}return a.a.sendTraceTag(506856269,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: Failed to get document Url."),""}calculateHash(e){return e?""+(new l.sha256).update(e).digest("hex"):""}constructor(e,t,i){this.m_logger=i,this.sanitizeAndHashUrl(t),this.m_sessionKey="sharing_"+e,this.m_localStorageHelper=d.getCurrentInstance(this.m_logger)}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return l}));var n=i(9),r=i(3),a=i(7),s=i(34);class o{on(e,t){return this.m_events.on(e,t),this}init(e,t,i){this.m_loggableFeatureName=e.loggableFeatureName||"",this.m_syncStateManager=t,this.m_logger=i,this.m_attemptingToExitPrivateViewing=!1,console.log(n.a,n.a.setLogger),n.a.setLogger(this.m_logger),n.a.sendTraceTag(507004830,r.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: initialized for feature:${this.m_loggableFeatureName}.`)}localStateChanged(e,t){if(!this.m_syncStateManager)throw n.a.sendTraceTag(507004829,r.a.msoulscat_Wac_PptLive,a.a.Error,"PrivateViewingManager.localStateChanged m_syncStateManager is null"),new Error("PrivateViewingManager.localStateChanged m_syncStateManager is null");const i=this.m_syncStateManager.getGlobalState();this.m_syncStateManager.isInPrivateViewing()&&this.m_attemptingToExitPrivateViewing?this.m_syncStateManager.areSyncStatesEqual(e,i,!0)?(n.a.sendTraceTag(507004828,r.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged exit private viewing. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`),this.m_attemptingToExitPrivateViewing=!1,this.m_syncStateManager.isInPrivateViewingChanged(!1)):n.a.sendTraceTag(507004827,r.a.msoulscat_Wac_PptLive,a.a.Warning,`PrivateViewingManager: trying to exit private viewing to the wrong syncState. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`):this.m_pendingSyncStateChangeRequests.some(t=>{var i;return null===(i=this.m_syncStateManager)||void 0===i?void 0:i.areSyncStatesEqual(t,e,!0)})?(this.m_pendingSyncStateChangeRequests.splice(0,this.m_pendingSyncStateChangeRequests.findIndex(t=>{var i;return null===(i=this.m_syncStateManager)||void 0===i?void 0:i.areSyncStatesEqual(t,e,!0)})+1),n.a.sendTraceTag(507004826,r.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged found request in array. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`)):this.m_syncStateManager.isInPrivateViewing()||this.m_syncStateManager.areSyncStatesEqual(i,e)||this.m_attemptingToExitPrivateViewing||(this.m_syncStateManager.hadPreviousUserInput(t)?(n.a.sendTraceTag(507004825,r.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged enter private viewing. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`),this.m_syncStateManager.isInPrivateViewingChanged(!0)):(n.a.sendTraceTag(507004824,r.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged unintentional private viewing. Trying to put user back in sync. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`),this.m_syncStateManager.goToSyncState(i)))}async globalStateChanged(e){if(this.m_pendingSyncStateChangeRequests.push(e),!this.m_syncStateManager)throw n.a.sendTraceTag(507004823,r.a.msoulscat_Wac_PptLive,a.a.Error,"PrivateViewingManager.localStateChanged m_syncStateManager is null"),new Error("PrivateViewingManager.localStateChanged m_syncStateManager is null");this.m_syncStateManager.isInPrivateViewing()&&this.m_attemptingToExitPrivateViewing&&(n.a.sendTraceTag(507004822,r.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: globalStateChanged while user is in private viewing and trying to exit private viewing. NewSyncState: "+JSON.stringify(e)),await this.m_syncStateManager.goToSyncState(e)),n.a.sendTraceTag(507004821,r.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: globalStateChanged. NewSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`)}resetPrivateViewingManager(){this.m_attemptingToExitPrivateViewing=!1,this.m_pendingSyncStateChangeRequests=[],n.a.sendTraceTag(507004820,r.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: reset PrivateViewingManager")}async returnToPresenter(e){if(!this.m_syncStateManager)throw n.a.sendTraceTag(507004819,r.a.msoulscat_Wac_PptLive,a.a.Error,"PrivateViewingManager.localStateChanged m_syncStateManager is null"),new Error("PrivateViewingManager.localStateChanged m_syncStateManager is null");if(!this.m_syncStateManager.isInPrivateViewing())return void n.a.sendTraceTag(507004818,r.a.msoulscat_Wac_PptLive,a.a.Error,"PrivateViewingManager: tried to returnToPresenter but is not in private viewing");this.m_attemptingToExitPrivateViewing=!0;const t=this.m_syncStateManager.getGlobalState();this.m_syncStateManager.areSyncStatesEqual(e,t)?(n.a.sendTraceTag(507004817,r.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: returnToPresenter localState == globalState, so exit private viewing."),this.m_attemptingToExitPrivateViewing=!1,this.m_syncStateManager.isInPrivateViewingChanged(!1)):(n.a.sendTraceTag(507004816,r.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: returnToPresenter navigating to "+JSON.stringify(t)),await this.m_syncStateManager.goToSyncState(t))}constructor(){this.m_loggableFeatureName="",this.m_events=new s.EventEmitter,this.m_pendingSyncStateChangeRequests=[],this.m_attemptingToExitPrivateViewing=!1}}class l{recordInboundSyncEvent(e){this.m_pendingSyncStateChangeRequests.push(e),n.a.sendTraceTag(507004833,r.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: recordInboundSyncEvent. NewSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`)}shouldBroadcastOutboundSyncEvent(e){return this.m_pendingSyncStateChangeRequests.some(t=>this.m_syncStateManager.areSyncStatesEqual(t,e,!0))?(this.m_pendingSyncStateChangeRequests.splice(0,this.m_pendingSyncStateChangeRequests.findIndex(t=>this.m_syncStateManager.areSyncStatesEqual(t,e,!0))+1),n.a.sendTraceTag(507004832,r.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: shouldBroadcastOutboundSyncEvent FALSE. newSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`),!1):(n.a.sendTraceTag(507004831,r.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: shouldBroadcastOutboundSyncEvent TRUE. newSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`),!0)}resetPendingSyncEvents(){this.m_pendingSyncStateChangeRequests=[]}constructor(e,t,i){this.m_pendingSyncStateChangeRequests=[],this.m_logger=i,this.m_loggableFeatureName=e.loggableFeatureName||"",this.m_syncStateManager=t,n.a.setLogger(this.m_logger),n.a.sendTraceTag(507004834,r.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: initialized for feature:${this.m_loggableFeatureName}.`)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(8),r=i(4),a=i(34),s=i(9),o=i(3),l=i(7),d=i(13),c=i(1),h=i(108);class u{enableMouseInput(){c.a.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_mouseInputEnabled||(this.m_container.addEventListener("click",this.m_boundOnClick),this.m_mouseInputEnabled=!0,s.a.sendTraceTag(506857238,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: enableMouseInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableMouseInput(){c.a.readBooleanOrDefault("enableOpticalZoom",!1)&&!this.m_mouseInputEnabled||(this.m_container.removeEventListener("click",this.m_boundOnClick),this.m_mouseInputEnabled=!1,s.a.sendTraceTag(506857237,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: disableMouseInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableKeyboardInput(){this.m_container.addEventListener("keydown",this.m_boundOnKeyDown),s.a.sendTraceTag(506857236,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: enableKeyboardInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `)}disableKeyboardInput(){this.m_container.removeEventListener("keydown",this.m_boundOnKeyDown),s.a.sendTraceTag(506857235,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: disableKeyboardInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `)}enableTouchInput(){if(c.a.readBooleanOrDefault("enableOpticalZoom",!1)){if(this.m_touchInputEnabled)return}else r.ChangeGate.isChangeGateEnabled("SlideShowCore.offSwipeBeforeOnSwipe")&&(this.m_hammerManager.off("swipeleft swiperight",this.m_boundOnSwipeEvent),s.a.sendTraceTag(506857234,o.a.msoulscat_Wac_PptLive,l.a.Info,"InputsAddon: offSwipeBeforeOnSwipe"));this.m_hammerManager.on("swipeleft swiperight",this.m_boundOnSwipeEvent),this.m_touchInputEnabled=!0,s.a.sendTraceTag(506857233,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: enableTouchInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `)}disableTouchInput(){c.a.readBooleanOrDefault("enableOpticalZoom",!1)&&!this.m_touchInputEnabled||(this.m_hammerManager.off("swipeleft swiperight",this.m_boundOnSwipeEvent),this.m_touchInputEnabled=!1,s.a.sendTraceTag(506857232,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: disableTouchInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableOpticalZoomTouchInputs(){this.m_opticalZoomTouchInputsEnabled||(this.m_hammerManager.on("panstart panmove panend",this.m_boundOnTouchPanEvent),this.m_hammerManager.on("pinchstart pinchmove pinchend",this.m_boundOnPinchEvent),this.m_opticalZoomTouchInputsEnabled=!0,s.a.sendTraceTag(506857231,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: enableOpticalZoomTouchInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableOpticalZoomTouchInputs(){this.m_opticalZoomTouchInputsEnabled&&(this.m_hammerManager.off("panstart panmove panend",this.m_boundOnTouchPanEvent),this.m_hammerManager.off("pinchstart pinchmove pinchend",this.m_boundOnPinchEvent),this.m_opticalZoomTouchInputsEnabled=!1,s.a.sendTraceTag(506857230,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: disableOpticalZoomTouchInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableOpticalZoomMouseInputs(){this.m_opticalZoomMouseInputsEnabled||(this.m_container.addEventListener("wheel",this.m_boundOnWheel),this.m_hammerManager.on("panstart panmove panend",this.m_boundOnMousePanEvent),this.m_opticalZoomMouseInputsEnabled=!0,s.a.sendTraceTag(506857229,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: enableOpticalZoomMouseInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableOpticalZoomMouseInputs(){this.m_opticalZoomMouseInputsEnabled&&(this.m_container.removeEventListener("wheel",this.m_boundOnWheel),this.m_hammerManager.off("panstart panmove panend",this.m_boundOnMousePanEvent),this.m_opticalZoomMouseInputsEnabled=!1,s.a.sendTraceTag(506857228,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: disableOpticalZoomMouseInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableOpticalZoomKeyboardInputs(){this.m_opticalZoomKeyboardInputsEnabled||(this.m_container.addEventListener("keydown",this.m_boundOnKeyDownForOpticalZoom),this.m_opticalZoomKeyboardInputsEnabled=!0,s.a.sendTraceTag(506857227,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: enableOpticalZoomKeyboardInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableOpticalZoomKeyboardInputs(){this.m_opticalZoomKeyboardInputsEnabled&&(this.m_container.removeEventListener("keydown",this.m_boundOnKeyDownForOpticalZoom),this.m_opticalZoomKeyboardInputsEnabled=!1,s.a.sendTraceTag(506857226,o.a.msoulscat_Wac_PptLive,l.a.Info,`InputsAddon: disableOpticalZoomKeyboardInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}async onSwipeEventAsync(e){if(!(c.a.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>c.a.readNumberOrDefault("minimumZoom",1)||r.ChangeGate.isChangeGateEnabled("SlideShowCore.skipSwipeFromNonSlideContainer")&&e.target!==this.m_container)){if(this.m_inputLoggingCallback&&this.m_inputLoggingCallback(""),r.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")&&this.m_onBeforeNavigateAsync&&(!this.m_onBeforeNavigateAsync||!await this.m_onBeforeNavigateAsync("")))return;"swipeleft"===e.type?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",n.j.Touch)):"swiperight"===e.type&&(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",n.j.Touch)),this.m_preventClickEvent=!0,window.setTimeout(()=>{this.m_preventClickEvent=!1},0)}}onMousePan(e){if("mouse"===e.pointerType&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>c.a.readNumberOrDefault("minimumZoom",1)){if("panstart"===e.type&&(this.m_lastPosition=d.k.Zero,c.a.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&(this.m_container.style.cursor="-moz-grabbing",this.m_container.style.cursor="-webkit-grabbing",this.m_container.style.cursor="grabbing"),c.a.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent))try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){s.a.sendTraceTag(506857225,o.a.msoulscat_Wac_PptLive,l.a.Info,"InputsAddon::onMousePan - Could not capture pointer: "+e)}"panend"===e.type&&c.a.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&(this.m_container.style.cursor="-moz-grab",this.m_container.style.cursor="-webkit-grab",this.m_container.style.cursor="grab"),this.m_slideshowCore.panByAmount(new d.k(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:n.d.Mouse}),this.m_lastPosition=new d.k(e.deltaX,e.deltaY),this.m_preventClickEvent=!0,window.setTimeout(()=>this.m_preventClickEvent=!1)}}onTouchPan(e){if("mouse"!==e.pointerType&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>c.a.readNumberOrDefault("minimumZoom",1)){if("panstart"===e.type){if(this.m_lastPosition=new d.k(e.deltaX,e.deltaY),c.a.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent)try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){s.a.sendTraceTag(506857224,o.a.msoulscat_Wac_PptLive,l.a.Info,"InputsAddon::onTouchPan - Could not capture pointer: "+e)}return}this.m_slideshowCore.panByAmount(new d.k(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:n.d.Touch}),this.m_lastPosition=new d.k(e.deltaX,e.deltaY)}}onPinch(e){if("pinchstart"!==e.type){if(c.a.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent&&!this.m_container.hasPointerCapture(e.srcEvent.pointerId))try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){s.a.sendTraceTag(506857222,o.a.msoulscat_Wac_PptLive,l.a.Info,"InputsAddon::onPinch - Could not capture pointer: "+e)}this.m_slideshowCore.zoomToAsync(this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel*e.scale/this.m_lastScaling,new d.k(e.center.x,e.center.y),{source:n.d.Pinch}),this.m_slideshowCore.panByAmount(new d.k(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:n.d.Pinch}),this.m_lastPosition=new d.k(e.deltaX,e.deltaY),this.m_lastScaling=e.scale}else if(this.m_lastScaling=e.scale,this.m_lastPosition=new d.k(e.deltaX,e.deltaY),c.a.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent)try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){s.a.sendTraceTag(506857223,o.a.msoulscat_Wac_PptLive,l.a.Info,"InputsAddon::onPinch - Could not capture pointer: "+e)}}async onClickAsync(e){if(e.target===this.m_container&&!this.m_preventClickEvent){if(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),r.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")&&this.m_onBeforeNavigateAsync&&(!this.m_onBeforeNavigateAsync||!await this.m_onBeforeNavigateAsync("")))return;this.m_slideshowCore.nextStep("0_anim",n.j.Mouse)}}onWheel(e){if(e.preventDefault(),e.ctrlKey||e.metaKey){const t=.001,i=this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel*(e.deltaY<0?1-t*e.deltaY:1/(1+t*e.deltaY));this.m_slideshowCore.zoomToAsync(i,new d.k(e.clientX,e.clientY),{source:n.d.CtrlWheel})}else this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>c.a.readNumberOrDefault("minimumZoom",1)&&this.m_slideshowCore.panByAmount(new d.k(-e.deltaX,-e.deltaY),{source:n.d.Scroll})}onKeyDownForOpticalZoom(e){switch(e.key){case"Escape":this.m_slideshowCore.zoomToAsync(c.a.readNumberOrDefault("minimumZoom",1),void 0,{fAnimate:!0,source:n.d.KeyboardEscape});break;case"=":case"+":this.m_slideshowCore.zoomToAsync(1.15*this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,void 0,{source:n.d.KeyboardPlus});break;case"_":case"-":this.m_slideshowCore.zoomToAsync(1/1.15*this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,void 0,{source:n.d.KeyboardMinus})}switch(e.key){case"ArrowUp":return void this.m_slideshowCore.panByAmount(new d.k(0,10),{source:n.d.KeyboardArrowUp});case"ArrowDown":return void this.m_slideshowCore.panByAmount(new d.k(0,-10),{source:n.d.KeyboardArrowDown});case"ArrowLeft":return void this.m_slideshowCore.panByAmount(new d.k(10,0),{source:n.d.KeyboardArrowLeft});case"ArrowRight":return void this.m_slideshowCore.panByAmount(new d.k(-10,0),{source:n.d.KeyboardArrowRight})}}async onKeyDownAsync(e){if(e.isComposing||229===e.keyCode)this.events.emit("keydown",e);else{if(r.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")&&this.m_onBeforeNavigateAsync&&(!this.m_onBeforeNavigateAsync||!await this.m_onBeforeNavigateAsync("")))return;if("n"===e.key.toLowerCase()?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",n.j.Keyboard)):"p"===e.key.toLowerCase()&&(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",n.j.Keyboard)),this.m_container!==document.querySelector("#slideshow-app-thumbnail-strip")){if(this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>c.a.readNumberOrDefault("minimumZoom",1))return;switch(e.key){case"PageDown":case" ":case"Enter":case"ArrowDown":this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",n.j.Keyboard);break;case"PageUp":case"Backspace":case"ArrowUp":this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",n.j.Keyboard);break;case"ArrowLeft":case"ArrowRight":"ArrowRight"===e.key&&!this.m_isRtl||"ArrowLeft"===e.key&&this.m_isRtl?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",n.j.Keyboard)):(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",n.j.Keyboard));break;default:this.events.emit("keydown",e)}}}}constructor(e,t,i,n,s){this.events=new a.EventEmitter,this.m_preventClickEvent=!1,this.m_lastScaling=0,this.m_lastPosition=d.k.Zero,this.m_touchInputEnabled=!1,this.m_mouseInputEnabled=!1,this.m_opticalZoomTouchInputsEnabled=!1,this.m_opticalZoomMouseInputsEnabled=!1,this.m_opticalZoomKeyboardInputsEnabled=!1,this.m_slideshowCore=e,this.m_isRtl=i,this.m_container=t,this.m_hammerManager=new h.Manager(t),c.a.readBooleanOrDefault("enableOpticalZoom",!1)?(this.m_hammerManager.add(new h.Pan),this.m_hammerManager.add((new h.Swipe).recognizeWith(this.m_hammerManager.get("pan"))),this.m_hammerManager.add((new h.Pinch).recognizeWith(this.m_hammerManager.get("pan")))):this.m_hammerManager.add(new h.Swipe),this.m_boundOnClick=this.onClickAsync.bind(this),this.m_boundOnWheel=this.onWheel.bind(this),this.m_boundOnKeyDown=this.onKeyDownAsync.bind(this),this.m_boundOnKeyDownForOpticalZoom=this.onKeyDownForOpticalZoom.bind(this),this.m_boundOnSwipeEvent=this.onSwipeEventAsync.bind(this),this.m_boundOnMousePanEvent=this.onMousePan.bind(this),this.m_boundOnTouchPanEvent=this.onTouchPan.bind(this),this.m_boundOnPinchEvent=this.onPinch.bind(this),this.enableMouseInput(),this.enableKeyboardInput(),this.enableTouchInput(),this.m_inputLoggingCallback=n,this.m_onBeforeNavigateAsync=r.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")?s&&s.onBeforeNavigateAsync:void 0}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(81),r=i(9);class a{logFrameData(e){const t={...e.metadata,sharingLayoutMode:this.m_sharingLayoutMode||"undefined"};this.m_animatedContentLogger.logFrameData(e.isAnimating,{metadata:t})}constructor(e,t,i,a){this.m_sharingLayoutMode=void 0,r.a.setLogger(i),this.m_animatedContentLogger=new n.a({type:"Animation"}),e.events.on("animationStateChanging",this.logFrameData.bind(this)),a&&(a.appEvents&&a.appEvents.on("sharingLayoutModeChanged",e=>{this.m_sharingLayoutMode=e}),a.sharingLayoutMode&&(this.m_sharingLayoutMode=a.sharingLayoutMode))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(81),r=i(9);class a{logFrameData(e){const t={...e.metadata,sharingLayoutMode:this.m_sharingLayoutMode||"undefined"};this.m_transitionContentLogger.logFrameData(e.isTransitioning,{metadata:t})}constructor(e,t,i,a){this.m_sharingLayoutMode=void 0,r.a.setLogger(i),this.m_transitionContentLogger=new n.a({type:"Transition"}),e.events.on("slideLocationChanging",this.logFrameData.bind(this)),a&&(a.appEvents&&a.appEvents.on("sharingLayoutModeChanged",e=>{this.m_sharingLayoutMode=e}),a.sharingLayoutMode&&(this.m_sharingLayoutMode=a.sharingLayoutMode))}}},,function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n,r=i(1),a=i(9),s=i(3),o=i(7),l=i(4);!function(e){e.Init="init",e.WebGLContextRestored="webglcontextrestored",e.PrefetchOnRefreshPodSession="prefetchOnRefreshPodSession",e.OnSlideLocationChanged="onSlideLocationChanged"}(n||(n={}));class d{enablePrefetch(){this.m_isPrefetchEnabled=!0}disablePrefetch(){this.m_isPrefetchEnabled=!1}onSlideLocationChanged(e){this.m_isPrefetchEnabled&&(this.m_isPrefetching=!1,this.m_slidesToPrefetch=[],this.m_symbol=Symbol("Cancel"),this.prefetchSlides(this.m_symbol,n.OnSlideLocationChanged))}async getPrefetchAndPrerenderWindow(e,t,i){const n=[],r=[],a=async(e,t,i,a,s)=>{for(;i>=0&&e>0&&a>0;i+=s,a--)(await this.m_slideshowCore.isHidden(i)).isHidden||(n.push({slideIndex:i}),e--,t>0&&(r.push({slideIndex:i}),t--))};return await a(t,this.m_forwardPrerenderCount,e+1,this.m_slideshowCore.getSlideCount()-e-1,1),await a(i,this.m_backwardPrerenderCount,e-1,e,-1),{slidesToPrefetch:n,slidesToPrerender:r}}async prefetchSlides(e,t,i,d,c){this.m_slideshowCore.setMaxSceneCount(this.m_forwardPrerenderCount,this.m_backwardPrerenderCount);const h=i||this.m_slideshowCore.getSlideLocation();if(!h)return void a.a.sendTraceTag(506856865,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"PrefetchAddon: undefined slide location in prefetchSlide.");const u=h.slideIndex;if(a.a.sendTraceTag(506856864,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"PrefetchAddon::prefetchSlides - currentSlideIndex:"+u),-1===u)return;let m=d;l.ChangeGate.isChangeGateEnabled("SSPassPrefetchCountAsParam")&&null!=m||(m=l.ChangeGate.isChangeGateEnabled("PrefetchOnInitSlideAddition")&&t===n.Init?r.a.readNumberOrDefault("SSPrefetchOnInitForwardCount",this.m_forwardPrefetchCount):this.m_forwardPrefetchCount);let f=c;if(l.ChangeGate.isChangeGateEnabled("SSPassPrefetchCountAsParam")&&null!=f||(f=this.m_backwardPrefetchCount),r.a.readBooleanOrDefault("prefetchPrerenderWindowFix",!1)&&r.a.readBooleanOrDefault("useHiddenListFromPresInfo",!1)){const e=await this.getPrefetchAndPrerenderWindow(u,m,f);this.m_slidesToPrefetch=e.slidesToPrefetch,this.m_slidesToPrerender=e.slidesToPrerender}else{for(let e=1;e<=m;e+=1)this.m_slidesToPrefetch.push({slideIndex:u+e});for(let e=1;e<=f;e+=1)u-e>=0&&this.m_slidesToPrefetch.push({slideIndex:u-e})}if(this.m_slideshowCore.prefetchWindowRange&&(this.m_slideshowCore.prefetchWindowRange.last=u+this.m_forwardPrerenderCount,this.m_slideshowCore.prefetchWindowRange.first=Math.max(u-this.m_backwardPrerenderCount,0)),this.m_isPrefetching)return void a.a.sendTraceTag(506856863,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"PrefetchAddon::prefetchSlides - return as already prefetch in progress. Current queue size :"+this.m_slidesToPrefetch.length);this.m_isPrefetching=!0;const p={source:t};for(;this.m_slidesToPrefetch.length>0&&e===this.m_symbol;){let e=!1;if(r.a.readBooleanOrDefault("prefetchPrerenderWindowFix",!1)&&r.a.readBooleanOrDefault("useHiddenListFromPresInfo",!1)){const t=this.m_slidesToPrefetch[0].slideIndex;void 0!==t&&this.m_slidesToPrerender.some(e=>e.slideIndex===t)&&(e=!0)}else void 0!==this.m_slidesToPrefetch[0].slideIndex&&this.shouldPrerenderSlide(this.m_slidesToPrefetch[0].slideIndex,u)&&(e=!0);await this.m_slideshowCore.prefetchSlide(this.m_slidesToPrefetch[0],e,p),this.m_slidesToPrefetch.shift()}this.m_isPrefetching=!1}shouldPrerenderSlide(e,t){return e>t&&e-t<=this.m_forwardPrerenderCount||e<t&&t-e<=this.m_backwardPrerenderCount}constructor(e,t,i){if(this.m_isPrefetching=!1,this.m_slidesToPrefetch=[],this.m_slidesToPrerender=[],this.m_forwardPrefetchCount=5,this.m_backwardPrefetchCount=5,this.m_forwardPrerenderCount=2,this.m_backwardPrerenderCount=2,this.m_symbol=Symbol("Init"),this.m_isPrefetchEnabled=!0,a.a.setLogger(t),this.m_slideshowCore=e,i&&(this.m_forwardPrefetchCount=i.forwardPrefechCount?i.forwardPrefechCount:this.m_forwardPrefetchCount,this.m_backwardPrefetchCount=i.backwardPrefechCount?i.backwardPrefechCount:this.m_backwardPrefetchCount,r.a.readBooleanOrDefault("prerenderWindowChange",!1)?(this.m_forwardPrerenderCount=r.a.readNumberOrDefault("forwardPrerenderCount",this.m_forwardPrerenderCount),this.m_backwardPrerenderCount=r.a.readNumberOrDefault("backwardPrerenderCount",this.m_backwardPrerenderCount)):(this.m_forwardPrerenderCount=i.forwardPrerenderCount?i.forwardPrerenderCount:this.m_forwardPrerenderCount,this.m_backwardPrerenderCount=i.backwardPrerenderCount?i.backwardPrerenderCount:this.m_backwardPrerenderCount)),r.a.readBooleanOrDefault("enablePrefetchOnInit",!1)?e.events.on("prefetchOnInit",e=>this.prefetchSlides(this.m_symbol,n.Init,e)):e.events.on("prefetchOnInit",()=>this.prefetchSlides(this.m_symbol,n.Init)),r.a.readBooleanOrDefault("enablePrefetchOnRefreshPodSession",!1)){const t=r.a.readNumberOrDefault("SSPrefetchOnRehydrateForwardCount",this.m_forwardPrefetchCount),i=r.a.readNumberOrDefault("SSPrefetchOnRehydrateBackwardCount",this.m_backwardPrefetchCount);e.events.on("prefetchOnRefreshPodSession",e=>this.prefetchSlides(this.m_symbol,n.PrefetchOnRefreshPodSession,e,t,i))}e.events.on("slideLocationChanged",()=>this.onSlideLocationChanged()),e.events.on("webglcontextrestored",()=>this.prefetchSlides(this.m_symbol,n.WebGLContextRestored))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(8),r=i(9),a=i(3),s=i(7);class o{async onSlideLocationChanged(e){if(this.m_prevSlideLocation=this.m_currentSlideLocation,this.m_currentSlideLocation=this.m_slideshowCore.getSlideLocation(),!this.m_currentSlideLocation)return void r.a.sendTraceTag(506856984,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,"SlideAdvanceAddon: undefined slide location in onSlideLocationChanged.");if(this.cancelPendingAutoAdvance(),this.cancelPendingClickTimes(),this.m_prevSlideLocation&&this.m_currentSlideLocation.slideIndex<this.m_prevSlideLocation.slideIndex&&e.actionContext&&e.actionContext.navigationType!==n.c.GoTo&&e.actionContext.navigationType!==n.c.ClickTarget)return;const t=await this.m_slideshowCore.getSlideShowTimings(this.m_currentSlideLocation);if(t&&t.autoAdv){const e=1e3*t.autoAdvTime;this.scheduleAutoAdvance(e),t.clickTimes&&this.scheduleClickTimes(t.clickTimes)}}scheduleAutoAdvance(e){this.cancelPendingAutoAdvance(),this.m_autoAdvanceEvent=window.setTimeout(this.onAutoAdvanceTimer.bind(this),e)}scheduleClickTimes(e){this.cancelPendingClickTimes();let t=0;for(let i=0;i<e.length;i+=1)t+=e[i],this.m_clickTimeEvents[i]=window.setTimeout(this.onClickTimer.bind(this),t)}cancelPendingAutoAdvance(){this.m_autoAdvanceEvent!==this.c_noEventScheduled&&(window.clearTimeout(this.m_autoAdvanceEvent),this.m_autoAdvanceEvent=this.c_noEventScheduled)}cancelPendingClickTimes(){for(let e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]!==this.c_noEventScheduled&&(window.clearTimeout(this.m_clickTimeEvents[e]),this.m_clickTimeEvents[e]=this.c_noEventScheduled)}onAutoAdvanceTimer(){r.a.sendTraceTag(506856983,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideAdvanceAddon:onAutoAdvanceTimer Calling nextSlide from "+JSON.stringify(this.m_currentSlideLocation)),this.m_slideLocationsAutoAdvanced.push(this.m_currentSlideLocation),this.m_slideshowCore.nextSlide(!1)}onClickTimer(){this.m_slideshowCore.nextStep("0_anim",n.j.AutoAdvance)}constructor(e,t){this.c_noEventScheduled=-1,this.m_clickTimeEvents=[],this.m_slideLocationsAutoAdvanced=[],r.a.setLogger(t),this.m_slideshowCore=e,this.m_autoAdvanceEvent=this.c_noEventScheduled;for(let e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]=this.c_noEventScheduled;this.m_slideshowCore.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),this.m_slideshowCore.events.on("exitFromEndOfShow",()=>{r.a.sendTraceTag(506856985,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,"SlideAdvanceAddon:onAutoAdvanceTimer SlideLocations that used AutoAdvance:"+JSON.stringify(this.m_slideLocationsAutoAdvanced)),this.m_slideLocationsAutoAdvanced=[],this.m_autoAdvanceEvent=this.c_noEventScheduled;for(let e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]=this.c_noEventScheduled;this.m_prevSlideLocation=void 0,this.m_currentSlideLocation=void 0}),this.m_slideshowCore.events.on("stopAutoAdvance",()=>{this.cancelPendingAutoAdvance(),this.cancelPendingClickTimes()})}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(72),r=i(9),a=i(3),s=i(7),o=i(134);class l{onInkManagerActivity(e){switch(e.item){case"Init":this.inkAddonCore.m_inkCanvas||(this.inkAddonCore.metricHelper.boot(n.a.Menu),this.startDownloadingInkJs(this.inkAddonCore.onDownloadCompleted),r.a.sendTraceTag(506857118,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: Ink initialization triggered by ink button."));break;case"Pen":this.selectPen(e.color);break;case"Highlighter":this.selectHighlighter(e.color);break;case"Eraser":this.inkAddonCore.selectEraser();break;case"None":this.inkAddonCore.selectNone();break;case"EraseAll":this.inkAddonCore.eraseAll();break;case"SetColor":this.setColor(e.color);break;case"Laser":this.selectLaser()}}setColor(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.setColor(e),r.a.sendTraceTag(506857117,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: setColor called with color: "+e))}selectPen(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setColor(e),this.inkAddonCore.m_inkCanvas.selectPen(),r.a.sendTraceTag(506857116,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: selectPen called with color: "+e))}selectHighlighter(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setColor(e),this.inkAddonCore.m_inkCanvas.selectHighlighter(),r.a.sendTraceTag(506857115,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: selectHighlighter called with color: "+e))}selectLaser(e=this.m_defaultLaserColor){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setLaserColor(e),this.inkAddonCore.m_inkCanvas.selectLaser(),r.a.sendTraceTag(506857114,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: selectLaser called"))}startDownloadingInkJs(e){if(null!=window.slideshowink)return r.a.sendTraceTag(506857113,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: slideshowink.js is loaded to the window, no download needed."),this.inkAddonCore.updateDimensions(),void this.initInk();this.inkAddonCore.isInkJsDownloading||(r.a.sendTraceTag(506857112,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: Start downloading slideshowink.js"),this.inkAddonCore.isInkJsDownloading=!0,this.inkAddonCore.loadInkJsCallback().then(()=>{e()}).catch(e=>{this.inkAddonCore.onDownloadFailed(e)}))}resetInkCanvas(){return this.inkAddonCore.resetInkCanvas()}initInk(){if(this.inkAddonCore.m_inkCanvas)return;try{slideshowink.inkCanvasFactoryGlobal.setLogger(new n.b),this.telemetryLogger&&slideshowink.inkCanvasFactoryGlobal.setActivityLogger(new o.a({telemetryLogger:this.telemetryLogger}));const e=slideshowink.inkCanvasFactoryGlobal.createSlideShowInkCanvasSmoothed(this.inkAddonCore.inkContainer,this.inkAddonCore.parent);this.inkAddonCore.isShowingBlankSlide||e.start(),this.inkAddonCore.m_inkCanvas=e}catch(e){r.a.sendTraceTag(506857111,a.a.msoulscat_Wac_PptSlideshow,s.a.Error,"SlideShowInkAddon: inkCanvas initialization error: "+JSON.stringify(e))}r.a.sendTraceTag(506857110,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: inkCanvas initialized."),this.inkAddonCore.registerAppEventListeners();const e=this.inkAddonCore.slideshowCore.getSlideLocation();e&&this.slideChanged(e),this.inkAddonCore.updateInkCanvasDimensions(),window.removeEventListener("pointerdown",this.inkAddonCore.onPointerDown),r.a.sendTraceTag(506857109,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`SlideShowInkAddon: inkCanvas initialization from: ${this.inkAddonCore.metricHelper.getSource().toString()} in time: ${this.inkAddonCore.metricHelper.timeDiff()} with lost stroke count: ${this.inkAddonCore.metricHelper.getLostStrokeCount()}`)}slideChanged(e){this.inkAddonCore.m_inkCanvas&&this.inkAddonCore.m_inkCanvas.slideChanged(e.slideIndex)}constructor(e,t,i,o,l){this.m_defaultLaserColor="#E3182D",this.inkAddonCore=new n.c(e,t,i,o,this.initInk.bind(this),this.slideChanged.bind(this),()=>!0);const d=e=>{"pen"===e.pointerType&&(window.removeEventListener("pointerover",d),this.inkAddonCore.m_inkCanvas||(this.inkAddonCore.metricHelper.boot(n.a.Pen),this.startDownloadingInkJs(this.inkAddonCore.onDownloadCompleted),r.a.sendTraceTag(506857119,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,"SlideShowInkAddon: Ink initialization triggered by pointerover.")))};l&&l.telemetryLogger&&(this.telemetryLogger=l.telemetryLogger),window.addEventListener("pointerover",d)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i(9),r=i(3),a=i(7),s=i(155),o=i(8),l=i(56),d=i(23),c=i(154),h=i(64),u=i(1);class m{getGlobalState(){return this.m_globalState}localStateChanged(e){const t=this.m_slideshowCore.getSlideLocation(),i=this.m_slideshowCore.getAnimationState(!0);if(!t)return void n.a.sendTraceTag(506857168,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PrivateViewingAddon - No slideLocation was returned from getSlideLocation but recieved event slideLocationChanged");i||n.a.sendTraceTag(506857167,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PrivateViewingAddon - No animationState was returned from getAnimationState but recieved event animationStateChanged");const s=h.a.toSyncState(t,i);this.m_slideshowRole===o.i.Presenter?this.m_globalState=s:(this.m_privateViewingEnabled||this.m_slideshowRole===o.i.PrivateViewing)&&(this.m_localState&&"slideLocationChanged"===e&&t.slideIndex===h.a.syncStateToSlideLocation(this.m_localState).slideIndex?n.a.sendTraceTag(506857166,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`PrivateViewingAddon - slideLocationChanged event fired even when slideIndex not changed; slideIndex: ${t.slideIndex};`):this.m_privateViewingManager.localStateChanged(s,e)),this.m_localState=s,this.saveLocalStateToAppStateManager()}returnToPresenter(){if(this.m_localState){if(l.a.trackTeamsPVMetrics({action:"returnToPresenter",slideIndex:h.a.syncStateToSlideLocation(this.m_globalState).slideIndex},this.m_clockSkewCalculator.sessionUTC),u.a.readBooleanOrDefault("allowUserToPrivatelyZoom",!1)&&!this.isInPrivateViewing()&&this.m_isUserPrivatelyZooming)return;this.m_privateViewingManager.returnToPresenter(this.m_localState)}else n.a.sendTraceTag(506857165,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"PrivateViewingAddon - returnToPresenter called with undefined m_localState.")}onPrivateViewingToggled(e){this.m_privateViewingEnabled!==e?(this.m_privateViewingEnabled=e,n.a.sendTraceTag(506857163,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"PrivateViewingAddon - private viewing toggled to "+(e?"enabled":"disabled")),e||this.m_slideshowRole!==o.i.PrivateViewing||this.returnToPresenter()):n.a.sendTraceTag(506857164,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"PrivateViewingAddon - private viewing toggle value did not change. It is still "+(e?"enabled":"disabled"))}async goToSyncState(e){if(this.m_slideshowRole===o.i.Presenter)return void n.a.sendTraceTag(506857162,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`PrivateViewingAddon - gotoSyncState was called by a presenter. SyncState = ${JSON.stringify(e)}.`);const t=h.a.syncStateToSlideLocation(e),i={animationState:h.a.syncStateToAnimationState(e),fForceRetry:!0},s=await this.m_slideshowCore.gotoSlide(t,i);s&&s.fSucceeded?(this.m_localState=e,this.syncMediaStates(t.slideId,t.slideIndex),n.a.sendTraceTag(506857161,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`PrivateViewingAddon - gotoSlide succeeded. SyncState = ${JSON.stringify(e)}.`)):n.a.sendTraceTag(506857160,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,`PrivateViewingAddon - gotoSlide failed with error ${s.error}. SyncState = ${JSON.stringify(e)}.`)}hadPreviousUserInput(e){let t=!0;return"slideLocationChanged"!==e&&"animationStateChanged"!==e||(t=l.a.hadPreviousUserInput(this.m_clockSkewCalculator.sessionUTC),n.a.sendTraceTag(506857159,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,`PrivateViewingAddon - hadPreviousUserInput: ${t}.`)),t}isInPrivateViewing(){return this.m_slideshowRole===o.i.PrivateViewing}isPresenting(){return this.m_slideshowRole===o.i.Presenter}isInPrivateViewingChanged(e,t){let i=!1;const s=this.m_slideshowRole;if(this.m_slideshowRole===o.i.Attendee&&t)this.m_slideShowAppEvents.emit("roleChanged",o.i.PrivateViewing),this.m_slideShowAppEvents.emit("roleChangedOutbound",o.i.PrivateViewing),i=!0,l.a.trackTeamsPVMetrics({action:"enterPrivateViewing",source:e},this.m_clockSkewCalculator.sessionUTC);else if(this.m_slideshowRole===o.i.PrivateViewing&&!t){this.m_slideShowAppEvents.emit("roleChanged",o.i.Attendee),this.m_slideShowAppEvents.emit("roleChangedOutbound",o.i.Attendee);const e=this.m_slideshowCore.getSlideLocation();e&&e.slideId&&this.syncMediaStates(e.slideId,e.slideIndex),i=!0,l.a.trackTeamsPVMetrics({action:"leavePrivateViewing"},this.m_clockSkewCalculator.sessionUTC)}n.a.sendTraceTag(506857158,r.a.msoulscat_Wac_PptSlideshow,i?a.a.Info:a.a.Error,`PrivateViewingAddon - privateViewingChangedTo: ${t?"true":"false"}. Successful: ${i?"true":"false"}. Role before was: ${s}. Source: ${e}`)}syncMediaStates(e,t){this.m_slideShowAppEvents.emit("returnToPresenterUpdateAllMedia",{slideId:e,slideIndex:t})}registerSlideShowUIEvents(){this.m_slideShowUIEvents&&(this.m_slideShowUIEvents.on("setPrivateViewingToggle",e=>{this.onPrivateViewingToggled(e)}),this.m_slideShowUIEvents.on("privateViewingToggled",e=>{this.onPrivateViewingToggled(e)}),this.m_slideShowUIEvents.on("roleChanged",e=>{e===o.i.Presenter&&(this.m_privateViewingManager.resetPrivateViewingManager(),this.m_slideshowRole===o.i.PrivateViewing&&l.a.trackTeamsPVMetrics({action:"leavePrivateViewing"},this.m_clockSkewCalculator.sessionUTC)),this.m_slideshowRole=e,this.saveLocalStateToAppStateManager()}))}saveLocalStateToAppStateManager(){if(this.m_localState){const e={role:this.m_slideshowRole,currentSyncState:h.a.syncStateToSlideLocation(this.m_localState),currentAnimationState:h.a.syncStateToAnimationState(this.m_localState),globalSyncState:h.a.syncStateToSlideLocation(this.m_globalState),globalAnimationState:h.a.syncStateToAnimationState(this.m_globalState)};this.m_globalAppStateManager&&this.m_globalAppStateManager.updateGlobalState(c.a.PrivateViewingAddon,e)}}set slideShowUIEvents(e){e&&(this.m_slideShowUIEvents=e,this.registerSlideShowUIEvents())}get slideShowUIEvents(){return this.m_slideShowUIEvents}constructor(e,t,i,l,c,u,m,f,p,g,_){this.m_privateViewingEnabled=!1,this.m_isUserPrivatelyZooming=!1,n.a.setLogger(l),this.m_slideshowCore=e,this.m_slideShowAppEvents=t,this.m_slideshowRole=i,this.m_slideShowUIEvents=p,this.m_globalAppStateManager=g,u&&f||n.a.sendTraceTag(506857171,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"PrivateViewingAddon - No initial slide location given"),this.m_localState=h.a.toSyncState({slideId:m,slideIndex:f},u),this.m_globalState=_||this.m_localState;const S={goToSyncState:this.goToSyncState.bind(this),isInPrivateViewingChanged:this.isInPrivateViewingChanged.bind(this,d.b.SyncStateManager),isInPrivateViewing:this.isInPrivateViewing.bind(this),hadPreviousUserInput:this.hadPreviousUserInput.bind(this),getGlobalState:this.getGlobalState.bind(this),areSyncStatesEqual:h.a.areSyncStatesEqual.bind(this)};this.m_clockSkewCalculator=c,this.m_privateViewingManager=new s.b,this.m_privateViewingManager.init({loggableFeatureName:"PPT_SSApp"},S,l),this.registerSlideShowUIEvents(),this.m_slideShowAppEvents.on("slideLocationChanged",()=>{this.localStateChanged("slideLocationChanged")}),this.m_slideShowAppEvents.on("animationStateChanged",()=>{this.localStateChanged("animationStateChanged")}),this.m_slideShowAppEvents.on("requestPrivateViewingChanged",e=>{this.m_privateViewingEnabled&&this.isInPrivateViewingChanged(e.source,e.isInPrivateViewing)}),this.m_slideShowAppEvents.on("globalStateChanged",async e=>{if(e){if(this.m_slideshowRole!==o.i.Presenter){const t=e[0],i=2===e.length?e[1]:void 0,s=h.a.toSyncState(t,i);this.m_globalState=s,this.m_privateViewingEnabled?(await this.m_privateViewingManager.globalStateChanged(this.m_globalState),this.m_slideShowUIEvents&&t.slideIndex&&this.m_slideShowUIEvents.emit("presenterSlideStateChanged",t.slideIndex)):n.a.sendTraceTag(506857169,r.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PrivateViewingAddon - private viewing is not enabled")}}else n.a.sendTraceTag(506857170,r.a.msoulscat_Wac_PptSlideshow,a.a.Error,"PrivateViewingAddon - globalStateChanged called but wasn't passed in any args")}),this.m_slideShowAppEvents.on("returnToPresenter",()=>{this.returnToPresenter()}),this.m_slideShowAppEvents.on("isUserPrivatelyZooming",e=>{this.m_isUserPrivatelyZooming=e})}}},function(e,t,i){"use strict";var n,r,a;i.d(t,"a",(function(){return w})),function(e){e[e.iframe=0]="iframe",e[e.webView=1]="webView"}(n||(n={})),function(e){e[e.Handshake=0]="Handshake",e[e.GetSlidesInShowCount=1]="GetSlidesInShowCount",e[e.GetCurrentPosition=3]="GetCurrentPosition",e[e.OnPositionChanged=5]="OnPositionChanged",e[e.MediaEvent=8]="MediaEvent",e[e.OnError=10]="OnError",e[e.OnNetworkHealthChanged=15]="OnNetworkHealthChanged",e[e.OnBrowserEvent=18]="OnBrowserEvent",e[e.OnExitSlideshow=23]="OnExitSlideshow",e[e.AppReadyForPostMessage=28]="AppReadyForPostMessage",e[e.PostAppErrorUpwardsForTelemetry=41]="PostAppErrorUpwardsForTelemetry",e[e.ReturnToPresenter=25]="ReturnToPresenter",e[e.TogglePrivateViewing=47]="TogglePrivateViewing",e[e.OnSlideViewBoundsChanged=48]="OnSlideViewBoundsChanged",e[e.AadTokenRequest=49]="AadTokenRequest",e[e.StartCoach=50]="StartCoach",e[e.StopCoach=51]="StopCoach",e[e.CheckCoachStatus=52]="CheckCoachStatus",e[e.AnnotationEvent=53]="AnnotationEvent",e[e.BlankSlideState=54]="BlankSlideState",e[e.ShowWeatherPerson=55]="ShowWeatherPerson",e[e.BootStageChanged=56]="BootStageChanged",e[e.RoleChangedOutbound=57]="RoleChangedOutbound",e[e.PasteFileLinktoChat=60]="PasteFileLinktoChat",e[e.CopyFileLinktoClipboard=61]="CopyFileLinktoClipboard",e[e.InitMediaSyncEvent=63]="InitMediaSyncEvent",e[e.CameoDetectedInPresentation=66]="CameoDetectedInPresentation",e[e.CameoFrameRequestForSlide=67]="CameoFrameRequestForSlide",e[e.RenderingModeChangedToSVG=68]="RenderingModeChangedToSVG",e[e.FrameTrustCheck=69]="FrameTrustCheck",e[e.AddinEventOutbound=70]="AddinEventOutbound",e[e.InitAddinSyncEvent=71]="InitAddinSyncEvent",e[e.TakeControl=72]="TakeControl",e[e.MediaDetectedInPresentation=73]="MediaDetectedInPresentation",e[e.OpticalZoomStateChanged=74]="OpticalZoomStateChanged",e[e.CameraStateChanged=76]="CameraStateChanged",e[e.SubtitlesStateChanged=78]="SubtitlesStateChanged"}(r||(r={})),function(e){e[e.Handshake=0]="Handshake",e[e.GetSlidesInShowCount=1]="GetSlidesInShowCount",e[e.GetCurrentPosition=3]="GetCurrentPosition",e[e.NextStep=5]="NextStep",e[e.PrevStep=7]="PrevStep",e[e.NextSlide=6]="NextSlide",e[e.PrevSlide=8]="PrevSlide",e[e.GoToSlide=9]="GoToSlide",e[e.GoToSlideId_DEPRECATED=10]="GoToSlideId_DEPRECATED",e[e.PlayMedia=15]="PlayMedia",e[e.PauseMedia=16]="PauseMedia",e[e.StopMedia=17]="StopMedia",e[e.SeekMedia=18]="SeekMedia",e[e.GotoNextSlide=24]="GotoNextSlide",e[e.GotoPrevSlide=25]="GotoPrevSlide",e[e.BootTimingFromApi=26]="BootTimingFromApi",e[e.RestoreFocus=28]="RestoreFocus",e[e.ExitSlideShow=29]="ExitSlideShow",e[e.SetNavigationOptions=31]="SetNavigationOptions",e[e.SwitchRole=34]="SwitchRole",e[e.RecordMetrics=36]="RecordMetrics",e[e.ChangeTheme=37]="ChangeTheme",e[e.SetInkingActivity=38]="SetInkingActivity",e[e.PPTSharingLayoutChanged=46]="PPTSharingLayoutChanged",e[e.SetPrivateViewingToggle=47]="SetPrivateViewingToggle",e[e.SendPresenterStateDuringPrivateViewing=48]="SendPresenterStateDuringPrivateViewing",e[e.SetAadToken=49]="SetAadToken",e[e.UpdateMeetingCoachStatus=50]="UpdateMeetingCoachStatus",e[e.AnnotationEvent=53]="AnnotationEvent",e[e.BlankSlideState=54]="BlankSlideState",e[e.VolumeMedia=55]="VolumeMedia",e[e.MediaEvent=59]="MediaEvent",e[e.ReturnToPresenterInbound=60]="ReturnToPresenterInbound",e[e.CustomBackgroundForAPL=61]="CustomBackgroundForAPL",e[e.SetGlobalMute=62]="SetGlobalMute",e[e.LaserPointerActivation=63]="LaserPointerActivation",e[e.UpdateBufferInfoForCameo=64]="UpdateBufferInfoForCameo",e[e.SetFrameTrustStatus=65]="SetFrameTrustStatus",e[e.HideCameo=66]="HideCameo",e[e.AddinEventInbound=72]="AddinEventInbound",e[e.OpticalZoomStateChanged=74]="OpticalZoomStateChanged",e[e.UpdatePresenterName=75]="UpdatePresenterName",e[e.CameraStateChanged=76]="CameraStateChanged",e[e.SubtitlesStateChanged=78]="SubtitlesStateChanged",e[e.VideoFrameToPptForCameo=99]="VideoFrameToPptForCameo"}(a||(a={}));var s=i(9),o=i(3),l=i(7),d=i(17),c=i(11),h=i(150),u=i(8),m=i(13),f=i(39),p=i(24),g=i(4),_=i(1),S=i(10),v=i(27);class y{static tryLoggingMessageType(e){if(e.data)try{const t="string"==typeof e.data?JSON.parse(e.data):e.data;if(!t.m_type)return;s.a.sendTraceTag(506856320,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"WindowCommunicationChannel:: Dropping message of type: "+t.m_type)}catch(e){s.a.sendTraceTag(506856291,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,`WindowCommunicationChannel:: Error reading/parsing message data (${e})`)}}postMessageUpward(e){window.postMessage({message:e,direction:"upward"},window.location.origin)}addEventListener(e){const t=t=>{const i=t.data?t.data.direction:void 0;"upward"!==i&&(t.source===window?e(i&&t.data.message?new MessageEvent("message",{data:t.data.message}):t):this.m_logger&&(s.a.sendTraceTag(506856290,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"WindowCommunicationChannel:: message source is not the same window."),y.tryLoggingMessageType(t)))};window.addEventListener("message",t),this.m_registeredListeners.push(t)}get embeddedViewOption(){return this.m_embeddedViewOption}close(){this.m_registeredListeners.forEach(e=>window.removeEventListener("message",e)),s.a.sendTraceTag(506856289,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"WindowCommunicationChannel::close : Removed listeners.")}constructor(e,t){this.m_embeddedViewOption=e,this.m_logger=t,this.m_registeredListeners=new Array,s.a.setLogger(this.m_logger)}}var T=i(126);const b=i(116);class w{async launchApp(e){try{if(this.m_slideShowApp=e,this.m_logger||(this.m_logger=this.m_slideShowApp.logger,s.a.setLogger(this.m_logger)),s.a.sendTraceTag(506856583,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::launchApp hostSessionId: ${this.m_hostSessionId}.`),this.registerForAppEvents(),e instanceof T.a){const e={slideId:{sid:-1,cid:0},slideIndex:-1};this.sendPositionMessage(r.OnPositionChanged,!1,e)}await this.m_slideShowApp.init()}catch(e){s.a.sendTraceTag(506856582,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,`Exception during launchApp: ${e}.`),S.e.recordVeto("FailedToLaunchApp",{qosVeto:"FileOpenFailed",isSessionEndingError:!0}),this.sendError(5e3,d.n.FailedToLaunchApp,d.n.FailedToLaunchApp,JSON.stringify(e,Object.getOwnPropertyNames(e)),"")}}registerForAppEvents(){if(this.m_slideShowApp.slideShowAppEvents.on("bootStageChanged",this.onBootStageChanged.bind(this)),this.m_slideShowApp.slideShowAppEvents.on("networkHealthChanged",e=>{const t={m_id:this.m_hostSessionId,m_type:r.OnNetworkHealthChanged,m_isHealthy:e.isHealthy,m_addTimeoutTimeMs:e.addTimeoutTimeMs};this.postMessageUpward(t)}),this.m_slideShowApp.slideShowAppEvents.on("slideShowRetryableError",this.onSlideShowRetryableError.bind(this)),this.m_slideShowApp.slideShowAppEvents.on("slideshowError",this.onSlideShowError.bind(this)),this.m_slideShowApp.slideShowAppEvents.on("slideShowReady",this.onSlideShowReady.bind(this)),this.m_slideShowApp.slideShowAppEvents.on("slideMediaEvent",e=>{this.sendMediaEvent(e)}),this.m_slideShowApp.slideShowAppEvents.on("mediaInitState",e=>{this.sendInitMediaState(e)}),this.m_slideShowApp.slideShowAppEvents.on("roleChangedOutbound",e=>{this.roleChangedOutbound(e)}),this.m_slideShowApp.slideShowAppEvents.on("showWeatherPerson",e=>{this.showWeatherPerson(e)}),this.m_slideShowApp.slideShowAppEvents.on("returnToPresenter",()=>{this.returnToPresenter()}),this.m_slideShowApp.slideShowAppEvents.on("takeControl",()=>{this.sendPositionMessage(r.TakeControl,!0)}),this.m_slideShowApp.slideShowAppEvents.on("privateViewingToggled",e=>{this.privateViewingToggled(e)}),g.ChangeGate.isChangeGateEnabled("PVA.SlideNavStartSyncFix")&&this.m_slideShowApp.slideShowAppEvents.on("slideNavigationStarted",e=>{this.sendPositionMessage(r.OnPositionChanged,!1,e,!0),this.sendCameoFrameRequestForSlide()}),this.m_slideShowApp.slideShowAppEvents.on("slideLocationChanged",()=>{this.sendPositionMessage(r.OnPositionChanged,!1),this.sendCameoFrameRequestForSlide()}),this.m_slideShowApp.slideShowAppEvents.on("animationStateChanged",()=>{this.sendPositionMessage(r.OnPositionChanged,!1)}),_.a.readBooleanOrDefault("isZoomSyncEnabled",!1)){this.m_slideShowApp.slideShowAppEvents.on("initOpticalZoomState",e=>{this.sendOpticalZoomStateMessage(e)});const e=g.ChangeGate.isChangeGateEnabled("SSC.ThrottleOpticalZoomMessages")?Object(h.a)(this.sendOpticalZoomStateMessage.bind(this),_.a.readNumberOrDefault("sendOpticalZoomStateThrottleTimeMs",50)):void 0;this.m_slideShowApp.slideShowAppEvents.on("opticalZoomStateChanged",t=>{t.metadata&&t.metadata.currentRole===p.b.Presenter&&(!e||t.animationData?this.sendOpticalZoomStateMessage(t):e(t))})}this.m_slideShowApp.slideShowAppEvents.on("blankSlideStateChanged",e=>{this.m_currentSlideState=e;const t={m_id:this.m_hostSessionId,m_type:r.BlankSlideState,m_blankSlideState:e};this.postMessageUpward(t)}),this.m_slideShowApp.slideShowAppEvents.on("onExitSlideShow",()=>{const e=this.m_slideShowApp.getSlideLocation();if(!e)return;const t={m_id:this.m_hostSessionId,m_type:r.OnExitSlideshow,m_slideId:e.slideId.sid,m_slideIndex:e.slideIndex,m_isFromEndOfSlideshow:this.m_currentSlideState===u.a.EndOfShow};this.postMessageUpward(t)}),this.m_slideShowApp.slideShowAppEvents.on("aadTokenRequest",e=>{const t={m_id:this.m_hostSessionId,m_type:r.AadTokenRequest,m_resourceId:e};this.postMessageUpward(t)}),this.m_slideShowApp.slideShowAppEvents.on("frameTrustCheck",()=>{this.m_slideShowReady?this.requestFrameTrustStatus():this.m_hasPendingFrameTrustCheckRequest=!0}),this.m_slideShowApp.slideShowAppEvents.on("slideShowAnnotationEvent",e=>{this.sendAnnotationEvent(e)}),this.m_slideShowApp.slideShowAppEvents.on("copyFileLink",()=>{this.copyFileLink()}),this.m_slideShowApp.slideShowAppEvents.on("copyFileLinktoChat",()=>{this.copyFileLinktoChat()}),this.m_slideShowApp.slideShowAppEvents.on("turnOnCoach",()=>{this.turnOnCoach()}),this.m_slideShowApp.slideShowAppEvents.on("turnOffCoach",()=>{this.turnOffCoach()}),this.m_slideShowApp.slideShowAppEvents.on("checkCoachStatus",()=>{this.checkCoachStatus()}),this.m_slideShowApp.slideShowAppEvents.on("cameoDetectedInPresentation",e=>{this.sendCameoDetectedInPresentation(e)}),this.m_slideShowApp.slideShowAppEvents.on("mediaDetectedInPresentation",()=>{this.sendMediaDetectedInPresentation()}),this.m_slideShowApp.slideShowAppEvents.on("renderingModeChangedToSVG",()=>{this.sendRenderingModeChangedToSVG()}),this.m_slideShowApp.slideShowAppEvents.on("slideViewBoundsChanged",this.sendSlideViewBounds.bind(this)),this.m_slideShowApp.slideShowAppEvents.on("cameraStateChanged",e=>{this.sendCameraStateChangedEvent(e)}),this.m_slideShowApp.slideShowAppEvents.on("subtitlesStateChanged",e=>{this.sendSubtitlesStateChangedEvent(e)}),this.m_slideShowApp.slideShowAppEvents.on("slideAddinSyncStateEvent",e=>{this.sendAddinSyncStateEvent(e)}),addEventListener("mousemove",e=>{this.onBrowserEvent(e)})}sendAppReadyForPostMessage(){s.a.sendTraceTag(506856581,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::sendAppReadyForPostMessage hostSessionId: ${this.m_hostSessionId}.`);const e={m_id:this.m_hostSessionId,m_type:r.AppReadyForPostMessage,func:"initialize"};this.postMessageUpward(e)}onSlideShowReady(){s.a.sendTraceTag(506856580,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::onSlideShowReady hostSessionId: ${this.m_hostSessionId}.`),this.m_slideShowReady=!0,this.onBootStageChanged("FinishingHandshake"),this.tryFinishHandshake(),this.emitCameoEvents(),this.m_hasPendingFrameTrustCheckRequest&&(this.requestFrameTrustStatus(),this.m_hasPendingFrameTrustCheckRequest=!1)}emitCameoEvents(){if(this.m_slideShowApp){const e=this.m_slideShowApp.getSlideLocation();e&&this.m_slideShowApp.emitIfCameoDetected(e.slideIndex)}this.sendCameoFrameRequestForSlide()}requestFrameTrustStatus(){const e={m_id:this.m_hostSessionId,m_type:r.FrameTrustCheck};this.postMessageUpward(e)}onBootStageChanged(e){s.a.sendTraceTag(506856579,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::onBootStageChanged: previous boot stage: ${this.m_currentBootStage}, new boot stage: ${e}`),this.m_currentBootStage=e;const t={m_id:this.m_hostSessionId,m_type:r.BootStageChanged,m_stageInfo:e};this.postMessageUpward(t)}onSlideShowRetryableError(e){s.a.sendTraceTag(506856578,o.a.msoulscat_Wac_PptSlideshow,l.a.Warning,`SlideShowAPI::onSlideShowRetryableError hostSessionId: ${this.m_hostSessionId}, Error:${e}.`);const t={m_id:this.m_hostSessionId,m_type:r.PostAppErrorUpwardsForTelemetry,ErrorName:e};this.postMessageUpward(t)}onSlideShowError(e){s.a.sendTraceTag(506856577,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,`SlideShowAPI::onSlideShowError errorCode: ${e}.`);let t=e;g.ChangeGate.isChangeGateEnabled("SSA.TrimErrorCode")&&e&&(t=e.trim()),S.e.recordVeto(this.m_slideShowReady?"UnexpectedAppClose":"FileOpenFailed",{errorName:""!==t?t:"EmptyErrorName",isSessionEndingError:!0}),this.sendError(w.convertToAppErrorCode(e),t,t,"","")}sendError(e,t,i,n,a){const s={m_id:this.m_hostSessionId,m_type:r.OnError,m_code:e,m_errorName:t,m_message:i,m_extraInfo:n,m_sessionId:this.m_slideShowApp.sessionInfo.userSessionId,m_correlationId:a};this.postMessageUpward(s)}sendCameraStateChangedEvent(e){s.a.sendTraceTag(506856576,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::sendCameraStateChangedEvent cameraEnabled: ${e}.`);const t={m_id:this.m_hostSessionId,m_type:r.CameraStateChanged,m_cameoButtonEnabled:e};this.postMessageUpward(t)}sendSubtitlesStateChangedEvent(e){s.a.sendTraceTag(506856547,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::sendSubtitlesStateChangedEvent subtitlesEnabled: ${e}.`);const t={m_id:this.m_hostSessionId,m_type:r.SubtitlesStateChanged,m_subtitlesEnabled:e};this.postMessageUpward(t)}sendPositionMessage(e,t,i,n){const r=i||this.m_slideShowApp.getSlideLocation();if(!r)return void s.a.sendTraceTag(506856546,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,`SlideShowAPI::sendPositionMessage: ${this.m_hostSessionId}, type: ${e}`);const a=n?{timelineStates:[]}:this.m_slideShowApp.getAnimationState(!1),d=[];for(const e of a.timelineStates){const t={TimeLineId:e.timelineId,Step:e.step,LastClickTime:e.lastClickTime?e.lastClickTime:0,StartTimeOffset:a.startTimeOffset||0};d.push(t)}const c=!t&&this.m_slideShowApp.shouldPreventBroadcastOutboundSlideNavEvent(r,a);s.a.sendTraceTag(506856545,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::sendPositionMessage: ${this.m_hostSessionId}, type: ${e}, slideId: ${r.slideId.sid}, slideIndex:${r.slideIndex}, timelineMappings: ${JSON.stringify(d)}, shouldPreventBroadcast: ${c}`);const h={m_id:this.m_hostSessionId,m_type:e,m_slideId:r.slideId.sid,m_slideIndex:r.slideIndex,m_timeLineMappings:d,m_slideLocation:r,m_animationState:a,m_metadata:{slideIndex:r.slideIndex,slideId:r.slideId.sid,timelineMappings:"",PPT_ModernSS_Emit_Nav:this.m_slideShowApp.sessionUTC,skew_emitter:this.m_slideShowApp.skew,Skew_Emitter:this.m_slideShowApp.skew,presenter_id:this.m_hostSessionId,presenter_ring:this.m_slideShowApp.sessionInfo.uiHostRing||"",stateClientId:this.m_lastKnownStateClientId,stateServiceNavSync:this.m_slideShowApp.appSettings.isStateServiceNavTelemetryEnabled,shouldPreventBroadcast:c}};this.postMessageUpward(h)}sendOpticalZoomStateMessage(e){let t=!1,i=!1,n=e.currentState;if(e.animationData&&(t=!0,i=b(e.currentState,e.animationData.startOpticalZoomState),n=i?e.animationData.targetOpticalZoomState:e.currentState),t&&!i)return;const a={m_id:this.m_hostSessionId,m_type:r.OpticalZoomStateChanged,m_opticalZoomState:n,m_shouldAnimate:i,m_metadata:{source:e.metadata?e.metadata.source:"",currentSlideLocation:this.m_slideShowApp.getSlideLocation(),PPT_ModernSS_Emit_Time_Ms:this.m_slideShowApp.sessionUTC,Skew_Emitter:this.m_slideShowApp.skew}};this.postMessageUpward(a)}sendMediaEvent(e){if(f.a.isDuplicateMediaSyncMessage(e.correlationId,!0))return;const t=!!this.m_slideShowApp.appSettings.isStateServiceMediaSyncEnabled,i={m_id:this.m_hostSessionId,m_type:r.MediaEvent,m_mediaPlayerName:e.mediaName,m_mediaEventType:e.event.eventType,m_mediaPosition:e.event.position,m_mediaVolume:e.event.volume,m_mediaMuted:e.event.muted,m_metadata:{PPT_ModernSS_Emit_Media:this.m_slideShowApp.sessionUTC,Skew_Emitter:this.m_slideShowApp.skew,presenterMediaStateServiceEnabled:t,mediaSyncTimeLine:[],CorrelationId:e.correlationId,origin:e.origin,mediaEventType:e.event.eventType}};this.updateMediaSyncMetadataAndLog("Sending Media Sync Event to "+(t?"StateServicePreviewerClient":"IC3"),i),s.a.sendTraceTag(506856544,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`Pushing Media Event upwards for host session: ${this.m_hostSessionId}, media: ${e.mediaName}, event: ${e.event.eventType}, position: ${e.event.position}`),this.postMessageUpward(i)}updateMediaSyncMetadataAndLog(e,t){t.m_metadata&&t.m_metadata.mediaSyncTimeLine?(t.m_metadata.mediaSyncTimeLine.push("SlideShowAPI: "+e),s.a.sendTraceTag(506856542,o.a.msoulscat_Wac_PptLive,l.a.Info,JSON.stringify({fileName:"SlideShowAPI",mediaSyncMessage:t}))):s.a.sendTraceTag(506856543,o.a.msoulscat_Wac_PptLive,l.a.Info,"SlideShowAPI::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine.")}sendInitMediaState(e){const t=e.state,i=e.correlationId;if(f.a.isDuplicateMediaSyncMessage(i,!0))return;const n=!!this.m_slideShowApp.appSettings.isStateServiceMediaSyncEnabled,a={m_id:this.m_hostSessionId,m_type:r.InitMediaSyncEvent,m_mediaPlayerName:t.mediaName,m_mediaPlayerState:t.playerState?t.playerState:m.d.MediaPaused,m_mediaPosition:t.position?t.position:0,m_mediaVolume:t.volume?t.volume:0,m_mediaMuted:!!t.muted&&t.muted,m_metadata:{PPT_ModernSS_Emit_Media:this.m_slideShowApp.sessionUTC,Skew_Emitter:this.m_slideShowApp.skew,presenterMediaStateServiceEnabled:n,mediaSyncTimeLine:[],CorrelationId:i,origin:e.origin}};this.updateMediaSyncMetadataAndLog("Sending Initial Media State to "+(n?"StateServicePreviewerClient":"IC3"),a),s.a.sendTraceTag(506856541,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"Pushing Initial Media Event upwards for host session: "+JSON.stringify(a)),this.postMessageUpward(a)}sendAnnotationEvent(e){const t={m_id:this.m_hostSessionId,m_type:r.AnnotationEvent,m_annotationEventType:e.eventType,m_annotationSlideID:e.slideID,m_annotationStrokeID:e.strokeID,m_annotationEventJson:e.eventJson,m_metadata:e.eventType===v.a.SemiDryStrokeAdded||e.eventType===v.a.LaserStart||e.eventType===v.a.LaserEnd||e.eventType===v.a.WetStrokeStart||e.eventType===v.a.WetStrokeEnd?{PPT_ModernSS_Emit_Annotation:this.m_slideShowApp.sessionUTC,annotationEventType:e.eventType,Skew_Emitter:this.m_slideShowApp.skew,presenter_ring:this.m_slideShowApp.sessionInfo.uiHostRing?this.m_slideShowApp.sessionInfo.uiHostRing:""}:void 0};s.a.sendTraceTag(506856540,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`Pushing Annotation Event upwards for host session: ${this.m_hostSessionId}, event: ${e.eventType}, eventType: ${e.eventType}`),this.postMessageUpward(t)}roleChangedOutbound(e){s.a.sendTraceTag(506856539,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::roleChangedOutbound with role = ${e} hostSessionId: ${this.m_hostSessionId}.`);const t={m_id:this.m_hostSessionId,m_type:r.RoleChangedOutbound,m_role:e};this.postMessageUpward(t)}showWeatherPerson(e){s.a.sendTraceTag(506856538,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::${e.show?"show":"hide"} weather person hostSessionId: ${this.m_hostSessionId}; metadata: ${e.metadata?JSON.stringify(e.metadata):""}.`);const t={m_id:this.m_hostSessionId,m_type:r.ShowWeatherPerson,m_show:e.show,m_metadata:e.metadata};this.postMessageUpward(t)}returnToPresenter(){s.a.sendTraceTag(506856537,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::returnToPresenter hostSessionId: ${this.m_hostSessionId}.`);const e={m_id:this.m_hostSessionId,m_type:r.ReturnToPresenter};this.postMessageUpward(e)}privateViewingToggled(e){s.a.sendTraceTag(506856536,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::${e?"enabled":"disabled"} private viewing hostSessionId: ${this.m_hostSessionId}.`);const t={m_id:this.m_hostSessionId,m_type:r.TogglePrivateViewing,m_enabled:e};this.postMessageUpward(t)}copyFileLink(){s.a.sendTraceTag(506856535,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideShowAPI:: copy file link to clipboard clicked ");const e={m_id:this.m_hostSessionId,m_type:r.CopyFileLinktoClipboard};this.postMessageUpward(e)}copyFileLinktoChat(){s.a.sendTraceTag(506856534,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideShowAPI:: copy file link to chat now clicked");const e={m_id:this.m_hostSessionId,m_type:r.PasteFileLinktoChat};this.postMessageUpward(e)}turnOnCoach(){s.a.sendTraceTag(506856533,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI:: Turn on coach hostSessionId: ${this.m_hostSessionId}.`);const e={m_id:this.m_hostSessionId,m_type:r.StartCoach};this.postMessageUpward(e)}turnOffCoach(){s.a.sendTraceTag(506856532,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI:: Turn off coach hostSessionId: ${this.m_hostSessionId}.`);const e={m_id:this.m_hostSessionId,m_type:r.StopCoach};this.postMessageUpward(e)}checkCoachStatus(){s.a.sendTraceTag(506856531,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::requesting coach status hostSessionId: ${this.m_hostSessionId}.`);const e={m_id:this.m_hostSessionId,m_type:r.CheckCoachStatus};this.postMessageUpward(e)}tryFinishHandshake(){if(null==this.m_slideShowApp||!this.m_handshakeReceived||!this.m_slideShowReady)return void s.a.sendTraceTag(506856530,o.a.msoulscat_Wac_PptSlideshow,this.m_slideShowReady?l.a.Error:l.a.Info,`Slideshow App: ${!!this.m_slideShowApp} HandshakeReady: ${!!this.m_handshakeReceived} SlideShowReady: ${!!this.m_slideShowReady},\n        );`);s.a.sendTraceTag(506856529,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"PowerPoint ready for host session: "+this.m_hostSessionId);const e={m_id:this.m_hostSessionId,m_type:r.Handshake,m_sessionId:this.m_slideShowApp.sessionInfo.hostSessionId,m_percievedBootTime:Date.now(),m_data:{title:"Slide Show"}};this.postMessageUpward(e)}sendCameoDetectedInPresentation(e){s.a.sendTraceTag(506856528,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::Cameo detected in Presentation: ${e}, hostSessionId: ${this.m_hostSessionId}.`);const t={m_id:this.m_hostSessionId,m_type:r.CameoDetectedInPresentation,m_fCameoDetectedInPresentation:e};this.postMessageUpward(t)}sendMediaDetectedInPresentation(){s.a.sendTraceTag(506856527,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::Media detected in Presentation, hostSessionId: ${this.m_hostSessionId}.`);const e={m_id:this.m_hostSessionId,m_type:r.MediaDetectedInPresentation};this.postMessageUpward(e)}sendRenderingModeChangedToSVG(){const e={m_id:this.m_hostSessionId,m_type:r.RenderingModeChangedToSVG};this.postMessageUpward(e)}sendAddinSyncStateEvent(e){const t={m_id:this.m_hostSessionId,m_type:r.AddinEventOutbound,m_addinInstanceId:e.instanceId,m_addinStateData:e.liveShareState};this.postMessageUpward(t)}handleAnnotationMessage(e){s.a.sendTraceTag(506856526,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideshowAPI Downward Annotation Message received: "+e.m_eventType),f.a.logStateServicePipelineLatency("Ink",e.m_eventType?e.m_eventType.toString():"",e.m_metadata,this.m_slideShowApp.skew);const t={eventType:e.m_eventType,slideID:e.m_slideID,strokeID:e.m_strokeID,eventJson:e.m_eventJson,inkSnapshot:e.m_semiDryInkSnapshot,startPointJson:e.m_startPointJson,appendPointsArray:e.m_appendPointsArray,metadata:e.m_metadata};this.m_slideShowApp.handleAnnotationEvent(t)}handleGotoSlideMessage(e){let t=e.m_actionContext;if(e.m_metadata&&(f.a.logStateServicePipelineLatency("Nav","",e.m_metadata,this.m_slideShowApp.skew),Math.abs(this.m_slideShowApp.skew)<1e8&&(e.m_metadata.SSApi_Local=this.m_slideShowApp.sessionUTC),e.m_metadata.navTrigger="SSInboundMessage",t?t.navMetrics=e.m_metadata:t={navMetrics:e.m_metadata}),e.m_slideLocation)this.m_slideShowApp.gotoSlide(e.m_slideLocation,t,e.m_animationState,e.m_skipTransition);else{let i;if(e.m_timeLineMappings){const t=[];let n;for(let i=0;i<e.m_timeLineMappings.length;i+=1){const r={timelineId:e.m_timeLineMappings[i].TimeLineId,step:e.m_timeLineMappings[i].Step,lastClickTime:0===e.m_timeLineMappings[i].LastClickTime?void 0:e.m_timeLineMappings[i].LastClickTime};n=0===e.m_timeLineMappings[i].StartTimeOffset?void 0:e.m_timeLineMappings[i].StartTimeOffset,t.push(r)}i={timelineStates:t,startTimeOffset:n}}void 0!==e.m_slideIndex?this.m_slideShowApp.gotoSlide({slideIndex:e.m_slideIndex},t,i,void 0):e.m_slideId&&this.m_slideShowApp.gotoSlide({slideId:{sid:e.m_slideId,cid:0}},t,i,void 0)}}onMessage(e){if(void 0!==e.data.arrayBuffer&&void 0!==e.data.bufferMetadata)return void this.handleMessageWithArrayBuffer(e.data.bufferMetadata,e.data.arrayBuffer);let t;try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){return void s.a.sendTraceTag(506856525,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"Exception when trying to parse data")}null!=t&&null!=t.m_type?this.handleMessage(t,e.origin):s.a.sendTraceTag(506856524,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"Message does not have data or data type.")}handleMessageWithArrayBuffer(e,t){this.m_slideShowApp.videoFrameToPptForCameo(e,t)}postMessageUpward(e){if(null!=e.m_id&&window.parent){const t=JSON.stringify(e);this.m_windowCommunicationChannel.postMessageUpward(t),g.ChangeGate.isChangeGateEnabled("SSA.LogPostMessageUpwardType")&&s.a.sendTraceTag(506856523,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"PostMessage sent of type: "+e.m_type)}else s.a.sendTraceTag(506856522,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"PostMessage called without id or target! "+JSON.stringify(e))}sendSlideViewBounds(){const e={m_id:this.m_hostSessionId,m_type:r.OnSlideViewBoundsChanged,m_slideViewBounds:_.a.readBooleanOrDefault("shrinkSlideForAPL",!1)?this.m_slideShowApp.getSlideAreaContainerBounds():this.m_slideShowApp.getSlideViewBounds()};this.postMessageUpward(e)}onBrowserEvent(e){if(!_.a.readBooleanOrDefault("onBrowserEventEnabled",!1))return;const t=e,i={m_id:this.m_hostSessionId,m_type:r.OnBrowserEvent,m_event:e,m_clientX:t.clientX,m_clientY:t.clientY};this.postMessageUpward(i)}sendCameoFrameRequestForSlide(){if(!g.ChangeGate.isChangeGateEnabled("SSC.SendCameoFrameRequest"))return;const e=this.m_slideShowApp.getCameoInfoFromActiveSlide();if(void 0!==e){const t={m_id:this.m_hostSessionId,m_type:r.CameoFrameRequestForSlide,m_cameoInSlide:e};this.postMessageUpward(t)}}checkTrustedOrigin(e){const t=this.m_slideShowApp.appSettings.trustedHostOrigins;if(t)for(const i of t)if(new RegExp(`^${i}$`).test(e))return!0;return!1}async handleMessage(e,t){const i={m_id:e.m_id,m_type:e.m_type};switch(g.ChangeGate.isChangeGateEnabled("SSC.LogHandleMessageForMessagesBesidesOpticalZoom")&&e.m_type!==a.OpticalZoomStateChanged&&s.a.sendTraceTag(506856521,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideShowAPI::handleMessage : ${JSON.stringify(i)}.`),e.m_type){case a.Handshake:this.m_handshakeReceived=!0,this.tryFinishHandshake();break;case a.GetSlidesInShowCount:{const e={m_id:this.m_hostSessionId,m_type:r.GetSlidesInShowCount,m_slidesCount:this.m_slideShowApp.getSlideCount()};this.postMessageUpward(e);break}case a.NextStep:{const t=e;await this.m_slideShowApp.nextStep(t.m_timelineId,t.m_metadata);break}case a.PrevStep:{const t=e;await this.m_slideShowApp.prevStep(t.m_timelineId,t.m_metadata);break}case a.LaserPointerActivation:{const t=e;this.m_slideShowApp.setLaserPointerActivation(t.m_fActivate,t.m_metadata);break}case a.CameraStateChanged:{const t=e;this.m_slideShowApp.changeCameraState(t.m_cameoButtonEnabled);break}case a.SubtitlesStateChanged:{const t=e;this.m_slideShowApp.changeSubtitlesState(t.m_subtitlesEnabled);break}case a.GotoNextSlide:await this.m_slideShowApp.nextSlide(!1);break;case a.NextSlide:{const t=e;await this.m_slideShowApp.nextSlide(!t.m_fOrNextFullyBuilt||t.m_fOrNextFullyBuilt);break}case a.MediaEvent:{const t=e;s.a.sendTraceTag(506856520,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideshowAPI Downward Message containing MediaEvent received for media: "+t.m_mediaPlayerName),f.a.logStateServicePipelineLatency("Media",t.m_eventType?t.m_eventType.toString():"",t.m_metadata,this.m_slideShowApp.skew),this.m_slideShowApp.updateMediaState(t.m_mediaPlayerName,t.m_position,t.m_volume,t.m_muted,t.m_playerState,t.m_metadata,t.m_isInitState);break}case a.GotoPrevSlide:await this.m_slideShowApp.prevSlide(!1);break;case a.PrevSlide:{const t=e;await this.m_slideShowApp.prevSlide(!t.m_fOrNextFullyBuilt||t.m_fOrNextFullyBuilt);break}case a.GetCurrentPosition:this.sendPositionMessage(r.GetCurrentPosition,!0);break;case a.GoToSlideId_DEPRECATED:case a.GoToSlide:{const t=e;this.handleGotoSlideMessage(t);break}case a.AnnotationEvent:{const t=e;this.handleAnnotationMessage(t);break}case a.PlayMedia:{const t=e;s.a.sendTraceTag(506856519,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideshowAPI Downward Message PlayMedia received for media: "+t.m_mediaPlayerName),this.m_slideShowApp.playMedia(t.m_mediaPlayerName,t.m_metadata);break}case a.PauseMedia:{const t=e;s.a.sendTraceTag(506856518,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideshowAPI Downward Message PauseMedia received for media: "+t.m_mediaPlayerName),this.m_slideShowApp.pauseMedia(t.m_mediaPlayerName,t.m_metadata);break}case a.SeekMedia:{const t=e;s.a.sendTraceTag(506856517,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideshowAPI Downward Message SeekMedia received for media: ${t.m_mediaPlayerName}, position: ${t.m_position}`),this.m_slideShowApp.seekMedia(t.m_mediaPlayerName,t.m_position,t.m_metadata);break}case a.VolumeMedia:{const t=e;s.a.sendTraceTag(506856516,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SlideshowAPI Downward Message setMediaVolume received for media: ${t.m_mediaPlayerName}, volume: ${t.m_volume}`);break}case a.AddinEventInbound:{const t=e;s.a.sendTraceTag(506856515,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"SlideshowAPI Downward Message AddinEvent received for addin: "+t.m_addinInstanceId),this.m_slideShowApp.setAddinSyncState({instanceId:t.m_addinInstanceId,liveShareState:t.m_addinStateData});break}case a.SetNavigationOptions:{const t=e;this.m_slideShowApp.setNavigationOptions(t.m_enableAdvanceOnClick,t.m_enableKeyboardNavigation);break}case a.BootTimingFromApi:{const t=e;if(null!=t&&null!=t.m_apiTimings){t.m_apiTimings.ReceivedBootTimingDataFromApi=(new Date).getTime(),s.a.sendTraceTag(506856514,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"BootTimingFromApiInboundMessage: "+JSON.stringify(t.m_apiTimings));const e={};e.boostrapperTiming=t.m_apiTimings,c.a.recordSessionStats(e)}break}case a.RestoreFocus:this.m_slideShowApp.restoreFocus();break;case a.ExitSlideShow:this.m_slideShowApp.exitSlideShow();break;case a.SwitchRole:{const t=e;null!=t&&null!=t.m_role&&this.m_slideShowApp.switchRole(t.m_role);break}case a.ChangeTheme:{const t=e;null!=t&&null!=t.m_isHighContrast&&await this.m_slideShowApp.changeTheme(t.m_isHighContrast,t.m_highContrastColorSettings);break}case a.SetPrivateViewingToggle:{const t=e;t&&null!=t.m_enabled&&this.m_slideShowApp.setPrivateViewingToggle(t.m_enabled);break}case a.RecordMetrics:{const t=e;if(t&&t.m_data)if("TeamsNavMetric"===t.m_statName){if(f.a.trackTeamsPVMetrics(t.m_data,this.m_slideShowApp.sessionUTC),!g.ChangeGate.isChangeGateEnabled("SSUI.disableButtonsEmitRoleChanged"))switch(t.m_data.action){case"enterPrivateViewing":this.m_slideShowApp.slideShowAppEvents&&this.m_slideShowApp.appSettings.isResumeSlideShowExperienceEnabled&&this.m_slideShowApp.slideShowAppEvents.emit("roleChanged",p.b.PrivateViewing);break;case"leavePrivateViewing":this.m_slideShowApp.slideShowAppEvents&&this.m_slideShowApp.appSettings.isResumeSlideShowExperienceEnabled&&this.m_slideShowApp.slideShowAppEvents.emit("roleChanged",p.b.Attendee)}}else"StateServiceNavMetric"===t.m_statName?g.ChangeGate.isChangeGateEnabled("SSC.LogStateServiceComparisonNav")&&f.b.logStateServiceComparisonTelemetry(t.m_data.m_metadata,this.m_slideShowApp.sessionUTC,this.m_slideShowApp.skew,this.m_slideShowApp.sessionInfo.uiHostRing?this.m_slideShowApp.sessionInfo.uiHostRing:""):"StateServiceClientId"===t.m_statName&&(this.m_lastKnownStateClientId=t.m_data.clientId);break}case a.SetInkingActivity:{const t=e;null!=t&&null!=t.m_activity&&this.m_slideShowApp.setInkingActivity(t.m_activity);break}case a.SetAadToken:{const t=e;this.m_slideShowApp.setAadToken(t.m_token);break}case a.SetFrameTrustStatus:if(this.checkTrustedOrigin(t)){const t=e;this.m_slideShowApp.setFrameTrustStatus(t.m_isTrusted)}break;case a.PPTSharingLayoutChanged:{const t=e;null!=t&&(this.sendSlideViewBounds(),void 0===t.m_sharingLayoutMode?s.a.sendTraceTag(506856513,o.a.msoulscat_Wac_PptSlideshow,l.a.Warning,`SlideShowAPI::PPTSharingLayoutChanged message does not have a valid SharingLayoutMode: ${JSON.stringify(e)}.`):this.m_slideShowApp.setSharingLayoutMode(t.m_sharingLayoutMode));break}case a.SendPresenterStateDuringPrivateViewing:{const t=e;this.m_slideShowApp.sendPresenterStateDuringPrivateViewing(t.m_slideIndex);break}case a.UpdateMeetingCoachStatus:{const t=e;t&&null!=t.m_isCoachOn&&this.m_slideShowApp.updateMeetingCoachStatus(t.m_isCoachOn);break}case a.BlankSlideState:{const t=e;this.m_slideShowApp.setBlankSlideState(t.m_blankSlideState);break}case a.ReturnToPresenterInbound:this.m_slideShowApp.returnToPresenterInbound();break;case a.CustomBackgroundForAPL:{const t=e;this.m_slideShowApp.updateCustomBackgroundForAPL(t.m_backgroundUrl,t.m_backgroundId);break}case a.SetGlobalMute:{const t=e;this.m_slideShowApp.setGlobalMute(t.m_fMuted);break}case a.UpdateBufferInfoForCameo:{const t=e;this.m_slideShowApp.updateBufferInfoForCameo(t.m_bufferName);break}case a.HideCameo:{const t=e;this.m_slideShowApp.hideCameo(t.m_fHide,t.m_reason);break}case a.OpticalZoomStateChanged:{const t=e;g.ChangeGate.isChangeGateEnabled("SSC.LogOpticalZoomSyncStateServiceTelemetry")&&f.a.logStateServicePipelineMetrics("OpticalZoom","",t.m_metadata,this.m_slideShowApp.skew),this.m_slideShowApp.setOpticalZoomState(t.m_opticalZoomState,{fAnimate:t.m_shouldAnimate,source:u.d.Sync,presentersSource:t.m_metadata.source});break}case a.UpdatePresenterName:{const t=e;this.m_slideShowApp.updatePresenterName(t.m_presenterDisplayName);break}default:s.a.sendTraceTag(506856512,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,`SlideShowAPI::unhandled message in handleMessage : ${JSON.stringify(i)}.`)}}static convertToAppErrorCode(e){let t=e;switch(e.startsWith("Server")&&(t=e.slice("Server".length).trim()),t){case"PostBootFailed":return 5002;case"ErrorWorkerCannotOpenDocument":return 5308422;case"ErrorWorkerCannotOpenDocumentFileType":return 5341186;case"ErrorWorkerCannotOpenDocumentIRM":case"ErrorFileDownloadNotSupportedFileType":return 5341187;case"ErrorWorkerCannotOpenDocumentPassword":return 5341188;case"ErrorCannotInstallFonts":return 5341190;case"ErrorCannotRender":return 5341281;case"ErrorWorkerCannotOpenDocumentMacro":return 5341217;case"ErrorWorkerCannotOpenDocumentSigned":return 5341219;case"ErrorWorkerCannotOpenDocumentWrongExt":return 5341260;case"ErrorWorkerCannotOpenDocumentStgDocFileCorrupt":return 5341261;case"ErrorWorkerCannotOpenDocumentMmcfPackagePartNotFound":return 5341263;case"ErrorWorkerCannotOpenDocumentArchiveError":return 5341264;case"ErrorWorkerCannotOpenDocumentTooLarge":return 5341301;case"ErrorFileDownloadZeroByteFile":return 5341338;case"ErrorFileNotFound":return 5341412;case"Unauthorized":case"ErrorFileDownloadStatusCodeUnauthorized":return 5341414;case"ErrorFileDownloadStatusCodeForbidden":return 5341415;case"ErrorFileDownloadStatusCodeNotFound":return 5341417;case"ErrorFileDownloadFailed":return 5341421;case"ErrorFileDownloadStatusCodeTooManyRequests":return 5341437;case"ErrorCannotOpenFileMetroFileCorruption":return 5341440;case"ErrorFileDownloadTimedOut":return 5341460;case"GetItemsFailedDownloadFile":return 5341461;case"ErrorFailedToFetch":return 5341599;case"ErrorRESERVEDItemFailed":return 5341600;case"ErrorRequestTimeout":return 5341601;case"ErrorFileDownloadResourceInconsistent":return 5341602;case"ErrorGeneralUnknown":return 5341603;case"ErrorRequestFailed":return 5341610;case"ErrorWorkerExceedLimit":return 5341612;case"ErrorConnectionLost":return 5341613;case"ErrorFileDownloadNetworkError":return 5341614;case"ErrorWorkerCannotOpenDocumentStgFileAlreadyExists":return 5341615;case"ErrorInvalidItem":return 5341617;case"ResourceLoaderFailed":return 5341618;case"ErrorFileDownloadFailedToParseEndOfCentralDirectory":return 5341619;case"ErrorWorkerFailed":return 5373969;default:return s.a.sendTraceTag(506856483,o.a.msoulscat_Wac_PptSlideshow,l.a.Warning,`SlideShowAPI::convertToAppErrorCode: ${t} is converted to 5001`),5001}}close(){s.a.sendTraceTag(506856482,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,"Closing the communication channel"),this.m_windowCommunicationChannel.close()}constructor(e,t,i){this.m_handshakeReceived=!1,this.m_slideShowReady=!1,this.m_currentSlideState=u.a.Hidden,this.m_currentBootStage="",this.m_hasPendingFrameTrustCheckRequest=!1,this.m_hostSessionId=e,d.m.logger&&(this.m_logger=d.m.logger,s.a.setLogger(this.m_logger)),t&&g.ChangeGate.initSettings({disabledChangeGates:t||""}),this.m_windowCommunicationChannel=new y(n.iframe,this.m_logger),this.m_windowCommunicationChannel.addEventListener(this.onMessage.bind(this)),this.sendAppReadyForPostMessage(),this.m_currentBootStage="SlideShowAppStart";const a={m_id:this.m_hostSessionId,m_type:r.BootStageChanged,m_stageInfo:"SlideShowAppStart"};this.postMessageUpward(a)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var n=i(31),r=i(192),a=i(9),s=i(3),o=i(7),l=i(11);class d{createPodsProxy(e,t,i,r,a){const s={DownloadUrl:e.fileUrl,CustomFontCatalogUrl:e.customFontCatalogUrl,SupportsMultiRangeRequests:t,DocID:e.docId};return new n.f(e.podsUrl,s,e.fileExtension,i,e.presentUrl,r,a)}}var c=i(17),h=i(13),u=i(4),m=i(122),f=i(10),p=i(39),g=i(24),_=i(74),S=i(59),v=i(140),y=i(147),T=i(54),b=i(1),w=i(27),C=i(102);class I{on(e,t){try{if(!this.event)return void a.a.sendTraceTag(506856328,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"CacheableSlideShowUIEvents - event object not available yet, cannot register event: "+e);this.event.on(e,t.bind(this))}catch(t){a.a.sendTraceTag(506856327,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`CacheableSlideShowUIEvents - exception trying to register event ${e}: ${t}.`)}}off(e,t){try{this.event&&this.event.off(e,t)}catch(t){a.a.sendTraceTag(506856326,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`CacheableSlideShowUIEvents - exception trying to unregister event ${e}: ${t}.`)}}emit(e,t){try{if(!this.event||this.shouldCacheEvents)return a.a.sendTraceTag(506856325,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`CacheableSlideShowUIEvents - cache event: ${e})}.`),void this.m_eventCache.push({eventName:e,args:t});this.event.emit(e,t)}catch(t){a.a.sendTraceTag(506856324,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`CacheableSlideShowUIEvents - exception trying to emit event ${e}: ${t}.`)}}flushCachedEvents(){if(this.event)for(let e=0;e<this.m_eventCache.length;e+=1)try{a.a.sendTraceTag(506856322,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`CacheableSlideShowUIEvents - trying to flush event: ${String(this.m_eventCache[e].eventName)}.`),this.event.emit(this.m_eventCache[e].eventName,this.m_eventCache[e].args)}catch(t){a.a.sendTraceTag(506856321,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`CacheableSlideShowUIEvents - exception when flushing ${this.m_eventCache[e].eventName}: ${t}.`)}else a.a.sendTraceTag(506856323,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"CacheableSlideShowUIEvents - trying to flush events without event object.")}constructor(){this.m_eventCache=[],this.shouldCacheEvents=!0}}var P=i(121),E=i(138),x=i(127),k=i(117),M=i(148),A=i(118),R=i(149),O=i(124),F=i(96),D=i(125),L=i(246);class B{static setupGlobals_SlideShowCore(e){if(e.sessionSettings&&e.fileInfo){const t=e.fileInfo.podsUrl+"/RemoteUls.ashx",i=Object(r.a)(e.sessionSettings.appSettings.userSessionId,""+t);Object(c.s)({logger:i,settings:e.sessionSettings.slideShowCoreSettings.settings,disabledChangeGates:e.sessionSettings.slideShowCoreSettings.disabledChangeGates,vetoSessionId:e.sessionSettings.appSettings.userSessionId}),B.globalLogger=c.m.logger;try{Object(n.j)({settings:e.sessionSettings.slideShowCoreSettings.settings})}catch(e){a.a.sendTraceTag(506856471,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - setupGlobals_PodsProxy error: "+e)}}}setInkingActivity(e){this.m_syncAddonsConnector?this.m_syncAddonsConnector.setInkingActivity(e):a.a.sendTraceTag(506856470,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - setInkingActivity is called but no slideShowInkAddon object.")}preloadShaders(){B.preloadShaders()}static preloadShaders(){c.m.preloadShaders()}async init(){a.a.sendTraceTag(506856469,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::init called."),await this.bootSlideShow()}async bootSlideShow(){const e=await this.m_slideShowComponentManager.loadComponentAsync("CommonMonitoring");this.m_sessionSettings.bootMetrics&&(this.m_sessionSettings.bootMetrics.initAppTime=l.a.performanceNowTrimmed(),e.convertBootMetricTimesToPerformanceNowTiming(this.m_sessionSettings.bootMetrics));const t=this.m_slideShowAppSetting&&this.m_slideShowAppSetting.heartbeatTelemetryInterval?this.m_slideShowAppSetting.heartbeatTelemetryInterval:1e3,i=this.m_slideShowAppSetting&&this.m_slideShowAppSetting.maxHeartbeatTelemetryCount?this.m_slideShowAppSetting.maxHeartbeatTelemetryCount:150;e.startHeartbeatTelemetry(t,i,this.m_logger),this.m_slideShowAppSetting.isPresenterExperienceInitialVisible&&l.a.recordSessionStats({everBeenPresenter:this.m_slideShowAppSetting.isPresenterExperienceInitialVisible}),this.setupContainer(this.m_container),await this.loadFile(),this.m_appBootFinished=!0,this.m_slideShowAppEvents.emit("slideShowReady")}async initSlideShowModernUIComponent(){if(this.initSlideShowUISharedToolbarEvents(),this.initSlideShowUISharedGridViewEvents(),this.m_slideShowUIContainers&&this.m_slideShowUIEvents.event&&this.m_slideShowServiceProxy)try{const e=await this.m_slideShowComponentManager.loadComponentAsync("SlideShowUI"),t=this.getSlideLocation();await e.initializeAsync({containerElement:this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer],uiType:"embed",podsProxy:this.m_slideShowServiceProxy,uiEvents:this.m_slideShowUIEvents.event,slideCount:this.getSlideCount(),currentSlideLocation:t})}catch(e){a.a.sendTraceTag(506856468,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::initSlideShowModernUIComponent Exception while loading SlideShowUI: "+e)}}async initSlideShowUIComponents(){if(!this.m_slideShowAppSetting)return;if(this.m_sessionSettings.slideShowCoreSettings.settings){const e=this.m_sessionSettings.slideShowCoreSettings.settings.slideshowui;e&&(b.a.readBooleanOrDefault("enableOpticalZoom",!1)||(e.enableOpticalZoomUI=!1,e.enableDivMenuOption=!1),b.a.readBooleanOrDefault("enableOpticalZoomForPresenter",!1)&&(e.enableOpticalZoomForPresenter=!0),b.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&(e.isZoomSyncEnabled=!0))}PresenterViewUI.setupGlobals_SlideShowUI({settings:this.m_sessionSettings.slideShowCoreSettings.settings}),PresenterViewUI.ChangeGateHelper.initSettings(this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates);let e=PresenterViewUI.HighContrastMode.None;this.m_slideShowAppSetting.toggleHighContrastModeEnabled&&this.m_sessionSettings.slideShowCoreSettings.isHighContrast&&(e=this.getHighContrastModeFromColorSettings(this.m_sessionSettings.slideShowCoreSettings.isHighContrast,this.m_sessionSettings.slideShowCoreSettings.clientColorSettings));const t=this.getSlideLocation(),i={shouldShowByDefault:this.m_slideShowAppSetting.isPresenterExperienceInitialVisible,isRTL:this.m_isRtl,enableNotesFontResizing:this.m_slideShowAppSetting.enableNotesFontResizing,enableNotesPaneResizing:this.m_slideShowAppSetting.enableNotesPaneResizing,highContrastMode:e,startingSlideIndex:t?t.slideIndex:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation?this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation.slideIndex:0,enablethumbnailsAndNotesPrefetch:this.m_slideShowAppSetting.enablethumbnailsAndNotesPrefetch,thumbnailsAndNotesForwardPrefetchCount:this.m_slideShowAppSetting.thumbnailsAndNotesForwardPrefetchCount,thumbnailsAndNotesBackwardPrefetchCount:this.m_slideShowAppSetting.thumbnailsAndNotesBackwardPrefetchCount,shouldShowPresenterViewToggleButtons:this.m_slideShowAppSetting.slideshowPresenterViewToggleEnabled,maxDarkFetchTimes:this.m_slideShowAppSetting.presenterUIMaxDarkFetchTimes,minPresenterUIShowHeight:this.m_slideShowAppSetting.minPresenterUIShowHeight,enableSlideShowToolbarForPresenter:this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter,thumbnailStripMaxChunkAmount:b.a.readNumberOrDefault("thumbnailStripMaxChunkAmount",3),enableThumbnailChunkFetch:b.a.readBooleanOrDefault("enableThumbnailChunkFetch",!1),slideShowViewManagerEnabled:this.m_slideShowAppSetting.slideShowViewManagerEnabled,disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates,settings:this.m_sessionSettings.slideShowCoreSettings.settings,enableDownloadUrlChangedHandler:!0};b.a.readBooleanOrDefault("isClientRehydrationFromLocalStorageEnabled",!1)&&(i.initialSlideShowRole=this.m_slideShowAppSetting.initialSlideShowRole),this.m_slideShowAppSetting.isPresenterExperienceEnabled&&await this.initPresenterViewUIComponents(i);let n=g.b.Presenter;if(n=b.a.readBooleanOrDefault("isClientRehydrationFromLocalStorageEnabled",!1)&&void 0!==this.m_slideShowAppSetting.initialSlideShowRole?this.m_slideShowAppSetting.initialSlideShowRole:this.m_slideShowAppSetting.isPresenterExperienceInitialVisible?g.b.Presenter:g.b.Attendee,b.a.readBooleanOrDefault("enableOpticalZoom",!1)&&b.a.readBooleanOrDefault("enableOpticalZoomUIPopover",!1)&&this.initOpticalZoomPopover(e),this.m_slideShowAppSetting.isResumeSlideShowExperienceEnabled){const i={shouldShowByDefault:!1,isRTL:this.m_isRtl,startingSlideIndex:t?t.slideIndex:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation?this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation.slideIndex:0,shouldResumeDialogShowByDefault:this.m_slideShowAppSetting.isPresenterExperienceInitialVisible,initialSlideShowRole:n,highContrastMode:e,enableDownloadUrlChangedHandler:!0};this.initResumeSlideShowComponent(i)}if(b.a.readBooleanOrDefault("forceSvg",!1)){const e=document.getElementById("ppt-slideshow-app-area");e&&this.m_isRtl&&(e.style.direction="ltr")}if(this.m_slideShowAppSetting.isGridViewExperienceEnabled||this.m_slideShowAppSetting.isGridViewExperienceEnabledForPresentersOnly){const t={shouldShowByDefault:!1,isRTL:this.m_isRtl,highContrastMode:e,shouldEnableGridViewForPresentersOnly:this.m_slideShowAppSetting.isGridViewExperienceEnabledForPresentersOnly,shouldEnableGridViewForPresentersAndAttendees:this.m_slideShowAppSetting.isGridViewExperienceEnabled,disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates,gridViewMaxChunkAmount:this.m_slideShowAppSetting.gridViewMaxChunkAmount,settings:this.m_sessionSettings.slideShowCoreSettings.settings,enableDownloadUrlChangedHandler:!0};await this.initGridViewComponent(t)}if((this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter||this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee)&&(a.a.sendTraceTag(506856467,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Initializing toolbar. Toolbar enabled for presenter: ${this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter}. Toolbar enabled for attendee: ${this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee}`),await this.initSlideShowToolbar()),u.ChangeGate.isChangeGateEnabled("SSA.enableToolbarKeyboardNavigation")&&this.m_slideShowUIEvents.on("setPrivateViewingToggle",e=>{a.a.sendTraceTag(506856466,s.a.msoulscat_Wac_PptLive,o.a.Info,`SlideShowApp::setPrivateViewingToggle - m_toolbarKeyboardInputAddon: ${this.m_toolbarKeyboardInputAddon?"defined":"undefined"}, m_slideShowTopKeyboardInputAddon: ${this.m_slideShowTopKeyboardInputAddon?"defined":"undefined"}, isPresenter: ${this.m_isPresenter}, PrivateViewingEnabled: ${e}.`),this.m_toolbarKeyboardInputAddon&&this.m_slideShowTopKeyboardInputAddon&&!this.m_isPresenter&&(e?(this.m_toolbarKeyboardInputAddon.enableKeyboardInput(),this.m_slideShowTopKeyboardInputAddon.enableKeyboardInput()):(this.m_toolbarKeyboardInputAddon.disableKeyboardInput(),this.m_slideShowTopKeyboardInputAddon.disableKeyboardInput()))}),this.m_slideShowAppSetting&&this.m_slideShowAppSetting.enableMovePresenterNameToPPT&&this.m_slideShowUIEvents){const e=this.getSlideViewBounds();new PresenterViewUI.PresenterName(this.m_container,e,this.slideshowAppContainerId,this.m_slideShowUIEvents,this.m_logger)}u.ChangeGate.isChangeGateEnabled("SSC.TabFocusManagerPresenterViewApp")&&await this.initTabFocusManager(),u.ChangeGate.isChangeGateEnabled("SSC.MoveFlushEventsCall")||(this.m_slideShowUIEvents.flushCachedEvents(),this.m_slideShowUIEvents.shouldCacheEvents=!1)}async postBoot(e){try{if(this.m_logger){const e=window.innerWidth,t=window.innerHeight;a.a.sendTraceTag(506856465,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`SlideShowApp - log client resolution: width:${e}, height:${t}`)}const t=[];if(e&&(this.m_slideShowUIEvents.event=e,this.m_slideShowMediaAddon&&(t.push("MediaAddon"),this.m_slideShowMediaAddon.slideShowUIEvents=this.m_slideShowUIEvents),this.m_presenterSyncAddon&&(t.push("PresenterSyncAddon"),this.m_presenterSyncAddon.slideShowUIEvents=this.m_slideShowUIEvents),this.m_slideViewBoundsHelper&&(t.push("SlideViewBoundsHelper"),this.m_slideViewBoundsHelper.slideShowUIEvents=this.m_slideShowUIEvents),this.m_opticalZoomSyncHandlerAddon&&(t.push("OpticalZoomSyncHandlerAddon"),this.m_opticalZoomSyncHandlerAddon.registerSlideShowUIListeners()),a.a.sendTraceTag(506856464,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - set slideShowUIEvents for these addons during postBoot: "+t.toString())),f.a.addToQosPillar("Interruptions"),f.a.addToQosPillar("Fidelity"),f.a.addToQosPillar("Present"),b.a.readBooleanOrDefault("enableSlideShowModernUI",!1)?await this.initSlideShowModernUIComponent():await this.initSlideShowUIComponents(),u.ChangeGate.isChangeGateEnabled("SSC.MoveFlushEventsCall")&&(this.m_slideShowUIEvents.flushCachedEvents(),this.m_slideShowUIEvents.shouldCacheEvents=!1),this.m_clockSkewCalculator.beginCalculateSkewLoop(),b.a.readBooleanOrDefault("runResourceLoadTest",!1))try{this.m_logger.sendTraceTag(506856463,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"loadResourceTest value "+ResourceLoadTest.ResourceLoadTest.Success)}catch(e){this.m_logger.sendTraceTag(506856462,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"loadResourceTest caught exception "+e)}}catch(e){this.m_logger&&this.m_logger.sendTraceTag(506856461,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - exception in postBoot: "+e),this.m_slideShowAppEvents.emit("slideshowError",c.n.PostBootFailed)}}onCameraButtonPressed(e){this.m_syncAddonsConnector&&this.m_syncAddonsConnector.updateCameraState(e)}changeCameraState(e){this.m_syncAddonsConnector&&this.m_syncAddonsConnector.updateCameraState(e),this.m_slideShowUIEvents.emit("cameraStateChanged",e)}changeSubtitlesState(e){this.m_slideShowUIEvents.emit("subtitlesStateChanged",e)}renderDynamicWatermark(e){var t;if(this.m_dynamicWatermarkLabel=e,null===(t=this.m_dynamicWatermarkLabel)||void 0===t||!t.length)return void a.a.sendTraceTag(506323680,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - Dynamic watermark Label is empty. Skip rendering.");const i=[this.m_parent];if(this.m_slideShowUIContainers){const e=this.m_slideShowUIContainers;e[g.c.NotesPane]&&i.push(e[g.c.NotesPane]),e[g.c.ThumbnailStrip]&&i.push(e[g.c.ThumbnailStrip]),e[g.c.GridView]&&i.push(e[g.c.GridView])}for(const e of i)L.a.createWatermark({watermarkArgsData:{watermarkElement:e},watermarkText:this.m_dynamicWatermarkLabel}).then(()=>{a.a.sendTraceTag(506323679,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - Dynamic watermark rendered successfully for div "+e.id)}).catch(e=>{a.a.sendTraceTag(506323678,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - exception in rendering dynamic watermark: "+e)})}async initTabFocusManager(){if(this.m_slideShowUIContainers&&this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer]){const e=this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer];this.m_tabFocusManager=new PresenterViewUI.TabFocusManager(e),this.m_tabFocusManager.pushContainer(this.m_slideShowUIContainers[g.c.SlideShowAndToolbarContainer],!0,!0,g.a.SlideShowAndToolbar),this.m_tabFocusManager.pushContainer(this.m_slideShowUIContainers[g.c.ThumbnailStrip],!0,!0,g.a.ThumbnailStrip),this.m_tabFocusManager.pushContainer(this.m_slideShowUIContainers[g.c.NotesPane],!0,!0,g.a.NotesPane);const t=this.m_slideShowUIContainers[g.c.ThumbnailStrip],i=this.m_slideShowUIContainers[g.c.SlideShowToolbar],n=document.getElementsByClassName("toolbar-button-container-visible");t&&i&&n&&n.length>0&&t.addEventListener("keydown",e=>{e.shiftKey&&"tab"===e.key.toLowerCase()&&document.activeElement&&document.activeElement.id.includes("grid-content-view")&&(e.preventDefault(),i?n[n.length-1].focus():i.focus())})}}async initPresenterViewUIComponents(e){if(a.a.sendTraceTag(506856457,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::initSlideShowUIComponents called."),!this.m_slideShowUIContainers||!this.m_slideShowUIContainers[g.c.ThumbnailStrip]||!this.m_slideShowUIContainers[g.c.NotesPane])return void a.a.sendTraceTag(506856456,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::initSlideShowUIComponents no slideshow ui related containers.");const t=l.a.performanceNowTrimmed(),i={};i.isPVShowByDefault=this.m_slideShowAppSetting.isPresenterExperienceInitialVisible;const n=l.a.performanceNowTrimmed();await this.initSlideShowUIDefaultResourceProvider();const r=l.a.performanceNowTrimmed();if(i.ssuiInitProvider={start:n,end:r},this.m_slideShowUIEvents&&this.m_slideShowUIResourceProvider){if(this.m_slideShowUIEvents.on("thumbnailSelectionChanged",e=>{try{const t={navigationType:c.g.GoTo,navMetrics:{navTrigger:"thumbnailSelectionChanged"}};this.gotoSlide(e,t,void 0,!0)}catch(e){a.a.sendTraceTag(506856455,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - exception in thumbnailSelectionChanged handler: "+e)}}),this.m_thumbnailStrip=new PresenterViewUI.ThumbnailStrip(this.m_slideShowUIContainers[g.c.ThumbnailStrip],e,this.m_slideShowUIEvents,this.m_slideShowUIResourceProvider,this.m_logger),this.m_thumbnailStrip.init(),this.m_timer=new PresenterViewUI.TimerComponent(this.m_logger),this.m_timer.renderComponent(),u.ChangeGate.isChangeGateEnabled("PresenterViewEducationToastMessageInPopUpWindow")){this.m_educationToast=new PresenterViewUI.EducationToastComponent(this.m_logger);const e=this.m_sessionSettings.slideShowCoreSettings.presenterViewEducationToastMessageHeadingForPopUpWindow||this.c_educationToastMessageHeading,t=this.m_sessionSettings.slideShowCoreSettings.presenterViewEducationToastMessageBodyForPopUpWindow||this.c_educationToastMessageBody;this.m_educationToast.renderComponent(e,t)}this.m_notesPane=new PresenterViewUI.NotesPane(this.m_slideShowUIContainers[g.c.NotesPane],e,this.m_slideShowUIEvents,this.m_slideShowUIResourceProvider,this.m_logger),this.m_notesPane.init();const n=l.a.performanceNowTrimmed();i.initSSUIComponents={start:t,end:n},l.a.recordSessionStats(i)}}async initGridViewComponent(e){this.m_slideShowUIEvents&&this.initSlideShowUISharedGridViewEvents(),this.m_slideShowAppSetting.isPresenterExperienceEnabled||await this.initSlideShowUIDefaultResourceProvider(),this.m_slideShowUIEvents&&this.m_slideShowUIContainers&&this.m_slideShowUIResourceProvider&&this.m_slideShowUIContainers[g.c.GridView]&&(this.m_gridView=new PresenterViewUI.GridView(this.m_slideShowUIContainers[g.c.GridView],this.m_slideShowUIContainers,e,this.m_slideShowUIEvents,this.m_slideShowUIResourceProvider,this.m_logger),this.m_gridView.init())}onGridViewSlideSelected(e){try{const t={navigationType:c.g.GoTo,navMetrics:{navTrigger:"gridViewSlideSelected"}};p.a.trackLastUserInputNavigation({navType:c.g.GoTo,source:c.p.API},this.sessionUTC),this.gotoSlide(e,t,void 0,!0),this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("gridViewToggled",!1),a.a.sendTraceTag(506856452,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - GridView slide selected with index: "+e.slideIndex)}catch(e){a.a.sendTraceTag(506856451,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - exception in gridViewSlideSelected handler: "+e)}}initSlideShowUISharedGridViewEvents(){this.m_slideShowUIEvents&&this.m_slideShowUIEvents.on("gridViewSlideSelected",e=>this.onGridViewSlideSelected(e))}initSlideShowUISharedToolbarEvents(){this.m_slideShowUIEvents&&(this.m_slideShowUIEvents.on("prevStepClicked",()=>{try{const e={PPTUI_Local_Nav_Next:this.sessionUTC};this.prevStep(void 0,e)}catch(e){a.a.sendTraceTag(506856450,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in prevStepClicked handler: "+e)}}),this.m_slideShowUIEvents.on("nextStepClicked",()=>{try{const e={PPTUI_Local_Nav_Next:this.sessionUTC};this.nextStep(void 0,e)}catch(e){a.a.sendTraceTag(506856449,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in nextStepClicked handler: "+e)}}),this.m_slideShowUIEvents.on("cameraButtonPressed",e=>{this.onCameraButtonPressed(e),this.slideShowAppEvents.emit("cameraStateChanged",e)}),this.m_slideShowUIEvents.on("subtitlesButtonPressed",e=>{this.slideShowAppEvents.emit("subtitlesStateChanged",e)}))}initSlideShowToolbar(){let e=PresenterViewUI.HighContrastMode.None;this.m_sessionSettings.slideShowCoreSettings.isHighContrast&&(e=this.getHighContrastModeFromColorSettings(this.m_sessionSettings.slideShowCoreSettings.isHighContrast,this.m_sessionSettings.slideShowCoreSettings.clientColorSettings));const t=this.m_slideShowAppSetting.isPresenterExperienceInitialVisible,i=this.getSlideLocation(),n={shouldShowByDefault:t&&this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter||!t&&this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee,isRTL:this.m_isRtl,highContrastMode:e,shouldShowHighContrastToggleButton:this.m_slideShowAppSetting.slideShowModernToolbarHighContrastToggleButtonEnabled,shouldShowTranslateButton:this.m_slideShowAppSetting.slideShowModernToolbarTranslateButtonEnabled,shouldShowPrivateViewingToggleButton:this.m_slideShowAppSetting.slideShowModernToolbarPrivateViewingToggleButtonEnabled,shouldShowGridViewToggleButton:this.m_slideShowAppSetting.slideShowModernToolbarShowGridViewToggleButton,startingSlideIndex:i?i.slideIndex:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation?this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation.slideIndex:0,enableSlideShowToolbarForPresenter:this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter,enableSlideShowToolbarForAttendee:this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee,enablePPTLiveCopyLinkInPresenterView:this.m_slideShowAppSetting.pptLiveCopyLinkEnabledInPresenterView,enablePPTLiveCopyLinkToChatInPresenterView:this.m_slideShowAppSetting.pptLiveCopyLinktoChatEnabledInPresenterView,enableSvgIcons:this.m_slideShowAppSetting.slideShowToolbarSvgIconsEnabled,shouldShowPresenterViewToggleButtons:this.m_slideShowAppSetting.slideshowPresenterViewToggleEnabled,shouldShowAnnotationsToggleButton:this.m_slideShowAppSetting.isAnnotationsUIEnabled,shouldShowCoachButton:this.m_slideShowAppSetting.enableCoach,slideShowViewManagerEnabled:this.m_slideShowAppSetting.slideShowViewManagerEnabled,enableMovePrivateViewingToPPT:this.m_slideShowAppSetting.isMovePrivateViewingToPPTEnabled,enableAnnotationsStrokeArrowHead:this.m_slideShowAppSetting.isInstantArrowEnabled,enableAnnotationsInkEffectPen:this.m_slideShowAppSetting.isInkEffectPensEnabled,enableMoveTakeControlButtonToPPT:this.m_slideShowAppSetting.enableMoveTakeControlButtonToPPT,jsScriptsBasePath:this.m_slideShowAppSetting.jsScriptsBasePath,enableDownloadUrlChangedHandler:!0,minimumZoom:b.a.readNumberOrDefault("minimumZoom",1),maximumZoom:b.a.readNumberOrDefault("maximumZoom",2),settings:this.m_sessionSettings.slideShowCoreSettings.settings};if((this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter||this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee)&&this.m_slideShowUIEvents&&this.m_slideShowUIContainers){a.a.sendTraceTag(506856448,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - Toolbar enabled for Presenter");const e=u.ChangeGate.isChangeGateEnabled("SSA.enableUpdateToolbarPositionDuringInit")?this.getSlideViewBounds():void 0;b.a.readBooleanOrDefault("isClientRehydrationFromLocalStorageEnabled",!1)&&(void 0!==this.m_slideShowAppSetting.initialSlideShowRole?n.initialSlideShowRole=this.m_slideShowAppSetting.initialSlideShowRole:n.initialSlideShowRole=this.m_slideShowAppSetting.isPresenterExperienceInitialVisible?g.b.Presenter:g.b.Attendee),this.m_slideShowToolbar=new PresenterViewUI.SlideShowToolbar(this.m_slideShowUIContainers[g.c.SlideShowToolbar],n,this.m_slideShowUIEvents,this.m_logger,this.getSlideCount(),this.m_slideShowUIResourceProvider,this.m_slideShowAppSetting.slideShowViewManagerEnabled?new PresenterViewUI.SlideShowViewManager(n,n.initialSlideShowRole?n.initialSlideShowRole:g.b.Attendee,this.m_slideShowUIEvents,this.m_logger):void 0,e)}else a.a.sendTraceTag(506856419,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Toolbar not initialized: slideShowToolbarenabledForPresenter: ${this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter},\n        slideShowToolbarEnabledForAttende: ${this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee},\n        isSlideShowUIEvents empty:${this.m_slideShowUIEvents}, isSlideShowContainersEmpty: ${this.m_slideShowUIContainers}`);this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter&&this.m_slideShowUIEvents&&(this.initSlideShowUISharedToolbarEvents(),this.m_slideShowUIEvents.on("highContrastContentChanged",async e=>{try{const t=e===PresenterViewUI.HighContrastMode.HighContrastBlack,i=t?c.c.BlackColorTheme:c.c.None;await this.changeSlideShowContent(t,i)}catch(e){a.a.sendTraceTag(506856418,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in highContrastContentChanged handler: "+e)}}),this.m_slideShowUIEvents.on("contentLanguageChanged",async e=>{try{await this.translateSlideShowContent(e),a.a.sendTraceTag(506856417,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp -contentLanguageChanged triggered "+e)}catch(e){a.a.sendTraceTag(506856416,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in contentLanguageChanged handler: "+e)}}),this.m_slideShowUIEvents.on("showWeatherPerson",e=>{this.m_slideShowAppEvents.emit("showWeatherPerson",e)}),this.m_slideShowUIEvents.on("returnToPresenter",()=>{this.m_slideShowAppEvents.emit("returnToPresenter")}),this.m_slideShowUIEvents.on("takeControl",()=>{this.m_slideShowAppEvents.emit("takeControl")}),this.m_slideShowUIEvents.on("privateViewingToggled",e=>{this.m_slideShowAppEvents.emit("privateViewingToggled",e)}),this.m_slideShowUIEvents.on("presenterUIToggled",e=>{this.m_slideShowAppSetting.slideshowPresenterViewToggleEnabled&&this.updatePresenterUIToggledClass(e)}),b.a.readBooleanOrDefault("enableOpticalZoom",!1)&&b.a.readBooleanOrDefault("enableOpticalZoomUI",!1)&&(this.m_slideShowUIEvents.on("zoomInPressed",()=>{if(this.m_slideshowCore){const e=this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel;this.m_slideshowCore.zoomToAsync(1.15*e,void 0,{source:c.h.UIPlus})}}),this.m_slideShowUIEvents.on("zoomOutPressed",()=>{if(this.m_slideshowCore){const e=this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel;this.m_slideshowCore.zoomToAsync(1/1.15*e,void 0,{source:c.h.UIMinus})}})),this.m_slideShowUIEvents.on("setInkState",e=>{try{this.setInkState(e)}catch(e){a.a.sendTraceTag(506856415,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in setInkState handler: "+e)}}),this.m_slideShowUIEvents.on("setInkArrowMode",e=>{try{this.setInkArrowMode(e)}catch(e){a.a.sendTraceTag(506856414,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in setInkArrowMode handler: "+e)}}),this.m_slideShowUIEvents.on("inkEraseAll",()=>{try{this.m_slideShowInkAddon&&this.m_slideShowInkAddon.onInkManagerActivity({item:"EraseAll"})}catch(e){a.a.sendTraceTag(506856413,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in ink erase all handler: "+e)}}),this.m_slideShowUIEvents.on("penColorChanged",e=>{try{this.changeInkColor(e.tool,e.value)}catch(e){a.a.sendTraceTag(506856412,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in ink color change handler: "+e)}}),this.m_slideShowUIEvents.on("penThicknessChanged",e=>{try{this.changeInkSize(e.tool,e.value)}catch(e){a.a.sendTraceTag(506856411,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in ink thickness change handler: "+e)}}),this.m_slideShowUIEvents.on("setInkInputType",e=>{try{this.setInkInputType(e)}catch(e){a.a.sendTraceTag(506856410,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in ink setInkInputType handler: "+e)}}),this.m_slideShowUIEvents.on("copyFileLink",()=>{this.m_slideShowAppEvents.emit("copyFileLink")}),this.m_slideShowUIEvents.on("copyFileLinktoChat",()=>{this.m_slideShowAppEvents.emit("copyFileLinktoChat")}),this.m_slideShowUIEvents.on("turnOnCoach",()=>{this.m_slideShowAppEvents.emit("turnOnCoach")}),this.m_slideShowUIEvents.on("turnOffCoach",()=>{this.m_slideShowAppEvents.emit("turnOffCoach")}),this.m_slideShowUIEvents.on("checkCoachStatus",()=>{this.m_slideShowAppEvents.emit("checkCoachStatus")}))}initResumeSlideShowComponent(e){if(this.m_slideShowUIEvents&&this.m_slideShowUIContainers&&this.m_slideShowUIContainers[g.c.ResumeSlideShow]&&this.m_container){this.m_slideShowUIEvents.on("resumeSlideShowClicked",e=>{this.gotoSlide(e,void 0,void 0,!0)});const t=this.m_slideShowAppSetting.teamsCallId||"",i=this.m_slideShowAppSetting.resumeSlideShowCacheKey||"";this.m_resumeSlideShow=new PresenterViewUI.ResumeSlideShow(this.m_slideShowUIContainers[g.c.ResumeSlideShow],e,this.m_slideShowUIEvents,i,t,this.m_logger,this.m_container),this.m_resumeSlideShow.init(),this.m_slideShowUIEvents.emit("slideShowReady")}}initOpticalZoomPopover(e){this.m_slideShowUIContainers&&this.m_slideShowUIContainers[g.c.OpticalZoomPopover]&&(this.m_opticalZoomPopover=new PresenterViewUI.OpticalZoomPopover(this.m_slideShowUIContainers[g.c.OpticalZoomPopover],this.m_slideShowUIEvents,this.m_logger,this.getSlideViewBounds(),e),this.m_opticalZoomPopover.init())}async initSlideShowUIDefaultResourceProvider(){this.m_slideShowServiceProxy&&(this.m_slideShowUIResourceProvider=new PresenterViewUI.SlideShowUIDefaultResourceProvider(this.m_slideShowServiceProxy,this.m_logger),await this.m_slideShowUIResourceProvider.init())}get slideShowAppEvents(){return this.m_slideShowAppEvents}get logger(){return this.m_logger}get sessionInfo(){return this.m_sessionInfo}get slideShowInkAddon(){return this.m_slideShowInkAddon}setupContainer(e){this.m_slideShowAppSetting.toggleHighContrastModeEnabled&&null!=this.m_sessionSettings.slideShowCoreSettings.isHighContrast&&this.updateAppColorThemeClass(this.m_sessionSettings.slideShowCoreSettings.isHighContrast,this.m_sessionSettings.slideShowCoreSettings.clientColorSettings),this.m_slideShowAppSetting&&this.m_slideShowAppSetting.isPresenterExperienceEnabled&&this.updateSlideShowAppRoleClass(this.m_slideShowAppSetting.isPresenterExperienceInitialVisible?g.b.Presenter:g.b.Attendee),this.setupAppContainer(e),this.setupSlideContainer(e)}setupAppContainer(e){e.classList.add("slideshow-app-container"),b.a.readBooleanOrDefault("RepositioningPPTLiveSlideShowToolbar",!0)&&e.classList.add("new-toolbar-reposition-css")}setupSlideContainer(e){b.a.readBooleanOrDefault("shrinkSlideForAPL",!1)?(this.m_slideAreaContainer=document.createElement("div"),this.m_slideAreaContainer.id=this.slideshowAppContainerId,this.m_slideAreaContainer.style.height="100%",this.m_slideAreaContainer.setAttribute("role","presentation"),b.a.readBooleanOrDefault("aplAXFixes",!1)||this.m_slideAreaContainer.classList.add(this.slideContainerClassName),e.appendChild(this.m_slideAreaContainer),this.m_container=document.createElement("div"),this.m_container.id="slide-container",this.m_container.classList.add(this.slideshowContainerUnShrinkClassName),b.a.readBooleanOrDefault("aplAXFixes",!1)&&this.m_container.classList.add(this.slideContainerClassName),this.m_slideAreaContainer.appendChild(this.m_container)):(this.m_container=document.createElement("div"),this.m_container.style.height="100%",this.m_container.setAttribute("role","presentation"),this.m_container.classList.add(this.slideContainerClassName),this.m_container.id=this.slideshowAppContainerId,e.appendChild(this.m_container)),b.a.readBooleanOrDefault("restrictInputsRegionForSSA",!1)?(this.m_inputsRegion.id="slideshow-container-inputs-region",this.m_inputsRegion.style.pointerEvents="auto",this.m_container.appendChild(this.m_inputsRegion)):this.m_container.tabIndex=0}rehydrateClientApp(){if(this.m_globalStateManager){const e=this.m_globalStateManager.fetchGlobalStateForCurrentSharingSession();e&&e.LocalAppState&&e.LocalAppState.role===g.b.PrivateViewing&&(a.a.sendTraceTag(506856409,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`SlideShowApp:rehydrateClient: updating SessionSettings.initialSlideShowRole from\n              ${this.m_sessionSettings.appSettings.initialSlideShowRole} to ${e.LocalAppState.role}`),a.a.sendTraceTag(506856408,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`SlideShowApp:rehydrateClient: updating SessionSettings.isPresenterExperienceInitialVisible from\n              ${this.m_sessionSettings.appSettings.isPresenterExperienceInitialVisible} to false`),this.m_sessionSettings.appSettings.initialSlideShowRole=e.LocalAppState.role,this.m_sessionSettings.appSettings.isPresenterExperienceInitialVisible=!1,this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation=e.LocalAppState.currentSlideLocation,this.m_sessionSettings.slideShowCoreSettings.startingAnimationState=e.LocalAppState.currentAnimationState,e.LocalAppState.globalSyncState)}}async loadFile(){a.a.sendTraceTag(506856407,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::loadFile called."),this.m_providers=new c.d(this.m_podsProxy,this.m_logger,{retryCount:this.m_slideShowAppSetting.getItemsRetryCount&&this.m_slideShowAppSetting.getItemsRetryCount>0?this.m_slideShowAppSetting.getItemsRetryCount:3,retryOnCategories:this.m_slideShowAppSetting.getItemsRetryCategories?this.m_slideShowAppSetting.getItemsRetryCategories.split(";"):["Transient","ErrorCannotRender"],settings:this.m_sessionSettings.slideShowCoreSettings.settings,disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates});const e=void 0!==this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(void 0!==this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation.slideId||void 0!==this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation.slideIndex&&this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation.slideIndex>=0);e||(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation=void 0),b.a.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&(this.m_sessionSettings.slideShowCoreSettings.showCustomPlayButtonForVideo=this.m_slideShowAppSetting.isPresenterExperienceEnabled);const t=b.a.readBooleanOrDefault("restrictInputsRegionForSSA",!1)?this.m_inputsRegion:this.m_container;this.m_slideshowCore=new c.m(t,this.m_providers,this.m_logger,this.m_sessionSettings),this.m_slideShowCoreConnector=new O.a(this.m_slideshowCore,this.m_slideShowAppEvents),this.m_slideshowCore.events.on("networkHealthChanged",e=>{this.m_providers&&this.m_providers.setNetworkHealth(e.isHealthy)}),this.m_slideshowCore.events.on("slideLocationChanged",()=>{const e=document.activeElement;this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("slideStateChanged",{slideLocation:this.getSlideLocation()}),this.restoreFocusToPreviousElement(e)}),this.m_slideshowCore.events.on("logSessionEnd",()=>{this.m_slideShowAppSetting.isPresenterExperienceEnabled&&this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("logSessionEnd"),p.a.logSessionEndPrivateViewingTelemetry()}),this.m_slideShowAppEvents.on("roleChanged",e=>{if(this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("roleChanged",e),this.onRoleChangedWithOpticalZoom(e),u.ChangeGate.isChangeGateEnabled("SSA.weatherPersonPrivateViewing")){const t=e!==g.b.PrivateViewing;this.m_slideShowAppEvents.emit("showWeatherPerson",{show:t,metadata:{source:"roleChange_"+e}})}}),this.m_slideshowCore.events.on("renderingModeChangedToSVG",()=>{if(b.a.readBooleanOrDefault("forceSvg",!1)){const e=document.getElementById("ppt-slideshow-app-area");e&&this.m_isRtl&&(e.style.direction="ltr")}}),this.m_slideshowCore.events.on("slideDimensionsChanged",()=>{this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("slideDimensionsChanged",this.getSlideViewBounds())}),this.m_slideshowCore.events.on("annotationStartCloseMenus",()=>{this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("dismissPopupMenus")}),this.m_slideshowCore.events.on("slideShowAnnotationEvent",e=>{if(!this.m_slideShowUIEvents||e.eventType!==w.a.LaserStart&&e.eventType!==w.a.WetStrokeStart||this.m_slideShowUIEvents.emit("dismissPopupMenus"),this.m_slideShowAppSetting.isInstantInkingBehaviorEnabled&&this.m_slideShowInkAddon&&this.m_slideShowUIEvents&&("pen"===this.m_slideShowInkAddon.pickToolInputType||void 0===this.m_slideShowInkAddon.pickToolInputType)&&(e.eventType===w.a.WetStrokeStart||e.eventType===w.a.LaserStart)){const e={tool:this.m_slideShowInkAddon.activeInkingTool,value:T.a.Pressed.toString()};this.m_slideShowUIEvents.emit("inkToolStateChanged",e)}}),this.m_slideshowCore.events.on("inkToolStateChanged",e=>{if(this.m_slideShowUIEvents){const t={tool:e.tool,value:e.state.toString()};this.m_slideShowUIEvents.emit("inkToolStateChanged",t)}}),b.a.readBooleanOrDefault("isZoomSyncEnabled",!1)||this.m_slideshowCore.events.on("opticalZoomStateChanged",e=>{this.m_slideShowAppEvents.emit("opticalZoomStateChanged",e),this.m_slideShowUIEvents.emit("opticalZoomStateChanged",e.currentState.zoomLevel)}),this.m_slideshowCore.events.on("exitFromEndOfShow",()=>{window.parent.opener.postMessage({type:"exitPresenterView"},window.location.origin)});const i=this.m_slideshowCore;if(this.m_slideShowComponentManager.loadComponentAsync("CommonMonitoring").then(e=>{e.addEvents(i)}),new c.i(this.m_slideshowCore,this.m_logger,this.m_sessionSettings.slideShowCoreSettings.prefetchOptions),await this.initSlideShowCore(),this.m_slideshowCore&&this.m_slideshowCore.setGlobalMute(!0),!e){const e=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0;a.a.sendTraceTag(506856406,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - gotoFirstSlide called."),await this.m_slideshowCore.gotoFirstSlide(!0,{startFromTime:e,bootMetrics:this.m_sessionSettings.bootMetrics})}b.a.readBooleanOrDefault("slideAdvanceAddonEnabled",!1)&&new c.l(this.m_slideshowCore,this.m_logger),new c.b(this.m_slideshowCore,this.m_sessionSettings,this.m_logger,{appEvents:this.slideShowAppEvents,sharingLayoutMode:this.m_sharingLayoutMode}),new c.q(this.m_slideshowCore,this.m_sessionSettings,this.m_logger,{appEvents:this.slideShowAppEvents,sharingLayoutMode:this.m_sharingLayoutMode}),new C.a(this.m_slideshowCore,this.m_sessionSettings,this.m_logger),this.m_slidePerfAddon=new E.a(this.m_slideshowCore,this.m_sessionSettings,this.m_logger,()=>this.getCameoManagerState(),{appEvents:this.slideShowAppEvents,sharingLayoutMode:this.m_sharingLayoutMode});const n=new P.a(this.m_slideshowCore),r=void 0===this.m_slideShowAppSetting.enableAdvanceOnClick||this.m_slideShowAppSetting.enableAdvanceOnClick,l=void 0===this.m_slideShowAppSetting.enableKeyboardNavigation||this.m_slideShowAppSetting.enableKeyboardNavigation;this.setNavigationOptions(r,l),this.m_slideShowMediaAddon=new c.f(this.m_slideshowCore,this.m_logger,this.slideShowAppEvents,this.m_slideShowAppSetting.isPresenterExperienceInitialVisible?g.b.Presenter:g.b.Attendee,this.m_slideShowUIEvents);const d=this.m_slideShowAppSetting.slideShowInkJsFilePath?this.m_slideShowAppSetting.slideShowInkJsFilePath:"",h=this.m_slideShowAppSetting.isPresenterExperienceInitialVisible?g.b.Presenter:g.b.Attendee;b.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&(this.m_opticalZoomSyncHandlerAddon=new k.a(this.m_slideshowCore,h,this.slideShowAppEvents,this.m_slideShowUIEvents)),this.m_slideShowInkAddon=new _.g(this.m_slideshowCore,this.m_logger,b.a.readBooleanOrDefault("restrictInputsRegionForSSA",!1)?this.m_inputsRegion:this.m_container,()=>new Promise((e,t)=>{const i=document.createElement("script");i.addEventListener("error",t),i.addEventListener("load",e),i.type="text/javascript",i.src=d,document.body.appendChild(i),this.m_slideShowInkAddon&&b.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&this.m_slideShowInkAddon.updateRole(h)}),this.m_slideShowAppSetting,Boolean(this.m_sessionSettings.slideShowCoreSettings.isHighContrast),this.m_slideShowAppEvents),this.m_slideShowInkAddon.updateSlideShowInkJsName(y.basename(d,"js")),(!this.m_slideShowAppSetting.isPresenterExperienceInitialVisible||u.ChangeGate.isChangeGateEnabled("SSA.disableLocalInkWithNoUI")&&!this.m_slideShowAppSetting.isAnnotationsUIEnabled)&&this.m_slideShowInkAddon.enableLocalInking(!1),this.m_slideShowAppSetting.isInstantInkingBehaviorEnabled&&(this.m_slideShowInkAddon.setDefaultToCursor(),this.m_slideShowAppSetting.isPresenterExperienceInitialVisible&&this.m_slideShowInkAddon.startCursorAtInit()),this.m_syncAddonsConnector=new F.a(this.m_slideShowMediaAddon,this.m_slideShowInkAddon,n,this.m_slideshowCore.events,!!this.m_slideShowAppSetting.isInstantInkingBehaviorEnabled),(h!==g.b.Presenter||b.a.readBooleanOrDefault("enableOpticalZoomForPresenter",!1))&&(this.m_slideshowCore.enableOpticalZoom=!0),this.m_slideViewBoundsHelper=new v.a(this.m_slideshowCore,this.m_slideShowAppEvents,this.m_slideShowUIEvents),f.d.recordUserAction({actionName:"OpenDocument"})}getSlideCount(){if(this.m_slideShowCoreConnector)return a.a.sendTraceTag(506856405,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::getSlideCount called."),this.m_slideShowCoreConnector.getSlideCount();throw"Invalid slideshowCore"}async nextStep(e,t){this.m_slideShowCoreConnector&&(await this.m_slideShowCoreConnector.nextStep(e),t&&(t.navDistance=1,p.a.logNavigationPromiseCompletedMetadata(t,this.sessionUTC,this.skew,this.sessionInfo.uiHostRing)))}async prevStep(e,t){this.m_slideShowCoreConnector&&(await this.m_slideShowCoreConnector.prevStep(e),t&&(t.navDistance=1,p.a.logNavigationPromiseCompletedMetadata(t,this.sessionUTC,this.skew,this.sessionInfo.uiHostRing)))}async prevSlide(e){this.m_slideShowCoreConnector&&await this.m_slideShowCoreConnector.prevSlide(e)}async nextSlide(e){this.m_slideShowCoreConnector&&await this.m_slideShowCoreConnector.nextSlide(e)}setLaserPointerActivation(e,t){if(this.m_slideShowToolbar){const t=e?PresenterViewUI.InkingTools.LaserPointer:PresenterViewUI.InkingTools.Select,i=this.m_slideShowToolbar.getInkState(t);this.m_slideShowUIEvents.emit("setInkState",i)}this.m_logger&&this.m_logger.sendTraceTag(506856404,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,JSON.stringify(t))}setBlankSlideState(e){this.m_slideShowCoreConnector&&this.m_slideShowCoreConnector.setBlankSlideState(e)}logInkEvent(e){a.a.sendTraceTag(506856403,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Ink activity created:  type=${e}.`)}async setInkArrowMode(e){this.m_slideShowInkAddon&&await this.m_slideShowInkAddon.perform({name:"inkArrowMode",value:e.toString()})}async setInkState(e){if(this.m_slideShowInkAddon)if(e.tool===PresenterViewUI.InkingTools.Pen){const t="Pen",i=e.value,n=void 0===i.colorHex?_.e:i.colorHex,r=void 0===i.thickness?_.f:i.thickness,a=void 0===i.effectPattern?_.a:i.effectPattern;this.logInkEvent(t),await this.m_slideShowInkAddon.ensureInkManagerActivity({item:t,value:{colorHex:n,thickness:r,effectPattern:a}})}else if(e.tool===PresenterViewUI.InkingTools.Highlighter){const t="Highlighter",i=e.value,n=void 0===i.colorHex?_.b:i.colorHex,r=void 0===i.thickness?_.c:i.thickness;this.logInkEvent(t),await this.m_slideShowInkAddon.ensureInkManagerActivity({item:t,value:{colorHex:n,thickness:r}})}else if(e.tool===PresenterViewUI.InkingTools.Eraser){const e="Eraser";this.logInkEvent(e),await this.m_slideShowInkAddon.ensureInkManagerActivity({item:e})}else if(e.tool===PresenterViewUI.InkingTools.LaserPointer){const t="Laser",i=e.value,n=void 0===i.colorHex?_.d:i.colorHex;this.logInkEvent(t),await this.m_slideShowInkAddon.ensureInkManagerActivity({item:t,value:{colorHex:n}})}else if(e.tool===PresenterViewUI.InkingTools.Select){const e="Select";this.logInkEvent(e),await this.m_slideShowInkAddon.ensureInkManagerActivity({item:e})}else if(e.tool===PresenterViewUI.InkingTools.None){const e="None";this.logInkEvent(e),await this.m_slideShowInkAddon.ensureInkManagerActivity({item:e})}}async changeInkColor(e,t){if(this.m_slideShowInkAddon)switch(e){case PresenterViewUI.InkingTools.Pen:t.effectPattern?await this.m_slideShowInkAddon.onInkManagerActivity({item:"SetInkEffect",color:t}):await this.m_slideShowInkAddon.onInkManagerActivity({item:"SetColor",color:t.colorHex});break;case PresenterViewUI.InkingTools.Highlighter:await this.m_slideShowInkAddon.onInkManagerActivity({item:"SetColor",color:t.colorHex});break;case PresenterViewUI.InkingTools.LaserPointer:await this.m_slideShowInkAddon.onInkManagerActivity({item:"SetLaserColor",color:t.colorHex});break;default:throw"changeInkColor - unsupported tool "+e}}async changeInkSize(e,t){if(this.m_slideShowInkAddon){let i="";switch(e){case PresenterViewUI.InkingTools.Pen:i="penSize";break;case PresenterViewUI.InkingTools.Highlighter:i="highlightSize";break;case PresenterViewUI.InkingTools.LaserPointer:i="laserSize";break;default:throw"changeInkThickness - unsupported tool "+e}await this.m_slideShowInkAddon.perform({name:i,value:t.toString()})}}async setInkInputType(e){this.m_slideShowInkAddon&&(this.m_slideShowInkAddon.pickToolInputType=e,await this.m_slideShowInkAddon.perform({name:"selectToolInputType",value:e}))}async gotoSlide(e,t,i,n){this.m_slideShowCoreConnector&&(await this.m_slideShowCoreConnector.gotoSlide(e,t,i,n),t&&t.navMetrics&&p.a.logNavigationPromiseCompletedMetadata(t.navMetrics,this.sessionUTC,this.skew,this.sessionInfo.uiHostRing))}updateMediaState(e,t,i,n,r,a,s){if(p.a.isDuplicateMediaSyncMessage(a.CorrelationId,!1))return;p.a.logMediaSyncCompletedMetadata(a,this.sessionUTC,this.skew);const o=F.a.furnishMediaSyncState(e,t,i,n,r,a,s);this.m_syncAddonsConnector?(this.m_syncAddonsConnector.updateMediaState(o),!o.origin.isInitial&&this.m_slideShowCoreConnector?this.m_slideShowCoreConnector.updateMediaState(o):c.f.updateMediaSyncMetadataAndLog(`Blocking - isInitState: ${s}, slideShowCoreUndefined: ${!this.m_slideShowCoreConnector}`,"PresenterViewApp",o)):c.f.updateMediaSyncMetadataAndLog("Blocking - MediaAddonUndefined: true","PresenterViewApp",o)}playMedia(e,t){this.m_slideShowCoreConnector&&this.m_slideShowMediaAddon?this.m_slideShowCoreConnector.playMedia(e):a.a.sendTraceTag(506856402,s.a.msoulscat_Wac_PptLive,o.a.Info,"SlideShowApp::playMedia: Media Sync IC3 playMedia event discarded"),t&&p.a.logMediaSyncCompletedMetadata(t,this.sessionUTC,this.skew)}pauseMedia(e,t){this.m_slideShowCoreConnector&&this.m_slideShowMediaAddon?this.m_slideShowCoreConnector.pauseMedia(e):a.a.sendTraceTag(506856401,s.a.msoulscat_Wac_PptLive,o.a.Info,"SlideShowApp::pauseMedia: Media Sync IC3 pauseMedia event discarded"),t&&p.a.logMediaSyncCompletedMetadata(t,this.sessionUTC,this.skew)}seekMedia(e,t,i){this.m_slideShowCoreConnector&&this.m_slideShowMediaAddon?this.m_slideShowCoreConnector.seekMedia(e,t):a.a.sendTraceTag(506856400,s.a.msoulscat_Wac_PptLive,o.a.Info,"SlideShowApp::seekMedia: Media Sync IC3 seekMedia event discarded"),i&&p.a.logMediaSyncCompletedMetadata(i,this.sessionUTC,this.skew)}getSlideLocation(){if(this.m_slideShowCoreConnector)return this.m_slideShowCoreConnector.getSlideLocation();throw"Invalid slideshowCore"}getAnimationState(e){if(this.m_slideShowCoreConnector)return this.m_slideShowCoreConnector.getAnimationState(e);throw"Invalid slideshowCore"}setNavigationOptions(e,t){a.a.sendTraceTag(506856399,s.a.msoulscat_Wac_PptLive,o.a.Info,`SlideShowApp::setNavigationOptions - enableAdvanceOnClick: ${e?"true":"false"}, enableKeyboardNavigation: ${t?"true":"false"}.`),this.registerMouseInputAddOn(e),this.enableKeyboardNavigation()}enableKeyboardNavigation(){if(this.m_slideShowUIContainers&&this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer]){const e=this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer],t=10,i=b.a.readBooleanOrDefault("enableOpticalZoomForPresenter",!1);e.addEventListener("keydown",n=>{if(!this.m_slideshowCore)return;const r=+this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel;switch(n.key.toLowerCase()){case"pagedown":case" ":case"arrowdown":case"n":i&&"arrowdown"===n.key.toLowerCase()&&1!==r?this.m_slideshowCore.panByAmount(new h.k(0,-t),{source:c.h.KeyboardArrowDown}):n.ctrlKey||this.m_slideshowCore.nextStep("0_anim",c.p.Keyboard);break;case"pageup":case"backspace":case"arrowup":case"p":i&&"arrowup"===n.key.toLowerCase()&&1!==r?this.m_slideshowCore.panByAmount(new h.k(0,t),{source:c.h.KeyboardArrowUp}):n.ctrlKey||this.m_slideshowCore.prevStep("0_anim",c.p.Keyboard);break;case"arrowleft":case"arrowright":i&&1!==r?"arrowright"===n.key.toLowerCase()?this.m_slideshowCore.panByAmount(new h.k(-t,0),{source:c.h.KeyboardArrowRight}):"arrowleft"===n.key.toLowerCase()&&this.m_slideshowCore.panByAmount(new h.k(t,0),{source:c.h.KeyboardArrowLeft}):"arrowright"===n.key.toLowerCase()&&!this.m_isRtl||"arrowleft"===n.key.toLowerCase()&&this.m_isRtl?this.m_slideshowCore.nextStep("0_anim",c.p.Keyboard):this.m_slideshowCore.prevStep("0_anim",c.p.Keyboard);break;case"escape":const a=e.contains(document.activeElement)||e===document.activeElement;i&&1!==r?this.m_slideshowCore.zoomToAsync(1,void 0,{source:c.h.KeyboardEscape}):a&&this.m_slideshowCore.events.emit("exitFromEndOfShow");break;case"g":u.ChangeGate.isChangeGateEnabled("PV.EnableGridViewShortcut")&&this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("gridViewToggled",!0);break;case"=":case"+":this.zoomInOrOut(!0);break;case"_":case"-":this.zoomInOrOut(!1)}})}}zoomInOrOut(e){if(!this.m_slideshowCore||!b.a.readBooleanOrDefault("enableOpticalZoomForPresenter",!1))return;const t=this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,i=e?1.15*t:t/1.15;this.m_slideshowCore.zoomToAsync(i,void 0,{source:e?c.h.KeyboardPlus:c.h.KeyboardMinus})}registerMouseInputAddOn(e){if(!this.m_slideshowCore)throw"Invalid slideshowCore";if(a.a.sendTraceTag(506856398,s.a.msoulscat_Wac_PptLive,o.a.Info,`SlideShowApp::registerMouseInputAddOn - enableAdvanceOnClick: ${e}.`),!this.m_mouseInputsAddon){const e=b.a.readBooleanOrDefault("restrictInputsRegionForSSA",!1)?this.m_inputsRegion:this.m_container;this.m_mouseInputsAddon=new c.e(this.m_slideshowCore,e,this.m_isRtl,this.inputLoggingCallback),b.a.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_mouseInputsAddon.enableOpticalZoomMouseInputs(),this.m_mouseInputsAddon.enableOpticalZoomTouchInputs())}e?(this.m_mouseInputsAddon.enableMouseInput(),this.m_mouseInputsAddon.enableTouchInput()):(this.m_mouseInputsAddon.disableMouseInput(),this.m_mouseInputsAddon.disableTouchInput())}async initSlideShowCore(){this.m_slideshowCore&&(a.a.sendTraceTag(506856397,s.a.msoulscat_Wac_PptLive,o.a.Info,"Calling initSlideShowCore."),await this.m_slideshowCore.init().then(()=>{if(this.m_slideShowAppSetting.isPresenterExperienceEnabled){const e=document.getElementById("webgl-canvas")||document.getElementById("svg-canvas");e&&(e.classList.add(this.currentSlideBorderClassName),e.classList.add(this.webGlCanvasClassName))}}))}restoreFocusToPreviousElement(e){const t=document.getElementById("slideshow-app-resume-slideshow");t&&t.contains(e)&&this.restoreFocus()}restoreFocus(){this.m_slideShowCoreConnector&&(a.a.sendTraceTag(506856396,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::restoreFocus called."),this.m_slideShowCoreConnector.restoreFocus())}exitSlideShow(){this.m_slideShowCoreConnector&&(a.a.sendTraceTag(506856395,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::exitSlideShow called."),this.m_slideShowCoreConnector.exitSlideShow(),p.a.logSessionEndPrivateViewingTelemetry(),this.m_slidePerfAddon&&this.m_slidePerfAddon.onSlideShowExit())}switchRole(e){1!==e&&a.a.sendTraceTag(506856394,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`PresenterViewApp - switchRole called with role !== Presenter, role=${e}.`);try{this.updateSlideShowAppRoleClass(e),this.m_syncAddonsConnector&&this.m_syncAddonsConnector.switchRole(e),this.m_slideShowUIEvents?(b.a.readBooleanOrDefault("isClientRehydrationFromLocalStorageEnabled",!1),this.m_slideShowUIEvents.emit("roleChanged",e)):a.a.sendTraceTag(506856393,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - switchRole is called but no slideShowUIEvents object."),this.onRoleChangedWithOpticalZoom(e)}catch(e){a.a.sendTraceTag(506856392,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`SlideShowApp - exception in switchRole: ${e}.`)}}updateSlideShowAppRoleClass(e){this.m_isPresenter=e===g.b.Presenter,this.m_slideShowUIContainers&&this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer]&&(e===g.b.Presenter?(this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer].classList.remove("slideshow-app-attendee-role"),this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer].classList.add("slideshow-app-presenter-role")):(this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer].classList.remove("slideshow-app-presenter-role"),this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer].classList.add("slideshow-app-attendee-role")))}updatePresenterUIToggledClass(e){this.updateSlideShowAppRoleClass(e?g.b.Presenter:g.b.Attendee)}onRoleChangedWithOpticalZoom(e){b.a.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_slideshowCore&&(b.a.readBooleanOrDefault("enableOpticalZoomForPresenter",!1)?(this.m_slideshowCore.enableOpticalZoom=!0,b.a.readBooleanOrDefault("isZoomSyncEnabled",!1)&&this.m_slideShowInkAddon&&this.m_slideShowInkAddon.updateRole(e)):e!==g.b.Presenter?this.m_slideshowCore.enableOpticalZoom=!0:this.m_slideshowCore.zoomToAsync(1,void 0,{fAnimate:!0,source:c.h.RoleChanged}).then(()=>{this.m_slideshowCore&&(this.m_slideshowCore.enableOpticalZoom=!1)}))}async changeTheme(e,t){if(a.a.sendTraceTag(506856391,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`SlideShowApp - changeTheme is called, isHighContrast=${e}, clientColorSettings=${t}.`),this.m_slideShowUIEvents&&this.m_slideShowAppSetting.toggleHighContrastModeEnabled){const i=this.getHighContrastModeFromColorSettings(e,t);this.m_slideShowAppSetting.toggleHighContrastModeEnabled&&this.updateAppColorThemeClass(e,t),this.m_slideShowUIEvents.emit("highContrastModeChanged",i),this.m_slideShowUIEvents.emit("highContrastContentChanged",i),this.m_slideShowAppSetting.slideShowToolbarEnabledForPresenter||await this.changeSlideShowContent(e,t)}else await this.changeSlideShowContent(e,t)}async sendPresenterStateDuringPrivateViewing(e){this.m_slideShowUIEvents&&this.m_slideShowAppSetting.slideShowToolbarEnabledForAttendee&&this.m_slideShowUIEvents.emit("presenterSlideStateChanged",e)}setPrivateViewingToggle(e){this.m_slideShowUIEvents&&this.m_slideShowUIEvents.emit("setPrivateViewingToggle",e)}shouldPreventBroadcastOutboundSlideNavEvent(e,t){return!!this.m_presenterSyncAddon&&this.m_presenterSyncAddon.shouldPreventBroadcastOutboundSlideNavEvent(e,t)}updateMeetingCoachStatus(e){this.m_slideShowUIEvents&&this.m_slideShowAppSetting.enableCoach&&this.m_slideShowUIEvents.emit("updateMeetingCoachStatus",e)}async changeSlideShowContent(e,t){this.m_sessionSettings&&(this.m_sessionSettings.slideShowCoreSettings.isHighContrast=e,this.m_sessionSettings.slideShowCoreSettings.clientColorSettings=t,await this.updateSlideShowCoreResourceProviderInternal(!1),this.m_syncAddonsConnector&&this.m_syncAddonsConnector.changeTheme(e))}async updateSlideShowCoreResourceProviderInternal(e){if(this.m_slideshowCore&&this.m_sessionSettings){const t=this.m_providers;this.m_providers=new c.d(this.m_podsProxy,this.m_logger,{retryCount:this.m_slideShowAppSetting.getItemsRetryCount&&this.m_slideShowAppSetting.getItemsRetryCount>0?this.m_slideShowAppSetting.getItemsRetryCount:3,retryOnCategories:this.m_slideShowAppSetting.getItemsRetryCategories?this.m_slideShowAppSetting.getItemsRetryCategories.split(";"):["Transient","ErrorCannotRender"],settings:this.m_sessionSettings.slideShowCoreSettings.settings});const i=this.getAnimationState(!0);await this.m_slideshowCore.updateResourceProviders(this.m_providers,{shouldRerenderSlide:e}),t&&t.dispose(),this.m_slideshowCore.gotoAnimationState(i)}else a.a.sendTraceTag(506856390,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::updateSlideShowCoreResourceProviderInternal - no slideshow core or session settings object.")}async translateSlideShowContent(e){this.m_sessionSettings&&(this.m_sessionSettings.slideShowCoreSettings.translateLanguage=e,await this.updateSlideShowCoreResourceProviderInternal(!1))}getHighContrastModeFromColorSettings(e,t){let i=PresenterViewUI.HighContrastMode.None;return e&&t&&t===c.c.BlackColorTheme&&(i=PresenterViewUI.HighContrastMode.HighContrastBlack),i}updateAppColorThemeClass(e,t){const i="slideshow-app-black-color-theme",n=this.m_slideShowUIContainers&&this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer]?this.m_slideShowUIContainers[g.c.SlideShowUIRootContainer]:void 0;e?t&&t===c.c.BlackColorTheme&&(this.m_container.classList.add(i),this.m_parent.classList.add(i),n&&n.classList.add(i)):(this.m_container.classList.remove(i),this.m_parent.classList.remove(i),n&&n.classList.remove(i))}getSlideAreaContainerBounds(){if(b.a.readBooleanOrDefault("shrinkSlideForAPL",!1)){if(this.m_sharingLayoutMode===S.a.NewsAnchor||this.m_sharingLayoutMode===S.a.SideBySide){const e=this.m_slideAreaContainer.getBoundingClientRect(),t={top:e.top,bottom:e.bottom,left:e.left,right:e.right};return t.top+=this.m_slideAreaContainer.clientTop,t.bottom-=this.m_slideAreaContainer.clientTop,t.left+=this.m_slideAreaContainer.clientLeft,t.right-=this.m_slideAreaContainer.clientLeft,t}return this.getSlideViewBounds()}}getSlideViewBounds(){if(this.m_slideViewBoundsHelper)return this.m_slideViewBoundsHelper.getSlideViewBounds()}getRole(){return 0}get skew(){return this.m_clockSkewCalculator.skew}get sessionUTC(){return this.m_clockSkewCalculator.sessionUTC}get appSettings(){return this.m_slideShowAppSetting}get podsProxy(){return this.m_podsProxy}setAadToken(e){this.m_slideshowCore&&this.m_slideshowCore.setAadToken(e)}setFrameTrustStatus(e){this.m_slideshowCore&&this.m_slideshowCore.setFrameTrustStatus(e)}getCameoManagerState(){return!1}getCameoInfoFromActiveSlide(){}videoFrameToPptForCameo(e,t){}updateBufferInfoForCameo(e){}updateCustomBackgroundForAPL(e,t){this.m_customBackgroundUrlForAPL=e,this.m_customBackgroundId=t,b.a.readBooleanOrDefault("shrinkSlideForAPL",!1)&&(this.m_sharingLayoutMode!==S.a.SideBySide&&this.m_sharingLayoutMode!==S.a.NewsAnchor||this.refreshCustomBackgroundForAPLOnDOM())}refreshCustomBackgroundForAPLOnDOM(){this.m_customBackgroundUrlForAPL&&""!==this.m_customBackgroundUrlForAPL&&(this.m_slideAreaContainer.style.backgroundImage=`url(${this.m_customBackgroundUrlForAPL})`,this.m_slideAreaContainer.style.backgroundSize="cover",this.m_logger.sendTraceTag(506856389,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::refreshCustomBackgroundForAPLOnDOM - backgroundImage set to "+(this.m_customBackgroundId?this.m_customBackgroundId:"<background id not received>")))}updatePresenterName(e){this.m_slideShowAppSetting.enableMovePresenterNameToPPT&&this.m_slideShowUIEvents&&(this.m_slideShowUIEvents.emit("presenterNameChanged",e),a.a.sendTraceTag(506856388,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::updatePresenterName - received new presenter name"))}returnToPresenterInbound(){this.m_slideShowAppEvents.emit("returnToPresenter")}setSharingLayoutMode(e){if(e&&(a.a.sendTraceTag(506856387,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`SlideShowApp::setSharingLayoutMode - received new sharingLayoutMode=${e} while old sharingLayoutMode=${this.m_sharingLayoutMode}`),this.m_sharingLayoutMode=e,this.slideShowAppEvents.emit("sharingLayoutModeChanged",this.m_sharingLayoutMode),f.a.addOrUpdatePartCDimensions(new Map([["PresenterMode",S.a[this.m_sharingLayoutMode]]])),b.a.readBooleanOrDefault("shrinkSlideForAPL",!1)))if(this.m_sharingLayoutMode===S.a.SideBySide||this.m_sharingLayoutMode===S.a.NewsAnchor){if(this.m_container.classList.remove(this.slideshowContainerUnShrinkClassName),this.m_sharingLayoutMode===S.a.SideBySide?(this.m_container.classList.add(this.slideshowContainerAplShrinkSbsClassName),this.m_container.classList.remove(this.slideshowContainerAplShrinkReporterClassName)):this.m_sharingLayoutMode===S.a.NewsAnchor&&(this.m_container.classList.add(this.slideshowContainerAplShrinkReporterClassName),this.m_container.classList.remove(this.slideshowContainerAplShrinkSbsClassName)),this.refreshCustomBackgroundForAPLOnDOM(),this.m_slideAreaContainer.classList.add(this.currentSlideBorderClassName),this.m_slideShowAppSetting.isPresenterExperienceEnabled){const e=document.getElementById("webgl-canvas")||document.getElementById("svg-canvas");e&&(e.classList.remove(this.currentSlideBorderClassName),e.classList.add(this.canvasSlideShadowClassName))}}else if(this.m_container.classList.add(this.slideshowContainerUnShrinkClassName),this.m_container.classList.remove(this.slideshowContainerAplShrinkSbsClassName),this.m_container.classList.remove(this.slideshowContainerAplShrinkReporterClassName),this.m_slideAreaContainer.style.backgroundImage="none",this.m_slideAreaContainer.classList.remove(this.currentSlideBorderClassName),this.m_slideShowAppSetting.isPresenterExperienceEnabled){const e=document.getElementById("webgl-canvas")||document.getElementById("svg-canvas");e&&(e.classList.add(this.currentSlideBorderClassName),e.classList.remove(this.canvasSlideShadowClassName))}}emitIfCameoDetected(e){this.m_slideshowCore&&this.m_slideshowCore.emitIfCameoDetected(e)}emitIfMediaDetected(e){this.m_slideshowCore&&this.m_slideshowCore.emitIfMediaDetected(e)}handleAnnotationEvent(e){this.m_syncAddonsConnector?(this.m_syncAddonsConnector.handleAnnotationEvent(e),e.metadata&&p.a.logAnnotationCompletedMetadata(e.metadata,this.sessionUTC,this.skew,this.sessionInfo.uiHostRing)):this.m_logger.sendTraceTag(506856386,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::handleAnnotationEvent - receiving annotation events before SlideShowInkShareAddon is ready")}setGlobalMute(e){this.m_sessionInfo&&this.m_sessionInfo.uiHost&&this.m_sessionInfo.uiHost.toLowerCase().includes("teams")&&this.m_slideshowCore&&this.m_slideshowCore.setGlobalMute(e)}setAddinSyncState(e){e?this.m_slideshowCore?this.m_slideshowCore.setAddinSyncState(e):this.m_logger.sendTraceTag(506856384,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::setAddinSyncState - receiving setAddinSyncState before SlideShowCore is ready."):this.m_logger.sendTraceTag(506856385,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::setAddinSyncState - addinSyncState is null.")}hideCameo(e,t){}async onFileDownloadUrlChanged(e){try{if(a.a.sendTraceTag(506856355,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - downloadUrlChanged handler called."),e)if(e!==this.m_fileInfo.fileUrl){this.m_slideshowCore&&(this.m_slideshowCore.isHandlingResourceInconsistent=!0);const t=l.a.performanceNowTrimmed();this.m_fileInfo.fileUrl=e;const i=!!this.m_sessionSettings.appSettings.supportMultiRangeRequests&&this.m_sessionSettings.appSettings.supportMultiRangeRequests,n={DownloadUrl:e,CustomFontCatalogUrl:this.m_fileInfo.customFontCatalogUrl,SupportsMultiRangeRequests:i,DocID:this.m_fileInfo.docId};if(this.m_podsProxy.updateDocSource(n),this.m_appBootFinished?(await this.updateSlideShowCoreResourceProviderInternal(!0),this.m_slideshowCore&&(this.m_slideshowCore.isHandlingResourceInconsistent=!1)):this.m_providers&&this.m_slideshowCore&&(this.m_slideshowCore.isHandlingResourceInconsistent=!1,this.m_providers.resetProviders(),await this.initSlideShowCore()),this.m_slideShowServiceProxy&&(a.a.sendTraceTag(506856354,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - re-init slideshow UI resource provider in downloadUrlChanged handler."),this.m_slideShowServiceProxy.updateDocSource(n),await this.initSlideShowUIDefaultResourceProvider()),this.m_slideShowUIEvents){a.a.sendTraceTag(506856353,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - update resource provider for UI compononents."),this.m_slideShowUIResourceProvider&&(this.m_slideShowToolbar&&(this.m_slideShowToolbar.resourceProvider=this.m_slideShowUIResourceProvider),this.m_thumbnailStrip&&(this.m_thumbnailStrip.resourceProvider=this.m_slideShowUIResourceProvider),this.m_notesPane&&(this.m_notesPane.resourceProvider=this.m_slideShowUIResourceProvider),this.m_gridView&&(this.m_gridView.resourceProvider=this.m_slideShowUIResourceProvider));const i={downloadUrl:e,slideCount:this.getSlideCount()};this.m_slideShowUIEvents.emit("downloadUrlChanged",i);const n=l.a.performanceNowTrimmed(),r={start:t,end:n,duration:n-t};a.a.sendTraceTag(506856352,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`SlideShowApp::onFileDownloadUrlChanged handler - finish update file url: ${JSON.stringify(r)}.`)}}else a.a.sendTraceTag(506856351,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"SlideShowApp::onFileDownloadUrlChanged handler - new file url is the same to current file url.");else a.a.sendTraceTag(506856350,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp::onFileDownloadUrlChanged handler - no file url.")}catch(e){this.m_slideshowCore&&(this.m_slideshowCore.isHandlingResourceInconsistent=!1),a.a.sendTraceTag(506856349,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - exception in onFileDownloadUrlChanged handler: "+e)}}setOpticalZoomState(e,t){this.m_opticalZoomSyncHandlerAddon&&this.m_opticalZoomSyncHandlerAddon.handleOpticalZoomStateChangeAsync(e,t)}constructor(e,t,l,h,f,g,_){if(this.m_sharingLayoutMode=void 0,this.currentSlideBorderClassName="slideshow-area-border-class",this.canvasSlideShadowClassName="canvas-area-shadow-class",this.webGlCanvasClassName="webgl-canvas-class",this.slideContainerClassName="slide-container-class",this.slideshowAppContainerId="slideshow-app-container",this.slideshowContainerAplShrinkSbsClassName="slide-container-apl-shrink-sbs",this.slideshowContainerAplShrinkReporterClassName="slide-container-apl-shrink-reporter",this.slideshowContainerUnShrinkClassName="slide-container-not-apl-unshrink",this.c_educationToastMessageHeading="Presenter View Window PV app",this.c_educationToastMessageBody="Place it in a screen only visible to you PV app",this.inputLoggingCallback=(e,t)=>{let i="";"prev"===e?i="privateSlideUpdatePrev":"next"===e&&(i="privateSlideUpdateNext"),p.a.trackTeamsPVMetrics({action:i,containerClassList:t?t.classList:""},this.sessionUTC)},_&&c.m.logger)this.m_logger=c.m.logger;else{this.m_logger=Object(r.a)(h.appSettings.userSessionId,t.podsUrl+"/RemoteUls.ashx"),Object(c.s)({logger:this.m_logger,settings:h.slideShowCoreSettings.settings,disabledChangeGates:h.slideShowCoreSettings.disabledChangeGates,vetoSessionId:h.appSettings.userSessionId});try{Object(n.j)({settings:h.slideShowCoreSettings.settings})}catch(e){a.a.sendTraceTag(506856481,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"SlideShowApp - setupGlobals_PodsProxy error: "+e)}}a.a.sendTraceTag(506856480,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::Constructor called."),c.r.ssa=this;const S=b.a.readStringOrDefault("hackImageAppendOption","");S&&(h.slideShowCoreSettings.imageSettings?h.slideShowCoreSettings.imageSettings.imageAppendOption=S:h.slideShowCoreSettings.imageSettings={imageAppendOption:S}),h.appSettings.hostExperience=l.hostExperience,this.m_appBootFinished=!1,this.m_parent=e,this.m_fileInfo=t,this.m_sessionInfo=l,this.m_sessionSettings=h;const v=this.m_sessionSettings.appSettings.teamsCallId;b.a.readBooleanOrDefault("isClientRehydrationFromLocalStorageEnabled",!1)&&v&&(this.m_globalStateManager=new x.b(v,this.m_fileInfo.fileUrl,this.m_logger),this.rehydrateClientApp()),this.m_slideShowAppSetting=h.appSettings,this.m_isRtl=this.m_slideShowAppSetting.isRtl||!1,this.m_sessionSettings.appSettings.applicationLcid=l.applicationLcid,this.m_sessionSettings.appSettings.applicationLocaleName=l.applicationLocaleName,u.ChangeGate.isChangeGateEnabled("SSA.DisableOpticalZoomSyncForSyncForSingleWindowUsers")&&!this.m_slideShowAppSetting.isStateServiceOpticalZoomSyncEnabled&&this.m_sessionSettings.slideShowCoreSettings.settings&&(b.a.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","enableOpticalZoomForPresenter","false"),b.a.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","isInkingInZoomedStateEnabled","false"),b.a.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","isZoomSyncEnabled","false"),Object(c.s)({settings:this.m_sessionSettings.slideShowCoreSettings.settings}),a.a.sendTraceTag(506856479,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp::constructor - OpticalZoomSync is disabled because StateService for OpticalZoomSync was not initialized.")),b.a.readBooleanOrDefault("useSmallResolutionSizeIfPreviousSessionTimedOut",!1)&&l.PreviousSessionErrorName&&b.a.readStringOrDefault("bootTimeoutErrorsForSmallResolutionSize","").toLocaleLowerCase().includes(l.PreviousSessionErrorName.toLowerCase())&&(this.m_sessionSettings.slideShowCoreSettings.useSmallResolutionSize=!0),this.m_teamsVetoSettings=this.m_slideShowAppSetting.teamsVetoSettings,this.m_container=document.createElement("div"),this.m_slideAreaContainer=document.createElement("div"),this.m_inputsRegion=document.createElement("div"),this.m_parent.appendChild(this.m_container),this.m_slideShowUIEvents=new I,this.m_slideShowUIEvents.event=g,this.m_slideShowUIEvents.shouldCacheEvents=!0,this.m_slideShowUIContainers=f,this.m_slideShowAppEvents=(new D.a).createAppEvents(),this.m_slideShowComponentManager=M.a.getInstance(),this.m_slideShowComponentManager.registerComponent("SlideShowUI",new A.a(async()=>await i.e(0).then(i.bind(null,287)))),this.m_slideShowComponentManager.registerComponent("CommonMonitoring",new A.b(R.a)),this.m_slideShowComponentManager.loadComponentAsync("CommonMonitoring").then(e=>{e.initialize(this.m_slideShowAppSetting.loggableScriptDomains,this.m_slideShowAppSetting.loggableServiceDomains)}),this.m_slideShowAppSetting.isAnnotationsUIEnabled=this.m_slideShowAppSetting.isAnnotationsUIEnabled||b.a.readBooleanOrDefault("enableSlideShareAnnotationToolbar",!1);const y=b.a.readStringOrDefault("clientHeaderForPresenterViewServerRequest","Unified App"),T=this.m_slideShowAppSetting.teamsCallId||"empty",w=new Map([["X-UserSessionId",this.m_sessionInfo.userSessionId],["X-WacNoAuth","1"],["CallId",T],["Client",y],["UseDocCache",this.m_sessionSettings.appSettings.useDocCache?"True":"False"],["SupportsDecryptedContentDownload","True"]]);this.m_fileInfo.originalFileExtension&&w.set("OriginalFileExtension",this.m_fileInfo.originalFileExtension),this.m_sessionSettings.appSettings.scenario&&w.set("Scenario",this.m_sessionSettings.appSettings.scenario),b.a.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&w.set("x-ms-get-items-trailer-enabled",(!0).toString());const C=!!this.m_sessionSettings.appSettings.supportMultiRangeRequests&&this.m_sessionSettings.appSettings.supportMultiRangeRequests,P={timeout:this.m_slideShowAppSetting.serviceRequestTimeout?this.m_slideShowAppSetting.serviceRequestTimeout:3e4,bootRequestTimeout:b.a.readNumberOrDefault("getItemsBootRequestTimeout",12e3),shouldUseBootRequestTimeout:b.a.readBooleanOrDefault("getItemsShouldUseBootRequestTimeout",!1),throwHttpErrors:!0,onRetryableError:e=>{this.m_slideShowAppEvents.emit("slideShowRetryableError",e)},enableServerSpecificErrorCode:!0,callId:T,sessionInfo:{UiHostRing:this.m_sessionInfo.uiHostRing,SessionId:this.m_sessionInfo.userSessionId,CallId:T},perfTimingMonitorEnabled:!0,parseResponseTimeout:b.a.readNumberOrDefault("parseResponseTimeout",25e3),responseStreamDownloadTimeout:b.a.readNumberOrDefault("responseStreamDownloadTimeout",3e4),shouldUpdateNewFileUrlFromSnap:!0,shouldUseResponseStreamWhenReceivedTotalLength:b.a.readBooleanOrDefault("shouldUseResponseStreamWhenReceivedTotalLength",!1),allowImagesAsBinary:b.a.readBooleanOrDefault("allowImagesAsBinary",!1),disabledChangeGates:h.slideShowCoreSettings.disabledChangeGates,parsingWhileDownloadingEnabled:!0};void 0!==t.enableUsePresentFrontdoor&&(P.pptoPresentFrontDoorEnabled=t.enableUsePresentFrontdoor);const E=new d;this.m_podsProxy=E.createPodsProxy(this.m_fileInfo,C,this.m_logger,w,P),this.m_podsProxy.events.on("requestStageChanged",e=>{e.requestType===n.h.getItemsPresInfoAndSlideInfoAsync&&this.slideShowAppEvents.emit("bootStageChanged",e.stageInfo)}),a.a.sendTraceTag(506856478,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - register downloadUrlChanged handler."),this.m_podsProxy.events.on("downloadUrlChanged",this.onFileDownloadUrlChanged.bind(this));const k=w;k.set("Client",y),k.set("CallId",T),this.m_slideShowServiceProxy=E.createPodsProxy(this.m_fileInfo,C,this.m_logger,k,P),a.a.sendTraceTag(506856477,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"SlideShowApp - register downloadUrlChanged handler for slideShow UI pods proxy."),this.m_slideShowServiceProxy.events.on("downloadUrlChanged",this.onFileDownloadUrlChanged.bind(this));const O=this.m_slideShowAppSetting&&this.m_slideShowAppSetting.clockSkewCalculatorMaxSlowerAttempts?this.m_slideShowAppSetting.clockSkewCalculatorMaxSlowerAttempts:10;this.m_clockSkewCalculator=new m.a(this.m_logger,this.m_podsProxy,O,this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates),this.m_teamsVetoSettings&&p.a.initialize(this.m_teamsVetoSettings);const F=b.a.readNumberOrDefault("slowMediaSyncQoSThresholdMs",3e4);p.a.setSlowMediaSyncThreshold(F),void 0!==this.m_slideShowAppSetting.jsScriptsBasePath&&""!==this.m_slideShowAppSetting.jsScriptsBasePath&&(i.p=""+this.m_slideShowAppSetting.jsScriptsBasePath),this.m_slideShowComponentManager.loadComponentAsync("CommonMonitoring").then(e=>{const t=[];this.appSettings.isPresenterExperienceInitialVisible&&t.push(["StartAsPresenter",this.appSettings.isPresenterExperienceInitialVisible.toString()]),e.initUsageTelemetry(this.sessionInfo,this.m_fileInfo,this.m_sessionSettings,this.logger,t,"PRESENTERVIEWAPP")})}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(9),r=i(3),a=i(7),s=i(4),o=i(31),l=i(89);class d{stopAndRecord(){if(this.m_isDone)return;this.m_observer.disconnect(),o.f.s_events.off("networkCall",this.addGetItemsCall),this.m_entries=this.m_entries.filter(e=>""!==e.url.host);const e=new Set,t=new Map,i=new Set;for(const n of this.m_entries){const r=n.url.pathname.split("/").pop(),a=n.resource?n.resource.encodedBodySize:0;if(r&&d.shouldLog(n,this.m_loggableScriptDomains,[".js",".css",".jpg",".png"]))e.add(`${r}:${a}`);else if(r&&d.shouldLog(n,this.m_loggableServiceDomains,[".ashx","/items"])){let e=r;const i=n.url.searchParams.get("action");i&&(e+="?action="+i),t.set(e,(t.get(e)||0)+1)}else{let e="unknown";(this.m_loggableScriptDomains.find(e=>n.url.hostname.endsWith(e))||this.m_loggableServiceDomains.find(e=>n.url.hostname.endsWith(e)))&&(e=n.url.hostname),i.add(`${e}:${a}`)}}if(s.ChangeGate.isChangeGateEnabled("SSC.NetworkMonitorStaticFiles")&&n.a.sendTraceTag(506857108,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"NetworkMonitorAddon StaticFiles "+Array.from(e).join(",")),s.ChangeGate.isChangeGateEnabled("SSC.NetworkMonitorServiceCalls")){const e={};for(const[i,n]of t)e[i]=n;n.a.sendTraceTag(506857107,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"NetworkMonitorAddon ServiceCalls "+JSON.stringify(e))}s.ChangeGate.isChangeGateEnabled("SSC.NetworkMonitorOtherCalls")&&n.a.sendTraceTag(506857106,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"NetworkMonitorAddon OtherCalls "+Array.from(i).join(",")),this.m_isDone=!0}addPerformanceResourceTimingEntry(e){this.m_entries.push({url:new URL(e.name),resource:e})}static shouldLog(e,t,i){if(!t.find(t=>e.url.hostname.endsWith(t)))return!1;if(!i.find(t=>e.url.pathname.endsWith(t)))return!1;const s=e.resource;return!s||!("responseStatus"in s)||404!==s.responseStatus||(n.a.sendTraceTag(506857105,r.a.msoulscat_Wac_PptSlideshow,a.a.Info,"NetworkMonitor - skipping log for 404 response code"),!1)}logPerformanceResourceTimingEntry(e){if(!d.shouldLog({url:new URL(e.name),resource:e},this.m_loggableScriptDomains,[".js",".css",".jpg",".png"]))return;const t=new URL(e.name),i={};i.dateTime=performance.now(),i.hostname=t.hostname,i.filename=t.pathname.split("/").pop(),i.start=e.startTime,i.redirectStart=e.redirectStart,i.redirectEnd=e.redirectEnd,i.domainLookupStart=e.domainLookupStart,i.domainLookupEnd=e.domainLookupEnd,i.tcpHandshakeStart=e.connectStart,i.tcpHandshakeEnd=e.connectEnd,i.secureConnectionStart=e.secureConnectionStart,i.responseStart=e.responseStart,i.responseEnd=e.responseEnd,i.fetchStart=e.fetchStart,i.requestStart=e.requestStart,"decodedBodySize"in e&&(i.decodedBodySize=e.decodedBodySize),"encodedBodySize"in e&&(i.encodedBodySize=e.encodedBodySize),"transferSize"in e&&(i.transferSize=e.transferSize),"responseStatus"in e&&(i.responseStatus=e.responseStatus),"nextHopProtocol"in e&&(i.nextHopProtocol=e.nextHopProtocol),"initiatorType"in e&&(i.initiatorType=e.initiatorType),"deliveryType"in e&&(i.deliveryType=e.deliveryType),Object.keys(i).length>0&&n.a.sendTraceTag(509449823,r.a.msoulscat_Wac_PptSession,a.a.Info,"NetworkMonitor logPerformanceResourceTimingEntry: "+JSON.stringify(i))}constructor(e,t){this.m_entries=[],this.m_isDone=!1,this.addGetItemsCall=e=>{if(-1===e.url.indexOf("getitems.ashx")&&!e.url.endsWith("items"))return;const t=new Set;for(const i of e.itemIds)t.add(i.replace(/[0-9]/g,""));this.m_entries.push({url:new URL(`${e.url}?action=${Array.from(t).join("%2b")}`),resource:void 0})},this.m_loggableScriptDomains=e,this.m_loggableServiceDomains=t;for(const e of performance.getEntriesByType("resource"))this.addPerformanceResourceTimingEntry(e),this.logPerformanceResourceTimingEntry(e);this.m_observer=new PerformanceObserver(e=>{const t=e.getEntriesByType("resource");for(const e of t)this.addPerformanceResourceTimingEntry(e),this.logPerformanceResourceTimingEntry(e)}),this.m_observer.observe({entryTypes:["resource"]}),o.f.s_events.on("networkCall",this.addGetItemsCall),l.b.networkMonitorAddon=this}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{async processMultipartResponse(e,t,i){if(null==e)throw"multipartContentBuffer is empty";try{const n=new TextDecoder("utf-8").decode(e);this.parseMultipart(n,t).forEach(e=>{const t=this.parseResponsePart(e);i(t)})}catch(e){const t={Err:new Error(e)};i(t)}}fetchBoundary(e){const t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,i){if(!e)throw"multipartContentBufferOrStream is empty";let n,r="",a=void 0,s=0,o=[],l=null;const d=e instanceof Uint8Array;try{for(;;){if(d)n=e;else{const{done:t,value:i}=await e.read();if(t)break;n=i}for(const e of n){const n=10===e||13===e,d=10===e&&13===l,c=10===l&&13===e;if(o.push(e),n||(r+=String.fromCharCode(e)),0===s&&d)"--"+t===r&&(s=1,r="",o=[]);else if(1===s&&c)a=new Uint8Array(o),s=2,r="",o=[];else if(2===s&&d)s=3,r="",o=[];else if(3===s){if(r.length>t.length+4&&(r=""),"--"+t===r){const e=o.length-r.length,t=o.slice(0,e-1);s=1;i({Headers:this.processHeader(a),Body:new Uint8Array(t)}),r="",a=void 0,o=[]}d&&(r="")}l=e}if(d)break}}catch(e){i({Err:new Error(e)})}}parseMultipart(e,t){const i="--"+t;return e.split(i).map(e=>e.trim()).filter(e=>""!==e&&"--"!==e)}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),i=new Map;t.forEach(e=>{const t=e.split(": ");2===t.length&&i.set(t[0],t[1])});const n=this.parseResponseBodyFromPart(e),r=(new TextEncoder).encode(n);return{Headers:i,Body:r}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){const t=new Map;if(e){let i="";for(let t=0;t<e.byteLength;t+=1)i+=String.fromCharCode(e[t]);i.split("\n").forEach(e=>{const i=e.split(": ");2===i.length&&t.set(i[0],i[1])})}return t}}},function(e,t){var i,n,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l,d=[],c=!1,h=-1;function u(){c&&l&&(c=!1,l.length?d=l.concat(d):h=-1,d.length&&m())}function m(){if(!c){var e=o(u);c=!0;for(var t=d.length;t;){for(l=d,d=[];++h<t;)l&&l[h].run();h=-1,t=d.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new f(e,t)),1!==d.length||c||o(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){"use strict";i.r(t),i.d(t,"PresenterViewApp",(function(){return n.a})),i.d(t,"SlideShowAPI",(function(){return r.a})),i.d(t,"SyncBridgeApp",(function(){return a.a})),i.d(t,"SlideShowCoreConnector",(function(){return s.a})),i.d(t,"SyncAddonsConnector",(function(){return o.a})),i.d(t,"UISyncConnector",(function(){return l})),i.d(t,"SlideShowInkShareAddon",(function(){return d.g})),i.d(t,"MediaAddon",(function(){return c.a})),i.d(t,"AppEventsFactory",(function(){return h.a})),i.d(t,"SlideShowJsFileNames",(function(){return u.b})),i.d(t,"SlideShowCssFileNames",(function(){return u.a})),i.d(t,"SlideShowResourceLoader",(function(){return u.c})),i.d(t,"PPTLiveAppComponent",(function(){return m.a})),i.d(t,"PPTLiveGlobalStateManager",(function(){return m.b})),i.d(t,"OpticalZoomSyncStateHandlerAddon",(function(){return f.a})),i.d(t,"SlideShowUIEventsFactory",(function(){return g}));var n=i(165),r=i(164),a=i(126),s=i(124),o=i(96);class l{updateCameraToolbarButtonState(e){this.m_cameraToolbarButtonUpdater(e)}updateSubtitlesToolbarButtonState(e){this.m_subtitlesToolbarButtonUpdater(e)}notifyCameraStateChange(e){this.m_appEvents.emit("cameraStateChanged",e)}notifySubtitlesStateChange(e){this.m_appEvents.emit("subtitlesStateChanged",e)}constructor(e,t,i){this.m_appEvents=e,this.m_cameraToolbarButtonUpdater=t,this.m_subtitlesToolbarButtonUpdater=i}}var d=i(74),c=i(92),h=i(125),u=i(139),m=i(127),f=i(117),p=i(34);class g{createSlideShowUIEvents(){return new p.EventEmitter}}},,function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var n=i(130),r=i(41);class a{get isDisposed(){return this._isDisposed}createVertexBuffer(e,t,i,n,r,a=!1,o){const l=a?t:t*Float32Array.BYTES_PER_ELEMENT,d=n?a?n:n*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new s(this._engine,this,e,this._updatable,!0,d,void 0===r?this._instanced:r,l,i,void 0,void 0,!0,this._divisor||o)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(e=null){!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e,this._label),this._data=e):this._buffer=this._engine.createVertexBuffer(e,void 0,this._label))}_rebuild(){if(this._data)this._buffer=null,this.create(this._data);else{if(!this._buffer)return;if(this._buffer.capacity>0)return void(this._updatable?this._buffer=this._engine.createDynamicVertexBuffer(this._buffer.capacity,this._label):this._buffer=this._engine.createVertexBuffer(this._buffer.capacity,void 0,this._label));r.a.Warn(`Missing data for buffer "${this._label}" ${this._buffer?"(uniqueId: "+this._buffer.uniqueId+")":""}. Buffer reconstruction failed.`),this._buffer=null}}update(e){this.create(e)}updateDirectly(e,t,i,n=!1){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,n?t:t*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),this._data=0===t&&void 0===i?e:null)}_increaseReferences(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._isDisposed=!0,this._data=null,this._buffer=null)}constructor(e,t,i,r=0,a=!1,s=!1,o=!1,l,d){this._isAlreadyOwned=!1,this._isDisposed=!1,e&&e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=i,this._instanced=s,this._divisor=l||1,this._label=d,t instanceof n.a?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=o?r:r*Float32Array.BYTES_PER_ELEMENT,a||this.create()}}class s{get isDisposed(){return this._isDisposed}get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(e){const t=0!=e;this._instanceDivisor=e,t!==this._instanced&&(this._instanced=t,this._computeHashCode())}get _maxVerticesCount(){const e=this.getData();return e?Array.isArray(e)?e.length/(this.byteStride/4)-this.byteOffset/4:(e.byteLength-this.byteOffset)/this.byteStride:0}_computeHashCode(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){var e;null===(e=this._buffer)||void 0===e||e._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(e,t){const i=this.getData();return i?s.GetFloatData(i,this._size,this.type,this.byteOffset,this.byteStride,this.normalized,e,t):null}getBuffer(){return this._buffer.getBuffer()}getWrapperBuffer(){return this._buffer}getStrideSize(){return this.byteStride/s.GetTypeByteLength(this.type)}getOffset(){return this.byteOffset/s.GetTypeByteLength(this.type)}getSize(e=!1){return e?this._size*s.GetTypeByteLength(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(e){this._buffer.create(e),this._alignBuffer()}update(e){this._buffer.update(e),this._alignBuffer()}updateDirectly(e,t,i=!1){this._buffer.updateDirectly(e,t,void 0,i),this._alignBuffer()}dispose(){this._ownsBuffer&&this._buffer.dispose(),this._isDisposed=!0}forEach(e,t){s.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,t)}_alignBuffer(){}static DeduceStride(e){switch(e){case s.UVKind:case s.UV2Kind:case s.UV3Kind:case s.UV4Kind:case s.UV5Kind:case s.UV6Kind:return 2;case s.NormalKind:case s.PositionKind:return 3;case s.ColorKind:case s.ColorInstanceKind:case s.MatricesIndicesKind:case s.MatricesIndicesExtraKind:case s.MatricesWeightsKind:case s.MatricesWeightsExtraKind:case s.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}}static GetDataType(e){return e instanceof Int8Array?s.BYTE:e instanceof Uint8Array?s.UNSIGNED_BYTE:e instanceof Int16Array?s.SHORT:e instanceof Uint16Array?s.UNSIGNED_SHORT:e instanceof Int32Array?s.INT:e instanceof Uint32Array?s.UNSIGNED_INT:s.FLOAT}static GetTypeByteLength(e){switch(e){case s.BYTE:case s.UNSIGNED_BYTE:return 1;case s.SHORT:case s.UNSIGNED_SHORT:return 2;case s.INT:case s.UNSIGNED_INT:case s.FLOAT:return 4;default:throw new Error(`Invalid type '${e}'`)}}static ForEach(e,t,i,n,r,a,o,l){if(e instanceof Array){let r=t/4;const s=i/4;for(let t=0;t<a;t+=n){for(let i=0;i<n;i++)l(e[r+i],t+i);r+=s}}else{const d=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),c=s.GetTypeByteLength(r);for(let e=0;e<a;e+=n){let a=t;for(let t=0;t<n;t++)l(s._GetFloatValue(d,r,a,o),e+t),a+=c;t+=i}}}static _GetFloatValue(e,t,i,n){switch(t){case s.BYTE:{let t=e.getInt8(i);return n&&(t=Math.max(t/127,-1)),t}case s.UNSIGNED_BYTE:{let t=e.getUint8(i);return n&&(t/=255),t}case s.SHORT:{let t=e.getInt16(i,!0);return n&&(t=Math.max(t/32767,-1)),t}case s.UNSIGNED_SHORT:{let t=e.getUint16(i,!0);return n&&(t/=65535),t}case s.INT:return e.getInt32(i,!0);case s.UNSIGNED_INT:return e.getUint32(i,!0);case s.FLOAT:return e.getFloat32(i,!0);default:throw new Error("Invalid component type "+t)}}static GetFloatData(e,t,i,n,a,o,l,d){const c=t*s.GetTypeByteLength(i),h=l*t;if(i!==s.FLOAT||a!==c){const r=new Float32Array(h);return s.ForEach(e,n,a,t,i,h,o,(e,t)=>r[t]=e),r}if(!(e instanceof Array||e instanceof Float32Array)||0!==n||e.length!==h){if(e instanceof Array){const t=n/4;return e.slice(t,t+h)}if(e instanceof ArrayBuffer)return new Float32Array(e,n,h);{const t=e.byteOffset+n;if(0!=(3&t)&&(r.a.Warn("Float array must be aligned to 4-bytes border"),d=!0),d){const i=new Uint8Array(h*Float32Array.BYTES_PER_ELEMENT),n=new Uint8Array(e.buffer,t,i.length);return i.set(n),new Float32Array(i.buffer)}return new Float32Array(e.buffer,t,h)}}return d?e.slice():e}constructor(e,t,i,n,r,o,l,d,c,h,u=!1,m=!1,f=1,p=!1){this._isDisposed=!1;let g=!1;var _,S,v,y,T;if(this.engine=e,"object"==typeof n&&null!==n?(g=null!==(_=n.updatable)&&void 0!==_&&_,r=n.postponeInternalCreation,o=n.stride,l=n.instanced,d=n.offset,c=n.size,h=n.type,u=null!==(S=n.normalized)&&void 0!==S&&S,m=null!==(v=n.useBytes)&&void 0!==v&&v,f=null!==(y=n.divisor)&&void 0!==y?y:1,p=null!==(T=n.takeBufferOwnership)&&void 0!==T&&T,this._label=n.label):g=!!n,t instanceof a?(this._buffer=t,this._ownsBuffer=p):(this._buffer=new a(e,t,g,o,r,l,m,f,this._label),this._ownsBuffer=!0),this.uniqueId=s._Counter++,this._kind=i,void 0===h){const e=this.getData();this.type=e?s.GetDataType(e):s.FLOAT}else this.type=h;const b=s.GetTypeByteLength(this.type);m?(this._size=c||(o?o/b:s.DeduceStride(i)),this.byteStride=o||this._buffer.byteStride||this._size*b,this.byteOffset=d||0):(this._size=c||o||s.DeduceStride(i),this.byteStride=o?o*b:this._buffer.byteStride||this._size*b,this.byteOffset=(d||0)*b),this.normalized=u,this._instanced=void 0!==l&&l,this._instanceDivisor=l?f:0,this._alignBuffer(),this._computeHashCode()}}s._Counter=0,s.BYTE=5120,s.UNSIGNED_BYTE=5121,s.SHORT=5122,s.UNSIGNED_SHORT=5123,s.INT=5124,s.UNSIGNED_INT=5125,s.FLOAT=5126,s.PositionKind="position",s.NormalKind="normal",s.TangentKind="tangent",s.UVKind="uv",s.UV2Kind="uv2",s.UV3Kind="uv3",s.UV4Kind="uv4",s.UV5Kind="uv5",s.UV6Kind="uv6",s.ColorKind="color",s.ColorInstanceKind="instanceColor",s.MatricesIndicesKind="matricesIndices",s.MatricesWeightsKind="matricesWeights",s.MatricesIndicesExtraKind="matricesIndicesExtra",s.MatricesWeightsExtraKind="matricesWeightsExtra"},,,,,,function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},function(e,t,i){var n=i(100),r=i(101),a=i(95).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function l(){this.init(),this._w=o,r.call(this,64,56)}function d(e,t,i){return i^e&(t^i)}function c(e,t,i){return e&t|i&(e|t)}function h(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function u(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function m(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}n(l,r),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,i=this._w,n=0|this._a,r=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,f=0|this._f,p=0|this._g,g=0|this._h,_=0;_<16;++_)i[_]=e.readInt32BE(4*_);for(;_<64;++_)i[_]=0|(((t=i[_-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+i[_-7]+m(i[_-15])+i[_-16];for(var S=0;S<64;++S){var v=g+u(l)+d(l,f,p)+s[S]+i[S]|0,y=h(n)+c(n,r,a)|0;g=p,p=f,f=l,l=o+v|0,o=a,a=r,r=n,n=v+y|0}this._a=n+this._a|0,this._b=r+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0,this._f=f+this._f|0,this._g=p+this._g|0,this._h=g+this._h|0},l.prototype._hash=function(){var e=a.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},function(e,t,i){var n=i(100),r=i(101),a=i(95).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function l(){this.init(),this._w=o,r.call(this,128,112)}function d(e,t,i){return i^e&(t^i)}function c(e,t,i){return e&t|i&(e|t)}function h(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function u(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function m(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function p(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function _(e,t){return e>>>0<t>>>0?1:0}n(l,r),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,i=0|this._ah,n=0|this._bh,r=0|this._ch,a=0|this._dh,o=0|this._eh,l=0|this._fh,S=0|this._gh,v=0|this._hh,y=0|this._al,T=0|this._bl,b=0|this._cl,w=0|this._dl,C=0|this._el,I=0|this._fl,P=0|this._gl,E=0|this._hl,x=0;x<32;x+=2)t[x]=e.readInt32BE(4*x),t[x+1]=e.readInt32BE(4*x+4);for(;x<160;x+=2){var k=t[x-30],M=t[x-30+1],A=m(k,M),R=f(M,k),O=p(k=t[x-4],M=t[x-4+1]),F=g(M,k),D=t[x-14],L=t[x-14+1],B=t[x-32],N=t[x-32+1],V=R+L|0,W=A+D+_(V,R)|0;W=(W=W+O+_(V=V+F|0,F)|0)+B+_(V=V+N|0,N)|0,t[x]=W,t[x+1]=V}for(var U=0;U<160;U+=2){W=t[U],V=t[U+1];var z=c(i,n,r),H=c(y,T,b),G=h(i,y),j=h(y,i),$=u(o,C),q=u(C,o),Z=s[U],J=s[U+1],X=d(o,l,S),Y=d(C,I,P),K=E+q|0,Q=v+$+_(K,E)|0;Q=(Q=(Q=Q+X+_(K=K+Y|0,Y)|0)+Z+_(K=K+J|0,J)|0)+W+_(K=K+V|0,V)|0;var ee=j+H|0,te=G+z+_(ee,j)|0;v=S,E=P,S=l,P=I,l=o,I=C,o=a+Q+_(C=w+K|0,w)|0,a=r,w=b,r=n,b=T,n=i,T=y,i=Q+te+_(y=K+ee|0,K)|0}this._al=this._al+y|0,this._bl=this._bl+T|0,this._cl=this._cl+b|0,this._dl=this._dl+w|0,this._el=this._el+C|0,this._fl=this._fl+I|0,this._gl=this._gl+P|0,this._hl=this._hl+E|0,this._ah=this._ah+i+_(this._al,y)|0,this._bh=this._bh+n+_(this._bl,T)|0,this._ch=this._ch+r+_(this._cl,b)|0,this._dh=this._dh+a+_(this._dl,w)|0,this._eh=this._eh+o+_(this._el,C)|0,this._fh=this._fh+l+_(this._fl,I)|0,this._gh=this._gh+S+_(this._gl,P)|0,this._hh=this._hh+v+_(this._hl,E)|0},l.prototype._hash=function(){var e=a.allocUnsafe(64);function t(t,i,n){e.writeInt32BE(t,n),e.writeInt32BE(i,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(51);class r{static get Now(){return Object(n.d)()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{toGlobal(e,t){return new n(this.x*e,this.y*t,this.width*e,this.height*t)}toGlobalToRef(e,t,i){return i.x=this.x*e,i.y=this.y*t,i.width=this.width*e,i.height=this.height*t,this}clone(){return new n(this.x,this.y,this.width,this.height)}constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}}},function(e,t,i){"use strict";i.d(t,"f",(function(){return s})),i.d(t,"g",(function(){return o})),i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return u})),i.d(t,"n",(function(){return m})),i.d(t,"h",(function(){return f})),i.d(t,"m",(function(){return p})),i.d(t,"l",(function(){return g})),i.d(t,"i",(function(){return C})),i.d(t,"k",(function(){return I})),i.d(t,"j",(function(){return P}));var n=i(114),r=i(77),a=i(99),s="Release.AudienceGroup",o="WAC.Ring",l="App.Name",d="App.Platform",c="App.Version",h="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",u="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121",m=void 0;function f(e,t,i,n){var a=!0;if(t)for(var s=function(t){var s=t.classification,o=t.dataType,l=t.name;if(s&&!(4===s||1===s||2===n&&32===s||3===n&&2048===s))return a=!1,"break";if(3===n&&i&&3!==o&&1!==o&&2!==o&&"OTelJS.Version"!==l&&"OTelJS.Sink"!==l)return Object(r.b)(0,1,(function(){return"DNM: Invalid field type "+l})),a=!1,"break";var d;d=i?"zC."===l.substr(0,3)?"zC.Data."+l.substr(3):"Data."+l:l;var c=void 0;switch(o){case 3:c=6;break;case 2:c=4;break;case 4:c=8;break;case 0:return e[d]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";case 1:default:return e[d]=t.value,"continue"}var h={value:t.value,propertyType:c};e[d]=h},o=0,l=t;o<l.length&&"break"!==s(l[o]);o++);return a}function p(e,t){try{return e()}catch(e){return Object(r.a)(1,"1DS Sink",e),t}}function g(e,t){for(var i=function(i){var n=t[i];if(!n.processEvent(e))return Object(r.b)(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(n.name)})),{value:!1}},n=0;n<t.length;n++){var a=i(n);if("object"==typeof a)return a.value}return!0}function _(e){Object(r.b)(0,1,(function(){return"Invalid "+e}))}function S(e){return Object(n.t)(e)&&""!==e}function v(e,t){return Object.values(t).includes(e)}function y(e){return v(e,a.d)}function T(e){return v(e,a.c)}function b(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function w(e){return!e||"Other"===e}function C(e,t){var i=!0;function r(t,n){n(e[t])||(_(t),i=!1)}function a(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return r(l,S),r(d,t?y:S),r(c,S),r("Session.Id",a),t?(r(s,T),r("User.IsSignedIn",n.l),e["User.IsSignedIn"]?(r("User.PrimaryIdentityHash",S),r("User.PrimaryIdentitySpace",b),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e["User.PrimaryIdentitySpace"])?r("User.TenantId",a):r("User.TenantId",n.q)):(r("User.PrimaryIdentitySpace",w),r("User.TenantId",n.q))):e["User.IsAnonymous"]||!1===e["User.IsSignedIn"]||(r("User.PrimaryIdentityHash",S),r("User.PrimaryIdentitySpace",S),e["User.TenantId"]&&r("User.TenantId",a)),Object(n.q)(e["User.IsAnonymous"])||e["User.IsSignedIn"]!==e["User.IsAnonymous"]||(_("User.IsAnonymous"),i=!1),i}function I(e){return e.timestamp?new Date(e.timestamp):new Date}function P(e){var t=I(e);return t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),2===e.telemetryProperties.dnmInterval&&t.setHours(0),t}},function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return l}));var n=i(85),r=i(43);function a(e,t,i){const r=new n.d(0,0),a=new n.d(0,0);for(const s of e){const e=n.e.Project(s,n.a.IdentityReadOnly,t,i);e.x=((e.x-i.x)/i.width-.5)*(16/9)+.5,e.y=(e.y-i.y)/i.height,e.x<r.x&&(r.x=e.x),e.y<r.y&&(r.y=e.y),e.x>a.x&&(a.x=e.x),e.y>a.y&&(a.y=e.y)}return{min:r,max:a}}function s(e){e._gl.pixelStorei(e._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,e._gl.NONE),e._gl.pixelStorei(e._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0)}function o(e){const t=e.readPixels();if(!t)return;let i=!0;for(let e=3;e<t.length;e+=4)if(255!==t[e]){i=!1;break}return i}function l(e,t,i){const a=(s=new n.b(Object(r.e)(e.scnRotQX),Object(r.e)(e.scnRotQY),Object(r.e)(e.scnRotQZ),Object(r.e)(e.scnRotQW)),o=new n.b(Object(r.e)(e.scnRotMQX),Object(r.e)(e.scnRotMQY),Object(r.e)(e.scnRotMQZ),Object(r.e)(e.scnRotMQW)),l=new n.b(Object(r.e)(t.scnRotQX),Object(r.e)(t.scnRotQY),Object(r.e)(t.scnRotQZ),Object(r.e)(t.scnRotQW)),c=n.b.Slerp,(h=i)<.5?c(s,o,2*h):c(o,l,2*(h-.5)));var s,o,l,c,h;return{txW:d(i,e.txW,t.txW),txH:d(i,e.txH,t.txH),untScl:d(i,e.untScl,t.untScl),scnPreTX:d(i,e.scnPreTX,t.scnPreTX),scnPreTY:d(i,e.scnPreTY,t.scnPreTY),scnPreTZ:d(i,e.scnPreTZ,t.scnPreTZ),scnSclX:d(i,e.scnSclX,t.scnSclX),scnSclY:d(i,e.scnSclY,t.scnSclY),scnSclZ:d(i,e.scnSclZ,t.scnSclZ),scnRotQX:Object(r.i)(a.x),scnRotQY:Object(r.i)(a.y),scnRotQZ:Object(r.i)(a.z),scnRotQW:Object(r.i)(a.w),scnPosTX:d(i,e.scnPosTX,t.scnPosTX),scnPosTY:d(i,e.scnPosTY,t.scnPosTY),scnPosTZ:d(i,e.scnPosTZ,t.scnPosTZ),camPrm:d(i,e.camPrm,t.camPrm),camPX:d(i,e.camPX,t.camPX),camPY:d(i,e.camPY,t.camPY),camPZ:d(i,e.camPZ,t.camPZ),camAtX:d(i,e.camAtX,t.camAtX),camAtY:d(i,e.camAtY,t.camAtY),camAtZ:d(i,e.camAtZ,t.camAtZ),camUpX:d(i,e.camUpX,t.camUpX),camUpY:d(i,e.camUpY,t.camUpY),camUpZ:d(i,e.camUpZ,t.camUpZ)}}function d(e,t,i){return t*(1-e)+i*e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(57),r=i(107),a=i(47);class s{sendTelemetryEvent(e){e&&Object(n.p)(e)}sendDirectNumericEvent(e){e&&Object(n.k)(e)}sendCustomerContentEvent(e){e&&Object(n.j)(e)}sendActivityEvent(e){e&&Object(n.i)(e)}sendUserActionEvent(e){e&&Object(n.q)(e)}addNamespaceMapping(e,t){e&&t&&Object(n.b)(e,t)}setDNMToken(e,t){e&&t&&Object(n.r)(e,t)}sendOtelEvent(e){e&&Object(n.o)(e)}sendOtelCustomerContent(e){e&&Object(n.m)(e)}sendOtelDirectNumeric(e){e&&Object(n.n)(e)}setEnabledState(e){Object(n.s)(e)}registerEventHandler(e){e&&Object(n.g)(e)}shutdown(){return Object(n.t)()}setOtelWorkerEnabledState(e,t){return Object(r.e)(e,Object(a.d)(t))}startOtelWorker(){return Object(r.f)()}addSink(e){Object(r.a)(Object(a.d)(e))}hasValidLogger(){return Object(r.c)()}isMeasuresEnabled(){return Object(r.d)()}}class o{createInstance(){return new s}}},function(e,t,i){"use strict";function n(e){return e?[r,a,s,o,l,c,d].map(t=>t(e)):[]}function r(e){return{name:"App",contract:{name:"App",dataFields:[h("Name",e.name),h("Platform",e.platform),h("Version",e.version)]}}}function a(e){return{name:"Session",contract:{name:"Session",dataFields:[h("Id",e.sessionId),h("EcsETag",e.flightsImpressionId)]}}}function s(e){return{name:"Release",contract:{name:"Release",dataFields:[h("AudienceGroup",e.audienceGroup)]}}}function o(e){return{name:"Browser",contract:{name:"Browser",dataFields:[h("Name",e.browserName),h("Version",e.browserVersion)]}}}function l(e){return{name:"Culture",contract:{name:"Culture",dataFields:[h("UiLanguage",e.appLanguage)]}}}function d(e){return{name:"User",contract:{name:"User",dataFields:[h("PrimaryIdentityHash",e.loggableUserId),h("PrimaryIdentitySpace",e.loggableUserIdSpace),h("TenantId",e.omsTenantId),u("IsAnonymous",e.isAnonymousUser)]}}}function c(e){return{name:"WAC",contract:{name:"WAC",dataFields:[h("Host",e.host),h("ServerDocId",e.serverDocId),h("Datacenter",e.datacenter),u("IsSynthetic",e.isSynthetic),u("IsBusinessUser",e.isBusinessUser),u("IsEdu",e.isEduUser),h("ApplicationMode",e.applicationMode),h("ApplicationModeExtended",e.applicationModeExtended),h("BrowserLanguage",e.browserLanguage),h("ContentLanguage",e.contentLanguage),h("OsVersion",e.osVersion),h("Ring",e.ring),h("UiHost",e.uiHost),h("SessionOrigin",e.sessionOrigin),h("UiHostIntegrationType",e.uiHostIntegrationType),m("NetworkDownlink",e.networkDownlink),m("NetworkDownlinkMax",e.networkDownlinkMax),h("NetworkEffectiveType",e.networkEffectiveType),(t="NetworkRTT",i=e.networkRTT,null==i?{name:t,int64:0}:{name:t,int64:i}),u("NetworkSaveData",e.networkSaveData),h("NetworkType",e.networkType)]}};var t,i}function h(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function u(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}function m(e,t){return null==t?{name:e,double:0}:{name:e,double:t}}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n="4.20.30"},function(e,t,i){"use strict";(function(e,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=void 0!==e&&"[object global]"==={}.toString.call(e);function s(e,t){return 0===e.indexOf(t.toLowerCase())?e:"".concat(t.toLowerCase()).concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}function o(e){return Boolean(e&&1===e.nodeType&&"nodeName"in e&&e.ownerDocument&&e.ownerDocument.defaultView)}function l(e){return!isNaN(parseFloat(e))&&isFinite(e)&&Math.floor(e)==e}function d(e){return/^(https?:)?\/\/((player|www)\.)?vimeo\.com(?=$|\/)/.test(e)}function c(e){return/^https:\/\/player\.vimeo\.com\/video\/\d+/.test(e)}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,i=e.url,n=t||i;if(!n)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(l(n))return"https://vimeo.com/".concat(n);if(d(n))return n.replace("http:","https:");if(t)throw new TypeError("“".concat(t,"” is not a valid video id."));throw new TypeError("“".concat(n,"” is not a vimeo.com url."))}var u=void 0!==Array.prototype.indexOf,m="undefined"!=typeof window&&void 0!==window.postMessage;if(!(a||u&&m))throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};
/*!
 * weakmap-polyfill v2.0.4 - ECMAScript6 WeakMap polyfill
 * https://github.com/polygonplanet/weakmap-polyfill
 * Copyright (c) 2015-2021 polygonplanet <polygon.planet.aqua@gmail.com>
 * @license MIT
 */
!function(e){if(!e.WeakMap){var t=Object.prototype.hasOwnProperty,i=Object.defineProperty&&function(){try{return 1===Object.defineProperty({},"x",{value:1}).x}catch(e){}}(),n=function(e,t,n){i?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:n}):e[t]=n};e.WeakMap=function(){function e(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(n(this,"_id",a("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}function i(e,i){if(!r(e)||!t.call(e,"_id"))throw new TypeError(i+" method called on incompatible receiver "+typeof e)}function a(e){return e+"_"+s()+"."+s()}function s(){return Math.random().toString().substring(2)}return n(e.prototype,"delete",(function(e){if(i(this,"delete"),!r(e))return!1;var t=e[this._id];return!(!t||t[0]!==e||(delete e[this._id],0))})),n(e.prototype,"get",(function(e){if(i(this,"get"),r(e)){var t=e[this._id];return t&&t[0]===e?t[1]:void 0}})),n(e.prototype,"has",(function(e){if(i(this,"has"),!r(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)})),n(e.prototype,"set",(function(e,t){if(i(this,"set"),!r(e))throw new TypeError("Invalid value used as weak map key");var a=e[this._id];return a&&a[0]===e?(a[1]=t,this):(n(e,this._id,[e,t]),this)})),n(e,"_polyfill",!0),e}()}function r(e){return Object(e)===e}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:f);var p=function(e,t){return function(e){
/*! Native Promise Only
      v0.8.1 (c) Kyle Simpson
      MIT License: http://getify.mit-license.org
  */
var t,n;n=function(){var e,t,n,r=Object.prototype.toString,a=void 0!==i?function(e){return i(e)}:setTimeout;try{Object.defineProperty({},"x",{}),e=function(e,t,i,n){return Object.defineProperty(e,t,{value:i,writable:!0,configurable:!1!==n})}}catch(t){e=function(e,t,i){return e[t]=i,e}}function s(e,i){n.add(e,i),t||(t=a(n.drain))}function o(e){var t,i=typeof e;return null==e||"object"!=i&&"function"!=i||(t=e.then),"function"==typeof t&&t}function l(){for(var e=0;e<this.chain.length;e++)d(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function d(e,t,i){var n,r;try{!1===t?i.reject(e.msg):(n=!0===t?e.msg:t.call(void 0,e.msg))===i.promise?i.reject(TypeError("Promise-chain cycle")):(r=o(n))?r.call(n,i.resolve,i.reject):i.resolve(n)}catch(e){i.reject(e)}}function c(e){var t,i=this;if(!i.triggered){i.triggered=!0,i.def&&(i=i.def);try{(t=o(e))?s((function(){var n=new m(i);try{t.call(e,(function(){c.apply(n,arguments)}),(function(){h.apply(n,arguments)}))}catch(e){h.call(n,e)}})):(i.msg=e,i.state=1,i.chain.length>0&&s(l,i))}catch(e){h.call(new m(i),e)}}}function h(e){var t=this;t.triggered||(t.triggered=!0,t.def&&(t=t.def),t.msg=e,t.state=2,t.chain.length>0&&s(l,t))}function u(e,t,i,n){for(var r=0;r<t.length;r++)!function(r){e.resolve(t[r]).then((function(e){i(r,e)}),n)}(r)}function m(e){this.def=e,this.triggered=!1}function f(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var t=new f(this);this.then=function(e,i){var n={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return n.promise=new this.constructor((function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");n.resolve=e,n.reject=t})),t.chain.push(n),0!==t.state&&s(l,t),n.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,(function(e){c.call(t,e)}),(function(e){h.call(t,e)}))}catch(e){h.call(t,e)}}n=function(){var e,i,n;function r(e,t){this.fn=e,this.self=t,this.next=void 0}return{add:function(t,a){n=new r(t,a),i?i.next=n:e=n,i=n,n=void 0},drain:function(){var n=e;for(e=i=t=void 0;n;)n.fn.call(n.self),n=n.next}}}();var g=e({},"constructor",p,!1);return p.prototype=g,e(g,"__NPO__",0,!1),e(p,"resolve",(function(e){return e&&"object"==typeof e&&1===e.__NPO__?e:new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");t(e)}))})),e(p,"reject",(function(e){return new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");i(e)}))})),e(p,"all",(function(e){var t=this;return"[object Array]"!=r.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t((function(i,n){if("function"!=typeof i||"function"!=typeof n)throw TypeError("Not a function");var r=e.length,a=Array(r),s=0;u(t,e,(function(e,t){a[e]=t,++s===r&&i(a)}),n)}))})),e(p,"race",(function(e){var t=this;return"[object Array]"!=r.call(e)?t.reject(TypeError("Not an array")):new t((function(i,n){if("function"!=typeof i||"function"!=typeof n)throw TypeError("Not a function");u(t,e,(function(e,t){i(t)}),n)}))})),p},(t=f)["Promise"]=t.Promise||n(),e.exports&&(e.exports=t.Promise)}(t={exports:{}}),t.exports}(),g=new WeakMap;function _(e,t,i){var n=g.get(e.element)||{};t in n||(n[t]=[]),n[t].push(i),g.set(e.element,n)}function S(e,t){return(g.get(e.element)||{})[t]||[]}function v(e,t,i){var n=g.get(e.element)||{};if(!n[t])return!0;if(!i)return n[t]=[],g.set(e.element,n),!0;var r=n[t].indexOf(i);return-1!==r&&n[t].splice(r,1),g.set(e.element,n),n[t]&&0===n[t].length}function y(e,t){var i=g.get(e);g.set(t,i),g.delete(e)}function T(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return console.warn(e),{}}return e}function b(e,t,i){if(e.element.contentWindow&&e.element.contentWindow.postMessage){var n={method:t};void 0!==i&&(n.value=i);var r=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));r>=8&&r<10&&(n=JSON.stringify(n)),e.element.contentWindow.postMessage(n,e.origin)}}function w(e,t){var i,n=[];if((t=T(t)).event)"error"===t.event&&S(e,t.data.method).forEach((function(i){var n=new Error(t.data.message);n.name=t.data.name,i.reject(n),v(e,t.data.method,i)})),n=S(e,"event:".concat(t.event)),i=t.data;else if(t.method){var r=function(e,t){var i=S(e,t);if(i.length<1)return!1;var n=i.shift();return v(e,t,n),n}(e,t.method);r&&(n.push(r),i=t.value)}n.forEach((function(t){try{if("function"==typeof t)return void t.call(e,i);t.resolve(i)}catch(e){}}))}var C=["autopause","autoplay","background","byline","color","controls","dnt","height","id","interactive_params","keyboard","loop","maxheight","maxwidth","muted","playsinline","portrait","responsive","speed","texttrack","title","transparent","url","width"];function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return C.reduce((function(t,i){var n=e.getAttribute("data-vimeo-".concat(i));return(n||""===n)&&(t[i]=""===n?1:n),t}),t)}function P(e,t){var i=e.html;if(!t)throw new TypeError("An element must be provided");if(null!==t.getAttribute("data-vimeo-initialized"))return t.querySelector("iframe");var n=document.createElement("div");return n.innerHTML=i,t.appendChild(n.firstChild),t.setAttribute("data-vimeo-initialized","true"),t.querySelector("iframe")}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return new Promise((function(n,r){if(!d(e))throw new TypeError("“".concat(e,"” is not a vimeo.com url."));var a="https://vimeo.com/api/oembed.json?url=".concat(encodeURIComponent(e));for(var s in t)t.hasOwnProperty(s)&&(a+="&".concat(s,"=").concat(encodeURIComponent(t[s])));var o="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;o.open("GET",a,!0),o.onload=function(){if(404!==o.status)if(403!==o.status)try{var t=JSON.parse(o.responseText);if(403===t.domain_status_code)return P(t,i),void r(new Error("“".concat(e,"” is not embeddable.")));n(t)}catch(e){r(e)}else r(new Error("“".concat(e,"” is not embeddable.")));else r(new Error("“".concat(e,"” was not found.")))},o.onerror=function(){var e=o.status?" (".concat(o.status,")"):"";r(new Error("There was an error fetching the embed code from Vimeo".concat(e,".")))},o.send()}))}var x=new WeakMap,k=new WeakMap,M={},A=function(){function e(t){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n(this,e),window.jQuery&&t instanceof jQuery&&(t.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),t=t[0]),"undefined"!=typeof document&&"string"==typeof t&&(t=document.getElementById(t)),!o(t))throw new TypeError("You must pass either a valid element or a valid id.");if("IFRAME"!==t.nodeName){var a=t.querySelector("iframe");a&&(t=a)}if("IFRAME"===t.nodeName&&!d(t.getAttribute("src")||""))throw new Error("The player element passed isn’t a Vimeo embed.");if(x.has(t))return x.get(t);this._window=t.ownerDocument.defaultView,this.element=t,this.origin="*";var s=new p((function(e,n){if(i._onMessage=function(t){if(d(t.origin)&&i.element.contentWindow===t.source){"*"===i.origin&&(i.origin=t.origin);var r=T(t.data);if(r&&"error"===r.event&&r.data&&"ready"===r.data.method){var a=new Error(r.data.message);return a.name=r.data.name,void n(a)}var s=r&&"ready"===r.event,o=r&&"ping"===r.method;if(s||o)return i.element.setAttribute("data-ready","true"),void e();w(i,r)}},i._window.addEventListener("message",i._onMessage),"IFRAME"!==i.element.nodeName){var a=I(t,r);E(h(a),a,t).then((function(e){var n=P(e,t);return i.element=n,i._originalElement=t,y(t,n),x.set(i.element,i),e})).catch(n)}}));if(k.set(this,s),x.set(this.element,this),"IFRAME"===this.element.nodeName&&b(this,"ping"),M.isEnabled){var l=function(){return M.exit()};this.fullscreenchangeHandler=function(){M.isFullscreen?_(i,"event:exitFullscreen",l):v(i,"event:exitFullscreen",l),i.ready().then((function(){b(i,"fullscreenchange",M.isFullscreen)}))},M.on("fullscreenchange",this.fullscreenchangeHandler)}return this}var t,i;return t=e,(i=[{key:"callMethod",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new p((function(n,r){return t.ready().then((function(){_(t,e,{resolve:n,reject:r}),b(t,e,i)})).catch(r)}))}},{key:"get",value:function(e){var t=this;return new p((function(i,n){return e=s(e,"get"),t.ready().then((function(){_(t,e,{resolve:i,reject:n}),b(t,e)})).catch(n)}))}},{key:"set",value:function(e,t){var i=this;return new p((function(n,r){if(e=s(e,"set"),null==t)throw new TypeError("There must be a value to set.");return i.ready().then((function(){_(i,e,{resolve:n,reject:r}),b(i,e,t)})).catch(r)}))}},{key:"on",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(!t)throw new TypeError("You must pass a callback function.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");0===S(this,"event:".concat(e)).length&&this.callMethod("addEventListener",e).catch((function(){})),_(this,"event:".concat(e),t)}},{key:"off",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(t&&"function"!=typeof t)throw new TypeError("The callback must be a function.");v(this,"event:".concat(e),t)&&this.callMethod("removeEventListener",e).catch((function(e){}))}},{key:"loadVideo",value:function(e){return this.callMethod("loadVideo",e)}},{key:"ready",value:function(){var e=k.get(this)||new p((function(e,t){t(new Error("Unknown player. Probably unloaded."))}));return p.resolve(e)}},{key:"addCuePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.callMethod("addCuePoint",{time:e,data:t})}},{key:"removeCuePoint",value:function(e){return this.callMethod("removeCuePoint",e)}},{key:"enableTextTrack",value:function(e,t){if(!e)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:e,kind:t})}},{key:"disableTextTrack",value:function(){return this.callMethod("disableTextTrack")}},{key:"pause",value:function(){return this.callMethod("pause")}},{key:"play",value:function(){return this.callMethod("play")}},{key:"requestFullscreen",value:function(){return M.isEnabled?M.request(this.element):this.callMethod("requestFullscreen")}},{key:"exitFullscreen",value:function(){return M.isEnabled?M.exit():this.callMethod("exitFullscreen")}},{key:"getFullscreen",value:function(){return M.isEnabled?p.resolve(M.isFullscreen):this.get("fullscreen")}},{key:"requestPictureInPicture",value:function(){return this.callMethod("requestPictureInPicture")}},{key:"exitPictureInPicture",value:function(){return this.callMethod("exitPictureInPicture")}},{key:"getPictureInPicture",value:function(){return this.get("pictureInPicture")}},{key:"unload",value:function(){return this.callMethod("unload")}},{key:"destroy",value:function(){var e=this;return new p((function(t){if(k.delete(e),x.delete(e.element),e._originalElement&&(x.delete(e._originalElement),e._originalElement.removeAttribute("data-vimeo-initialized")),e.element&&"IFRAME"===e.element.nodeName&&e.element.parentNode&&(e.element.parentNode.parentNode&&e._originalElement&&e._originalElement!==e.element.parentNode?e.element.parentNode.parentNode.removeChild(e.element.parentNode):e.element.parentNode.removeChild(e.element)),e.element&&"DIV"===e.element.nodeName&&e.element.parentNode){e.element.removeAttribute("data-vimeo-initialized");var i=e.element.querySelector("iframe");i&&i.parentNode&&(i.parentNode.parentNode&&e._originalElement&&e._originalElement!==i.parentNode?i.parentNode.parentNode.removeChild(i.parentNode):i.parentNode.removeChild(i))}e._window.removeEventListener("message",e._onMessage),M.isEnabled&&M.off("fullscreenchange",e.fullscreenchangeHandler),t()}))}},{key:"getAutopause",value:function(){return this.get("autopause")}},{key:"setAutopause",value:function(e){return this.set("autopause",e)}},{key:"getBuffered",value:function(){return this.get("buffered")}},{key:"getCameraProps",value:function(){return this.get("cameraProps")}},{key:"setCameraProps",value:function(e){return this.set("cameraProps",e)}},{key:"getChapters",value:function(){return this.get("chapters")}},{key:"getCurrentChapter",value:function(){return this.get("currentChapter")}},{key:"getColor",value:function(){return this.get("color")}},{key:"setColor",value:function(e){return this.set("color",e)}},{key:"getCuePoints",value:function(){return this.get("cuePoints")}},{key:"getCurrentTime",value:function(){return this.get("currentTime")}},{key:"setCurrentTime",value:function(e){return this.set("currentTime",e)}},{key:"getDuration",value:function(){return this.get("duration")}},{key:"getEnded",value:function(){return this.get("ended")}},{key:"getLoop",value:function(){return this.get("loop")}},{key:"setLoop",value:function(e){return this.set("loop",e)}},{key:"setMuted",value:function(e){return this.set("muted",e)}},{key:"getMuted",value:function(){return this.get("muted")}},{key:"getPaused",value:function(){return this.get("paused")}},{key:"getPlaybackRate",value:function(){return this.get("playbackRate")}},{key:"setPlaybackRate",value:function(e){return this.set("playbackRate",e)}},{key:"getPlayed",value:function(){return this.get("played")}},{key:"getQualities",value:function(){return this.get("qualities")}},{key:"getQuality",value:function(){return this.get("quality")}},{key:"setQuality",value:function(e){return this.set("quality",e)}},{key:"getSeekable",value:function(){return this.get("seekable")}},{key:"getSeeking",value:function(){return this.get("seeking")}},{key:"getTextTracks",value:function(){return this.get("textTracks")}},{key:"getVideoEmbedCode",value:function(){return this.get("videoEmbedCode")}},{key:"getVideoId",value:function(){return this.get("videoId")}},{key:"getVideoTitle",value:function(){return this.get("videoTitle")}},{key:"getVideoWidth",value:function(){return this.get("videoWidth")}},{key:"getVideoHeight",value:function(){return this.get("videoHeight")}},{key:"getVideoUrl",value:function(){return this.get("videoUrl")}},{key:"getVolume",value:function(){return this.get("volume")}},{key:"setVolume",value:function(e){return this.set("volume",e)}}])&&r(t.prototype,i),e}();a||(M=function(){var e=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,n=t.length,r={};i<n;i++)if((e=t[i])&&e[1]in document){for(i=0;i<e.length;i++)r[t[0][i]]=e[i];return r}return!1}(),t={fullscreenchange:e.fullscreenchange,fullscreenerror:e.fullscreenerror},i={request:function(t){return new Promise((function(n,r){var a=function e(){i.off("fullscreenchange",e),n()};i.on("fullscreenchange",a);var s=(t=t||document.documentElement)[e.requestFullscreen]();s instanceof Promise&&s.then(a).catch(r)}))},exit:function(){return new Promise((function(t,n){if(i.isFullscreen){var r=function e(){i.off("fullscreenchange",e),t()};i.on("fullscreenchange",r);var a=document[e.exitFullscreen]();a instanceof Promise&&a.then(r).catch(n)}else t()}))},on:function(e,i){var n=t[e];n&&document.addEventListener(n,i)},off:function(e,i){var n=t[e];n&&document.removeEventListener(n,i)}};return Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(document[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[e.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[e.fullscreenEnabled])}}}),i}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=[].slice.call(e.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),i=function(e){"console"in window&&console.error&&console.error("There was an error creating an embed: ".concat(e))};t.forEach((function(e){try{if(null!==e.getAttribute("data-vimeo-defer"))return;var t=I(e);E(h(t),t,e).then((function(t){return P(t,e)})).catch(i)}catch(e){i(e)}}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoPlayerResizeEmbeds_){window.VimeoPlayerResizeEmbeds_=!0;var t=function(t){if(d(t.origin)&&t.data&&"spacechange"===t.data.event)for(var i=e.querySelectorAll("iframe"),n=0;n<i.length;n++)if(i[n].contentWindow===t.source){i[n].parentElement.style.paddingBottom="".concat(t.data.data[0].bottom,"px");break}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoSeoMetadataAppended){window.VimeoSeoMetadataAppended=!0;var t=function(t){if(d(t.origin)){var i=T(t.data);if(i&&"ready"===i.event)for(var n=e.querySelectorAll("iframe"),r=0;r<n.length;r++){var a=n[r],s=a.contentWindow===t.source;c(a.src)&&s&&new A(a).callMethod("appendVideoMetadata",window.location.href)}}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoCheckedUrlTimeParam){window.VimeoCheckedUrlTimeParam=!0;var t=function(e){"console"in window&&console.error&&console.error("There was an error getting video Id: ".concat(e))},i=function(i){if(d(i.origin)){var n=T(i.data);if(n&&"ready"===n.event)for(var r=e.querySelectorAll("iframe"),a=0;a<r.length;a++){var s=r[a],o=s.contentWindow===i.source;c(s.src)&&o&&function(){var e=new A(s);e.getVideoId().then((function(t){var i=new RegExp("[?&]vimeo_t_".concat(t,"=([^&#]*)")).exec(window.location.href);if(i&&i[1]){var n=decodeURI(i[1]);e.setCurrentTime(n)}})).catch(t)}()}}};window.addEventListener("message",i)}}()),t.a=A}).call(this,i(94),i(203).setImmediate)},function(e,t,i){var n,r,a;!function(s,o){"use strict";r=[i(208)],void 0===(a="function"==typeof(n=function(e){var t=/(^|@)\S+:\d+/,i=/^\s*at .*(\S+:\d+|\(native\))/m,n=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(i))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(i)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var i=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=i.match(/ (\((.+):(\d+):(\d+)\)$)/),r=(i=n?i.replace(n[0],""):i).split(/\s+/).slice(1),a=this.extractLocation(n?n[1]:r.pop()),s=r.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new e({functionName:s,fileName:o,lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(n)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var i=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=t.match(i),r=n&&n[1]?n[1]:void 0,a=this.extractLocation(t.replace(i,""));return new e({functionName:r,fileName:a[0],lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),r=[],a=2,s=n.length;a<s;a+=2){var o=i.exec(n[a]);o&&r.push(new e({fileName:o[2],lineNumber:o[1],source:n[a]}))}return r},parseOpera10:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),r=[],a=0,s=n.length;a<s;a+=2){var o=i.exec(n[a]);o&&r.push(new e({functionName:o[3]||void 0,fileName:o[2],lineNumber:o[1],source:n[a]}))}return r},parseOpera11:function(i){return i.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var i,n=t.split("@"),r=this.extractLocation(n.pop()),a=n.shift()||"",s=a.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;a.match(/\(([^)]*)\)/)&&(i=a.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var o=void 0===i||"[arguments not available]"===i?void 0:i.split(",");return new e({functionName:s,args:o,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:t})}),this)}}})?n.apply(t,r):n)||(e.exports=a)}()},function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return l}));var n,r=function(){return(r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},a="undefined"==typeof window?e:window,s=a&&a.CSPSettings&&a.CSPSettings.nonce,o=((n=a.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(n=r(r({},n),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),n.registeredThemableStyles||(n=r(r({},n),{registeredThemableStyles:[]})),a.__themeState__=n,n);function l(e){o.theme=e,function(){if(o.theme){for(var e=[],t=0,i=o.registeredThemableStyles;t<i.length;t++){var n=i[t];e.push(n.themableStyle)}e.length>0&&(void 0===(a=1)&&(a=3),3!==a&&2!==a||(d(o.registeredStyles),o.registeredStyles=[]),3!==a&&1!==a||(d(o.registeredThemableStyles),o.registeredThemableStyles=[]),r=[].concat.apply([],e),o.loadStyles?o.loadStyles(c(r).styleString,r):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],i=document.createElement("style"),n=c(e),r=n.styleString,a=n.themable;i.setAttribute("data-load-themed-styles","true"),s&&i.setAttribute("nonce",s),i.appendChild(document.createTextNode(r)),o.perf.count++,t.appendChild(i);var l=document.createEvent("HTMLEvents");l.initEvent("styleinsert",!0,!1),l.args={newStyle:i},document.dispatchEvent(l);var d={styleElement:i,themableStyle:e};a?o.registeredThemableStyles.push(d):o.registeredStyles.push(d)}}(r))}var r,a}()}function d(e){e.forEach((function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)}))}function c(e){var t=o.theme,i=!1;return{styleString:(e||[]).map((function(e){var n=e.theme;if(n){i=!0;var r=t?t[n]:void 0,a=e.defaultValue||"inherit";return t&&!r&&console&&!(n in t)&&"undefined"!=typeof DEBUG&&DEBUG&&console.warn('Theming value not provided for "'.concat(n,'". Falling back to "').concat(a,'".')),r||a}return e.rawString})).join(""),themable:i}}}).call(this,i(94))},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n={},r=void 0;try{r=window}catch(e){}function a(e,t){if(void 0!==r){var i=r.__packages__=r.__packages__||{};i[e]&&n[e]||(n[e]=t,(i[e]=i[e]||[]).push(t))}}a("@fluentui/set-version","6.0.0")},function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return o})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(n||(n={}));var r=i(7);class a{handleTrace(e){e.message.length>a.messageMaxChars&&(e.message=e.message.substr(0,a.messageMaxChars-a.trimmedMessage.length)+a.trimmedMessage),this.logCache.push(e),(this.logCache.length>a.uploadTriggerSize||e.level===r.a.Error)&&this.triggerUploadAsync()}constructor(e,t,i){this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=()=>{this.triggerUpload(!1,!1)},this.flush=()=>{this.triggerUploadAsync()},this.triggerUploadAsync=()=>{window.setTimeout(()=>this.triggerUpload(!0,!0),0)},this.triggerUpload=(e,t)=>{window.clearTimeout(this.timeoutId),this.logCache.length>0&&(this.uploadId+=1,function(e,t,i){if(!t)return;const n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch{}!function(e,t,i){const n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}(function(e,t,i,n){const r=[],a=e.map(e=>function(e,t,i){const n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){let t=i.findIndex(t=>t===e.correlationId);t<0&&(t=i.push(e.correlationId)-1),n.I=t}const r=1e3*e.type+e.level;return n.D=r,n}(e,n,r)),s=function(e,t,i,n,r){const a={};return a.T=e,a.L=t,a.S=i,a.I=n,r&&r.length>0&&(a.W=r),a.V=1,a}(n,a,t,i,r);return JSON.stringify(s)}(this.logCache,this.userSessionId,this.uploadId,this.timestampBase),this.remoteUrlEndpoint,t),this.logCache=[],this.timestampBase=Date.now()),e&&(this.timeoutId=window.setTimeout(this.triggerUploadAsync,a.uploadCadenceInMsSec))},this.userSessionId=e;let n=t+"?usid="+e;void 0!==i&&i.forEach((e,t)=>{n+="&"+t+"="+e}),this.remoteUrlEndpoint=n,window.setTimeout(()=>this.triggerUpload(!0,!0),0)}}a.messageMaxChars=3072,a.uploadCadenceInMsSec=3e4,a.uploadTriggerSize=30,a.trimmedMessage="... [Trimmed]";class s{setCorrelationId(e){this.correlationId=e}sendTraceTag(e,t,i,n){l(this.cache,e,t,i,n,this.correlationId)}debugAssertTag(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")}shipAssertTag(e,t,i,n){i&&l(this.cache,e,t,r.a.Error,n,this.correlationId)}flush(){this.cache.flush()}flushOnClose(){this.cache.flushOnClose}constructor(e,t,i){this.correlationId="",this.cache=new a(e,t,i)}}function o(e,t){return new s(e,t)}function l(e,t,i,a,s,o){if(a>r.a.Info)return;const l={timestamp:Date.now(),category:i,tag:t,level:a,type:n.Trace,message:s,correlationId:o};e.handleTrace(l)}},function(e,t,i){"use strict";var n=i(48);n.a.prototype._readTexturePixelsSync=function(e,t,i,n=-1,r=0,a=null,s=!0,o=!1,l=0,d=0){const c=this._gl;if(!c)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){const e=c.createFramebuffer();if(!e)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=e}var h,u;c.bindFramebuffer(c.FRAMEBUFFER,this._dummyFramebuffer),n>-1?c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+n,null===(h=e._hardwareTexture)||void 0===h?void 0:h.underlyingResource,r):c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null===(u=e._hardwareTexture)||void 0===u?void 0:u.underlyingResource,r);let m=void 0!==e.type?this._getWebGLTextureType(e.type):c.UNSIGNED_BYTE;if(o)a||(a=function(e,t,i=!1,n){switch(e){case 3:{const e=(ArrayBuffer,new Int8Array(t));return n&&e.set(new Int8Array(n)),e}case 0:{const e=(ArrayBuffer,new Uint8Array(t));return n&&e.set(new Uint8Array(n)),e}case 4:{const e=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(i?t/2:t);return n&&e.set(new Int16Array(n)),e}case 5:case 8:case 9:case 10:case 2:{const e=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(i?t/2:t);return n&&e.set(new Uint16Array(n)),e}case 6:{const e=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(i?t/4:t);return n&&e.set(new Int32Array(n)),e}case 7:case 11:case 12:case 13:case 14:case 15:{const e=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(i?t/4:t);return n&&e.set(new Uint32Array(n)),e}case 1:{const e=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(i?t/4:t);return n&&e.set(new Float32Array(n)),e}}const r=(ArrayBuffer,new Uint8Array(t));return n&&r.set(new Uint8Array(n)),r}(e.type,4*t*i));else switch(m){case c.UNSIGNED_BYTE:a||(a=new Uint8Array(4*t*i)),m=c.UNSIGNED_BYTE;break;default:a||(a=new Float32Array(4*t*i)),m=c.FLOAT}return s&&this.flushFramebuffer(),c.readPixels(l,d,t,i,c.RGBA,m,a),c.bindFramebuffer(c.FRAMEBUFFER,this._currentFramebuffer),a},n.a.prototype._readTexturePixels=function(e,t,i,n=-1,r=0,a=null,s=!0,o=!1,l=0,d=0){return Promise.resolve(this._readTexturePixelsSync(e,t,i,n,r,a,s,o,l,d))}},function(e,t,i){"use strict";var n=i(55),r=i(41),a=i(48);class s extends class{get depthStencilTexture(){return this._depthStencilTexture}get depthStencilTextureWithStencil(){return this._depthStencilTextureWithStencil}get isCube(){return this._isCube}get isMulti(){return this._isMulti}get is2DArray(){return this.layers>0}get is3D(){return this.depth>0}get size(){return this.width}get width(){return this._size.width||this._size}get height(){return this._size.height||this._size}get layers(){return this._size.layers||0}get depth(){return this._size.depth||0}get texture(){var e,t;return null!==(e=null===(t=this._textures)||void 0===t?void 0:t[0])&&void 0!==e?e:null}get textures(){return this._textures}get faceIndices(){return this._faceIndices}get layerIndices(){return this._layerIndices}get samples(){return this._samples}setSamples(e,t=!0,i=!1){if(this.samples===e&&!i)return e;const n=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,e,t):this._engine.updateRenderTargetTextureSampleCount(this,e);return this._samples=e,n}setTextures(e){Array.isArray(e)?this._textures=e:this._textures=e?[e]:null}setTexture(e,t=0,i=!0){this._textures||(this._textures=[]),this._textures[t]!==e&&(this._textures[t]&&i&&this._textures[t].dispose(),this._textures[t]=e)}setLayerAndFaceIndices(e,t){this._layerIndices=e,this._faceIndices=t}setLayerAndFaceIndex(e=0,t,i){this._layerIndices||(this._layerIndices=[]),this._faceIndices||(this._faceIndices=[]),void 0!==t&&t>=0&&(this._layerIndices[e]=t),void 0!==i&&i>=0&&(this._faceIndices[e]=i)}createDepthStencilTexture(e=0,t=!0,i=!1,n=1,r=14,a){var s;return null===(s=this._depthStencilTexture)||void 0===s||s.dispose(),this._depthStencilTextureWithStencil=i,this._depthStencilTextureLabel=a,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:t,comparisonFunction:e,generateStencil:i,isCube:this._isCube,samples:n,depthTextureFormat:r,label:a},this),this._depthStencilTexture}_shareDepth(e){this.shareDepth(e)}shareDepth(e){this._depthStencilTexture&&(e._depthStencilTexture&&e._depthStencilTexture.dispose(),e._depthStencilTexture=this._depthStencilTexture,e._depthStencilTextureWithStencil=this._depthStencilTextureWithStencil,this._depthStencilTexture.incrementReferences())}_swapAndDie(e){this.texture&&this.texture._swapAndDie(e),this._textures=null,this.dispose(!0)}_cloneRenderTargetWrapper(){let e=null;if(this._isMulti){const n=this.textures;if(n&&n.length>0){let r=!1,a=n.length,s=-1;const o=n[n.length-1]._source;14!==o&&12!==o||(r=!0,s=n[n.length-1].format,a--);const l=[],d=[],c=[],h=[],u=[],m=[],f=[],p={};for(let e=0;e<a;++e){const r=n[e];var t,i;l.push(r.samplingMode),d.push(r.type),c.push(r.format),void 0!==p[r.uniqueId]?(h.push(-1),f.push(0)):(p[r.uniqueId]=e,r.is2DArray?(h.push(35866),f.push(r.depth)):r.isCube?(h.push(34067),f.push(0)):r.is3D?(h.push(32879),f.push(r.depth)):(h.push(3553),f.push(0))),this._faceIndices&&u.push(null!==(t=this._faceIndices[e])&&void 0!==t?t:0),this._layerIndices&&m.push(null!==(i=this._layerIndices[e])&&void 0!==i?i:0)}const g={samplingModes:l,generateMipMaps:n[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:r,depthTextureFormat:s,types:d,formats:c,textureCount:a,targetTypes:h,faceIndex:u,layerIndex:m,layerCounts:f,label:this.label},_={width:this.width,height:this.height,depth:this.depth};e=this._engine.createMultipleRenderTarget(_,g);for(let t=0;t<a;++t){if(-1!==h[t])continue;const i=p[n[t].uniqueId];e.setTexture(e.textures[i],t)}}}else{var n,r,a,s,o;const t={};if(t.generateDepthBuffer=this._generateDepthBuffer,t.generateMipMaps=null!==(n=null===(r=this.texture)||void 0===r?void 0:r.generateMipMaps)&&void 0!==n&&n,t.generateStencilBuffer=this._generateStencilBuffer,t.samplingMode=null===(a=this.texture)||void 0===a?void 0:a.samplingMode,t.type=null===(s=this.texture)||void 0===s?void 0:s.type,t.format=null===(o=this.texture)||void 0===o?void 0:o.format,t.noColorAttachment=!this._textures,t.label=this.label,this.isCube)e=this._engine.createRenderTargetCubeTexture(this.width,t);else{var l;const i={width:this.width,height:this.height,layers:this.is2DArray||this.is3D?null===(l=this.texture)||void 0===l?void 0:l.depth:void 0};e=this._engine.createRenderTargetTexture(i,t)}e.texture&&(e.texture.isReady=!0)}return e}_swapRenderTargetWrapper(e){if(this._textures&&e._textures)for(let t=0;t<this._textures.length;++t)this._textures[t]._swapAndDie(e._textures[t],!1),e._textures[t].isReady=!0;this._depthStencilTexture&&e._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(e._depthStencilTexture),e._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null}_rebuild(){const e=this._cloneRenderTargetWrapper();if(e){if(this._depthStencilTexture){const t=this._depthStencilTexture.samplingMode,i=this._depthStencilTexture.format,n=2===t||3===t||11===t;e.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,n,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples,i,this._depthStencilTextureLabel)}this.samples>1&&e.setSamples(this.samples),e._swapRenderTargetWrapper(this),e.dispose()}}releaseTextures(){if(this._textures)for(let i=0;null!==(e=i<(null===(t=this._textures)||void 0===t?void 0:t.length))&&void 0!==e&&e;++i){var e,t;this._textures[i].dispose()}this._textures=null}dispose(e=!1){var t;e||(null===(t=this._depthStencilTexture)||void 0===t||t.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)}constructor(e,t,i,n,r){this._textures=null,this._faceIndices=null,this._layerIndices=null,this._samples=1,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=e,this._isCube=t,this._size=i,this._engine=n,this._depthStencilTexture=null,this.label=r}}{_cloneRenderTargetWrapper(){let e=null;return this._colorTextureArray&&this._depthStencilTextureArray?(e=this._engine.createMultiviewRenderTargetTexture(this.width,this.height),e.texture.isReady=!0):e=super._cloneRenderTargetWrapper(),e}_swapRenderTargetWrapper(e){super._swapRenderTargetWrapper(e),e._framebuffer=this._framebuffer,e._depthStencilBuffer=this._depthStencilBuffer,e._MSAAFramebuffer=this._MSAAFramebuffer,e._colorTextureArray=this._colorTextureArray,e._depthStencilTextureArray=this._depthStencilTextureArray,this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null}createDepthStencilTexture(e=0,t=!0,i=!1,n=1,r=14,a){if(this._depthStencilBuffer){const e=this._engine,t=e._currentFramebuffer,i=this._context;e._bindUnboundFramebuffer(this._framebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,null),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,null),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,null),e._bindUnboundFramebuffer(t),i.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null}return super.createDepthStencilTexture(e,t,i,n,r,a)}shareDepth(e){super.shareDepth(e);const t=this._context,i=this._depthStencilBuffer,n=e._MSAAFramebuffer||e._framebuffer,r=this._engine;e._depthStencilBuffer&&e._depthStencilBuffer!==i&&t.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=i;const a=e._generateStencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;r._bindUnboundFramebuffer(n),t.framebufferRenderbuffer(t.FRAMEBUFFER,a,t.RENDERBUFFER,i),r._bindUnboundFramebuffer(null)}_bindTextureRenderTarget(e,t=0,i,n=0){if(!e._hardwareTexture)return;const r=this._framebuffer,a=this._engine,s=a._currentFramebuffer;if(a._bindUnboundFramebuffer(r),a.webGLVersion>1){const r=this._context,a=r["COLOR_ATTACHMENT"+t];var o,l,d;if(e.is2DArray||e.is3D)i=null!==(o=null!==(l=i)&&void 0!==l?l:null===(d=this.layerIndices)||void 0===d?void 0:d[t])&&void 0!==o?o:0,r.framebufferTextureLayer(r.FRAMEBUFFER,a,e._hardwareTexture.underlyingResource,n,i);else if(e.isCube){var c,h,u;i=null!==(c=null!==(h=i)&&void 0!==h?h:null===(u=this.faceIndices)||void 0===u?void 0:u[t])&&void 0!==c?c:0,r.framebufferTexture2D(r.FRAMEBUFFER,a,r.TEXTURE_CUBE_MAP_POSITIVE_X+i,e._hardwareTexture.underlyingResource,n)}else r.framebufferTexture2D(r.FRAMEBUFFER,a,r.TEXTURE_2D,e._hardwareTexture.underlyingResource,n)}else{const r=this._context,a=r["COLOR_ATTACHMENT"+t+"_WEBGL"],s=void 0!==i?r.TEXTURE_CUBE_MAP_POSITIVE_X+i:r.TEXTURE_2D;r.framebufferTexture2D(r.FRAMEBUFFER,a,s,e._hardwareTexture.underlyingResource,n)}a._bindUnboundFramebuffer(s)}setTexture(e,t=0,i=!0){super.setTexture(e,t,i),this._bindTextureRenderTarget(e,t)}setLayerAndFaceIndices(e,t){var i,n;if(super.setLayerAndFaceIndices(e,t),!this.textures||!this.layerIndices||!this.faceIndices)return;const r=null!==(i=null===(n=this._attachments)||void 0===n?void 0:n.length)&&void 0!==i?i:this.textures.length;for(let e=0;e<r;e++){const t=this.textures[e];t&&(t.is2DArray||t.is3D?this._bindTextureRenderTarget(t,e,this.layerIndices[e]):t.isCube?this._bindTextureRenderTarget(t,e,this.faceIndices[e]):this._bindTextureRenderTarget(t,e))}}setLayerAndFaceIndex(e=0,t,i){if(super.setLayerAndFaceIndex(e,t,i),!this.textures||!this.layerIndices||!this.faceIndices)return;const n=this.textures[e];n.is2DArray||n.is3D?this._bindTextureRenderTarget(this.textures[e],e,this.layerIndices[e]):n.isCube&&this._bindTextureRenderTarget(this.textures[e],e,this.faceIndices[e])}dispose(e=this._disposeOnlyFramebuffers){const t=this._context;e||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null)),this._framebuffer&&(t.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._depthStencilBuffer&&(t.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null),this._MSAAFramebuffer&&(t.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null),super.dispose(e)}constructor(e,t,i,n,r){super(e,t,i,n),this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._disposeOnlyFramebuffers=!1,this._currentLOD=0,this._context=r}}i(195),a.a.prototype._createHardwareRenderTargetWrapper=function(e,t,i){const n=new s(e,t,i,this,this._gl);return this._renderTargetWrapperCache.push(n),n},a.a.prototype.createRenderTargetTexture=function(e,t){var i;const n=this._createHardwareRenderTargetWrapper(!1,!1,e);let r=!0,a=!1,s=!1,o=void 0,l=1,d=void 0;var c,h;void 0!==t&&"object"==typeof t&&(r=null===(c=t.generateDepthBuffer)||void 0===c||c,a=!!t.generateStencilBuffer,s=!!t.noColorAttachment,o=t.colorAttachment,l=null!==(h=t.samples)&&void 0!==h?h:1,d=t.label);const u=o||(s?null:this._createInternalTexture(e,t,!0,5)),m=e.width||e,f=e.height||e,p=this._currentFramebuffer,g=this._gl,_=g.createFramebuffer();return this._bindUnboundFramebuffer(_),n._depthStencilBuffer=this._setupFramebufferDepthAttachments(a,r,m,f),!u||u.is2DArray||u.is3D||g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(p),n.label=null!==(i=d)&&void 0!==i?i:"RenderTargetWrapper",n._framebuffer=_,n._generateDepthBuffer=r,n._generateStencilBuffer=a,n.setTextures(u),this.updateRenderTargetTextureSampleCount(n,l),n},a.a.prototype._createDepthStencilTexture=function(e,t){const i=this._gl,a=e.layers||0,s=e.depth||0;let o=i.TEXTURE_2D;0!==a?o=i.TEXTURE_2D_ARRAY:0!==s&&(o=i.TEXTURE_3D);const l=new n.a(this,12);if(l.label=t.label,!this._caps.depthTextureExtension)return r.a.Error("Depth texture is not supported by your browser or hardware."),l;const d={bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1,...t};if(this._bindTextureDirectly(o,l,!0),this._setupDepthStencilTexture(l,e,d.generateStencil,0!==d.comparisonFunction&&d.bilinearFiltering,d.comparisonFunction,d.samples),void 0!==d.depthTextureFormat){if(15!==d.depthTextureFormat&&16!==d.depthTextureFormat&&17!==d.depthTextureFormat&&13!==d.depthTextureFormat&&14!==d.depthTextureFormat&&18!==d.depthTextureFormat)return r.a.Error("Depth texture format is not supported."),l;l.format=d.depthTextureFormat}else l.format=d.generateStencil?13:16;const c=17===l.format||13===l.format||18===l.format;let h=i.UNSIGNED_INT;15===l.format?h=i.UNSIGNED_SHORT:17===l.format||13===l.format?h=i.UNSIGNED_INT_24_8:14===l.format?h=i.FLOAT:18===l.format&&(h=i.FLOAT_32_UNSIGNED_INT_24_8_REV);const u=c?i.DEPTH_STENCIL:i.DEPTH_COMPONENT;let m=u;return this.webGLVersion>1&&(15===l.format?m=i.DEPTH_COMPONENT16:16===l.format?m=i.DEPTH_COMPONENT24:17===l.format||13===l.format?m=i.DEPTH24_STENCIL8:14===l.format?m=i.DEPTH_COMPONENT32F:18===l.format&&(m=i.DEPTH32F_STENCIL8)),l.is2DArray?i.texImage3D(o,0,m,l.width,l.height,a,0,u,h,null):l.is3D?i.texImage3D(o,0,m,l.width,l.height,s,0,u,h,null):i.texImage2D(o,0,m,l.width,l.height,0,u,h,null),this._bindTextureDirectly(o,null),this._internalTexturesCache.push(l),l},a.a.prototype.updateRenderTargetTextureSampleCount=function(e,t){if(this.webGLVersion<2||!e||!e.texture)return 1;if(e.samples===t)return t;const i=this._gl;t=Math.min(t,this.getCaps().maxMSAASamples),e._depthStencilBuffer&&(i.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=null),e._MSAAFramebuffer&&(i.deleteFramebuffer(e._MSAAFramebuffer),e._MSAAFramebuffer=null);const n=e.texture._hardwareTexture;if(n.releaseMSAARenderBuffers(),t>1&&"function"==typeof i.renderbufferStorageMultisample){const r=i.createFramebuffer();if(!r)throw new Error("Unable to create multi sampled framebuffer");e._MSAAFramebuffer=r,this._bindUnboundFramebuffer(e._MSAAFramebuffer);const a=this._createRenderBuffer(e.texture.width,e.texture.height,t,-1,this._getRGBABufferInternalSizedFormat(e.texture.type,e.texture.format,e.texture._useSRGBBuffer),i.COLOR_ATTACHMENT0,!1);if(!a)throw new Error("Unable to create multi sampled framebuffer");n.addMSAARenderBuffer(a)}else this._bindUnboundFramebuffer(e._framebuffer);return e.texture.samples=t,e._samples=t,e._depthStencilBuffer=this._setupFramebufferDepthAttachments(e._generateStencilBuffer,e._generateDepthBuffer,e.texture.width,e.texture.height,t),this._bindUnboundFramebuffer(null),t},a.a.prototype._setupDepthStencilTexture=function(e,t,i,n,r,a=1){const s=t.width||t,o=t.height||t,l=t.layers||0,d=t.depth||0;e.baseWidth=s,e.baseHeight=o,e.width=s,e.height=o,e.is2DArray=l>0,e.depth=l||d,e.isReady=!0,e.samples=a,e.generateMipMaps=!1,e.samplingMode=n?2:1,e.type=0,e._comparisonFunction=r;const c=this._gl,h=this._getTextureTarget(e),u=this._getSamplingParameters(e.samplingMode,!1);c.texParameteri(h,c.TEXTURE_MAG_FILTER,u.mag),c.texParameteri(h,c.TEXTURE_MIN_FILTER,u.min),c.texParameteri(h,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(h,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),this.webGLVersion>1&&(0===r?(c.texParameteri(h,c.TEXTURE_COMPARE_FUNC,515),c.texParameteri(h,c.TEXTURE_COMPARE_MODE,c.NONE)):(c.texParameteri(h,c.TEXTURE_COMPARE_FUNC,r),c.texParameteri(h,c.TEXTURE_COMPARE_MODE,c.COMPARE_REF_TO_TEXTURE)))}},function(e,t,i){"use strict";i(97).a.prototype.createDepthStencilTexture=function(e,t,i){if(t.isCube){const i=e.width||e;return this._createDepthStencilCubeTexture(i,t)}return this._createDepthStencilTexture(e,t,i)}},function(e,t,i){"use strict";var n=i(48);n.a.prototype.updateDynamicIndexBuffer=function(e,t,i=0){let n;this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),n=e.is32Bits?t instanceof Uint32Array?t:new Uint32Array(t):t instanceof Uint16Array?t:new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,n,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},n.a.prototype.updateDynamicVertexBuffer=function(e,t,i,n){this.bindArrayBuffer(e),void 0===i&&(i=0);const r=t.byteLength||t.length;void 0===n||n>=r&&0===i?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(i,i+n)):(t=t instanceof ArrayBuffer?new Uint8Array(t,i,n):new Uint8Array(t.buffer,t.byteOffset+i,n),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()}},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeGate=void 0;var n=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=n},function(e,t,i){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(r.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new a(r.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(204),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i(94))},function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var n,r,a,s,o,l=1,d={},c=!1,h=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){f(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?(s="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&f(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),n=function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){f(e.data)},n=function(e){a.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,n=function(e){var t=h.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):n=function(e){setTimeout(f,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var r={callback:e,args:t};return d[l]=r,n(l),l++},u.clearImmediate=m}function m(e){delete d[e]}function f(e){if(c)setTimeout(f,0,e);else{var t=d[e];if(t){c=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(void 0,i)}}(t)}finally{m(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,i(94),i(168))},function(e,t,i){var n,r,a=i(177),s=i(178),o=0,l=0;e.exports=function(e,t,i){var d=t&&i||0,c=t||[],h=(e=e||{}).node||n,u=void 0!==e.clockseq?e.clockseq:r;if(null==h||null==u){var m=a();null==h&&(h=n=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==u&&(u=r=16383&(m[6]<<8|m[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:l+1,g=f-o+(p-l)/1e4;if(g<0&&void 0===e.clockseq&&(u=u+1&16383),(g<0||f>o)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=f,l=p,r=u;var _=(1e4*(268435455&(f+=122192928e5))+p)%4294967296;c[d++]=_>>>24&255,c[d++]=_>>>16&255,c[d++]=_>>>8&255,c[d++]=255&_;var S=f/4294967296*1e4&268435455;c[d++]=S>>>8&255,c[d++]=255&S,c[d++]=S>>>24&15|16,c[d++]=S>>>16&255,c[d++]=u>>>8|128,c[d++]=255&u;for(var v=0;v<6;++v)c[d+v]=h[v];return t||s(c)}},function(e,t,i){var n=i(177),r=i(178);e.exports=function(e,t,i){var a=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var o=0;o<16;++o)t[a+o]=s[o];return t||r(s)}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,i){var n,r,a;!function(i,s){"use strict";r=[],void 0===(a="function"==typeof(n=function(){function e(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var i=["isConstructor","isEval","isNative","isToplevel"],n=["columnNumber","lineNumber"],r=["fileName","functionName","source"],a=i.concat(n,r,["args"],["evalOrigin"]);function s(t){if(t)for(var i=0;i<a.length;i++)void 0!==t[a[i]]&&this["set"+e(a[i])](t[a[i]])}s.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof s)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new s(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",i=this.getColumnNumber()||"",n=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+i+")":"[eval]:"+t+":"+i:n?n+" ("+e+":"+t+":"+i+")":e+":"+t+":"+i}},s.fromString=function(e){var t=e.indexOf("("),i=e.lastIndexOf(")"),n=e.substring(0,t),r=e.substring(t+1,i).split(","),a=e.substring(i+1);if(0===a.indexOf("@"))var o=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(a,""),l=o[1],d=o[2],c=o[3];return new s({functionName:n,args:r||void 0,fileName:l,lineNumber:d||void 0,columnNumber:c||void 0})};for(var o=0;o<i.length;o++)s.prototype["get"+e(i[o])]=t(i[o]),s.prototype["set"+e(i[o])]=function(e){return function(t){this[e]=Boolean(t)}}(i[o]);for(var l=0;l<n.length;l++)s.prototype["get"+e(n[l])]=t(n[l]),s.prototype["set"+e(n[l])]=function(e){return function(t){if(i=t,isNaN(parseFloat(i))||!isFinite(i))throw new TypeError(e+" must be a Number");var i;this[e]=Number(t)}}(n[l]);for(var d=0;d<r.length;d++)s.prototype["get"+e(r[d])]=t(r[d]),s.prototype["set"+e(r[d])]=function(e){return function(t){this[e]=String(t)}}(r[d]);return s})?n.apply(t,r):n)||(e.exports=a)}()},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){var n=i(100),r=i(101),a=i(95).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,r.call(this,64,56)}function d(e){return e<<30|e>>>2}function c(e,t,i,n){return 0===e?t&i|~t&n:2===e?t&i|t&n|i&n:t^i^n}n(l,r),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,i=this._w,n=0|this._a,r=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,h=0;h<16;++h)i[h]=e.readInt32BE(4*h);for(;h<80;++h)i[h]=i[h-3]^i[h-8]^i[h-14]^i[h-16];for(var u=0;u<80;++u){var m=~~(u/20),f=0|((t=n)<<5|t>>>27)+c(m,r,a,o)+l+i[u]+s[m];l=o,o=a,a=d(r),r=n,n=f}this._a=n+this._a|0,this._b=r+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,i){"use strict";(function(e){var n=i(212),r=i(213),a=i(214);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return d(this,e,t,i)}function d(e,t,i,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,n){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===i&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,i):new Uint8Array(t,i,n),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=u(e,t),e}(e,t,i,n):"string"==typeof t?function(e,t,i){if("string"==typeof i&&""!==i||(i="utf8"),!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(t,i),r=(e=o(e,n)).write(t,i);return r!==n&&(e=e.slice(0,r)),e}(e,t,i):function(e,t){if(l.isBuffer(t)){var i=0|m(t.length);return 0===(e=o(e,i)).length||t.copy(e,0,0,i),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?o(e,0):u(e,t);if("Buffer"===t.type&&a(t.data))return u(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(c(t),e=o(e,t<0?0:0|m(t)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function u(e,t){var i=t.length<0?0:0|m(t.length);e=o(e,i);for(var n=0;n<i;n+=1)e[n]=255&t[n];return e}function m(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return W(e).length;default:if(n)return V(e).length;t=(""+t).toLowerCase(),n=!0}}function p(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,i);case"utf8":case"utf-8":return P(this,t,i);case"ascii":return E(this,t,i);case"latin1":case"binary":return x(this,t,i);case"base64":return I(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function _(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:S(e,t,i,n,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):S(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function S(e,t,i,n,r){var a,s=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,i/=2}function d(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var c=-1;for(a=i;a<o;a++)if(d(e,a)===d(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*s}else-1!==c&&(a-=a-c),c=-1}else for(i+l>o&&(i=o-l),a=i;a>=0;a--){for(var h=!0,u=0;u<l;u++)if(d(e,a+u)!==d(t,u)){h=!1;break}if(h)return a}return-1}function v(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var s=0;s<n;++s){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[i+s]=o}return s}function y(e,t,i,n){return U(V(t,e.length-i),e,i,n)}function T(e,t,i,n){return U(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function b(e,t,i,n){return T(e,t,i,n)}function w(e,t,i,n){return U(W(t),e,i,n)}function C(e,t,i,n){return U(function(e,t){for(var i,n,r,a=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(i=e.charCodeAt(s))>>8,r=i%256,a.push(r),a.push(n);return a}(t,e.length-i),e,i,n)}function I(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function P(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var a,s,o,l,d=e[r],c=null,h=d>239?4:d>223?3:d>191?2:1;if(r+h<=i)switch(h){case 1:d<128&&(c=d);break;case 2:128==(192&(a=e[r+1]))&&(l=(31&d)<<6|63&a)>127&&(c=l);break;case 3:a=e[r+1],s=e[r+2],128==(192&a)&&128==(192&s)&&(l=(15&d)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[r+1],s=e[r+2],o=e[r+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&d)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),r+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var i="",n=0;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return i}(n)}function E(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function x(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function k(e,t,i){var n,r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);for(var a="",s=t;s<i;++s)a+=(n=e[s])<16?"0"+n.toString(16):n.toString(16);return a}function M(e,t,i){for(var n=e.slice(t,i),r="",a=0;a<n.length;a+=2)r+=String.fromCharCode(n[a]+256*n[a+1]);return r}function A(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,i,n,r,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function O(e,t,i,n){t<0&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-i,2);r<a;++r)e[i+r]=(t&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function F(e,t,i,n){t<0&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-i,4);r<a;++r)e[i+r]=t>>>8*(n?r:3-r)&255}function D(e,t,i,n,r,a){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function L(e,t,i,n,a){return a||D(e,0,i,4),r.write(e,t,i,n,23,4),i+4}function B(e,t,i,n,a){return a||D(e,0,i,8),r.write(e,t,i,n,52,8),i+8}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,i){return d(null,e,t,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,i){return function(e,t,i,n){return c(t),t<=0?o(null,t):void 0!==i?"string"==typeof n?o(null,t).fill(i,n):o(null,t).fill(i):o(null,t)}(0,e,t,i)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,r=0,a=Math.min(i,n);r<a;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=l.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var s=e[i];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?P(this,0,e):p.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,i,n,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;for(var a=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(t>>>=0),o=Math.min(a,s),d=this.slice(n,r),c=e.slice(t,i),h=0;h<o;++h)if(d[h]!==c[h]){a=d[h],s=c[h];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},l.prototype.indexOf=function(e,t,i){return _(this,e,t,i,!0)},l.prototype.lastIndexOf=function(e,t,i){return _(this,e,t,i,!1)},l.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return v(this,e,t,i);case"utf8":case"utf-8":return y(this,e,t,i);case"ascii":return T(this,e,t,i);case"latin1":case"binary":return b(this,e,t,i);case"base64":return w(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var i,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;i=new l(r,void 0);for(var a=0;a<r;++a)i[a]=this[a+e]}return i},l.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||A(e,t,this.length);for(var n=this[e],r=1,a=0;++a<t&&(r*=256);)n+=this[e+a]*r;return n},l.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||A(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},l.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||A(e,t,this.length);for(var n=this[e],r=1,a=0;++a<t&&(r*=256);)n+=this[e+a]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||A(e,t,this.length);for(var n=t,r=1,a=this[e+--n];n>0&&(r*=256);)a+=this[e+--n]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,i,n){e=+e,t|=0,i|=0,n||R(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,a=0;for(this[t]=255&e;++a<i&&(r*=256);)this[t+a]=e/r&255;return t+i},l.prototype.writeUIntBE=function(e,t,i,n){e=+e,t|=0,i|=0,n||R(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+i},l.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):F(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);R(this,e,t,i,r-1,-r)}var a=0,s=1,o=0;for(this[t]=255&e;++a<i&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+i},l.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);R(this,e,t,i,r-1,-r)}var a=i-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+i},l.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):F(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,i){return L(this,e,t,!0,i)},l.prototype.writeFloatBE=function(e,t,i){return L(this,e,t,!1,i)},l.prototype.writeDoubleLE=function(e,t,i){return B(this,e,t,!0,i)},l.prototype.writeDoubleBE=function(e,t,i){return B(this,e,t,!1,i)},l.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r,a=n-i;if(this===e&&i<t&&t<n)for(r=a-1;r>=0;--r)e[r+t]=this[r+i];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+a),t);return a},l.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var a;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(a=t;a<i;++a)this[a]=e;else{var s=l.isBuffer(e)?e:V(new l(e,n).toString()),o=s.length;for(a=0;a<i-t;++a)this[a+t]=s[a%o]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function V(e,t){var i;t=t||1/0;for(var n=e.length,r=null,a=[],s=0;s<n;++s){if((i=e.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&a.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&a.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;a.push(i)}else if(i<2048){if((t-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function W(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}}).call(this,i(94))},function(e,t,i){"use strict";t.byteLength=function(e){var t=d(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,n=d(e),s=n[0],o=n[1],l=new a(function(e,t,i){return 3*(t+i)/4-i}(0,s,o)),c=0,h=o>0?s-4:s;for(i=0;i<h;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===o&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,l[c++]=255&t),1===o&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,a=[],s=0,o=i-r;s<o;s+=16383)a.push(c(e,s,s+16383>o?o:s+16383));return 1===r?(t=e[i-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),a.join("")};for(var n=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)n[o]=s[o],r[s.charCodeAt(o)]=o;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function c(e,t,i){for(var r,a,s=[],o=t;o<i;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(n[(a=r)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,i,n,r){var a,s,o=8*r-n-1,l=(1<<o)-1,d=l>>1,c=-7,h=i?r-1:0,u=i?-1:1,m=e[t+h];for(h+=u,a=m&(1<<-c)-1,m>>=-c,c+=o;c>0;a=256*a+e[t+h],h+=u,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=n;c>0;s=256*s+e[t+h],h+=u,c-=8);if(0===a)a=1-d;else{if(a===l)return s?NaN:1/0*(m?-1:1);s+=Math.pow(2,n),a-=d}return(m?-1:1)*s*Math.pow(2,a-n)},t.write=function(e,t,i,n,r,a){var s,o,l,d=8*a-r-1,c=(1<<d)-1,h=c>>1,u=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:a-1,f=n?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?u/l:u*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(o=0,s=c):s+h>=1?(o=(t*l-1)*Math.pow(2,r),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[i+m]=255&o,m+=f,o/=256,r-=8);for(s=s<<r|o,d+=r;d>0;e[i+m]=255&s,m+=f,s/=256,d-=8);e[i+m-f]|=128*p}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t,i){var n=i(100),r=i(101),a=i(95).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,r.call(this,64,56)}function d(e){return e<<5|e>>>27}function c(e){return e<<30|e>>>2}function h(e,t,i,n){return 0===e?t&i|~t&n:2===e?t&i|t&n|i&n:t^i^n}n(l,r),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,i=this._w,n=0|this._a,r=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,u=0;u<16;++u)i[u]=e.readInt32BE(4*u);for(;u<80;++u)i[u]=(t=i[u-3]^i[u-8]^i[u-14]^i[u-16])<<1|t>>>31;for(var m=0;m<80;++m){var f=~~(m/20),p=d(n)+h(f,r,a,o)+l+i[m]+s[f]|0;l=o,o=a,a=c(r),r=n,n=p}this._a=n+this._a|0,this._b=r+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,i){var n=i(100),r=i(179),a=i(101),s=i(95).Buffer,o=new Array(64);function l(){this.init(),this._w=o,a.call(this,64,56)}n(l,r),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},function(e,t,i){var n=i(100),r=i(180),a=i(101),s=i(95).Buffer,o=new Array(160);function l(){this.init(),this._w=o,a.call(this,128,112)}n(l,r),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(48);function t(t,i,n){e.writeInt32BE(t,n),e.writeInt32BE(i,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},function(e,t,i){"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGatesManagerSet=t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=e=>{n=e},t.isChangeGateEnabled=e=>!n||n.isChangeGateEnabled(e),t.isChangeGatesManagerSet=()=>!!n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,i){"use strict";
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator,p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function S(e,t,i){this.props=e,this.context=t,this.refs=_,this.updater=i||p}function v(){}function y(e,t,i){this.props=e,this.context=t,this.refs=_,this.updater=i||p}S.prototype.isReactComponent={},S.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},S.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=S.prototype;var T=y.prototype=new v;T.constructor=y,g(T,S.prototype),T.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,C={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,i){var r,a={},s=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)w.call(t,r)&&!I.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=i;else if(1<l){for(var d=Array(l),c=0;c<l;c++)d[c]=arguments[c+2];a.children=d}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:n,type:e,key:s,ref:o,props:a,_owner:C.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function k(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function M(e,t,i){if(null==e)return e;var a=[],s=0;return function e(t,i,a,s,o){var l=typeof t;"undefined"!==l&&"boolean"!==l||(t=null);var d=!1;if(null===t)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case n:case r:d=!0}}if(d)return o=o(d=t),t=""===s?"."+k(d,0):s,b(o)?(a="",null!=t&&(a=t.replace(x,"$&/")+"/"),e(o,i,a,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(x,"$&/")+"/")+t)),i.push(o)),1;if(d=0,s=""===s?".":s+":",b(t))for(var c=0;c<t.length;c++){var h=s+k(l=t[c],c);d+=e(l,i,a,h,o)}else if("function"==typeof(h=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(t)))for(t=h.call(t),c=0;!(l=t.next()).done;)d+=e(l=l.value,i,a,h=s+k(l,c++),o);else if("object"===l)throw i=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===i?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return d}(e,a,"","",(function(e){return t.call(i,e,s++)})),a}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},O={transition:null},F={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:O,ReactCurrentOwner:C};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:M,forEach:function(e,t,i){M(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=S,t.Fragment=a,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=h,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=D,t.cloneElement=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=C.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)w.call(t,d)&&!I.hasOwnProperty(d)&&(r[d]=void 0===t[d]&&void 0!==l?l[d]:t[d])}var d=arguments.length-2;if(1===d)r.children=i;else if(1<d){l=Array(d);for(var c=0;c<d;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:n,type:e.type,key:a,ref:s,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:d,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,i){return R.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,i){return R.current.useReducer(e,t,i)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return R.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},function(e,t,i){"use strict";
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=i(35),r=i(222);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var c=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(e,t,i,n,r,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var _=/[\-:]([a-z])/g;function S(e){return e[1].toUpperCase()}function v(e,t,i,n){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null==t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!h.call(f,e)||!h.call(m,e)&&(u.test(e)?f[e]=!0:(m[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(_,S);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(_,S);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(_,S);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),E=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=F&&e[F]||e["@@iterator"])?e:null}var L,B=Object.assign;function N(e){if(void 0===L)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var V=!1;function W(e,t){if(!e||V)return"";V=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var r=t.stack.split("\n"),a=n.stack.split("\n"),s=r.length-1,o=a.length-1;1<=s&&0<=o&&r[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(r[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||r[s]!==a[o]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{V=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?N(e):""}function U(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return W(e.type,!1);case 11:return W(e.type.render,!1);case 1:return W(e.type,!0);default:return""}}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return function e(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case w:return"Fragment";case b:return"Portal";case I:return"Profiler";case C:return"StrictMode";case k:return"Suspense";case M:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case E:return(t.displayName||"Context")+".Consumer";case P:return(t._context.displayName||"Context")+".Provider";case x:var i=t.render;return(t=t.displayName)||(t=""!==(t=i.displayName||i.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case A:return null!==(i=t.displayName||null)?i:e(t.type)||"Memo";case R:i=t._payload,t=t._init;try{return e(t(i))}catch(e){}}return null}(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function j(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var r=i.get,a=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=G(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var i=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function J(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=H(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Y(e,t){X(e,t);var i=H(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?Q(e,t.type,i):t.hasOwnProperty("defaultValue")&&Q(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function K(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function Q(e,t,i){"number"===t&&q(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var ee=Array.isArray;function te(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+H(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(a(92));if(ee(i)){if(1<i.length)throw Error(a(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:H(i)}}function re(e,t){var i=H(t.value),n=H(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,de=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,i,n,r){MSApp.execUnsafeLocalFunction((function(){return e(t,i)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function ce(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ue=["Webkit","ms","Moz","O"];function me(e,t,i){return null==t||"boolean"==typeof t||""===t?"":i||"number"!=typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function fe(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=me(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(he).forEach((function(e){ue.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var pe=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(pe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function ve(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ye=null,Te=null,be=null;function we(e){if(e=hr(e)){if("function"!=typeof ye)throw Error(a(280));var t=e.stateNode;t&&(t=mr(t),ye(e.stateNode,e.type,t))}}function Ce(e){Te?be?be.push(e):be=[e]:Te=e}function Ie(){if(Te){var e=Te,t=be;if(be=Te=null,we(e),t)for(e=0;e<t.length;e++)we(t[e])}}function Pe(e,t){return e(t)}function Ee(){}var xe=!1;function ke(e,t,i){if(xe)return e(t,i);xe=!0;try{return Pe(e,t,i)}finally{xe=!1,(null!==Te||null!==be)&&(Ee(),Ie())}}function Me(e,t){var i=e.stateNode;if(null===i)return null;var n=mr(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!=typeof i)throw Error(a(231,t,typeof i));return i}var Ae=!1;if(c)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(e){Ae=!1}function Oe(e,t,i,n,r,a,s,o,l){var d=Array.prototype.slice.call(arguments,3);try{t.apply(i,d)}catch(e){this.onError(e)}}var Fe=!1,De=null,Le=!1,Be=null,Ne={onError:function(e){Fe=!0,De=e}};function Ve(e,t,i,n,r,a,s,o,l){Fe=!1,De=null,Oe.apply(Ne,arguments)}function We(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function ze(e){if(We(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(a(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(n=r.return)){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return ze(r),e;if(s===n)return ze(r),t;s=s.sibling}throw Error(a(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,l=r.child;l;){if(l===i){o=!0,i=r,n=s;break}if(l===n){o=!0,n=r,i=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===i){o=!0,i=s,n=r;break}if(l===n){o=!0,n=s,i=r;break}l=l.sibling}if(!o)throw Error(a(189))}}if(i.alternate!==n)throw Error(a(190))}if(3!==i.tag)throw Error(a(188));return i.stateNode.current===i?e:t}(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var i=e(t);if(null!==i)return i;t=t.sibling}return null}(e):null}var Ge=r.unstable_scheduleCallback,je=r.unstable_cancelCallback,$e=r.unstable_shouldYield,qe=r.unstable_requestPaint,Ze=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Xe=r.unstable_ImmediatePriority,Ye=r.unstable_UserBlockingPriority,Ke=r.unstable_NormalPriority,Qe=r.unstable_LowPriority,et=r.unstable_IdlePriority,tt=null,it=null,nt=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(rt(e)/at|0)|0},rt=Math.log,at=Math.LN2,st=64,ot=4194304;function lt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,a=e.pingedLanes,s=268435455&i;if(0!==s){var o=s&~r;0!==o?n=lt(o):0!=(a&=s)&&(n=lt(a))}else 0!=(s=i&~r)?n=lt(s):0!==a&&(n=lt(a));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&r)&&((r=n&-n)>=(a=t&-t)||16===r&&0!=(4194240&a)))return t;if(0!=(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-nt(t)),n|=e[i],t&=~r;return n}function ct(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:default:return-1}}function ht(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ut(){var e=st;return 0==(4194240&(st<<=1))&&(st=64),e}function mt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function ft(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-nt(t)]=i}function pt(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-nt(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var gt=0;function _t(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var St,vt,yt,Tt,bt,wt=!1,Ct=[],It=null,Pt=null,Et=null,xt=new Map,kt=new Map,Mt=[],At="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Et=null;break;case"pointerover":case"pointerout":xt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kt.delete(t.pointerId)}}function Ot(e,t,i,n,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:a,targetContainers:[r]},null!==t&&null!==(t=hr(t))&&vt(t),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=cr(e.target);if(null!==t){var i=We(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Ue(i)))return e.blockedOn=t,void bt(e.priority,(function(){yt(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=hr(i))&&vt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);Se=n,i.target.dispatchEvent(n),Se=null,t.shift()}return!0}function Lt(e,t,i){Dt(e)&&i.delete(t)}function Bt(){wt=!1,null!==It&&Dt(It)&&(It=null),null!==Pt&&Dt(Pt)&&(Pt=null),null!==Et&&Dt(Et)&&(Et=null),xt.forEach(Lt),kt.forEach(Lt)}function Nt(e,t){e.blockedOn===t&&(e.blockedOn=null,wt||(wt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bt)))}function Vt(e){function t(t){return Nt(t,e)}if(0<Ct.length){Nt(Ct[0],e);for(var i=1;i<Ct.length;i++){var n=Ct[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==It&&Nt(It,e),null!==Pt&&Nt(Pt,e),null!==Et&&Nt(Et,e),xt.forEach(t),kt.forEach(t),i=0;i<Mt.length;i++)(n=Mt[i]).blockedOn===e&&(n.blockedOn=null);for(;0<Mt.length&&null===(i=Mt[0]).blockedOn;)Ft(i),null===i.blockedOn&&Mt.shift()}var Wt=y.ReactCurrentBatchConfig,Ut=!0;function zt(e,t,i,n){var r=gt,a=Wt.transition;Wt.transition=null;try{gt=1,Gt(e,t,i,n)}finally{gt=r,Wt.transition=a}}function Ht(e,t,i,n){var r=gt,a=Wt.transition;Wt.transition=null;try{gt=4,Gt(e,t,i,n)}finally{gt=r,Wt.transition=a}}function Gt(e,t,i,n){if(Ut){var r=$t(e,t,i,n);if(null===r)Ln(e,t,n,jt,i),Rt(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return It=Ot(It,e,t,i,n,r),!0;case"dragenter":return Pt=Ot(Pt,e,t,i,n,r),!0;case"mouseover":return Et=Ot(Et,e,t,i,n,r),!0;case"pointerover":var a=r.pointerId;return xt.set(a,Ot(xt.get(a)||null,e,t,i,n,r)),!0;case"gotpointercapture":return a=r.pointerId,kt.set(a,Ot(kt.get(a)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(Rt(e,n),4&t&&-1<At.indexOf(e)){for(;null!==r;){var a=hr(r);if(null!==a&&St(a),null===(a=$t(e,t,i,n))&&Ln(e,t,n,jt,i),a===r)break;r=a}null!==r&&n.stopPropagation()}else Ln(e,t,n,null,i)}}var jt=null;function $t(e,t,i,n){if(jt=null,null!==(e=cr(e=ve(n))))if(null===(t=We(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jt=e,null}function qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Xe:return 1;case Ye:return 4;case Ke:case Qe:return 16;case et:return 536870912;default:return 16}default:return 16}}var Zt=null,Jt=null,Xt=null;function Yt(){if(Xt)return Xt;var e,t,i=Jt,n=i.length,r="value"in Zt?Zt.value:Zt.textContent,a=r.length;for(e=0;e<n&&i[e]===r[e];e++);var s=n-e;for(t=1;t<=s&&i[n-t]===r[a-t];t++);return Xt=r.slice(e,1<t?1-t:void 0)}function Kt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Qt(){return!0}function ei(){return!1}function ti(e){function t(t,i,n,r,a){for(var s in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Qt:ei,this.isPropagationStopped=ei,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Qt)},persist:function(){},isPersistent:Qt}),t}var ii,ni,ri,ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},si=ti(ai),oi=B({},ai,{view:0,detail:0}),li=ti(oi),di=B({},oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yi,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ri&&(ri&&"mousemove"===e.type?(ii=e.screenX-ri.screenX,ni=e.screenY-ri.screenY):ni=ii=0,ri=e),ii)},movementY:function(e){return"movementY"in e?e.movementY:ni}}),ci=ti(di),hi=ti(B({},di,{dataTransfer:0})),ui=ti(B({},oi,{relatedTarget:0})),mi=ti(B({},ai,{animationName:0,elapsedTime:0,pseudoElement:0})),fi=ti(B({},ai,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),pi=ti(B({},ai,{data:0})),gi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Si={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Si[e])&&!!t[e]}function yi(){return vi}var Ti=ti(B({},oi,{key:function(e){if(e.key){var t=gi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Kt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_i[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yi,charCode:function(e){return"keypress"===e.type?Kt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Kt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bi=ti(B({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wi=ti(B({},oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yi})),Ci=ti(B({},ai,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ii=ti(B({},di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Pi=[9,13,27,32],Ei=c&&"CompositionEvent"in window,xi=null;c&&"documentMode"in document&&(xi=document.documentMode);var ki=c&&"TextEvent"in window&&!xi,Mi=c&&(!Ei||xi&&8<xi&&11>=xi),Ai=String.fromCharCode(32),Ri=!1;function Oi(e,t){switch(e){case"keyup":return-1!==Pi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fi(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Di=!1,Li={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Li[e.type]:"textarea"===t}function Ni(e,t,i,n){Ce(n),0<(t=Nn(t,"onChange")).length&&(i=new si("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Vi=null,Wi=null;function Ui(e){Mn(e,0)}function zi(e){if($(ur(e)))return e}function Hi(e,t){if("change"===e)return t}var Gi=!1;if(c){var ji;if(c){var $i="oninput"in document;if(!$i){var qi=document.createElement("div");qi.setAttribute("oninput","return;"),$i="function"==typeof qi.oninput}ji=$i}else ji=!1;Gi=ji&&(!document.documentMode||9<document.documentMode)}function Zi(){Vi&&(Vi.detachEvent("onpropertychange",Ji),Wi=Vi=null)}function Ji(e){if("value"===e.propertyName&&zi(Wi)){var t=[];Ni(t,Wi,e,ve(e)),ke(Ui,t)}}function Xi(e,t,i){"focusin"===e?(Zi(),Wi=i,(Vi=t).attachEvent("onpropertychange",Ji)):"focusout"===e&&Zi()}function Yi(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zi(Wi)}function Ki(e,t){if("click"===e)return zi(t)}function Qi(e,t){if("input"===e||"change"===e)return zi(t)}var en="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function tn(e,t){if(en(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!h.call(t,r)||!en(e[r],t[r]))return!1}return!0}function nn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rn(e,t){var i,n=nn(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nn(n)}}function an(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var i="string"==typeof t.contentWindow.location.href}catch(e){i=!1}if(!i)break;t=q((e=t.contentWindow).document)}return t}function sn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var on=c&&"documentMode"in document&&11>=document.documentMode,ln=null,dn=null,cn=null,hn=!1;function un(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;hn||null==ln||ln!==q(n)||(n="selectionStart"in(n=ln)&&sn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},cn&&tn(cn,n)||(cn=n,0<(n=Nn(dn,"onSelect")).length&&(t=new si("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=ln)))}function mn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var fn={animationend:mn("Animation","AnimationEnd"),animationiteration:mn("Animation","AnimationIteration"),animationstart:mn("Animation","AnimationStart"),transitionend:mn("Transition","TransitionEnd")},pn={},gn={};function _n(e){if(pn[e])return pn[e];if(!fn[e])return e;var t,i=fn[e];for(t in i)if(i.hasOwnProperty(t)&&t in gn)return pn[e]=i[t];return e}c&&(gn=document.createElement("div").style,"AnimationEvent"in window||(delete fn.animationend.animation,delete fn.animationiteration.animation,delete fn.animationstart.animation),"TransitionEvent"in window||delete fn.transitionend.transition);var Sn=_n("animationend"),vn=_n("animationiteration"),yn=_n("animationstart"),Tn=_n("transitionend"),bn=new Map,wn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cn(e,t){bn.set(e,t),l(t,[e])}for(var In=0;In<wn.length;In++){var Pn=wn[In];Cn(Pn.toLowerCase(),"on"+(Pn[0].toUpperCase()+Pn.slice(1)))}Cn(Sn,"onAnimationEnd"),Cn(vn,"onAnimationIteration"),Cn(yn,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(Tn,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var En="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xn=new Set("cancel close invalid load scroll toggle".split(" ").concat(En));function kn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,s,o,l,d){if(Ve.apply(this,arguments),Fe){if(!Fe)throw Error(a(198));var c=De;Fe=!1,De=null,Le||(Le=!0,Be=c)}}(n,t,void 0,e),e.currentTarget=null}function Mn(e,t){t=0!=(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,d=o.currentTarget;if(o=o.listener,l!==a&&r.isPropagationStopped())break e;kn(r,o,d),a=l}else for(s=0;s<n.length;s++){if(l=(o=n[s]).instance,d=o.currentTarget,o=o.listener,l!==a&&r.isPropagationStopped())break e;kn(r,o,d),a=l}}}if(Le)throw e=Be,Le=!1,Be=null,e}function An(e,t){var i=t[or];void 0===i&&(i=t[or]=new Set);var n=e+"__bubble";i.has(n)||(Dn(t,e,2,!1),i.add(n))}function Rn(e,t,i){var n=0;t&&(n|=4),Dn(i,e,n,t)}var On="_reactListening"+Math.random().toString(36).slice(2);function Fn(e){if(!e[On]){e[On]=!0,s.forEach((function(t){"selectionchange"!==t&&(xn.has(t)||Rn(t,!1,e),Rn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[On]||(t[On]=!0,Rn("selectionchange",!1,t))}}function Dn(e,t,i,n){switch(qt(t)){case 1:var r=zt;break;case 4:r=Ht;break;default:r=Gt}i=r.bind(null,t,i,e),r=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function Ln(e,t,i,n,r){var a=n;if(0==(1&t)&&0==(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===s)for(s=n.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==o;){if(null===(s=cr(o)))return;if(5===(l=s.tag)||6===l){n=a=s;continue e}o=o.parentNode}}n=n.return}ke((function(){var n=a,r=ve(i),s=[];e:{var o=bn.get(e);if(void 0!==o){var l=si,d=e;switch(e){case"keypress":if(0===Kt(i))break e;case"keydown":case"keyup":l=Ti;break;case"focusin":d="focus",l=ui;break;case"focusout":d="blur",l=ui;break;case"beforeblur":case"afterblur":l=ui;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ci;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=hi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=wi;break;case Sn:case vn:case yn:l=mi;break;case Tn:l=Ci;break;case"scroll":l=li;break;case"wheel":l=Ii;break;case"copy":case"cut":case"paste":l=fi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=bi}var c=0!=(4&t),h=!c&&"scroll"===e,u=c?null!==o?o+"Capture":null:o;c=[];for(var m,f=n;null!==f;){var p=(m=f).stateNode;if(5===m.tag&&null!==p&&(m=p,null!==u&&null!=(p=Me(f,u))&&c.push(Bn(f,p,m))),h)break;f=f.return}0<c.length&&(o=new l(o,d,null,i,r),s.push({event:o,listeners:c}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||i===Se||!(d=i.relatedTarget||i.fromElement)||!cr(d)&&!d[sr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(d=(d=i.relatedTarget||i.toElement)?cr(d):null)&&(d!==(h=We(d))||5!==d.tag&&6!==d.tag)&&(d=null)):(l=null,d=n),l!==d)){if(c=ci,p="onMouseLeave",u="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=bi,p="onPointerLeave",u="onPointerEnter",f="pointer"),h=null==l?o:ur(l),m=null==d?o:ur(d),(o=new c(p,f+"leave",l,i,r)).target=h,o.relatedTarget=m,p=null,cr(r)===n&&((c=new c(u,f+"enter",d,i,r)).target=m,c.relatedTarget=h,p=c),h=p,l&&d)e:{for(u=d,f=0,m=c=l;m;m=Vn(m))f++;for(m=0,p=u;p;p=Vn(p))m++;for(;0<f-m;)c=Vn(c),f--;for(;0<m-f;)u=Vn(u),m--;for(;f--;){if(c===u||null!==u&&c===u.alternate)break e;c=Vn(c),u=Vn(u)}c=null}else c=null;null!==l&&Wn(s,o,l,c,!1),null!==d&&null!==h&&Wn(s,h,d,c,!0)}if("select"===(l=(o=n?ur(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Hi;else if(Bi(o))if(Gi)g=Qi;else{g=Yi;var _=Xi}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=Ki);switch(g&&(g=g(e,n))?Ni(s,g,i,r):(_&&_(e,o,n),"focusout"===e&&(_=o._wrapperState)&&_.controlled&&"number"===o.type&&Q(o,"number",o.value)),_=n?ur(n):window,e){case"focusin":(Bi(_)||"true"===_.contentEditable)&&(ln=_,dn=n,cn=null);break;case"focusout":cn=dn=ln=null;break;case"mousedown":hn=!0;break;case"contextmenu":case"mouseup":case"dragend":hn=!1,un(s,i,r);break;case"selectionchange":if(on)break;case"keydown":case"keyup":un(s,i,r)}var S;if(Ei)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Di?Oi(e,i)&&(v="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(v="onCompositionStart");v&&(Mi&&"ko"!==i.locale&&(Di||"onCompositionStart"!==v?"onCompositionEnd"===v&&Di&&(S=Yt()):(Jt="value"in(Zt=r)?Zt.value:Zt.textContent,Di=!0)),0<(_=Nn(n,v)).length&&(v=new pi(v,e,null,i,r),s.push({event:v,listeners:_}),(S||null!==(S=Fi(i)))&&(v.data=S))),(S=ki?function(e,t){switch(e){case"compositionend":return Fi(t);case"keypress":return 32!==t.which?null:(Ri=!0,Ai);case"textInput":return(e=t.data)===Ai&&Ri?null:e;default:return null}}(e,i):function(e,t){if(Di)return"compositionend"===e||!Ei&&Oi(e,t)?(e=Yt(),Xt=Jt=Zt=null,Di=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mi&&"ko"!==t.locale?null:t.data;default:return null}}(e,i))&&0<(n=Nn(n,"onBeforeInput")).length&&(r=new pi("onBeforeInput","beforeinput",null,i,r),s.push({event:r,listeners:n}),r.data=S)}Mn(s,t)}))}function Bn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Nn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=Me(e,i))&&n.unshift(Bn(e,a,r)),null!=(a=Me(e,t))&&n.push(Bn(e,a,r))),e=e.return}return n}function Vn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Wn(e,t,i,n,r){for(var a=t._reactName,s=[];null!==i&&i!==n;){var o=i,l=o.alternate,d=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==d&&(o=d,r?null!=(l=Me(i,a))&&s.unshift(Bn(i,l,o)):r||null!=(l=Me(i,a))&&s.push(Bn(i,l,o))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}var Un=/\r\n?/g,zn=/\u0000|\uFFFD/g;function Hn(e){return("string"==typeof e?e:""+e).replace(Un,"\n").replace(zn,"")}function Gn(e,t,i){if(t=Hn(t),Hn(e)!==t&&i)throw Error(a(425))}function jn(){}var $n=null,qn=null;function Zn(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Jn="function"==typeof setTimeout?setTimeout:void 0,Xn="function"==typeof clearTimeout?clearTimeout:void 0,Yn="function"==typeof Promise?Promise:void 0,Kn="function"==typeof queueMicrotask?queueMicrotask:void 0!==Yn?function(e){return Yn.resolve(null).then(e).catch(Qn)}:Jn;function Qn(e){setTimeout((function(){throw e}))}function er(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Vt(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Vt(t)}function tr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ir(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var nr=Math.random().toString(36).slice(2),rr="__reactFiber$"+nr,ar="__reactProps$"+nr,sr="__reactContainer$"+nr,or="__reactEvents$"+nr,lr="__reactListeners$"+nr,dr="__reactHandles$"+nr;function cr(e){var t=e[rr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[sr]||i[rr]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=ir(e);null!==e;){if(i=e[rr])return i;e=ir(e)}return t}i=(e=i).parentNode}return null}function hr(e){return!(e=e[rr]||e[sr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ur(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function mr(e){return e[ar]||null}var fr=[],pr=-1;function gr(e){return{current:e}}function _r(e){0>pr||(e.current=fr[pr],fr[pr]=null,pr--)}function Sr(e,t){pr++,fr[pr]=e.current,e.current=t}var vr={},yr=gr(vr),Tr=gr(!1),br=vr;function wr(e,t){var i=e.type.contextTypes;if(!i)return vr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in i)a[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Cr(e){return null!=e.childContextTypes}function Ir(){_r(Tr),_r(yr)}function Pr(e,t,i){if(yr.current!==vr)throw Error(a(168));Sr(yr,t),Sr(Tr,i)}function Er(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(a(108,z(e)||"Unknown",r));return B({},i,n)}function xr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vr,br=yr.current,Sr(yr,e),Sr(Tr,Tr.current),!0}function kr(e,t,i){var n=e.stateNode;if(!n)throw Error(a(169));i?(e=Er(e,t,br),n.__reactInternalMemoizedMergedChildContext=e,_r(Tr),_r(yr),Sr(yr,e)):_r(Tr),Sr(Tr,i)}var Mr=null,Ar=!1,Rr=!1;function Or(e){null===Mr?Mr=[e]:Mr.push(e)}function Fr(){if(!Rr&&null!==Mr){Rr=!0;var e=0,t=gt;try{var i=Mr;for(gt=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}Mr=null,Ar=!1}catch(t){throw null!==Mr&&(Mr=Mr.slice(e+1)),Ge(Xe,Fr),t}finally{gt=t,Rr=!1}}return null}var Dr=[],Lr=0,Br=null,Nr=0,Vr=[],Wr=0,Ur=null,zr=1,Hr="";function Gr(e,t){Dr[Lr++]=Nr,Dr[Lr++]=Br,Br=e,Nr=t}function jr(e,t,i){Vr[Wr++]=zr,Vr[Wr++]=Hr,Vr[Wr++]=Ur,Ur=e;var n=zr;e=Hr;var r=32-nt(n)-1;n&=~(1<<r),i+=1;var a=32-nt(t)+r;if(30<a){var s=r-r%5;a=(n&(1<<s)-1).toString(32),n>>=s,r-=s,zr=1<<32-nt(t)+r|i<<r|n,Hr=a+e}else zr=1<<a|i<<r|n,Hr=e}function $r(e){null!==e.return&&(Gr(e,1),jr(e,1,0))}function qr(e){for(;e===Br;)Br=Dr[--Lr],Dr[Lr]=null,Nr=Dr[--Lr],Dr[Lr]=null;for(;e===Ur;)Ur=Vr[--Wr],Vr[Wr]=null,Hr=Vr[--Wr],Vr[Wr]=null,zr=Vr[--Wr],Vr[Wr]=null}var Zr=null,Jr=null,Xr=!1,Yr=null;function Kr(e,t){var i=Sd(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function Qr(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Zr=e,Jr=tr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Zr=e,Jr=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Ur?{id:zr,overflow:Hr}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Sd(18,null,null,0)).stateNode=t,i.return=e,e.child=i,Zr=e,Jr=null,!0);default:return!1}}function ea(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ta(e){if(Xr){var t=Jr;if(t){var i=t;if(!Qr(e,t)){if(ea(e))throw Error(a(418));t=tr(i.nextSibling);var n=Zr;t&&Qr(e,t)?Kr(n,i):(e.flags=-4097&e.flags|2,Xr=!1,Zr=e)}}else{if(ea(e))throw Error(a(418));e.flags=-4097&e.flags|2,Xr=!1,Zr=e}}}function ia(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Zr=e}function na(e){if(e!==Zr)return!1;if(!Xr)return ia(e),Xr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!Zn(e.type,e.memoizedProps)),t&&(t=Jr)){if(ea(e))throw ra(),Error(a(418));for(;t;)Kr(e,t),t=tr(t.nextSibling)}if(ia(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){Jr=tr(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}Jr=null}}else Jr=Zr?tr(e.stateNode.nextSibling):null;return!0}function ra(){for(var e=Jr;e;)e=tr(e.nextSibling)}function aa(){Jr=Zr=null,Xr=!1}function sa(e){null===Yr?Yr=[e]:Yr.push(e)}var oa=y.ReactCurrentBatchConfig;function la(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(a(309));var n=i.stateNode}if(!n)throw Error(a(147,e));var r=n,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=r.refs;null===e?delete t[s]:t[s]=e})._stringRef=s,t)}if("string"!=typeof e)throw Error(a(284));if(!i._owner)throw Error(a(290,e))}return e}function da(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ca(e){return(0,e._init)(e._payload)}function ha(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=yd(e,t)).index=0,e.sibling=null,e}function s(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,i,n){return null===t||6!==t.tag?((t=Cd(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function d(e,t,i,n){var a=i.type;return a===w?h(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===R&&ca(a)===t.type)?((n=r(t,i.props)).ref=la(e,t,i),n.return=e,n):((n=Td(i.type,i.key,i.props,null,e.mode,n)).ref=la(e,t,i),n.return=e,n)}function c(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Id(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function h(e,t,i,n,a){return null===t||7!==t.tag?((t=bd(i,e.mode,n,a)).return=e,t):((t=r(t,i)).return=e,t)}function u(e,t,i){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Cd(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case T:return(i=Td(t.type,t.key,t.props,null,e.mode,i)).ref=la(e,null,t),i.return=e,i;case b:return(t=Id(t,e.mode,i)).return=e,t;case R:return u(e,(0,t._init)(t._payload),i)}if(ee(t)||D(t))return(t=bd(t,e.mode,i,null)).return=e,t;da(e,t)}return null}function m(e,t,i,n){var r=null!==t?t.key:null;if("string"==typeof i&&""!==i||"number"==typeof i)return null!==r?null:l(e,t,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case T:return i.key===r?d(e,t,i,n):null;case b:return i.key===r?c(e,t,i,n):null;case R:return m(e,t,(r=i._init)(i._payload),n)}if(ee(i)||D(i))return null!==r?null:h(e,t,i,n,null);da(e,i)}return null}function f(e,t,i,n,r){if("string"==typeof n&&""!==n||"number"==typeof n)return l(t,e=e.get(i)||null,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case T:return d(t,e=e.get(null===n.key?i:n.key)||null,n,r);case b:return c(t,e=e.get(null===n.key?i:n.key)||null,n,r);case R:return f(e,t,i,(0,n._init)(n._payload),r)}if(ee(n)||D(n))return h(t,e=e.get(i)||null,n,r,null);da(t,n)}return null}function p(r,a,o,l){for(var d=null,c=null,h=a,p=a=0,g=null;null!==h&&p<o.length;p++){h.index>p?(g=h,h=null):g=h.sibling;var _=m(r,h,o[p],l);if(null===_){null===h&&(h=g);break}e&&h&&null===_.alternate&&t(r,h),a=s(_,a,p),null===c?d=_:c.sibling=_,c=_,h=g}if(p===o.length)return i(r,h),Xr&&Gr(r,p),d;if(null===h){for(;p<o.length;p++)null!==(h=u(r,o[p],l))&&(a=s(h,a,p),null===c?d=h:c.sibling=h,c=h);return Xr&&Gr(r,p),d}for(h=n(r,h);p<o.length;p++)null!==(g=f(h,r,p,o[p],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?p:g.key),a=s(g,a,p),null===c?d=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(r,e)})),Xr&&Gr(r,p),d}function g(r,o,l,d){var c=D(l);if("function"!=typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var h=c=null,p=o,g=o=0,_=null,S=l.next();null!==p&&!S.done;g++,S=l.next()){p.index>g?(_=p,p=null):_=p.sibling;var v=m(r,p,S.value,d);if(null===v){null===p&&(p=_);break}e&&p&&null===v.alternate&&t(r,p),o=s(v,o,g),null===h?c=v:h.sibling=v,h=v,p=_}if(S.done)return i(r,p),Xr&&Gr(r,g),c;if(null===p){for(;!S.done;g++,S=l.next())null!==(S=u(r,S.value,d))&&(o=s(S,o,g),null===h?c=S:h.sibling=S,h=S);return Xr&&Gr(r,g),c}for(p=n(r,p);!S.done;g++,S=l.next())null!==(S=f(p,r,g,S.value,d))&&(e&&null!==S.alternate&&p.delete(null===S.key?g:S.key),o=s(S,o,g),null===h?c=S:h.sibling=S,h=S);return e&&p.forEach((function(e){return t(r,e)})),Xr&&Gr(r,g),c}return function e(n,a,s,l){if("object"==typeof s&&null!==s&&s.type===w&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case T:e:{for(var d=s.key,c=a;null!==c;){if(c.key===d){if((d=s.type)===w){if(7===c.tag){i(n,c.sibling),(a=r(c,s.props.children)).return=n,n=a;break e}}else if(c.elementType===d||"object"==typeof d&&null!==d&&d.$$typeof===R&&ca(d)===c.type){i(n,c.sibling),(a=r(c,s.props)).ref=la(n,c,s),a.return=n,n=a;break e}i(n,c);break}t(n,c),c=c.sibling}s.type===w?((a=bd(s.props.children,n.mode,l,s.key)).return=n,n=a):((l=Td(s.type,s.key,s.props,null,n.mode,l)).ref=la(n,a,s),l.return=n,n=l)}return o(n);case b:e:{for(c=s.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){i(n,a.sibling),(a=r(a,s.children||[])).return=n,n=a;break e}i(n,a);break}t(n,a),a=a.sibling}(a=Id(s,n.mode,l)).return=n,n=a}return o(n);case R:return e(n,a,(c=s._init)(s._payload),l)}if(ee(s))return p(n,a,s,l);if(D(s))return g(n,a,s,l);da(n,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==a&&6===a.tag?(i(n,a.sibling),(a=r(a,s)).return=n,n=a):(i(n,a),(a=Cd(s,n.mode,l)).return=n,n=a),o(n)):i(n,a)}}var ua=ha(!0),ma=ha(!1),fa=gr(null),pa=null,ga=null,_a=null;function Sa(){_a=ga=pa=null}function va(e){var t=fa.current;_r(fa),e._currentValue=t}function ya(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Ta(e,t){pa=e,_a=ga=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(ho=!0),e.firstContext=null)}function ba(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===ga){if(null===pa)throw Error(a(308));ga=e,pa.dependencies={lanes:0,firstContext:e}}else ga=ga.next=e;return t}var wa=null;function Ca(e){null===wa?wa=[e]:wa.push(e)}function Ia(e,t,i,n){var r=t.interleaved;return null===r?(i.next=i,Ca(t)):(i.next=r.next,r.next=i),t.interleaved=i,Pa(e,n)}function Pa(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Ea=!1;function xa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ka(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ma(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Aa(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!=(2&pl)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Pa(e,i)}return null===(r=n.interleaved)?(t.next=t,Ca(n)):(t.next=r.next,r.next=t),n.interleaved=t,Pa(e,i)}function Ra(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,pt(e,i)}}function Oa(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,a=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===a?r=a=s:a=a.next=s,i=i.next}while(null!==i);null===a?r=a=t:a=a.next=t}else r=a=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Fa(e,t,i,n){var r=e.updateQueue;Ea=!1;var a=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,d=l.next;l.next=null,null===s?a=d:s.next=d,s=l;var c=e.alternate;null!==c&&(o=(c=c.updateQueue).lastBaseUpdate)!==s&&(null===o?c.firstBaseUpdate=d:o.next=d,c.lastBaseUpdate=l)}if(null!==a){var h=r.baseState;for(s=0,c=d=l=null,o=a;;){var u=o.lane,m=o.eventTime;if((n&u)===u){null!==c&&(c=c.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,p=o;switch(u=t,m=i,p.tag){case 1:if("function"==typeof(f=p.payload)){h=f.call(m,h,u);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(u="function"==typeof(f=p.payload)?f.call(m,h,u):f))break e;h=B({},h,u);break e;case 2:Ea=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(u=r.effects)?r.effects=[o]:u.push(o))}else m={eventTime:m,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(d=c=m,l=h):c=c.next=m,s|=u;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(u=o).next,u.next=null,r.lastBaseUpdate=u,r.shared.pending=null}}if(null===c&&(l=h),r.baseState=l,r.firstBaseUpdate=d,r.lastBaseUpdate=c,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);wl|=s,e.lanes=s,e.memoizedState=h}}function Da(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!=typeof r)throw Error(a(191,r));r.call(n)}}}var La={},Ba=gr(La),Na=gr(La),Va=gr(La);function Wa(e){if(e===La)throw Error(a(174));return e}function Ua(e,t){switch(Sr(Va,t),Sr(Na,e),Sr(Ba,La),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_r(Ba),Sr(Ba,t)}function za(){_r(Ba),_r(Na),_r(Va)}function Ha(e){Wa(Va.current);var t=Wa(Ba.current),i=oe(t,e.type);t!==i&&(Sr(Na,e),Sr(Ba,i))}function Ga(e){Na.current===e&&(_r(Ba),_r(Na))}var ja=gr(0);function $a(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qa=[];function Za(){for(var e=0;e<qa.length;e++)qa[e]._workInProgressVersionPrimary=null;qa.length=0}var Ja=y.ReactCurrentDispatcher,Xa=y.ReactCurrentBatchConfig,Ya=0,Ka=null,Qa=null,es=null,ts=!1,is=!1,ns=0,rs=0;function as(){throw Error(a(321))}function ss(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!en(e[i],t[i]))return!1;return!0}function os(e,t,i,n,r,s){if(Ya=s,Ka=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ja.current=null===e||null===e.memoizedState?Gs:js,e=i(n,r),is){s=0;do{if(is=!1,ns=0,25<=s)throw Error(a(301));s+=1,es=Qa=null,t.updateQueue=null,Ja.current=$s,e=i(n,r)}while(is)}if(Ja.current=Hs,t=null!==Qa&&null!==Qa.next,Ya=0,es=Qa=Ka=null,ts=!1,t)throw Error(a(300));return e}function ls(){var e=0!==ns;return ns=0,e}function ds(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===es?Ka.memoizedState=es=e:es=es.next=e,es}function cs(){if(null===Qa){var e=Ka.alternate;e=null!==e?e.memoizedState:null}else e=Qa.next;var t=null===es?Ka.memoizedState:es.next;if(null!==t)es=t,Qa=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Qa=e).memoizedState,baseState:Qa.baseState,baseQueue:Qa.baseQueue,queue:Qa.queue,next:null},null===es?Ka.memoizedState=es=e:es=es.next=e}return es}function hs(e,t){return"function"==typeof t?t(e):t}function us(e){var t=cs(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var n=Qa,r=n.baseQueue,s=i.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(null!==r){s=r.next,n=n.baseState;var l=o=null,d=null,c=s;do{var h=c.lane;if((Ya&h)===h)null!==d&&(d=d.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===d?(l=d=u,o=n):d=d.next=u,Ka.lanes|=h,wl|=h}c=c.next}while(null!==c&&c!==s);null===d?o=n:d.next=l,en(n,t.memoizedState)||(ho=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=d,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{s=r.lane,Ka.lanes|=s,wl|=s,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function ms(e){var t=cs(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,s=t.memoizedState;if(null!==r){i.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);en(s,t.memoizedState)||(ho=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function fs(){}function ps(e,t){var i=Ka,n=cs(),r=t(),s=!en(n.memoizedState,r);if(s&&(n.memoizedState=r,ho=!0),n=n.queue,Es(Ss.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||null!==es&&1&es.memoizedState.tag){if(i.flags|=2048,bs(9,_s.bind(null,i,n,r,t),void 0,null),null===gl)throw Error(a(349));0!=(30&Ya)||gs(i,t,r)}return r}function gs(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=Ka.updateQueue)?(t={lastEffect:null,stores:null},Ka.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function _s(e,t,i,n){t.value=i,t.getSnapshot=n,vs(t)&&ys(e)}function Ss(e,t,i){return i((function(){vs(t)&&ys(e)}))}function vs(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!en(e,i)}catch(e){return!0}}function ys(e){var t=Pa(e,1);null!==t&&Hl(t,e,1,-1)}function Ts(e){var t=ds();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:e},t.queue=e,e=e.dispatch=Vs.bind(null,Ka,e),[t.memoizedState,e]}function bs(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=Ka.updateQueue)?(t={lastEffect:null,stores:null},Ka.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function ws(){return cs().memoizedState}function Cs(e,t,i,n){var r=ds();Ka.flags|=e,r.memoizedState=bs(1|t,i,void 0,void 0===n?null:n)}function Is(e,t,i,n){var r=cs();n=void 0===n?null:n;var a=void 0;if(null!==Qa){var s=Qa.memoizedState;if(a=s.destroy,null!==n&&ss(n,s.deps))return void(r.memoizedState=bs(t,i,a,n))}Ka.flags|=e,r.memoizedState=bs(1|t,i,a,n)}function Ps(e,t){return Cs(8390656,8,e,t)}function Es(e,t){return Is(2048,8,e,t)}function xs(e,t){return Is(4,2,e,t)}function ks(e,t){return Is(4,4,e,t)}function Ms(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function As(e,t,i){return i=null!=i?i.concat([e]):null,Is(4,4,Ms.bind(null,t,e),i)}function Rs(){}function Os(e,t){var i=cs();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&ss(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Fs(e,t){var i=cs();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&ss(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Ds(e,t,i){return 0==(21&Ya)?(e.baseState&&(e.baseState=!1,ho=!0),e.memoizedState=i):(en(i,t)||(i=ut(),Ka.lanes|=i,wl|=i,e.baseState=!0),t)}function Ls(e,t){var i=gt;gt=0!==i&&4>i?i:4,e(!0);var n=Xa.transition;Xa.transition={};try{e(!1),t()}finally{gt=i,Xa.transition=n}}function Bs(){return cs().memoizedState}function Ns(e,t,i){var n=zl(e);i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},Ws(e)?Us(t,i):null!==(i=Ia(e,t,i,n))&&(Hl(i,e,n,Ul()),zs(i,t,n))}function Vs(e,t,i){var n=zl(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(Ws(e))Us(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,i);if(r.hasEagerState=!0,r.eagerState=o,en(o,s)){var l=t.interleaved;return null===l?(r.next=r,Ca(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(e){}null!==(i=Ia(e,t,r,n))&&(Hl(i,e,n,r=Ul()),zs(i,t,n))}}function Ws(e){var t=e.alternate;return e===Ka||null!==t&&t===Ka}function Us(e,t){is=ts=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function zs(e,t,i){if(0!=(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,pt(e,i)}}var Hs={readContext:ba,useCallback:as,useContext:as,useEffect:as,useImperativeHandle:as,useInsertionEffect:as,useLayoutEffect:as,useMemo:as,useReducer:as,useRef:as,useState:as,useDebugValue:as,useDeferredValue:as,useTransition:as,useMutableSource:as,useSyncExternalStore:as,useId:as,unstable_isNewReconciler:!1},Gs={readContext:ba,useCallback:function(e,t){return ds().memoizedState=[e,void 0===t?null:t],e},useContext:ba,useEffect:Ps,useImperativeHandle:function(e,t,i){return i=null!=i?i.concat([e]):null,Cs(4194308,4,Ms.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Cs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Cs(4,2,e,t)},useMemo:function(e,t){var i=ds();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=ds();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ns.bind(null,Ka,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},ds().memoizedState=e},useState:Ts,useDebugValue:Rs,useDeferredValue:function(e){return ds().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=Ls.bind(null,e[1]),ds().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=Ka,r=ds();if(Xr){if(void 0===i)throw Error(a(407));i=i()}else{if(i=t(),null===gl)throw Error(a(349));0!=(30&Ya)||gs(n,t,i)}r.memoizedState=i;var s={value:i,getSnapshot:t};return r.queue=s,Ps(Ss.bind(null,n,s,e),[e]),n.flags|=2048,bs(9,_s.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=ds(),t=gl.identifierPrefix;if(Xr){var i=Hr;t=":"+t+"R"+(i=(zr&~(1<<32-nt(zr)-1)).toString(32)+i),0<(i=ns++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=rs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},js={readContext:ba,useCallback:Os,useContext:ba,useEffect:Es,useImperativeHandle:As,useInsertionEffect:xs,useLayoutEffect:ks,useMemo:Fs,useReducer:us,useRef:ws,useState:function(){return us(hs)},useDebugValue:Rs,useDeferredValue:function(e){return Ds(cs(),Qa.memoizedState,e)},useTransition:function(){return[us(hs)[0],cs().memoizedState]},useMutableSource:fs,useSyncExternalStore:ps,useId:Bs,unstable_isNewReconciler:!1},$s={readContext:ba,useCallback:Os,useContext:ba,useEffect:Es,useImperativeHandle:As,useInsertionEffect:xs,useLayoutEffect:ks,useMemo:Fs,useReducer:ms,useRef:ws,useState:function(){return ms(hs)},useDebugValue:Rs,useDeferredValue:function(e){var t=cs();return null===Qa?t.memoizedState=e:Ds(t,Qa.memoizedState,e)},useTransition:function(){return[ms(hs)[0],cs().memoizedState]},useMutableSource:fs,useSyncExternalStore:ps,useId:Bs,unstable_isNewReconciler:!1};function qs(e,t){if(e&&e.defaultProps){for(var i in t=B({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}function Zs(e,t,i,n){i=null==(i=i(n,t=e.memoizedState))?t:B({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var Js={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=Ul(),r=zl(e),a=Ma(n,r);a.payload=t,null!=i&&(a.callback=i),null!==(t=Aa(e,a,r))&&(Hl(t,e,r,n),Ra(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=Ul(),r=zl(e),a=Ma(n,r);a.tag=1,a.payload=t,null!=i&&(a.callback=i),null!==(t=Aa(e,a,r))&&(Hl(t,e,r,n),Ra(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Ul(),n=zl(e),r=Ma(i,n);r.tag=2,null!=t&&(r.callback=t),null!==(t=Aa(e,r,n))&&(Hl(t,e,n,i),Ra(t,e,n))}};function Xs(e,t,i,n,r,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!(t.prototype&&t.prototype.isPureReactComponent&&tn(i,n)&&tn(r,a))}function Ys(e,t,i){var n=!1,r=vr,a=t.contextType;return"object"==typeof a&&null!==a?a=ba(a):(r=Cr(t)?br:yr.current,a=(n=null!=(n=t.contextTypes))?wr(e,r):vr),t=new t(i,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Js,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ks(e,t,i,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&Js.enqueueReplaceState(t,t.state,null)}function Qs(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs={},xa(e);var a=t.contextType;"object"==typeof a&&null!==a?r.context=ba(a):(a=Cr(t)?br:yr.current,r.context=wr(e,a)),r.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Zs(e,t,a,i),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Js.enqueueReplaceState(r,r.state,null),Fa(e,i,r,n),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function eo(e,t){try{var i="",n=t;do{i+=U(n),n=n.return}while(n);var r=i}catch(e){r="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:r,digest:null}}function to(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function io(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var no="function"==typeof WeakMap?WeakMap:Map;function ro(e,t,i){(i=Ma(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Al||(Al=!0,Rl=n),io(0,t)},i}function ao(e,t,i){(i=Ma(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){io(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(i.callback=function(){io(0,t),"function"!=typeof n&&(null===Ol?Ol=new Set([this]):Ol.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function so(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new no;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=ud.bind(null,e,t,i),t.then(e,e))}function oo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function lo(e,t,i,n,r){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=Ma(-1,1)).tag=2,Aa(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var co=y.ReactCurrentOwner,ho=!1;function uo(e,t,i,n){t.child=null===e?ma(t,null,i,n):ua(t,e.child,i,n)}function mo(e,t,i,n,r){i=i.render;var a=t.ref;return Ta(t,r),n=os(e,t,i,n,a,r),i=ls(),null===e||ho?(Xr&&i&&$r(t),t.flags|=1,uo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Do(e,t,r))}function fo(e,t,i,n,r){if(null===e){var a=i.type;return"function"!=typeof a||vd(a)||void 0!==a.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Td(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,po(e,t,a,n,r))}if(a=e.child,0==(e.lanes&r)){var s=a.memoizedProps;if((i=null!==(i=i.compare)?i:tn)(s,n)&&e.ref===t.ref)return Do(e,t,r)}return t.flags|=1,(e=yd(a,n)).ref=t.ref,e.return=t,t.child=e}function po(e,t,i,n,r){if(null!==e){var a=e.memoizedProps;if(tn(a,n)&&e.ref===t.ref){if(ho=!1,t.pendingProps=n=a,0==(e.lanes&r))return t.lanes=e.lanes,Do(e,t,r);0!=(131072&e.flags)&&(ho=!0)}}return So(e,t,i,n,r)}function go(e,t,i){var n=t.pendingProps,r=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(yl,vl),vl|=i;else{if(0==(1073741824&i))return e=null!==a?a.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sr(yl,vl),vl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:i,Sr(yl,vl),vl|=n}else null!==a?(n=a.baseLanes|i,t.memoizedState=null):n=i,Sr(yl,vl),vl|=n;return uo(e,t,r,i),t.child}function _o(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,i,n,r){var a=Cr(i)?br:yr.current;return a=wr(t,a),Ta(t,r),i=os(e,t,i,n,a,r),n=ls(),null===e||ho?(Xr&&n&&$r(t),t.flags|=1,uo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Do(e,t,r))}function vo(e,t,i,n,r){if(Cr(i)){var a=!0;xr(t)}else a=!1;if(Ta(t,r),null===t.stateNode)Fo(e,t),Ys(t,i,n),Qs(t,i,n,r),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,d=i.contextType;d="object"==typeof d&&null!==d?ba(d):wr(t,d=Cr(i)?br:yr.current);var c=i.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==n||l!==d)&&Ks(t,s,n,d),Ea=!1;var u=t.memoizedState;s.state=u,Fa(t,n,s,r),l=t.memoizedState,o!==n||u!==l||Tr.current||Ea?("function"==typeof c&&(Zs(t,i,c,n),l=t.memoizedState),(o=Ea||Xs(t,i,o,n,u,l,d))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=d,n=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,ka(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:qs(t.type,o),s.props=d,h=t.pendingProps,u=s.context,l="object"==typeof(l=i.contextType)&&null!==l?ba(l):wr(t,l=Cr(i)?br:yr.current);var m=i.getDerivedStateFromProps;(c="function"==typeof m||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==h||u!==l)&&Ks(t,s,n,l),Ea=!1,u=t.memoizedState,s.state=u,Fa(t,n,s,r);var f=t.memoizedState;o!==h||u!==f||Tr.current||Ea?("function"==typeof m&&(Zs(t,i,m,n),f=t.memoizedState),(d=Ea||Xs(t,i,d,n,u,f,l)||!1)?(c||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=l,n=d):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),n=!1)}return yo(e,t,i,n,a,r)}function yo(e,t,i,n,r,a){_o(e,t);var s=0!=(128&t.flags);if(!n&&!s)return r&&kr(t,i,!1),Do(e,t,a);n=t.stateNode,co.current=t;var o=s&&"function"!=typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=ua(t,e.child,null,a),t.child=ua(t,null,o,a)):uo(e,t,o,a),t.memoizedState=n.state,r&&kr(t,i,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Pr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pr(0,t.context,!1),Ua(e,t.containerInfo)}function bo(e,t,i,n,r){return aa(),sa(r),t.flags|=256,uo(e,t,i,n),t.child}var wo,Co,Io,Po={dehydrated:null,treeContext:null,retryLane:0};function Eo(e){return{baseLanes:e,cachePool:null,transitions:null}}function xo(e,t,i){var n,r=t.pendingProps,s=ja.current,o=!1,l=0!=(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!=(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Sr(ja,1&s),null===e)return ta(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0==(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=wd(l,r,0,null),e=bd(e,r,i,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Eo(i),t.memoizedState=Po,e):ko(t,l));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,i,n,r,s,o){if(i)return 256&t.flags?(t.flags&=-257,Mo(e,t,o,n=to(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,r=t.mode,n=wd({mode:"visible",children:n.children},r,0,null),(s=bd(s,r,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!=(1&t.mode)&&ua(t,e.child,null,o),t.child.memoizedState=Eo(o),t.memoizedState=Po,s);if(0==(1&t.mode))return Mo(e,t,o,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,Mo(e,t,o,n=to(s=Error(a(419)),n,void 0))}if(l=0!=(o&e.childLanes),ho||l){if(null!==(n=gl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!=(r&(n.suspendedLanes|o))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Pa(e,r),Hl(n,e,r,-1))}return id(),Mo(e,t,o,n=to(Error(a(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=fd.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,Jr=tr(r.nextSibling),Zr=t,Xr=!0,Yr=null,null!==e&&(Vr[Wr++]=zr,Vr[Wr++]=Hr,Vr[Wr++]=Ur,zr=e.id,Hr=e.overflow,Ur=t),(t=ko(t,n.children)).flags|=4096,t)}(e,t,l,r,n,s,i);if(o){o=r.fallback,l=t.mode,n=(s=e.child).sibling;var d={mode:"hidden",children:r.children};return 0==(1&l)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=d,t.deletions=null):(r=yd(s,d)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=yd(n,o):(o=bd(o,l,i,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Eo(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~i,t.memoizedState=Po,r}return e=(o=e.child).sibling,r=yd(o,{mode:"visible",children:r.children}),0==(1&t.mode)&&(r.lanes=i),r.return=t,r.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function ko(e,t){return(t=wd({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Mo(e,t,i,n){return null!==n&&sa(n),ua(t,e.child,null,i),(e=ko(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ao(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ya(e.return,t,i)}function Ro(e,t,i,n,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=i,a.tailMode=r)}function Oo(e,t,i){var n=t.pendingProps,r=n.revealOrder,a=n.tail;if(uo(e,t,n.children,i),0!=(2&(n=ja.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ao(e,i,t);else if(19===e.tag)Ao(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Sr(ja,n),0==(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===$a(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),Ro(t,!1,r,i,a);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===$a(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}Ro(t,!0,i,null,a);break;case"together":Ro(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fo(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Do(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),wl|=t.lanes,0==(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(i=yd(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=yd(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Lo(e,t){if(!Xr)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Bo(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function No(e,t,i){var n=t.pendingProps;switch(qr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bo(t),null;case 1:return Cr(t.type)&&Ir(),Bo(t),null;case 3:return n=t.stateNode,za(),_r(Tr),_r(yr),Za(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(na(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==Yr&&(ql(Yr),Yr=null))),Bo(t),null;case 5:Ga(t);var r=Wa(Va.current);if(i=t.type,null!==e&&null!=t.stateNode)Co(e,t,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Bo(t),null}if(e=Wa(Ba.current),na(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[rr]=t,n[ar]=s,e=0!=(1&t.mode),i){case"dialog":An("cancel",n),An("close",n);break;case"iframe":case"object":case"embed":An("load",n);break;case"video":case"audio":for(r=0;r<En.length;r++)An(En[r],n);break;case"source":An("error",n);break;case"img":case"image":case"link":An("error",n),An("load",n);break;case"details":An("toggle",n);break;case"input":J(n,s),An("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},An("invalid",n);break;case"textarea":ne(n,s),An("invalid",n)}for(var l in ge(i,s),r=null,s)if(s.hasOwnProperty(l)){var d=s[l];"children"===l?"string"==typeof d?n.textContent!==d&&(!0!==s.suppressHydrationWarning&&Gn(n.textContent,d,e),r=["children",d]):"number"==typeof d&&n.textContent!==""+d&&(!0!==s.suppressHydrationWarning&&Gn(n.textContent,d,e),r=["children",""+d]):o.hasOwnProperty(l)&&null!=d&&"onScroll"===l&&An("scroll",n)}switch(i){case"input":j(n),K(n,s,!0);break;case"textarea":j(n),ae(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=jn)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=l.createElement(i,{is:n.is}):(e=l.createElement(i),"select"===i&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,i),e[rr]=t,e[ar]=n,wo(e,t),t.stateNode=e;e:{switch(l=_e(i,n),i){case"dialog":An("cancel",e),An("close",e),r=n;break;case"iframe":case"object":case"embed":An("load",e),r=n;break;case"video":case"audio":for(r=0;r<En.length;r++)An(En[r],e);r=n;break;case"source":An("error",e),r=n;break;case"img":case"image":case"link":An("error",e),An("load",e),r=n;break;case"details":An("toggle",e),r=n;break;case"input":J(e,n),r=Z(e,n),An("invalid",e);break;case"option":r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=B({},n,{value:void 0}),An("invalid",e);break;case"textarea":ne(e,n),r=ie(e,n),An("invalid",e);break;default:r=n}for(s in ge(i,r),d=r)if(d.hasOwnProperty(s)){var c=d[s];"style"===s?fe(e,c):"dangerouslySetInnerHTML"===s?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===s?"string"==typeof c?("textarea"!==i||""!==c)&&ce(e,c):"number"==typeof c&&ce(e,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=c&&"onScroll"===s&&An("scroll",e):null!=c&&v(e,s,c,l))}switch(i){case"input":j(e),K(e,n,!1);break;case"textarea":j(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+H(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?te(e,!!n.multiple,s,!1):null!=n.defaultValue&&te(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof r.onClick&&(e.onclick=jn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Bo(t),null;case 6:if(e&&null!=t.stateNode)Io(0,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(a(166));if(i=Wa(Va.current),Wa(Ba.current),na(t)){if(n=t.stateNode,i=t.memoizedProps,n[rr]=t,(s=n.nodeValue!==i)&&null!==(e=Zr))switch(e.tag){case 3:Gn(n.nodeValue,i,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Gn(n.nodeValue,i,0!=(1&e.mode))}s&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[rr]=t,t.stateNode=n}return Bo(t),null;case 13:if(_r(ja),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(Xr&&null!==Jr&&0!=(1&t.mode)&&0==(128&t.flags))ra(),aa(),t.flags|=98560,s=!1;else if(s=na(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[rr]=t}else aa(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Bo(t),s=!1}else null!==Yr&&(ql(Yr),Yr=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=i,t):((n=null!==n)!=(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&ja.current)?0===Tl&&(Tl=3):id())),null!==t.updateQueue&&(t.flags|=4),Bo(t),null);case 4:return za(),null===e&&Fn(t.stateNode.containerInfo),Bo(t),null;case 10:return va(t.type._context),Bo(t),null;case 17:return Cr(t.type)&&Ir(),Bo(t),null;case 19:if(_r(ja),null===(s=t.memoizedState))return Bo(t),null;if(n=0!=(128&t.flags),null===(l=s.rendering))if(n)Lo(s,!1);else{if(0!==Tl||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=$a(e))){for(t.flags|=128,Lo(s,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(s=i).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Sr(ja,1&ja.current|2),t.child}e=e.sibling}null!==s.tail&&Ze()>kl&&(t.flags|=128,n=!0,Lo(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=$a(l))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Lo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!Xr)return Bo(t),null}else 2*Ze()-s.renderingStartTime>kl&&1073741824!==i&&(t.flags|=128,n=!0,Lo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=s.last)?i.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ze(),t.sibling=null,i=ja.current,Sr(ja,n?1&i|2:1&i),t):(Bo(t),null);case 22:case 23:return Kl(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!=(1&t.mode)?0!=(1073741824&vl)&&(Bo(t),6&t.subtreeFlags&&(t.flags|=8192)):Bo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Vo(e,t){switch(qr(t),t.tag){case 1:return Cr(t.type)&&Ir(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return za(),_r(Tr),_r(yr),Za(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ga(t),null;case 13:if(_r(ja),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));aa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _r(ja),null;case 4:return za(),null;case 10:return va(t.type._context),null;case 22:case 23:return Kl(),null;case 24:default:return null}}wo=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Co=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,Wa(Ba.current);var a,s=null;switch(i){case"input":r=Z(e,r),n=Z(e,n),s=[];break;case"select":r=B({},r,{value:void 0}),n=B({},n,{value:void 0}),s=[];break;case"textarea":r=ie(e,r),n=ie(e,n),s=[];break;default:"function"!=typeof r.onClick&&"function"==typeof n.onClick&&(e.onclick=jn)}for(c in ge(i,n),i=null,r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(a in l)l.hasOwnProperty(a)&&(i||(i={}),i[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var d=n[c];if(l=null!=r?r[c]:void 0,n.hasOwnProperty(c)&&d!==l&&(null!=d||null!=l))if("style"===c)if(l){for(a in l)!l.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(i||(i={}),i[a]="");for(a in d)d.hasOwnProperty(a)&&l[a]!==d[a]&&(i||(i={}),i[a]=d[a])}else i||(s||(s=[]),s.push(c,i)),i=d;else"dangerouslySetInnerHTML"===c?(d=d?d.__html:void 0,l=l?l.__html:void 0,null!=d&&l!==d&&(s=s||[]).push(c,d)):"children"===c?"string"!=typeof d&&"number"!=typeof d||(s=s||[]).push(c,""+d):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=d&&"onScroll"===c&&An("scroll",e),s||l===d||(s=[])):(s=s||[]).push(c,d))}i&&(s=s||[]).push("style",i);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},Io=function(e,t,i,n){i!==n&&(t.flags|=4)};var Wo=!1,Uo=!1,zo="function"==typeof WeakSet?WeakSet:Set,Ho=null;function Go(e,t){var i=e.ref;if(null!==i)if("function"==typeof i)try{i(null)}catch(i){hd(e,t,i)}else i.current=null}function jo(e,t,i){try{i()}catch(i){hd(e,t,i)}}var $o=!1;function qo(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&jo(t,i,a)}r=r.next}while(r!==n)}}function Zo(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function Jo(e){var t=e.ref;if(null!==t){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}"function"==typeof t?t(e):t.current=e}}function Xo(e){var t=e.alternate;null!==t&&(e.alternate=null,Xo(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[rr],delete t[ar],delete t[or],delete t[lr],delete t[dr]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Yo(e){return 5===e.tag||3===e.tag||4===e.tag}function Ko(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Yo(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}var Qo=null,el=!1;function tl(e,t,i){for(i=i.child;null!==i;)il(e,t,i),i=i.sibling}function il(e,t,i){if(it&&"function"==typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(tt,i)}catch(e){}switch(i.tag){case 5:Uo||Go(i,t);case 6:var n=Qo,r=el;Qo=null,tl(e,t,i),el=r,null!==(Qo=n)&&(el?(e=Qo,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):Qo.removeChild(i.stateNode));break;case 18:null!==Qo&&(el?(e=Qo,i=i.stateNode,8===e.nodeType?er(e.parentNode,i):1===e.nodeType&&er(e,i),Vt(e)):er(Qo,i.stateNode));break;case 4:n=Qo,r=el,Qo=i.stateNode.containerInfo,el=!0,tl(e,t,i),Qo=n,el=r;break;case 0:case 11:case 14:case 15:if(!Uo&&null!==(n=i.updateQueue)&&null!==(n=n.lastEffect)){r=n=n.next;do{var a=r,s=a.destroy;a=a.tag,void 0!==s&&(0!=(2&a)||0!=(4&a))&&jo(i,t,s),r=r.next}while(r!==n)}tl(e,t,i);break;case 1:if(!Uo&&(Go(i,t),"function"==typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(e){hd(i,t,e)}tl(e,t,i);break;case 21:tl(e,t,i);break;case 22:1&i.mode?(Uo=(n=Uo)||null!==i.memoizedState,tl(e,t,i),Uo=n):tl(e,t,i);break;default:tl(e,t,i)}}function nl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new zo),t.forEach((function(t){var n=pd.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function rl(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:Qo=l.stateNode,el=!1;break e;case 3:case 4:Qo=l.stateNode.containerInfo,el=!0;break e}l=l.return}if(null===Qo)throw Error(a(160));il(s,o,r),Qo=null,el=!1;var d=r.alternate;null!==d&&(d.return=null),r.return=null}catch(e){hd(r,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)al(t,e),t=t.sibling}function al(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rl(t,e),sl(e),4&n){try{qo(3,e,e.return),Zo(3,e)}catch(t){hd(e,e.return,t)}try{qo(5,e,e.return)}catch(t){hd(e,e.return,t)}}break;case 1:rl(t,e),sl(e),512&n&&null!==i&&Go(i,i.return);break;case 5:if(rl(t,e),sl(e),512&n&&null!==i&&Go(i,i.return),32&e.flags){var r=e.stateNode;try{ce(r,"")}catch(t){hd(e,e.return,t)}}if(4&n&&null!=(r=e.stateNode)){var s=e.memoizedProps,o=null!==i?i.memoizedProps:s,l=e.type,d=e.updateQueue;if(e.updateQueue=null,null!==d)try{"input"===l&&"radio"===s.type&&null!=s.name&&X(r,s),_e(l,o);var c=_e(l,s);for(o=0;o<d.length;o+=2){var h=d[o],u=d[o+1];"style"===h?fe(r,u):"dangerouslySetInnerHTML"===h?de(r,u):"children"===h?ce(r,u):v(r,h,u,c)}switch(l){case"input":Y(r,s);break;case"textarea":re(r,s);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?te(r,!!s.multiple,f,!1):m!==!!s.multiple&&(null!=s.defaultValue?te(r,!!s.multiple,s.defaultValue,!0):te(r,!!s.multiple,s.multiple?[]:"",!1))}r[ar]=s}catch(t){hd(e,e.return,t)}}break;case 6:if(rl(t,e),sl(e),4&n){if(null===e.stateNode)throw Error(a(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(t){hd(e,e.return,t)}}break;case 3:if(rl(t,e),sl(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(t){hd(e,e.return,t)}break;case 4:rl(t,e),sl(e);break;case 13:rl(t,e),sl(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(xl=Ze())),4&n&&nl(e);break;case 22:if(h=null!==i&&null!==i.memoizedState,1&e.mode?(Uo=(c=Uo)||h,rl(t,e),Uo=c):rl(t,e),sl(e),8192&n){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!=(1&e.mode))for(Ho=e,h=e.child;null!==h;){for(u=Ho=h;null!==Ho;){switch(f=(m=Ho).child,m.tag){case 0:case 11:case 14:case 15:qo(4,m,m.return);break;case 1:Go(m,m.return);var p=m.stateNode;if("function"==typeof p.componentWillUnmount){n=m,i=m.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(e){hd(n,i,e)}}break;case 5:Go(m,m.return);break;case 22:if(null!==m.memoizedState){ll(u);continue}}null!==f?(f.return=m,Ho=f):ll(u)}h=h.sibling}e:for(h=null,u=e;;){if(5===u.tag){if(null===h){h=u;try{r=u.stateNode,c?"function"==typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=u.stateNode,o=null!=(d=u.memoizedProps.style)&&d.hasOwnProperty("display")?d.display:null,l.style.display=me("display",o))}catch(t){hd(e,e.return,t)}}}else if(6===u.tag){if(null===h)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(t){hd(e,e.return,t)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:rl(t,e),sl(e),4&n&&nl(e);break;case 21:break;default:rl(t,e),sl(e)}}function sl(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(Yo(i)){var n=i;break e}i=i.return}throw Error(a(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(ce(r,""),n.flags&=-33),function e(t,i,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,i?n.insertBefore(t,i):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(e(t,i,n),t=t.sibling;null!==t;)e(t,i,n),t=t.sibling}(e,Ko(e),r);break;case 3:case 4:var s=n.stateNode.containerInfo;!function e(t,i,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,i?8===n.nodeType?n.parentNode.insertBefore(t,i):n.insertBefore(t,i):(8===n.nodeType?(i=n.parentNode).insertBefore(t,n):(i=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==i.onclick||(i.onclick=jn));else if(4!==r&&null!==(t=t.child))for(e(t,i,n),t=t.sibling;null!==t;)e(t,i,n),t=t.sibling}(e,Ko(e),s);break;default:throw Error(a(161))}}catch(t){hd(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ol(e){for(;null!==Ho;){var t=Ho;if(0!=(8772&t.flags)){var i=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Uo||Zo(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Uo)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:qs(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Da(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(i=null,null!==t.child)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}Da(t,o,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&i.focus();break;case"img":d.src&&(i.src=d.src)}}break;case 6:case 4:case 12:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var u=h.dehydrated;null!==u&&Vt(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}Uo||512&t.flags&&Jo(t)}catch(e){hd(t,t.return,e)}}if(t===e){Ho=null;break}if(null!==(i=t.sibling)){i.return=t.return,Ho=i;break}Ho=t.return}}function ll(e){for(;null!==Ho;){var t=Ho;if(t===e){Ho=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Ho=i;break}Ho=t.return}}function dl(e){for(;null!==Ho;){var t=Ho;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Zo(4,t)}catch(e){hd(t,i,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(e){hd(t,r,e)}}var a=t.return;try{Jo(t)}catch(e){hd(t,a,e)}break;case 5:var s=t.return;try{Jo(t)}catch(e){hd(t,s,e)}}}catch(e){hd(t,t.return,e)}if(t===e){Ho=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Ho=o;break}Ho=t.return}}var cl,hl=Math.ceil,ul=y.ReactCurrentDispatcher,ml=y.ReactCurrentOwner,fl=y.ReactCurrentBatchConfig,pl=0,gl=null,_l=null,Sl=0,vl=0,yl=gr(0),Tl=0,bl=null,wl=0,Cl=0,Il=0,Pl=null,El=null,xl=0,kl=1/0,Ml=null,Al=!1,Rl=null,Ol=null,Fl=!1,Dl=null,Ll=0,Bl=0,Nl=null,Vl=-1,Wl=0;function Ul(){return 0!=(6&pl)?Ze():-1!==Vl?Vl:Vl=Ze()}function zl(e){return 0==(1&e.mode)?1:0!=(2&pl)&&0!==Sl?Sl&-Sl:null!==oa.transition?(0===Wl&&(Wl=ut()),Wl):0!==(e=gt)?e:e=void 0===(e=window.event)?16:qt(e.type)}function Hl(e,t,i,n){if(50<Bl)throw Bl=0,Nl=null,Error(a(185));ft(e,i,n),0!=(2&pl)&&e===gl||(e===gl&&(0==(2&pl)&&(Cl|=i),4===Tl&&Zl(e,Sl)),Gl(e,n),1===i&&0===pl&&0==(1&t.mode)&&(kl=Ze()+500,Ar&&Fr()))}function Gl(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-nt(a),o=1<<s,l=r[s];-1===l?0!=(o&i)&&0==(o&n)||(r[s]=ct(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=dt(e,e===gl?Sl:0);if(0===n)null!==i&&je(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&je(i),1===t)0===e.tag?function(e){Ar=!0,Or(e)}(Jl.bind(null,e)):Or(Jl.bind(null,e)),Kn((function(){0==(6&pl)&&Fr()})),i=null;else{switch(_t(n)){case 1:i=Xe;break;case 4:i=Ye;break;case 16:i=Ke;break;case 536870912:i=et;break;default:i=Ke}i=gd(i,jl.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function jl(e,t){if(Vl=-1,Wl=0,0!=(6&pl))throw Error(a(327));var i=e.callbackNode;if(dd()&&e.callbackNode!==i)return null;var n=dt(e,e===gl?Sl:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=nd(e,n);else{t=n;var r=pl;pl|=2;var s=td();for(gl===e&&Sl===t||(Ml=null,kl=Ze()+500,Ql(e,t));;)try{ad();break}catch(t){ed(e,t)}Sa(),ul.current=s,pl=r,null!==_l?t=0:(gl=null,Sl=0,t=Tl)}if(0!==t){if(2===t&&0!==(r=ht(e))&&(n=r,t=$l(e,r)),1===t)throw i=bl,Ql(e,0),Zl(e,n),Gl(e,Ze()),i;if(6===t)Zl(e,n);else{if(r=e.current.alternate,0==(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],a=r.getSnapshot;r=r.value;try{if(!en(a(),r))return!1}catch(e){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=nd(e,n))&&0!==(s=ht(e))&&(n=s,t=$l(e,s)),1===t))throw i=bl,Ql(e,0),Zl(e,n),Gl(e,Ze()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:ld(e,El,Ml);break;case 3:if(Zl(e,n),(130023424&n)===n&&10<(t=xl+500-Ze())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){Ul(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=Jn(ld.bind(null,e,El,Ml),t);break}ld(e,El,Ml);break;case 4:if(Zl(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var o=31-nt(n);s=1<<o,(o=t[o])>r&&(r=o),n&=~s}if(n=r,10<(n=(120>(n=Ze()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hl(n/1960))-n)){e.timeoutHandle=Jn(ld.bind(null,e,El,Ml),n);break}ld(e,El,Ml);break;case 5:ld(e,El,Ml);break;default:throw Error(a(329))}}}return Gl(e,Ze()),e.callbackNode===i?jl.bind(null,e):null}function $l(e,t){var i=Pl;return e.current.memoizedState.isDehydrated&&(Ql(e,t).flags|=256),2!==(e=nd(e,t))&&(t=El,El=i,null!==t&&ql(t)),e}function ql(e){null===El?El=e:El.push.apply(El,e)}function Zl(e,t){for(t&=~Il,t&=~Cl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-nt(t),n=1<<i;e[i]=-1,t&=~n}}function Jl(e){if(0!=(6&pl))throw Error(a(327));dd();var t=dt(e,0);if(0==(1&t))return Gl(e,Ze()),null;var i=nd(e,t);if(0!==e.tag&&2===i){var n=ht(e);0!==n&&(t=n,i=$l(e,n))}if(1===i)throw i=bl,Ql(e,0),Zl(e,t),Gl(e,Ze()),i;if(6===i)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ld(e,El,Ml),Gl(e,Ze()),null}function Xl(e,t){var i=pl;pl|=1;try{return e(t)}finally{0===(pl=i)&&(kl=Ze()+500,Ar&&Fr())}}function Yl(e){null!==Dl&&0===Dl.tag&&0==(6&pl)&&dd();var t=pl;pl|=1;var i=fl.transition,n=gt;try{if(fl.transition=null,gt=1,e)return e()}finally{gt=n,fl.transition=i,0==(6&(pl=t))&&Fr()}}function Kl(){vl=yl.current,_r(yl)}function Ql(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,Xn(i)),null!==_l)for(i=_l.return;null!==i;){var n=i;switch(qr(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&Ir();break;case 3:za(),_r(Tr),_r(yr),Za();break;case 5:Ga(n);break;case 4:za();break;case 13:case 19:_r(ja);break;case 10:va(n.type._context);break;case 22:case 23:Kl()}i=i.return}if(gl=e,_l=e=yd(e.current,null),Sl=vl=t,Tl=0,bl=null,Il=Cl=wl=0,El=Pl=null,null!==wa){for(t=0;t<wa.length;t++)if(null!==(n=(i=wa[t]).interleaved)){i.interleaved=null;var r=n.next,a=i.pending;if(null!==a){var s=a.next;a.next=r,n.next=s}i.pending=n}wa=null}return e}function ed(e,t){for(;;){var i=_l;try{if(Sa(),Ja.current=Hs,ts){for(var n=Ka.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}ts=!1}if(Ya=0,es=Qa=Ka=null,is=!1,ns=0,ml.current=null,null===i||null===i.return){Tl=1,bl=t,_l=null;break}e:{var s=e,o=i.return,l=i,d=t;if(t=Sl,l.flags|=32768,null!==d&&"object"==typeof d&&"function"==typeof d.then){var c=d,h=l,u=h.tag;if(0==(1&h.mode)&&(0===u||11===u||15===u)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=oo(o);if(null!==f){f.flags&=-257,lo(f,o,l,0,t),1&f.mode&&so(s,c,t),d=c;var p=(t=f).updateQueue;if(null===p){var g=new Set;g.add(d),t.updateQueue=g}else p.add(d);break e}if(0==(1&t)){so(s,c,t),id();break e}d=Error(a(426))}else if(Xr&&1&l.mode){var _=oo(o);if(null!==_){0==(65536&_.flags)&&(_.flags|=256),lo(_,o,l,0,t),sa(eo(d,l));break e}}s=d=eo(d,l),4!==Tl&&(Tl=2),null===Pl?Pl=[s]:Pl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Oa(s,ro(0,d,t));break e;case 1:l=d;var S=s.type,v=s.stateNode;if(0==(128&s.flags)&&("function"==typeof S.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===Ol||!Ol.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,Oa(s,ao(s,l,t));break e}}s=s.return}while(null!==s)}od(i)}catch(e){t=e,_l===i&&null!==i&&(_l=i=i.return);continue}break}}function td(){var e=ul.current;return ul.current=Hs,null===e?Hs:e}function id(){0!==Tl&&3!==Tl&&2!==Tl||(Tl=4),null===gl||0==(268435455&wl)&&0==(268435455&Cl)||Zl(gl,Sl)}function nd(e,t){var i=pl;pl|=2;var n=td();for(gl===e&&Sl===t||(Ml=null,Ql(e,t));;)try{rd();break}catch(t){ed(e,t)}if(Sa(),pl=i,ul.current=n,null!==_l)throw Error(a(261));return gl=null,Sl=0,Tl}function rd(){for(;null!==_l;)sd(_l)}function ad(){for(;null!==_l&&!$e();)sd(_l)}function sd(e){var t=cl(e.alternate,e,vl);e.memoizedProps=e.pendingProps,null===t?od(e):_l=t,ml.current=null}function od(e){var t=e;do{var i=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(i=No(i,t,vl)))return void(_l=i)}else{if(null!==(i=Vo(i,t)))return i.flags&=32767,void(_l=i);if(null===e)return Tl=6,void(_l=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(_l=t);_l=t=e}while(null!==t);0===Tl&&(Tl=5)}function ld(e,t,i){var n=gt,r=fl.transition;try{fl.transition=null,gt=1,function(e,t,i,n){do{dd()}while(null!==Dl);if(0!=(6&pl))throw Error(a(327));i=e.finishedWork;var r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-nt(i),a=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~a}}(e,s),e===gl&&(_l=gl=null,Sl=0),0==(2064&i.subtreeFlags)&&0==(2064&i.flags)||Fl||(Fl=!0,gd(Ke,(function(){return dd(),null}))),s=0!=(15990&i.flags),0!=(15990&i.subtreeFlags)||s){s=fl.transition,fl.transition=null;var o=gt;gt=1;var l=pl;pl|=4,ml.current=null,function(e,t){if($n=Ut,sn(e=an())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch(e){i=null;break e}var o=0,l=-1,d=-1,c=0,h=0,u=e,m=null;t:for(;;){for(var f;u!==i||0!==r&&3!==u.nodeType||(l=o+r),u!==s||0!==n&&3!==u.nodeType||(d=o+n),3===u.nodeType&&(o+=u.nodeValue.length),null!==(f=u.firstChild);)m=u,u=f;for(;;){if(u===e)break t;if(m===i&&++c===r&&(l=o),m===s&&++h===n&&(d=o),null!==(f=u.nextSibling))break;m=(u=m).parentNode}u=f}i=-1===l||-1===d?null:{start:l,end:d}}else i=null}i=i||{start:0,end:0}}else i=null;for(qn={focusedElem:e,selectionRange:i},Ut=!1,Ho=t;null!==Ho;)if(e=(t=Ho).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Ho=e;else for(;null!==Ho;){t=Ho;try{var p=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:break;case 1:if(null!==p){var g=p.memoizedProps,_=p.memoizedState,S=t.stateNode,v=S.getSnapshotBeforeUpdate(t.elementType===t.type?g:qs(t.type,g),_);S.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(e){hd(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Ho=e;break}Ho=t.return}p=$o,$o=!1}(e,i),al(i,e),function(e){var t=an(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&function e(t,i){return!(!t||!i)&&(t===i||(!t||3!==t.nodeType)&&(i&&3===i.nodeType?e(t,i.parentNode):"contains"in t?t.contains(i):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(i))))}(i.ownerDocument.documentElement,i)){if(null!==n&&sn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,a=Math.min(n.start,r);n=void 0===n.end?a:Math.min(n.end,r),!e.extend&&a>n&&(r=n,n=a,a=r),r=rn(i,a);var s=rn(i,n);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}(qn),Ut=!!$n,qn=$n=null,e.current=i,function(e,t,i){Ho=e,function e(t,i,n){for(var r=0!=(1&t.mode);null!==Ho;){var a=Ho,s=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Wo;if(!o){var l=a.alternate,d=null!==l&&null!==l.memoizedState||Uo;l=Wo;var c=Uo;if(Wo=o,(Uo=d)&&!c)for(Ho=a;null!==Ho;)d=(o=Ho).child,22===o.tag&&null!==o.memoizedState?dl(a):null!==d?(d.return=o,Ho=d):dl(a);for(;null!==s;)Ho=s,e(s,i,n),s=s.sibling;Ho=a,Wo=l,Uo=c}ol(t)}else 0!=(8772&a.subtreeFlags)&&null!==s?(s.return=a,Ho=s):ol(t)}}(e,t,i)}(i,e,r),qe(),pl=l,gt=o,fl.transition=s}else e.current=i;if(Fl&&(Fl=!1,Dl=e,Ll=r),0===(s=e.pendingLanes)&&(Ol=null),function(e){if(it&&"function"==typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(tt,e,void 0,128==(128&e.current.flags))}catch(e){}}(i.stateNode),Gl(e,Ze()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n((r=t[i]).value,{componentStack:r.stack,digest:r.digest});if(Al)throw Al=!1,e=Rl,Rl=null,e;0!=(1&Ll)&&0!==e.tag&&dd(),0!=(1&(s=e.pendingLanes))?e===Nl?Bl++:(Bl=0,Nl=e):Bl=0,Fr()}(e,t,i,n)}finally{fl.transition=r,gt=n}return null}function dd(){if(null!==Dl){var e=_t(Ll),t=fl.transition,i=gt;try{if(fl.transition=null,gt=16>e?16:e,null===Dl)var n=!1;else{if(e=Dl,Dl=null,Ll=0,0!=(6&pl))throw Error(a(331));var r=pl;for(pl|=4,Ho=e.current;null!==Ho;){var s=Ho,o=s.child;if(0!=(16&Ho.flags)){var l=s.deletions;if(null!==l){for(var d=0;d<l.length;d++){var c=l[d];for(Ho=c;null!==Ho;){var h=Ho;switch(h.tag){case 0:case 11:case 15:qo(8,h,s)}var u=h.child;if(null!==u)u.return=h,Ho=u;else for(;null!==Ho;){var m=(h=Ho).sibling,f=h.return;if(Xo(h),h===c){Ho=null;break}if(null!==m){m.return=f,Ho=m;break}Ho=f}}}var p=s.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}Ho=s}}if(0!=(2064&s.subtreeFlags)&&null!==o)o.return=s,Ho=o;else e:for(;null!==Ho;){if(0!=(2048&(s=Ho).flags))switch(s.tag){case 0:case 11:case 15:qo(9,s,s.return)}var S=s.sibling;if(null!==S){S.return=s.return,Ho=S;break e}Ho=s.return}}var v=e.current;for(Ho=v;null!==Ho;){var y=(o=Ho).child;if(0!=(2064&o.subtreeFlags)&&null!==y)y.return=o,Ho=y;else e:for(o=v;null!==Ho;){if(0!=(2048&(l=Ho).flags))try{switch(l.tag){case 0:case 11:case 15:Zo(9,l)}}catch(e){hd(l,l.return,e)}if(l===o){Ho=null;break e}var T=l.sibling;if(null!==T){T.return=l.return,Ho=T;break e}Ho=l.return}}if(pl=r,Fr(),it&&"function"==typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(tt,e)}catch(e){}n=!0}return n}finally{gt=i,fl.transition=t}}return!1}function cd(e,t,i){e=Aa(e,t=ro(0,t=eo(i,t),1),1),t=Ul(),null!==e&&(ft(e,1,t),Gl(e,t))}function hd(e,t,i){if(3===e.tag)cd(e,e,i);else for(;null!==t;){if(3===t.tag){cd(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Ol||!Ol.has(n))){t=Aa(t,e=ao(t,e=eo(i,e),1),1),e=Ul(),null!==t&&(ft(t,1,e),Gl(t,e));break}}t=t.return}}function ud(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=Ul(),e.pingedLanes|=e.suspendedLanes&i,gl===e&&(Sl&i)===i&&(4===Tl||3===Tl&&(130023424&Sl)===Sl&&500>Ze()-xl?Ql(e,0):Il|=i),Gl(e,t)}function md(e,t){0===t&&(0==(1&e.mode)?t=1:(t=ot,0==(130023424&(ot<<=1))&&(ot=4194304)));var i=Ul();null!==(e=Pa(e,t))&&(ft(e,t,i),Gl(e,i))}function fd(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),md(e,i)}function pd(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),md(e,i)}function gd(e,t){return Ge(e,t)}function _d(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sd(e,t,i,n){return new _d(e,t,i,n)}function vd(e){return!(!(e=e.prototype)||!e.isReactComponent)}function yd(e,t){var i=e.alternate;return null===i?((i=Sd(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Td(e,t,i,n,r,s){var o=2;if(n=e,"function"==typeof e)vd(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case w:return bd(i.children,r,s,t);case C:o=8,r|=8;break;case I:return(e=Sd(12,i,t,2|r)).elementType=I,e.lanes=s,e;case k:return(e=Sd(13,i,t,r)).elementType=k,e.lanes=s,e;case M:return(e=Sd(19,i,t,r)).elementType=M,e.lanes=s,e;case O:return wd(i,r,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case P:o=10;break e;case E:o=9;break e;case x:o=11;break e;case A:o=14;break e;case R:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Sd(o,i,t,r)).elementType=e,t.type=n,t.lanes=s,t}function bd(e,t,i,n){return(e=Sd(7,e,n,t)).lanes=i,e}function wd(e,t,i,n){return(e=Sd(22,e,n,t)).elementType=O,e.lanes=i,e.stateNode={isHidden:!1},e}function Cd(e,t,i){return(e=Sd(6,e,null,t)).lanes=i,e}function Id(e,t,i){return(t=Sd(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Pd(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ed(e,t,i,n,r,a,s,o,l){return e=new Pd(e,t,i,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Sd(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},xa(a),e}function xd(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}function kd(e){if(!e)return vr;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Cr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var i=e.type;if(Cr(i))return Er(e,i,t)}return t}function Md(e,t,i,n,r,a,s,o,l){return(e=Ed(i,n,!0,e,0,a,0,o,l)).context=kd(null),i=e.current,(a=Ma(n=Ul(),r=zl(i))).callback=null!=t?t:null,Aa(i,a,r),e.current.lanes=r,ft(e,r,n),Gl(e,n),e}function Ad(e,t,i,n){var r=t.current,a=Ul(),s=zl(r);return i=kd(i),null===t.context?t.context=i:t.pendingContext=i,(t=Ma(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Aa(r,t,s))&&(Hl(e,r,s,a),Ra(e,r,s)),s}function Rd(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Od(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Fd(e,t){Od(e,t),(e=e.alternate)&&Od(e,t)}cl=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Tr.current)ho=!0;else{if(0==(e.lanes&i)&&0==(128&t.flags))return ho=!1,function(e,t,i){switch(t.tag){case 3:To(t),aa();break;case 5:Ha(t);break;case 1:Cr(t.type)&&xr(t);break;case 4:Ua(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Sr(fa,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Sr(ja,1&ja.current),t.flags|=128,null):0!=(i&t.child.childLanes)?xo(e,t,i):(Sr(ja,1&ja.current),null!==(e=Do(e,t,i))?e.sibling:null);Sr(ja,1&ja.current);break;case 19:if(n=0!=(i&t.childLanes),0!=(128&e.flags)){if(n)return Oo(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Sr(ja,ja.current),n)break;return null;case 22:case 23:return t.lanes=0,go(e,t,i)}return Do(e,t,i)}(e,t,i);ho=0!=(131072&e.flags)}else ho=!1,Xr&&0!=(1048576&t.flags)&&jr(t,Nr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fo(e,t),e=t.pendingProps;var r=wr(t,yr.current);Ta(t,i),r=os(null,t,n,e,r,i);var s=ls();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Cr(n)?(s=!0,xr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,xa(t),r.updater=Js,t.stateNode=r,r._reactInternals=t,Qs(t,n,e,i),t=yo(null,t,n,!0,s,i)):(t.tag=0,Xr&&s&&$r(t),uo(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Fo(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"==typeof e)return vd(e)?1:0;if(null!=e){if((e=e.$$typeof)===x)return 11;if(e===A)return 14}return 2}(n),e=qs(n,e),r){case 0:t=So(null,t,n,e,i);break e;case 1:t=vo(null,t,n,e,i);break e;case 11:t=mo(null,t,n,e,i);break e;case 14:t=fo(null,t,n,qs(n.type,e),i);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,So(e,t,n,r=t.elementType===n?r:qs(n,r),i);case 1:return n=t.type,r=t.pendingProps,vo(e,t,n,r=t.elementType===n?r:qs(n,r),i);case 3:e:{if(To(t),null===e)throw Error(a(387));n=t.pendingProps,r=(s=t.memoizedState).element,ka(e,t),Fa(t,n,null,i);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=bo(e,t,n,i,r=eo(Error(a(423)),t));break e}if(n!==r){t=bo(e,t,n,i,r=eo(Error(a(424)),t));break e}for(Jr=tr(t.stateNode.containerInfo.firstChild),Zr=t,Xr=!0,Yr=null,i=ma(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(aa(),n===r){t=Do(e,t,i);break e}uo(e,t,n,i)}t=t.child}return t;case 5:return Ha(t),null===e&&ta(t),n=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,o=r.children,Zn(n,r)?o=null:null!==s&&Zn(n,s)&&(t.flags|=32),_o(e,t),uo(e,t,o,i),t.child;case 6:return null===e&&ta(t),null;case 13:return xo(e,t,i);case 4:return Ua(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=ua(t,null,n,i):uo(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,mo(e,t,n,r=t.elementType===n?r:qs(n,r),i);case 7:return uo(e,t,t.pendingProps,i),t.child;case 8:case 12:return uo(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,Sr(fa,n._currentValue),n._currentValue=o,null!==s)if(en(s.value,o)){if(s.children===r.children&&!Tr.current){t=Do(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var d=l.firstContext;null!==d;){if(d.context===n){if(1===s.tag){(d=Ma(-1,i&-i)).tag=2;var c=s.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?d.next=d:(d.next=h.next,h.next=d),c.pending=d}}s.lanes|=i,null!==(d=s.alternate)&&(d.lanes|=i),ya(s.return,i,t),l.lanes|=i;break}d=d.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),ya(o,i,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}uo(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Ta(t,i),n=n(r=ba(r)),t.flags|=1,uo(e,t,n,i),t.child;case 14:return r=qs(n=t.type,t.pendingProps),fo(e,t,n,r=qs(n.type,r),i);case 15:return po(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:qs(n,r),Fo(e,t),t.tag=1,Cr(n)?(e=!0,xr(t)):e=!1,Ta(t,i),Ys(t,n,r),Qs(t,n,r,i),yo(null,t,n,!0,e,i);case 19:return Oo(e,t,i);case 22:return go(e,t,i)}throw Error(a(156,t.tag))};var Dd="function"==typeof reportError?reportError:function(e){console.error(e)};function Ld(e){this._internalRoot=e}function Bd(e){this._internalRoot=e}function Nd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Vd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Wd(){}function Ud(e,t,i,n,r){var a=i._reactRootContainer;if(a){var s=a;if("function"==typeof r){var o=r;r=function(){var e=Rd(s);o.call(e)}}Ad(t,s,e,r)}else s=function(e,t,i,n,r){if(r){if("function"==typeof n){var a=n;n=function(){var e=Rd(s);a.call(e)}}var s=Md(t,n,e,0,null,!1,0,"",Wd);return e._reactRootContainer=s,e[sr]=s.current,Fn(8===e.nodeType?e.parentNode:e),Yl(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof n){var o=n;n=function(){var e=Rd(l);o.call(e)}}var l=Ed(e,0,!1,null,0,!1,0,"",Wd);return e._reactRootContainer=l,e[sr]=l.current,Fn(8===e.nodeType?e.parentNode:e),Yl((function(){Ad(t,l,i,n)})),l}(i,t,e,r,n);return Rd(s)}Bd.prototype.render=Ld.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Ad(e,t,null,null)},Bd.prototype.unmount=Ld.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Yl((function(){Ad(null,e,null,null)})),t[sr]=null}},Bd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Mt.length&&0!==t&&t<Mt[i].priority;i++);Mt.splice(i,0,e),0===i&&Ft(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=lt(t.pendingLanes);0!==i&&(pt(t,1|i),Gl(t,Ze()),0==(6&pl)&&(kl=Ze()+500,Fr()))}break;case 13:Yl((function(){var t=Pa(e,1);if(null!==t){var i=Ul();Hl(t,e,1,i)}})),Fd(e,1)}},vt=function(e){if(13===e.tag){var t=Pa(e,134217728);null!==t&&Hl(t,e,134217728,Ul()),Fd(e,134217728)}},yt=function(e){if(13===e.tag){var t=zl(e),i=Pa(e,t);null!==i&&Hl(i,e,t,Ul()),Fd(e,t)}},Tt=function(){return gt},bt=function(e,t){var i=gt;try{return gt=e,t()}finally{gt=i}},ye=function(e,t,i){switch(t){case"input":if(Y(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=mr(n);if(!r)throw Error(a(90));$(n),Y(n,r)}}}break;case"textarea":re(e,i);break;case"select":null!=(t=i.value)&&te(e,!!i.multiple,t,!1)}},Pe=Xl,Ee=Yl;var zd={usingClientEntryPoint:!1,Events:[hr,ur,mr,Ce,Ie,Xl]},Hd={findFiberByHostInstance:cr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gd={bundleType:Hd.bundleType,version:Hd.version,rendererPackageName:Hd.rendererPackageName,rendererConfig:Hd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:Hd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jd.isDisabled&&jd.supportsFiber)try{tt=jd.inject(Gd),it=jd}catch(e){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zd,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Nd(t))throw Error(a(200));return xd(e,t,null,i)},t.createRoot=function(e,t){if(!Nd(e))throw Error(a(299));var i=!1,n="",r=Dd;return null!=t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Ed(e,1,!1,null,0,i,0,n,r),e[sr]=t.current,Fn(8===e.nodeType?e.parentNode:e),new Ld(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return Yl(e)},t.hydrate=function(e,t,i){if(!Vd(t))throw Error(a(200));return Ud(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Nd(e))throw Error(a(405));var n=null!=i&&i.hydratedSources||null,r=!1,s="",o=Dd;if(null!=i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),t=Md(t,null,e,1,null!=i?i:null,r,0,s,o),e[sr]=t.current,Fn(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new Bd(t)},t.render=function(e,t,i){if(!Vd(t))throw Error(a(200));return Ud(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Vd(e))throw Error(a(40));return!!e._reactRootContainer&&(Yl((function(){Ud(null,null,e,!1,(function(){e._reactRootContainer=null,e[sr]=null}))})),!0)},t.unstable_batchedUpdates=Xl,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Vd(i))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Ud(e,t,i,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},function(e,t,i){"use strict";e.exports=i(223)},function(e,t,i){"use strict";
/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n,r,a,s;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();t.unstable_now=function(){return l.now()-d}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var c=null,h=null,u=function(){if(null!==c)try{var e=t.unstable_now();c(!0,e),c=null}catch(e){throw setTimeout(u,0),e}};n=function(e){null!==c?setTimeout(n,0,e):(c=e,setTimeout(u,0))},r=function(e,t){h=setTimeout(e,t)},a=function(){clearTimeout(h)},t.unstable_shouldYield=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var m=window.setTimeout,f=window.clearTimeout;if("undefined"!=typeof console){var p=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,_=null,S=-1,v=5,y=0;t.unstable_shouldYield=function(){return t.unstable_now()>=y},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<e?Math.floor(1e3/e):5};var T=new MessageChannel,b=T.port2;T.port1.onmessage=function(){if(null!==_){var e=t.unstable_now();y=e+v;try{_(!0,e)?b.postMessage(null):(g=!1,_=null)}catch(e){throw b.postMessage(null),e}}else g=!1},n=function(e){_=e,g||(g=!0,b.postMessage(null))},r=function(e,i){S=m((function(){e(t.unstable_now())}),i)},a=function(){f(S),S=-1}}function w(e,t){var i=e.length;e.push(t);e:for(;;){var n=i-1>>>1,r=e[n];if(!(void 0!==r&&0<P(r,t)))break e;e[n]=t,e[i]=r,i=n}}function C(e){return void 0===(e=e[0])?null:e}function I(e){var t=e[0];if(void 0!==t){var i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length;n<r;){var a=2*(n+1)-1,s=e[a],o=a+1,l=e[o];if(void 0!==s&&0>P(s,i))void 0!==l&&0>P(l,s)?(e[n]=l,e[o]=i,n=o):(e[n]=s,e[a]=i,n=a);else{if(!(void 0!==l&&0>P(l,i)))break e;e[n]=l,e[o]=i,n=o}}}return t}return null}function P(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}var E=[],x=[],k=1,M=null,A=3,R=!1,O=!1,F=!1;function D(e){for(var t=C(x);null!==t;){if(null===t.callback)I(x);else{if(!(t.startTime<=e))break;I(x),t.sortIndex=t.expirationTime,w(E,t)}t=C(x)}}function L(e){if(F=!1,D(e),!O)if(null!==C(E))O=!0,n(B);else{var t=C(x);null!==t&&r(L,t.startTime-e)}}function B(e,i){O=!1,F&&(F=!1,a()),R=!0;var n=A;try{for(D(i),M=C(E);null!==M&&(!(M.expirationTime>i)||e&&!t.unstable_shouldYield());){var s=M.callback;if("function"==typeof s){M.callback=null,A=M.priorityLevel;var o=s(M.expirationTime<=i);i=t.unstable_now(),"function"==typeof o?M.callback=o:M===C(E)&&I(E),D(i)}else I(E);M=C(E)}if(null!==M)var l=!0;else{var d=C(x);null!==d&&r(L,d.startTime-i),l=!1}return l}finally{M=null,A=n,R=!1}}var N=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){O||R||(O=!0,n(B))},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return C(E)},t.unstable_next=function(e){switch(A){case 1:case 2:case 3:var t=3;break;default:t=A}var i=A;A=t;try{return e()}finally{A=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=N,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=A;A=e;try{return t()}finally{A=i}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?o+s:o,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:k++,callback:i,priorityLevel:e,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>o?(e.sortIndex=s,w(x,e),null===C(E)&&e===C(x)&&(F?a():F=!0,r(L,s-o))):(e.sortIndex=l,w(E,e),O||R||(O=!0,n(B))),e},t.unstable_wrapCallback=function(e){var t=A;return function(){var i=A;A=t;try{return e.apply(this,arguments)}finally{A=i}}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;const int pc=0,qc=1,rc=2,sc=3,tc=-1;const int k=0,l=1,m=2,n=3;const int uc=0,vc=1,wc=2;uniform vec2 u_0;uniform vec2 u_1;uniform vec2 u_2;uniform float u_3;uniform int u_4;uniform float u_5;uniform int u_6;uniform int u_7;uniform mat3 u_8;uniform float u_12;uniform int u_13;uniform float u_14;uniform int u_15;uniform vec2 u_17;uniform int u_18;uniform int u_19;attribute vec2 a_v;attribute vec4 a_p0;attribute vec4 a_p1;attribute vec4 a_p2;attribute vec4 a_p3;attribute vec4 a_p4;attribute float a_d1;attribute float a_d2;const float o=0.0,p=1.0,q=3.0,s=4.0,t=5.0,u=6.0,v=7.0;const float xc=0.001;const float yc=0.001;varying float frag_type;varying vec3 frag_geoUVS;varying vec2 frag_geoRange;varying vec4 frag_specialParam1;varying vec4 frag_specialParam2;varying vec4 frag_specialParam3;varying vec3 frag_specialParam4;varying vec2 frag_specialParam5;const int zc=2,Ac=5;const int Bc=0,Cc=1,Dc=2,Ec=3;vec2 Fc(vec4 Gc){mat3 Hc=u_8;vec2 Ic=u_0;vec2 Jc=u_1;vec2 Kc=u_17;return((Hc*vec3(Gc.xy,1.0)).xy*Jc-Ic)/Kc;}vec2 Lc(vec2 wb){return vec2(-wb.y,wb.x);}void main(){vec2 Mc=a_v;int Y=u_7;vec2 Nc=u_2;float Oc=u_3;int Z=u_4;float Pc=u_5;float Qc=u_12;int fb=u_13;float Rc=u_14;int Sc=u_15;vec2 Kc=u_17;bool Tc=u_18 !=0;bool Uc=u_19 !=0;frag_type=0.0;frag_geoRange=frag_specialParam5=vec2(0.0,0.0);frag_geoUVS=frag_specialParam4=vec3(0.0,0.0,0.0);frag_specialParam1=frag_specialParam2=frag_specialParam3=vec4(0.0,0.0,0.0,0.0);if(Y==rc || Y==sc){gl_Position=vec4(Mc,0.0,1.0);frag_type=p;}else{vec2 Vc=Fc(a_p0),Wc=Fc(a_p1),Xc=Fc(a_p2),Yc=Fc(a_p3),Zc=Fc(a_p4);int ad=int(a_p0.z),bd=int(a_p1.z),cd=int(a_p2.z),dd=int(a_p3.z),ed=int(a_p4.z);float fd=Uc ? 0.0 : a_d1,gd=Uc ? 0.0 : a_d2;float hd=a_p1.w,id=a_p2.w,jd=a_p3.w;bool kd=bd==wc;bool ld=cd==wc;vec2 md,nd,od;int pd,qd;if(ld){md=Wc;nd=Xc;od=Yc;pd=bd;qd=dd;}else if(kd){md=Vc;nd=Wc;od=Xc;pd=ad;qd=cd;}else{md=Wc;nd=(Wc+Xc)*0.5;od=Xc;pd=bd;qd=cd;}vec2 rd=od-md,sd=nd-md,td=od-nd;float ud=length(rd),vd=length(sd),wd=length(td);vec2 xd=rd/ud,yd=sd/vd,zd=td/wd;vec2 Ad=Lc(xd),Bd=Lc(yd),Cd=Lc(zd);float Dd=dot(Bd,zd);mat2 Ed;vec2 Fd,Gd;float Hd;bool Id=false;vec2 Jd;if(ld || kd){vec2 Kd=td-sd;float Ld=(dot(-sd,td)+dot(-sd,-sd))/dot(Kd,Kd);vec2 Md=mix(md,nd,Ld),Nd=mix(nd,od,Ld),Od=normalize(Nd-Md);float Pd=sign(Dd);mat2 Qd=mat2(Od,vec2(-Od.y,Od.x)*Pd);vec2 Rd=mix(Md,Nd,Ld);vec2 Sd=(md-Rd)*Qd,Td=(od-Rd)*Qd;float Ud=abs(Sd.x)> abs(Td.x)?(Sd.x*Sd.x)/Sd.y :(Td.x*Td.x)/Td.y;Ed=Qd/Ud;Fd=Rd;Gd=vec2(Sd.x,Td.x)/Ud;Hd=Ud*Pd;Id=Tc || abs(Dd)< xc || min(abs(ud),min(abs(vd/ud),abs(wd/ud)))< yc;if(Id){nd=(md+od)*0.5;sd=nd-md;td=od-nd;vd=wd=ud*0.5;yd=zd=xd;Bd=Cd=Ad;Dd=1.0;}}bool Vd=ld || kd;vec2 Wd=Vc;int Xd=ad;vec2 Yd=Vd ? Zc : Yc;int Zd=Vd ? ed : dd;bool ae=(Xd==0),be=(Zd==0),ce=(qd==0);if(Xd==0)Wd=md-(nd-md);if(Zd==0)Yd=od-(od-nd);vec2 de=md-Wd,ee=-de,fe=Yd-od,ge=-fe;float he=length(de),ie=length(fe);vec2 je=de/he,ke=fe/ie;vec2 le=Lc(je),me=Lc(ke);if(! Vd || Id){if(vd < yc){yd=je;Bd=le;}if(wd < yc){zd=ke;Cd=me;}if(ud < yc){xd=normalize(Yd-Wd);Ad=Lc(xd);}if(ud < yc){xd=vec2(1.0,0.0);Ad=vec2(0.0,-1.0);ud=yc;}if(vd < yc){yd=xd;Bd=Ad;}if(wd < yc){zd=xd;Cd=Ad;}if(he < yc){je=yd;le=Bd;}if(ie < yc){ke=zd;me=Cd;}Ed=mat2(xd/ud,Ad/ud);Fd=md;Gd=vec2(0.0,1.0);Hd=ud;}vec2 ne=vec2(0.0,0.0);if(Y==pc &&(! Vd || ld)){if(Tc){bool ce=(qd==0);if(ce || abs(ud)< Oc*yc)frag_type=o;else{float oe=clamp(hd,0.0,1.0);float pe=clamp((Vd ? jd : id),0.0,1.0);float qe=Vd ? fd+(gd-fd)*2.0 : gd;float re=Qc*0.5;vec4 se=vec4(min(md.x,od.x)-Oc*Kc.x,min(md.y,od.y)-Oc*Kc.y,max(md.x,od.x)+Oc*Kc.x,max(md.y,od.y)+Oc*Kc.y);ne=Mc*vec2(se [ 2 ]-se [ 0 ],se [ 3 ]-se [ 1 ])/2.0+vec2(se [ 2 ]+se [ 0 ],se [ 3 ]+se [ 1 ])/2.0;vec2 te=vec2(xd.x==0.0 ? 1.0 : sign(xd.x),xd.y==0.0 ? 1.0 : sign(xd.y));float ue=re*(1.0-oe),ve=re*(1.0-pe);float we=re*oe,xe=re*pe;vec2 ye=md-te*we,ze=od+te*xe;vec2 Ae=ye+vec2(te.x*2.0*we,0.0),Be=ze-vec2(te.x*2.0*xe,0.0);vec2 Ce=ye+vec2(0.0,te.y*2.0*we),De=ze-vec2(0.0,te.y*2.0*xe);bool Ee=dot(Ad,Ae-md)>=0.0,Fe=dot(Ad,Be-md)>=0.0;vec2 Ge=Ee ? Ae : Ce,He=Fe ? Be : De;vec2 Ie=Ee ? Ce : Ae,Je=Fe ? De : Be;float Ke=max(abs(xd.x),abs(xd.y));float Le=dot(ne-Ge,Lc(normalize(He-Ge)))*Ke+re;float Me=dot(ne-Ie,-Lc(normalize(Je-Ie)))*Ke+re;float Ne=dot(ne-md,Ad);float Oe=dot(ne-md,(oe > xc)? Lc(Ie-Ge): xd);float Pe=dot(ne-od,(pe > xc)? Lc(He-Je):-xd);frag_specialParam1=vec4(ne-md,ne-od)*0.5/Oc;frag_specialParam2=vec4(Le,Me,ue,ve)*0.5/Oc;frag_specialParam3=vec4(gd-fd,fd,0.0,0.0);frag_specialParam4=vec3(Ne,Oe,Pe);frag_type=v;}}else{float Qe=dot(le,yd),Re=dot(Cd,ke),Se=dot(le,xd),Te=dot(Ad,ke);bool Ue=abs(Qe)< xc,Ve=abs(Re)< xc;bool We=Ue && dot(je,yd)< 0.0,Xe=Ve && dot(zd,ke)< 0.0;float Ye=(! Ue)? sign(Qe):(Se !=0.0)? sign(Se): sign(Te);float Ze=(! Ve)? sign(Re):(Te !=0.0)? sign(Te): sign(Se);vec2 af=normalize(le+Bd)*-Ye;float bf=abs(dot(af,Bd));float cf=(Z==k)? bf :(Z==l)? 1.0/max(bf,xc): 1.0;vec2 df=We ? yd*Ye : af*cf;vec2 ef=normalize(Cd+me)*-Ze;float ff=abs(dot(ef,Cd));float gf=(Z==k)? ff :(Z==l)? 1.0/max(ff,xc): 1.0;vec2 hf=Xe ?-zd*Ze : ef*gf;vec4 se=vec4(min(min(min(min(md.x,od.x),nd.x),md.x+df.x*Oc),od.x+hf.x*Oc)-Oc,min(min(min(min(md.y,od.y),nd.y),md.y+df.y*Oc),od.y+hf.y*Oc)-Oc,max(max(max(max(md.x,od.x),nd.x),md.x+df.x*Oc),od.x+hf.x*Oc)+Oc,max(max(max(max(md.y,od.y),nd.y),md.y+df.y*Oc),od.y+hf.y*Oc)+Oc);ne=Mc*vec2(se [ 2 ]-se [ 0 ],se [ 3 ]-se [ 1 ])/2.0+vec2(se [ 2 ]+se [ 0 ],se [ 3 ]+se [ 1 ])/2.0;vec2 jf=normalize(Bd+df*Ye);vec2 kf=-normalize(le+df*Ye);bool lf=ce || We || Ue || cf > vd*10.0 || cf > he*10.0;vec2 mf=ne-md;vec2 nf=normalize(df);float Cb=-dot(mf,(vd < xc || We)? xd : yd);float Db=lf ? Cb :-dot(mf,Lc(nf))*Ye;float Eb=lf ?-dot(mf,Bd)*Ye : dot(mf,Lc(jf))/(2.0*Oc*length(df+jf*dot(-df,jf)));float Fb=lf ? 0.5 :(dot(mf,nf)/Oc-Pc)/abs(dot(nf,Bd));float Gb=lf ? 1.0 : dot(mf,Lc(kf))/(2.0*Oc*length(df+kf*dot(-df,kf)));vec2 of=-normalize(Cd+hf*Ze);vec2 pf=normalize(me+hf*Ze);bool qf=ce || Xe || Ve || gf > wd*10.0 || gf > ie*10.0;vec2 rf=ne-od;vec2 sf=normalize(hf);float Hb=dot(rf,(wd < xc || Xe)? xd : zd);float Ib=qf ? Hb : dot(rf,Lc(sf))*Ze;float Jb=qf ?-dot(rf,Cd)*Ze : dot(rf,Lc(of))/(2.0*Oc*length(hf+of*dot(-hf,of)));float Kb=qf ? 0.5 :(dot(rf,sf)/Oc-Pc)/abs(dot(sf,Cd));float Lb=qf ? 1.0 : dot(rf,Lc(pf))/(2.0*Oc*length(hf+pf*dot(-hf,pf)));float tf=(1.0-Rc)*Qc/(4.0*Oc);if(ae)Gb=-dot(mf,yd)/(2.0*Oc)+tf;if(be)Lb=dot(rf,zd)/(2.0*Oc)+tf;float uf,vf;if(Vd && ! Id){float wf=fd,qe=fd+(gd-fd)*2.0;float xf=sqrt(1.0+4.0*Gd [ 0 ]*Gd [ 0 ]),yf=sqrt(1.0+4.0*Gd [ 1 ]*Gd [ 1 ]);float zf=sign(Gd [ 0 ])*0.5*(abs(Gd [ 0 ])*xf+0.5*log(2.0*abs(Gd [ 0 ])+xf));float Af=sign(Gd [ 1 ])*0.5*(abs(Gd [ 1 ])*yf+0.5*log(2.0*abs(Gd [ 1 ])+yf));uf=(qe-wf)/abs(Af-zf);vf=wf-zf*uf;}else{float wf=fd;float qe=gd;uf=qe-wf;vf=wf;}float oe=hd;float pe=Vd ? jd : id;vec2 Bf=(vec2(1.0,1.0)-clamp(vec2(oe,pe),0.0,1.0))*Qc/(4.0*Oc);frag_specialParam1=vec4(vec2(Cb,Db)/Qc,Eb,Fb);frag_specialParam2=vec4(vec2(Hb,Ib)/Qc,Jb,Kb);frag_specialParam3=vec4(uf,vf,Bf.x,Bf.y);if(Sc==0 || Rc > 0.0)frag_specialParam4=vec3(ae ? 0.0 : 1.0,be ? 0.0 : 1.0,ce ? 0.0 : 1.0);else frag_specialParam4=vec3(1.0,1.0,ce ? 0.0 : 1.0);frag_specialParam5=vec2(Gb,Lb);frag_type=(Vd && ! Id)? s : q;}}else if(Y==qc &&(! Id || ld)){float Cf=(Mc.y)/(Kc.x*Nc.x);if(! Vd || Id){vec2 Df=(Mc.x < 0.0)? md : od;ne=Df+vec2(Cf,0.0);frag_type=t;}else{float Ef=clamp((md.y-nd.y)/(md.y+od.y-2.0*nd.y),0.0,1.0);vec2 Ff=mix(mix(md,nd,Ef),mix(nd,od,Ef),Ef);vec2 Gf=ld ? md : Ff;vec2 Hf=ld ? Ff : od;vec2 Df=(Mc.x < 0.0)? Gf : Hf;vec2 If=(Ff-Fd)*Ed;vec2 Jf=(Df+vec2(Cf,0.0)-Fd)*Ed;vec2 Kf=((ld ? md : od)-Fd)*Ed;float Lf=Jf.x-If.x;float Mf=sign(Kf.x-If.x);float fc=Lf*Mf;float gc=sign(dot(Bd,zd));ne=Df+vec2(Cf,0.0);frag_specialParam1.x=dot(ne-md,Bd*sign(dot(Bd,xd)));frag_specialParam1.y=dot(ne-nd,Cd*sign(dot(Cd,-yd)));frag_specialParam1.z=dot(ne-od,Ad*sign(dot(Ad,-zd)));frag_specialParam1.w=dot(ne-Gf,vec2(Gf.y-Hf.y,Hf.x-Gf.x));frag_specialParam2.x=fc;frag_specialParam2.y=gc;frag_type=u;}}else{gl_Position=vec4(0.0,0.0,0.0,0.0);frag_type=o;}gl_Position=vec4(ne.x*Nc.x*2.0*Kc.x,-ne.y*Nc.y*2.0*Kc.y,0.0,1.0);frag_geoRange=Gd;frag_geoUVS.xy=(ne-Fd)*Ed;frag_geoUVS.z=Hd*0.5/Oc;if(fb==2)frag_specialParam3=vec4(Mc.x*0.5+0.5,Mc.y*0.5+0.5,rd.x+rd.y,0.0);}}",f:"precision highp float;const int c=0,d=1,e=2,f=3,h=4,i=5,j=6;const int k=0,l=1,m=2,n=3;uniform int ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform float ufrag_4;uniform float ufrag_5;uniform float ufrag_6;uniform int ufrag_7;uniform float ufrag_8;uniform float ufrag_10;uniform float ufrag_11;uniform float ufrag_12;uniform vec4 ufrag_13;uniform float ufrag_15;uniform vec2 ufrag_16;uniform int ufrag_17;uniform float ufrag_18;uniform float ufrag_19;varying float frag_type;const float o=0.0,p=1.0,q=3.0,s=4.0,t=5.0,u=6.0,v=7.0;varying vec3 frag_geoUVS;varying vec2 frag_geoRange;varying vec4 frag_specialParam1;varying vec4 frag_specialParam2;varying vec4 frag_specialParam3;varying vec3 frag_specialParam4;varying vec2 frag_specialParam5;float A(vec2 B,vec2 C){float a=0.5-B.y;float b=-0.5*B.x;float D=b*0.5;float E=(b*b)*0.25;float F=(a*a*a)/27.0;if(E+F > 0.0){float G=sqrt(E+F);float H=G-D;float I=sign(H)*pow(abs(H),1.0/3.0);float J=G+D;float K=-sign(J)*pow(abs(J),1.0/3.0);float x=I+K;return clamp(x,C [ 0 ],C [ 1 ]);}else{const float L=0.333333333;const vec3 M=vec3(0.0,2.094395102,4.188790205);float N=1.0/a;vec3 O=2.0*sqrt(-a*L)*cos(L*acos(sqrt(-6.75*N)*b*N)-M);vec3 x=clamp(O,C [ 0 ],C [ 1 ]);vec3 P=B.x-x,Q=B.y-x*x,R=P*P+Q*Q;return(R [ 0 ] < R [ 1 ] && R [ 0 ] < R [ 2 ])? x [ 0 ] :(R [ 1 ] < R [ 2 ])? x [ 1 ] : x [ 2 ];}}bool S(float T){return T-0.4 < frag_type && frag_type < T+0.4;}float U(float V,float a,float b,float W,float X){return clamp((abs(V*2.0-a-b)+a-b)*W*0.5+X,0.0,1.0);}void main(){int Y=ufrag_0;int Z=ufrag_1;float ab=ufrag_2;float bb=ufrag_3;float cb=ufrag_4;float db=ufrag_5;float eb=ufrag_6;int fb=ufrag_7;float gb=ufrag_8;float hb=ufrag_10;float ib=ufrag_11;float jb=ufrag_12;vec4 kb=ufrag_13;float lb=ufrag_15;vec2 mb=ufrag_16;bool nb=(ufrag_17==1);float ob=ufrag_18;float pb=ufrag_19;const float qb=1.0;float F=qb;float rb;float sb=0.0;float tb=0.0;if(Y==0 && ! S(v)){float V=0.0;float ub=0.0;vec2 vb;if(S(s)){float x=A(frag_geoUVS.xy,frag_geoRange);vb=frag_geoUVS.xy-vec2(x,x*x);vec2 wb=normalize(vec2(1.0,2.0*x));sb=dot(vb,vec2(-wb.y,wb.x))*frag_geoUVS.z;float xb=2.0*abs(x),yb=sqrt(1.0+xb*xb);float zb=sign(x)*(xb*yb+log(xb+yb))*0.25;float Ab=1.0-abs(sign((x-frag_geoRange [ 0 ])*(x-frag_geoRange [ 1 ])));V=zb+Ab*dot(vb,wb);ub=(x-frag_geoRange [ 0 ])/(frag_geoRange [ 1 ]-frag_geoRange [ 0 ]);}else{vb=frag_geoUVS.xy-vec2(clamp(frag_geoUVS.x,0.0,1.0),0.0);V=ub=frag_geoUVS.x;sb=frag_geoUVS.y;}F=length(vb)*abs(frag_geoUVS.z);ub=clamp(ub,0.0,1.0);const float Bb=0.01;float Cb=frag_specialParam1 [ 0 ],Db=frag_specialParam1 [ 1 ],Eb=frag_specialParam1 [ 2 ],Fb=frag_specialParam1 [ 3 ],Gb=frag_specialParam5 [ 0 ];float Hb=frag_specialParam2 [ 0 ],Ib=frag_specialParam2 [ 1 ],Jb=frag_specialParam2 [ 2 ],Kb=frag_specialParam2 [ 3 ],Lb=frag_specialParam5 [ 1 ];float Mb=frag_specialParam4.x,Nb=frag_specialParam4.y,Ob=frag_specialParam4.z;bool Pb=ub < 0.5 ?(Mb !=0.0 &&(Db > Bb || Fb > 1.0)):(Nb !=0.0 &&(Ib > Bb || Kb > 1.0));if(Z !=m){if(Pb)F=qb;else{const float Qb=0.001;if(ub < 0.5 && Cb > Bb && Mb !=0.0)F=(Db <=Qb)? Eb :(Fb >=0.0)? Gb : qb;if(ub > 0.5 && Hb > Bb && Nb !=0.0)F=(Ib <=Qb)? Jb :(Kb >=0.0)? Lb : qb;}}float Rb=F;if(Mb==0.0)Rb=max(Rb,Gb);if(Nb==0.0)Rb=max(Rb,Lb);tb=V*frag_specialParam3.x+frag_specialParam3.y;bool Sb=(mb==vec2(0.0,0.0))||(mb [ 0 ] <=tb && tb <=mb [ 1 ]);bb=Sb ? bb*Ob : 0.0;float Tb=(F <=lb && Sb)? bb : 0.0;float Ub=Pb ? 0.0 : Tb;const float Vb=0.2;const float Wb=(1.0-2.0*Vb)*2.0;float Xb=abs(fract(db+tb*cb)*2.0-1.0)*jb;float Yb=U(Xb,kb [ 0 ],kb [ 1 ],Wb,Vb)*U(Xb,kb [ 2 ],kb [ 3 ],Wb,Vb)*Tb;float Zb=clamp(0.5-F*sign(sb)*ib,0.0,1.0)*Ub;rb=sign(Rb)*max(0.0,abs(Rb)+mix(frag_specialParam3.z,frag_specialParam3.w,ub));float ac=(0.5-rb+pb)*bb;float bc=(0.5-F)*ab;vec4 cc=vec4(bc,ac,Zb,Yb);vec4 dc=vec4(ac,bc,0.0,0.0);vec4 ec=mix(cc,dc,ob);gl_FragColor=clamp(ec,0.0,1.0);}else if(S(t)){gl_FragColor=vec4(0.0,0.0,0.0,1.0);if(eb==sign(frag_geoUVS.y))discard;}else if(S(u)){gl_FragColor=vec4(0.0,0.0,0.0,0.0);if(frag_specialParam1.x > 0.0 && frag_specialParam1.y > 0.0 && frag_specialParam1.z > 0.0){float fc=frag_specialParam2.x,gc=frag_specialParam2.y;float hc=((fc >=0.0)? sign((frag_geoUVS.y-frag_geoUVS.x*frag_geoUVS.x)): 1.0)*gc;if(eb==hc)discard;}else if(eb==sign(frag_specialParam1.w))discard;}else if(S(v)){tb=frag_geoUVS.x*frag_specialParam3.x+frag_specialParam3.y;float ic=max(abs(frag_specialParam1.x),abs(frag_specialParam1.y))+frag_specialParam2.z;float jc=max(abs(frag_specialParam1.z),abs(frag_specialParam1.w))+frag_specialParam2.w;rb=min(ic,jc);if(frag_specialParam4.y >=0.0 && frag_specialParam4.z >=0.0)rb=min(rb,frag_specialParam4.x >=0.0 ? frag_specialParam2.x : frag_specialParam2.y);float kc=0.5-clamp(rb,0.0,0.5);gl_FragColor=vec4(kc*ab,kc*bb,0.0,1.0);}else gl_FragColor=vec4(frag_type*(1.0-gb),0.0,0.0,frag_type*gb);if(Y==0 && nb){float lc=smoothstep(lb,lb*1.5,rb);float mc=(tb+32.0*rb/lb)*jb;float nc=1.0-(mc+lc);gl_FragColor=vec4(nc,nc,nc,1.0);}if(fb==e){gl_FragColor.rgb=clamp(vec3(1.0-F*2.0,1.0-F*4.0,1.0-F*8.0),0.0,1.0);float oc=0.25+clamp((abs(frag_specialParam3.x+frag_specialParam3.y-1.0)+abs(frag_specialParam3.x-frag_specialParam3.y))*4.0-2.75,0.0,1.0);gl_FragColor+=vec4(oc*(1.0+sin(frag_specialParam3.z))/2.0,oc*(1.0+cos(frag_specialParam3.z))/2.0,oc*frag_specialParam3.z/18.0,1.0);}}",a:["a_v","a_p0","a_p1","a_p2","a_p3","a_p4","a_d1","a_d2"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","u_0","u_1","u_2","u_3","u_4","u_5","u_6","u_7","u_8","u_12","u_13","u_14","u_15","u_17","u_18","u_19"],s:[]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;uniform mat3 u_0;uniform mat3 u_1;uniform vec2 u_2;uniform mat3 u_3;uniform mat3 u_4;uniform mat3 u_5;uniform mat3 u_6;uniform mat3 u_7;uniform mat3 u_8;uniform mat3 u_10;uniform mat3 u_11;uniform int u_13;uniform int u_14;uniform vec2 u_15;uniform int u_16;uniform float u_17;uniform float u_18;uniform float u_19;uniform vec2 u_20;uniform vec2 u_21;attribute vec2 a_v;attribute vec2 a_0;attribute vec2 a_1;varying vec2 q,s,t,u,v,A,B,C;varying float D;mat2 pd(float qd){return mat2(cos(qd),-sin(qd),sin(qd),cos(qd));}vec2 rd(vec2 sd){return vec2(sd.x/2.0,sd.y/-2.0)+vec2(0.5,0.5);}vec2 td(vec2 sd,mat3 ud){return(ud*vec3(vec2(sd.x/2.0,sd.y/2.0),1.0)).xy*vec2(1.0,-1.0)+vec2(0.5,0.5);}mat4 vd(float wd,float xd,float yd,float zd){float a=1.0/tan(wd*0.5),b=1.0/(yd-zd);return mat4(a/xd,0.0,0.0,0.0,0.0,-a,0.0,0.0,0.0,0.0,(yd+zd)*b,-1.0,0.0,0.0,2.0*yd*zd*b,0.0);}mat4 Ad(float qd){float Bd=cos(qd),Cd=sin(qd);return mat4(1.0,0.0,0.0,0.0,0.0,Bd,-Cd,0.0,0.0,Cd,Bd,0.0,0.0,0.0,0.0,1.0);}mat4 Dd(float qd){float Bd=cos(qd),Cd=sin(qd);return mat4(Bd,0.0,Cd,0.0,0.0,1.0,0.0,0.0,-Cd,0.0,Bd,0.0,0.0,0.0,0.0,1.0);}void main(){vec2 Ed=a_v;mat3 Fd=u_0;vec2 Gd=u_15;mat3 Hd=u_1;vec2 Id=u_2;mat3 Jd=u_3;mat3 Kd=u_4;mat3 Ld=u_5;mat3 Md=u_6;mat3 Nd=u_7;mat3 Od=u_8;mat3 Pd=u_10;mat3 Qd=u_11;vec2 Rd=u_20;vec2 Sd=u_21;int Td=u_13;int Ud=u_14;float Vd=u_18;float Wd=u_19;vec2 Xd=Ed;vec2 Yd=Ed;if(u_16 !=0){Xd=Ed+a_0*2.0;Yd=Ed+a_1*2.0;Ed=mix(Xd,Yd,u_17);}vec2 Zd=(Fd*vec3(Ed.xy/2.0,1.0)).xy;vec2 ae;if(Gd !=vec2(1.0,1.0)){const float be=1.57079632679;mat4 ce=Dd((1.0-Gd.x)*be),de=Ad((1.0-Gd.y)*be);mat4 ee=mat4(mat2(Hd));ee [ 3 ] [ 0 ]=Hd [ 2 ] [ 0 ];ee [ 3 ] [ 1 ]=Hd [ 2 ] [ 1 ];vec4 fe=ee*de*ce*vec4(Zd,0.0,1.0)-vec4(Id*0.5,0.0,0.0);gl_Position=vec4((fe.xy/Id)*vec2(2.0,-2.0),0.0,1.0);const float ge=0.78539816339;float he=Id.y/(2.0*tan(ge*0.5));fe.z-=he;vec4 ie=vd(ge,Id.x/Id.y,he/2.0,he*2.0)*fe;gl_Position=ie/ie.w;}else{vec2 ae=(Hd*vec3(Zd,1.0)).xy;gl_Position=vec4((ae/Id-vec2(0.5,0.5))*vec2(2.0,-2.0),0.0,1.0);}gl_Position.z=mix(Vd,Wd,Ed.y*0.5+0.5);q=td(Xd.xy,Jd);C=td(Xd.xy,Qd);s=td((Td !=0)? gl_Position.xy : Yd.xy,Kd);u=td((Ud !=0)? gl_Position.xy : Ed.xy,Md);t=td(Ed.xy,Ld);A=td(Ed.xy,Nd);B=td(Ed.xy,Od);v=td(Ed.xy,Pd);if(Rd==Sd){D=1.0;}else{vec2 je=Sd-Rd;D=dot(Zd-Rd,je)/dot(je,je);}}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform sampler2D t_4;uniform sampler2D t_5;uniform sampler2D t_6;uniform sampler2D t_7;uniform float ufrag_0;uniform float ufrag_1;uniform float ufrag_2;uniform vec4 ufrag_3;uniform vec4 ufrag_4;uniform float ufrag_6;uniform vec3 ufrag_8;uniform vec3 ufrag_9;uniform int ufrag_10;uniform int ufrag_11;uniform vec2 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform int ufrag_15;uniform int ufrag_16;uniform vec2 ufrag_17;uniform int ufrag_18;uniform int ufrag_19;uniform float ufrag_20;uniform float ufrag_21;uniform vec4 ufrag_22;uniform vec4 ufrag_23;uniform int ufrag_24;uniform int ufrag_25;uniform vec4 ufrag_26;uniform float ufrag_27;uniform float ufrag_28;uniform float ufrag_29;uniform int ufrag_30;uniform int ufrag_31;uniform float ufrag_32;uniform int ufrag_34;uniform int ufrag_35;uniform float ufrag_36;uniform int ufrag_37;uniform int ufrag_38;uniform int ufrag_39;uniform float ufrag_40;uniform float ufrag_41;uniform mat3 ufrag_42;uniform vec3 ufrag_43;uniform vec4 ufrag_44;uniform int ufrag_45;const int c=0,d=1,e=2,f=3,h=4,i=10,j=11,k=14,l=16;const int m=0,n=1,o=2,p=3;varying vec2 q,s,t,u,v,A,B,C;varying float D;float E(float F){return clamp(F,0.0,1.0);}const vec2 G=vec2(.5,.5);const float H=1.0/255.0;vec4 I(vec4 J,vec4 K){float L=K.a+J.a*(1.0-K.a);return clamp(vec4((K.rgb*K.a+J.rgb*J.a*(1.0-K.a))/max(L,H),L),0.0,1.0);}float M(float N,vec3 O,vec3 P){float Q=clamp(N,O [ 0 ],O [ 2 ]);vec3 R=abs((Q-O)*P);return min(R [ 0 ],min(R [ 1 ],R [ 2 ]));}float S(vec2 T){vec2 U=sign(G-abs(T-G));return max(0.0,U.x+U.y)*.5;}float V(float W,float X,float Y){const float Z=-0.5;const float ab=0.16;const float bb=0.5;float cb=mix(ab,Z,E(Y*bb));float db=min(Y,X);float eb=1.0-E((W-cb)/db);return eb*eb;}vec2 fb(vec4 gb,float hb,float ib,float jb,vec3 kb,vec3 lb,float Y,float mb){bool nb=ufrag_38 !=0;float ob=max(ib,Y)*0.5;float pb=gb.r-0.5;float qb=V(-pb/hb,0.5/hb,Y);float rb=clamp(0.5-mix(gb.g,min(1.0-gb.r,gb.g),ufrag_29),0.0,0.5);float sb=(nb && mb==0.0)? rb : 0.5-gb.b;float N=rb*sign(sb)/hb;bool tb=lb [ 0 ]==lb [ 2 ];if(! tb && abs(N)< ib*0.5-Y*2.0)N=sb/hb;N+=mb;const float ub=0.2;const float vb=1.0/(1.0-ub*2.0);const float wb=0.5-0.5*vb;float xb=gb.a;float yb=xb*vb+wb;float zb=(1.0-yb)*ob;float Ab=abs(N);if(xb <(1.0-ub)&& ! nb)Ab=mix(max(zb,Ab),length(vec2(zb,Ab)),jb);const float Bb=0.49;float Cb=min(ob,Bb/hb);float Db=V(Ab-Cb,0.5/hb-Cb,Y);if(xb < ub && ! nb){Db=0.0;}if(yb >=jb && ! nb){float Eb=M(N,kb*ob,lb);float Fb=min(min(lb [ 0 ],lb [ 1 ]),lb [ 2 ]);float Gb=Y*Fb;float Hb=V(Eb-Cb,0.5/hb-Cb,Gb);Db=min(Db,Hb);}if(ufrag_37==0)return vec2(clamp(qb,0.0,1.0),clamp(Db,0.0,1.0));else return vec2(0.0,clamp(max(qb,Db),0.0,1.0));}const int Ib=0,Jb=1,Kb=2,Lb=3,Mb=4,Nb=5,Ob=6,Pb=7,Qb=8,Rb=9;vec2 Sb(int Tb,vec4 Ub,vec2 T,float hb){if(Tb==Mb)return vec2(1.0-min(min(Ub [ 0 ]*T.x,Ub [ 3 ]*T.y),min(Ub [ 2 ]*(1.0-T.x),Ub [ 1 ]*(1.0-T.y))),0.0);if(Tb==Kb){float Vb=T.x,Wb=floor(Vb),Q=Vb-Wb;Vb=(fract(Wb*0.5)==0.0)? Q : 1.0-Q;return vec2(Vb,0.0);}else return T;}vec4 Xb(int Tb,vec4 Ub,vec4 Yb,vec2 T,sampler2D Zb,int ac,vec4 gb,float hb){if(Tb==Ib)return vec4(0.0,0.0,0.0,0.0);else if(Tb==Jb)return Ub;vec4 eb=texture2D(Zb,Sb(Tb,Ub,T,hb));if(ac !=0 && Tb !=0 && Tb > 1 &&(T.x < 0.0 || T.x > 1.0 || T.y < 0.0 || T.y > 1.0))eb.a=0.0;if(Tb==Pb)return mix(Ub,Yb,eb.r);else{if(Tb==Ob && eb.a > 0.0)eb.rgb/=eb.a;return eb;}}void main(){float hb=ufrag_0;float ib=ufrag_1;float bc=ufrag_2;vec4 cc=ufrag_3;vec4 dc=ufrag_4;float jb=ufrag_6;vec3 kb=ufrag_8;vec3 lb=ufrag_9;int ec=ufrag_10;int fc=ufrag_11;vec2 gc=ufrag_12;vec4 hc=ufrag_13;int ic=ufrag_15;int jc=ufrag_16;vec2 kc=ufrag_17;int lc=ufrag_18;int mc=ufrag_19;float nc=ufrag_20;float oc=ufrag_21;vec4 pc=ufrag_22;vec4 qc=ufrag_23;int rc=ufrag_24;int sc=ufrag_25;vec4 tc=ufrag_26;float mb=ufrag_27;float uc=ufrag_28;int vc=ufrag_30;int wc=ufrag_31;float xc=ufrag_32;bool yc=ufrag_34 !=0;float zc=ufrag_36;int Ac=ufrag_39;float Bc=ufrag_40;float Cc=ufrag_41;mat3 Dc=ufrag_42;vec3 Ec=ufrag_43;vec4 Fc=ufrag_44;int Gc=ufrag_45;vec4 Hc=yc ? vec4(0.0,0.0,0.0,0.0): texture2D(t_0,q);if(ic==e || ic==h || ic==f){float Ic=S(q);float Jc=S(s);Hc*=Ic;if(ic==h){vec4 Kc=texture2D(t_1,s)*Jc;Hc*=Kc.a;}else if(zc > 0.0){vec4 Kc=texture2D(t_1,s)*Jc;Hc=mix(Hc,Kc,E(zc));}if(ic==f){vec4 Lc=texture2D(t_2,q)*Ic;vec4 Mc=texture2D(t_4,s)*Jc;vec4 Nc=mix(Lc,Mc,E(zc));vec4 Oc=vec4(0.0,0.0,0.0,0.0);if(t.x >=0.0 && t.x <=1.0 && t.y >=0.0 && t.y <=1.0){Oc=mix(texture2D(t_5,t),texture2D(t_6,t),zc);}float Pc=Nc.a > 0.0 ? Nc.r/Nc.a : 0.0;float Qc=Hc.a > 0.0 ? Hc.r/Hc.a : 0.0;float Rc=abs(Pc-Qc);Hc=mix(Hc*0.5+Nc*0.5,Oc,Rc);}gl_FragColor=Hc;if(gl_FragColor.a > 0.0){gl_FragColor.rgb/=gl_FragColor.a;}}else if(ic <=d){vec2 Sc=yc ? vec2(1.0,0.0): fb(Hc,hb,ib,jb,kb,lb,bc,mb);if(Ac !=0 && ufrag_37==0){vec4 Tc=texture2D(t_7,C)*S(C);vec2 Uc=fb(Tc,hb,ib,jb,kb,lb,bc,mb);Sc=(Ac==2)? vec2(E(Sc.x-Uc.x),E(Sc.y*(1.0-Uc.x)+Sc.x*Uc.y)):(Ac==1)? vec2(Uc.x*Sc.x,E(Uc.y*Sc.x+Sc.y*Uc.x)): Uc;}vec4 Vc=Xb(ec,cc,pc,s,t_1,lc,Hc,hb);Vc.a*=nc;vec4 Wc=vec4(Vc.rgb,0.0);if(vc !=0){vec4 Xc=Xb(Ob,vec4(0.0,0.0,0.0,0.0),vec4(0.0,0.0,0.0,0.0),t,t_6,wc,Hc,hb);Xc.a*=xc;if(Gc==1 && ec !=Ib){Vc=I(Xc,Vc);Vc.a=Xc.a;}else if(Gc==2 && ec !=Ib){Vc.a*=Xc.a;}else{Vc=I(Vc,Xc);}Wc=vec4(Xc.rgb,Xc.a*Bc*S(t));}Vc.rgb=clamp(mix(Vc.rgb,vec3(0.5)*sign(uc)+0.5,abs(uc)),0.0,1.0);if(sc !=0){float Yc=texture2D(t_5,B).a;Vc.rgb=mix(Vc.rgb,tc.rgb,(1.0-Yc)*tc.a);}vec4 Zc=mix(Wc,Vc,Sc [ 0 ]);vec4 ad=Xb(fc,dc,qc,u,t_2,mc,Hc,hb);vec4 bd=vec4(ad.rgb,ad.a*Sc [ 1 ]*oc);gl_FragColor=I(Zc,bd);}else if(ic==i){float cd=(Hc.r-0.5);float dd=E(1.0-2.0*abs(sin(cd*64.0)))*0.5;if(cd < 0.0)gl_FragColor=vec4(0.0,dd*(1.0+cd),1.0+cd,1.0+cd);else gl_FragColor=vec4(1.0-cd,dd*(1.0-cd),0.0,1.0);}else{if(ic==j)gl_FragColor=vec4(Hc.r,Hc.g*2.0,0.0,1.0);else if(ic==k)gl_FragColor=vec4(Hc.r,0.0,0.0,1.0);else if(ic==l)gl_FragColor=vec4(Hc.b,Hc.b > 0.95 ?(Hc.b-0.95)*20.0 : 0.0,Hc.a,1.0);else gl_FragColor=vec4(Hc.r,Hc.g,Hc.b,1.0);}float ed=gc [ 0 ]+(gc [ 1 ]-gc [ 0 ])*E(D);if(rc !=0)ed-=1.0-texture2D(t_4,A).a;if(jc !=0 &&(ic==0 || ic==2)){if(jc==1){ed-=1.0-kc [ 1 ];}else{vec4 fd=texture2D(t_3,v);if(jc==2){float gd=1.0-fd.r;ed-=1.0-E(gd*kc [ 0 ]+kc [ 1 ]);}else if(jc==3){float hd=1.0-kc [ 0 ];float id=kc [ 1 ]/hd;if(fd.r > 0.0){ed-=1.0-E(6.0*id);vec3 jd=clamp(vec3((1.0-fd.a)*kc [ 0 ]+kc [ 1 ]*3.0)-vec3(0.0,1.0-fd.b,2.0-fd.b)*(1.0-kc [ 0 ]),0.0,1.0);gl_FragColor.rgb=mix(mix(vec3(fd.r),vec3(fd.g),jd [ 1 ]),mix(vec3(fd.g),gl_FragColor.rgb,id),jd [ 2 ]);}else{ed-=1.0-E(2.0*id-1.0);}}}}if(Fc.a > 0.0){float kd=max(gl_FragColor.r,max(gl_FragColor.g,gl_FragColor.b));float ld=min(gl_FragColor.r,min(gl_FragColor.g,gl_FragColor.b));float md=(kd+ld)*0.5;vec3 nd=md < 0.5 ? Fc.rgb*md*2.0 : mix(Fc.rgb,vec3(1.0,1.0,1.0),md*2.0-1.0);gl_FragColor.rgb=mix(gl_FragColor.rgb,nd,Fc.a);}gl_FragColor.rgb=Dc*gl_FragColor.rgb+Ec;gl_FragColor.a=E(gl_FragColor.a)*E(ed)*Cc;if(ufrag_35==2){gl_FragColor.rgb=clamp(gl_FragColor.rgb+0.5,0.0,1.0);}else if(ufrag_35==3){gl_FragColor.rgb=clamp(gl_FragColor.rgb-0.5,0.0,1.0);}if(ic !=d && hc.a > 0.0)gl_FragColor.rgb=hc.rgb;gl_FragColor.rgb*=gl_FragColor.a;gl_FragColor.rgb=clamp(gl_FragColor.rgb,0.0,1.0);if(ic==d){if(gl_FragColor.a > 0.0)gl_FragColor=hc;else gl_FragColor=vec4(0.0,0.0,0.0,0.0);}if(ufrag_35==1 || ufrag_35==2){float od=1.0-gl_FragColor.a;gl_FragColor=vec4(od+gl_FragColor.rgb,gl_FragColor.a);}else if(gl_FragColor.a==0.0){gl_FragColor=vec4(0.0,0.0,0.0,0.0);}}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_6","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","ufrag_20","ufrag_21","ufrag_22","ufrag_23","ufrag_24","ufrag_25","ufrag_26","ufrag_27","ufrag_28","ufrag_29","ufrag_30","ufrag_31","ufrag_32","ufrag_34","ufrag_35","ufrag_36","ufrag_37","ufrag_38","ufrag_39","ufrag_40","ufrag_41","ufrag_42","ufrag_43","ufrag_44","ufrag_45","u_0","u_1","u_2","u_3","u_4","u_5","u_6","u_7","u_8","u_10","u_11","u_13","u_14","u_15","u_16","u_17","u_18","u_19","u_20","u_21"],s:["t_0","t_1","t_2","t_3","t_4","t_5","t_6","t_7"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;uniform int u_0;uniform vec2 u_1;uniform vec2 u_2;uniform mat3 u_3;attribute vec2 a_v;attribute vec4 a_p1;attribute vec4 a_p2;varying vec2 c;void main(){if(u_0==0){gl_Position=vec4(a_v,0.0,1.0);}else{vec2 s;if(a_v.x > 0.0){vec2 N=(a_v.y < 0.0)? a_p1.xy : a_p2.xy;gl_Position=vec4((((u_3*vec3(N,1.0)).xy-u_1)*u_2)*vec2(2.0,-2.0),0.0,1.0);}else gl_Position=vec4(0.0,0.0,0.0,1.0);}c=a_v*vec2(0.5,-0.5)+vec2(0.5,0.5);}",f:"precision highp float;uniform float bfrag_0 [ 11 ];uniform vec4 bfrag_1 [ 11 ];uniform int ufrag_0;uniform vec2 ufrag_2;uniform int ufrag_4;uniform vec2 ufrag_5;uniform float ufrag_6;uniform float ufrag_7;varying vec2 c;vec4 d(vec4 e,float f,float h){return vec4(pow(e.r,f),pow(e.g,f),pow(e.b,f),pow(e.a,h));}vec4 i(float j){float k=ufrag_6;float h=ufrag_7;float l=1.0/k;float m=1.0/h;for(int n=0;n < 10;n++){if(j <=bfrag_0 [ n+1 ]){vec4 o=d(bfrag_1 [ n ],k,h);vec4 p=d(bfrag_1 [ n+1 ],k,h);return d(mix(o,p,(j-bfrag_0 [ n ])/(bfrag_0 [ n+1 ]-bfrag_0 [ n ])),l,m);}}return bfrag_1 [ 10 ];}float q(vec2 s,vec2 t){vec2 u=s-t;float v=dot(u,u);float A=t.x*s.y-s.x*t.y;vec2 B=u*A;float C=sqrt(v-A*A);vec2 D=u*C;vec2 E=vec2((B.y+sign(D.y)*D.x),(-B.x+abs(D.y)))/v;vec2 F=vec2((B.y-sign(D.y)*D.x),(-B.x-abs(D.y)))/v;vec2 G=sign(length(E-t)-length(F-t))==sign(dot(t-s,t))? E : F;float j=length(s-t)/length(G-t);return clamp(j,0.0,1.0);}float H(float x){return x < 0.5 ? 2.0*x*x : 2.0*x*(2.0-x)-1.0;}float I(float x,float J){return x < J ? H(x/J): H((1.0-x)/(1.0-J));}float K(float x,float J){return x < J ? x/J :(1.0-x)/(1.0-J);}void main(){float j=c.x;if(ufrag_0==1){vec2 t=ufrag_2;j=q(c*2.0-1.0,t*2.0-1.0);}if(ufrag_4 !=0){float L=I(j,ufrag_5.x)*ufrag_5.y;float M=K(j,ufrag_5.x)*ufrag_5.y;gl_FragColor=vec4(i(L).rgb,i(M).a);}else{gl_FragColor=i(j);}}",a:["a_v","a_p1","a_p2"],u:["bfrag_0","bfrag_1","ufrag_0","ufrag_2","ufrag_4","ufrag_5","ufrag_6","ufrag_7","u_0","u_1","u_2","u_3"],s:[]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;uniform float u_0;uniform vec2 u_1;uniform vec2 u_2;uniform vec2 u_3;uniform int u_4;attribute vec2 a_v;varying vec2 c,d,e,f,h,i,j,k,l;void main(){vec2 G=a_v;float H=u_0;vec2 I=u_1;vec2 J=u_2;vec2 K=u_3;int p=u_4;gl_Position=vec4(G.x,-G.y,0.0,1.0);vec2 L=(vec2(G.x,-G.y)*I/2.0)+vec2(0.5,0.5);if(p==1){vec2 M=J*vec2(2.0*H/(K.x*8.0),2.0*H/(K.y*8.0));vec2 N=L-J*vec2(H/K.x,H/K.y);c=N;d=N+M;e=N+M*2.0;f=N+M*3.0;h=N+M*4.0;i=N+M*5.0;j=N+M*6.0;k=N+M*7.0;l=N+M*8.0;}else{vec2 r=vec2(H/K.x,H/K.y);c=L+r*vec2(-0.7,-0.7);d=L+r*vec2(0.0,-1.0);e=L+r*vec2(0.7,-0.7);f=L+r*vec2(-1.0,0.0);h=L;i=L+r*vec2(1.0,0.0);j=L+r*vec2(-0.7,0.7);k=L+r*vec2(0.0,1.0);l=L+r*vec2(0.7,0.7);}}",f:"precision highp float;uniform sampler2D tex_0;uniform vec4 ufrag_0;uniform float ufrag_2;uniform int ufrag_3;uniform int ufrag_4;varying vec2 c,d,e,f,h,i,j,k,l;void main(){vec4 m=ufrag_0;int n=ufrag_3;float o=ufrag_2;int p=ufrag_4;vec4 q=p==1 ? vec4(1.20,1.15,1.10,1.05)*o : vec4(1.20,1.20,1.20,1.20)*o;vec4 s=texture2D(tex_0,c,q [ 0 ]);vec4 t=texture2D(tex_0,d,q [ 1 ]);vec4 u=texture2D(tex_0,e,q [ 2 ]);vec4 v=texture2D(tex_0,f,q [ 3 ]);vec4 A=texture2D(tex_0,h,o);vec4 B=texture2D(tex_0,i,q [ 3 ]);vec4 C=texture2D(tex_0,j,q [ 2 ]);vec4 D=texture2D(tex_0,k,q [ 1 ]);vec4 E=texture2D(tex_0,l,q [ 0 ]);if(n==0){vec4 F=s*0.000229+t*0.005977+u*0.060598+v*0.241732+A*0.382928+B*0.241732+C*0.060598+D*0.005977+E*0.000229;gl_FragColor=clamp(F,0.0,1.0);}else if(n==1){float F=s.a*0.000229+t.a*0.005977+u.a*0.060598+v.a*0.241732+A.a*0.382928+B.a*0.241732+C.a*0.060598+D.a*0.005977+E.a*0.000229;gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}else if(n==2){float F=min(min(min(min(s.a,t.a),min(u.a,v.a)),min(min(A.a,B.a),min(C.a,D.a))),E.a);gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}else if(n==3){float F=max(max(max(max(s.a,t.a),max(u.a,v.a)),max(max(A.a,B.a),max(C.a,D.a))),E.a);gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}}",a:["a_v"],u:["ufrag_0","ufrag_2","ufrag_3","ufrag_4","u_0","u_1","u_2","u_3","u_4"],s:["tex_0"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;varying vec2 c;void main(){vec2 v=a_v;gl_Position=vec4(v.x,-v.y,0.0,1.0);c=(vec2(v.x,v.y)/2.0)+vec2(0.5,0.5);}",f:"precision highp float;varying vec2 c;const int d=1,e=2,f=3,h=4,i=5,j=6,k=7,l=8,m=9,n=10,o=11,p=12;uniform int ufrag_0;uniform float ufrag_1;void main(){const float PI=3.141592653;const float q=0.707106781;int s=ufrag_0;float t=ufrag_1;float u=0.0,x=c.x,y=c.y;if(s==d)u=1.0-x*t;else if(s==e)u=max(abs(x*2.0-1.0),abs(y*2.0-1.0));else if(s==f)u=1.0-(x*t+floor(y*t)/2.0);else if(s==h)u=length(c*2.0-vec2(1.0,1.0))*q;else if(s==i)u=(abs(x*2.0-1.0)+abs(y*2.0-1.0))*0.5;else if(s==j)u=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);else if(s==k)u=min(abs(x*2.0-1.0),abs(y*2.0-1.0));else if(s==l)u=fract(sin(x*12.9898)*43758.5453);else if(s==m)u=abs(x*2.0-1.0);else if(s==n)u=1.0-(ceil(x*t)+ceil(y*t))/(2.0*t);else if(s==o)u=1.0-atan(abs(x-0.5),0.5-y)/PI;else if(s==p)u=1.0-atan(x-0.5,0.5-y)*t/(2.0*PI);gl_FragColor=vec4(mod(u,1.0),0.0,0.0,1.0);}",a:["a_v"],u:["ufrag_0","ufrag_1"],s:[]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;const int i=0,j=1,k=2,l=3;void main(){vec2 m=a_v;vec4 n=a_0,o=a_1;vec2 p=m*0.5+0.5;c=vec2(n [ i ]+(n [ k ]-n [ i ])*p.x,1.0-(n [ j ]+(n [ l ]-n [ j ])*p.y));gl_Position=vec4((o [ i ]+(o [ k ]-o [ i ])*p.x)*2.0-1.0,1.0-((o [ j ]+(o [ l ]-o [ j ])*p.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform float ufrag_0;varying vec2 c;float d(float e){return clamp(e,0.0,1.0);}void main(){float f=ufrag_0;vec4 h=texture2D(t_0,c);h.rgb=(h.rgb-0.5)*f+0.5;gl_FragColor=h;}",a:["a_v","a_0","a_1"],u:["ufrag_0"],s:["t_0"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;uniform mat3 u_1;const int Wb=0,Xb=1,Yb=2,Zb=3;void main(){vec2 ac=a_v;vec4 bc=a_0,cc=a_1;vec2 dc=ac*0.5+0.5;c=vec2(bc [ Wb ]+(bc [ Yb ]-bc [ Wb ])*dc.x,1.0-(bc [ Xb ]+(bc [ Zb ]-bc [ Xb ])*dc.y));c=(u_1*vec3(c.x,c.y,1.0)).xy;gl_Position=vec4((cc [ Wb ]+(cc [ Yb ]-cc [ Wb ])*dc.x)*2.0-1.0,1.0-((cc [ Xb ]+(cc [ Zb ]-cc [ Xb ])*dc.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform sampler2D t_4;uniform float ufrag_0;uniform int ufrag_1;varying vec2 c;uniform int ufrag_3;uniform vec2 ufrag_4;uniform vec4 ufrag_5;uniform int ufrag_6;uniform float ufrag_7;uniform float ufrag_8;uniform float ufrag_9;uniform int ufrag_10;uniform float ufrag_11;uniform float ufrag_12;uniform vec3 ufrag_13;uniform vec3 ufrag_14;uniform int ufrag_15;uniform float ufrag_16;uniform float ufrag_17;uniform float ufrag_18;uniform vec4 ufrag_19;uniform vec2 ufrag_22;uniform vec4 ufrag_23;uniform int ufrag_24;uniform int ufrag_25;uniform vec4 ufrag_26;uniform vec4 ufrag_27;uniform vec4 ufrag_28;uniform int ufrag_29;uniform vec4 ufrag_30;uniform int ufrag_31;const int d=0;const int e=1;const int f=2;const int h=3;const int i=1;const int j=2;const int k=3;const int l=4;float m(float n){return clamp(n,0.0,1.0);}vec3 o(vec3 rgb){float p=max(rgb.r,max(rgb.g,rgb.b));float q=min(rgb.r,min(rgb.g,rgb.b));float s=(p+q)*0.5;if(p==q)return vec3(0.0,0.0,s);float t=(p-q)*2.0;float u=p+q;float v=0.5*t/((s <=0.5)? u : 2.0-u);float A=(rgb.r==p)?((rgb.g-rgb.b)/t)/3.0 :(rgb.g==p)?(1.0+(rgb.b-rgb.r)/t)/3.0 :(2.0+(rgb.r-rgb.g)/t)/3.0;return vec3(fract(A),v,s);}float B(float C,float D,float E){float F=fract(E);return(F*6.0 < 1.0)? C+(D-C)*F*6.0 :(F*2.0 < 1.0)? D :(F*3.0 < 2.0)? C+(D-C)*(4.0-F*6.0): C;}vec3 G(vec3 H){float D=(H.z <=0.5)? H.z+H.z*H.y : H.z+H.y-H.z*H.y;float C=2.0*H.z-D;return vec3(B(C,D,H.x+1.0/3.0),B(C,D,H.x),B(C,D,H.x-1.0/3.0));}const vec3 I=vec3(2.2,2.2,2.2);const vec3 J=vec3(1.0/2.2,1.0/2.2,1.0/2.2);const vec2 K=vec2(.5,.5);vec4 L(vec4 M,vec3 N){return vec4(pow(M.rgb,N),M.a);}vec3 O(vec3 rgb,vec4 u){return clamp(u [ 0 ]*rgb*rgb*rgb+u [ 1 ]*rgb*rgb+u [ 2 ]*rgb+u [ 3 ],0.0,1.0);}vec2 P(float Q,vec3 R,float S,vec2 T){float U=floor(Q/S);float V=Q-U*S;return vec2(V,U)*R.rg+T;}vec3 W(vec3 M,vec3 R,float S){vec2 X=R.rg*vec2(S,ceil(R.b/S));vec3 Y=clamp(M,0.0,1.0)*(R-vec3(1.0));vec2 T=Y.rg+vec2(0.5);float Z=floor(Y.b);float ab=min(Z+1.0,R.b-1.0);vec3 a=texture2D(t_2,P(Z,R,S,T)/X).rgb;vec3 b=texture2D(t_2,P(ab,R,S,T)/X).rgb;return mix(a,b,Y.b-Z);}const int bb=8;const int cb=16;const float db=float(cb)*sqrt(3.0);vec3 eb(int fb){return texture2D(t_3,vec2(float(fb)/255.0,0.0)).rgb;}vec4 gb(vec3 hb,int ib [ bb ]){float jb=db;int kb=0;vec3 lb=vec3(0.0);for(int fb=0;fb < bb;fb++){int mb=ib [ fb ];vec3 M=eb(mb);float nb=length(M-hb);if(nb < jb){kb=mb;lb=M;jb=nb;}}return vec4(lb,float(kb));}int ob(vec3 pb,int ib [ bb ]){vec3 hb=pb;int kb=0;float qb=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);int rb=int(qb*float(cb-1));for(int sb=0;sb < cb;sb++){vec4 tb=gb(hb,ib);vec3 lb=tb.rgb;kb=int(tb.a);if(sb==rb){return kb;}hb=((hb+(hb-lb))+pb)*0.5;}return kb;}int ub(vec3 pb){int ib [ bb ];float vb [ bb ];for(int mb=0;mb < bb;mb++){ib [ mb ]=mb;vb [ mb ]=length(eb(mb)-pb);}for(int mb=bb;mb < 256;mb++){int wb=0;float xb=0.0;for(int yb=0;yb < bb;yb++){float zb=vb [ yb ];if(zb > xb){wb=yb;xb=zb;}}vec3 M=eb(mb);float nb=length(M-pb);if(nb < xb){for(int yb=0;yb < bb;yb++){if(yb==wb){ib [ yb ]=mb;vb [ yb ]=nb;}}}}return ob(pb,ib);}vec3 Ab(vec3 pb){vec4 Bb=ufrag_26;vec4 Cb=ufrag_27;vec4 Db=ufrag_28;float Eb=m(dot(pb,vec3(0.2126,0.7152,0.0722)));vec4 Fb=Bb+Cb*m(Eb*3.0-1.5)-Db*m(Eb*-3.0+1.5);return mix(vec3(Eb),pb*Fb.rgb,Fb.a);}vec4 Gb(vec4 pb){if(ufrag_3+ufrag_6+ufrag_10+ufrag_15+ufrag_25==0 &&(ufrag_23.x <=1.0)){return pb;}vec4 Hb=vec4(pb);Hb.rgb=Hb.a==0.0 ? vec3(0.0,0.0,0.0): Hb.rgb/Hb.a;if(ufrag_15==1){Hb.r*=ufrag_16;Hb.b*=ufrag_17;Hb.g*=ufrag_18;}if(ufrag_6==1){vec3 H=o(Hb.rgb);H=vec3(fract(H.x+ufrag_7),H.yz*vec2(ufrag_8,ufrag_9));Hb.rgb=clamp(G(H),0.0,1.0);}if(ufrag_3==1){Hb.rgb=ufrag_4 [ 0 ]*Hb.rgb+ufrag_4 [ 1 ];if(ufrag_5 [ 0 ] < 0.0){Hb.rgb=clamp(Hb.rgb,0.0,1.0);}Hb.rgb=O(Hb.rgb,ufrag_5);}if(ufrag_25==1){Hb.rgb=Ab(Hb.rgb);}if(ufrag_10==1){const vec3 Ib=vec3(0.2125,0.7154,0.0721);float Jb=clamp(dot(Hb.rgb,Ib)*ufrag_11+ufrag_12,0.0,1.0);Hb.rgb=mix(ufrag_13,ufrag_14,Jb);}if(ufrag_23.x > 1.0){Hb.rgb=W(Hb.rgb,ufrag_23.xyz,ufrag_23.w);}Hb.rgb*=Hb.a;return Hb;}void main(){float Kb=ufrag_0;int Lb=ufrag_1;vec4 Mb=ufrag_19;int Nb=ufrag_29;vec4 Ob=ufrag_30;vec4 Pb=texture2D(t_0,c);vec4 Qb=Pb;Qb.rgb=(Qb.rgb-0.5)*Kb+0.5;Qb.rgb=(Lb==f)? vec3(Qb.b,Qb.g,Qb.r): Qb.rgb;if(Lb==h){vec4 Rb=texture2D(t_1,c);vec3 Sb=vec3(Qb.r,Rb.r,Rb.a)*255.0-vec3(16.0,128.0,128.0);vec3 rgb=Sb*mat3(1.164383,0.0,1.596027,1.164383,-0.391762,-0.812968,1.164383,2.017232,0.0);Qb.rgb=clamp(rgb/255.0,0.0,1.0);}else if(Lb==e){Qb=Gb(Qb);}if(Nb !=0){float Tb=dot(texture2D(t_4,c),Ob);if(Nb==i){Qb*=Tb;}else if(Nb==j){Qb*=1.0-Tb;}else if(Nb==k){Qb=mix(Pb,Qb,Tb);}else if(Nb==l){Qb=mix(Qb,Pb,Tb);}}if(Mb.a !=0.0){float Ub=Mb.a*Qb.a;Qb=vec4(Mb.rgb*Ub,Ub);}if(ufrag_24==1){int Vb=ub(Qb.rgb);Qb=vec4(eb(Vb),1.0);}if(ufrag_31==1 && Qb.a > 0.0){Qb.rgb/=Qb.a;}gl_FragColor=Qb;}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","ufrag_22","ufrag_23","ufrag_24","ufrag_25","ufrag_26","ufrag_27","ufrag_28","ufrag_29","ufrag_30","ufrag_31","u_1"],s:["t_0","t_1","t_2","t_3","t_4"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;uniform mat3 u_0;uniform mat3 u_1;uniform mat3 u_2;uniform mat3 u_3;uniform vec2 u_4;attribute vec2 a_v;varying vec2 c;varying vec2 d;vec2 Kb(vec2 Lb,mat3 Mb){return(Mb*vec3(vec2(Lb.x/2.0,Lb.y/2.0),1.0)).xy*vec2(1.0,-1.0)+vec2(0.5,0.5);}void main(){vec2 Nb=a_v;mat3 Ob=u_0;mat3 Pb=u_1;mat3 Qb=u_2;mat3 Rb=u_3;vec2 Sb=u_4;c=Kb(Nb.xy,Qb);d=Kb(Nb.xy,Rb);vec2 Tb=(Ob*vec3(Nb.xy/2.0,1.0)).xy;vec2 Ub=(Pb*vec3(Tb,1.0)).xy;gl_Position=vec4((Ub/Sb-vec2(0.5,0.5))*vec2(2.0,-2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;varying vec2 c;varying vec2 d;uniform int ufrag_0;uniform vec2 ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform vec2 ufrag_4;uniform vec4 ufrag_5;uniform vec4 ufrag_6 [ 4 ];uniform vec3 ufrag_7 [ 4 ];uniform vec4 ufrag_8 [ 4 ];uniform vec4 ufrag_9;uniform vec4 ufrag_10;uniform vec4 ufrag_11;uniform vec4 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform float ufrag_15;uniform vec4 ufrag_16;uniform float ufrag_17;const int e=0;const int f=1;const int h=2;float i(vec2 j,float k,float l){vec2 m=ufrag_1;float n=ufrag_2;float o=ufrag_3;vec2 p=ufrag_4;float q=texture2D(t_1,j+m*vec2(k,l)).r;float s=clamp((q*n+o)/p.x,0.0,1.0);return texture2D(t_2,vec2(s,1.0)).r*p.y;}vec3 t(vec2 j){float u=i(j,-1.0,-1.0);float v=i(j,0.0,-1.0);float A=i(j,1.0,-1.0);float B=i(j,-1.0,0.0);float C=i(j,0.0,0.0);float D=i(j,1.0,0.0);float E=i(j,-1.0,1.0);float F=i(j,0.0,1.0);float G=i(j,1.0,1.0);vec3 H=normalize(vec3(1.0,0.0,v-u));vec3 I=normalize(vec3(1.0,0.0,A-v));vec3 J=normalize(vec3(1.0,0.0,C-B));vec3 K=normalize(vec3(1.0,0.0,D-C));vec3 L=normalize(vec3(1.0,0.0,F-E));vec3 M=normalize(vec3(1.0,0.0,G-F));vec3 N=normalize(vec3(0.0,1.0,B-u));vec3 O=normalize(vec3(0.0,1.0,C-v));vec3 P=normalize(vec3(0.0,1.0,D-A));vec3 Q=normalize(vec3(0.0,1.0,E-B));vec3 R=normalize(vec3(0.0,1.0,F-C));vec3 S=normalize(vec3(0.0,1.0,G-D));return normalize(cross(H,N)+cross(H,O)+cross(I,O)+cross(I,P)+cross(J,N)+cross(J,O)+cross(K,O)+cross(K,P)+cross(J,Q)+cross(J,R)+cross(K,R)+cross(K,S)+cross(L,Q)+cross(L,R)+cross(M,R)+cross(M,S));}vec4 T(vec4 U,vec4 V){float W=V.a+U.a*(1.0-V.a);return vec4((V.rgb*V.a+U.rgb*U.a*(1.0-V.a))/W,W);}void main(){int X=ufrag_0;vec4 Y=texture2D(t_0,c);if(X !=0){vec4 Z=vec4(Y.rgb/Y.a,Y.a);int ab=ufrag_14;if(ab==f){Z=vec4(0.0,0.0,0.0,0.0);}else{vec3 bb=t(d);vec4 cb=ufrag_5;vec4 db=ufrag_9;vec4 eb=ufrag_10;vec4 fb=ufrag_11;vec4 gb=ufrag_12;vec4 hb=ufrag_13;vec3 ib=gb.rgb+cb.rgb*fb.rgb;vec3 jb=vec3(0.0,0.0,-1.0);float kb=hb.x;bool lb=hb.y !=0.0;;vec3 mb=vec3(0.0,0.0,0.0);vec3 nb=vec3(0.0,0.0,0.0);for(int ob=0;ob < 4;ob++){vec3 pb=ufrag_6 [ ob ].rgb;vec3 qb=ufrag_7 [ ob ];float rb=ufrag_8 [ ob ].x;float sb=ufrag_8 [ ob ].y;float tb=ufrag_8 [ ob ].z;float ub=ufrag_8 [ ob ].w;float vb=-dot(bb,qb);vb=vb*rb+sb;mb+=clamp(vb,0.0,1.0)*tb*pb;float wb=0.0;if(lb){vec3 xb=-normalize(jb+qb);wb=dot(xb,bb);}else{vec3 yb=jb-2.0*bb*dot(bb,jb);wb=-dot(yb,qb);}wb=pow(max(0.0,wb),kb);nb+=clamp(wb,0.0,1.0)*ub*pb;}mb*=db.rgb;nb*=eb.rgb;float zb=Z.a*db.a;float Ab=hb.z;float Bb=hb.w;float Cb=1.0-abs(dot(jb,bb));if(Bb > 0.0){zb+=(1.0-zb)*pow(Cb,Bb);}else if(Bb < 0.0){zb-=zb*pow(Cb,-Bb);}if(Ab > 0.0){mb+=(vec3(1.0,1.0,1.0)-mb)*pow(Cb,Ab);}else if(Ab < 0.0){mb-=mb*pow(Cb,-Ab);}if(ab==h){const float Db=0.5;mb+=nb*Db;nb*=(1.0-Db);}Z.rgb=clamp(Z.rgb*(ib+mb)+nb,0.0,1.0);Z.a=clamp(zb,0.0,1.0);}float Eb=ufrag_15;if(Eb > 0.0){float n=ufrag_2;float o=ufrag_3;vec4 Fb=ufrag_16;float Gb=ufrag_17;float Hb=max(Eb,Gb)*0.5;float Ib=abs(texture2D(t_1,d).r*n+o);float Jb=clamp(Hb-Ib,0.0,1.0);Z=T(Z,Fb*vec4(1.0,1.0,1.0,Jb));}Y=vec4(Z.rgb*Z.a,Z.a);}gl_FragColor=Y;}",a:["a_v"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","u_0","u_1","u_2","u_3","u_4"],s:["t_0","t_1","t_2"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;uniform mat3 u_1;const int rb=0,sb=1,tb=2,ub=3;void main(){vec2 vb=a_v;vec4 wb=a_0,xb=a_1;vec2 yb=vb*0.5+0.5;c=vec2(wb [ rb ]+(wb [ tb ]-wb [ rb ])*yb.x,1.0-(wb [ sb ]+(wb [ ub ]-wb [ sb ])*yb.y));c=(u_1*vec3(c.x,c.y,1.0)).xy;gl_Position=vec4((xb [ rb ]+(xb [ tb ]-xb [ rb ])*yb.x)*2.0-1.0,1.0-((xb [ sb ]+(xb [ ub ]-xb [ sb ])*yb.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform float ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform vec2 ufrag_3;uniform int ufrag_4;uniform int ufrag_5;uniform vec2 ufrag_22;varying vec2 c;const float PI=3.141592653;float d(float e){return clamp(e,0.0,1.0);}vec3 f(vec3 rgb){float h=max(rgb.r,max(rgb.g,rgb.b));float i=min(rgb.r,min(rgb.g,rgb.b));float j=(h+i)*0.5;if(h==i)return vec3(0.0,0.0,j);float k=(h-i)*2.0;float l=h+i;float m=0.5*k/((j <=0.5)? l : 2.0-l);float n=(rgb.r==h)?((rgb.g-rgb.b)/k)/3.0 :(rgb.g==h)?(1.0+(rgb.b-rgb.r)/k)/3.0 :(2.0+(rgb.r-rgb.g)/k)/3.0;return vec3(fract(n),m,j);}float o(float x){return fract(sin(x*12.9898)*43758.5453);}float p(vec2 q){float s=ufrag_2;const float t=1.0;const float u=0.7;vec2 v=vec2(q.x,(1.0-q.y-(1.0-cos(q.x*PI/4.0))*t)*(1.0+t*0.5));float A=(v.x+v.y)*0.5;float B=d(((v.x-v.y)*0.5)/(1.0-abs(A-0.5)*2.0)*u+0.5);float C=floor(A*s);return d(1.0-1.0*(fract(C/2.0)==0.0 ?(C+B)/s :(C+1.0-B)/s));}float D(vec2 q,bool E){float s=ufrag_2;float F=p(q);float G=1.0-floor(q.x*s)/s;return mix(E ? o(G): G,F,E ? 0.3 : 0.1);}float H(vec2 q,vec2 I){float J=ufrag_2;float K=1.0-atan(q.x-I.x,q.y-I.y);float L=1.0+J*(sin(K*3.0)*0.1+sin(K*7.0)*0.05+sin(K*11.0)*0.03);return max(0.0,1.0-length(q-I)*L);}float M(vec2 q,vec2 I){bool N=ufrag_5 !=0;float O=N ? ufrag_22.y/ufrag_22.x : ufrag_22.x/ufrag_22.y;float s=ufrag_2;vec2 e=q-I;e*=O > 1.0 ? vec2(O,1.0): vec2(1.0,1.0/O);float P=length(e)*sqrt(2.0);if(P < 0.01/s){return 1.0;}float K=0.5+atan(e.y,e.x)/(2.0*PI);return(floor((1.0-P)*s-K)+K)/s;}void main(){const int Q=2;const float R=float((Q*2+1)*(Q*2+1));const float S=1.0;const float T=3.0;const float U=1.0;const float V=1.0;const vec3 W=vec3(0.0,0.0,-1.0);const float s=15.0;const vec2 X=vec2(1.0,1.0);bool N=ufrag_5 !=0;bool Y=c.x < 0.0 || c.y < 0.0 || c.x > 1.0 || c.y > 1.0;vec4 Z=texture2D(t_0,c);float ab=0.0;float bb=0.0;float cb=0.0;for(int db=-Q;db <=Q;db++){for(int eb=-Q;eb <=Q;eb++){vec2 fb=c+vec2(float(eb),float(db))*S/ufrag_22;vec4 gb=texture2D(t_0,fb);ab+=abs(Z.r-gb.r)+abs(Z.g-gb.g)+abs(Z.b-gb.b);vec2 hb=ufrag_3.xy;vec2 ib=N ? vec2(1.0-fb.y,1.0-fb.x): fb;ib=vec2(hb.x > 0.0 ? ib.x : 1.0-ib.x,hb.y > 0.0 ? ib.y : 1.0-ib.y);float jb=0.5;if(ufrag_1==1){jb=p(ib);}else if(ufrag_1==2){jb=H(ib,vec2(0.0,0.0));}else if(ufrag_1==3){jb=H(ib,vec2(0.5,0.5));}else if(ufrag_1==4){jb=D(ib,false);}else if(ufrag_1==5){jb=D(ib,true);}else if(ufrag_1==6){jb=M(ib,vec2(0.5,0.5));}bb+=jb;if(ufrag_4==0){cb+=0.5;}else{vec3 kb=f(Z.rgb);if(ufrag_4==1){cb+=1.0-smoothstep(0.4,0.6,kb [ 2 ]);}if(ufrag_4==2){cb+=smoothstep(0.4,0.6,kb [ 2 ]);}}}}ab=U*T*ab/R;bb=V*bb/R;cb=cb/R;vec3 lb=f(Z.rgb);vec3 mb=vec3(W.x < 0.0 ? 1.0 : 0.0,W.y < 0.0 ? 1.0 : 0.0,W.z < 0.0 ? 1.0 : 0.0)+f(Z.rgb)*W;float L=d((ab+bb+mb.x+mb.y+mb.z)/(U+V+abs(W.x)+abs(W.y)+abs(W.z)));float nb=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);float ob=1.0-nb*0.2;float pb=d(min(d((ab-0.5)*1.5+0.5)*nb,0.5));float qb=d(min((ab-0.75)*4.0+0.5,0.5));if(Y){gl_FragColor=vec4(0.0,ob,0.0,bb);}else{gl_FragColor=vec4(ob,ob-pb-qb,cb,bb);}}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_22","u_1"],s:["t_0"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 d;const int T=0,U=1,V=2,W=3;void main(){vec2 X=a_v;vec4 Y=a_0,Z=a_1;vec2 ab=X*0.5+0.5;d=vec2(Y [ T ]+(Y [ V ]-Y [ T ])*ab.x,1.0-(Y [ U ]+(Y [ W ]-Y [ U ])*ab.y));gl_Position=vec4((Z [ T ]+(Z [ V ]-Z [ T ])*ab.x)*2.0-1.0,1.0-((Z [ U ]+(Z [ W ]-Z [ U ])*ab.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform float ufrag_0;uniform float ufrag_1;uniform float ufrag_2;uniform int ufrag_3;uniform bool ufrag_4;uniform int ufrag_5;uniform vec4 ufrag_6;uniform float ufrag_7;uniform bool ufrag_8;uniform float ufrag_9;const int c=22;varying vec2 d;const int e=1;const int f=2;const int h=3;const int i=4;const float j=0.0001;float k(float l){return clamp(l,0.0,1.0);}float m(vec2 n){int o=ufrag_5;vec4 p=ufrag_6;float q=1.0;if(o > 2){float s=dot(texture2D(t_2,n),p);if(o==i){s=1.0-s;}float t=ufrag_7;float u=ufrag_9;if(ufrag_8){if(s < t){q=t-s;}else if(s > u){q=s-u;}else{q=0.0;}}else{q=max(0.0,s-t);}}return q*q;}void main(){int o=ufrag_5;vec2 v=ufrag_3==0 ? vec2(1.0/512.0,0.0): vec2(0.0,1.0/512.0);v*=ufrag_1;if(ufrag_2 > 1.0 && ufrag_3==0){v/=ufrag_2;}else if(ufrag_2 < 1.0 && ufrag_3==1){v*=ufrag_2;}float A=1.0/ufrag_0;float B=A*A;float C=-0.5*B;float D=0.39894*A;float E=m(d);float F=D*max(E,j);vec4 G=texture2D(t_0,d);vec4 H=G;if(F > 0.0){vec4 I=F*G;float J=0.0;J+=F;for(int K=1;K < c;K++){float L=float(K);float M=D*exp(L*L*C);vec2 N=L*v*E;vec2 O=d-N;vec2 P=d+N;float Q=M*m(O);float R=M*m(P);I+=Q*texture2D(t_0,O)+R*texture2D(t_0,P);J+=Q+R;}H=I/J;}if(ufrag_4){vec4 S=texture2D(t_1,d);vec4 s=S-H;H=S+s*ufrag_0*9.0;H=clamp(H,0.0,1.0);}gl_FragColor=H;}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9"],s:["t_0","t_1","t_2"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;uniform float u_0;uniform vec2 u_1;varying vec2 c;varying vec2 d;varying vec2 e;varying vec2 f;const float u_uvScale=0.2400;const float u_offsetSpeedRatio=0.3000;const float u_jellyfishDispScaleR=0.3600;const float u_jellyfishDispacement=3.4000;const float Pc=0.4235;const float Qc=0.3176;const vec2 Rc=vec2(Pc,Qc);const float Sc=0.15;const float Tc=0.02;vec2 k(vec2 l,vec2 m){float n=m.x/m.y;vec2 o=(m.x > m.y)? vec2(m.x/m.y,1.0): vec2(1.0,m.y/m.x);return(l-vec2(0.5,0.5))*o+vec2(0.5,0.5);}void main(){c=a_v*0.5+0.5;gl_Position=vec4(a_v*vec2(1.0,-1.0),0.0,1.0);vec2 H=k(c,u_1);vec2 Uc=Rc+H*u_uvScale;float K=u_0*u_offsetSpeedRatio;vec2 Vc=vec2(sin(K),cos(K))*Sc;d=Uc+Vc;e=Uc-Vc;vec2 Wc=Rc+H*u_jellyfishDispScaleR;float Xc=u_0*u_jellyfishDispacement;vec2 Yc=vec2(sin(Xc),cos(Xc))*Tc;f=Wc+Yc;}",f:"precision highp float;varying vec2 c;varying vec2 d;varying vec2 e;varying vec2 f;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform vec2 ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform vec2 ufrag_4;uniform float ufrag_5;uniform float ufrag_6;uniform float ufrag_7;uniform vec2 ufrag_8;uniform float ufrag_9;uniform vec4 ufrag_10;uniform vec4 ufrag_11;uniform vec4 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform float ufrag_15;uniform float ufrag_16;uniform int ufrag_17;uniform int ufrag_18;const float h=2.718281828459;const float PI=3.14;const float i=2.2;const float j=1.0/i;const float u_motionRange=1.3;const float u_colorSize=0.45;const float u_speedRatio=1.35;const vec3 u_Color=vec3(0.6800,0.1166,1);const vec3 u_Color1=vec3(0.0220,0.4647,1);const vec3 u_Color3=vec3(0,0.1905,0.6661);const vec3 u_Color2=vec3(0.9914,0.3993,0.1768);const float u_roseOffset=3.2;const float u_pinkOffset=4.7;const float u_greenOffset=1.6;const float u_iridescenceRepeat=1.2000;const float u_iridescenceOpacity=0.2300;const float u_jellyfishScale=2.;const float u_jellyfishOpacity=0.7800;const float u_jellyfishDisplacementSize=2.8000;vec2 k(vec2 l,vec2 m){float n=m.x/m.y;vec2 o=(m.x > m.y)? vec2(m.x/m.y,1.0): vec2(1.0,m.y/m.x);return(l-vec2(0.5,0.5))*o+vec2(0.5,0.5);}float p(float q){return-(cos(q*3.1415)-1.0)/2.0;}float s(vec2 t,float u){vec2 xy=t+vec2(sin(u),cos(u))*u_motionRange;float v=p(clamp(length(xy*u_colorSize),0.0,1.0));return v;}vec3 A(vec3 B){return pow(B,vec3(i));}vec3 C(vec3 B){return pow(B,vec3(j));}float D(vec2 E,vec2 b,float r){vec2 F=abs(E)-b;return length(max(F,0.0))+min(max(F.x,F.y),0.0)-r;}vec4 G(){vec2 m=ufrag_0;vec2 H=k(c,m);H.y=1.0-H.y;float I=ufrag_2;vec2 J=ufrag_8;float K=I*u_speedRatio;vec2 t=H*2.0-1.0;float L=s(t,K);float M=(1.-L)*0.5+0.5;vec3 N=u_Color1*M;float O=K+u_roseOffset;float P=s(t,O);vec3 Q=mix(u_Color,N,P);float R=K+u_pinkOffset;float S=s(t,R);float T=(1.-S)*0.5+0.5;vec3 U=u_Color3*T;float V=K+u_greenOffset;float W=s(t,V);vec3 X=mix(u_Color2,U,W);vec3 Y=mix(Q,X,L*P);vec4 Z=texture2D(t_0,d);float ab=Z.g;vec4 bb=texture2D(t_0,e);float cb=bb.r;float db=bb.b;float eb=bb.a;float fb=ab*(1.-(1.-db)*0.6);float gb=fb*(1.-((1.-eb)*0.5));float hb=-0.03+gb*1.73;float ib=clamp(hb,0.0,1.0);vec2 jb=vec2(ib*u_iridescenceRepeat,0.5);vec3 kb=texture2D(t_1,jb).rgb;kb=A(kb);vec4 lb=texture2D(t_1,f);float mb=(cb*lb.r)*u_jellyfishDisplacementSize;vec2 nb=(J-m*0.5)/min(m.x,m.y);vec2 ob=H+vec2(-1.0,1.0)*nb;vec2 pb=-u_jellyfishScale+ob*2.*u_jellyfishScale;float qb=length(pb)*2.0-1.0;float rb=clamp(mb+(1.-qb),0.0,1.0);float sb=(1.-ib)*u_iridescenceOpacity;float tb=ufrag_9*rb*u_jellyfishOpacity;float ub=mix(sb,tb,tb);vec3 vb=C(mix(Y,kb,ub));return vec4(vb,1.0);}float wb(float q){return clamp(q,0.0,1.0);}vec4 xb(vec4 B,vec3 yb){return vec4(pow(B.rgb,yb),B.a);}float zb(float Ab,float Bb){return sin(Ab*3.0+Bb)+0.9*sin(Ab*5.0-Bb*7.0)+0.5*sin(Ab*7.0+Bb*3.0)+0.2*sin(Ab*9.0+Bb*5.0);}vec4 Cb(vec2 Db,vec2 m){vec4 Eb=ufrag_10;vec4 N=ufrag_11;vec4 Q=ufrag_12;vec4 U=ufrag_13;vec2 Fb=Db/m;return mix(mix(Eb,N,Fb.x),mix(Q,U,Fb.x),Fb.y);}float Gb(vec2 Db,vec2 Hb,float Ib,float Jb){vec2 Kb=(Db-Hb)/Ib;return smoothstep(1.0,0.0,length(Kb));}float Lb(vec2 Db,vec2 m,float Mb,float Nb){float Ob=sqrt(Nb);vec2 Hb=mix(-m,2.0*m,Ob);const float Pb=3.0/8.0;float Jb=1.0-wb((Ob-Pb)/(1.0-Pb));return Gb(Db,Hb,Mb,Jb);}float Qb(vec2 Db,vec2 Hb,float Rb,float Sb,float Tb,float Ub,bool Vb){vec2 Kb=Db-Hb;float Ab=atan(Kb.x,Kb.y);float Wb=zb(Ab,Ub)*Rb*Tb;float Xb=(length(Kb)-Rb+Wb)/Sb;float Yb=Vb ? wb(Xb): abs(Xb);return smoothstep(1.0,0.0,Yb);}float Zb(vec2 Db,vec2 m,float Mb,float Nb,float Tb,float Ub){float Ob=sqrt(Nb);vec2 Hb=mix(-m*0.5,m*0.5,Ob);float Rb=mix(Mb*0.25,Mb,Ob);return Qb(Db,Hb,Rb,Mb*0.1,Tb,Ub,false)*(1.0-Ob)*0.5;}vec2 ac(vec2 Db,vec2 Hb,float bc){float cc=cos(bc);float dc=sin(bc);return(Db-Hb)*mat2(cc,-dc,dc,cc)+Hb;}vec4 ec(vec4 a,vec4 b){vec4 fc=vec4(1.0)-a;vec4 gc=vec4(1.0)-b;return vec4(a.r < 0.5 ? 2.0*a.r*b.r : 1.0-2.0*fc.r*gc.r,a.g < 0.5 ? 2.0*a.g*b.g : 1.0-2.0*fc.g*gc.g,a.b < 0.5 ? 2.0*a.b*b.b : 1.0-2.0*fc.b*gc.b,1.0);}vec4 hc(vec2 Db,vec2 m,vec4 ic,float jc,float kc,float lc,vec2 mc){float Mb=length(m);vec4 nc=Cb(Db,m);float oc=Lb(Db,m,Mb,jc);float pc=Zb(Db,m,Mb,jc,0.02,jc*3.0);vec4 qc=nc*oc*0.7+pc*0.5;float rc=sqrt(lc);float sc=Mb*0.25;float tc=lc > 0.0 ? Qb(Db,mc,rc*sc,Mb*0.06,0.05,lc,false)*(1.0-lc): 0.0;vec4 uc=vec4(0.25)*tc;vec4 vc=ic*kc;vc=qc+vc*(1.0-qc.a);vc=uc+vc*(1.0-uc.a);return clamp(vc,0.0,1.0);}vec4 wc(vec2 Db,vec2 m,vec4 ic,float jc,float I,float xc,float yc,vec2 zc){float Mb=length(m);vec4 nc=Cb(ac(Db,m*0.5,-I),m);float oc=Lb(Db,m,Mb,jc);float Ac=Mb*0.2;float Bc=Mb*0.5+Ac*2.0;float Cc=Qb(Db,m*0.5,yc*Bc-Ac,Ac,yc*0.05,I,true);vec4 vc=ic*wb(xc-Cc);if(ufrag_14==1){vec4 Dc=texture2D(t_2,Db/m);vc=mix(vc,Dc,oc);}else{vc=mix(vc,ic,oc);}float Ec=ufrag_15;if(ufrag_17==1){vec2 Fc=Db/m;if(ufrag_18==1){Fc.y=1.0-Fc.y;}vec4 Gc=texture2D(t_3,Fc);float Hc=Qb(Db,m*0.5,Ec*Bc-Ac,Ac,Ec*0.05,I,true);vc=mix(vc,Gc,1.0-Hc);}float Ic=ufrag_16;if(Ec > 0.0){float Jc=Ac*0.2+Ac*0.4*Ec;float Kc=Qb(Db,m*0.5,Ec*Bc-Jc,Jc,Ec*0.05,I,false);vec4 Dc=texture2D(t_2,Db/m);vc=mix(vc,Dc,Kc*sqrt(Ec)*Ic);}return vc;}vec4 Lc(vec2 Db,vec2 m,float Jb){float Mb=length(m);vec4 nc=Cb(Db,m);return nc*Jb;}void main(){vec2 m=ufrag_0;int Mc=ufrag_1;float I=ufrag_2;float Nc=ufrag_3;vec2 mc=ufrag_4;float Oc=ufrag_5;float xc=ufrag_6;float yc=ufrag_7;vec2 J=ufrag_8;vec2 Db=c*m;if(Mc==2){gl_FragColor=Lc(Db,m,xc);}else{vec4 ic=G();if(Mc==0){gl_FragColor=hc(Db,m,ic,Nc,xc,Oc,mc);}else if(Mc==1){gl_FragColor=wc(Db,m,ic,Nc,I,xc,yc,J);}}}",a:["a_v"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","u_motionRange","u_colorSize","u_speedRatio","u_Color","u_Color1","u_Color3","u_Color2","u_roseOffset","u_pinkOffset","u_greenOffset","u_iridescenceRepeat","u_iridescenceOpacity","u_jellyfishScale","u_jellyfishOpacity","u_jellyfishDisplacementSize","u_0","u_1","u_uvScale","u_offsetSpeedRatio","u_jellyfishDispScaleR","u_jellyfishDispacement"],s:["t_0","t_1","t_2","t_3"]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={v:"precision highp float;attribute vec2 a_v;varying vec2 c;void main(){vec2 C=a_v;gl_Position=vec4(C.x,-C.y,0.0,1.0);c=(vec2(C.x,-C.y)*0.5)+vec2(0.5,0.5);}",f:"precision highp float;uniform sampler2D t_0;varying vec2 c;uniform vec2 ufrag_0;uniform vec4 ufrag_1;const int d=2;const int e=d*2+1;const int f=e*e;const int h=f*f;void main(){vec2 i=ufrag_0;vec4 j=ufrag_1;vec4 k [ f ];vec2 l=i/(float(e)*0.5);for(int m=0;m < f;m++){int y=m/e;int x=m-y*e;vec2 n=vec2(float(x-d),float(y-d));k [ m ]=texture2D(t_0,clamp(c+l*n,0.0,1.0));}float o=float(f);vec4 p=k [ 0 ];float q;float s;vec4 t;for(int u=0;u < h;u++){int v=u/f;int A=u-v*f;if(A==0){q=0.0;t=k [ u/f ];s=dot(t,j);}float B=dot(k [ u-(u/f)*f ],j);q+=sign(B-s);if(A==f-1){q=abs(q);if(q < o){o=q;p=t;}}}gl_FragColor=p;}",a:["a_v"],u:["ufrag_0","ufrag_1"],s:["t_0"]}},function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return o}));var n=i(38),r=null;function a(t){void 0===t&&(t=!0);var i=!1===t?null:r;return i||(typeof globalThis!==n.l&&(i=globalThis),i||typeof self===n.l||(i=self),i||typeof window===n.l||(i=window),i||typeof e===n.l||(i=e),r=i),i}function s(e){throw new TypeError(e)}function o(e){var t=n.c;if(t)return t(e);if(null==e)return{};var i=typeof e;function r(){}return i!==n.j&&i!==n.h&&s("Object prototype may only be an Object:"+e),r[n.k]=e,new r}}).call(this,i(94))},,,,,,,,,,function(e,t,i){"use strict";i.d(t,"a",(function(){return ri}));var n=i(9),r=i(3),a=i(7),s=i(57),o=i(58);const l=(e,t=!1)=>t;var d,c=i(136),h=i(35),u=i(119),m={stylesheetKey:"__global__",inShadow:!1,window:void 0,__isShadowConfig__:!0},f=function(e){return!(!e||!function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}(e))&&!0===e.__isShadowConfig__};function p(){return void 0===d&&(d="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),d}function g(){return{rtl:p(),shadowConfig:m}}d=p();var _,S=i(29),v="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),y={};try{y=window||{}}catch(ae){}var T,b=function(){function e(e,t){var i,n,r,a,s,o;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=Object(S.a)({injectionMode:"undefined"==typeof document?0:1,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(i=null==t?void 0:t.classNameToArgs)&&void 0!==i?i:this._classNameToArgs,this._counter=null!==(n=null==t?void 0:t.counter)&&void 0!==n?n:this._counter,this._keyToClassName=null!==(a=null!==(r=this._config.classNameCache)&&void 0!==r?r:null==t?void 0:t.keyToClassName)&&void 0!==a?a:this._keyToClassName,this._preservedRules=null!==(s=null==t?void 0:t.preservedRules)&&void 0!==s?s:this._preservedRules,this._rules=null!==(o=null==t?void 0:t.rules)&&void 0!==o?o:this._rules}return e.getInstance=function(t){if(_=y.__stylesheet__,y.__shadow_dom_stylesheet__)return y.__shadow_dom_stylesheet__.getInstance(t);if(!_||_._lastStyleElement&&_._lastStyleElement.ownerDocument!==document){var i=(null==y?void 0:y.FabricConfig)||{},n=new e(i.mergeStyles,i.serializedStylesheet);_=n,y.__stylesheet__=n}return _},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=Object(S.a)(Object(S.a)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter((function(t){return t!==e}))}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter((function(t){return t!==e}))}},e.prototype.getClassName=function(e){var t=this._config.namespace,i=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(i,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,i,n){this._keyToClassName[this._getCacheKey(t)]=e,this._classNameToArgs[e]={args:i,rules:n}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[this._getCacheKey(e)]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t,i){void 0===i&&(i="__global__");var n=this._config.injectionMode,r=0!==n?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),r)switch(n){case 1:this._insertRuleIntoSheet(r.sheet,e);break;case 2:r.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach((function(t){return t({key:i,sheet:r?r.sheet:void 0,rule:e})}))},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach((function(e){return e()}))},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._createStyleElement=function(){var e,t=(null===(e=this._config.window)||void 0===e?void 0:e.document)||document,i=t.head,n=t.createElement("style"),r=null;n.setAttribute("data-merge-styles","true");var a=this._config.cspSettings;if(a&&a.nonce&&n.setAttribute("nonce",a.nonce),this._lastStyleElement)r=this._lastStyleElement.nextElementSibling;else{var s=this._findPlaceholderStyleTag();r=s?s.nextElementSibling:i.childNodes[0]}return i.insertBefore(n,i.contains(r)?r:null),this._lastStyleElement=n,n},e.prototype._insertRuleIntoSheet=function(e,t){if(!e)return!1;try{return e.insertRule(t,e.cssRules.length),!0}catch(e){}return!1},e.prototype._getCacheKey=function(e){return e},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||(this._styleElement=this._createStyleElement(),v||(this._config.window||window).requestAnimationFrame((function(){e._styleElement=void 0}))),this._styleElement},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}(),w={},C={"user-select":1};function I(e,t){var i=function(){var e;if(!T){var t="undefined"!=typeof document?document:void 0,i="undefined"!=typeof navigator?navigator:void 0,n=null===(e=null==i?void 0:i.userAgent)||void 0===e?void 0:e.toLowerCase();T=t?{isWebkit:!(!t||!("WebkitAppearance"in t.documentElement.style)),isMoz:!!(n&&n.indexOf("firefox")>-1),isOpera:!!(n&&n.indexOf("opera")>-1),isMs:!(!i||!/rv:11.0/i.test(i.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return T}(),n=e[t];if(C[n]){var r=e[t+1];C[n]&&(i.isWebkit&&e.push("-webkit-"+n,r),i.isMoz&&e.push("-moz-"+n,r),i.isMs&&e.push("-ms-"+n,r),i.isOpera&&e.push("-o-"+n,r))}}var P,E=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function x(e,t){var i=e[t],n=e[t+1];if("number"==typeof n){var r=E.indexOf(i)>-1,a=i.indexOf("--")>-1,s=r||a?"":"px";e[t+1]="".concat(n).concat(s)}}var k="left",M="right",A=((P={})[k]=M,P[M]=k,P),R={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function O(e,t,i){if(e.rtl){var n=t[i];if(!n)return;var r=t[i+1];if("string"==typeof r&&r.indexOf("@noflip")>=0)t[i+1]=r.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(n.indexOf(k)>=0)t[i]=n.replace(k,M);else if(n.indexOf(M)>=0)t[i]=n.replace(M,k);else if(String(r).indexOf(k)>=0)t[i+1]=r.replace(k,M);else if(String(r).indexOf(M)>=0)t[i+1]=r.replace(M,k);else if(A[n])t[i]=A[n];else if(R[r])t[i+1]=R[r];else switch(n){case"margin":case"padding":t[i+1]=function(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(r);break;case"box-shadow":t[i+1]=function(e,t){var i=e.split(" "),n=parseInt(i[0],10);return i[0]=i[0].replace(String(n),String(-1*n)),i.join(" ")}(r)}}}function F(e){var t=e&&e["&"];return t?t.displayName:void 0}var D,L,B,N,V,W=/\:global\((.+?)\)/g;function U(e,t){return e.indexOf(":global(")>=0?e.replace(W,"$1"):0===e.indexOf(":host(")?e:0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function z(e,t,i,n,r){void 0===t&&(t={__order:[]}),0===i.indexOf("@")?H([n],t,i=i+"{"+e,r):i.indexOf(",")>-1?function(e){if(!W.test(e))return e;for(var t=[],i=/\:global\((.+?)\)/g,n=null;n=i.exec(e);)n[1].indexOf(",")>-1&&t.push([n.index,n.index+n[0].length,n[1].split(",").map((function(e){return":global(".concat(e.trim(),")")})).join(", ")]);return t.reverse().reduce((function(e,t){var i=t[0],n=t[1],r=t[2];return e.slice(0,i)+r+e.slice(n)}),e)}(i).split(",").map((function(e){return e.trim()})).forEach((function(i){return H([n],t,U(i,e),r)})):H([n],t,U(i,e),r)}function H(e,t,i,n){void 0===t&&(t={__order:[]}),void 0===i&&(i="&");var r,a=t[i];a||(a={},t[i]=a,t.__order.push(i));for(var s=0,o=e;s<o.length;s++){var l=o[s];if("string"==typeof l){var d=n.argsFromClassName(l);d&&H(d,t,i,n)}else if(Array.isArray(l))H(l,t,i,n);else for(var c in l)if(l.hasOwnProperty(c)){var h=l[c];if("selectors"===c){var u=l.selectors;for(var m in u)u.hasOwnProperty(m)&&z(i,t,m,u[m],n)}else"object"==typeof h||(r=c).indexOf(":global(")>=0||0===r.indexOf(":")?null!=h&&z(i,t,c,h,n):void 0!==h&&("margin"===c||"padding"===c?G(a,c,h):a[c]=h)}}return t}function G(e,t,i){var n="string"==typeof i?function(e){for(var t=[],i=0,n=0,r=0;r<e.length;r++)switch(e[r]){case"(":n++;break;case")":n&&n--;break;case"\t":case" ":n||(r>i&&t.push(e.substring(i,r)),i=r+1)}return i<e.length&&t.push(e.substring(i)),t}(i):[i];0===n.length&&n.push(i),"!important"===n[n.length-1]&&(n=n.slice(0,-1).map((function(e){return e+" !important"}))),e[t+"Top"]=n[0],e[t+"Right"]=n[1]||n[0],e[t+"Bottom"]=n[2]||n[0],e[t+"Left"]=n[3]||n[1]||n[0]}function j(e,t){for(var i=[e.rtl?"rtl":"ltr"],n=!1,r=0,a=t.__order;r<a.length;r++){var s=a[r];i.push(s);var o=t[s];for(var l in o)o.hasOwnProperty(l)&&void 0!==o[l]&&(n=!0,i.push(l,o[l]))}return n?i.join(""):void 0}function $(e,t){return t<=0?"":1===t?e:e+$(e,t-1)}function q(e,t){if(!t)return"";var i,n,r,a=[];for(var s in t)t.hasOwnProperty(s)&&"displayName"!==s&&void 0!==t[s]&&a.push(s,t[s]);for(var o=0;o<a.length;o+=2)r=void 0,"-"!==(r=(i=a)[n=o]).charAt(0)&&(i[n]=w[r]=w[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase()),x(a,o),O(e,a,o),I(a,o);for(o=1;o<a.length;o+=4)a.splice(o,1,":",a[o],";");return a.join("")}function Z(e){for(var t,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var r=null!==(t=e.stylesheet)&&void 0!==t?t:b.getInstance(e.shadowConfig),a=H(i,void 0,void 0,r),s=j(e,a);if(s){var o={className:r.classNameFromKey(s),key:s,args:i};if(!o.className){o.className=r.getClassName(F(a));for(var l=[],d=0,c=a.__order;d<c.length;d++){var h=c[d];l.push(h,q(e,a[h]))}o.rulesToInsert=l}return o}}function J(e,t,i,n){void 0===t&&(t=1);var r=null!=n?n:b.getInstance(i),a=e.className,s=e.key,o=e.args,l=e.rulesToInsert;if(l){for(var d=0;d<l.length;d+=2){var c=l[d+1];if(c){var h=l[d];h=h.replace(/&/g,$(".".concat(e.className),t));var u="".concat(h,"{").concat(c,"}").concat(0===h.indexOf("@")?"}":"");r.insertRule(u)}}r.cacheClassName(a,s,o,l)}}!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(D||(D={})),function(e){e.Arabic="'".concat(D.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(D.Cyrillic,"'"),e.EastEuropean="'".concat(D.EastEuropean,"'"),e.Greek="'".concat(D.Greek,"'"),e.Hebrew="'".concat(D.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(D.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(D.Vietnamese,"'"),e.WestEuropean="'".concat(D.WestEuropean,"'"),e.Armenian="'".concat(D.Armenian,"'"),e.Georgian="'".concat(D.Georgian,"'")}(L||(L={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(B||(B={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(N||(N={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(V||(V={}));var X="'Segoe UI', '".concat(D.WestEuropean,"'"),Y={ar:L.Arabic,bg:L.Cyrillic,cs:L.EastEuropean,el:L.Greek,et:L.EastEuropean,he:L.Hebrew,hi:L.Hindi,hr:L.EastEuropean,hu:L.EastEuropean,ja:L.Japanese,kk:L.EastEuropean,ko:L.Korean,lt:L.EastEuropean,lv:L.EastEuropean,pl:L.EastEuropean,ru:L.Cyrillic,sk:L.EastEuropean,"sr-latn":L.EastEuropean,th:L.Thai,tr:L.EastEuropean,uk:L.Cyrillic,vi:L.Vietnamese,"zh-hans":L.ChineseSimplified,"zh-hant":L.ChineseTraditional,hy:L.Armenian,ka:L.Georgian};function K(e,t,i){return{fontFamily:i,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}function Q(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}var ee,te=void 0;try{te=window}catch(e){}function ie(e){if(Q()&&void 0!==te){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:te}}var ne,re,ae,se,oe,le=(ne=function(e){for(var t in Y)if(Y.hasOwnProperty(t)&&e&&0===t.indexOf(e))return Y[t];return X}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===ee){var t=function(e){if(Q()&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}(),i="localStorage"===e?function(e){var t=null;try{var i=ie();t=i?i.localStorage.getItem("language"):null}catch(e){}return t}():"sessionStorage"===e?function(e){var t=null;try{var i=ie();t=i?i.sessionStorage.getItem("language"):null}catch(e){}return t}():void 0;i&&(ee=i),void 0===ee&&t&&(ee=t.documentElement.getAttribute("lang")),void 0===ee&&(ee="en")}return ee}()),re="".concat(ne,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:K(B.mini,N.regular,re),xSmall:K(B.xSmall,N.regular,re),small:K(B.small,N.regular,re),smallPlus:K(B.smallPlus,N.regular,re),medium:K(B.medium,N.regular,re),mediumPlus:K(B.mediumPlus,N.regular,re),large:K(B.large,N.regular,re),xLarge:K(B.xLarge,N.semibold,re),xLargePlus:K(B.xLargePlus,N.semibold,re),xxLarge:K(B.xxLarge,N.semibold,re),xxLargePlus:K(B.xxLargePlus,N.semibold,re),superLarge:K(B.superLarge,N.semibold,re),mega:K(B.mega,N.semibold,re)});function de(e,t,i,n){!function(e){var t=b.getInstance(),i=q(g(),e);if(!t.classNameFromKey(i)){var n=t.getClassName();t.insertRule("@font-face{".concat(i,"}"),!0),t.cacheClassName(n,i,[],["font-face",i])}}({fontFamily:e="'".concat(e,"'"),src:(void 0!==n?"local('".concat(n,"'),"):"")+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:i,fontStyle:"normal",fontDisplay:"swap"})}function ce(e,t,i,n,r){void 0===n&&(n="segoeui");var a="".concat(e,"/").concat(i,"/").concat(n);de(t,a+"-light",N.light,r&&r+" Light"),de(t,a+"-semilight",N.semilight,r&&r+" SemiLight"),de(t,a+"-regular",N.regular,r),de(t,a+"-semibold",N.semibold,r&&r+" SemiBold"),de(t,a+"-bold",N.bold,r&&r+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");ce(t,D.Thai,"leelawadeeui-thai","leelawadeeui"),ce(t,D.Arabic,"segoeui-arabic"),ce(t,D.Cyrillic,"segoeui-cyrillic"),ce(t,D.EastEuropean,"segoeui-easteuropean"),ce(t,D.Greek,"segoeui-greek"),ce(t,D.Hebrew,"segoeui-hebrew"),ce(t,D.Vietnamese,"segoeui-vietnamese"),ce(t,D.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),ce(t,L.Selawik,"selawik","selawik"),ce(t,D.Armenian,"segoeui-armenian"),ce(t,D.Georgian,"segoeui-georgian"),de("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),N.light),de("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),N.semibold)}}((oe=null===(ae=ie())||void 0===ae?void 0:ae.FabricConfig,null!==(se=null==oe?void 0:oe.fontBaseUrl)&&void 0!==se?se:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"));var he=0,ue=function(){function e(){}return e.getValue=function(e,t){var i=me();return void 0===i[e]&&(i[e]="function"==typeof t?t():t),i[e]},e.setValue=function(e,t){var i=me(),n=i.__callbacks__,r=i[e];if(t!==r){i[e]=t;var a={oldValue:r,value:t,key:e};for(var s in n)n.hasOwnProperty(s)&&n[s](a)}return t},e.addChangeListener=function(e){var t=e.__id__,i=fe();t||(t=e.__id__=String(he++)),i[t]=e},e.removeChangeListener=function(e){delete fe()[e.__id__]},e}();function me(){var e,t=ie()||{};return t.__globalSettings__||(t.__globalSettings__=((e={}).__callbacks__={},e)),t.__globalSettings__}function fe(){return me().__callbacks__}var pe,ge={settings:{},scopedSettings:{},inCustomizerContext:!1},_e=ue.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),Se=[],ve=function(){function e(){}return e.reset=function(){_e.settings={},_e.scopedSettings={}},e.applySettings=function(t){_e.settings=Object(S.a)(Object(S.a)({},_e.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,i){_e.scopedSettings[t]=Object(S.a)(Object(S.a)({},_e.scopedSettings[t]),i),e._raiseChange()},e.getSettings=function(e,t,i){void 0===i&&(i=ge);for(var n={},r=t&&i.scopedSettings[t]||{},a=t&&_e.scopedSettings[t]||{},s=0,o=e;s<o.length;s++){var l=o[s];n[l]=r[l]||i.settings[l]||a[l]||_e.settings[l]}return n},e.applyBatchedUpdates=function(t,i){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,i||e._raiseChange()},e.observe=function(e){Se.push(e)},e.unobserve=function(e){Se=Se.filter((function(t){return t!==e}))},e._raiseChange=function(){e._suppressUpdates||Se.forEach((function(e){return e()}))},e}(),ye=i(190),Te={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(pe||(pe={}));var be={elevation4:pe.depth4,elevation8:pe.depth8,elevation16:pe.depth16,elevation64:pe.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"};function we(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var n=0,r=t;n<r.length;n++){var a=r[n];Ce(e||{},a)}return e}function Ce(e,t,i){for(var n in void 0===i&&(i=[]),i.push(t),t)if(t.hasOwnProperty(n)&&"__proto__"!==n&&"constructor"!==n&&"prototype"!==n){var r=t[n];if("object"!=typeof r||null===r||Array.isArray(r))e[n]=r;else{var a=i.indexOf(r)>-1;e[n]=a?r:Ce(e[n]||{},r,i)}}return i.pop(),e}function Ie(e,t,i,n,r){return void 0===r&&(r=!1),function(e,t){var i="";return!0===t&&(i=" /* @deprecated */"),e.listTextColor=e.listText+i,e.menuItemBackgroundChecked+=i,e.warningHighlight+=i,e.warningText=e.messageText+i,e.successText+=i,e}(Pe(e,t,Object(S.a)({primaryButtonBorder:"transparent",errorText:n?"#F1707B":"#a4262c",messageText:n?"#F3F2F1":"#323130",messageLink:n?"#6CB8F6":"#005A9E",messageLinkHovered:n?"#82C7FF":"#004578",infoIcon:n?"#C8C6C4":"#605e5c",errorIcon:n?"#F1707B":"#A80000",blockingIcon:n?"#442726":"#FDE7E9",warningIcon:n?"#C8C6C4":"#797775",severeWarningIcon:n?"#FCE100":"#D83B01",successIcon:n?"#92C353":"#107C10",infoBackground:n?"#323130":"#f3f2f1",errorBackground:n?"#442726":"#FDE7E9",blockingBackground:n?"#442726":"#FDE7E9",warningBackground:n?"#433519":"#FFF4CE",severeWarningBackground:n?"#4F2A0F":"#FED9CC",successBackground:n?"#393D1B":"#DFF6DD",warningHighlight:n?"#fff100":"#ffb900",successText:n?"#92c353":"#107C10"},i),n),r)}function Pe(e,t,i,n,r){void 0===r&&(r=!1);var a={},s=e||{},o=s.white,l=s.black,d=s.themePrimary,c=s.themeDark,h=s.themeDarker,u=s.themeDarkAlt,m=s.themeLighter,f=s.neutralLight,p=s.neutralLighter,g=s.neutralDark,_=s.neutralQuaternary,v=s.neutralQuaternaryAlt,y=s.neutralPrimary,T=s.neutralSecondary,b=s.neutralSecondaryAlt,w=s.neutralTertiary,C=s.neutralTertiaryAlt,I=s.neutralLighterAlt,P=s.accent;return o&&(a.bodyBackground=o,a.bodyFrameBackground=o,a.accentButtonText=o,a.buttonBackground=o,a.primaryButtonText=o,a.primaryButtonTextHovered=o,a.primaryButtonTextPressed=o,a.inputBackground=o,a.inputForegroundChecked=o,a.listBackground=o,a.menuBackground=o,a.cardStandoutBackground=o),l&&(a.bodyTextChecked=l,a.buttonTextCheckedHovered=l),d&&(a.link=d,a.primaryButtonBackground=d,a.inputBackgroundChecked=d,a.inputIcon=d,a.inputFocusBorderAlt=d,a.menuIcon=d,a.menuHeader=d,a.accentButtonBackground=d),c&&(a.primaryButtonBackgroundPressed=c,a.inputBackgroundCheckedHovered=c,a.inputIconHovered=c),h&&(a.linkHovered=h),u&&(a.primaryButtonBackgroundHovered=u),m&&(a.inputPlaceholderBackgroundChecked=m),f&&(a.bodyBackgroundChecked=f,a.bodyFrameDivider=f,a.bodyDivider=f,a.variantBorder=f,a.buttonBackgroundCheckedHovered=f,a.buttonBackgroundPressed=f,a.listItemBackgroundChecked=f,a.listHeaderBackgroundPressed=f,a.menuItemBackgroundPressed=f,a.menuItemBackgroundChecked=f),p&&(a.bodyBackgroundHovered=p,a.buttonBackgroundHovered=p,a.buttonBackgroundDisabled=p,a.buttonBorderDisabled=p,a.primaryButtonBackgroundDisabled=p,a.disabledBackground=p,a.listItemBackgroundHovered=p,a.listHeaderBackgroundHovered=p,a.menuItemBackgroundHovered=p),_&&(a.primaryButtonTextDisabled=_,a.disabledSubtext=_),v&&(a.listItemBackgroundCheckedHovered=v),w&&(a.disabledBodyText=w,a.variantBorderHovered=(null==i?void 0:i.variantBorderHovered)||w,a.buttonTextDisabled=w,a.inputIconDisabled=w,a.disabledText=w),y&&(a.bodyText=y,a.actionLink=y,a.buttonText=y,a.inputBorderHovered=y,a.inputText=y,a.listText=y,a.menuItemText=y),I&&(a.bodyStandoutBackground=I,a.defaultStateBackground=I),g&&(a.actionLinkHovered=g,a.buttonTextHovered=g,a.buttonTextChecked=g,a.buttonTextPressed=g,a.inputTextHovered=g,a.menuItemTextHovered=g),T&&(a.bodySubtext=T,a.focusBorder=T,a.inputBorder=T,a.smallInputBorder=T,a.inputPlaceholderText=T),b&&(a.buttonBorder=b),C&&(a.disabledBodySubtext=C,a.disabledBorder=C,a.buttonBackgroundChecked=C,a.menuDivider=C),P&&(a.accentButtonBackground=P),(null==t?void 0:t.elevation4)&&(a.cardShadow=t.elevation4),!n&&(null==t?void 0:t.elevation8)?a.cardShadowHovered=t.elevation8:a.variantBorderHovered&&(a.cardShadowHovered="0 0 1px "+a.variantBorderHovered),Object(S.a)(Object(S.a)({},a),i)}var Ee={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"};function xe(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var i=!!e.isInverted;return function(e,t){var i,n,r;void 0===t&&(t={});var a=we({},e,t,{semanticColors:Pe(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(i=t.palette)||void 0===i?void 0:i.themePrimary)&&!(null===(n=t.palette)||void 0===n?void 0:n.accent)&&(a.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var s=0,o=Object.keys(a.fonts);s<o.length;s++){var l=o[s];a.fonts[l]=we(a.fonts[l],t.defaultFontStyle,null===(r=null==t?void 0:t.fonts)||void 0===r?void 0:r[l])}return a}({palette:Te,effects:be,fonts:le,spacing:Ee,isInverted:i,disableGlobalClassNames:!1,semanticColors:Ie(Te,be,void 0,i,t),rtl:void 0},e)}var ke=xe({}),Me=[];function Ae(){var e,t,i,n=ie();(null===(t=null==n?void 0:n.FabricConfig)||void 0===t?void 0:t.legacyTheme)?Oe(n.FabricConfig.legacyTheme):ve.getSettings(["theme"]).theme||((null===(i=null==n?void 0:n.FabricConfig)||void 0===i?void 0:i.theme)&&(ke=xe(n.FabricConfig.theme)),ve.applySettings(((e={}).theme=ke,e)))}function Re(e){return void 0===e&&(e=!1),!0===e&&(ke=xe({},e)),ke}function Oe(e,t){var i;return void 0===t&&(t=!1),ke=xe(e,t),Object(ye.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)({},ke.palette),ke.semanticColors),ke.effects),function(e){for(var t={},i=0,n=Object.keys(e.fonts);i<n.length;i++)for(var r=n[i],a=e.fonts[r],s=0,o=Object.keys(a);s<o.length;s++){var l=o[s],d=r+l.charAt(0).toUpperCase()+l.slice(1),c=a[l];"fontSize"===l&&"number"==typeof c&&(c+="px"),t[d]=c}return t}(ke))),ve.applySettings(((i={}).theme=ke,i)),Me.forEach((function(e){try{e(ke)}catch(e){}})),ke}function Fe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles&&!f(e[0]))return e[0];for(var i={},n={},r=0,a=e;r<a.length;r++){var s=a[r];if(s&&!f(s))for(var o in s)if(s.hasOwnProperty(o)){if("subComponentStyles"===o&&void 0!==s.subComponentStyles){var l=s.subComponentStyles;for(var d in l)l.hasOwnProperty(d)&&(n.hasOwnProperty(d)?n[d].push(l[d]):n[d]=[l[d]]);continue}var c=i[o],h=s[o];i[o]=void 0===c?h:Object(S.d)(Object(S.d)([],Array.isArray(c)?c:[c],!0),Array.isArray(h)?h:[h],!0)}}if(Object.keys(n).length>0){i.subComponentStyles={};var u=i.subComponentStyles,m=function(e){if(n.hasOwnProperty(e)){var t=n[e];u[e]=function(e){return Fe.apply(void 0,t.map((function(t){return"function"==typeof t?t(e):t})))}}};for(var d in n)m(d)}return i}function De(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=[],r=[],a=e;function s(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];if(o&&!f(o))if("string"==typeof o)if(o.indexOf(" ")>=0)s(o.split(" "));else{var l=a.argsFromClassName(o);l?s(l):-1===n.indexOf(o)&&n.push(o)}else Array.isArray(o)?s(o):"object"==typeof o&&r.push(o)}}return s(t),{classes:n,objects:r}}function Le(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Be(e,g())}function Be(e,t){var i,n={subComponentStyles:{}},r=void 0;f(e[0])?(r=e[0],i=e[1]):i=e[0],null!=r||(r=null==t?void 0:t.shadowConfig);var a=Object(S.a)(Object(S.a)({},t),{shadowConfig:r});if(!i&&e.length<=1)return{subComponentStyles:{}};var s=b.getInstance(r);a.stylesheet=s;var o=Fe.apply(void 0,e),l=[];for(var d in o)if(o.hasOwnProperty(d)){if("subComponentStyles"===d){n.subComponentStyles=o.subComponentStyles||{};continue}if("__shadowConfig__"===d)continue;var c=De(s,o[d]),h=c.classes,u=c.objects;(null==u?void 0:u.length)?(g=Z(a||{},{displayName:d},u))&&(l.push(g),n[d]=h.concat([g.className]).join(" ")):n[d]=h.join(" ")}for(var m=0,p=l;m<p.length;m++){var g;(g=p[m])&&J(g,null==t?void 0:t.specificityMultiplier,r)}return n}Ae();var Ne=i(191);Object(Ne.a)("@fluentui/style-utilities","8.11.6"),Ae();var Ve=!1,We=0,Ue={empty:!0},ze={},He="undefined"==typeof WeakMap?null:WeakMap;function Ge(){We++}function je(e){return e?"object"==typeof e||"function"==typeof e?e:(ze[e]||(ze[e]={val:e}),ze[e]):Ue}function $e(){return{map:He?new He:null}}const qe=function(e,t,i){if(void 0===t&&(t=100),void 0===i&&(i=!1),!He)return e;if(!Ve){var n=b.getInstance();n&&n.onReset&&b.getInstance().onReset(Ge),Ve=!0}var r,a=0,s=We;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var l=r;(void 0===r||s!==We||t>0&&a>t)&&(r=$e(),a=0,s=We),l=r;for(var d=0;d<n.length;d++){var c=je(n[d]);l.map.has(c)||l.map.set(c,$e()),l=l.map.get(c)}return l.hasOwnProperty("value")||(l.value=e.apply(void 0,n),a++),!i||null!==l.value&&void 0!==l.value||(l.value=e.apply(void 0,n)),l.value}}(()=>Le({hidden:{display:"none"},visible:{display:"inherit",position:"absolute",top:0,bottom:0,left:0,right:0,height:"100%",width:"100%",border:"none",margin:0,padding:0,opacity:.55,zIndex:Number.MAX_SAFE_INTEGER,pointerEvents:"none"}}));var Ze=h.createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}});var Je=h.createContext(void 0),Xe=function(){var e,t,i,n,r,a,s=h.useContext(Je),o=(e=["theme"],i=h.useState(0)[1],n=function(){return i((function(e){return++e}))},r=h.useContext(Ze).customizations,a=r.inCustomizerContext,h.useEffect((function(){return a||ve.observe(n),function(){a||ve.unobserve(n)}}),[a]),ve.getSettings(e,t,r)).theme;return s||o||xe({})};const Ye="#242424",Ke="rgba(255, 255, 255, 0.1)",Qe="rgba(255, 255, 255, 0.4)",et="#000000",tt={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},it={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},nt={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:it,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},rt={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:tt,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},at={cranberry:tt,green:it,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},st=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],ot=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"],lt={success:"green",warning:"orange",danger:"cranberry"},dt=st.reduce((e,t)=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${i}Background1`]:nt[t].tint60,[`colorPalette${i}Background2`]:nt[t].tint40,[`colorPalette${i}Background3`]:nt[t].primary,[`colorPalette${i}Foreground1`]:nt[t].shade10,[`colorPalette${i}Foreground2`]:nt[t].shade30,[`colorPalette${i}Foreground3`]:nt[t].primary,[`colorPalette${i}BorderActive`]:nt[t].primary,[`colorPalette${i}Border1`]:nt[t].tint40,[`colorPalette${i}Border2`]:nt[t].primary};return Object.assign(e,n)},{});dt.colorPaletteYellowForeground1=nt.yellow.shade30,dt.colorPaletteRedForegroundInverted=nt.red.tint20,dt.colorPaletteGreenForegroundInverted=nt.green.tint20,dt.colorPaletteYellowForegroundInverted=nt.yellow.tint40;const ct=ot.reduce((e,t)=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${i}Background2`]:rt[t].tint40,[`colorPalette${i}Foreground2`]:rt[t].shade30,[`colorPalette${i}BorderActive`]:rt[t].primary};return Object.assign(e,n)},{}),ht={...dt,...ct},ut=Object.entries(lt).reduce((e,[t,i])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorStatus${n}Background1`]:at[i].tint60,[`colorStatus${n}Background2`]:at[i].tint40,[`colorStatus${n}Background3`]:at[i].primary,[`colorStatus${n}Foreground1`]:at[i].shade10,[`colorStatus${n}Foreground2`]:at[i].shade30,[`colorStatus${n}Foreground3`]:at[i].primary,[`colorStatus${n}ForegroundInverted`]:at[i].tint30,[`colorStatus${n}BorderActive`]:at[i].primary,[`colorStatus${n}Border1`]:at[i].tint40,[`colorStatus${n}Border2`]:at[i].primary};return Object.assign(e,r)},{});ut.colorStatusDangerBackground3Hover=at[lt.danger].shade10,ut.colorStatusDangerBackground3Pressed=at[lt.danger].shade20,ut.colorStatusWarningForeground1=at[lt.warning].shade20,ut.colorStatusWarningForeground3=at[lt.warning].shade20,ut.colorStatusWarningBorder2=at[lt.warning].shade20;const mt={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},ft={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},pt={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},gt={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},_t={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},St={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function vt(e,t,i=""){return{["shadow2"+i]:`0 0 2px ${e}, 0 1px 2px ${t}`,["shadow4"+i]:`0 0 2px ${e}, 0 2px 4px ${t}`,["shadow8"+i]:`0 0 2px ${e}, 0 4px 8px ${t}`,["shadow16"+i]:`0 0 2px ${e}, 0 8px 16px ${t}`,["shadow28"+i]:`0 0 8px ${e}, 0 14px 28px ${t}`,["shadow64"+i]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const yt={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},Tt={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},bt={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:"10px",spacingHorizontalM:"12px",spacingHorizontalL:"16px",spacingHorizontalXL:"20px",spacingHorizontalXXL:"24px",spacingHorizontalXXXL:"32px"},wt={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:"10px",spacingVerticalM:"12px",spacingVerticalL:"16px",spacingVerticalXL:"20px",spacingVerticalXXL:"24px",spacingVerticalXXXL:"32px"},Ct={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"},It=(e=>{const t=(e=>({colorNeutralForeground1:Ye,colorNeutralForeground1Hover:Ye,colorNeutralForeground1Pressed:Ye,colorNeutralForeground1Selected:Ye,colorNeutralForeground2:"#424242",colorNeutralForeground2Hover:Ye,colorNeutralForeground2Pressed:Ye,colorNeutralForeground2Selected:Ye,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:"#616161",colorNeutralForeground3Hover:"#424242",colorNeutralForeground3Pressed:"#424242",colorNeutralForeground3Selected:"#424242",colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:"#bdbdbd",colorNeutralForegroundInvertedDisabled:Qe,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:"#424242",colorNeutralForeground2LinkHover:Ye,colorNeutralForeground2LinkPressed:Ye,colorNeutralForeground2LinkSelected:Ye,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:Ye,colorNeutralForegroundStaticInverted:"#ffffff",colorNeutralForegroundInverted:"#ffffff",colorNeutralForegroundInvertedHover:"#ffffff",colorNeutralForegroundInvertedPressed:"#ffffff",colorNeutralForegroundInvertedSelected:"#ffffff",colorNeutralForegroundInverted2:"#ffffff",colorNeutralForegroundOnBrand:"#ffffff",colorNeutralForegroundInvertedLink:"#ffffff",colorNeutralForegroundInvertedLinkHover:"#ffffff",colorNeutralForegroundInvertedLinkPressed:"#ffffff",colorNeutralForegroundInvertedLinkSelected:"#ffffff",colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:"#ffffff",colorNeutralBackground1Hover:"#f5f5f5",colorNeutralBackground1Pressed:"#e0e0e0",colorNeutralBackground1Selected:"#ebebeb",colorNeutralBackground2:"#fafafa",colorNeutralBackground2Hover:"#f0f0f0",colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:"#e6e6e6",colorNeutralBackground3:"#f5f5f5",colorNeutralBackground3Hover:"#ebebeb",colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:"#e0e0e0",colorNeutralBackground4:"#f0f0f0",colorNeutralBackground4Hover:"#fafafa",colorNeutralBackground4Pressed:"#f5f5f5",colorNeutralBackground4Selected:"#ffffff",colorNeutralBackground5:"#ebebeb",colorNeutralBackground5Hover:"#f5f5f5",colorNeutralBackground5Pressed:"#f0f0f0",colorNeutralBackground5Selected:"#fafafa",colorNeutralBackground6:"#e6e6e6",colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:"rgba(255, 255, 255, 0.5)",colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:"#f5f5f5",colorSubtleBackgroundPressed:"#e0e0e0",colorSubtleBackgroundSelected:"#ebebeb",colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:"rgba(255, 255, 255, 0.5)",colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:"rgba(0, 0, 0, 0.1)",colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:"#f0f0f0",colorNeutralBackgroundInvertedDisabled:Ke,colorNeutralStencil1:"#e6e6e6",colorNeutralStencil2:"#fafafa",colorNeutralStencil1Alpha:"rgba(0, 0, 0, 0.1)",colorNeutralStencil2Alpha:"rgba(0, 0, 0, 0.05)",colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:"#ffffff",colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:"#fafafa",colorNeutralCardBackgroundHover:"#ffffff",colorNeutralCardBackgroundPressed:"#f5f5f5",colorNeutralCardBackgroundSelected:"#ebebeb",colorNeutralCardBackgroundDisabled:"#f0f0f0",colorNeutralStrokeAccessible:"#616161",colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:"#bdbdbd",colorNeutralStroke2:"#e0e0e0",colorNeutralStroke3:"#f0f0f0",colorNeutralStrokeSubtle:"#e0e0e0",colorNeutralStrokeOnBrand:"#ffffff",colorNeutralStrokeOnBrand2:"#ffffff",colorNeutralStrokeOnBrand2Hover:"#ffffff",colorNeutralStrokeOnBrand2Pressed:"#ffffff",colorNeutralStrokeOnBrand2Selected:"#ffffff",colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:"#e0e0e0",colorNeutralStrokeInvertedDisabled:Qe,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:"rgba(0, 0, 0, 0.05)",colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:"#ffffff",colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...mt,...ft,...pt,..._t,...gt,...St,...bt,...wt,...yt,...Tt,...t,...ht,...ut,...vt(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...vt(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(Ct),Pt=st.reduce((e,t)=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${i}Background1`]:nt[t].shade40,[`colorPalette${i}Background2`]:nt[t].shade30,[`colorPalette${i}Background3`]:nt[t].primary,[`colorPalette${i}Foreground1`]:nt[t].tint30,[`colorPalette${i}Foreground2`]:nt[t].tint40,[`colorPalette${i}Foreground3`]:nt[t].tint20,[`colorPalette${i}BorderActive`]:nt[t].tint30,[`colorPalette${i}Border1`]:nt[t].primary,[`colorPalette${i}Border2`]:nt[t].tint20};return Object.assign(e,n)},{});Pt.colorPaletteRedForeground3=nt.red.tint30,Pt.colorPaletteRedBorder2=nt.red.tint30,Pt.colorPaletteGreenForeground3=nt.green.tint40,Pt.colorPaletteGreenBorder2=nt.green.tint40,Pt.colorPaletteDarkOrangeForeground3=nt.darkOrange.tint30,Pt.colorPaletteDarkOrangeBorder2=nt.darkOrange.tint30,Pt.colorPaletteRedForegroundInverted=nt.red.primary,Pt.colorPaletteGreenForegroundInverted=nt.green.primary,Pt.colorPaletteYellowForegroundInverted=nt.yellow.shade30;const Et=ot.reduce((e,t)=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${i}Background2`]:rt[t].shade30,[`colorPalette${i}Foreground2`]:rt[t].tint40,[`colorPalette${i}BorderActive`]:rt[t].tint30};return Object.assign(e,n)},{});Et.colorPaletteDarkRedBackground2=rt.darkRed.shade20,Et.colorPalettePlumBackground2=rt.plum.shade20;const xt={...Pt,...Et},kt=Object.entries(lt).reduce((e,[t,i])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorStatus${n}Background1`]:at[i].shade40,[`colorStatus${n}Background2`]:at[i].shade30,[`colorStatus${n}Background3`]:at[i].primary,[`colorStatus${n}Foreground1`]:at[i].tint30,[`colorStatus${n}Foreground2`]:at[i].tint40,[`colorStatus${n}Foreground3`]:at[i].tint20,[`colorStatus${n}BorderActive`]:at[i].tint30,[`colorStatus${n}ForegroundInverted`]:at[i].shade10,[`colorStatus${n}Border1`]:at[i].primary,[`colorStatus${n}Border2`]:at[i].tint20};return Object.assign(e,r)},{});kt.colorStatusDangerBackground3Hover=at[lt.danger].shade10,kt.colorStatusDangerBackground3Pressed=at[lt.danger].shade20,kt.colorStatusDangerForeground3=at[lt.danger].tint40,kt.colorStatusDangerBorder2=at[lt.danger].tint30,kt.colorStatusSuccessForeground3=at[lt.success].tint40,kt.colorStatusSuccessBorder2=at[lt.success].tint40,kt.colorStatusWarningForegroundInverted=at[lt.warning].shade20;const Mt=(e=>{const t=(e=>({colorNeutralForeground1:"#ffffff",colorNeutralForeground1Hover:"#ffffff",colorNeutralForeground1Pressed:"#ffffff",colorNeutralForeground1Selected:"#ffffff",colorNeutralForeground2:"#d6d6d6",colorNeutralForeground2Hover:"#ffffff",colorNeutralForeground2Pressed:"#ffffff",colorNeutralForeground2Selected:"#ffffff",colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:"#adadad",colorNeutralForeground3Hover:"#d6d6d6",colorNeutralForeground3Pressed:"#d6d6d6",colorNeutralForeground3Selected:"#d6d6d6",colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:"#999999",colorNeutralForegroundDisabled:"#5c5c5c",colorNeutralForegroundInvertedDisabled:Qe,colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:"#d6d6d6",colorNeutralForeground2LinkHover:"#ffffff",colorNeutralForeground2LinkPressed:"#ffffff",colorNeutralForeground2LinkSelected:"#ffffff",colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:Ye,colorNeutralForegroundStaticInverted:"#ffffff",colorNeutralForegroundInverted:Ye,colorNeutralForegroundInvertedHover:Ye,colorNeutralForegroundInvertedPressed:Ye,colorNeutralForegroundInvertedSelected:Ye,colorNeutralForegroundInverted2:Ye,colorNeutralForegroundOnBrand:"#ffffff",colorNeutralForegroundInvertedLink:"#ffffff",colorNeutralForegroundInvertedLinkHover:"#ffffff",colorNeutralForegroundInvertedLinkPressed:"#ffffff",colorNeutralForegroundInvertedLinkSelected:"#ffffff",colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:"#292929",colorNeutralBackground1Hover:"#3d3d3d",colorNeutralBackground1Pressed:"#1f1f1f",colorNeutralBackground1Selected:"#383838",colorNeutralBackground2:"#1f1f1f",colorNeutralBackground2Hover:"#333333",colorNeutralBackground2Pressed:"#141414",colorNeutralBackground2Selected:"#2e2e2e",colorNeutralBackground3:"#141414",colorNeutralBackground3Hover:"#292929",colorNeutralBackground3Pressed:"#0a0a0a",colorNeutralBackground3Selected:Ye,colorNeutralBackground4:"#0a0a0a",colorNeutralBackground4Hover:"#1f1f1f",colorNeutralBackground4Pressed:"#000000",colorNeutralBackground4Selected:"#1a1a1a",colorNeutralBackground5:"#000000",colorNeutralBackground5Hover:"#141414",colorNeutralBackground5Pressed:"#050505",colorNeutralBackground5Selected:"#0f0f0f",colorNeutralBackground6:"#333333",colorNeutralBackgroundInverted:"#ffffff",colorNeutralBackgroundStatic:"#3d3d3d",colorNeutralBackgroundAlpha:"rgba(26, 26, 26, 0.5)",colorNeutralBackgroundAlpha2:"rgba(31, 31, 31, 0.7)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:"#383838",colorSubtleBackgroundPressed:"#2e2e2e",colorSubtleBackgroundSelected:"#333333",colorSubtleBackgroundLightAlphaHover:"rgba(36, 36, 36, 0.8)",colorSubtleBackgroundLightAlphaPressed:"rgba(36, 36, 36, 0.5)",colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:"rgba(0, 0, 0, 0.1)",colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:"#141414",colorNeutralBackgroundInvertedDisabled:Ke,colorNeutralStencil1:"#575757",colorNeutralStencil2:"#333333",colorNeutralStencil1Alpha:Ke,colorNeutralStencil2Alpha:"rgba(255, 255, 255, 0.05)",colorBackgroundOverlay:"rgba(0, 0, 0, 0.5)",colorScrollbarOverlay:"rgba(255, 255, 255, 0.6)",colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:"#ffffff",colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:"#333333",colorNeutralCardBackgroundHover:"#3d3d3d",colorNeutralCardBackgroundPressed:"#2e2e2e",colorNeutralCardBackgroundSelected:"#383838",colorNeutralCardBackgroundDisabled:"#141414",colorNeutralStrokeAccessible:"#adadad",colorNeutralStrokeAccessibleHover:"#bdbdbd",colorNeutralStrokeAccessiblePressed:"#b3b3b3",colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:"#666666",colorNeutralStroke1Hover:"#757575",colorNeutralStroke1Pressed:"#6b6b6b",colorNeutralStroke1Selected:"#707070",colorNeutralStroke2:"#525252",colorNeutralStroke3:"#3d3d3d",colorNeutralStrokeSubtle:"#0a0a0a",colorNeutralStrokeOnBrand:"#292929",colorNeutralStrokeOnBrand2:"#ffffff",colorNeutralStrokeOnBrand2Hover:"#ffffff",colorNeutralStrokeOnBrand2Pressed:"#ffffff",colorNeutralStrokeOnBrand2Selected:"#ffffff",colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:"#424242",colorNeutralStrokeInvertedDisabled:Qe,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:Ke,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:"#000000",colorStrokeFocus2:"#ffffff",colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...mt,...ft,...pt,..._t,...gt,...St,...bt,...wt,...yt,...Tt,...t,...xt,...kt,...vt(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...vt(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(Ct),At=st.reduce((e,t)=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${i}Background1`]:et,[`colorPalette${i}Background2`]:et,[`colorPalette${i}Background3`]:"#ffffff",[`colorPalette${i}Foreground1`]:"#ffffff",[`colorPalette${i}Foreground2`]:"#ffffff",[`colorPalette${i}Foreground3`]:"#ffffff",[`colorPalette${i}BorderActive`]:"#1aebff",[`colorPalette${i}Border1`]:"#ffffff",[`colorPalette${i}Border2`]:"#ffffff"};return Object.assign(e,n)},{});At.colorPaletteRedForegroundInverted="#ffffff",At.colorPaletteGreenForegroundInverted="#ffffff",At.colorPaletteYellowForegroundInverted="#ffffff";const Rt=ot.reduce((e,t)=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${i}Background2`]:et,[`colorPalette${i}Foreground2`]:"#ffffff",[`colorPalette${i}BorderActive`]:"#1aebff"};return Object.assign(e,n)},{}),Ot={...At,...Rt},Ft=Object.entries(lt).reduce((e,[t,i])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorStatus${n}Background1`]:et,[`colorStatus${n}Background2`]:et,[`colorStatus${n}Background3`]:"#ffffff",[`colorStatus${n}Foreground1`]:"#ffffff",[`colorStatus${n}Foreground2`]:"#ffffff",[`colorStatus${n}Foreground3`]:"#ffffff",[`colorStatus${n}BorderActive`]:"#1aebff",[`colorStatus${n}ForegroundInverted`]:"#ffffff",[`colorStatus${n}Border1`]:"#ffffff",[`colorStatus${n}Border2`]:"#ffffff"};return Object.assign(e,r)},{});Ft.colorStatusDangerBackground3Hover="#1aebff",Ft.colorStatusDangerBackground3Pressed="#1aebff";const Dt={..._t,fontFamilyBase:'-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif'},Lt={...(()=>{const e={colorNeutralForeground1:"#ffffff",colorNeutralForeground1Hover:"#000000",colorNeutralForeground1Pressed:"#000000",colorNeutralForeground1Selected:"#000000",colorNeutralForeground2:"#ffffff",colorNeutralForeground2Hover:"#000000",colorNeutralForeground2Pressed:"#000000",colorNeutralForeground2Selected:"#000000",colorNeutralForeground2BrandHover:"#000000",colorNeutralForeground2BrandPressed:"#000000",colorNeutralForeground2BrandSelected:"#000000",colorNeutralForeground3:"#ffffff",colorNeutralForeground3Hover:"#000000",colorNeutralForeground3Pressed:"#000000",colorNeutralForeground3Selected:"#000000",colorNeutralForeground3BrandHover:"#000000",colorNeutralForeground3BrandPressed:"#000000",colorNeutralForeground3BrandSelected:"#000000",colorNeutralForeground4:"#ffffff",colorNeutralForegroundDisabled:"#3ff23f",colorNeutralForegroundInvertedDisabled:"#3ff23f",colorBrandForegroundLink:"#ffff00",colorBrandForegroundLinkHover:"#ffff00",colorBrandForegroundLinkPressed:"#ffff00",colorBrandForegroundLinkSelected:"#ffff00",colorNeutralForeground2Link:"#ffff00",colorNeutralForeground2LinkHover:"#ffff00",colorNeutralForeground2LinkPressed:"#ffff00",colorNeutralForeground2LinkSelected:"#ffff00",colorCompoundBrandForeground1:"#1aebff",colorCompoundBrandForeground1Hover:"#1aebff",colorCompoundBrandForeground1Pressed:"#1aebff",colorBrandForeground1:"#ffffff",colorBrandForeground2:"#ffffff",colorBrandForeground2Hover:"#ffffff",colorBrandForeground2Pressed:"#ffffff",colorNeutralForeground1Static:et,colorNeutralForegroundStaticInverted:"#ffffff",colorNeutralForegroundInverted:"#000000",colorNeutralForegroundInvertedHover:"#000000",colorNeutralForegroundInvertedPressed:"#000000",colorNeutralForegroundInvertedSelected:"#000000",colorNeutralForegroundInverted2:"#ffffff",colorNeutralForegroundOnBrand:"#000000",colorNeutralForegroundInvertedLink:"#ffff00",colorNeutralForegroundInvertedLinkHover:"#ffff00",colorNeutralForegroundInvertedLinkPressed:"#ffff00",colorNeutralForegroundInvertedLinkSelected:"#ffff00",colorBrandForegroundInverted:"#ffffff",colorBrandForegroundInvertedHover:"#000000",colorBrandForegroundInvertedPressed:"#000000",colorBrandForegroundOnLight:"#000000",colorBrandForegroundOnLightHover:"#000000",colorBrandForegroundOnLightPressed:"#000000",colorBrandForegroundOnLightSelected:"#000000",colorNeutralBackground1:et,colorNeutralBackground1Hover:"#1aebff",colorNeutralBackground1Pressed:"#1aebff",colorNeutralBackground1Selected:"#1aebff",colorNeutralBackground2:et,colorNeutralBackground2Hover:"#1aebff",colorNeutralBackground2Pressed:"#1aebff",colorNeutralBackground2Selected:"#1aebff",colorNeutralBackground3:et,colorNeutralBackground3Hover:"#1aebff",colorNeutralBackground3Pressed:"#1aebff",colorNeutralBackground3Selected:"#1aebff",colorNeutralBackground4:et,colorNeutralBackground4Hover:"#1aebff",colorNeutralBackground4Pressed:"#1aebff",colorNeutralBackground4Selected:"#1aebff",colorNeutralBackground5:et,colorNeutralBackground5Hover:"#1aebff",colorNeutralBackground5Pressed:"#1aebff",colorNeutralBackground5Selected:"#1aebff",colorNeutralBackground6:et,colorNeutralBackgroundInverted:et,colorNeutralBackgroundStatic:et,colorNeutralBackgroundAlpha:et,colorNeutralBackgroundAlpha2:et,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:"#1aebff",colorSubtleBackgroundPressed:"#1aebff",colorSubtleBackgroundSelected:"#1aebff",colorSubtleBackgroundLightAlphaHover:"#1aebff",colorSubtleBackgroundLightAlphaPressed:"#1aebff",colorSubtleBackgroundLightAlphaSelected:"#1aebff",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:"#1aebff",colorSubtleBackgroundInvertedPressed:"#1aebff",colorSubtleBackgroundInvertedSelected:"#1aebff",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"#1aebff",colorTransparentBackgroundPressed:"#1aebff",colorTransparentBackgroundSelected:"#1aebff",colorNeutralBackgroundDisabled:et,colorNeutralBackgroundInvertedDisabled:et,colorNeutralStencil1:"#ffffff",colorNeutralStencil2:"#ffffff",colorNeutralStencil1Alpha:"#ffffff",colorNeutralStencil2Alpha:"#ffffff",colorBackgroundOverlay:"rgba(0, 0, 0, 0.5)",colorScrollbarOverlay:"#ffffff",colorBrandBackground:"#ffffff",colorBrandBackgroundHover:"#1aebff",colorBrandBackgroundPressed:"#1aebff",colorBrandBackgroundSelected:"#1aebff",colorCompoundBrandBackground:"#1aebff",colorCompoundBrandBackgroundHover:"#1aebff",colorCompoundBrandBackgroundPressed:"#1aebff",colorBrandBackgroundStatic:et,colorBrandBackground2:et,colorBrandBackground2Hover:et,colorBrandBackground2Pressed:et,colorBrandBackground3Static:et,colorBrandBackground4Static:et,colorBrandBackgroundInverted:"#ffffff",colorBrandBackgroundInvertedHover:"#1aebff",colorBrandBackgroundInvertedPressed:"#1aebff",colorBrandBackgroundInvertedSelected:"#1aebff",colorNeutralCardBackground:et,colorNeutralCardBackgroundHover:"#1aebff",colorNeutralCardBackgroundPressed:"#1aebff",colorNeutralCardBackgroundSelected:"#1aebff",colorNeutralCardBackgroundDisabled:et,colorNeutralStrokeAccessible:"#ffffff",colorNeutralStrokeAccessibleHover:"#1aebff",colorNeutralStrokeAccessiblePressed:"#1aebff",colorNeutralStrokeAccessibleSelected:"#1aebff",colorNeutralStroke1:"#ffffff",colorNeutralStroke1Hover:"#1aebff",colorNeutralStroke1Pressed:"#1aebff",colorNeutralStroke1Selected:"#1aebff",colorNeutralStroke2:"#ffffff",colorNeutralStroke3:"#ffffff",colorNeutralStrokeSubtle:"#ffffff",colorNeutralStrokeOnBrand:et,colorNeutralStrokeOnBrand2:"#ffffff",colorNeutralStrokeOnBrand2Hover:"#ffffff",colorNeutralStrokeOnBrand2Pressed:"#ffffff",colorNeutralStrokeOnBrand2Selected:"#ffffff",colorBrandStroke1:"#ffffff",colorBrandStroke2:"#ffffff",colorBrandStroke2Hover:"#1aebff",colorBrandStroke2Pressed:"#1aebff",colorBrandStroke2Contrast:et,colorCompoundBrandStroke:"#1aebff",colorCompoundBrandStrokeHover:"#1aebff",colorCompoundBrandStrokePressed:"#1aebff",colorNeutralStrokeDisabled:"#3ff23f",colorNeutralStrokeInvertedDisabled:"#3ff23f",colorTransparentStroke:"#ffffff",colorTransparentStrokeInteractive:"#1aebff",colorTransparentStrokeDisabled:"#3ff23f",colorNeutralStrokeAlpha:"#ffffff",colorNeutralStrokeAlpha2:et,colorStrokeFocus1:et,colorStrokeFocus2:"#1aebff",colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"};return{...mt,...ft,...pt,..._t,...gt,...St,...bt,...wt,...yt,...Tt,...e,...Ot,...Ft,...vt(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...vt(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})(),...Dt},Bt=xe({palette:{themeDarker:"#0e336a",themeDark:"#13458f",themeDarkAlt:"#1651aa",themePrimary:"#185abd",themeSecondary:"#2e6ac5",themeTertiary:"#6794d7",themeLight:"#aec6eb",themeLighter:"#d2e0f4",neutralDark:"#252423",neutralPrimary:"#323130",neutralPrimaryAlt:"#605E5C",neutralSecondary:"#797775",neutralSecondaryAlt:"#8A8886",neutralTertiary:"#B3B0AD",neutralTertiaryAlt:"#BEBBB8",neutralQuaternary:"#C8C6C4",neutralQuaternaryAlt:"#D2D0CE",neutralLight:"#E1DFDD",neutralLighter:"#EDEBE9",neutralLighterAlt:"#F3F2F1",black:"#000000",white:"#FFFFFF"}}),Nt=xe({palette:{themeDarker:"#82ABF1",themeDark:"#598FEC",themeDarkAlt:"#3D7CE8",themePrimary:"#296FE6",themeSecondary:"#2461CA",themeTertiary:"#19428A",themeLight:"#0C2145",themeLighter:"#071225",neutralDark:"#F3F2F1",neutralPrimary:"#D2D0CE",neutralPrimaryAlt:"#B3B0AD",neutralSecondary:"#979593",neutralSecondaryAlt:"#797775",neutralTertiary:"#605E5C",neutralTertiaryAlt:"#484644",neutralQuaternary:"#3B3A39",neutralQuaternaryAlt:"#292827",neutralLight:"#323130",neutralLighter:"#1B1A19",neutralLighterAlt:"#252423",black:"#FFFFFF",white:"#000000"}}),Vt={...It,legacy_themeDarker:"#0e336a",legacy_themeDark:"#13458f",legacy_themeDarkAlt:"#1651aa",legacy_themePrimary:"#185abd",legacy_themeSecondary:"#2e6ac5",legacy_themeTertiary:"#6794d7",legacy_themeLight:"#aec6eb",legacy_themeLighter:"#d2e0f4",legacy_neutralDark:"#252423",legacy_neutralPrimary:"#323130",legacy_neutralPrimaryAlt:"#605E5C",legacy_neutralSecondary:"#797775",legacy_neutralSecondaryAlt:"#8A8886",legacy_neutralTertiary:"#B3B0AD",legacy_neutralTertiaryAlt:"#BEBBB8",legacy_neutralQuaternary:"#C8C6C4",legacy_neutralQuaternaryAlt:"#D2D0CE",legacy_neutralLight:"#E1DFDD",legacy_neutralLighter:"#EDEBE9",legacy_neutralLighterAlt:"#F3F2F1",legacy_black:"#000000",legacy_white:"#FFFFFF",messageBarWarningBackground:"#FFFAD6",messageBarSuccessBackground:"#DEF2DE",messageBarErrorBackground:"#FDE7E9"},Wt={...Mt,legacy_themeDarker:"#82ABF1",legacy_themeDark:"#598FEC",legacy_themeDarkAlt:"#3D7CE8",legacy_themePrimary:"#296FE6",legacy_themeSecondary:"#2461CA",legacy_themeTertiary:"#19428A",legacy_themeLight:"#0C2145",legacy_themeLighter:"#071225",legacy_neutralDark:"#F3F2F1",legacy_neutralPrimary:"#D2D0CE",legacy_neutralPrimaryAlt:"#B3B0AD",legacy_neutralSecondary:"#979593",legacy_neutralSecondaryAlt:"#8A8886",legacy_neutralTertiary:"#797775",legacy_neutralTertiaryAlt:"#605E5C",legacy_neutralQuaternary:"#484644",legacy_neutralQuaternaryAlt:"#3B3A39",legacy_neutralLight:"#323130",legacy_neutralLighter:"#292827",legacy_neutralLighterAlt:"#252423",legacy_black:"#FFFFFF",legacy_white:"#1B1A19",messageBarWarningBackground:"#4C4400",messageBarSuccessBackground:"#052505",messageBarErrorBackground:"#3F1011"},Ut={...Lt,legacy_themeDarker:"#FFFFFF",legacy_themeDark:"#FFFFFF",legacy_themeDarkAlt:"#FFFFFF",legacy_themePrimary:"#FFFFFF",legacy_themeSecondary:"#FFFFFF",legacy_themeTertiary:"#000000",legacy_themeLight:"#000000",legacy_themeLighter:"#000000",legacy_neutralDark:"#FFFFFF",legacy_neutralPrimary:"#FFFFFF",legacy_neutralPrimaryAlt:"#FFFFFF",legacy_neutralSecondary:"#FFFFFF",legacy_neutralSecondaryAlt:"#FFFFFF",legacy_neutralTertiary:"#FFFFFF",legacy_neutralTertiaryAlt:"#000000",legacy_neutralQuaternary:"#000000",legacy_neutralQuaternaryAlt:"#000000",legacy_neutralLight:"#000000",legacy_neutralLighter:"#000000",legacy_neutralLighterAlt:"#000000",legacy_black:"#FFFFFF",legacy_white:"#000000",messageBarWarningBackground:"#000000",messageBarSuccessBackground:"#000000",messageBarErrorBackground:"#000000"};var zt;!function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark",e[e.HighContrast=2]="HighContrast"}(zt||(zt={}));class Ht{static getInstance(){return Ht.instance||(Ht.instance=new Ht),Ht.instance}isThemingInitialized(){return this.themingIsInitialized}async waitForInitialThemeLoad(){return this.themingInitializePromise}isFluentThemingInitialized(){if(!this.fluentThemingIsInitialized){if(null==Re())return!1;this.fluentThemingIsInitialized=!0}return!0}overrideThemingIsInitialized(e){e?this.onThemingInitialized():this.themingIsInitialized=!1}getThemeMode(){return this.currentTheme}getTheme(){return void 0===this.AppThemeListV8[this.currentTheme]||null===this.AppThemeListV8[this.currentTheme]?Re():this.AppThemeListV8[this.currentTheme]}getThemeNext(){return this.AppThemeList[this.currentTheme]}setTheme(e,t,i){i&&(this.AppThemeList[e]=i),this.AppThemeListV8[e]=t}loadTheme(e){this.currentTheme=e,Oe(this.AppThemeListV8[e]),this.themeChangedCallbacks.forEach(e=>e()),this.onThemingInitialized()}getThemeForMode(e){return this.AppThemeListV8[e]}getThemeForModeNext(e){return this.AppThemeList[e]}convertVNextThemeToV8Theme(e){return this.currentTheme===zt.Light?this.AppThemeListV8[zt.Light]:this.AppThemeListV8[zt.Dark]}registerOnThemeChanged(e){-1===this.themeChangedCallbacks.indexOf(e)&&this.themeChangedCallbacks.push(e)}unregisterOnThemeChanged(e){const t=this.themeChangedCallbacks.indexOf(e);-1!==t&&this.themeChangedCallbacks.splice(t,1)}constructor(){let e;this.AppThemeList={[zt.Light]:Vt,[zt.Dark]:Wt,[zt.HighContrast]:Ut},this.AppThemeListV8={[zt.Light]:Bt,[zt.Dark]:Nt,[zt.HighContrast]:Nt},this.currentTheme=zt.Light,this.themeChangedCallbacks=[],this.themingIsInitialized=!1,this.fluentThemingIsInitialized=!1,this.themingInitializePromise=new Promise(t=>{e=t}),this.onThemingInitialized=()=>{this.themingIsInitialized=!0,e()}}}const Gt=e=>{const t=Xe()||Ht.getInstance().getTheme();return h.createElement(h.Fragment,null,e.children(t))};class jt{static resolveDateTimeFormat(e){const t=new Intl.DateTimeFormat(Intl.Locale.name,{timeStyle:"short",dateStyle:"long"});return e.replace("${Device.DateTime}",t.format(Date.now()))}}const $t=e=>{const t=e.matchAll(/\$\{((?!\}).)*\}/g),i=[];let n=0;for(const r of t){r.index>n&&i.push(e.substring(n,r.index));const[t]=r;i.push(t),n=r.index+t.length}return n<e.length&&i.push(e.substring(n)),i},qt=(e,t={})=>{var i,n;const r=new Intl.DateTimeFormat(Intl.Locale.name,{timeStyle:"short",dateStyle:"long"}).format(null!==(i=t.dateTime)&&void 0!==i?i:Date.now()),a=new Set(t.include||Jt());null===(n=t.exclude)||void 0===n||n.forEach(e=>{a.delete(e)});let s="";const o=new Set,l=new Set;for(const i of e)i===Zt.DeviceDateTime&&a.has(Zt.DeviceDateTime)?(s+=r,o.add(i)):i===Zt.ConsumerPrincipalName&&a.has(Zt.ConsumerPrincipalName)&&t.userPrincipalName?(s+=t.userPrincipalName,o.add(i)):(s+=i,i.startsWith("${")&&i.endsWith("}")&&l.add(i));return{resolvedText:s,resolvedTokens:Array.from(o),unresolvedTokens:Array.from(l)}};var Zt;!function(e){e.DeviceDateTime="${Device.DateTime}",e.ConsumerPrincipalName="${Consumer.PrincipalName}"}(Zt||(Zt={}));const Jt=()=>Object.values(Zt).filter(e=>e.startsWith("$")),Xt=()=>[Zt.DeviceDateTime],Yt=()=>Object(c.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9639934_ResolveWatermarkTokensOnClient"),Kt=le.large.fontFamily,Qt=le.large.fontSize,ei=N.semibold;let ti=null;const ii=({id:e,templateText:t,pauseMutationObservers:i,startMutationObservers:s})=>{const o=l(0,!1),d=e+"Fill",[c,u]=Object(h.useState)(Yt()?"":()=>jt.resolveDateTimeFormat(t)),m=Object(h.useMemo)(()=>function(e,t,i,n){ti||(ti=new OffscreenCanvas(0,0));const r=ti.getContext("2d");r.font=t;const a=r.measureText(e);return{width:a.width+8,height:a.fontBoundingBoxAscent+a.fontBoundingBoxDescent+8}}(c,ei+" "+Qt+" "+Kt),[c]);return Object(h.useEffect)(()=>{0!==m.width&&0!==m.height||n.a.sendTraceTag(507093779,r.a.msoulscat_Wac_BrowserGeneral,a.a.Important,`Watermark text width (${m.width}) and/or height (${m.height}) returned as zero - watermark layout will not be correct.`)},[m.width,m.height]),o&&i(),Object(h.useEffect)(()=>{if(!Yt()){if(u(jt.resolveDateTimeFormat(t)),t.includes("${Device.DateTime}")){const e=setInterval(()=>{u(jt.resolveDateTimeFormat(t))},6e4);return()=>clearInterval(e)}return}const e=$t(t);if(u(qt(e).resolvedText),(e=>{const t=new Set(Xt());return e.some(e=>t.has(e))})(e)){const t=setInterval(()=>{u(qt(e).resolvedText)},6e4);return()=>clearInterval(t)}},[t]),Object(h.useEffect)(()=>{o&&s()}),h.createElement(Gt,null,e=>h.createElement("svg",{width:"100%",height:"100%"},h.createElement("defs",null,h.createElement("pattern",{id:d,patternUnits:"userSpaceOnUse",width:1.3*m.width+16,height:5*m.height+16,patternTransform:"rotate(-30)"},h.createElement("text",{x:4,y:m.height+4,fontFamily:Kt,fontSize:Qt,fontWeight:ei,fill:e.palette.black,stroke:e.palette.white,strokeWidth:.5},c),h.createElement("text",{x:.3*m.width+4,y:3.5*m.height+12,fontFamily:Kt,fontSize:Qt,fontWeight:ei,fill:e.palette.black,stroke:e.palette.white,strokeWidth:.5},c))),h.createElement("rect",{width:"100%",height:"100%",fill:"url(#"+d+")"})))};class ni extends h.Component{async renderAsync(){u.render(this.watermarkImplDiv,this.watermarkDiv),l(0,!1)&&this.startMutationObservers()}pauseMutationObservers(){this.wmRemovalObserver.disconnect(),this.wmAttributeModificationsObserver.disconnect()}startMutationObservers(){this.wmRemovalObserver.observe(this.container,{childList:!0}),this.wmAttributeModificationsObserver.observe(this.watermarkDiv,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}destroy(){if(void 0===this.watermarkDiv.id)return;this.pauseMutationObservers();const e=document.getElementById(this.watermarkDiv.id);e?(u.unmountComponentAtNode(e),e.remove()):n.a.sendTraceTag(505983809,r.a.msoulscat_Wac_Telemetry,a.a.Error,"WatermarkFactory.removeWatermark: Given html element could not be find in document.")}static destroyStatic(e){u.unmountComponentAtNode(e)}watermarkRemovalCallback(e,t){this.watermarkTamperingAttempts++,this.logTamperingAttempts(),this.watermarkTamperingAttempts>10||e.forEach(e=>{"childList"===e.type&&e.removedNodes.forEach(e=>{var t;e instanceof HTMLElement&&e.id===this.watermarkDiv.id&&(this.destroy(),this.watermarkDiv=document.createElement("div"),this.watermarkDiv.id=this.watermarkDivId,this.watermarkDiv.className=(null===(t=this.watermarkStyles)||void 0===t?void 0:t.visible)||"",this.container.appendChild(this.watermarkDiv),this.renderAsync())})})}watermarkAttributeModificationsCallback(e,t){this.watermarkTamperingAttempts++,this.logTamperingAttempts(),this.watermarkTamperingAttempts>10||e.forEach(e=>{var t;"attributes"===e.type||"childList"===e.type?(this.destroy(),this.watermarkDiv=document.createElement("div"),this.watermarkDiv.id=this.watermarkDivId,this.watermarkDiv.className=(null===(t=this.watermarkStyles)||void 0===t?void 0:t.visible)||"",this.container.appendChild(this.watermarkDiv),this.renderAsync()):n.a.sendTraceTag(505983427,r.a.msoulscat_Wac_BrowserGeneral,a.a.Important,`Watermark modification attempted: ${e.type} type`)})}logTamperingAttempts(){n.a.sendTraceTag(505983426,r.a.msoulscat_Wac_BrowserGeneral,a.a.Important,`Watermark tampering attempted by user: ${this.watermarkTamperingAttempts} attempts made`)}setDynamicWatermarkInlineStyle(e,t){var i,n,r,a,s,o,l;t.style.display="inherit",t.style.position="absolute",t.style.paddingTop=(null===(i=e.paddingTop)||void 0===i?void 0:i.toString())||"0",t.style.paddingBottom=(null===(n=e.paddingBottom)||void 0===n?void 0:n.toString())||"0",t.style.paddingRight=(null===(r=e.paddingRight)||void 0===r?void 0:r.toString())||"0",t.style.paddingLeft=(null===(a=e.paddingLeft)||void 0===a?void 0:a.toString())||"0",t.style.height=(null===(s=e.height)||void 0===s?void 0:s.toString())||"100%",t.style.width=(null===(o=e.width)||void 0===o?void 0:o.toString())||"100%",t.style.margin="0",t.style.border="none",t.style.opacity="0.55",t.style.zIndex=(null===(l=e.zIndex)||void 0===l?void 0:l.toString())||Number.MAX_SAFE_INTEGER.toString(),t.style.pointerEvents="none",e.zoom&&(t.style.transform="scale("+e.zoom.toString()+","+e.zoom.toString()+")")}getDynamicWatermarkImplInlineStyle(){return{display:"inherit",position:"absolute",top:0,bottom:0,left:0,right:0,height:"100%",width:"100%",border:"none",margin:0,padding:0,opacity:.55,zIndex:Number.MAX_SAFE_INTEGER,pointerEvents:"none"}}constructor(e,t,i){const n=l(0,!1);super({}),this.watermarkStyles=null,this.watermarkImplStyles=null,this.watermarkTamperingAttempts=0,this.watermarkDivId=e;const r=e+"Impl";var a,s;this.watermarkImplStyles=qe(),l(0,!1)&&t.useInlineStyling?this.watermarkImplDiv=h.createElement("div",{id:r,style:this.getDynamicWatermarkImplInlineStyle()},h.createElement(ii,{id:e,templateText:i,pauseMutationObservers:n?()=>{this.pauseMutationObservers()}:()=>{},startMutationObservers:n?()=>{this.startMutationObservers()}:()=>{}})):this.watermarkImplDiv=h.createElement("div",{id:r,className:null===(a=this.watermarkImplStyles)||void 0===a?void 0:a.visible},h.createElement(ii,{id:e,templateText:i,pauseMutationObservers:n?()=>{this.pauseMutationObservers()}:()=>{},startMutationObservers:n?()=>{this.startMutationObservers()}:()=>{}})),this.watermarkStyles=(e=>Le({hidden:{display:"none"},visible:{display:"inherit",position:"absolute",top:(null==e?void 0:e.paddingTop)||0,bottom:(null==e?void 0:e.paddingBottom)||0,left:(null==e?void 0:e.paddingLeft)||0,right:(null==e?void 0:e.paddingRight)||0,height:(null==e?void 0:e.height)||"100%",width:(null==e?void 0:e.width)||"100%",border:"none",margin:0,padding:0,opacity:.55,zIndex:(null==e?void 0:e.zIndex)||Number.MAX_SAFE_INTEGER,pointerEvents:"none",zoom:(null==e?void 0:e.zoom)||1}}))(t),this.container=t.watermarkElement,this.watermarkDiv=document.createElement("div"),this.watermarkDiv.id=this.watermarkDivId,this.wmRemovalObserver=new MutationObserver((e,t)=>this.watermarkRemovalCallback(e,t)),this.wmAttributeModificationsObserver=new MutationObserver((e,t)=>{this.watermarkAttributeModificationsCallback(e,t)}),l(0,!1)&&t.useInlineStyling?this.setDynamicWatermarkInlineStyle(t,this.watermarkDiv):this.watermarkDiv.className=null===(s=this.watermarkStyles)||void 0===s?void 0:s.visible,this.container.appendChild(this.watermarkDiv)}}class ri{static async createWatermark(e){const t="watermark"+ri.instanceCount++,i=e.watermarkArgsData.watermarkElement,n=ri.divWatermarkIdMap.get(i);n&&ri.removeWatermark(n),ri.divWatermarkIdMap.set(i,t);let r=e.watermarkText||"";if(Yt()){const t=Xt(),i=((e,t={})=>{const i=$t(e);return qt(i,t)})(r,{exclude:t,...e.tokenProps}),n=new Set(i.resolvedTokens),a=new Set(i.unresolvedTokens);t.forEach(e=>{a.delete(e)}),ai(n,a),r=i.resolvedText}const a=new ni(t,e.watermarkArgsData,r);ri.watermarkIdAndWatermarkMap.set(t,a),await a.renderAsync()}static async removeWatermarkFromHtmElement(e){if(e.watermarkArgsData.watermarkElement){const t=ri.divWatermarkIdMap.get(e.watermarkArgsData.watermarkElement);ri.removeWatermark(t),ri.divWatermarkIdMap.delete(e.watermarkArgsData.watermarkElement)}}static async removeAllWatermarks(){ri.divWatermarkIdMap.size>0&&n.a.sendTraceTag(507285646,r.a.msoulscat_Wac_BrowserGeneral,a.a.Important,"Remove Watermark is invoked successfully"),ri.divWatermarkIdMap.forEach(e=>{ri.removeWatermark(e)}),ri.divWatermarkIdMap.clear()}static removeWatermark(e){if(l(0,!1)){var t;null===(t=ri.watermarkIdAndWatermarkMap.get(e))||void 0===t||t.destroy(),ri.watermarkIdAndWatermarkMap.delete(e)}else{const t=document.getElementById(e);if(!t)return void n.a.sendTraceTag(507348962,r.a.msoulscat_Wac_Telemetry,a.a.Error,"WatermarkFactory.removeWatermark: Given html element could not be found in document.");ni.destroyStatic(t),t.remove()}}}ri.instanceCount=0,ri.divWatermarkIdMap=new Map,ri.watermarkIdAndWatermarkMap=new Map;const ai=(e,t)=>{const i=!Object(c.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9639934_UnsampleResolveWatermarkTokensOnClientTelemetry");Object(s.p)({name:"Office.Online.Security.Clp.ResolveDynamicWatermarkToken",samplingPolicy:i?o.e.Sampled:o.e.Complete,dataFields:[{name:"IsUpnResolved",bool:e.has(Zt.ConsumerPrincipalName)},{name:"IsUpnUnresolved",bool:t.has(Zt.ConsumerPrincipalName)},{name:"UnresolvedCount",int64:t.size},{name:"IsFromSharedWatermarksPackage",bool:!0}]}),t.size>0&&n.a.sendTraceTag(505938971,r.a.msoulscat_Wac_BrowserGeneral,i?a.a.Info:a.a.Important,"Shared watermark package detected unexpected unresolved tokens in the watermark text.")}},,,,,,function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(n||(n={}))},,,,,,,,,,,,,,,,function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(44),r=i(77),a=i(183);function s(e){return"number"==typeof e}var o=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if("Office.Telemetry.OTelJS.EventThrottled"===t)return!0;var i=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?i=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):s(this._maxSingleEventPerSecond)&&(i=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),s(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,i&&(i=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),i},e.prototype.applyThrottle=function(e,t,i,s){return!(e>t&&(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[s]&&(this._eventThrottleReported[s]=!0,this._telemetrySink.sendTelemetryEvent({eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:a.d,nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[Object(n.d)("SinkName",this._sinkName||""),Object(n.d)("ThrottledEvent.Name",s),Object(n.c)(i,t)]})),Object(r.b)(2,1,(function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(i,": ").concat(s)})),1))},e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(44),r=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4||(this.samplingValue=function(e){return function(e){for(var t=5381,i=0;i<e.length;i++)t=(t<<5)+t+e.charCodeAt(i);return t>>>0}(e)%1e3/1e3}(t),this.samplingKey=e,0))},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1||(this.samplingValue=t,this.samplingKey=e,0))},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto||(window.crypto.getRandomValues(e),this.samplingValue=e[0]%1e3/1e3,this.samplingKey="Random",0))},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,i){e.eventContract||(e.eventContract={name:"",dataFields:[]});var r=e.eventContract.dataFields;r.push(Object(n.b)("Event.SampleRate",t)),r.push(Object(n.b)("Session.SamplingValue",i)),this.samplingKey&&r.push(Object(n.d)("Session.SamplingKey",this.samplingKey)),r.push(Object(n.a)("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(112);const r=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-dod.cdn.office.net","https://res-gcch.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-1.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://res-h1.cdn.office.net","https://res-2.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-2-dev.cdn.officeppe.net","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud","https://content.lifecycle.officeppe.net/","https://word-edit.officeapps.live.com","https://ppc-word-edit.officeapps.live.com","https://ffc-word-edit.officeapps.live.com","https://fus1-word-edit.officeapps.live.com","https://fil1-word-edit.officeapps.live.com","https://fin1-word-edit.officeapps.live.com","https://eurppc-word-edit.officeapps.live.com","https://ffc-word-view.officeapps.live.com","https://ppc-word-view.officeapps.live.com","https://wordwebclientbuilds.blob.core.windows.net"],a=new RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),s=("urlOriginPolicy",Object(n.a)("urlOriginPolicy",{createScriptURL:e=>{const{origin:t}=new URL(e,document.baseURI);if(r.includes(t)||a.test(t))return e;throw new Error("TrustedTypes policy does not allow loading URL: "+e)}},void 0))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(112);Object(n.a)("emptyStringPolicyHTML",{createHTML:e=>""},void 0);const r=Object(n.a)("emptyStringPolicyURL",{createScriptURL:e=>""},void 0)},function(e,t,i){"use strict";i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return p})),i.d(t,"a",(function(){return g}));var n=i(29),r=i(77),a={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?a[e]?(t.ariaTenantToken&&(a[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(a[e].dnmToken=t.dnmToken)):a[e]=t:Object(r.b)(0,0,(function(){return"Namespace: ".concat(e)}))}function o(e,t){for(var i=e.length;i>0;){var n=e.substr(0,i);if(a[n]){var r=a[n];return t.ariaTenantToken=r.ariaTenantToken,t.dnmToken=r.dnmToken,!0}i=e.lastIndexOf(".",i-1)}return!1}var l=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,d=/^[a-zA-Z0-9_\.]{1,95}$/;function c(e){return d.test(e)}function h(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!c(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var u=i(187),m=i(44),f=-1;function p(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(n.a)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var g=function(){function e(e,t,i){var r,a,s;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=i||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=Object(n.a)(Object(n.a)({},e.getConfig()),this.config),(a=this.partAFields).push.apply(a,e.partAFields)),t&&(s=this.persistentDataFields).push.apply(s,t)}return e.prototype.addEventContentType=function(e,t){e.push(Object(m.c)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=p(e),i=t.telemetryProperties;i.nexusTenantToken=f;var n=i.ariaTenantToken;n||o(t.eventName,i)||n?this.sendTelemetryEventInternal(t,1):Object(r.b)(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var i=p(e);this.sendTelemetryEventInternal(i,t)},e.prototype.sendCustomerContent=function(e){var t=p(e),i=t.telemetryProperties,n=i.customerContentVersion;return(!n||n>2)&&(i.customerContentVersion=2),i.ariaTenantToken=void 0,i.nexusTenantToken=void 0,i.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=p(e),i=t.telemetryProperties;i.dnmToken||o(t.eventName,i)||i.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):Object(r.b)(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):Object(r.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void Object(r.a)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(i){try{3===t||2===t?i.sendNonStandardEvent&&i.sendNonStandardEvent(e,t):i.sendTelemetryEvent(e)}catch(e){}}))}else Object(r.b)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var i,n,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(Object(m.d)("OTelJS.Version",u.a)),3!==t&&this.persistentDataFields&&(i=e.dataFields).unshift.apply(i,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(n=a.dataFields).push.apply(n,this.partAFields),e.eventContract=a}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!l.test(t))throw new Error("Invalid eventName");var t,i=e.eventContract;if(i){if(i.name&&!c(i.name))throw new Error("Invalid eventContract");h(i.dataFields)}h(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,i=e;t<i.length;t++){var n=i[t],r=n[0],a=n[1];this.sendTelemetryEventInternal(r,a)}},e.prototype.setTenantToken=function(e,t,i){s(e,{ariaTenantToken:t,nexusTenantToken:i})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return p(e)},e.prototype.getConfig=function(){return this.config},e}()},,,,,,,,,,,,,,,,function(e,t,i){"use strict";i.r(t);var n=i(8);i.d(t,"RequestStatus",(function(){return n.f})),i.d(t,"SlideShowRole",(function(){return n.i})),i.d(t,"BlankSlideState",(function(){return n.a})),i.d(t,"SlideShowCoreState",(function(){return n.g})),i.d(t,"OpticalZoomSource",(function(){return n.d})),i.d(t,"PriorityHint",(function(){return n.e})),i.d(t,"SlideshowActionSource",(function(){return n.j})),i.d(t,"ClientColorSettings",(function(){return n.b})),i.d(t,"SlideShowErrorCode",(function(){return n.h})),i.d(t,"NavigationType",(function(){return n.c}));var r=i(89);i.d(t,"exposed",(function(){return r.b})),i.d(t,"setupGlobals_SlideShowCore",(function(){return r.c})),i.d(t,"SlideShowCore",(function(){return r.a}));var a=i(160);i.d(t,"PrefetchAddon",(function(){return a.a}));var s=i(161);i.d(t,"SlideAdvanceAddon",(function(){return s.a}));var o=i(102);i.d(t,"PerfCheckerAddon",(function(){return o.a}));var l=i(156);i.d(t,"InputsAddon",(function(){return l.a}));var d=i(81);i.d(t,"AnimatedContentLogger",(function(){return d.a}));var c=i(84);i.d(t,"SlideShowDataParser",(function(){return c.a}));var h=i(157);i.d(t,"AnimationLoggerAddon",(function(){return h.a}));var u=i(158);i.d(t,"TransitionLoggerAddon",(function(){return u.a}));var m=i(143);i.d(t,"DefaultResourceProviders",(function(){return m.a}));var f=i(162);i.d(t,"SlideShowInkAddon",(function(){return f.a}));var p=i(92);i.d(t,"MediaAddon",(function(){return p.a}));var g=i(163);i.d(t,"PrivateViewingAddon",(function(){return g.a}));var _=i(121);i.d(t,"CameoWebcamAddon",(function(){return _.a}))}])}));
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/SlideShowCore.js.map/889a95abaad15401e39810883c883266/SlideShowCore.js.map